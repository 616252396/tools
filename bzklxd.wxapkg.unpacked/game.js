define("index.js", function (require, module, exports) {
    window.screenOrientation = "sensor_landscape", loadLib("libs/laya.core.js"), loadLib("libs/laya.ui.js"), loadLib("libs/laya.d3.js"), loadLib("js/bundle.js");
});
define("js/bundle.js", function (require, module, exports) {
    var __extends = this && this.__extends || function () {
        var a = Object.setPrototypeOf || {__proto__: []} instanceof Array && function (e, t) {
            e.__proto__ = t
        } || function (e, t) {
            for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n])
        };
        return function (e, t) {
            function n() {
                this.constructor = e
            }

            a(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n)
        }
    }();
    !function o(r, s, l) {
        function h(t, e) {
            if (!s[t]) {
                if (!r[t]) {
                    var n = "function" == typeof require && require;
                    if (!e && n) return n(t, !0);
                    if (c) return c(t, !0);
                    var a = new Error("Cannot find module '" + t + "'");
                    throw a.code = "MODULE_NOT_FOUND", a
                }
                var i = s[t] = {exports: {}};
                r[t][0].call(i.exports, function (e) {
                    return h(r[t][1][e] || e)
                }, i, i.exports, o, r, s, l)
            }
            return s[t].exports
        }

        for (var c = "function" == typeof require && require, e = 0; e < l.length; e++) h(l[e]);
        return h
    }({
        1: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("./views/runtime/UIAdapter"), i = e("./views/item/GameRankListItemView"),
                o = e("./views/item/BroadcastView"), r = e("./views/item/MatchPlayerItemView"),
                s = e("./views/item/GradeItem"), l = e("./views/item/DinsShowScript"),
                h = e("./views/item/AttributeItem"), c = function () {
                    function e() {
                    }

                    return e.init = function () {
                        var e = Laya.ClassUtils.regClass;
                        e("views/runtime/UIAdapter.ts", a.default), e("views/item/GameRankListItemView.ts", i.default), e("views/item/BroadcastView.ts", o.default), e("views/item/MatchPlayerItemView.ts", r.default), e("views/item/GradeItem.ts", s.default), e("views/item/DinsShowScript.ts", l.default), e("views/item/AttributeItem.ts", h.default)
                    }, e.width = 750, e.height = 1334, e.scaleMode = "fixedwidth", e.screenMode = "vertical", e.alignV = "middle", e.alignH = "center", e.startScene = "LoadingView.scene", e.sceneRoot = "", e.debug = !1, e.stat = !1, e.physicsDebug = !1, e.exportSceneToJson = !1, e
                }();
            (n.default = c).init()
        }, {
            "./views/item/AttributeItem": 65,
            "./views/item/BroadcastView": 66,
            "./views/item/DinsShowScript": 67,
            "./views/item/GameRankListItemView": 68,
            "./views/item/GradeItem": 70,
            "./views/item/MatchPlayerItemView": 71,
            "./views/runtime/UIAdapter": 72
        }],
        2: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var o = e("./conslt/GameConst"), a = e("./core/managee/DUIManager"), i = e("./conslt/DIUIConfig"),
                r = e("./sdkm/SDKManager"), s = e("./conslt/GlobalData"), l = e("./utils/DateUtil"),
                h = e("./core/managee/RescManager"), c = e("./conslt/DResConfig"), d = e("./core/managee/DEventManage"),
                u = e("./conslt/DEvent"), p = e("./core/managee/NetwrokManager"), g = e("./game/data/GameData"),
                m = e("./game/managre/DServeManager"), f = e("./game/utils/GameUtils"), y = e("./conslt/ReporttType"),
                v = function () {
                    function e() {
                        this.curSubPacketLoadProgress = 0, this.loadProgress = 0, this.updateManager = null, this.subPackageName = "res", this.curHideTimer = 0
                    }

                    return Object.defineProperty(e, "Instance", {
                        get: function () {
                            return null === e._instance && (e._instance = new e), e._instance
                        }, enumerable: !0, configurable: !0
                    }), e.prototype.onConfigLoaded = function () {
                        this.canLoadSubpackage() ? (a.DUIManager.Instance.openUI(i.DIUIConfig.Load, {loadSubpackage: !0}), this.loadSubpackage()) : (a.DUIManager.Instance.openUI(i.DIUIConfig.Load, {loadSubpackage: !1}), this.loadSubpackageFinish()), this.checkForUpdate()
                    }, e.prototype.initEnv = function () {
                        var t = this;
                        (r.SDKManager.IsTencentGame() || r.SDKManager.IsTouTiao()) && "undefined" != typeof wx && (Laya.MiniAdpter.window.wx.onShow(function (e) {
                            t.onShowWX(e)
                        }), Laya.MiniAdpter.window.wx.onHide(function (e) {
                            t.onHideWX(e)
                        }));
                        var e = parseInt(Laya.LocalStorage.getItem("wxRegisterTime") || "0");
                        0 === e && (e = Date.now(), Laya.LocalStorage.setItem("wxRegisterTime", e.toString()), Laya.LocalStorage.removeItem("canFetchVideo"), Laya.LocalStorage.removeItem("useVideoMaxTime"), s.GlobalData.firstTimePlayer = !0), s.GlobalData.registerTime = e;
                        var n = Date.now();
                        s.GlobalData.accountTime = n - e;
                        var a = parseInt(Laya.LocalStorage.getItem("lastStartLoadTime") || "0");
                        if (s.GlobalData.lastStartTime = a, Laya.LocalStorage.setItem("lastStartLoadTime", n.toString()), s.GlobalData.isOverDay = f.GameUtils.checkOverDay(), s.GlobalData.isNewPlayer = l.DateUtil.isSameDay(n, e), o.GameConst.recoverData || (s.GlobalData.isNewPlayer = !0), (r.SDKManager.IsTencentGame() || r.SDKManager.IsTouTiao()) && "undefined" != typeof wx) {
                            var i = wx.getSystemInfoSync();
                            s.GlobalData.windowHeight = i.windowHeight, s.GlobalData.windowWidth = i.windowWidth, s.GlobalData.screenHeight = i.screenHeight, s.GlobalData.screenWidth = i.screenWidth, i.platform && "android" === i.platform.toLowerCase() ? r.SDKManager.isAndroid = !0 : i.platform && "ios" === i.platform.toLowerCase() && (r.SDKManager.isIos = !0), i.benchmarkLevel && 1 <= i.benchmarkLevel && i.benchmarkLevel < 20 && (r.SDKManager.isLowDevice = !0)
                        }
                        r.SDKManager.nodeReport(y.ReporttType.gameStart)
                    }, e.prototype.onLoadComplete = function () {
                        this.doLoginAction(null)
                    }, e.prototype.canLoadSubpackage = function () {
                        return !(!this.subPackageName || !this.subPackageName.length) && (!o.GameConst.UseRemoteRes && (!r.SDKManager.IsQQ() && !(!r.SDKManager.IsTencentGame() || "undefined" == typeof wx || !wx.loadSubpackage)))
                    }, e.prototype.loadSubpackageFinish = function () {
                        h.RescManager.Instance.loadRes(null), Laya.loader.load(c.default.getGameConfig(), Laya.Handler.create(this, this.onLoadComplete))
                    }, e.prototype.loadSubpackage = function () {
                        var t = this, e = wx.loadSubpackage({
                            name: this.subPackageName, success: function (e) {
                                t.loadSubpackageFinish(), Laya.timer.clear(t, t.updateLoad)
                            }, fail: function (e) {
                                Laya.timer.clear(t, t.updateLoad)
                            }
                        });
                        e && (e.onProgressUpdate(function (e) {
                            t.curSubPacketLoadProgress = e.progress / 100
                        }), Laya.timer.once(500, this, this.updateLoad))
                    }, e.prototype.doLoginAction = function (t) {
                        var n = this;
                        void 0 === t && (t = null), this.getAppCfg(), g.GameData.Instance.loginError = !1, r.SDKManager.Instance.sdkLogin(Laya.Handler.create(this, function (e) {
                            r.SDKManager.Instance.loginParams = e, n.connectSdkLoginSrv(r.SDKManager.Instance.loginParams, t)
                        }), null)
                    }, e.prototype.connectSdkLoginSrv = function (e, t) {
                        null !== e && m.DServeManager.Instance.sdkLogin(e, t)
                    }, e.prototype.onShowWX = function (e) {
                        e.path;
                        e.referrerInfo && e.referrerInfo.appId;
                        var t = e.query;
                        t && this.updateLoadInfoFromWX(t), e.scene && (s.GlobalData.scene = e.scene, r.SDKManager.Instance.report("GameScene", {scene: e.scene}));
                        var n = 0;
                        this.curHideTimer && (n = Date.now() - this.curHideTimer) < 0 && (n = 0), this.curHideTimer = null, d.DEventManage.Instance.event(u.DEvent.GetFocus, {hideTime: n})
                    }, e.prototype.onHideWX = function (e) {
                        g.GameData.saveGameData(!0, !0), this.curHideTimer = Date.now(), d.DEventManage.Instance.event(u.DEvent.LostFocus)
                    }, e.prototype.updateLoadInfoFromWX = function (e) {
                        if (null !== e && (null !== e.inviteName || null !== e.openid || null !== e.inviteCode)) {
                            e.inviteName, e.openid, e.pos, e.shareTime;
                            var t = e.inviteCode;
                            t && (g.GameData.Instance.inviteCode = t)
                        }
                    }, e.prototype.getAppCfg = function () {
                        p.NetwrokManager.Instance.getAppConfig().then(function (e) {
                            if (o.GameConst.State = e.type || 0, o.GameConst.showRecommend = e.showRecommend || !1, o.GameConst.ShareTickTimer = e.shareTimer || 3e3, o.GameConst.vGameInfo = Object.assign({}, o.GameInfo, e.vGameInfo), o.GameConst.State == o.AppState.Check) o.GameConst.vAdCount = 3e3; else {
                                var t = e.shareList || [];
                                0 < t.length && (r.SDKManager.IsTouTiao() || (o.GameConst.ShareInfoList = t)), o.GameConst.vList = e.vList || [], o.GameConst.vsInfo = e.vsInfo || {
                                    type: 0,
                                    snu: 6,
                                    vnum: 8
                                }, o.GameConst.vAdCount = e.vAdCount || o.GameConst.vAdCount
                            }
                        }).catch(function (e) {
                        })
                    }, e.prototype.updateLoad = function () {
                        this.loadProgress += .05, 1 <= this.loadProgress ? (Laya.timer.clear(this, this.updateLoad), this.loadProgress = 1) : Laya.timer.once(500, this, this.updateLoad), this.updateSubPacketLoad()
                    }, e.prototype.updateSubPacketLoad = function () {
                        var e = this.curSubPacketLoadProgress;
                        e < .9 || Laya.timer.clear(this, this.updateLoad), e = .1 * this.curSubPacketLoadProgress + .9 * this.loadProgress, d.DEventManage.Instance.event(u.DEvent.SubpackageLoadProgress, e)
                    }, e.prototype.checkForUpdate = function () {
                        var t = this;
                        "undefined" != typeof wx && wx.getUpdateManager && (this.updateManager = wx.getUpdateManager(), this.updateManager.onCheckForUpdate(function (e) {
                        }), this.updateManager.onUpdateReady(function () {
                            wx.showModal({
                                title: "更新提示",
                                content: "新版本已经准备好，是否重启应用？",
                                success: function (e) {
                                    e.confirm && t.updateManager.applyUpdate()
                                },
                                fail: null,
                                complete: null,
                                confirmText: "重启",
                                confirmColor: "#3CC51F",
                                showCancel: !0,
                                cancelText: "取消",
                                cancelColor: "#000000"
                            })
                        }), this.updateManager.onUpdateFailed(function () {
                        }))
                    }, e._instance = null, e
                }();
            n.GameMain = v
        }, {
            "./conslt/DEvent": 4,
            "./conslt/DIUIConfig": 5,
            "./conslt/DResConfig": 6,
            "./conslt/GameConst": 8,
            "./conslt/GlobalData": 9,
            "./conslt/ReporttType": 11,
            "./core/managee/DEventManage": 12,
            "./core/managee/DUIManager": 13,
            "./core/managee/NetwrokManager": 16,
            "./core/managee/RescManager": 17,
            "./game/data/GameData": 21,
            "./game/managre/DServeManager": 25,
            "./game/utils/GameUtils": 39,
            "./sdkm/SDKManager": 42,
            "./utils/DateUtil": 48
        }],
        3: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("./GameConfig"), i = e("./GameMain");
            new (function () {
                function e() {
                    window.Laya3D ? Laya3D.init(a.default.width, a.default.height) : Laya.init(a.default.width, a.default.height, Laya.WebGL), Laya.Physics && Laya.Physics.enable(), Laya.DebugPanel && Laya.DebugPanel.enable(), Laya.stage.scaleMode = a.default.scaleMode, Laya.stage.screenMode = a.default.screenMode, Laya.stage.alignV = a.default.alignV, Laya.stage.alignH = a.default.alignH, Laya.URL.exportSceneToJson = a.default.exportSceneToJson, (a.default.debug || "true" == Laya.Utils.getQueryString("debug")) && Laya.enableDebugPanel(), a.default.physicsDebug && Laya.PhysicsDebugDraw && Laya.PhysicsDebugDraw.enable(), a.default.stat && Laya.Stat.show(), Laya.alertGlobalError = !0, Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION), i.GameMain.Instance.initEnv()
                }

                return e.prototype.onVersionLoaded = function () {
                    Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded))
                }, e.prototype.onConfigLoaded = function () {
                    i.GameMain.Instance.onConfigLoaded()
                }, e
            }())
        }, {"./GameConfig": 1, "./GameMain": 2}],
        4: [function (e, t, n) {
            "use strict";
            var a;
            Object.defineProperty(n, "__esModule", {value: !0}), (a = n.DEvent || (n.DEvent = {})).ResLoadProgress = "ResLoadProgress", a.StartLoadFinish = "StartLoadFinish", a.GetFocus = "GetFocus", a.LostFocus = "LostFocus", a.ShareSuccess = "ShareSuccess", a.ShowAdCompleted = "ShowAdCompleted", a.CloseShowAd = "CloseShowAd", a.FetchVideoFail = "FetchVideoFail", a.ShareFail = "ShareFail", a.userLoginFinish = "userLoginFinish", a.SubpackageLoadProgress = "SubpackageLoadProgress", a.ShowBannerCompleted = "ShowBannerCompleted", a.FinishVideoAd = "FinishVideoAd", a.ShowShareVideoCompleted = "ShowShareVideoCompleted", a.CloseShowShareViedo = "CloseShowShareViedo", a.BannerPosChange = "BannerPosChange", a.DestoryUserInfoButton = "DestoryUserInfoButton", a.OverDayEvent = "OverDayEvent", a.OpenView = "OpenView", a.CloseView = "CloseView", a.BattleTimeChange = "BattleTimeChange", a.PlayerLVUp = "PlayerLVUp", a.killNumChange = "killNumChange", a.PlayerGoodsUpdate = "PlayerGoodsUpdate", a.ReliveViewShow = "ReliveViewShow", a.UserInfoChange = "UserInfoChange", a.BattleMatchSuccess = "BattleMatchSuccess", a.UpdateRecordBtn = "UpdateRecordBtn", a.moveInputChange = "moveInputChange", a.kill = "kill", a.onAddEnergy = "onAddEnergy", a.onExitGame = "onExitGame", a.onGameDestory = "onGameDestory", a.onGameFinish = "onGameFinish", a.loadMapFinish = "loadMapFinish", a.gameStartCDEnd = "gameStartCDEnd", a.CupChange = "CupChange", a.SkinShowChange = "SkinShowChange", a.SkinUsedChange = "SkinUsedChange"
        }, {}],
        5: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../views/LoadingView"), i = e("../views/StartView"), o = e("../views/GameView"),
                r = e("../views/QuickBattleMatchView"), s = e("../views/ReliveView"), l = e("../views/SettlementView"),
                h = e("../views/GradeUpView"), c = e("../views/GetMoneyView"), d = e("../views/RecordShareView"),
                u = e("../views/SettingView"), p = e("../views/SkinView"), g = function () {
                    function e() {
                    }

                    return e.Load = {id: 1, cls: a.LoadingView, res: null}, e.Start = {
                        id: 2,
                        cls: i.default,
                        res: null
                    }, e.Game = {id: 3, cls: o.default, res: null}, e.Match = {
                        id: 4,
                        cls: r.default,
                        res: null
                    }, e.Revive = {id: 5, cls: s.ReliveView, res: null}, e.Settlement = {
                        id: 11,
                        cls: l.default,
                        res: null
                    }, e.GradeUp = {id: 12, cls: h.default, res: null}, e.GetMoney = {
                        id: 13,
                        cls: c.default,
                        res: null
                    }, e.RecordShare = {id: 14, cls: d.default, res: null}, e.Setting = {
                        id: 15,
                        cls: u.default,
                        res: null
                    }, e.Skin = {id: 16, cls: p.default, res: null}, e
                }();
            n.DIUIConfig = g
        }, {
            "../views/GameView": 53,
            "../views/GetMoneyView": 54,
            "../views/GradeUpView": 55,
            "../views/LoadingView": 56,
            "../views/QuickBattleMatchView": 57,
            "../views/RecordShareView": 58,
            "../views/ReliveView": 59,
            "../views/SettingView": 60,
            "../views/SettlementView": 61,
            "../views/SkinView": 62,
            "../views/StartView": 63
        }],
        6: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("./GameConst"), i = function () {
                function t() {
                }

                return t.getGameConfig = function () {
                    var e = t.RES_GAME_DATA;
                    return a.GameConst.UseRemoteRes && (e = "/" + e), [{url: e, type: Laya.Loader.TEXT}]
                }, t.getGameRes = function () {
                    return [{url: t.RES_COMMON_CONFIG, type: Laya.Loader.ATLAS}, {
                        url: t.RES_GRADE,
                        type: Laya.Loader.ATLAS
                    }, {url: t.RES_BTN_ANI, type: Laya.Loader.ATLAS}, {
                        url: t.RES_RANK,
                        type: Laya.Loader.ATLAS
                    }, {url: t.RES_SETTLEMENT, type: Laya.Loader.ATLAS}, {
                        url: t.RES_SKIN,
                        type: Laya.Loader.ATLAS
                    }, {url: t.RES_DINS_1, type: Laya.Loader.IMAGE}, {
                        url: t.RES_DINS_2,
                        type: Laya.Loader.IMAGE
                    }, {url: t.RES_DINS_3, type: Laya.Loader.IMAGE}, {
                        url: t.RES_DINS_4,
                        type: Laya.Loader.IMAGE
                    }, {url: t.RES_DINS_5, type: Laya.Loader.IMAGE}, {
                        url: t.RES_DINS_6,
                        type: Laya.Loader.IMAGE
                    }, {url: t.RES_DINS_7, type: Laya.Loader.IMAGE}, {
                        url: t.RES_DINS_8,
                        type: Laya.Loader.IMAGE
                    }, {url: t.RES_DINS_9, type: Laya.Loader.IMAGE}, {
                        url: t.RES_DINS_10,
                        type: Laya.Loader.IMAGE
                    }, {url: t.RES_DINS_11, type: Laya.Loader.IMAGE}, {url: t.RES_DINS_12, type: Laya.Loader.IMAGE}]
                }, t.RES_COMMON_CONFIG = "res/atlas/common.atlas", t.RES_GRADE = "res/atlas/grade.atlas", t.RES_BTN_ANI = "res/atlas/btnAni.atlas", t.RES_RANK = "res/atlas/rank.atlas", t.RES_SKIN = "res/atlas/skin.atlas", t.RES_SETTLEMENT = "res/atlas/settlement.atlas", t.RES_GAME_DATA = "res/data/gameData.bin", t.RES_DINS_1 = "dins/T-Rex_1.jpg", t.RES_DINS_2 = "dins/T-Rex_2.jpg", t.RES_DINS_3 = "dins/T-Rex_3.jpg", t.RES_DINS_4 = "dins/T-Rex_4.jpg", t.RES_DINS_5 = "dins/T-Rex_5.jpg", t.RES_DINS_6 = "dins/T-Rex_6.jpg", t.RES_DINS_7 = "dins/T-Rex_7.jpg", t.RES_DINS_8 = "dins/T-Rex_8.jpg", t.RES_DINS_9 = "dins/T-Rex_9.jpg", t.RES_DINS_10 = "dins/T-Rex_10.jpg", t.RES_DINS_11 = "dins/T-Rex_11.jpg", t.RES_DINS_12 = "dins/T-Rex_12.jpg", t
            }();
            n.default = i
        }, {"./GameConst": 8}],
        7: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0}), n.DSound = {
                Bgm: "music/bgm.mp3",
                LevelUpdate: "music/success.mp3",
                Button: "music/button.mp3",
                Eat: "music/Eat.mp3",
                Fail: "music/fail.mp3",
                Die: "music/Dead.mp3",
                Gold: "music/coin.mp3",
                Success: "music/success.mp3",
                coundDown: "music/countdown.mp3",
                Progress: "music/levelprogress.mp3",
                Victory: "music/victory.mp3",
                Destruction: "music/Destruction.mp3",
                footstep2: "music/footstep2.mp3",
                people: "music/people.mp3",
                gameStart: "music/gameStart.mp3",
                AttrUpdate: "music/LevelUp.mp3",
                hit: "music/hit.mp3",
                dinsDie: "music/dinsDie.mp3"
            }
        }, {}],
        8: [function (e, t, n) {
            "use strict";
            var a, i, o, r;
            Object.defineProperty(n, "__esModule", {value: !0}), (i = a = n.Platform || (n.Platform = {}))[i.Wechat = 1] = "Wechat", i[i.QQ = 7] = "QQ", i[i.TouTiao = 9] = "TouTiao", (r = o = n.AppState || (n.AppState = {}))[r.Normal = 1] = "Normal", r[r.Check = 2] = "Check", r[r.Fission = 3] = "Fission", n.ShareInfoList = [{
                imgUrl: "https://res7.lexun99.com/game/dins/share/share1.jpg",
                shareContent: "开局一条小恐龙，进化成为霸王龙。"
            }, {
                imgUrl: "https://res7.lexun99.com/game/dins/share/share2.jpg",
                shareContent: "《侏罗纪世界》中霸王龙才是真正的老戏骨！"
            }, {
                imgUrl: "https://res7.lexun99.com/game/dins/share/share3.jpg",
                shareContent: "史前最凶残的10大生物，霸王龙竟排不上榜"
            }, {imgUrl: "https://res7.lexun99.com/game/dins/share/share4.jpg", shareContent: "史前怪物大作战，当棘龙遇上霸王龙,谁输谁赢?"}];
            var s = {
                IgnoreShare: !(n.GameInfo = {
                    sRecommend: !0,
                    acv: "",
                    ttacv: "",
                    qqacv: "",
                    vsAllCount: 3,
                    vsFailShareCount: 3,
                    tuiInfo: [],
                    ttTuiInfo: [],
                    tRecommend: !0,
                    tIosRecommend: !0
                }),
                Platform: a.Wechat,
                packageName: "com.lexun.dins",
                ClientVer: "1.0.0",
                Apiversion: "1",
                SupportOpenDomain: !0,
                State: o.Normal,
                showRecommend: !1,
                ShareTickTimer: 3e3,
                host: "https://game.lexun99.com/sanguo",
                Dev: !1,
                ShareInfoList: n.ShareInfoList,
                isLimitCity: !1,
                isLimitCityB: !1,
                appId: "wxc297a6ed9d0eaeb9",
                bCount: 3,
                bTimer: 60,
                closeLD: !1,
                isF: !1,
                vList: [],
                UseRemoteRes: !1,
                resHost: "https://res7.lexun99.com/game/dins/",
                vsInfo: {type: 0, snum: 0, vnum: 0},
                vGameInfo: Object.assign({}, n.GameInfo),
                recoverData: !0,
                vAdCount: 0,
                isAnonymous: !1,
                aiCount: 27,
                videoTopics: ["暴走恐龙行动"]
            };
            a.TouTiao, o.Normal, n.ShareInfoList, Object.assign({}, n.GameInfo), a.QQ, o.Normal, n.ShareInfoList, Object.assign({}, n.GameInfo);
            n.GameConst = s
        }, {}],
        9: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function () {
                function e() {
                }

                return e.windowWidth = 0, e.windowHeight = 0, e.screenWidth = 0, e.screenHeight = 0, e.fetchingVideoAd = !1, e.registerTime = 0, e.accountTime = 0, e.isNewPlayer = !1, e.firstTimePlayer = !1, e.teachMode = !1, e.lastStartTime = 0, e.isOverDay = !1, e.severTime = 0, e.scene = 0, e
            }();
            n.GlobalData = a
        }, {}],
        10: [function (e, t, n) {
            "use strict";
            var a;
            Object.defineProperty(n, "__esModule", {value: !0}), (a = n.NetCode || (n.NetCode = {}))[a.OK = 1e4] = "OK", a[a.FAIL = 10002] = "FAIL", a[a.LOGIN_PAR_ERROR = 1001] = "LOGIN_PAR_ERROR", a[a.ENTRY_TOKEN_EXPIRE = 10005] = "ENTRY_TOKEN_EXPIRE", a[a.ENTRY_USER_NOT_EXIST = 10011] = "ENTRY_USER_NOT_EXIST"
        }, {}],
        11: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0}), n.ReporttType = {
                showAD: "showAD",
                doShare: "doShare",
                watchADComplete: "watchADComplete",
                watchADExit: "watchADExit",
                showBanner: "showBanner",
                loadBanner: "loadBanner",
                loadBannerError: "loadBannerError",
                loadVideoError: "loadVideoError",
                Login: "Login",
                LoginFail: "LoginFail",
                videoSuccess: "videoSuccess",
                gameStart: "gameStart",
                loadRes: "loadRes",
                showStart: "showStart",
                MyRecommendJump: "自有产品导出"
            }
        }, {}],
        12: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function (e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }

                return __extends(t, e), Object.defineProperty(t, "Instance", {
                    get: function () {
                        return null === t._instance && (t._instance = new t), t._instance
                    }, enumerable: !0, configurable: !0
                }), t._instance = null, t
            }(Laya.EventDispatcher);
            n.DEventManage = a
        }, {}],
        13: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var s = e("../../conslt/DIUIConfig"), l = e("../../game/managre/GameShaereManager"),
                h = e("./DEventManage"), d = e("../../conslt/DEvent"), a = function () {
                    function c() {
                        this.hideBanner = !1, this.adpaterArray = [], this.uiArray = [], this.debugStr = "", this.maskView = null, this.arrTips = null, this.reset(), this.hideBanner = !1
                    }

                    return Object.defineProperty(c, "Instance", {
                        get: function () {
                            return null == c._instance && (c._instance = new c).init(), c._instance
                        }, enumerable: !0, configurable: !0
                    }), c.prototype.init = function () {
                        Laya.stage.on(Laya.Event.RESIZE, this, this.onScreenResize)
                    }, c.prototype.addAdapter = function (e) {
                        this.adpaterArray.push(e)
                    }, c.prototype.clearAdapterOnUI = function (e) {
                        for (var t = e.uiname, n = this.adpaterArray.length - 1; 0 <= n; n--) this.adpaterArray[n].uiname == t && this.adpaterArray.splice(n, 1)
                    }, c.prototype.onScreenResize = function () {
                        for (var e = this.adpaterArray.length - 1; 0 <= e; e--) this.adpaterArray[e].adapter()
                    }, c.prototype.reset = function () {
                        this.uiArray = [], this.adpaterArray = []
                    }, c.prototype.pushUI = function (e) {
                        this.uiArray.push(e)
                    }, c.prototype.toUI = function (e, t) {
                        for (var n = this.uiArray.length - 1; 0 <= n; n--) {
                            var a = this.uiArray[n];
                            this.uninitUI(a)
                        }
                        this.uiArray.length = 0, this.openUI(e, t)
                    }, c.prototype.openUIUnique = function (e, t, n) {
                        void 0 === n && (n = !0), 0 == this.isUIOpen(e) && this.openUI(e, t, n)
                    }, c.prototype.checkBanner = function () {
                        l.GameShaereManager.Instance.isShowingBanner() && (l.GameShaereManager.Instance.hideBanner(), this.hideBanner = !0)
                    }, c.prototype.restoreBanner = function () {
                        if (this.hideBanner) for (var e = this.uiArray.length - 1; 0 <= e; e--) {
                            var t = this.uiArray[e];
                            if (t.visible) {
                                var n = 0;
                                t.getPinY && (n = t.getPinY());
                                var a = t.uiname && t.uiname.id || 0;
                                l.GameShaereManager.Instance.restoreBanner(a, n), this.hideBanner = !1;
                                break
                            }
                        }
                    }, c.prototype.openUI = function (e, t, n) {
                        void 0 === t && (t = null), void 0 === n && (n = !0), this.checkBanner(), null != e.res ? Laya.loader.load(e.res, Laya.Handler.create(null, function () {
                            c.Instance.createUI(e, t, n)
                        }), null) : this.createUI(e, t, n)
                    }, c.prototype.createUI = function (e, t, n) {
                        void 0 === n && (n = !0);
                        var a = new e.cls;
                        if (null != a) {
                            var i = !0;
                            switch (a.uiname = e) {
                                case s.DIUIConfig.Load:
                                    a.zOrder = c._loadingViewZorder, i = !1;
                                    break;
                                default:
                                    a.zOrder = c._viewZorder++
                            }
                            if (n && 0 < this.uiArray.length) {
                                var o = this.uiArray[this.uiArray.length - 1];
                                o.visible && null !== o.didHide && void 0 !== o.didHide && o.didHide()
                            }
                            Laya.stage.addChild(a), this.pushUI(a), a.visible = n;
                            var r = 0;
                            a.getPinY && (r = a.getPinY()), n && i && l.GameShaereManager.Instance.showADBanner(e.id, r), h.DEventManage.Instance.event(d.DEvent.OpenView, e), null != a.init && n && a.init(t), null !== a.didShow && void 0 !== a.didShow && n && a.didShow()
                        }
                    }, c.prototype.closeUI = function (e) {
                        for (var t = this.uiArray.length - 1; 0 <= t; t--) {
                            var n = this.uiArray[t];
                            if (n.uiname == e) {
                                this.uninitUI(n), this.uiArray.splice(t, 1);
                                break
                            }
                        }
                        for (var a = this.uiArray.length - 1; 0 <= a; a--) {
                            var i = this.uiArray[a];
                            if (i.visible) {
                                if (null !== i.didShow && void 0 !== i.didShow && i.didShow(), this.hideBanner) {
                                    var o = 0;
                                    i.getPinY && (o = i.getPinY());
                                    var r = i.uiname && i.uiname.id || 0;
                                    l.GameShaereManager.Instance.restoreBanner(r, o), this.hideBanner = !1
                                }
                                break
                            }
                        }
                    }, c.prototype.isUIOpen = function (e) {
                        for (var t = this.uiArray.length - 1; 0 <= t; t--) {
                            if (this.uiArray[t].uiname === e) return !0
                        }
                        return !1
                    }, c.prototype.showUI = function (e, t) {
                        for (var n = this.uiArray.length - 1; 0 <= n; n--) {
                            var a = this.uiArray[n];
                            if (a.uiname == e) {
                                null != a.init && a.init(t), null !== a.didShow && a.didShow(), a.visible = !0, a.zOrder = c._viewZorder++;
                                var i = 0;
                                return a.getPinY && (i = a.getPinY()), l.GameShaereManager.Instance.showADBanner(e.id, i), h.DEventManage.Instance.event(d.DEvent.OpenView, e), !0
                            }
                        }
                        return !1
                    }, c.prototype.hideUI = function (e) {
                        for (var t = this.uiArray.length - 1; 0 <= t; t--) {
                            var n = this.uiArray[t];
                            if (n.uiname == e) {
                                n.visible = !1, null !== n.didHide && n.didHide(), null !== n.uninit && n.uninit(), this.checkBanner();
                                break
                            }
                        }
                        for (var a = this.uiArray.length - 1; 0 <= a; a--) {
                            var i = this.uiArray[a];
                            if (i.visible) {
                                if (this.hideBanner) {
                                    var o = 0;
                                    i.getPinY && (o = i.getPinY());
                                    var r = i.uiname && i.uiname.id || 0;
                                    l.GameShaereManager.Instance.restoreBanner(r, o), this.hideBanner = !1
                                }
                                break
                            }
                        }
                    }, c.prototype.findUI = function (e) {
                        for (var t = this.uiArray.length - 1; 0 <= t; t--) {
                            var n = this.uiArray[t];
                            if (n.uiname == e) return n
                        }
                        return null
                    }, c.prototype.uninitUI = function (e) {
                        this.clearAdapterOnUI(e), null != e.uninit && e.uninit(), Laya.timer.clearAll(e), l.GameShaereManager.Instance.hideBanner(e.uiname.id), e.removeSelf(), e.destroy()
                    }, c.prototype.update = function () {
                        for (var e = this.uiArray.length - 1; 0 <= e; e--) {
                            var t = this.uiArray[e];
                            null != t.update && t.update()
                        }
                    }, c.prototype.showDialog = function (e) {
                    }, c.prototype.showMask = function (e) {
                        if (e && null == this.maskView) {
                            var t = new Laya.Sprite;
                            (this.maskView = t).graphics.drawRect(-530, -180, 2340, 1080, "#949494"), t.alpha = .5, t.mouseThrough = !1, t.mouseEnabled = !0;
                            var n = new Laya.HitArea;
                            n.hit.drawRect(0, 0, Laya.stage.width, Laya.stage.height, "#000000"), t.hitArea = n, t.zOrder = c._dialogZorder, Laya.stage.addChild(this.maskView)
                        } else e || null == this.maskView || (this.maskView.removeSelf(), this.maskView.destroy(), this.maskView = null)
                    }, c.prototype.showTips = function (e, t, n, a) {
                        void 0 === t && (t = 600), void 0 === n && (n = 30), void 0 === a && (a = "#FFFFFF");
                        var i = this.arrTips, o = null;
                        if (null == i) {
                            i = [];
                            var r = new Laya.Box;
                            Laya.stage.addChild(r), r.zOrder = c._tipsZorder;
                            for (var s = 0; s < 3; s++) {
                                (o = new Laya.Box).width = 600, o.height = 114, o.visible = !1;
                                var l, h = new Laya.Image;
                                h.skin = "common/bg_toast.png", h.width = 600, h.height = 114, o.addChild(h), (l = new Laya.Text).name = "txt", l.fontSize = 30, l.color = "#FFFFFF", l.width = 600, l.height = 114, l.align = "center", l.valign = "middle", o.addChild(l), i.push(o), r.addChild(o)
                            }
                            this.arrTips = i, r.width = 600, r.centerX = 0, r.centerY = 0
                        }
                        0 != i.length && ((l = (o = i.shift()).getChildByName("txt")).text = e, l.fontSize = n || 30, l.color = a || "#FFFFFF", t = t || 600, o.visible = !0, o.alpha = 1, Laya.Tween.to(o, {alpha: 0}, t, null, Laya.Handler.create(this, function (e) {
                            e.visible = !1, i.push(e)
                        }, [o]), 1e3))
                    }, c._viewZorder = 1e3, c._loadingViewZorder = 2999, c._tipsZorder = 3e3, c._dialogZorder = 3100, c._maskZorder = 3100, c._instance = null, c._debugTxt = null, c
                }();
            n.DUIManager = a
        }, {
            "../../conslt/DEvent": 4,
            "../../conslt/DIUIConfig": 5,
            "../../game/managre/GameShaereManager": 28,
            "./DEventManage": 12
        }],
        14: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../sdkm/SDKManager"), i = e("./DEventManage"), o = e("../../conslt/DEvent"), r = function () {
                function e() {
                    this.recorder = null, this.videoPath = null, this.recording = !1, this.doKilled = !1, this.pausing = !1, this.recordTime = 0, this.maxRecordTime = 0, a.SDKManager.IsTouTiao() && "undefined" != typeof wx && (this.recorder = wx.getGameRecorderManager(), this.initRecord())
                }

                return Object.defineProperty(e, "Instance", {
                    get: function () {
                        return null == e._instance && (e._instance = new e), e._instance
                    }, enumerable: !0, configurable: !0
                }), e.prototype.start = function (e) {
                    void 0 === e && (e = 120), this.recorder && (this.recording && (this.recorder.stop(), this.recording = !1, this.pausing = !1), this.recorder.start({duration: e}), this.maxRecordTime = e, this.recording = !0, this.doKilled = !1, this.pausing = !1, Laya.timer.clearAll(this), this.recordTime = 0, Laya.timer.loop(1e3, this, this.updateRecordTime), i.DEventManage.Instance.event(o.DEvent.UpdateRecordBtn))
                }, e.prototype.updateRecordTime = function () {
                    this.recording && !this.pausing && (this.recordTime += 1, this.recordTime + 1 >= this.maxRecordTime && this.stop())
                }, e.prototype.canShowShareVideo = function () {
                    return !!this.videoPath
                }, e.prototype.pause = function () {
                    this.recorder && this.recorder.recording && (this.recorder.pause(), this.pausing = !0)
                }, e.prototype.resume = function () {
                    this.recorder && this.recorder.recording && this.pausing && this.recorder.resume()
                }, e.prototype.stop = function () {
                    this.recorder && this.recording && (Laya.timer.clearAll(this), this.recorder.stop(), this.recording = !1, i.DEventManage.Instance.event(o.DEvent.UpdateRecordBtn))
                }, e.prototype.initRecord = function () {
                    var n = this;
                    this.recorder && (this.recorder.onStart(function (e) {
                    }), this.recorder.onStop(function (e) {
                        var t = e.videoPath;
                        n.recordTime <= 3 && (t = null), n.videoPath = t
                    }), this.recorder.onPause(function () {
                    }), this.recorder.onResume(function () {
                    }), this.recorder.onError(function (e) {
                    }), this.recorder.onInterruptionBegin(function (e) {
                    }), this.recorder.onInterruptionEnd(function (e) {
                    }))
                }, e.prototype.shareVideo = function (e) {
                    this.recording && this.stop(), a.SDKManager.Instance.shareVideo(e)
                }, e._instance = null, e
            }();
            n.GameRecodrderManager = r
        }, {"../../conslt/DEvent": 4, "../../sdkm/SDKManager": 42, "./DEventManage": 12}],
        15: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function () {
                function e() {
                }

                return e.setBoolValue = function (e, t) {
                    e && Laya.LocalStorage.setItem(e, t ? "1" : "0")
                }, e.getBoolValue = function (e) {
                    if (e) {
                        var t = Laya.LocalStorage.getItem(e);
                        if (null !== t) return "1" === t
                    }
                    return !1
                }, e.setNumberValue = function (e, t) {
                    e && Laya.LocalStorage.setItem(e, t + "")
                }, e.getNumberValue = function (e) {
                    if (e) {
                        var t = Laya.LocalStorage.getItem(e);
                        if (null !== t) return parseFloat(t) || 0
                    }
                    return 0
                }, e.setStringValue = function (e, t) {
                    e && Laya.LocalStorage.setItem(e, t)
                }, e.getStringValue = function (e) {
                    return e && Laya.LocalStorage.getItem(e) || ""
                }, e.setDataValue = function (e, t) {
                    e && Laya.LocalStorage.setJSON(e, t)
                }, e.getDataValue = function (e) {
                    return e && Laya.LocalStorage.getJSON(e) || null
                }, e
            }();
            n.LocalStorgeMananger = a
        }, {}],
        16: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../conslt/GameConst"), s = e("../network/HttpRequest"), i = e("../../conslt/NetCode"),
                l = e("../../game/data/GameData"), o = e("../../sdkm/SDKManager"), r = function () {
                    function e() {
                        this.packageName = a.GameConst.packageName, this.mt = a.GameConst.Platform, this.apiversion = a.GameConst.Apiversion, this.version = a.GameConst.ClientVer, this.sessionID = ""
                    }

                    return Object.defineProperty(e, "Instance", {
                        get: function () {
                            return null === e._instance && (e._instance = new e), e._instance
                        }, enumerable: !0, configurable: !0
                    }), e.prototype.addTsParas = function (e, t) {
                        return e
                    }, e.prototype.loginUser = function (e) {
                        var t = Object.assign(e, {
                            packageName: this.packageName,
                            inviteCode: l.GameData.Instance.inviteCode || ""
                        });
                        return this.post("/login", t)
                    }, e.prototype.getUserInfo = function (e, t, n) {
                        return void 0 === e && (e = ""), void 0 === t && (t = 0), void 0 === n && (n = ""), this.get("/hd/userInfo", {
                            packageName: this.packageName,
                            kid: e || "",
                            isClick: t,
                            isvs: n
                        })
                    }, e.prototype.getRankeList = function (e) {
                        return void 0 === e && (e = 0), this.get("/hd/RankList", {packageName: this.packageName, type: e})
                    }, e.prototype.getAppConfig = function () {
                        return this.get("/hd/config", {packageName: this.packageName})
                    }, e.prototype.getCheckUpdate = function () {
                        return this.get("/checkUpdate", {})
                    }, e.prototype.getInviteaList = function () {
                        return this.get("/getInvitedList", {packageName: this.packageName})
                    }, e.prototype.setInviteState = function (e) {
                        return this.post("/inviteState", {packageName: this.packageName, id: e})
                    }, e.prototype.updateInfo = function (e) {
                        var t = Object.assign({packageName: this.packageName, gender: -1, sessionID: this.sessionID}, e);
                        return this.post("/hd/update/info", t)
                    }, e.prototype.updateUserInfo = function (e, t, n, a) {
                        return void 0 === t && (t = null), void 0 === n && (n = null), void 0 === a && (a = null), this.updateInfo({
                            nickName: e,
                            avatar: t,
                            gender: n,
                            city: a
                        })
                    }, e.prototype.updataGameData = function (e) {
                        var t = {b: l.GameData.Instance.gold.base, c: l.GameData.Instance.gold.power},
                            n = l.GameData.Instance.diamond, a = {b: l.GameData.Instance.playerScore, c: 1},
                            i = {b: l.GameData.Instance.MVPCount, c: 1}, o = l.GameData.Instance.cup,
                            r = l.GameData.Instance.playerScore, s = l.GameData.Instance.gradeHighKillNum || 0;
                        return this.updateInfo({
                            gamedata: e,
                            gold: t,
                            diamond: n,
                            cgold: a,
                            cpower: i,
                            militaryId: r,
                            plunderNum: s,
                            stage: o
                        })
                    }, e.prototype.getMsgInfo = function () {
                        return this.get("/msgInfo", {packageName: this.packageName})
                    }, e.prototype.postMsgInfo = function (e) {
                        return void 0 === e && (e = 1), this.post("/handleMsgInfo", {
                            packageName: this.packageName,
                            dayStatus: e
                        })
                    }, e.prototype.buildUrl = function (e) {
                        return a.GameConst.host + e
                    }, e.prototype.buildParas = function (e, t) {
                        var n = e;
                        return t && (n = Object.assign(e, {
                            sessionID: this.sessionID,
                            apiversion: this.apiversion,
                            version: this.version,
                            mt: this.mt
                        })), n
                    }, e.prototype.get = function (e, t, n) {
                        var i = this;
                        void 0 === t && (t = {}), void 0 === n && (n = !0);
                        var o = this.buildUrl(e), r = this.buildParas(t, n);
                        return new Promise(function (n, a) {
                            new s.HttpRequest(function (e, t) {
                                i.handleResult(e, t, n, a)
                            }).sendGet(o, r)
                        })
                    }, e.prototype.post = function (e, t, n) {
                        var i = this;
                        void 0 === t && (t = {}), void 0 === n && (n = !0);
                        var o = this.buildUrl(e), r = this.buildParas(t, n);
                        return new Promise(function (n, a) {
                            new s.HttpRequest(function (e, t) {
                                i.handleResult(e, t, n, a)
                            }).sendPostWithUrl(o, r)
                        })
                    }, e.prototype.handleResult = function (e, t, n, a) {
                        if (e) return o.SDKManager.Instance.report("NetworkError", {error: JSON.stringify(e)}), void a(e);
                        t.code === i.NetCode.OK ? n(t.result) : (o.SDKManager.Instance.report("NetworkError", {code: t.code}), a(t))
                    }, e._instance = null, e
                }();
            n.NetwrokManager = r
        }, {
            "../../conslt/GameConst": 8,
            "../../conslt/NetCode": 10,
            "../../game/data/GameData": 21,
            "../../sdkm/SDKManager": 42,
            "../network/HttpRequest": 19
        }],
        17: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../conslt/DResConfig"), i = e("./DEventManage"), o = e("../../conslt/DEvent"),
                r = e("../../conslt/GameConst"), s = e("../../sdkm/SDKManager"), l = e("../../conslt/ReporttType"),
                h = e("../../utils/fileParse/ZipLoader"), c = function () {
                    function e() {
                        this.loadingRes = !1, this.loaded = !1, this.loadResCallback = null, this.templet = null, this.bitmapFont = null, this.reset(), h.ZipFile.initZipLoader()
                    }

                    return Object.defineProperty(e, "Instance", {
                        get: function () {
                            return null == e._instance && (e._instance = new e), e._instance
                        }, enumerable: !0, configurable: !0
                    }), e.prototype.reset = function () {
                        this.loadingRes = !1, this.loaded = !1
                    }, e.prototype.loadRes = function (e) {
                        this.loadingRes || (this.loadResCallback = e, this.loadingRes = !0, this.loadAllRes())
                    }, e.prototype.onProgress = function (e) {
                        i.DEventManage.Instance.event(o.DEvent.ResLoadProgress, e)
                    }, e.prototype.onLoad = function () {
                        this.loadingRes = !1
                    }, e.prototype.onLoadResComplete = function () {
                        this.loadResCallback && this.loadResCallback.run(), this.loadingRes = !1, this.loaded = !0, this.sentResToOpenContext(), i.DEventManage.Instance.event(o.DEvent.StartLoadFinish), s.SDKManager.nodeReport(l.ReporttType.loadRes)
                    }, e.prototype.loadAllRes = function () {
                        "undefined" == typeof wx || r.GameConst.UseRemoteRes, this.loadGRes()
                    }, e.prototype.loadGRes = function () {
                        var e = a.default.getGameRes();
                        Laya.loader.load(e, Laya.Handler.create(this, this.onLoadResComplete), Laya.Handler.create(this, this.onProgress, null, !1), null, 1, !0)
                    }, e.prototype.onError = function () {
                    }, e.prototype.clear = function () {
                    }, e.prototype.sentResToOpenContext = function () {
                        Laya.Browser.onMiniGame
                    }, e._instance = null, e
                }();
            n.RescManager = c
        }, {
            "../../conslt/DEvent": 4,
            "../../conslt/DResConfig": 6,
            "../../conslt/GameConst": 8,
            "../../conslt/ReporttType": 11,
            "../../sdkm/SDKManager": 42,
            "../../utils/fileParse/ZipLoader": 52,
            "./DEventManage": 12
        }],
        18: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("./DEventManage"), i = e("../../conslt/DEvent"), o = e("../../conslt/DSound"), r = function () {
                function e() {
                    this.curBgmName = null, this.init(), a.DEventManage.Instance.on(i.DEvent.GetFocus, this, this.onGetFocus), a.DEventManage.Instance.on(i.DEvent.LostFocus, this, this.onLostFocus), this.curBgmName = null
                }

                return Object.defineProperty(e, "Instance", {
                    get: function () {
                        return null == e._instance && (e._instance = new e), e._instance
                    }, enumerable: !0, configurable: !0
                }), e.prototype.init = function () {
                    Laya.SoundManager.autoStopMusic = !1;
                    var e = Laya.LocalStorage.getItem("musicVolume"), t = 1;
                    null !== e && "" !== e && (t = parseFloat(e + "")), this.setMusicVolume(t), this.setMusicMute(0 == t);
                    var n = Laya.LocalStorage.getItem("soundVolume"), a = 1;
                    null !== n && "" !== n && (a = parseFloat(n)), this.setSoundVolume(a), this.setSoundMute(0 == a)
                }, e.prototype.onLostFocus = function () {
                    this.stopAll()
                }, e.prototype.onGetFocus = function () {
                    this.startAll()
                }, e.prototype.startAll = function () {
                    var e = this;
                    null != this.curBgmName && setTimeout(function () {
                        null != e.curBgmName && Laya.SoundManager.playMusic(e.curBgmName)
                    }, 1e3)
                }, e.prototype.playBgm = function () {
                }, e.prototype.playBattleBgm = function () {
                    this.curBgmName = o.DSound.people, this.playMusic(o.DSound.people)
                }, e.prototype.stopSound = function (e) {
                    Laya.SoundManager.stopSound(e)
                }, e.prototype.stopMusic = function () {
                    Laya.SoundManager.stopMusic()
                }, e.prototype.playUIClick = function () {
                    this.playSound(o.DSound.Button)
                }, e.prototype.playMusic = function (e) {
                    this.stopMusic(), Laya.SoundManager.playMusic(e)
                }, e.prototype.playSound = function (e, t, n) {
                    void 0 === t && (t = 1), Laya.SoundManager.soundMuted || Laya.SoundManager.playSound(e, t, n)
                }, e.prototype.playGameSound = function (e, t, n) {
                    if (void 0 === t && (t = 1), e && 0 !== e.length && !Laya.SoundManager.soundMuted) {
                        var a = "music/" + e;
                        Laya.SoundManager.playSound(a, t, n)
                    }
                }, e.prototype.setMusicMute = function (e) {
                    Laya.SoundManager.musicMuted = e
                }, e.prototype.isMusicMuted = function () {
                    return Laya.SoundManager.musicMuted
                }, e.prototype.setMusicVolume = function (e) {
                    Laya.SoundManager.setMusicVolume(e), Laya.LocalStorage.setItem("musicVolume", e)
                }, e.prototype.getMusicVolume = function () {
                    return Laya.SoundManager.musicVolume
                }, e.prototype.setSoundMute = function (e) {
                    Laya.SoundManager.soundMuted = e
                }, e.prototype.isSoundMuted = function () {
                    return Laya.SoundManager.soundMuted
                }, e.prototype.setSoundVolume = function (e) {
                    Laya.SoundManager.setSoundVolume(e), Laya.LocalStorage.setItem("soundVolume", e)
                }, e.prototype.getSoundVolume = function () {
                    return Laya.SoundManager.soundVolume
                }, e.prototype.stopAll = function () {
                    Laya.SoundManager.stopAll()
                }, e.prototype.stopAllSound = function () {
                    Laya.SoundManager.stopAllSound()
                }, e
            }();
            n.SoundtManager = r
        }, {"../../conslt/DEvent": 4, "../../conslt/DSound": 7, "./DEventManage": 12}],
        19: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var i = e("../../conslt/GlobalData"), a = function () {
                function e(e) {
                    this.httpCallback = null, this.url = "", this.httpCallback = e, this.url = "", this.http = new Laya.HttpRequest, this.http.once(Laya.Event.PROGRESS, this, this.onHttpRequestProgress), this.http.once(Laya.Event.COMPLETE, this, this.onHttpRequestComplete), this.http.once(Laya.Event.ERROR, this, this.onHttpRequestError)
                }

                return e.prototype.sendPost = function (e, t, n) {
                    var a = this.parsToStr(t);
                    this.url = e + "/" + n, this.http.send(this.url, a, "post", "json")
                }, e.prototype.sendGet = function (e, t) {
                    var n = this.parsToStr(t);
                    this.url = e + "?" + n, this.http.send(this.url, null, "get", "json")
                }, e.prototype.sendGetWithUrl = function (e) {
                    this.url = e, this.http.send(e, null, "get", "json")
                }, e.prototype.sendPostWithUrl = function (e, t, n) {
                    void 0 === n && (n = "json"), this.url = e, this.http.send(e, t, "post", n || "json")
                }, e.prototype.parsToStr = function (e) {
                    if (Array.isArray(t)) {
                        for (var t = "", n = 0; n < e.length; n++) t += e[n][0] + "=" + e[n][1], n < e.length - 1 && (t += "&");
                        return t
                    }
                    return this.parseParams(e)
                }, e.prototype.onHttpRequestProgress = function (e) {
                }, e.prototype.onHttpRequestComplete = function (e) {
                    if (this.httpCallback) {
                        var t = this.http;
                        if (t._http && t._http.getResponseHeader) {
                            var n = t._http.getResponseHeader("Date"), a = new Date(n).getTime();
                            0 < a && (i.GlobalData.severTime = a)
                        }
                        this.httpCallback(null, this.http.data)
                    }
                }, e.prototype.onHttpRequestError = function (e) {
                    this.httpCallback && this.httpCallback(e, null)
                }, e.prototype.parseParams = function (e) {
                    var t = "";
                    if (null != e) {
                        for (var n in e) t += n + "=" + e[n] + "&";
                        t = t.substring(0, t.length - 1)
                    }
                    return t
                }, e
            }();
            n.HttpRequest = a
        }, {"../../conslt/GlobalData": 9}],
        20: [function (e, t, n) {
            "use strict";
            var a;
            Object.defineProperty(n, "__esModule", {value: !0}), (a = n.OpenDataMessageType || (n.OpenDataMessageType = {})).showFriendRank = "showFriendRank", a.hideFriendRank = "hideFriendRank", a.showFriendRankNextPage = "showFriendRankNextPage", a.showFrientRnakPrevPage = "showFrientRnakPrevPage", a.updateGradeList = "updateGradeList", a.updataScoreInfo = "updataScoreInfo"
        }, {}],
        21: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../conslt/GlobalData"), o = e("./User"), r = e("../../utils/DateUtil"),
                s = e("../../conslt/GameConst"), l = e("../../conslt/DEvent"), h = e("../../core/managee/DEventManage"),
                c = e("../../core/managee/NetwrokManager"), d = e("../managre/DataManmager"), i = function () {
                    function i() {
                        this.inviteCode = null, this.headIconUrl = "", this.logined = !1, this.loginError = !1, this.successLoginCb = null, this.checkUpdateInfoTime = 0, this.updateInfoData = null, this.isReadData = !1, this.lastSendDataTime = 0, this.saveDataTime = 240, this.flushSaveDataTime = 20, this.treasureBoxKeyAddCount = 0, this.user = new o.User, this.headIconUrl = "", Laya.timer.loop(1e3 * this.flushSaveDataTime, this, this.doSaveGameData), h.DEventManage.Instance.on(l.DEvent.OverDayEvent, this, this.resetByOverDay)
                    }

                    return Object.defineProperty(i, "Instance", {
                        get: function () {
                            return null == i._instance && (i._instance = new i), i._instance
                        }, enumerable: !0, configurable: !0
                    }), i.prototype.checkUpdateInfo = function () {
                    }, i.prototype.resetByOverDay = function () {
                        var e = Laya.Browser.now();
                        this.user.playerInfo.login_date = e
                    }, i.prototype.doSaveGameData = function (e, t) {
                        if (void 0 === e && (e = !1), void 0 === t && (t = !1), this.isReadData) {
                            var n = t, a = Laya.Browser.now();
                            a - this.lastSendDataTime > 1e3 * this.saveDataTime && (this.lastSendDataTime = a, n = !0), n && (e = !0), Laya.timer.clear(this, this.realSaveData), e ? this.realSaveData(n, a) : Laya.timer.once(1e3, this, this.realSaveData, [n, a])
                        }
                    }, i.prototype.realSaveData = function (e, t) {
                        void 0 === e && (e = !1), void 0 === t && (t = 0), Laya.timer.clear(this, this.realSaveData);
                        var n = Laya.Browser.now();
                        if (this.user.playerInfo.save_time = n, this.user.playerInfo.ver = s.GameConst.ClientVer, this.user.saveToStorage(), s.GameConst.recoverData && e) {
                            var a = JSON.stringify(Object.assign({}, i.Instance.user.playerInfo));
                            c.NetwrokManager.Instance.updataGameData(a)
                        }
                    }, i.saveGameData = function (e, t) {
                        void 0 === e && (e = !1), void 0 === t && (t = !1), i.Instance.doSaveGameData(e, t)
                    }, i.prototype.readDataInfo = function (e) {
                        if (!this.isReadData) {
                            s.GameConst.recoverData || (e = null), this.user.isDefaultData && e && (this.user.playerInfo = Object.assign({}, e)), this.user.isDefaultData = !1, this.isReadData = !0;
                            var t = this.user.playerInfo.login_date;
                            !1 === r.DateUtil.isToday(t) && this.resetByOverDay(), this.doSaveGameData()
                        }
                    }, Object.defineProperty(i.prototype, "guideInfo", {
                        get: function () {
                            return this.user.playerInfo.guideInfo || (this.user.playerInfo.guideInfo = {
                                1: {
                                    curStep: 0,
                                    isGuided: !1
                                }, 2: {curStep: 0, isGuided: !1}, 3: {curStep: 0, isGuided: !1}
                            }), this.user.playerInfo.guideInfo
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "gold", {
                        get: function () {
                            return this.user.playerInfo.gold || (this.user.playerInfo.gold = 0), this.user.playerInfo.gold || 0
                        }, set: function (e) {
                            this.user.playerInfo.gold = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "diamond", {
                        get: function () {
                            return this.user.playerInfo.diamond || (this.user.playerInfo.diamond = 0), this.user.playerInfo.diamond || 0
                        }, set: function (e) {
                            this.user.playerInfo.diamond = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "playerInfo", {
                        get: function () {
                            return this.user && !this.user.playerInfo && (this.user.playerInfo = {}), this.user.playerInfo
                        }, enumerable: !0, configurable: !0
                    }), i.prototype.updateWithChangeData = function (e) {
                        if (this.playerInfo) {
                            var t = this.playerInfo;
                            for (var n in e) t[n] += e[n];
                            h.DEventManage.Instance.event(l.DEvent.PlayerGoodsUpdate), this.doSaveGameData()
                        }
                    }, Object.defineProperty(i.prototype, "gradeHighKillNum", {
                        get: function () {
                            return this.playerInfo.gradeHighKillNum || 0
                        }, set: function (e) {
                            this.playerInfo.gradeHighKillNum = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "gradeHighRankNum", {
                        get: function () {
                            return this.playerInfo.gradeHighRankNum || 0
                        }, set: function (e) {
                            this.playerInfo.gradeHighRankNum = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "pvpHighKillNum", {
                        get: function () {
                            return this.playerInfo.pvpHighKillNum || 0
                        }, set: function (e) {
                            this.playerInfo.pvpHighKillNum = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "pvpHighRankNum", {
                        get: function () {
                            return this.playerInfo.pvpHighRankNum || 0
                        }, set: function (e) {
                            this.playerInfo.pvpHighRankNum = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "playerScore", {
                        get: function () {
                            return this.playerInfo.playerScore || 0
                        }, set: function (e) {
                            this.playerInfo.playerScore = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "hasShowIntro", {
                        get: function () {
                            return this.playerInfo.hasShowIntro || !1
                        }, set: function (e) {
                            this.playerInfo.hasShowIntro = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "skinLevelData", {
                        get: function () {
                            return this.playerInfo.skinLevelData || {}
                        }, set: function (e) {
                            this.playerInfo.skinLevelData = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "skinData", {
                        get: function () {
                            return this.playerInfo.skinData || {}
                        }, set: function (e) {
                            this.playerInfo.skinData = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "usingSkinID", {
                        get: function () {
                            return this.playerInfo.usingSkinID || 0
                        }, set: function (e) {
                            this.playerInfo.usingSkinID = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "MVPCount", {
                        get: function () {
                            return this.playerInfo.mvpCount
                        }, set: function (e) {
                            this.playerInfo.mvpCount = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "showLoginGift", {
                        get: function () {
                            return this.playerInfo.showLoginGift || !1
                        }, set: function (e) {
                            this.playerInfo.showLoginGift = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "isFirstPlay", {
                        get: function () {
                            return !1 !== this.playerInfo.isFirstPlay && (0 < this.playerInfo.playerScore || !a.GlobalData.isNewPlayer ? this.playerInfo.isFirstPlay = !1 : this.playerInfo.isFirstPlay = !0), this.playerInfo.isFirstPlay
                        }, set: function (e) {
                            this.playerInfo.isFirstPlay = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "treasureBoxCount", {
                        get: function () {
                            return Math.floor(this.treasureBoxCount / 100).toFixed(0)
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "treasureBoxKeyCount", {
                        get: function () {
                            return this.playerInfo.treasureBoxKeyCount || 0
                        }, set: function (e) {
                            this.playerInfo.treasureBoxKeyCount = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "battleCount", {
                        get: function () {
                            return this.playerInfo.battleCount || 0
                        }, set: function (e) {
                            this.playerInfo.battleCount = e || 0
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "cup", {
                        get: function () {
                            return this.playerInfo.cup || 0
                        }, set: function (e) {
                            this.playerInfo.cup = e
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "gradeCfg", {
                        get: function () {
                            return d.DataManmager.Instance.getUserGradeCfg(this.cup)
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(i.prototype, "gradeProgressInfo", {
                        get: function () {
                            return d.DataManmager.Instance.calcGradeProgressInfo(this.cup)
                        }, enumerable: !0, configurable: !0
                    }), i.prototype.getAttributeInfo = function (e) {
                        return (this.playerInfo.attributeInfo || [])[e] || {lv: 0, videoNum: 0, videoLastLv: 0}
                    }, i.prototype.setAttributeInfo = function (e, t) {
                        var n = this.playerInfo.attributeInfo || [];
                        n[e] = t, this.playerInfo.attributeInfo = n
                    }, i._instance = null, i
                }();
            n.GameData = i
        }, {
            "../../conslt/DEvent": 4,
            "../../conslt/GameConst": 8,
            "../../conslt/GlobalData": 9,
            "../../core/managee/DEventManage": 12,
            "../../core/managee/NetwrokManager": 16,
            "../../utils/DateUtil": 48,
            "../managre/DataManmager": 26,
            "./User": 22
        }],
        22: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../conslt/GameConst"), i = function () {
                this.soldierLevel = 0, this.tenSoldierNum = 0
            };
            n.SoldierLevelInfo = i;
            var o = function () {
                function e() {
                    this.uid = 0, this.nickName = "", this.avatar = "", this.token = "", this.session_key = "", this.openid = "", this.authorized = !1, this.city = "", this.gender = 0, this.playerInfo = {}, this.isDefaultData = !0
                }

                return e.prototype.setUid = function (e) {
                    this.uid = e
                }, e.prototype.loadCacheData = function () {
                    if (a.GameConst.recoverData) e = Laya.LocalStorage.getJSON("user_" + this.uid); else var e = Laya.LocalStorage.getJSON("user_r_" + this.uid);
                    if (null == e || "" == e) return !1;
                    for (var t in this.isDefaultData = !1, e) this[t] = e[t];
                    return !0
                }, e.prototype.saveToStorage = function () {
                    a.GameConst.recoverData ? Laya.LocalStorage.setJSON("user_" + this.uid, this) : Laya.LocalStorage.setJSON("user_r_" + this.uid, this)
                }, e.prototype.resumePlayerInfoDefault = function () {
                    this.playerInfo = {diamond: 0, gold: 0}
                }, e.prototype.getPlayerInfo = function () {
                    return this.playerInfo
                }, e
            }();
            n.User = o
        }, {"../../conslt/GameConst": 8}],
        23: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function (r) {
                function p(e, t, n, a, i) {
                    var o = r.call(this) || this;
                    return o._InitX = 0, o._InitY = 0, o.touchId = -1, o.radius = 100, o._curPos = null, o._lastStageX = 0, o._lastStageY = 0, o._startStageX = 0, o._startStageY = 0, o._tweener = null, o._view = e, o._button = t, o._button.changeStateOnClick = !1, o._thumb = n, o._touchArea = a, o._center = i, o._InitX = o._center.x + o._center.width / 2, o._InitY = o._center.y + o._center.height / 2, o.touchId = -1, o.radius = 100, o._curPos = new laya.maths.Point, o._touchArea.on(laya.events.Event.MOUSE_DOWN, o, o.onTouchDown), o._touchArea.on(laya.events.Event.MOUSE_OUT, o, o.OnMouseOut), o
                }

                return __extends(p, r), p.prototype.Trigger = function (e) {
                    this.onTouchDown(e)
                }, p.prototype.onTouchDown = function (e) {
                    if (-1 == this.touchId) {
                        this.touchId = e.touchId, null != this._tweener && (this._tweener.clear(), this._tweener = null);
                        var t = Laya.stage.mouseX, n = Laya.stage.mouseY;
                        this._button.selected = !0, t < this._touchArea.x ? t = this._touchArea.x : t > this._touchArea.width && (t = this._touchArea.width), n > Laya.stage.height ? n = Laya.stage.height : n < this._touchArea.y && (n = this._touchArea.y), this._lastStageX = t, this._lastStageY = n, this._startStageX = t, this._startStageY = n, this._center.visible = !0, this._center.x = t - this._center.width / 2, this._center.y = n - this._center.height / 2, this._button.x = t - this._button.width / 2, this._button.y = n - this._button.height / 2;
                        var a = t - this._InitX, i = n - this._InitY, o = 180 * Math.atan2(i, a) / Math.PI;
                        this._thumb.rotation = o + 90, Laya.stage.on(laya.events.Event.MOUSE_MOVE, this, this.OnTouchMove), Laya.stage.on(laya.events.Event.MOUSE_UP, this, this.OnTouchUp), Laya.stage.on(laya.events.Event.MOUSE_OUT, this, this.OnMouseOut)
                    }
                }, p.prototype.OnTouchUp = function (e) {
                    -1 != this.touchId && e.touchId == this.touchId && this.resetJoystick()
                }, p.prototype.OnTouchMove = function (e) {
                    if (-1 != this.touchId && e.touchId == this.touchId) {
                        var t = Laya.stage.mouseX, n = Laya.stage.mouseY, a = t - this._lastStageX,
                            i = n - this._lastStageY;
                        this._lastStageX = t, this._lastStageY = n;
                        var o = this._button.x + a, r = this._button.y + i,
                            s = o + this._button.width / 2 - this._startStageX,
                            l = r + this._button.height / 2 - this._startStageY, h = Math.atan2(l, s),
                            c = 180 * h / Math.PI;
                        this._thumb.rotation = c + 90;
                        var d = this.radius * Math.cos(h), u = this.radius * Math.sin(h);
                        Math.abs(s) > Math.abs(d) && (s = d), Math.abs(l) > Math.abs(u) && (l = u), (o = this._startStageX + s) < 0 && (o = 0), (r = this._startStageY + l) > Laya.stage.height && (r = Laya.stage.height), this._button.x = o - this._button.width / 2, this._button.y = r - this._button.height / 2, this.event(p.JoystickMoving, c)
                    }
                }, p.prototype.OnMouseOut = function (e) {
                    -1 != this.touchId && e.touchId == this.touchId && this.resetJoystick()
                }, p.prototype.resetJoystick = function () {
                    this.touchId = -1, this._thumb.rotation = this._thumb.rotation + 180, this._center.visible = !1, this._tweener = laya.utils.Tween.to(this._button, {
                        x: this._InitX - this._button.width / 2,
                        y: this._InitY - this._button.height / 2
                    }, 300, laya.utils.Ease.circOut, laya.utils.Handler.create(this, function () {
                        this._tweener = null, this._button.selected = !1, this._thumb.rotation = 0, this._center.x = this._InitX - this._center.width / 2, this._center.y = this._InitY - this._center.height / 2
                    })), Laya.stage.off(laya.events.Event.MOUSE_MOVE, this, this.OnTouchMove), Laya.stage.off(laya.events.Event.MOUSE_UP, this, this.OnTouchUp), Laya.stage.off(laya.events.Event.MOUSE_OUT, this, this.OnMouseOut), this.event(p.JoystickUp)
                }, p.prototype.clear = function () {
                    Laya.stage.off(laya.events.Event.MOUSE_MOVE, this, this.OnTouchMove), Laya.stage.off(laya.events.Event.MOUSE_UP, this, this.OnTouchUp), Laya.stage.off(laya.events.Event.MOUSE_OUT, this, this.OnMouseOut), this._touchArea.off(laya.events.Event.MOUSE_DOWN, this, this.onTouchDown), this._touchArea.off(laya.events.Event.MOUSE_OUT, this, this.OnMouseOut)
                }, p.JoystickMoving = "JoystickMoving", p.JoystickUp = "JoystickUp", p
            }(laya.events.EventDispatcher);
            n.JoystickModule = a
        }, {}],
        24: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a, i, o = e("../data/GameData"), r = e("../../sdkm/SDKManager"), s = e("./GameShaereManager");
            (i = a = n.AttributeType || (n.AttributeType = {}))[i.speed = 0] = "speed", i[i.power = 1] = "power", i[i.growup = 2] = "growup";
            var l = function () {
                function e() {
                    this.speedCfg = {
                        m_name: "移动速度",
                        m_start: 100,
                        m_step: 6,
                        m_startMoney: 200,
                        m_stepMoney: 200,
                        m_maxLv: 100
                    }, this.powerCfg = {
                        m_name: "力量",
                        m_start: 100,
                        m_step: 5,
                        m_startMoney: 300,
                        m_stepMoney: 300,
                        m_maxLv: 100
                    }, this.growupCfg = {
                        m_name: "成长速度",
                        m_start: 100,
                        m_step: 4,
                        m_startMoney: 400,
                        m_stepMoney: 400,
                        m_maxLv: 100
                    }
                }

                return Object.defineProperty(e, "Instance", {
                    get: function () {
                        return null === e._instance && (e._instance = new e), e._instance
                    }, enumerable: !0, configurable: !0
                }), e.prototype.getAttributeCfg = function (e) {
                    var t = o.GameData.Instance.getAttributeInfo(e), n = null;
                    return e == a.speed ? n = this.getAttrInfo(this.speedCfg, t.lv) : e == a.power ? n = this.getAttrInfo(this.powerCfg, t.lv) : e == a.growup && (n = this.getAttrInfo(this.growupCfg, t.lv)), n
                }, e.prototype.getAttrInfo = function (e, t) {
                    var n = t + 1;
                    n < 1 && (n = 1), n > e.m_maxLv && (n = e.m_maxLv);
                    var a = n >= e.m_maxLv;
                    return {
                        attrLv: "Lv." + (a ? "Max" : n),
                        attrName: e.m_name,
                        attrValue: e.m_start + n * e.m_step + "%",
                        buyCoin: e.m_startMoney + (n - 1) * e.m_stepMoney,
                        showVideo: !(s.GameShaereManager.Instance.wxCheck() || !r.SDKManager.Instance.hasOpenAD()) && (0 < t && t % 3 == 0),
                        isMax: a
                    }
                }, e.prototype.addAttributeCfg = function (e, t) {
                    void 0 === t && (t = !1);
                    var n = o.GameData.Instance.getAttributeInfo(e);
                    n.lv += 1, t && (n.videoNum += 1, n.videoLastLv = n.lv), o.GameData.Instance.setAttributeInfo(e, n)
                }, e.prototype.getAttrAddition = function (e) {
                    var t = o.GameData.Instance.getAttributeInfo(e), n = this.speedCfg;
                    return e == a.speed ? n = this.speedCfg : e == a.power ? n = this.powerCfg : e == a.growup && (n = this.growupCfg), (t.lv * n.m_step + n.m_start) / 100
                }, e._instance = null, e
            }();
            n.AttributeManager = l
        }, {"../../sdkm/SDKManager": 42, "../data/GameData": 21, "./GameShaereManager": 28}],
        25: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var i = e("../data/GameData"), o = e("../../conslt/GameConst"), r = e("../../conslt/DEvent"),
                s = e("../../sdkm/SDKManager"), l = e("../../conslt/ReporttType"),
                h = e("../../core/managee/NetwrokManager"), c = e("../../core/managee/DEventManage"),
                d = e("../conslt/OpenDataMessageType"), a = function () {
                    function e() {
                        this.sdkParams = null
                    }

                    return Object.defineProperty(e, "Instance", {
                        get: function () {
                            return null === e._instance && (e._instance = new e), e._instance
                        }, enumerable: !0, configurable: !0
                    }), e.prototype.clear = function () {
                    }, e.prototype.sdkLogin = function (e, n) {
                        var a = this;
                        h.NetwrokManager.Instance.loginUser(e).then(function (e) {
                            var t = e.sessionID;
                            if (t) return i.GameData.Instance.user.session_key = t, h.NetwrokManager.Instance.sessionID = t, o.GameConst.isLimitCity = e.isL || !1, o.GameConst.isLimitCityB = e.isLB || !1, o.GameConst.closeLD = e.closeLD || !1, o.GameConst.bTimer = e.bTimer || o.GameConst.bTimer, o.GameConst.bCount = e.bCount || o.GameConst.bCount, o.GameConst.isF = e.isF || !1, s.SDKManager.IsTouTiao() && (o.GameConst.closeLD = !0), s.SDKManager.Instance.report(l.ReporttType.Login), a.updateUserInfo(n)
                        }).then(function (e) {
                            i.GameData.Instance.logined = !0, c.DEventManage.Instance.event(r.DEvent.userLoginFinish, {
                                logined: !0,
                                caller: n
                            })
                        }).catch(function (e) {
                            i.GameData.Instance.logined || (i.GameData.Instance.loginError = !0, s.SDKManager.Instance.report(l.ReporttType.LoginFail, {}), c.DEventManage.Instance.event(r.DEvent.userLoginFinish, {
                                logined: !1,
                                caller: n
                            }))
                        })
                    }, e.prototype.updateUserInfo = function (e) {
                        return void 0 === e && (e = null), h.NetwrokManager.Instance.getUserInfo().then(function (e) {
                            var t = e.uid;
                            if (t) {
                                var n = i.GameData.Instance.user;
                                if (n.resumePlayerInfoDefault(), n.setUid(t), n.loadCacheData(), n.openid = e.openid, n.city = e.city, n.avatar = e.avatar, n.nickName = e.nickName, n.gender = e.gender, s.SDKManager.IsTouTiao() && o.GameConst.isAnonymous && (n.avatar = "https://game.lexun99.com/sanguo/game/head/timg5.png", n.nickName = "玩家"), n.authorized = e.authorized, n.authorized && c.DEventManage.Instance.event(r.DEvent.DestoryUserInfoButton), i.GameData.Instance.checkUpdateInfo(), e.openid && "undefined" != typeof wx && s.SDKManager.IsWeChat(), !i.GameData.Instance.isReadData) if (n.isDefaultData) {
                                    var a = null;
                                    e.gamedata && (a = JSON.parse(e.gamedata)), i.GameData.Instance.readDataInfo(a)
                                } else i.GameData.Instance.readDataInfo(null);
                                s.SDKManager.Instance.postToOpenDataMessage(d.OpenDataMessageType.updataScoreInfo, {
                                    score: i.GameData.Instance.playerScore,
                                    mvpCount: i.GameData.Instance.MVPCount
                                }), c.DEventManage.Instance.event(r.DEvent.UserInfoChange)
                            }
                        })
                    }, e._instance = null, e
                }();
            n.DServeManager = a
        }, {
            "../../conslt/DEvent": 4,
            "../../conslt/GameConst": 8,
            "../../conslt/ReporttType": 11,
            "../../core/managee/DEventManage": 12,
            "../../core/managee/NetwrokManager": 16,
            "../../sdkm/SDKManager": 42,
            "../conslt/OpenDataMessageType": 20,
            "../data/GameData": 21
        }],
        26: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var c = e("../../core/managee/LocalStorgeMananger"), r = e("../../conslt/DResConfig"),
                a = e("../utils/GameUtils"), i = e("../../core/managee/DEventManage"), s = e("../../conslt/DEvent"),
                l = e("../../conslt/GameConst"), h = e("../../sdkm/SDKManager"), d = e("../../conslt/GlobalData"),
                u = e("../../utils/MathUtil"), p = e("../conslt/OpenDataMessageType"), g = e("../data/GameData"),
                m = e("./AttributeManager"), o = function () {
                    function o() {
                        this.skinCfg = null, this.videoCfgData = null, this.bannerCfgData = null, this.signCfgData = {}, this.randomBannerCfgData = null, this.signRed = !0, this.playerCfgData = null, this.ainameCfgData = {}, this.userGradeCfgData = {}, this.signDaynfo = "signDaynfo", this.maxUserGrade = 0, this.m_switchMapCount = 0, this.prefabsPath = {}, this.modelConfig = {}, this.fightSetting = {}, this.map = {}, this.specialBattleGood = {}, this.maxLoadGoodsNum = 50, this.roleLevelData = {}, this.aiProperty = {}, this.roleGrow = {}, this.gCfg = {}, this.fightRoles = {}, this.fightRoleList = [], this.loadData(), this.signRed = !this.todayIsSigned(), this.m_switchMapCount = u.default.getRandom(1, 2), Laya.timer.loop(1e4, this, this.checkOverDay)
                    }

                    return Object.defineProperty(o, "Instance", {
                        get: function () {
                            return null === o._instance && (o._instance = new o), o._instance
                        }, enumerable: !0, configurable: !0
                    }), o.prototype.loadData = function () {
                        var e = r.default.RES_GAME_DATA;
                        l.GameConst.UseRemoteRes && (e = "/" + e);
                        var t = Laya.loader.getRes(e), n = this.processData(t || "");
                        if (n) {
                            if (this.videoCfgData = n.videoShareCfg, this.bannerCfgData = n.bannerCfg, this.signCfgData = n.sign, this.bannerCfgData && this.bannerCfgData.length) for (var a in this.randomBannerCfgData = [], this.bannerCfgData) {
                                var i = this.bannerCfgData[a];
                                this.randomBannerCfgData.push(i)
                            }
                            this.skinCfg = n.skinCfg, this.playerCfgData = n.player, this.ainameCfgData = n.aiName, this.userGradeCfgData = n.userGrade, this.prefabsPath = n.prefabsPath, this.modelConfig = n.modelConfig, this.fightSetting = n.fightSetting, this.specialBattleGood = n.battleGood, this.map = n.map, this.aiProperty = n.aiProperty, this.roleLevelData = n.roleLevel, this.gCfg = n.gCfg, o.roleModelID = this.gCfg.dinsModelID, o.humanModelID = this.gCfg.manModelID, h.SDKManager.Instance.postToOpenDataMessage(p.OpenDataMessageType.updateGradeList, this.userGradeCfgData)
                        }
                        Laya.Loader.clearRes(e), this.init()
                    }, o.prototype.init = function () {
                        u.default.initSinCosVal()
                    }, o.prototype.getVideoShareCfg = function (e) {
                        if (null == this.videoCfgData) return null;
                        for (var t = 0; t < this.videoCfgData.length; t++) if (this.videoCfgData[t].pos == e) return this.videoCfgData[t];
                        return null
                    }, o.prototype.getBannerCfg = function (e) {
                        if (null == this.bannerCfgData) return null;
                        for (var t = 0; t < this.bannerCfgData.length; t++) if (this.bannerCfgData[t].pos == e) return this.bannerCfgData[t];
                        return null
                    }, o.prototype.saveAutoShowSign = function () {
                        var e = c.LocalStorgeMananger.getDataValue(this.signDaynfo) || {}, t = (new Date).getDate();
                        e.showDay = t, c.LocalStorgeMananger.setDataValue(this.signDaynfo, e)
                    }, o.prototype.doSignAction = function () {
                        var e = c.LocalStorgeMananger.getDataValue(this.signDaynfo);
                        if (e) {
                            var t = new Date, n = e.signDay + 1;
                            e.signDay = n;
                            var a = t.getTime();
                            e.ts = a
                        }
                        this.signRed = !1, c.LocalStorgeMananger.setDataValue(this.signDaynfo, e)
                    }, o.prototype.getSignDayInfo = function () {
                        var e = 0, t = 0, n = c.LocalStorgeMananger.getDataValue(this.signDaynfo), a = !1, i = new Date,
                            o = i.getDate(), r = 0, s = 0;
                        if (n) {
                            if (t = n.showDay, s = n.ts, a = !0, 0 < n.ts) {
                                var l = new Date;
                                if (l.setTime(n.ts), i.getTime() < n.ts + 864e5 && o == l.getDate()) r = 1, e = n.signDay, a = !1; else (l = new Date).setTime(n.ts + 864e5), o == l.getDate() && (e = n.signDay, a = !1)
                            }
                        } else a = !0;
                        a && ((n = {}).signDay = e, n.showDay = t, n.ts = s, c.LocalStorgeMananger.setDataValue(this.signDaynfo, n));
                        var h = {signDay: e, signed: r, show: o == t ? 1 : 0};
                        return this.signRed = !r, h
                    }, o.prototype.processData = function (e) {
                        var t = this.uncompile(e);
                        return JSON.parse(t)
                    }, o.prototype.uncompile = function (e) {
                        for (var t = String.fromCharCode(e.charCodeAt(0) - 1), n = 1; n < e.length; n++) t += String.fromCharCode(e.charCodeAt(n) - 1);
                        return t
                    }, o.prototype.checkOverDay = function () {
                        a.GameUtils.checkOverDay() && i.DEventManage.Instance.event(s.DEvent.OverDayEvent)
                    }, o.prototype.getRandomBannerCfg = function () {
                        var e = this.randomBannerCfgData.length, t = Math.floor(Math.random() * (e - 1));
                        if (0 <= t && t < e) {
                            var n = this.randomBannerCfgData[t];
                            if (n && n.adunit && n.adunit.length) return this.randomBannerCfgData.splice(t, 1), this.randomBannerCfgData.push(n), n
                        }
                        return null
                    }, o.prototype.isOverSeverTime = function (e) {
                        if (void 0 === e && (e = 7200), 0 < d.GlobalData.severTime) {
                            var t = (new Date).getTime();
                            if (Math.abs(t - d.GlobalData.severTime) < 1e3 * e) return !1
                        }
                        return !0
                    }, o.prototype.todayIsSigned = function () {
                        return 0 < this.getSignDayInfo().signed
                    }, o.prototype.getAIPlayerInfo = function (e) {
                        return 0 <= e && e < this.ainameCfgData.length ? this.ainameCfgData[e] : null
                    }, o.prototype.getAINameCount = function () {
                        return null == this.ainameCfgData ? 0 : this.ainameCfgData.length
                    }, o.prototype.getFightRole = function (e) {
                        return this.fightRoles[e]
                    }, o.prototype.getRoleSkinId = function () {
                        return o.roleModelID
                    }, o.prototype.getSpeed = function () {
                        return .5 * (m.AttributeManager.Instance.getAttrAddition(m.AttributeType.speed) || 1)
                    }, o.prototype.getScore = function () {
                        return m.AttributeManager.Instance.getAttrAddition(m.AttributeType.growup) || 1
                    }, o.prototype.setFightRoles = function (e, t) {
                        var n = this;
                        this.fightSetting[e];
                        this.fightRoles = {}, this.fightRoleList = [], this.fightRoleList.push({
                            id: o.roleNodeID,
                            name: g.GameData.Instance.user.nickName,
                            head: g.GameData.Instance.user.avatar,
                            isUser: !0,
                            modal: this.getModel()
                        }), t.forEach(function (e, t) {
                            n.fightRoleList.push({
                                id: o.roleNodeID + t + 1,
                                name: e.name,
                                head: e.head,
                                isUser: !1,
                                modal: 0
                            })
                        }), this.fightRoleList.forEach(function (e) {
                            n.fightRoles[e.id] = e
                        })
                    }, o.prototype.getFightRoleList = function () {
                        return this.fightRoleList
                    }, o.prototype.getModel = function () {
                        return 0
                    }, o.prototype.getUserGradeCfg = function (e) {
                        var t = this.calcGradeByCup(e);
                        return this.userGradeCfgData[t]
                    }, o.prototype.calcGradeByCup = function (e) {
                        for (var t = 0, n = 0; n < this.userGradeCfgData.length; n++) {
                            if (e < this.userGradeCfgData[n].cup) {
                                t = n - 1;
                                break
                            }
                        }
                        return Math.max(0, t)
                    }, o.prototype.getMaxUserGrade = function () {
                        return this.userGradeCfgData.length || 0
                    }, o.prototype.calcGradeProgressInfo = function (e) {
                        var t = this.calcGradeByCup(e);
                        return {count: e, total: this.getCupByGrade(t + 1)}
                    }, o.prototype.getCupByGrade = function (e) {
                        return 0 <= e && e <= this.getMaxUserGrade() ? this.userGradeCfgData[e].cup : 0
                    }, o.prototype.isOverGrade = function (e) {
                        return e >= this.getMaxUserGrade()
                    }, o.prototype.calcGradeProgress = function (e) {
                        var t = this.calcGradeProgressInfo(e);
                        return t ? t.count / t.total : 0
                    }, o.prototype.nextCupForGrade = function (e) {
                        var t = e + 1;
                        return this.getCupByGrade(t)
                    }, o.EnergyBallPoolSign = "EnergyBall", o.EnergyBallPoolSignFromPlayer = "EnergyBallFromPlayer", o.BallActorPoolSign = "BallActor", o.BallActorPoolSignFromPlayer = "BallActorPoolSignFromPlayer", o.PlayerActorPoolSign = "PlayerActor", o.BulletActorPoolSign = "BulletActor", o.BulletPoolSign = "Bullet", o.PlayerPoolSign = "Player", o.SkillBallPoolSign = "SkillBall", o.SkillBallActorPoolSign = "SkillBallActor", o.roleNodeID = 100, o.roleConfigNum = 0, o.roleModelID = 20011, o.humanModelID = 20024, o.allMap = !1, o.goodsScale = 1, o.sceneRange = 4, o.moveSpeedUp = 1, o.cameraRotation = [-55, 90, 0], o.animName = {
                        SHOW: "show",
                        MOVE: "move"
                    }, o.isLarger = !1, o.buffs = {SPEED_UP: 1, ENERGY_UP: 2}, o.roleReliveType = {
                        INIT: 0,
                        CONTINUE: 1
                    }, o._instance = null, o
                }();
            n.DataManmager = o
        }, {
            "../../conslt/DEvent": 4,
            "../../conslt/DResConfig": 6,
            "../../conslt/GameConst": 8,
            "../../conslt/GlobalData": 9,
            "../../core/managee/DEventManage": 12,
            "../../core/managee/LocalStorgeMananger": 15,
            "../../sdkm/SDKManager": 42,
            "../../utils/MathUtil": 49,
            "../conslt/OpenDataMessageType": 20,
            "../data/GameData": 21,
            "../utils/GameUtils": 39,
            "./AttributeManager": 24
        }],
        27: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../data/GameData"), i = e("../../core/managee/DUIManager"),
                o = e("../../core/managee/DEventManage"), r = e("../../conslt/DEvent"),
                s = e("../../conslt/DIUIConfig"), h = e("./DataManmager"), l = e("../utils/GameUtils"),
                c = e("../../utils/MathUtil"), d = e("../../core/managee/GameRecodrderManager"),
                u = e("../model/GameScene"), p = e("../model/PlayerCameraControl"),
                g = e("../../core/managee/SoundtManager"), m = e("../../conslt/DSound"), f = function () {
                    function e() {
                        this.isMobile = !0, this.battleCnt = 0, this.battleCntDay = 0, this.isInBattle = !1, this.showAdCount = 0, this.curScene = null, this.mainRole = null, this.time = 0, this.lastTime = 0, this.fightId = 0, this.fightConfig = null, this.specRelive = !1, this.videoRelive = 0, this.moveCtrs = [], this.moveCtrCnt = 0, this.performCtrs = [], this.performCtrCnt = 0, this.initPos = [], this.playerCameraCtr = null, this.playerCount = 0, this.boomWallSprite = null, this.eatPeopleSprite = null, this.killDinSprite = null, this.levelUpSprite = null, this.usedAINames = [], this.aiPlayerInfos = [], this.isGamePause = !1, this.matchFinish = !1, this.loadFightResFinish = !1, this.gameTime = 120, this.getGameMode = function () {
                            return this.gameMode
                        }, this.reset(), this.init()
                    }

                    return Object.defineProperty(e, "Instance", {
                        get: function () {
                            return null === e._instance && (e._instance = new e), e._instance
                        }, enumerable: !0, configurable: !0
                    }), e.prototype.init = function () {
                        var t = this;
                        this.isMobile = l.GameUtils.onMobile(), this.registerEvent(), Laya.Sprite3D.load("res/scene/KillParticle.lh", Laya.Handler.create(this, function (e) {
                            t.eatPeopleSprite = e.getChildByName("KillParticle_people"), t.eatPeopleSprite.active = !1, t.killDinSprite = e.getChildByName("KillParticle"), t.killDinSprite.active = !1, t.levelUpSprite = e.getChildByName("LevelUp"), t.levelUpSprite.active = !1, t.boomWallSprite = e.getChildByName("BoomWall"), t.boomWallSprite.active = !1
                        }))
                    }, e.prototype.registerEvent = function () {
                        o.DEventManage.Instance.on(r.DEvent.GetFocus, this, this.onGetFocus), o.DEventManage.Instance.on(r.DEvent.LostFocus, this, this.onLostFocus), o.DEventManage.Instance.on(r.DEvent.onGameDestory, this, this.gameOver), o.DEventManage.Instance.on(r.DEvent.BattleMatchSuccess, this, this.onMatchSuccess), o.DEventManage.Instance.on(r.DEvent.loadMapFinish, this, this.onMapFinish), o.DEventManage.Instance.on(r.DEvent.gameStartCDEnd, this, this.startGame), o.DEventManage.Instance.on(r.DEvent.kill, this, this.onPlayerKilled)
                    }, e.prototype.unregisterEvent = function () {
                        o.DEventManage.Instance.off(r.DEvent.GetFocus, this, this.onGetFocus), o.DEventManage.Instance.off(r.DEvent.LostFocus, this, this.onLostFocus), o.DEventManage.Instance.off(r.DEvent.onGameDestory, this, this.gameOver), o.DEventManage.Instance.off(r.DEvent.BattleMatchSuccess, this, this.onMatchSuccess), o.DEventManage.Instance.off(r.DEvent.loadMapFinish, this, this.onMapFinish), o.DEventManage.Instance.off(r.DEvent.gameStartCDEnd, this, this.startGame), o.DEventManage.Instance.off(r.DEvent.kill, this, this.onPlayerKilled)
                    }, e.prototype.onGetFocus = function () {
                        Laya.timer.scale = 1
                    }, e.prototype.onLostFocus = function () {
                        Laya.timer.scale = 0
                    }, e.prototype.reset = function () {
                        this.battleCnt = 0, this.battleCntDay = 0, this.isInBattle = !1, this.showAdCount = 0
                    }, Object.defineProperty(e.prototype, "user", {
                        get: function () {
                            return a.GameData.Instance.user
                        }, enumerable: !0, configurable: !0
                    }), e.prototype.setGamePause = function (e) {
                        (this.isGamePause = e) ? d.GameRecodrderManager.Instance.pause() : d.GameRecodrderManager.Instance.resume()
                    }, e.prototype.clear = function () {
                        !1 !== this.isInBattle && this.clearData()
                    }, e.prototype.clearData = function () {
                        this.isInBattle = !1, this.showAdCount = 0
                    }, e.collect = function () {
                        "undefined" != typeof wx && wx.triggerGC()
                    }, e.prototype.prepareStartGame = function (e) {
                        l.GameUtils.clearDictionary(this.usedAINames), this.aiPlayerInfos.length = 0, this.loadFightResFinish = !1, this.matchFinish = !1, this.resetData(e), this.createScene(this.onSceneLoaded.bind(this))
                    }, e.prototype.onSceneLoaded = function () {
                        var e = this;
                        this.createCamera(), this.createPlayer(function () {
                            e.createBattleInfoUI()
                        })
                    }, e.prototype.createBattleInfoUI = function () {
                        i.DUIManager.Instance.openUI(s.DIUIConfig.Match)
                    }, e.prototype.onMatchSuccess = function () {
                        this.matchFinish = !0, this.onBattleUIComplete()
                    }, e.prototype.onMapFinish = function () {
                        this.loadFightResFinish = !0, this.onBattleUIComplete()
                    }, e.prototype.onBattleUIComplete = function () {
                        this.loadFightResFinish && this.matchFinish && (this.curScene.scene.visible = !0, this.curScene.floor.setActive(!0), i.DUIManager.Instance.toUI(s.DIUIConfig.Game, null), i.DUIManager.Instance.createUI(s.DIUIConfig.Revive, {}, !1), this.startGameCd())
                    }, e.prototype.startGameCd = function () {
                        d.GameRecodrderManager.Instance.start(300), this.updatePerform(), this.loop()
                    }, e.prototype.startGame = function () {
                        this.curScene.spwanHumanForRole(), this.isGamePause = !1, this.lastTime = 0, this.time = 0, Laya.timer.loop(1, this, this.loop)
                    }, e.prototype.resetData = function (e) {
                        this.fightId = e, this.fightConfig = h.DataManmager.Instance.fightSetting[e], this.specRelive = !1, this.moveCtrs = [], this.moveCtrCnt = 0, this.performCtrs = [], this.performCtrCnt = null, this.initPos = [];
                        for (var t = this.fightConfig.bornPoint, n = 0; n < t.length; n += 2) this.initPos.push([t[n], t[n + 1]]);
                        var a = [], i = this.generateAIPlayerList(this.fightConfig.aiNum);
                        for (n = 0; n < this.fightConfig.aiNum; n++) a.push({head: i[n].avatar, name: i[n].name});
                        h.DataManmager.Instance.setFightRoles(this.fightId, a)
                    }, e.prototype.createScene = function (e) {
                        this.curScene = new u.default(this.fightId, e)
                    }, e.prototype.createCamera = function () {
                        this.playerCameraCtr = new p.default
                    }, e.prototype.createPlayer = function (e) {
                        var t = this;
                        this.playerCount = 0;
                        var n = function () {
                            t.playerCount++, t.playerCount === t.fightConfig.aiNum && e && e()
                        };
                        this.curScene.createMainRole();
                        for (var a = [], i = this.fightConfig.aiId.length, o = 0; o < i; o++) {
                            var r = h.DataManmager.Instance.aiProperty[this.fightConfig.aiId[o]];
                            r && a.push({id: r.id, num: r.bornLimit || 999})
                        }
                        0 === a.length && a.push({id: 1001, num: 999}), this.fightConfig.aiNum = 14;
                        var s = 0;
                        for (o = a.length - 1; 0 <= o && !(s >= this.fightConfig.aiNum); o--) {
                            (l = a[o]).num--, l.num <= 0 && a.splice(o, 1), this.curScene.addRole(o, n, l.id), s++
                        }
                        for (o = s; o < this.fightConfig.aiNum; o++) {
                            var l;
                            (l = a[c.default.getRandom(0, a.length - 1)]).num--, l.num <= 0 && a.splice(o, 1), this.curScene.addRole(o, n, l.id), s++
                        }
                    }, e.prototype.getFloor = function () {
                        if (this.curScene) return this.curScene.floor
                    }, e.prototype.getFollowTarget = function () {
                        return this.mainRole || (this.mainRole = this.curScene.mainRole), this.mainRole
                    }, e.prototype.addMoveCtr = function (e) {
                        0 <= this.moveCtrs.indexOf(e) || (this.moveCtrCnt++, this.moveCtrs.push(e))
                    }, e.prototype.removeMoveCtrl = function (e) {
                        this.moveCtrCnt--;
                        var t = this.moveCtrs.indexOf(e);
                        0 <= t && this.moveCtrs.splice(t, 1)
                    }, e.prototype.addPerformCtr = function (e) {
                        this.performCtrCnt++, this.performCtrs.push(e)
                    }, e.prototype.removePerformCtr = function (e) {
                        this.performCtrCnt--;
                        var t = this.performCtrs.indexOf(e);
                        0 <= t && this.performCtrs.splice(t, 1)
                    }, Object.defineProperty(e.prototype, "realDeltaTime", {
                        get: function () {
                            return Math.min(.1, .001 * Laya.timer.delta)
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(e.prototype, "deltaTime", {
                        get: function () {
                            return Math.max(.05, .001 * Laya.timer.delta)
                        }, enumerable: !0, configurable: !0
                    }), e.prototype.updateMove = function () {
                        this.moveCtrs.forEach(function (e) {
                            e && e.update()
                        })
                    }, e.prototype.updatePerform = function () {
                        this.performCtrs.forEach(function (e) {
                            e && e.update()
                        })
                    }, e.prototype.loop = function () {
                        if (!this.isGamePause) {
                            this.time += this.realDeltaTime, this.updateMove(), this.updatePerform(), this.curScene.update(), this.time > this.gameTime && this.gameFinish();
                            var e = Math.round(this.time);
                            e !== this.lastTime && (this.lastTime = e, o.DEventManage.Instance.event(r.DEvent.BattleTimeChange, this.gameTime - this.lastTime))
                        }
                    }, e.prototype.gameFinish = function () {
                        d.GameRecodrderManager.Instance.stop(), this.setGamePause(!0), o.DEventManage.Instance.event(r.DEvent.onGameFinish);
                        var e = this.curScene.roleArr;
                        e.sort(function (e, t) {
                            return t.energy - e.energy
                        });
                        var t = e.indexOf(this.mainRole);
                        i.DUIManager.Instance.toUI(s.DIUIConfig.Settlement, {
                            sort: t + 1,
                            energy: this.mainRole.energy
                        }), this.gameOver()
                    }, e.prototype.gameOver = function () {
                        Laya.timer.clear(this, this.loop), g.SoundtManager.Instance.stopSound(m.DSound.footstep2), this.playerCameraCtr && (this.playerCameraCtr.dispose(), this.playerCameraCtr = null), this.boomWallSprite && this.boomWallSprite.parent && this.boomWallSprite.removeSelf(), this.levelUpSprite && this.levelUpSprite.parent && this.levelUpSprite.removeSelf(), this.killDinSprite && this.killDinSprite.parent && this.killDinSprite.removeSelf(), this.eatPeopleSprite && this.eatPeopleSprite.parent && this.eatPeopleSprite.removeSelf(), this.curScene && (this.curScene.dispose(), this.curScene = null), this.mainRole = null, e.collect()
                    }, e.prototype.converPos = function (e) {
                        var t = new Laya.Vector3(0, 0, 0);
                        return this.playerCameraCtr && this.playerCameraCtr.camera && this.playerCameraCtr.camera.viewport.project(e, this.playerCameraCtr.camera.projectionViewMatrix, t), t
                    }, e.prototype.getRandomAIPlayerInfo = function () {
                        for (var e, t, n = h.DataManmager.Instance, a = n.getAINameCount() - 1; ;) if (t = Math.round(Math.random() * a), (e = n.getAIPlayerInfo(t)) && null == this.usedAINames[e.name]) {
                            this.usedAINames[e.name] = e.name;
                            break
                        }
                        return e
                    }, e.prototype.generateAIPlayerList = function (e) {
                        if (this.aiPlayerInfos.length < e) for (; this.aiPlayerInfos.length < e;) {
                            var t = this.getRandomAIPlayerInfo();
                            t && this.aiPlayerInfos.push(t)
                        }
                        return this.aiPlayerInfos
                    }, e.prototype.onPlayerKilled = function (e) {
                        e.deather === this.mainRole && i.DUIManager.Instance.showUI(s.DIUIConfig.Revive, {})
                    }, e._instance = null, e
                }();
            n.GameMaanager = f
        }, {
            "../../conslt/DEvent": 4,
            "../../conslt/DIUIConfig": 5,
            "../../conslt/DSound": 7,
            "../../core/managee/DEventManage": 12,
            "../../core/managee/DUIManager": 13,
            "../../core/managee/GameRecodrderManager": 14,
            "../../core/managee/SoundtManager": 18,
            "../../utils/MathUtil": 49,
            "../data/GameData": 21,
            "../model/GameScene": 33,
            "../model/PlayerCameraControl": 37,
            "../utils/GameUtils": 39,
            "./DataManmager": 26
        }],
        28: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a, i, r, o, s, l, h, c, d, u = e("../../core/managee/DEventManage"), p = e("../../conslt/DEvent"),
                g = e("../../core/managee/DUIManager"), m = e("../../core/managee/LocalStorgeMananger"),
                f = e("../../conslt/GameConst"), y = e("../../sdkm/SDKManager"), v = e("../utils/GameUtils"),
                I = e("../../conslt/GlobalData"), S = e("../../conslt/ReporttType"), w = e("./DataManmager");
            (i = a = n.InComeType || (n.InComeType = {}))[i.Share = 1] = "Share", i[i.Video = 2] = "Video", (o = r = n.ShareVideoPos || (n.ShareVideoPos = {}))[o.Unknow = -1] = "Unknow", o[o.DefaultShare = 0] = "DefaultShare", o[o.SettlementAD = 101] = "SettlementAD", o[o.GradeUpShare = 102] = "GradeUpShare", o[o.AttributeAD = 103] = "AttributeAD", o[o.GetMoneyAD = 104] = "GetMoneyAD", o[o.ReliveAD = 105] = "ReliveAD", o[o.SkinTryAD = 106] = "SkinTryAD", o[o.ReliveShare = 8] = "ReliveShare", (s = n.VShareVideoPos || (n.VShareVideoPos = {}))[s.vSettelment = 4] = "vSettelment", s[s.vRelive = 5] = "vRelive", (h = l = n.VSInfoType || (n.VSInfoType = {}))[h.Default = 0] = "Default", h[h.Share = 1] = "Share", h[h.Video = 2] = "Video", (d = c = n.VSShowType || (n.VSShowType = {}))[d.Default = 0] = "Default", d[d.Share = 1] = "Share", d[d.Video = 2] = "Video";
            var D = function () {
                function o() {
                    this._lastCallTime = 0, this.videoMapping = {}, this.shareMapping = {}, this.clickShareCnts = {}, this.canFetchVideo = !0, this._isShowingBanner = !1, this._inited = !1, this._callShare = !1, this._callShareReward = !1, this._dailyShareMapping = {}, this._vsCount = 0, this._videoCount = 0, this._vsFailShareCount = 0, this._lastCallTime = 0, this.videoMapping = {}, this.shareMapping = {}, this.clickShareCnts = {}, this.canFetchVideo = !0, this._isShowingBanner = !1, this._dailyShareMapping = {}, this._inited = !1, this._callShare = !1, this._callShareReward = !1, this.registerEvent(), this.readVideoCache()
                }

                return Object.defineProperty(o, "Instance", {
                    get: function () {
                        return null == o._instance && (o._instance = new o), o._instance
                    }, enumerable: !0, configurable: !0
                }), o.prototype.registerEvent = function () {
                    u.DEventManage.Instance.on(p.DEvent.FetchVideoFail, this, this.onFetchVideoFail), u.DEventManage.Instance.on(p.DEvent.GetFocus, this, this.onGameFocus), u.DEventManage.Instance.on(p.DEvent.OverDayEvent, this, this.resetByOverDay), u.DEventManage.Instance.on(p.DEvent.FinishVideoAd, this, this.onFinishVideoAd)
                }, o.prototype.unregisterEvent = function () {
                    u.DEventManage.Instance.off(p.DEvent.FetchVideoFail, this, this.onFetchVideoFail), u.DEventManage.Instance.off(p.DEvent.GetFocus, this, this.onGameFocus), u.DEventManage.Instance.off(p.DEvent.FinishVideoAd, this, this.onFinishVideoAd)
                }, o.prototype.canShowVideo = function () {
                    return !0
                }, o.prototype.onFetchVideoFail = function (e) {
                    if (this.canFetchVideo = !1, this.saveVideoCache(), this.isForceVideoWithError(e) || !this.checkShowShareAfterVideoFail(e)) {
                        g.DUIManager.Instance.showTips("获取视频失败");
                        w.DataManmager.Instance.getVideoShareCfg(e)
                    }
                }, o.prototype.saveShareCache = function (e, t) {
                    this._dailyShareMapping[e] = {
                        shared: !0,
                        shareTime: t
                    }, Laya.LocalStorage.setJSON("dailySharedMapping", this._dailyShareMapping)
                }, o.prototype.saveVideoCache = function () {
                    Laya.LocalStorage.setItem("canFetchVideo", (this.canFetchVideo ? 1 : 0).toString()), Laya.LocalStorage.setItem("vsCount", this._vsCount.toString()), Laya.LocalStorage.setItem("vsFailShareCount", this._vsFailShareCount.toString()), Laya.LocalStorage.setItem("videoCount", this._videoCount.toString())
                }, o.prototype.readVideoCache = function () {
                    var e = new Date, t = e.getFullYear(), n = e.getMonth(), a = e.getDate(),
                        i = Laya.LocalStorage.getJSON("dailySharedMapping");
                    for (var o in i) {
                        var r = i[o], s = r.shared, l = r.shareTime, h = new Date(l), c = h.getFullYear(),
                            d = h.getMonth(), u = h.getDate();
                        (c < t || t == c && (d < n || n == d && u < a)) && (s = !1, l = null), this._dailyShareMapping[o] = {
                            shared: s,
                            shareTime: l
                        }
                    }
                    i = Laya.LocalStorage.getItem("canFetchVideo") || 0, this.canFetchVideo = 1 == (parseInt(i) || 0), this.canFetchVideo = !0, this._vsCount = m.LocalStorgeMananger.getNumberValue("vsCount") || 0, this._vsFailShareCount = m.LocalStorgeMananger.getNumberValue("vsFailShareCount") || 0, this._videoCount = m.LocalStorgeMananger.getNumberValue("videoCount") || 0, I.GlobalData.isOverDay && this.resetByOverDay()
                }, o.prototype.wxCheck = function () {
                    return !f.GameConst.Dev && f.GameConst.State == f.AppState.Check
                }, o.prototype.aCheck = function () {
                    return !!this.wxCheck() || (y.SDKManager.IsQQ() ? f.GameConst.vGameInfo.qqacv === f.GameConst.ClientVer : y.SDKManager.IsTouTiao() ? f.GameConst.vGameInfo.ttacv === f.GameConst.ClientVer : !f.GameConst.Dev && f.GameConst.ClientVer === f.GameConst.vGameInfo.acv)
                }, o.prototype.getVideoCnt = function (e) {
                    var t = this.videoMapping[e];
                    return null == t ? 0 : t
                }, o.prototype.getShareClickCnt = function (e) {
                    var t = this.clickShareCnts[e];
                    return null == t ? 0 : t
                }, o.prototype.addShareClickCnt = function (e) {
                    var t = this.clickShareCnts[e];
                    null == t ? t = 1 : t++, this.clickShareCnts[e] = t
                }, o.prototype.showADBanner = function (e, t) {
                    if (void 0 === t && (t = -1), !y.SDKManager.IsWeChat() && this.shouldShowForBanner(e)) {
                        var n = w.DataManmager.Instance.getBannerCfg(e);
                        if (null != n) {
                            var a = n.adunit;
                            y.SDKManager.IsTouTiao() ? a = n.tadunit : y.SDKManager.IsQQ() && (a = n.qadunit);
                            var i = w.DataManmager.Instance.getRandomBannerCfg();
                            null !== i && i.adunit && (a = i.adunit, y.SDKManager.IsTouTiao() && i.tadunit ? a = i.tadunit : y.SDKManager.IsQQ() && i.qadunit && (a = i.qadunit)), this._isShowingBanner = !0;
                            var o = n.hAlign, r = n.vAlign, s = n.xOffset;
                            (this.wxCheck() || !f.GameConst.isF || f.GameConst.isLimitCityB) && 0 < t && (t += v.GameUtils.getNormalBannerOffset()), y.SDKManager.Instance.showBanner(e, a, o, r, n.w, s, n.yOffset, t)
                        }
                    }
                }, o.prototype.hideBanner = function (e) {
                    void 0 === e && (e = 0), this._isShowingBanner = !1, y.SDKManager.Instance.hideBanner(e)
                }, o.prototype.isShowingBanner = function () {
                    return this._isShowingBanner
                }, o.prototype.restoreBanner = function (e, t) {
                    void 0 === t && (t = 0), this.showADBanner(e, t)
                }, o.prototype.showVideoOrrShare = function (e, t) {
                    if (0 < this._lastCallTime && Date.now() - this._lastCallTime < 300) return;
                    if (I.GlobalData.fetchingVideoAd && Date.now() - this._lastCallTime < 1e4) g.DUIManager.Instance.showTips("正在拉取视频", 2e3); else {
                        this._callShareReward = !1, this._callShare = !1, this._lastCallTime = Date.now();
                        var n = w.DataManmager.Instance.getVideoShareCfg(e);
                        null != n && (n.type == a.Video ? this.handleVideo(n) : this.handleShare(n, !0))
                    }
                }, o.prototype.isForceVideo = function (e) {
                    return e === r.ReliveAD || e === r.SettlementAD || e === r.AttributeAD || e === r.GetMoneyAD
                }, o.prototype.isForceVideoWithError = function (e) {
                    if (this.wxCheck()) return !0
                }, o.prototype.checkShowShareAfterVideoFail = function (e) {
                    var t = !1;
                    if (this._vsFailShareCount + this._videoCount >= f.GameConst.vGameInfo.vsAllCount && (t = !0), t || this._vsFailShareCount >= f.GameConst.vGameInfo.vsFailShareCount) return !1;
                    this._callShareReward = !1, this._callShare = !1, this._lastCallTime = Date.now();
                    var n = Date.now(), a = v.GameUtils.getShareInfoByCfg(null);
                    return this._callShareReward = !0, this._callShare = !0, this._callShareCfg = {
                        pos: e,
                        fromVideoFail: !0
                    }, y.SDKManager.Instance.shareM(e, !1, 1, a.imgUrl, a.shareContent, n, ""), !0
                }, o.prototype.handleVideo = function (e) {
                    if (y.SDKManager.IsWeChat()) return this.wxCheck() ? (g.DUIManager.Instance.showTips("广告功能暂未开通"), !0) : void this.handleShare(e, !1);
                    if (this.canShowVideo() || this.isForceVideo(e.pos)) {
                        if (!this.canShowVideoADByCount()) {
                            if (!this.wxCheck() && this.checkShowShareAfterVideoFail(e.pos)) return;
                            return void g.DUIManager.Instance.showTips("视频奖励次数今日已达上限")
                        }
                        y.SDKManager.Instance.report(S.ReporttType.showAD, {adName: e.name || ""});
                        var t = e.adunit;
                        y.SDKManager.IsTouTiao() ? t = e.tadunit : y.SDKManager.IsQQ() && (t = e.qadunit), y.SDKManager.Instance.showVideo(e.pos, t, e.toast)
                    } else this.handleShare(e, !1)
                }, o.prototype.handleShare = function (e, t) {
                    this.hasDailyShared(e.pos) || this.saveShareCache(e.pos, (new Date).toString()), y.SDKManager.Instance.report(S.ReporttType.doShare, {adName: e.name || ""});
                    var n = Date.now(), a = v.GameUtils.getShareInfoByCfg(e), i = a.shareContent;
                    this._callShareReward = t, this._callShare = !0, this._callShareCfg = {
                        pos: e.pos,
                        fromVideoFail: !1
                    }, y.SDKManager.Instance.shareM(e.pos, 1 == e.shot, e.type, a.imgUrl, i, n, e.name)
                }, o.prototype.hasDailyShared = function (e) {
                    var t = this._dailyShareMapping[e];
                    return null != t && t.shared
                }, o.prototype.onShowAdCompleted = function (e, t) {
                    void 0 === t && (t = !1);
                    var n = this.videoMapping[e];
                    if (null == n ? n = 1 : n++, this.videoMapping[e] = n, t) return this._vsFailShareCount++, void this.saveVideoCache();
                    this.canAddVSCount(e) && (this._vsCount++, m.LocalStorgeMananger.setNumberValue("vsCount", this._vsCount))
                }, o.prototype.onGameFocus = function () {
                    this._callShare = !1
                }, o.prototype.getVSShowType = function () {
                    if (!f.GameConst.vsInfo) return c.Default;
                    var e = f.GameConst.vsInfo, t = e.type, n = e.snum, a = e.vnum, i = n + a;
                    return t === l.Default || 0 === n && 0 === a ? c.Default : 0 === n && 0 < a ? c.Video : 0 < n && 0 === a ? c.Share : t === l.Share ? this._vsCount % i < n ? c.Share : c.Video : t === l.Video ? this._vsCount % i < a ? c.Video : c.Share : c.Default
                }, o.getShowType = function (e) {
                    if (o.Instance.wxCheck()) return 2;
                    var t = o.Instance.getVSShowType();
                    if (t !== c.Default) return t === c.Video && 0 < f.GameConst.vsInfo.snum && !o.Instance.canShowVideoADByCount() ? c.Share : t;
                    var n = f.GameConst.vList;
                    if (n.length) for (var a = 0; a < n.length; a++) {
                        var i = n[a];
                        if (i && i.pos == e) return i.type || 0
                    }
                    return 0
                }, o.prototype.shouldShowForBanner = function (e) {
                    return !0
                }, o.prototype.resetByOverDay = function () {
                    this.canFetchVideo = !0, this._vsCount = 0, this._vsFailShareCount = 0, this._videoCount = 0, this.saveVideoCache()
                }, o.prototype.canAddVSCount = function (e) {
                    return e === r.ReliveAD || e === r.SettlementAD
                }, o.prototype.canShowVideoADByCount = function () {
                    return o.Instance._videoCount < f.GameConst.vAdCount
                }, o.prototype.onFinishVideoAd = function (e) {
                    this._videoCount++, this.saveVideoCache()
                }, o.prototype.updateViewWithPos = function (e, t) {
                    var n = e.getChildByName("icon"), a = o.getShowType(t);
                    n.skin = 2 === a ? "common/ic_vedio.png" : "common/ic_share.png"
                }, o._instance = null, o
            }();
            n.GameShaereManager = D
        }, {
            "../../conslt/DEvent": 4,
            "../../conslt/GameConst": 8,
            "../../conslt/GlobalData": 9,
            "../../conslt/ReporttType": 11,
            "../../core/managee/DEventManage": 12,
            "../../core/managee/DUIManager": 13,
            "../../core/managee/LocalStorgeMananger": 15,
            "../../sdkm/SDKManager": 42,
            "../utils/GameUtils": 39,
            "./DataManmager": 26
        }],
        29: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var i, a, o = e("../data/GameData"), r = e("./DataManmager"), s = e("../../utils/MathUtil");
            (a = i = n.SkinType || (n.SkinType = {}))[a.free = 0] = "free", a[a.vedio = 1] = "vedio", a[a.grade = 2] = "grade";
            var l = function () {
                function e() {
                    this.tempSkin = -1
                }

                return Object.defineProperty(e, "Instance", {
                    get: function () {
                        return null === e._instance && (e._instance = new e), e._instance
                    }, enumerable: !0, configurable: !0
                }), e.prototype.getSkinCfg = function (e) {
                    return e > r.DataManmager.Instance.skinCfg.length && (e = 1), r.DataManmager.Instance.skinCfg[e - 1]
                }, e.prototype.getSkinInfo = function (e) {
                    return (o.GameData.Instance.playerInfo.skinArr || [])[e] || {type: 0, cnt: 0}
                }, e.prototype.setSkinInfo = function (e, t) {
                    var n = o.GameData.Instance.playerInfo.skinArr || [];
                    n[e] = t, o.GameData.Instance.playerInfo.skinArr = n
                }, Object.defineProperty(e.prototype, "curSkin", {
                    get: function () {
                        return o.GameData.Instance.playerInfo.curSkin || 1
                    }, set: function (e) {
                        o.GameData.Instance.playerInfo.curSkin = e
                    }, enumerable: !0, configurable: !0
                }), e.prototype.hasComplete = function (e) {
                    var t = this.getSkinCfg(e), n = this.getSkinInfo(e);
                    if (t.conditionType == n.type) {
                        if (t.conditionType == i.free) return !0;
                        if (t.conditionType == i.grade) {
                            var a = o.GameData.Instance.gradeCfg;
                            if (a && a.id >= t.conditionCnt) return !0
                        } else if (n.cnt >= t.conditionCnt) return !0
                    } else this.setSkinInfo(e, {type: t.conditionType, cnt: 0});
                    return !1
                }, e.prototype.setTempSkin = function (e) {
                    this.tempSkin = e
                }, e.prototype.resetTempSkin = function () {
                    this.tempSkin = -1
                }, e.prototype.getGameSkin = function () {
                    var e = this.curSkin;
                    return 0 <= this.tempSkin && (e = this.tempSkin), this.getSkinCfg(e)
                }, e.prototype.getRandomSkin = function () {
                    var e = s.default.getRandom(1, 5);
                    return this.getSkinCfg(e)
                }, e._instance = null, e
            }();
            n.SkinManager = l
        }, {"../../utils/MathUtil": 49, "../data/GameData": 21, "./DataManmager": 26}],
        30: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var d = e("../../utils/MathUtil"), i = e("../managre/DataManmager"), u = e("../managre/GameMaanager"),
                o = function () {
                    function e(e, t) {
                        this.targetType = "item", this.type = 0, this.x = 0, this.y = 0, this.left = 0, this.right = 0, this.bottom = 0, this.top = 0, this.score = 0, this.scoreK = 0, this.type = 10 * e + t
                    }

                    return e.prototype.set = function (e, t, n) {
                        var a = n / Math.SQRT2;
                        switch (this.type) {
                            case 11:
                                this.x = e - a, this.y = t - a, this.scoreK = 2 / n;
                                break;
                            case 12:
                                this.x = e + a, this.y = t - a, this.scoreK = 2 / n;
                                break;
                            case 13:
                                this.x = e - a, this.y = t + a, this.scoreK = 2 / n;
                                break;
                            case 14:
                                this.x = e + a, this.y = t + a, this.scoreK = 2 / n;
                                break;
                            case 21:
                                this.x = e, this.y = t, this.scoreK = 1;
                                break;
                            case 22:
                                this.x = e - 2 * a, this.y = t, this.scoreK = a;
                                break;
                            case 23:
                                this.x = e + 2 * a, this.y = t, this.scoreK = a;
                                break;
                            case 24:
                                this.x = e, this.y = t - 2 * a, this.scoreK = a;
                                break;
                            case 25:
                                this.x = e, this.y = t + 2 * a, this.scoreK = a
                        }
                        this.left = this.x - a, this.right = this.x + a, this.bottom = this.y + a, this.top = this.y - a, this.score = 0
                    }, e.prototype.checkItem = function (e) {
                        return !!this.isInRange(e) && (this.score += e.getScore(), !0)
                    }, e.prototype.isInRange = function (e) {
                        return d.default.isInRange(this.left, this.right, this.top, this.bottom, e.getX(), e.getY())
                    }, e.prototype.getScore = function () {
                        return this.score * this.scoreK
                    }, e
                }();
            n.RangeScoreOB = o;
            var p, a, g = function () {
                function i() {
                    this.targetType = "role", this.type = 30, this.score = 0, this.role = null, this.dstRole = null, this.sqrVisual = 0
                }

                return i.create = function (e, t, n) {
                    var a = Laya.Pool.getItemByClass("RoleScore", i);
                    return a.init(e, t, n), a
                }, i.prototype.init = function (e, t, n) {
                    this.score = 0, this.role = e, this.dstRole = t, this.sqrVisual = n * n
                }, i.prototype.update = function () {
                    return this.score = -1, this.role !== this.dstRole && !this.dstRole.isProtect && this.dstRole.isAlive() && this.dstRole.isWeak(this.role.getLevel()) && d.default.getDistanceSqr(this.role.getX(), this.role.getY(), this.dstRole.getX(), this.dstRole.getY()) < this.sqrVisual && (this.score = this.dstRole.getScore()), this.getScore()
                }, i.prototype.getScore = function () {
                    return this.score
                }, i.prototype.destroy = function () {
                    Laya.Pool.recover("RoleScore", this)
                }, i
            }();
            n.RoleScore = g, (a = p = n.AIPlanType || (n.AIPlanType = {}))[a.none = 0] = "none", a[a.normal = 1] = "normal", a[a.dodge = 2] = "dodge", a[a.random = 3] = "random";
            var r = function () {
                function a() {
                    this.rangeScores = [], this.rsLength = 0, this.targetRange = null, this.config = null, this.visualField = null, this.sqrVisualField = null, this.nextPlanTime = 0, this.prePlan = p.none, this.plan = p.none, this.targetItem = null, this.nextTargetTime = 0, this.role = null, this.angle = 0, this.ignoreItem = null, this.radius = 0, this.rangeScores = [];
                    for (var e = 1; e <= 4; e++) this.rangeScores.push(new o(1, e));
                    for (e = 1; e <= 5; e++) this.rangeScores.push(new o(2, e));
                    this.rsLength = this.rangeScores.length
                }

                return a.create = function (e, t) {
                    var n = Laya.Pool.getItemByClass("DAILogic", a);
                    return n.init(e, t), n
                }, a.prototype.init = function (e, t) {
                    this.role = e, this.config = i.DataManmager.Instance.aiProperty[t], this.visualField = this.config.visualField, this.sqrVisualField = this.visualField * this.visualField, this.nextPlanTime = 0, this.prePlan = p.none, this.plan = p.none, this.targetItem = null, this.angle = 0, this.selectRandomPlan()
                }, a.prototype.update = function () {
                    this.selectPlan(), this.role.targetAngle = this.angle
                }, a.prototype.setPlan = function (e) {
                    e === p.dodge ? this.nextPlanTime = u.GameMaanager.Instance.time + this.config.warTime : this.nextPlanTime = u.GameMaanager.Instance.time + this.config.time, this.plan = e
                }, a.prototype.setTarget = function (e) {
                    this.targetItem !== e && (this.targetItem = e, this.nextTargetTime = u.GameMaanager.Instance.time + this.config.ignoreTime)
                }, a.prototype.selectPlan = function () {
                    if (this.nextPlanTime > u.GameMaanager.Instance.time && this.plan === p.normal) {
                        var e = this.getTargetItem();
                        e || (this.findNearestInRangeScoreOB(), e = this.getTargetItem()), e ? this.angle = d.default.getMoveTargetAngle(this.role.getX(), this.role.getY(), this.targetItem.getX(), this.targetItem.getY()) : this.plan = p.none
                    }
                    this.nextPlanTime > u.GameMaanager.Instance.time && this.plan !== p.none || (this.prePlan = this.plan, this.plan = p.none, this.selectRolePlan(), this.plan === p.none && this.prePlan === p.normal && this.findNearestInRangeScoreOB() && this.setPlan(p.normal), this.plan === p.none && this.selectItemPlan(), this.plan === p.none && this.selectRandomPlan())
                }, a.prototype.selectRolePlan = function () {
                }, a.prototype.getTargetItem = function () {
                    return this.targetItem && this.targetItem.isAlive() && this.targetItem.isWeak(this.role.getLevel()) ? this.nextTargetTime < u.GameMaanager.Instance.time && (this.ignoreItem = this.targetItem, this.targetItem = null) : this.targetItem = null, this.targetItem
                }, a.prototype.findNearestInRangeScoreOB = function () {
                    var n = this;
                    if (!this.targetRange) return !1;
                    var a = null, i = this.role.getX(), o = this.role.getY();
                    if ("role" === this.targetRange.targetType) -1 !== this.targetRange.update() && this.targetRange.dstRole !== this.ignoreItem && (a = this.targetRange.dstRole); else {
                        var r = this.role.getLevel(), s = Number.MAX_VALUE,
                            e = u.GameMaanager.Instance.curScene.getRangeGoodsByPos(this.targetRange.x, this.targetRange.y, this.radius);
                        e.push(u.GameMaanager.Instance.curScene.unStaticGoods), e.push(u.GameMaanager.Instance.curScene.getRoles()), e.push(u.GameMaanager.Instance.curScene.humanArr), e.forEach(function (e) {
                            e.forEach(function (e) {
                                if (e.isWeak(r) && e !== n.ignoreItem && n.targetRange.isInRange(e)) {
                                    var t = d.default.getDistanceSqr(i, o, e.getX(), e.getY());
                                    t < s && (a = e, s = t)
                                }
                            })
                        })
                    }
                    return !!a && (this.setTarget(a), this.angle = d.default.getMoveTargetAngle(i, o, this.targetItem.getX(), this.targetItem.getY()), !0)
                }, a.prototype.selectItemPlan = function () {
                    for (var n = this, e = this.role.getX(), t = this.role.getY(), a = this.role.getLevel(), i = 0; i < this.rsLength; i++) this.rangeScores[i].set(e, t, this.visualField);
                    this.radius = this.visualField / Math.SQRT2;
                    var o = e - 2 * this.radius, r = e + 2 * this.radius, s = t - 2 * this.radius,
                        l = t + 2 * this.radius,
                        h = u.GameMaanager.Instance.curScene.getRangeGoods(this.role, 2.5 * this.radius);
                    (h.push(u.GameMaanager.Instance.curScene.unStaticGoods), h.push(u.GameMaanager.Instance.curScene.humanArr), h.forEach(function (e) {
                        e.forEach(function (e) {
                            if (e.isAlive() && e.isWeak(a) && e !== n.ignoreItem && d.default.isInRange(o, r, l, s, e.getX(), e.getY())) for (var t = 0; t < n.rsLength && !n.rangeScores[t].checkItem(e); t++) ;
                        })
                    }), this.rangeScores.length === this.rsLength) && u.GameMaanager.Instance.curScene.getRoles().forEach(function (e) {
                        n.rangeScores.push(g.create(n.role, e, n.config.visualPeople))
                    });
                    for (var c = this.rsLength; c < this.rangeScores.length; c++) this.rangeScores[c].update();
                    this.rangeScores.sort(function (e, t) {
                        return t.getScore() - e.getScore()
                    });
                    for (c = 0; c < this.rsLength && 0 !== this.rangeScores[c].getScore(); c++) if (this.isSmart() && (this.targetRange = this.rangeScores[c], this.findNearestInRangeScoreOB())) {
                        this.setPlan(p.normal);
                        break
                    }
                    this.rangeScores.sort(function (e, t) {
                        return e.type - t.type
                    })
                }, a.prototype.selectRandomPlan = function () {
                    var e = d.default.getMoveTargetAngle(this.role.getX(), this.role.getY(), 0, 0);
                    e += d.default.getRandom(-135, 135), this.angle = e, this.setPlan(p.random)
                }, a.prototype.isSmart = function () {
                    return this.config.IQ >= Math.random()
                }, a.prototype.destory = function () {
                    for (var e = this.rsLength; e < this.rangeScores.length; e++) this.rangeScores[e].destory();
                    this.rangeScores.length = this.rsLength, Laya.Pool.recover("DAILogic", this)
                }, a
            }();
            n.default = r
        }, {"../../utils/MathUtil": 49, "../managre/DataManmager": 26, "../managre/GameMaanager": 27}],
        31: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var m = e("../../utils/StringUtil"), o = e("../../utils/ArrayUtil"), a = e("../utils/GameUtils"),
                i = e("../utils/AniUtils"), f = e("../managre/DataManmager"), r = function () {
                    function g() {
                        this.modelId = 0, this.sprite = null, this.animator = null, this.avatar = null, this.parent = null, this.loadedHandler = null, this.position = new Laya.Vector3(NaN, NaN, NaN), this.localPosition = new Laya.Vector3(0, 0, 0), this.localScale = new Laya.Vector3(1, 1, 1), this.localRotation = new Laya.Vector3(0, 0, 0), this.loaded = !1, this.modelConfig = null, this.isDestroyed = !1, this.waitDestroy = !1, this.config = null, this.name = null, this.active = !0, this.animUtils = null
                    }

                    return g.isLoading = function (e) {
                        for (var t = 0; t < e.length; t++) if (-1 !== g.curLoad.indexOf(e[t])) return !0;
                        return !1
                    }, g.prepareLoad = function (n, a) {
                        if (this.isLoading(n)) g.waitting.push({
                            ids: n,
                            completeHandler: a
                        }); else if (g.MAX_LOADING_NUM <= g.curLoadingNum) g.waitting.push({
                            ids: n,
                            completeHandler: a
                        }); else {
                            var p = [];
                            n.forEach(function (e) {
                                var t = f.DataManmager.Instance.prefabsPath[e], n = e;
                                if (Number(e)) {
                                    if (!t) return;
                                    g.curLoad.push(e), n = t.chs
                                }
                                var a = f.DataManmager.Instance.modelConfig[n];
                                if (a) {
                                    var i = t ? t.additionalId : 0;
                                    if (i) for (var o = i.split("&"), r = 0; r < o.length; r++) {
                                        var s = o.split("#")[0];
                                        -1 !== o.indexOf(s) && o.push(s)
                                    }
                                    var l = a.resource;
                                    for (r = l.length - 1; 0 <= r; r--) {
                                        for (var h = l[r], c = !1, d = 0; d < p.length; d++) {
                                            var u = p[d];
                                            if (u === h || u.url === h) {
                                                c = !0;
                                                break
                                            }
                                        }
                                        c || (m.StringUtils.endWith(h, ".lh") ? p.push({
                                            url: h,
                                            class: Laya.Sprite3D,
                                            priority: 1
                                        }) : m.StringUtils.endWith(h, ".lani") ? p.push({
                                            url: h,
                                            class: Laya.AnimationTemplet,
                                            priority: 1
                                        }) : p.push(h))
                                    }
                                }
                            });
                            var i = function (e) {
                                e && e.forEach(function (e) {
                                    g.loadedCount[e] = (g.loadedCount[e] || 0) + 1
                                })
                            };
                            g.curLoadingNum++, Laya.loader.create(p, new Laya.Handler(null, function () {
                                g.curLoadingNum--, n.forEach(function (e) {
                                    var t = f.DataManmager.Instance.prefabsPath[e], n = e;
                                    if (Number(e)) {
                                        if (!t) return;
                                        n = t.chs
                                    }
                                    o.ArrayUtil.remove(g.curLoad, e);
                                    var a = f.DataManmager.Instance.modelConfig[n];
                                    a && i && i(a.resource)
                                }), a && a.run();
                                for (var e = g.waitting.length - 1; 0 <= e; e--) {
                                    var t = g.waitting[e];
                                    if (!g.isLoading(t)) return o.ArrayUtil.remove(g.waitting, t), void g.prepareLoad(t.ids, t.completeHandler)
                                }
                            }))
                        }
                    }, g.create = function (e, t, n) {
                        void 0 === n && (n = null);
                        var a = new g;
                        return a.reset(e, t, n), g.addDModelUsedCnt(t), a
                    }, g.addDModelUsedCnt = function (e) {
                        g.modelUsedCnt[e] = (g.modelUsedCnt[e] || 0) + 1
                    }, g.getUrlById = function (e) {
                        var t = f.DataManmager.Instance.prefabsPath[e];
                        return this.fullChs(t.chs)
                    }, g.fullChs = function (e) {
                        return e + ".lh"
                    }, g.prototype.reset = function (e, t, n) {
                        if (this.parent = e, this.modelId = t, this.loadedHandler = n, this.isDestroyed = !1, this.config = f.DataManmager.Instance.prefabsPath[t], this.animUtils ? Laya.timer.clearAll(this.animUtils) : this.animUtils = new i.default, this.config) {
                            var a = this.config.chs;
                            return this.modelConfig = f.DataManmager.Instance.modelConfig[a], this.name = a.substring(a.lastIndexOf("/") + 1), this.setLocalScale(this.config.scale), this.create(), !0
                        }
                        return !1
                    }, g.prototype.create = function () {
                        this.loaded ? Laya.timer.once(1, this, this.onAllCompleted) : g.prepareLoad([this.modelId], Laya.Handler.create(this, this.onComplete))
                    }, g.prototype.onComplete = function () {
                        if (!this.isDestroyed) {
                            var e = this.config.chs;
                            m.StringUtils.endWith(e, ".lh") || (e += ".lh"), Laya.Sprite3D.load(e, new Laya.Handler(this, this.onLoadComplete))
                        }
                    }, g.prototype.onLoadComplete = function (e) {
                        this.sprite = Laya.Sprite3D.instantiate(e), (this.sprite.$model = this).sprite.name = "Model_" + this.modelId, this.avatar = this.sprite, this.animator = this.avatar.getComponent(Laya.Animator), Laya.timer.once(1, this, this.onAllCompleted)
                    }, g.prototype.setPosition = function (e, t, n) {
                        a.GameUtils.setVector3(this.position, e, t, n), this.loaded && (this.sprite.transform.position = this.position)
                    }, g.prototype.setLocalPosition = function (e, t, n) {
                        a.GameUtils.setVector3(this.localPosition, e, t, n), this.loaded && (this.sprite.transform.localPosition = this.localPosition)
                    }, g.prototype.setLocalScale = function (e, t, n) {
                        void 0 === e && (e = 1), void 0 === t && (t = 0), void 0 === n && (n = 0), t || (t = e), n || (n = e), a.GameUtils.setVector3(this.localScale, e, t, n), this.loaded && (this.sprite.transform.localScale = this.localScale)
                    }, g.prototype.setLocalRotation = function (e, t, n) {
                        a.GameUtils.setVector3(this.localRotation, e, t, n), this.loaded && this.updateLocalRotation()
                    }, g.prototype.updateLocalRotation = function () {
                        var e = new Laya.Quaternion;
                        Laya.Quaternion.createFromYawPitchRoll(this.localRotation.x, this.localRotation.y, this.localRotation.z, e), this.sprite.transform.localRotation = e
                    }, g.prototype.setActive = function (e) {
                        this.active !== e && (this.active = e, this.loaded && (this.sprite.active = e))
                    }, g.prototype.setDModelAlpha = function (e) {
                        a.GameUtils.changeSingleMeshColor({w: e}, this.avatar)
                    }, g.prototype.isActive = function () {
                        return this.active
                    }, g.prototype.rotate = function (e, t, n) {
                        this.loaded && this.sprite.transform.rotate(e, t, n)
                    }, g.prototype.onAllCompleted = function () {
                        this.loaded = !0, this.isDestroyed || (this.waitDestroy ? this.dispose() : (this.parent && this.parent.addChild(this.sprite), isNaN(this.position.x) ? this.sprite.transform.localPosition = this.localPosition : this.sprite.transform.position = this.position, this.sprite.transform.localScale = this.localScale, this.updateLocalRotation(), this.sprite.active = this.active, this.loadedHandler && this.loadedHandler.run()))
                    }, g.prototype.playAnim = function (e, t, n, a) {
                        void 0 === t && (t = !1), this.animator ? (Laya.timer.clearAll(this.animUtils), t ? this.animUtils.playAnim(this.animator, e) : this.animUtils.playAnimWithFunc(this.animator, e, n, a)) : n && n.runWith(a)
                    }, g.prototype.replay = function () {
                        this.setActive(!1), this.setActive(!0)
                    }, g.prototype.dispose = function () {
                        !this.isDestroyed && this.loaded ? (this.animUtils && (Laya.timer.clearAll(this.animUtils), this.animUtils = null), this.isDestroyed = !0, this.loaded = !1, this.sprite && (this.sprite.destroy(!0), this.sprite = null), this.animator && (this.animator.destroy(), this.animator = null), this.avatar = null, this.parent = null, this.loadedHandler = null, this.active = !1, this.waitDestroy = !1, this.position = new Laya.Vector3(NaN, NaN, NaN), this.localPosition = new Laya.Vector3(0, 0, 0), this.localScale = new Laya.Vector3(1, 1, 1), this.localRotation = new Laya.Vector3(0, 0, 0), Laya.Pool.recover("model", this), g.modelUsedCnt[this.modelId]--, g.destroyResArray(this.modelConfig.resource), this.modelConfig = null) : this.waitDestroy = !0
                    }, g.prototype.setAlalbedo = function (e, t, n, a, i) {
                        if (e) {
                            var o = e.meshRender || e.skinnedMeshRender;
                            if (o) for (var r = o.materials, s = r.length - 1; 0 <= s; s--) {
                                var l = r[s];
                                if (0 != l.cull || 1 != l.blend || 770 != l.srcBlend || 1 != l.dstBlend) {
                                    !l._albedo && (l._albedo = new Laya.Vector4);
                                    var h = l._albedo.elements;
                                    h[0] = n, h[1] = a, h[2] = i, h[3] = t, l.albedo = l._albedo
                                }
                            } else for (var c = 0; c < e.numChildren; c++) {
                                var d = e.getChildAt(c);
                                this.setAlalbedo(d, t, n, a, i)
                            }
                        }
                    }, g.prototype.setRenderMode = function (e) {
                        this.sprite && this.updateRenderMode(this.sprite, e)
                    }, g.prototype.updateRenderMode = function (e, t) {
                        var n = e.meshRender || e.skinnedMeshRender;
                        if (n) n.material.renderMode = t; else for (var a = 0; a < e.numChildren; a++) {
                            var i = e.getChildAt(a);
                            this.updateRenderMode(i, t)
                        }
                    }, g.prototype.setAlpha = function (e) {
                        1 === e ? this.setRenderMode(4) : (this.setRenderMode(13), this.setAlalbedo(this.sprite, e, 1, 1, 1))
                    }, g.destoryRes = function (e) {
                        e && (e.destroy && !e.destoryed ? e.destroy(!0) : e.dispose && !e.disposed && e.dispose())
                    }, g.destroyResArray = function (e) {
                        e && e.forEach(function (e) {
                            g.loadedCount[e] && (g.loadedCount[e]--, 0 === g.loadedCount[e] && (g.destoryRes(Laya.Loader.getRes(e)), Laya.loader.clearRes(Laya.URL.formatURL(e))))
                        })
                    }, g.MAX_LOADING_NUM = 3, g.curLoadingNum = 0, g.waitting = [], g.loadedCount = {}, g.modelUsedCnt = {}, g.curLoad = [], g
                }();
            n.default = r
        }, {
            "../../utils/ArrayUtil": 47,
            "../../utils/StringUtil": 50,
            "../managre/DataManmager": 26,
            "../utils/AniUtils": 38,
            "../utils/GameUtils": 39
        }],
        32: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var h, a, o = e("./DModel"), i = e("./MoveBasicControl"), r = e("./DAILogic"),
                c = e("../../core/managee/DEventManage"), d = e("../../conslt/DEvent"), u = e("../../utils/MathUtil"),
                p = e("../../views/item/GameUserInfoView"), g = e("../../core/managee/SoundtManager"),
                m = e("../../conslt/DSound"), f = e("../managre/DataManmager"), y = e("../managre/GameMaanager"),
                v = e("../managre/AttributeManager"), I = e("../../utils/StringUtil");
            (a = h = n.DRoleStatus || (n.DRoleStatus = {})).unknow = "unknow", a.idel = "idel", a.attack = "attack", a.death = "death", a.walk = "walk", a.run = "run";
            var s = function (s) {
                function l(e, t, n, a, i, o) {
                    void 0 === o && (o = 10);
                    var r = s.call(this) || this;
                    return r.roleStatus = h.unknow, r.roleData = null, r.skinConfig = null, r.aiID = null, r.isEnemy = !1, r.loadComplete = null, r.buffs = null, r.model = null, r.modelId = null, r.energyScale = 1, r.aiConfig = null, r.aiLogic = null, r.energy = 0, r.isLoadComplete = !1, r.killNum = 0, r.reLiveTimes = 0, r.maxLv = 1, r.isVisible = !1, r.modelOringeScale = 1, r.configSize = null, r.speedRate = 1, r.level = 0, r.attactRadius = 0, r.bounds = null, r.isProtect = !1, r.protectTime = 0, r.attack = .003, r.skinAddAttackRadio = 1, r.skinAddSpeedRadio = 1, r.attacking = !1, r.scale = 1, r.backAni = null, r.backAnimating = !1, r.lastX = 0, r.lastY = 0, r.coliObj = null, r.userInfoView = null, r.updateUserInfoCount = 0, r.refreshCount = 0, r.roleData = e, r.skinConfig = t, r.aiID = n, r.isEnemy = a, r.loadComplete = i, r.buffs = {}, r.refreshCount = o % l.totalRefreshCount, r.reset(), r.initData(), r.initRole(), r.skinConfig && (r.skinAddAttackRadio = r.skinConfig.attrPower / 100, r.skinAddSpeedRadio = r.skinConfig.attrSpeed / 100), r
                }

                return __extends(l, s), Object.defineProperty(l.prototype, "roleName", {
                    get: function () {
                        return this.roleData && this.roleData.name || ""
                    }, enumerable: !0, configurable: !0
                }), l.prototype.initData = function () {
                    this.userInfoView = new p.default;
                    var e = null;
                    this.isEnemy && (e = I.StringUtils.getAvatarUrl(this.roleData.head)), this.userInfoView.updateLevel(1, 0), this.userInfoView.updateUserName(this.roleData.name, e), this.modelId = f.DataManmager.roleModelID, this.energyScale = 1, this.aiID ? (this.aiConfig = f.DataManmager.Instance.aiProperty[this.aiID], this.aiLogic = r.default.create(this, this.aiID), this.rawSpeed = .5) : (this.rawSpeed = f.DataManmager.Instance.getSpeed(), this.energyScale = f.DataManmager.Instance.getScore());
                    this.energy = 0, this.updateLevelInfo(1), this.alive = !0, this.isLoadComplete = !1, this.killNum = 0, this.reLiveTimes = 0, this.setProtect(!1, 0), this.maxLv = 1, this.isVisible = !0
                }, l.prototype.initRole = function () {
                    var i = this;
                    this.model = o.default.create(null, this.modelId, new Laya.Handler(this, function () {
                        i.model.setLocalPosition(.1, .01, 0), i.setInitPos(.1, 0), i.model.setLocalRotation(180, 0, 0), i.modelOringeScale = .07, i.setScale(i.selfSizeScale * i.modelOringeScale), i.coliObj = i.model.sprite.getChildByName("colObj"), i.updateBound();
                        var e = i.model.sprite.getChildAt(0);
                        if (e.skinnedMeshRenderer) {
                            var t = new Laya.BlinnPhongMaterial;
                            t.specularColor = new Laya.Vector4(0, 0, 0, 1), t.renderMode = Laya.BlinnPhongMaterial.RENDERMODE_CUTOUT, t.enableLighting = !0, t.albedoIntensity = 1, t.shininess = 1, t.albedoTexture = Laya.loader.getRes("dins/T-Rex_" + (i.skinConfig.id || 1) + ".jpg"), e.skinnedMeshRenderer.material = t
                        }
                        if (i.loadComplete && i.loadComplete(i), i.isLoadComplete = !0, i.model.animator) {
                            var n = i.model.animator.getControllerLayer(0), a = n._statesMap[h.attack];
                            a && (a.speed = 7), (a = n._statesMap[h.walk]) && (a.speed = 1.5)
                        }
                        i.initEvent(), i.isEnemy ? i.roleStatus = h.walk : (i.roleStatus = h.idel, i.stopFootSound()), i.model.playAnim(i.roleStatus, !0)
                    }))
                }, l.prototype.updateBound = function () {
                    this.bounds = this.model.sprite.getChildAt(0)._render.bounds.getExtent(), this.bounds && (this.bounds.x > this.bounds.z ? this.attactRadius = this.bounds.x : this.attactRadius = this.bounds.z)
                }, l.prototype.initEvent = function () {
                    this.isEnemy || c.DEventManage.Instance.on(d.DEvent.moveInputChange, this, this.monitorMoveInputChangeEvent)
                }, l.prototype.uninitEvent = function () {
                    c.DEventManage.Instance.off(d.DEvent.moveInputChange, this, this.monitorMoveInputChangeEvent)
                }, l.prototype.monitorMoveInputChangeEvent = function (e) {
                    this.isAlive() && (this.speed = e.disRate * this.getMaxSpeed(), 0 < this.speed && this.roleStatus === h.idel ? (this.roleStatus = h.walk, this.model.playAnim(this.roleStatus, !0), this.playFootSound()) : 0 === this.speed && this.roleStatus === h.walk && (this.roleStatus = h.idel, this.model.playAnim(this.roleStatus, !0), this.stopFootSound()), this.targetAngle = e.deg - f.DataManmager.cameraRotation[1])
                }, l.prototype.playFootSound = function () {
                    this.isEnemy || (g.SoundtManager.Instance.stopSound(m.DSound.footstep2), g.SoundtManager.Instance.playSound(m.DSound.footstep2, 999))
                }, l.prototype.stopFootSound = function () {
                    this.isEnemy || g.SoundtManager.Instance.stopSound(m.DSound.footstep2)
                }, l.prototype.getMaxSpeed = function () {
                    var e = .3 * this.maxSpeed * this.skinAddSpeedRadio,
                        t = this.getBuff(f.DataManmager.buffs.SPEED_UP);
                    return t ? e * t.value : e
                }, l.prototype.update = function () {
                    if (this.isAlive() && !this.backAnimating) {
                        this.updateBuff();
                        this.x, this.y, this.deltaMove;
                        if (this.isEnemy && (this.speed = this.getMaxSpeed(), Laya.timer.currFrame % l.totalRefreshCount === this.refreshCount && this.aiLogic.update()), this.lastX = this.x, this.lastY = this.y, s.prototype.update.call(this), 0 < this.speed) {
                            var e = u.default.getTidyAngle(this.curAngle) * u.default.rad1Angle - 90;
                            this.model.setLocalRotation(-e, 0, 0), this.updateBound();
                            var t = y.GameMaanager.Instance.curScene.checkInArea(this.x, this.y);
                            if (t) {
                                var n = u.default.fixPoint(t, new Laya.Vector2(this.lastX, this.lastY), new Laya.Vector2(this.x, this.y));
                                this.x = n.x, this.y = n.y
                            } else ;
                            this.setPosition(this.x, this.y)
                        }
                        this.protect(), this.isEnemy ? Laya.timer.currFrame % l.totalRefreshCount === this.refreshCount && this.checkFood() : Laya.timer.currFrame % 5 == 0 && this.checkFood()
                    }
                }, l.prototype.checkFood = function () {
                    this.isLoadComplete && (this.checkEatHuman(), this.checkEatGood(this.level), this.checkEatRole(this.level))
                }, l.prototype.updateRoleState = function () {
                    0 < this.speed ? this.roleStatus = h.walk : this.roleStatus = h.idel, this.model.playAnim(this.roleStatus, !0)
                }, l.prototype.checkEatHuman = function () {
                    var n = this, e = this.coliObj.transform.position.x, t = this.coliObj.transform.position.z,
                        a = y.GameMaanager.Instance.curScene.getRangeHuman(e, t, .1), i = 0, o = 0, r = 0;
                    if (a.forEach(function (e) {
                        if (e.isAlive()) {
                            i++;
                            var t = null;
                            e.model, e.model.sprite && (t = e.model.sprite.transform.position), n.addEnergy(e.getEnergy(), t), e.death(), y.GameMaanager.Instance.curScene.removeHuman(e), o = e.getX(), r = e.getY()
                        }
                    }), i && (this.playEatAni(h.attack), !this.isEnemy)) {
                        var s = y.GameMaanager.Instance.eatPeopleSprite;
                        s && (y.GameMaanager.Instance.curScene.floor.sprite.addChild(s), s.transform.scale = new Laya.Vector3(.3, .3, .3), s.transform.position = new Laya.Vector3(o, 0, r - .03), s.active = !1, s.active = !0), g.SoundtManager.Instance.playSound(m.DSound.Eat), "undefined" != typeof wx && wx.vibrateShort({
                            success: null,
                            fail: null,
                            complete: null
                        })
                    }
                }, l.prototype.playEatAni = function (e) {
                    var t = this;
                    this.roleStatus !== h.death && (this.roleStatus !== h.idel && this.roleStatus !== h.walk || (this.roleStatus = e, this.model.playAnim(e, !1, Laya.Handler.create(this, function () {
                        t.updateRoleState()
                    }))))
                }, l.prototype.checkEatGood = function (t) {
                    var n = this, e = this.coliObj.transform.position.x, a = this.coliObj.transform.position.z,
                        i = y.GameMaanager.Instance.curScene.getRangeGoodsByPos(e, a, .1);
                    y.GameMaanager.Instance.curScene.getUnStaticGoods(i, e, a, .1);
                    var o = 0;
                    i.forEach(function (e) {
                        e.forEach(function (e) {
                            e.isAlive() && e.isAbsorb(n, t) && (o++, n.addEnergy(e.getEnergy(), e.model.sprite.transform.position))
                        })
                    }), o && this.playEatAni(h.run)
                }, l.prototype.checkEatRole = function (n) {
                    var a = this, e = y.GameMaanager.Instance.curScene.roleArr, i = 0;
                    e.forEach(function (e) {
                        if (e !== a && e.isAlive() && e.getLevel() < n && !e.isProtect && a.checkCollisionRole(e) && (a.killNum++, a.addEnergy(e.getEnergy(), e.model.sprite.transform.position), c.DEventManage.Instance.event(d.DEvent.kill, {
                            killer: a,
                            deather: e
                        }), e.dead(!a.isEnemy), i++, !a.isEnemy)) {
                            var t = y.GameMaanager.Instance.killDinSprite;
                            t && (y.GameMaanager.Instance.curScene.floor.sprite.addChild(t), t.transform.position = e.model.sprite.transform.position, t.transform.scale = new Laya.Vector3(1.2, 1.2, 1.2), t.active = !1, t.active = !0), g.SoundtManager.Instance.playSound(m.DSound.hit)
                        }
                    }), i && (this.playEatAni(h.attack), this.isEnemy || c.DEventManage.Instance.event(d.DEvent.killNumChange, this.killNum))
                }, l.prototype.getRangeRole = function (e) {
                    var t = e.getX(), n = e.getY(), a = this.getX(), i = this.getY(),
                        o = e.configSize.devourEnemyRadius, r = this.configSize.devourEnemyRadius;
                    return Math.abs(t - a) < o + r || Math.abs(n - i) < o + r ? u.default.getDistanceSqr(t, n, a, i) : 0
                }, l.prototype.checkCollisionRole = function (e) {
                    var t = e.getX(), n = e.getY(), a = this.getX(), i = this.getY(), o = this.attactRadius,
                        r = e.attactRadius;
                    return (Math.abs(t - a) < o + r || Math.abs(n - i) < o + r) && u.default.getDistanceSqr(t, n, a, i) < o * o
                }, l.prototype.setMoveRotation = function (e) {
                    this.targetAngle = e
                }, l.prototype.getLevel = function () {
                    return this.level
                }, Object.defineProperty(l.prototype, "selfSpeedUp", {
                    get: function () {
                        return 1 + .1 * (this.level - 1)
                    }, enumerable: !0, configurable: !0
                }), l.prototype.levelUp = function () {
                    if (f.DataManmager.Instance.roleLevelData[this.level + 1] && (this.updateLevelInfo(this.level + 1), this.setScale(this.selfSizeScale * this.modelOringeScale), c.DEventManage.Instance.event(d.DEvent.PlayerLVUp, {
                        level: this.level,
                        isUser: !this.isEnemy,
                        role: this.roleData
                    }), !this.isEnemy)) {
                        var e = y.GameMaanager.Instance.levelUpSprite;
                        e && (y.GameMaanager.Instance.curScene.floor.sprite.addChild(e), e.transform.position = this.model.sprite.transform.position, e.transform.rotate(new Laya.Vector3(0, 0, 0), !0, !1), e.active = !1, e.active = !0), g.SoundtManager.Instance.playSound(m.DSound.AttrUpdate)
                    }
                }, l.prototype.updateLevelInfo = function (e) {
                    this.level = e, this.maxLv = Math.min(this.maxLv, this.level), this.configSize = f.DataManmager.Instance.roleLevelData[this.level]
                }, l.prototype.protect = function () {
                    this.isProtect && (this.protectTime -= y.GameMaanager.Instance.realDeltaTime, this.protectTime <= 0 && this.setProtect(!1, 0))
                }, l.prototype.setProtect = function (e, t) {
                    this.isProtect = e, this.protectTime = t
                }, l.prototype.dead = function (e) {
                    var t = this;
                    void 0 === e && (e = !1), this.alive = !1, this.roleStatus = h.death, this.model.playAnim(this.roleStatus, !1, Laya.Handler.create(this, function () {
                        t.model.setActive(!1), t.relive(f.DataManmager.roleReliveType.CONTINUE)
                    })), this.isEnemy ? e && g.SoundtManager.Instance.playSound(m.DSound.dinsDie) : g.SoundtManager.Instance.playSound(m.DSound.Die)
                }, Object.defineProperty(l.prototype, "selfSizeScale", {
                    get: function () {
                        var e = Math.min(6, this.level);
                        return Math.pow(1.4, Math.max(0, e - 1))
                    }, enumerable: !0, configurable: !0
                }), l.prototype.relive = function (e) {
                    if (e === f.DataManmager.roleReliveType.INIT) {
                        this.alive = !0, this.energy = 0, this.updateLevelInfo(1), this.setScale(this.selfSizeScale * this.modelOringeScale);
                        var t = u.default.getRandom(0, y.GameMaanager.Instance.initPos.length - 1);
                        this.setPosition(y.GameMaanager.Instance.initPos[t][0], y.GameMaanager.Instance.initPos[t][1]), c.DEventManage.Instance.event(d.DEvent.PlayerLVUp, {
                            level: this.level,
                            isUser: !this.isEnemy,
                            role: this.roleData
                        }), this.isEnemy || y.GameMaanager.Instance.playerCameraCtr.resetCamera()
                    } else if (e === f.DataManmager.roleReliveType.CONTINUE) {
                        this.alive = !0;
                        t = u.default.getRandom(0, y.GameMaanager.Instance.initPos.length - 1);
                        this.setPosition(y.GameMaanager.Instance.initPos[t][0], y.GameMaanager.Instance.initPos[t][1])
                    }
                    this.isEnemy ? this.roleStatus = h.walk : (this.speed = 0, this.roleStatus = h.idel, this.stopFootSound()), this.model.playAnim(this.roleStatus, !0), this.model.setActive(!0), this.reLiveTimes++, this.setProtect(!0, 5)
                }, l.prototype.addEnergy = function (e, t) {
                    if (void 0 === t && (t = null), !(e <= 0)) {
                        var n = !1, a = this.getBuff(f.DataManmager.buffs.ENERGY_UP);
                        if (a && (e = Math.floor(e * a.value), n = !0), e = Math.floor(e * this.energyScale), this.energy += e, this.energy > this.configSize.score[1] && this.levelUp(), this.userInfoView.updateLevel(this.level, this.levelProgress), !this.isEnemy && (c.DEventManage.Instance.event(d.DEvent.onAddEnergy, {
                            value: e,
                            isDouble: n
                        }), t)) {
                            var i = y.GameMaanager.Instance.converPos(t);
                            y.GameMaanager.Instance.curScene && y.GameMaanager.Instance.curScene.showScore(Math.floor(e), i)
                        }
                    }
                }, Object.defineProperty(l.prototype, "levelProgress", {
                    get: function () {
                        return 1 < this.configSize.score.length ? (this.energy - this.configSize.score[0]) / (this.configSize.score[1] - this.configSize.score[0]) : 0
                    }, enumerable: !0, configurable: !0
                }), l.prototype.setScale = function (e) {
                    this.model && this.model.setLocalScale(e), this.scale = e
                }, l.prototype.getScale = function () {
                    this.scale
                }, l.prototype.setPosition = function (e, t) {
                    if (this.model && this.model.setLocalPosition(e, .01, t), this.setInitPos(e, t), this.model && this.model.sprite) {
                        if (0 === this.updateUserInfoCount || this.isEnemy) {
                            var n = y.GameMaanager.Instance.converPos(this.model.sprite.transform.position);
                            this.userInfoView.pos(n.x, n.y - 200), this.userInfoView.scale(1.2, 1.2)
                        }
                        this.updateUserInfoCount++, 10 < this.updateUserInfoCount && (this.updateUserInfoCount = 0)
                    }
                }, l.prototype.getPosition = function () {
                    return this.model.localPosition
                }, l.prototype.getDModel = function () {
                    return this.model
                }, l.prototype.getAttackRadius = function () {
                    return this.attactRadius
                }, l.prototype.checkGoodsCollision = function (e) {
                    return !0
                }, l.prototype.getEnergy = function () {
                    return this.configSize.eatenEnergy
                }, l.prototype.isWeak = function (e) {
                    return this.getLevel() < e
                }, l.prototype.getScore = function () {
                    return this.configSize ? this.configSize.eatenEnergy : 0
                }, l.prototype.flyAwayGoods = function (e) {
                    var t = e.getPosition(), n = {x: t.x, y: t.y, z: t.z}, a = Math.min(20 * e.bounds.y, 1),
                        i = .5 < Math.random() ? 1 : -1, o = .5 < Math.random() ? 1 : -1, r = Laya.Tween.to(n, {
                            x: t.x + .1 * Math.random() * i,
                            y: t.y + a,
                            z: t.z + .1 * Math.random() * o,
                            update: new Laya.Handler(this, function () {
                                e.model && (e.model.setPosition(n.x, n.y, n.z), e.model.sprite && e.model.sprite.transform.rotate(new Laya.Vector3(3, i, o), !1, !1))
                            })
                        }, 1e3, Laya.Ease.linearIn, Laya.Handler.create(this, function () {
                            e.orbitHandler()
                        }));
                    return y.GameMaanager.Instance.curScene.spwanHumanForGoods(e), r
                }, l.prototype.updateBuff = function () {
                    for (var e in this.buffs) this.buffs[e].time -= y.GameMaanager.Instance.realDeltaTime
                }, l.prototype.getBuff = function (e) {
                    var t = this.buffs[e];
                    return t && 0 < t.time ? t : null
                }, l.prototype.dispose = function () {
                    this.loadComplete = null, this.buffs = {}, this.uninitEvent(), this.configSize = null, this.aiLogic = null, this.aiConfig = null, this.coliObj = null, this.userInfoView && (this.userInfoView.destroy(), this.userInfoView = null), this.backAni && (this.backAni.clear(), this.backAni = null), s.prototype.dispose.call(this), this.model && (this.model.dispose(), this.model = null)
                }, l.prototype.doBackAnimate = function () {
                    var e = this;
                    if (!this.backAni && this.model && this.model.sprite) {
                        var t = {x: this.x, y: this.y},
                            n = new Laya.Vector3(this.x - this.lastX, 0, this.y - this.lastY);
                        Laya.Vector3.normalize(n, n);
                        var a = {x: this.x - .2 * n.x, y: this.y - .2 * n.z};
                        this.backAnimating = !0, this.backAni = Laya.Tween.to(t, {
                            x: a.x,
                            y: a.y,
                            update: new Laya.Handler(this, function () {
                                e.model.setLocalPosition(t.x, 0, t.y)
                            })
                        }, 350, Laya.Ease.linearIn, new Laya.Handler(this, function () {
                            e.backAni = null, e.backAnimating = !1, e.lastX = a.x, e.lastY = a.y
                        }))
                    }
                }, Object.defineProperty(l.prototype, "roleAttack", {
                    get: function () {
                        var e = v.AttributeManager.Instance.getAttrAddition(v.AttributeType.power);
                        return this.attack * e * this.skinAddAttackRadio
                    }, enumerable: !0, configurable: !0
                }), l.tempRect1 = new Laya.Rectangle, l.tempRect2 = new Laya.Rectangle, l.totalRefreshCount = 10, l
            }(i.default);
            n.default = s
        }, {
            "../../conslt/DEvent": 4,
            "../../conslt/DSound": 7,
            "../../core/managee/DEventManage": 12,
            "../../core/managee/SoundtManager": 18,
            "../../utils/MathUtil": 49,
            "../../utils/StringUtil": 50,
            "../../views/item/GameUserInfoView": 69,
            "../managre/AttributeManager": 24,
            "../managre/DataManmager": 26,
            "../managre/GameMaanager": 27,
            "./DAILogic": 30,
            "./DModel": 31,
            "./MoveBasicControl": 36
        }],
        33: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("./DModel"), o = e("./Goods"), c = e("../../utils/MathUtil"), r = e("./DRole"),
                i = e("../utils/MapArray"), d = e("./Human"), s = e("../../utils/ArrayUtil"),
                l = e("../../core/managee/DEventManage"), h = e("../../conslt/DEvent"),
                u = e("../../views/item/AddScoreLabel"), p = e("../managre/GameMaanager"),
                g = e("../managre/DataManmager"), m = e("../managre/SkinManager"), f = function () {
                    function e(e, t) {
                        this.fightInfo = null, this.loadComplete = null, this.mapInfo = [], this.goodsArr = [], this.unStaticGoods = [], this.moveGoods = null, this.staticGoods = null, this.humanMap = null, this.roleArr = [], this.humanArr = [], this.initPos = [], this.blockArray = [], this.mainRole = null, this.scene = null, this.floor = null, this.modelCount = 0, this.modelLoadComplete = !1, this.lastLevel = 0, this.lastCeilX = 0, this.lastCeilY = 0, this.spawnCount = 0, this.infoLayer = null, this.fightInfo = g.DataManmager.Instance.fightSetting[e], this.loadComplete = t, 0 === this.fightInfo.type && (this.initData(), this.initScene())
                    }

                    return e.prototype.initData = function () {
                        for (var e in this.mapInfo = [], g.DataManmager.Instance.map) {
                            var t = g.DataManmager.Instance.map[e];
                            t.mapType === this.fightInfo.mapID && this.mapInfo.push(t)
                        }
                        this.goodsArr = [], this.unStaticGoods = [], this.moveGoods = new i.default, this.staticGoods = new i.default, this.humanMap = new i.default, this.roleArr = [], this.initPos = [];
                        var n = p.GameMaanager.Instance.initPos;
                        this.initPos = this.initPos.concat(n), this.lastLevel = 0, this.lastCeilX = 0, this.lastCeilY = 0, this.initBlock()
                    }, e.prototype.initBlock = function () {
                        var t = this;
                        this.blockArray = [], this.fightInfo.blockList && this.fightInfo.blockList.forEach(function (e) {
                            t.blockArray.push(new Laya.Rectangle(e.centerX - e.width / 2, e.centerY - e.height / 2, e.width, e.height))
                        })
                    }, e.prototype.getRoles = function () {
                        return this.roleArr
                    }, e.prototype.getGoods = function () {
                        return this.goodsArr
                    }, e.prototype.update = function () {
                        this.goodsArr && this.goodsArr.forEach(function (e) {
                            e.update()
                        }), this.spawnCount++, 1e4 <= this.spawnCount && (this.spwanHumanForRole(), this.spawnCount = 0)
                    }, e.prototype.setGoodsVisible = function () {
                        if (this.mainRole) {
                            var e = Math.ceil(this.mainRole.getX()), t = Math.ceil(this.mainRole.getY()),
                                n = this.mainRole.getLevel();
                            e === this.lastCeilX && t === this.lastCeilY && n === this.lastLevel || (this.lastCeilX = e, this.lastCeilY = t, this.lastLevel = n)
                        }
                    }, e.prototype.setAreaVisible = function (e, t, n) {
                        var a = this.staticGoods.getArray(e, t);
                        a && a.forEach(function (e) {
                            e.isInView = n, e.setVisible(n)
                        }), (a = this.moveGoods.getArray(e, t)) && a.forEach(function (e) {
                            e.isInView = n, e.setVisible(n)
                        })
                    }, e.prototype.isInArea = function (e, t, n, a, i) {
                        var o = a - t, r = i - n;
                        return e.x[0] <= o && o <= e.x[1] && e[o][0] <= r && r <= e[o][1]
                    }, e.prototype.initScene = function () {
                        var t = this;
                        this.scene = new Laya.Scene3D, Laya.stage.addChild(this.scene), this.scene.visible = !1, this.floor = a.default.create(this.scene, this.fightInfo.mapModel, Laya.Handler.create(this, function () {
                            t.infoLayer = new Laya.Box, t.infoLayer.size(Laya.stage.width, Laya.stage.height), Laya.stage.addChild(t.infoLayer), t.modelCount = 0, (p.GameMaanager.Instance.curScene = t).modelLoadComplete = !1;
                            for (var e = 0; e < g.DataManmager.Instance.maxLoadGoodsNum; e++) t.addArticle();
                            t.loadComplete && t.loadComplete()
                        }))
                    }, e.prototype.setBackGroundColor = function (e) {
                        this.clearColor = new Laya.Vector4(this.fightInfo.color[0] / 255, this.fightInfo.color[1] / 255, this.fightInfo.color[2] / 255, 1)
                    }, e.prototype.addArticle = function () {
                        var i = this;
                        if (this.modelCount < this.mapInfo.length) {
                            var e = this.mapInfo[this.modelCount];
                            new o.default(e, function (e) {
                                if (i.goodsArr.push(e), i.infoLayer.addChild(e.hpProgressBar), i.addArticle(), 1 === e.goodsInfo.type) for (var t = e.getRect(), n = t.x; n < t.right; n++) for (var a = t.y; a < t.bottom; a++) i.staticGoods.pushItem(n, a, e); else i.unStaticGoods.push(e)
                            });
                            this.modelCount++
                        } else this.modelLoadComplete || (this.modelLoadComplete = !0, l.DEventManage.Instance.event(h.DEvent.loadMapFinish))
                    }, e.prototype.getRangeHuman = function (e, t, n) {
                        for (var a = [], i = Math.ceil(100 * (e - n)), o = Math.ceil(100 * (e + n)), r = Math.ceil(100 * (t - n)), s = Math.ceil(100 * (t + n)), l = i; l <= o; l += 1) for (var h = r; h <= s; h += 1) {
                            var c = this.humanMap.getArray(l, h);
                            c && c.forEach(function (e) {
                                -1 === a.indexOf(e) && a.push(e)
                            })
                        }
                        return a
                    }, e.prototype.getRangeGoods = function (e, t) {
                        return this.getRangeGoodsByPos(e.getX(), e.getY(), t)
                    }, e.prototype.getRangeGoodsByPos = function (e, t, n) {
                        for (var a = [], i = Math.ceil(100 * (e - n)), o = Math.ceil(100 * (e + n)), r = Math.ceil(100 * (t - n)), s = Math.ceil(100 * (t + n)), l = i; l <= o; l += 10) for (var h = r; h <= s; h += 10) {
                            var c = this.staticGoods.getArray(l, h);
                            c && c.forEach(function (e) {
                                -1 === a.indexOf(e) && a.push(e)
                            })
                        }
                        return [a]
                    }, e.prototype.getUnStaticGoods = function (e, t, n, a) {
                        for (var i = e, o = Math.ceil(t - a), r = Math.ceil(t + a), s = Math.ceil(n - a), l = Math.ceil(n + a), h = o; h <= r; h++) for (var c = s; c <= l; c++) {
                            var d = this.moveGoods.getArray(h, c);
                            d && i.push(d)
                        }
                        return i
                    }, e.prototype.addRole = function (e, n, t) {
                        var a = this, i = g.DataManmager.Instance.getFightRole(g.DataManmager.roleNodeID + e + 1),
                            o = m.SkinManager.Instance.getRandomSkin();
                        new r.default(i, o, t, !0, function (e) {
                            a.floor.sprite.addChild(e.getDModel().sprite);
                            var t = a.getInitPos();
                            e.setPosition(t[0], t[1]), n && n(e), a.infoLayer.addChild(e.userInfoView), a.roleArr.push(e)
                        }, e)
                    }, e.prototype.createMainRole = function () {
                        var n = this, e = g.DataManmager.Instance.getFightRole(g.DataManmager.roleNodeID),
                            t = m.SkinManager.Instance.getGameSkin();
                        m.SkinManager.Instance.resetTempSkin();
                        new r.default(e, t, null, !1, function (e) {
                            n.floor.sprite.addChild(e.getDModel().sprite);
                            var t = n.getInitPos();
                            e.setPosition(t[0], t[1]), n.mainRole = e, n.roleArr.push(e), n.infoLayer.addChild(e.userInfoView)
                        })
                    }, e.prototype.spwanHumanForRole = function () {
                        var t = this;
                        this.roleArr && this.roleArr.length && this.roleArr.forEach(function (e) {
                            t.addHuman(e.getX(), 0, e.getY(), 15, 0)
                        })
                    }, e.prototype.spwanHumanForGoods = function (e) {
                        var t = Math.round(e.bounds.x * e.bounds.y * 100);
                        this.addHuman(e.getX(), .1, e.getY(), t, 1)
                    }, e.prototype.getInitPos = function () {
                        if (this.initPos && this.initPos.length || (this.initPos = [].concat(p.GameMaanager.Instance.initPos)), this.initPos.length) {
                            var e = c.default.getRandom(0, this.initPos.length - 1);
                            e >= this.initPos.length && (e = this.initPos.length - 1);
                            var t = this.initPos[e];
                            return this.initPos.splice(e, 1), t
                        }
                        return [0, 0]
                    }, e.prototype.dispose = function () {
                        var n = this;
                        this.moveGoods && (this.moveGoods.clear(), this.moveGoods = null), this.staticGoods && (this.staticGoods.clear(), this.staticGoods = null), this.humanMap && (this.humanMap.clear(), this.humanMap = null), this.humanArr.forEach(function (e, t) {
                            e && (n.humanArr.length, e.dispose())
                        }), this.humanArr.length = 0, this.humanArr = null, this.roleArr.forEach(function (e) {
                            e && e.dispose()
                        }), this.roleArr.length = 0, this.roleArr = null, this.goodsArr.forEach(function (e) {
                            e && e.dispose()
                        }), this.goodsArr.length = 0, this.goodsArr = null, this.floor && (this.floor.dispose(), this.floor = null), this.scene && (this.scene.destroy(), this.scene._animatorPool.elements = [], this.scene._opaqueQueue.clear(), this.scene = null), this.fightInfo = null, this.loadComplete = null, this.mapInfo = null, this.unStaticGoods = null, this.initPos = null, this.mainRole = null, this.blockArray = null, this.infoLayer && (this.infoLayer.removeChildren(), this.infoLayer.destroy(), this.infoLayer = null), Laya.Pool.clearBySign("model"), Laya.Pool.clearBySign("DAILogic"), Laya.Pool.clearBySign("RoleScore"), Laya.Pool.clearBySign("human"), Laya.Pool.clearBySign("AddScoreLlabel"), p.GameMaanager.Instance.curScene = null
                    }, e.prototype.addHuman = function (n, a, i, e, o) {
                        var r = this;
                        void 0 === o && (o = 0);
                        for (var s = 0, l = 0, t = function (e) {
                            0 === o ? (s = (c.default.getRandom(0, 1e4) - 5e3) / 1e5, l = (c.default.getRandom(0, 1e4) - 5e3) / 1e5, s *= 5, l *= 5, s += 0 < s ? .01 : -.01, l += 0 < l ? .01 : -.01) : (s = (c.default.getRandom(0, 5e3) - 2500) / 1e5, l = (c.default.getRandom(0, 5e3) - 2500) / 1e5, s *= 5, l *= 5);
                            var t = d.default.createHuman();
                            t.init(n + s, a, i + l, function (e) {
                                r.humanArr && r.humanArr.push(t)
                            })
                        }, h = 0; h < e; h++) t()
                    }, e.prototype.removeHuman = function (e) {
                        e && (e.dispose(), s.ArrayUtil.remove(this.humanArr, e), this.humanMap.removeItem(e.getX(), e.getY(), e), Laya.Pool.recover("human", e))
                    }, e.prototype.checkInArea = function (e, t) {
                        if (5 < e && (e = 4.9), e < -5 && (e = -4.9), 5 < t && (t = 4.9), t < -5 && (t = -4.9), this.blockArray && this.blockArray.length) for (var n = null, a = 0; a < this.blockArray.length; a++) if ((n = this.blockArray[a]).contains(e, t)) return n;
                        return null
                    }, e.prototype.showScore = function (e, t) {
                        if (0 < e) {
                            var n = u.default.createLabel();
                            n.pos(t.x, t.y - 100), n.scale(2, 2), n.updateLabel(e), this.infoLayer.addChild(n)
                        }
                    }, e
                }();
            n.default = f
        }, {
            "../../conslt/DEvent": 4,
            "../../core/managee/DEventManage": 12,
            "../../utils/ArrayUtil": 47,
            "../../utils/MathUtil": 49,
            "../../views/item/AddScoreLabel": 64,
            "../managre/DataManmager": 26,
            "../managre/GameMaanager": 27,
            "../managre/SkinManager": 29,
            "../utils/MapArray": 40,
            "./DModel": 31,
            "./DRole": 32,
            "./Goods": 34,
            "./Human": 35
        }],
        34: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var i = e("./DModel"), o = e("../../utils/MathUtil"), r = e("../../core/managee/SoundtManager"),
                s = e("../../conslt/DSound"), l = e("../managre/GameMaanager"), h = e("../managre/DataManmager"),
                a = function () {
                    function e(e, t) {
                        this.blockInfo = null, this.loadComplete = null, this.goodsInfo = null, this.isDisappear = !1, this.isAevouring = !1, this.isRealiveCD = !1, this.disappearTime = 0, this.modelAlpha = 1, this.x = 0, this.y = 0, this.z = 0, this.needAlpha = !1, this.sqrSpeed = 0, this.speed = 0, this.isInView = !0, this.model = null, this.scale = 1, this.goodsVisible = !1, this.modelParent = null, this.bounds = null, this.hp = 0, this.maxHp = 0, this.flyTween = null, this.hpProgressBar = null, this.blockInfo = e, this.loadComplete = t, this.initData(), this.initGoods()
                    }

                    return e.prototype.initData = function () {
                        this.goodsInfo = h.DataManmager.Instance.specialBattleGood[this.blockInfo.resource], this.flyTween = null, this.isDisappear = !1, this.isAevouring = !1, this.isRealiveCD = !1, this.disappearTime = 0, this.modelAlpha = 1, this.x = 0, this.y = 0, this.z = 0, this.needAlpha = !(this.goodsInfo.clarityShadow.length <= 1), this.sqrSpeed = this.goodsInfo.speed * this.goodsInfo.speed, this.speed = this.goodsInfo.speed, this.isInView = !0, this.hpProgressBar = new Laya.ProgressBar, this.hpProgressBar.skin = "common/hp.png", this.hpProgressBar.size(60, 6), this.hpProgressBar.visible = !1, this.hpProgressBar.anchorX = .5, this.hpProgressBar.anchorY = .5, this.hpProgressBar.scale(2, 2)
                    }, e.prototype.initGoods = function () {
                        var e = this, t = l.GameMaanager.Instance.getFloor();
                        t && t.sprite || Laya.timer.once(1e3, this, this.initGoods);
                        var n = this.blockInfo.coordinate[0], a = this.blockInfo.coordinate[1];
                        this.model = i.default.create(l.GameMaanager.Instance.getFloor().sprite, this.goodsInfo.modelId, Laya.Handler.create(this, function () {
                            e.setScale(h.DataManmager.goodsScale * e.goodsInfo.modelZoom), e.setPosition(n, a), e.model.setLocalRotation(-e.blockInfo.turnTo * o.default.rad1Angle, 0, 0), e.updateBound(), e.loadComplete && e.loadComplete(e)
                        }))
                    }, e.prototype.updateBound = function () {
                        this.bounds = this.model.sprite._render.bounds.getExtent(), this.hp = this.bounds.x * this.bounds.y * this.bounds.z, this.maxHp = this.hp
                    }, e.prototype.update = function () {
                        this.isAevouring || (this.isRealiveCD ? this.realive() : 1 === this.goodsInfo.type && this.isAlhpa())
                    }, e.prototype.isAlhpa = function () {
                        var e = l.GameMaanager.Instance.getFollowTarget();
                        if (e && this.needAlpha && e.getLevel() < this.goodsInfo.lv) {
                            var t = this.getPosition(), n = e.getPosition(), a = e.getAttackRadius(),
                                i = this.isCover(t.x, t.z, n.x - a, n.z + a);
                            i || (i = this.isCover(t.x, t.z, n.x + a, n.z - a)), i || (i = this.isCover(t.x, t.z, n.x, n.z)), i ? this.setAlpha(.5) : this.setAlpha(1)
                        }
                    }, e.prototype.isCover = function (e, t, n, a) {
                        return !1
                    }, e.prototype.isAlive = function () {
                        return !(this.isDisappear || this.isAevouring || this.isRealiveCD)
                    }, e.prototype.hideHP = function () {
                        this.hpProgressBar && (this.hpProgressBar.visible = !1)
                    }, e.prototype.isAbsorb = function (e, t) {
                        if (t > this.goodsInfo.lv && e.checkGoodsCollision(this)) {
                            if (this.hp -= e.roleAttack, !e.isEnemy) {
                                "undefined" != typeof wx && wx.vibrateShort({
                                    success: null,
                                    fail: null,
                                    complete: null
                                }), r.SoundtManager.Instance.playSound(s.DSound.Destruction);
                                var n = l.GameMaanager.Instance.boomWallSprite;
                                if (n) {
                                    n.transform.position = this.getPosition();
                                    var a = this.bounds.clone();
                                    Laya.Vector3.scale(a, .5, a), n.transform.scale = a, l.GameMaanager.Instance.curScene.floor.sprite.addChild(n), n.active = !1, n.active = !0
                                }
                            }
                            if (this.hpProgressBar.value = this.hp / this.maxHp, this.model && this.model.sprite) {
                                this.hpProgressBar.visible = !0;
                                var i = l.GameMaanager.Instance.converPos(this.model.sprite.transform.position);
                                this.hpProgressBar.pos(i.x, i.y)
                            }
                            if (e.isEnemy, this.hp <= 0) return this.isAevouring = !0, this.absorb(e), this.hideHP(), !0;
                            Laya.timer.once(1e3, this, this.hideHP, null, !0), e.doBackAnimate()
                        }
                        return !1
                    }, e.prototype.shake = function () {
                        this.model.setLocalRotation(this.blockInfo.turnTo * o.default.rad1Angle, (6 * Math.random() - 3) * o.default.rad1Angle, (4 * Math.random() - 3) * o.default.rad1Angle)
                    }, e.prototype.absorb = function (e) {
                        this.isAevouring = !0, this.modelParent = this.model.sprite.parent, this.flyTween && (this.flyTween.clear(), this.flyTween = null), this.flyTween = e.flyAwayGoods(this)
                    }, e.prototype.orbitHandler = function () {
                        this.isRealiveCD = !0, this.isDisappear = !0, this.isAevouring = !1, this.model && this.model.setActive(!1), this.flyTween && (this.flyTween.clear, this.flyTween = null)
                    }, e.prototype.realive = function () {
                        if (this.disappearTime += .001 * Laya.timer.delta, 20 < this.disappearTime && (this.disappearTime = 0, this.isRealiveCD = !1, this.isDisappear = !1, this.isInView)) {
                            this.model.setActive(!0), this.setScale(h.DataManmager.goodsScale * this.goodsInfo.modelZoom);
                            var e = this.blockInfo.coordinate[0], t = this.blockInfo.coordinate[1];
                            this.setPosition(e, t), this.model.setLocalRotation(-this.blockInfo.turnTo * o.default.rad1Angle, 0, 0), this.hp = this.maxHp
                        }
                    }, e.prototype.setScale = function (e) {
                        this.model && (this.model.setLocalScale(e), this.scale = e)
                    }, e.prototype.getScale = function () {
                        return this.scale
                    }, e.prototype.setVisible = function (e) {
                        this.isAlive() && this.goodsVisible !== e && (this.goodsVisible = e, this.model.setActive(e))
                    }, e.prototype.setAlpha = function (e) {
                        this.modelAlpha !== e && (this.model.setAlpha(e), this.modelAlpha = e)
                    }, e.prototype.getDModel = function () {
                        return this.model
                    }, e.prototype.getEnergy = function () {
                        return this.goodsInfo.score
                    }, e.prototype.getLevel = function () {
                        return this.goodsInfo.lv
                    }, e.prototype.getPosition = function () {
                        return this.model.localPosition
                    }, e.prototype.setPosition = function (e, t) {
                        this.x = e, this.z = t, this.model.setLocalPosition(e, 0, t)
                    }, e.prototype.getX = function () {
                        return this.x
                    }, e.prototype.getY = function () {
                        return this.z
                    }, e.prototype.getRect = function (e) {
                        void 0 === e && (e = 100);
                        var t = Math.ceil(100 * (this.x - this.bounds.x)),
                            n = Math.ceil(100 * (this.z - this.bounds.z)), a = Math.ceil(2 * this.bounds.x * 100),
                            i = Math.ceil(2 * this.bounds.z * 100);
                        return new Laya.Rectangle(t, n, a, i)
                    }, e.prototype.isWeak = function (e) {
                        return this.getLevel() <= e
                    }, e.prototype.getScore = function () {
                        return this.goodsInfo ? this.goodsInfo.score : 0
                    }, e.prototype.dispose = function () {
                        this.flyTween && (this.flyTween.clear, this.flyTween = null), this.model && (this.model.dispose(), this.model = null), this.goodsInfo = null, this.blockInfo = null, this.loadComplete = null, this.modelParent = null, this.hpProgressBar && (this.hpProgressBar.destroy(), this.hpProgressBar = null)
                    }, e
                }();
            n.default = a
        }, {
            "../../conslt/DSound": 7,
            "../../core/managee/SoundtManager": 18,
            "../../utils/MathUtil": 49,
            "../managre/DataManmager": 26,
            "../managre/GameMaanager": 27,
            "./DModel": 31
        }],
        35: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a, i, o = e("./MoveBasicControl"), r = e("./DModel"), s = e("../../utils/MathUtil"),
                l = e("../managre/GameMaanager"), h = e("../managre/DataManmager");
            (i = a = n.HumanStatus || (n.HumanStatus = {})).unknow = "unkonw", i.run = "run", i.wait = "wait";
            var c = function (t) {
                function n() {
                    var e = t.call(this) || this;
                    return e.humanStatus = a.unknow, e.model = null, e.bornPos = null, e.lastIndexX = null, e.lastIndexZ = null, e.visible = !1, e.scale = 1, e.loadCompletHandler = null, e.loaded = !1, e.isDisappear = !1, e.isAevouring = !1, e.isRealiveCD = !1, e.curY = 0, e.animating = !1, e.tempPos = {y: 0}, e
                }

                return __extends(n, t), n.createHuman = function () {
                    var e = Laya.Pool.getItemByClass("human", n);
                    return e.reset(), e
                }, n.prototype.init = function (e, t, n, a) {
                    this.loadCompletHandler = a, this.initData(e, t, n), this.initHuman()
                }, n.prototype.initData = function (e, t, n) {
                    this.lastIndexX = null, this.lastIndexZ = null, this.bornPos = new Laya.Vector3(e, t, n), this.isDisappear = !1, this.isAevouring = !1
                }, n.prototype.initHuman = function () {
                    var n = this;
                    this.loaded = !1, this.model = r.default.create(null, h.DataManmager.humanModelID, Laya.Handler.create(this, function () {
                        n.loaded = !0, n.setPosition(n.bornPos.x, n.bornPos.y, n.bornPos.y), n.setScale(.1);
                        var e = s.default.getRandom(0, 360);
                        n.targetAngle = e, e = s.default.getTidyAngle(e) * s.default.rad1Angle - 45, n.model.setLocalRotation(-e, 0, 0);
                        var t = l.GameMaanager.Instance.getFloor();
                        t && t.sprite.addChild(n.model.sprite), 0 < n.bornPos.y ? (n.humanStatus = a.wait, n.doDropDownAni()) : (n.humanStatus = a.run, n.speed = .05), n.model.playAnim(n.humanStatus, !0), n.loadCompletHandler && n.loadCompletHandler(n)
                    }))
                }, n.prototype.update = function () {
                    if (this.isAlive() && !this.animating && (this.model.sprite && (t.prototype.update.call(this), this.speed))) if (l.GameMaanager.Instance.curScene.checkInArea(this.x, this.y)) {
                        var e = this.targetAngle + s.default.getRandom(0, 280) - 140;
                        this.targetAngle = e, e = s.default.getTidyAngle(e) * s.default.rad1Angle - 45, this.model.setLocalRotation(-e, 0, 0)
                    } else this.setPosition(this.x, this.curY, this.y)
                }, n.prototype.doDropDownAni = function () {
                    this.tempPos.y = this.bornPos.y, this.animating = !0, Laya.Tween.to(this.tempPos.y, {
                        initY: 0,
                        update: new Laya.Handler(this, function () {
                            this.setPosition(this.bornPos.x, this.tempPos.y, this.bornPos.z)
                        })
                    }, 500, Laya.Ease.linearIn, new Laya.Handler(this, function () {
                        this.isAlive() && (this.speed = .05, this.humanStatus = a.run, this.model && this.model.playAnim(this.humanStatus, !0), this.animating = !1)
                    }))
                }, n.prototype.setPosition = function (e, t, n) {
                    this.model && this.model.setLocalPosition(e, t, n);
                    var a = Math.ceil(100 * e), i = Math.ceil(100 * n);
                    if (this.lastIndexX !== a || this.lastIndexZ !== i) {
                        if (l.GameMaanager.Instance.curScene && l.GameMaanager.Instance.curScene.humanMap) {
                            var o = l.GameMaanager.Instance.curScene.humanMap;
                            null !== this.lastIndexX && null !== this.lastIndexZ && o.removeItem(this.lastIndexX, this.lastIndexZ, this), o.pushItem(a, i, this)
                        }
                        this.lastIndexX = a, this.lastIndexZ = i
                    }
                    this.setInitPos(e, n)
                }, n.prototype.getX = function () {
                    return this.x
                }, n.prototype.getY = function () {
                    return this.y
                }, n.prototype.getScore = function () {
                    return 2
                }, n.prototype.getDModel = function () {
                    return this.model
                }, n.prototype.getEnergy = function () {
                    return this.getScore()
                }, n.prototype.getLevel = function () {
                    return 1
                }, n.prototype.getPosition = function () {
                    return this.model ? this.model.localPosition : null
                }, n.prototype.setVisible = function (e) {
                    this.isAlive() && this.visible !== e && (this.visible = e, this.model.setActive(e))
                }, n.prototype.setScale = function (e) {
                    this.model && (this.model.setLocalScale(e), this.scale = e)
                }, n.prototype.getScale = function () {
                    return this.scale
                }, n.prototype.dispose = function () {
                    if (t.prototype.dispose.call(this), Laya.Tween.clearAll(this.tempPos), null !== this.lastIndexX && null !== this.lastIndexZ) {
                        var e = l.GameMaanager.Instance.curScene.humanMap;
                        e && e.removeItem(this.lastIndexX, this.lastIndexZ, this)
                    }
                    this.lastIndexX = null, this.lastIndexZ = null, this.loadCompletHandler = null, this.model && (this.model.dispose(), this.model = null), Laya.Pool.recover("human", this)
                }, n.prototype.isWeak = function (e) {
                    return !0
                }, n.prototype.isAlive = function () {
                    return !(this.isDisappear || this.isAevouring || this.isRealiveCD)
                }, n.prototype.death = function () {
                    this.isDisappear = !0, this.isAevouring = !0
                }, n
            }(o.default);
            n.default = c
        }, {
            "../../utils/MathUtil": 49,
            "../managre/DataManmager": 26,
            "../managre/GameMaanager": 27,
            "./DModel": 31,
            "./MoveBasicControl": 36
        }],
        36: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../utils/MathUtil"), i = e("../managre/GameMaanager"), o = e("../managre/DataManmager"),
                r = function () {
                    function e() {
                        this.speedRate = 1, this.rawSpeed = 0, this.alive = !0, this.speed = 0, this.z = 0, this.x = 0, this.y = 0, this.curAngle = 0, this.targetAngle = 0, this.angleSpeed = 0, this._range = 0, this.sqrRange = 0
                    }

                    return e.prototype.reset = function () {
                        this.z = 0, this.speedRate = 1, this.rawSpeed = 0, this.alive = !0, i.GameMaanager.Instance.addMoveCtr(this)
                    }, e.prototype.setInitPos = function (e, t) {
                        this.x = e, this.y = t
                    }, Object.defineProperty(e.prototype, "maxSpeed", {
                        get: function () {
                            return this.rawSpeed * o.DataManmager.moveSpeedUp * this.speedRate
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(e.prototype, "deltaMove", {
                        get: function () {
                            return this.speed * i.GameMaanager.Instance.deltaTime
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(e.prototype, "deltaAngle", {
                        get: function () {
                            return this.angleSpeed * i.GameMaanager.Instance.deltaTime
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(e.prototype, "range", {
                        get: function () {
                            return this._range
                        }, set: function (e) {
                            this.range = e, this.sqrRange = e * e
                        }, enumerable: !0, configurable: !0
                    }), e.prototype.rotate = function () {
                        this.curAngle = this.targetAngle
                    }, e.prototype.update = function () {
                        this.rotate(), this.move()
                    }, e.prototype.move = function () {
                        if (this.speed) {
                            var e = a.default.getTidyAngle(this.curAngle) * a.default.rad1Angle;
                            this.x += Math.cos(e) * this.deltaMove, this.y += Math.sin(e) * this.deltaMove
                        }
                    }, e.prototype.getX = function () {
                        return this.x
                    }, e.prototype.getY = function () {
                        return this.y
                    }, e.prototype.isAlive = function () {
                        return this.alive
                    }, e.prototype.dispose = function () {
                        i.GameMaanager.Instance.removeMoveCtrl(this)
                    }, e
                }();
            n.default = r
        }, {"../../utils/MathUtil": 49, "../managre/DataManmager": 26, "../managre/GameMaanager": 27}],
        37: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../conslt/DEvent"), i = e("../utils/GameUtils"), o = e("../managre/GameMaanager"),
                r = e("../managre/DataManmager"), s = e("../../core/managee/DEventManage"), l = function () {
                    function e() {
                        this.camera = null, this.cameraPos = [], this.curCameraPos = [], this.playerMoveCtr = null, this.tempX = 0, this.tempY = 0, this.tempZ = 0, this.tempVector3 = null, this.initPos = [], this.createCamera(), o.GameMaanager.Instance.addPerformCtr(this)
                    }

                    return e.prototype.createCamera = function () {
                        this.camera = new Laya.Camera(0, .01, 1e3), o.GameMaanager.Instance.curScene.scene.addChild(this.camera);
                        var e = new Laya.DirectionLight;
                        e.color = new Laya.Vector3(.875865, .9443235, .9926471), e.transform.localPosition = new Laya.Vector3(0, 10, -12), e.intensity = 1.1, e.transform.localRotationEuler = new Laya.Vector3(-50, 0, 0), e.shadow = !1, e.lightmapBakedType = 0, o.GameMaanager.Instance.curScene.scene.addChild(e), o.GameMaanager.Instance.curScene.setBackGroundColor(this.camera), this.camera.transform.localPosition = new Laya.Vector3(0, 1, -1), this.camera.transform.localRotationEuler = new Laya.Vector3(r.DataManmager.cameraRotation[0], r.DataManmager.cameraRotation[1], r.DataManmager.cameraRotation[2]), this.initPos = [.8, 1.3, 0], this.cameraPos = [], r.DataManmager.allMap ? this.cameraPos = [0, 15, 10] : this.cameraPos = [].concat(this.initPos), this.curCameraPos = [].concat(this.initPos), s.DEventManage.Instance.on(a.DEvent.PlayerLVUp, this, this.onRoleLevelUP)
                    }, e.prototype.resetCamera = function () {
                        this.cameraPos = [].concat(this.initPos), this.curCameraPos = [].concat(this.initPos)
                    }, e.prototype.getCamera = function () {
                        return this.camera
                    }, e.prototype.onRoleLevelUP = function (e) {
                        if (!r.DataManmager.allMap) {
                            var t = e;
                            if (this.playerMoveCtr && t.isUser && t.level <= 6) {
                                var n = 1.4 * this.cameraPos[1] - this.cameraPos[1],
                                    a = 1.4 * this.cameraPos[0] - this.cameraPos[0],
                                    i = 1.4 * this.cameraPos[2] - this.cameraPos[2];
                                this.cameraPos[1] = this.cameraPos[1] + n / 2, this.cameraPos[0] = this.cameraPos[0] + a / 2, this.cameraPos[2] = this.cameraPos[2] + i / 2
                            }
                        }
                    }, e.prototype.update = function () {
                        this.updatePos()
                    }, e.prototype.updatePos = function () {
                        if (this.playerMoveCtr || (this.playerMoveCtr = o.GameMaanager.Instance.getFollowTarget()), this.camera && this.playerMoveCtr) {
                            this.cameraPos[0] !== this.curCameraPos[0] && (this.curCameraPos[0] += .05 * (this.cameraPos[0] - this.curCameraPos[0])), this.cameraPos[1] !== this.curCameraPos[1] && (this.curCameraPos[1] += .05 * (this.cameraPos[1] - this.curCameraPos[1])), this.cameraPos[2] !== this.curCameraPos[2] && (this.curCameraPos[2] += .05 * (this.cameraPos[2] - this.curCameraPos[2])), this.tempX = this.playerMoveCtr.x + this.curCameraPos[0], this.tempY = this.playerMoveCtr.z + this.curCameraPos[1], this.tempZ = this.playerMoveCtr.y + this.curCameraPos[2], this.tempVector3 ? i.GameUtils.setVector3(this.tempVector3, this.tempX, this.tempY, this.tempZ) : this.tempVector3 = new Laya.Vector3(this.tempX, this.tempY, this.tempZ), this.camera.transform.localPosition = this.tempVector3
                        }
                    }, e.prototype.forceSetFollowTarget = function (e) {
                        this.playerMoveCtr = e
                    }, e.prototype.dispose = function () {
                        this.playerMoveCtr = null, s.DEventManage.Instance.off(a.DEvent.PlayerLVUp, this, this.onRoleLevelUP), o.GameMaanager.Instance.removePerformCtr(this), this.camera && (this.camera.destroy(), this.camera = null)
                    }, e
                }();
            n.default = l
        }, {
            "../../conslt/DEvent": 4,
            "../../core/managee/DEventManage": 12,
            "../managre/DataManmager": 26,
            "../managre/GameMaanager": 27,
            "../utils/GameUtils": 39
        }],
        38: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function () {
                function e() {
                }

                return e.prototype.playAnim = function (e, t) {
                    e.play(t)
                }, e.prototype.playAnimWithFunc = function (t, e, n, a) {
                    var i = this, o = function (e) {
                        1 == Math.floor(t.getCurrentAnimatorPlayState().normalizedTime) && (n.runWith(e), Laya.timer.clear(i, o))
                    };
                    t.play(e), Laya.timer.frameLoop(1, this, o, a)
                }, e.prototype.playLoopAnimWithFunc = function (n, e, a, t) {
                    var i = this, o = 0, r = function (e) {
                        var t = Math.floor(n.getCurrentAnimatorPlayState().normalizedTime);
                        o < t && (a.runWith(e) && Laya.timer.clear(i, r), o = t)
                    };
                    n.play(e), Laya.timer.frameLoop(1, this, r, t)
                }, e
            }();
            n.default = a
        }, {}],
        39: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../core/managee/DEventManage"), i = e("../../conslt/DEvent"), o = e("../../conslt/GameConst"),
                r = e("../../conslt/GlobalData"), s = e("../../utils/DateUtil"), l = e("../../sdkm/SDKManager"),
                h = e("../managre/GameShaereManager"), c = function () {
                    function e() {
                    }

                    return e.onMobile = function () {
                        return Laya.Browser.onIOS || Laya.Browser.onAndroid || Laya.Browser.onMobile
                    }, e.finishVideo = function (e) {
                        a.DEventManage.Instance.event(i.DEvent.ShowAdCompleted, e), a.DEventManage.Instance.event(i.DEvent.CloseShowAd, e)
                    }, e.getShareInfoByCfg = function (e) {
                        if (e && e.imgUrl && e.imgUrl.length && e.shareContent && e.shareContent.length) return {
                            imgUrl: e.imgUrl,
                            shareContent: e.shareContent
                        };
                        var t = o.GameConst.ShareInfoList.length;
                        if (0 < t) {
                            var n = Math.floor(Math.random() * t);
                            if (l.SDKManager.IsTouTiao() && (n = 0), n < t) return o.GameConst.ShareInfoList[n]
                        }
                        return {imgUrl: "", shareContent: ""}
                    }, e.getDeviceRatio = function () {
                        return Laya.stage.height / Laya.stage.width
                    }, e.getBannerOffset = function () {
                        return 20
                    }, e.getNormalBannerOffset = function () {
                        return 40 / r.GlobalData.windowWidth * Laya.stage.width
                    }, e.bannerMoveY = function (e) {
                        void 0 === e && (e = 0);
                        var t = 0;
                        return o.GameConst.closeLD || o.GameConst.State == o.AppState.Check || (t = 16), t + e
                    }, e.checkOverDay = function () {
                        var e = parseInt(Laya.LocalStorage.getItem("curPlayDay") || "0"), t = Date.now(),
                            n = !s.DateUtil.isSameDay(t, e);
                        return n && Laya.LocalStorage.setItem("curPlayDay", t.toString()), n
                    }, e.finishShare = function (e, t, n) {
                        void 0 === t && (t = !1), void 0 === n && (n = !1), h.GameShaereManager.Instance.onShowAdCompleted(e, n), a.DEventManage.Instance.event(i.DEvent.ShowAdCompleted, e), a.DEventManage.Instance.event(i.DEvent.CloseShowAd, e)
                    }, e.finishShareVideo = function (e) {
                        a.DEventManage.Instance.event(i.DEvent.ShowShareVideoCompleted, e), a.DEventManage.Instance.event(i.DEvent.CloseShowShareViedo, e)
                    }, e.subString = function (e, t, n) {
                        for (var a = 0, i = "", o = /[^\x00-\xff]/g, r = "", s = e.replace(o, "**").length, l = 0; l < s && (null == (r = e.charAt(l).toString()).match(o) ? a++ : a += 2, !(t < a)); l++) i += r;
                        return n && t < s && (i += "..."), i
                    }, e.clearDictionary = function (e) {
                        for (var t in e) delete e[t]
                    }, e.arrayRemove = function (e, t) {
                        var n = e.indexOf(t);
                        -1 < n && e.splice(n, 1)
                    }, e.setVector3 = function (e, t, n, a) {
                        e.x = t, e.y = n, e.z = a
                    }, e.changeSingleMeshColor = function (e, t, n) {
                        void 0 === n && (n = !0)
                    }, e
                }();
            n.GameUtils = c
        }, {
            "../../conslt/DEvent": 4,
            "../../conslt/GameConst": 8,
            "../../conslt/GlobalData": 9,
            "../../core/managee/DEventManage": 12,
            "../../sdkm/SDKManager": 42,
            "../../utils/DateUtil": 48,
            "../managre/GameShaereManager": 28
        }],
        40: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function () {
                function e() {
                    this.store = {}
                }

                return e.prototype.getArray = function (e, t) {
                    return this.store[e + ":" + t]
                }, e.prototype.pushItem = function (e, t, n) {
                    if (n) {
                        var a = e + ":" + t, i = this.store[a];
                        i || (i = [], this.store[a] = i), i.push(n)
                    }
                }, e.prototype.removeItem = function (e, t, n) {
                    var a = this.getArray(e, t);
                    if (a) for (var i = 0; i < a.length; i++) a[i] === n && (a.splice(i, 1), i--)
                }, e.prototype.clear = function () {
                    if (this.store) for (var e in this.store) this.store[e] && delete this.store[e]
                }, e
            }();
            n.default = a
        }, {}],
        41: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../core/managee/DEventManage"), i = e("../conslt/DEvent"), s = e("../game/utils/GameUtils"),
                o = e("../game/data/GameData"), r = function () {
                    function e() {
                    }

                    return e.prototype.showBanner = function (e, t, n, a, i, o, r, s) {
                        void 0 === o && (o = 0), void 0 === r && (r = 0), void 0 === s && (s = 0)
                    }, e.prototype.hideBanner = function (e) {
                    }, e.prototype.showVideo = function (e, t, n) {
                        s.GameUtils.finishVideo(e)
                    }, e.prototype.shareM = function (e, t, n, a, i, o, r) {
                        s.GameUtils.finishVideo(e)
                    }, e.prototype.postToOpenDataMessage = function (e, t) {
                    }, e.prototype.report = function (e, t) {
                    }, e.prototype.sdkLogin = function (e, t) {
                        var n = o.GameData.Instance;
                        n.user.resumePlayerInfoDefault(), n.user.loadCacheData(), n.user.nickName = "玩家10001", o.GameData.Instance.logined = !0, a.DEventManage.Instance.event(i.DEvent.userLoginFinish, {logined: !0})
                    }, e.prototype.isLowDevice = function () {
                        return !1
                    }, e.prototype.reportAnalytics = function (e) {
                    }, e.prototype.updataScoreInfo = function (e) {
                    }, e.prototype.shareVideo = function (e) {
                        s.GameUtils.finishShare(e)
                    }, e.prototype.hasOpenAD = function () {
                        return !0
                    }, e
                }();
            n.SDKDefault = r
        }, {
            "../conslt/DEvent": 4,
            "../core/managee/DEventManage": 12,
            "../game/data/GameData": 21,
            "../game/utils/GameUtils": 39
        }],
        42: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("./SDKDefault"), i = e("./SDKWeChat"), o = e("../conslt/GameConst"),
                r = e("../conslt/GlobalData"), s = e("./SDKTouTiao"), l = e("../core/network/HttpRequest"),
                h = e("./SDKQQ"), c = e("../game/utils/GameUtils"), d = function () {
                    function n() {
                    }

                    return Object.defineProperty(n, "Instance", {
                        get: function () {
                            if (null == n._instance) switch (o.GameConst.Platform) {
                                case o.Platform.Wechat:
                                    n._instance = "undefined" != typeof wx ? new i.SDKWeChat : new a.SDKDefault;
                                    break;
                                case o.Platform.TouTiao:
                                    n._instance = "undefined" != typeof wx ? new s.SDKTouTiao : new a.SDKDefault;
                                    break;
                                case o.Platform.QQ:
                                    n._instance = "undefined" != typeof wx ? new h.SDKQQ : new a.SDKDefault;
                                    break;
                                default:
                                    n._instance = new a.SDKDefault
                            }
                            return n._instance
                        }, enumerable: !0, configurable: !0
                    }), n.IsTencentGame = function () {
                        return o.GameConst.Platform == o.Platform.Wechat || o.GameConst.Platform == o.Platform.QQ
                    }, n.IsWeChat = function () {
                        return o.GameConst.Platform == o.Platform.Wechat
                    }, n.IsTouTiao = function () {
                        return o.GameConst.Platform == o.Platform.TouTiao
                    }, n.IsQQ = function () {
                        return o.GameConst.Platform == o.Platform.QQ
                    }, n.canShowWXOpenDomain = function () {
                        return !!c.GameUtils.onMobile() && (!(!n.IsTencentGame() || !o.GameConst.SupportOpenDomain) && "undefined" != typeof wx)
                    }, n.nodeReport = function (e, t) {
                        r.GlobalData.isNewPlayer && n.Instance.report(e, t)
                    }, n.shouldShowTReommend = function () {
                        return !!this.IsTouTiao() && ("undefined" != typeof wx && void 0 !== wx.createMoreGamesButton && !(this.isIos && !o.GameConst.vGameInfo.tIosRecommend))
                    }, n.postQQLoginData = function (e, t, n) {
                        var i = {gid: e, c_uid: t, lid: "" + n};
                        return new Promise(function (n, a) {
                            new l.HttpRequest(function (e, t) {
                                e ? a(e) : 0 === t.code ? n(t) : a(t)
                            }).sendPostWithUrl("https://capisdk.ggxx.net/apiunionchannels/api/mobileqq/1.0.0/login.php", i)
                        })
                    }, n
                }();
            n.SDKManager = d
        }, {
            "../conslt/GameConst": 8,
            "../conslt/GlobalData": 9,
            "../core/network/HttpRequest": 19,
            "../game/utils/GameUtils": 39,
            "./SDKDefault": 41,
            "./SDKQQ": 43,
            "./SDKTouTiao": 44,
            "./SDKWeChat": 45
        }],
        43: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var v = e("../core/managee/DEventManage"), I = e("../conslt/DEvent"), S = e("../conslt/GlobalData"),
                w = e("../conslt/GameConst"), u = e("../game/managre/GameShaereManager"),
                l = e("../game/managre/DataManmager"), h = e("../game/utils/GameUtils"), p = e("../game/data/GameData"),
                D = e("../conslt/ReporttType"), r = e("../core/managee/SoundtManager"), M = e("./SDKManager"),
                a = e("../game/conslt/OpenDataMessageType"), s = e("../core/managee/DUIManager"), i = function () {
                    function i() {
                        this.bannerAd = null, this.bannerShowInfo = {}, this.checkShared = !0, this.bannerLoadError = !1, this.info = {}, this.loginParams = {}, this.setNickNameCallback = null, this.setHeadCallback = null, this.showPos = 0, this.sharePos = 0, this.showBannerPos = 0, this.lastFetchBannerTime = 0, this.rewardedVideoAd = null, this.curShareTimer = null, this.lastEndVideoAdTime = 0, this.info = i.sInfo, this.loginParams = null, "undefined" != typeof wx && (Laya.MiniAdpter.window.wx.aldOnShareAppMessage(this.onShareAppMessage), Laya.MiniAdpter.window.wx.showShareMenu({
                            withShareTicket: !0,
                            success: function () {
                            },
                            fail: function () {
                            }
                        }), v.DEventManage.Instance.on(I.DEvent.GetFocus, this, this.onGameFocus))
                    }

                    return i.prototype.onShareAppMessage = function (e) {
                        var t = u.ShareVideoPos.DefaultShare,
                            n = l.DataManmager.Instance.getVideoShareCfg(u.ShareVideoPos.DefaultShare),
                            a = h.GameUtils.getShareInfoByCfg(n), i = a.shareContent, o = a.imgUrl, r = 0, s = "";
                        return null != p.GameData.Instance && null != p.GameData.Instance.user && (s = p.GameData.Instance.user.openid, r = p.GameData.Instance.user.uid), {
                            title: i,
                            imageUrl: o,
                            query: "inviteName=" + p.GameData.Instance.user.nickName + "&openid=" + s + "&pos=" + t + "&shareTime=" + Date.now() + "&inviteCode=" + (0 < r ? r : ""),
                            success: function (e) {
                                v.DEventManage.Instance.event(I.DEvent.ShareSuccess, {
                                    pos: 0,
                                    shareTickets: e.shareTickets,
                                    from: 1
                                })
                            }
                        }
                    }, i.prototype.sdkLogin = function (t, e) {
                        if ("undefined" != typeof wx) {
                            var n = function (e) {
                                i.sInfo.encryptedData = e.encryptedData, i.sInfo.iv = e.iv, i.sInfo.nickName = e.userInfo.nickName, i.sInfo.avatar = e.userInfo.avatarUrl, i.sInfo.sex = e.userInfo.gender, i.sInfo.city = e.userInfo.city, t.runWith(i.sInfo)
                            }, a = function (e) {
                                t.runWith(i.sInfo)
                            };
                            wx.login({
                                success: function (e) {
                                    i.sInfo.wxCode = e.code, wx.getSetting({
                                        success: function (e) {
                                            var t = e.authSetting["scope.userInfo"];
                                            !0 === t ? wx.getUserInfo({
                                                withCredentials: !0,
                                                lang: "zh_CN",
                                                success: n,
                                                fail: a,
                                                complete: null
                                            }) : a()
                                        }, fail: function () {
                                            a()
                                        }, complete: null
                                    })
                                }, fail: function () {
                                    p.GameData.Instance.loginError = !0, v.DEventManage.Instance.event(I.DEvent.userLoginFinish, {logined: !1})
                                }, complete: null, pkgName: w.GameConst.packageName
                            })
                        } else {
                            p.GameData.Instance.user.loadCacheData()
                        }
                    }, i.prototype.getSetting = function (n, a) {
                        var i = this;
                        wx.getSetting({
                            success: function (e) {
                                var t = e.authSetting;
                                !0 === t["scope.userInfo"] ? i.sdkLogin(n, a) : !1 === t["scope.userInfo"] ? i.openSetting() : t["scope.record"] ? t["scope.writePhotosAlbum"] ? t["scope.camera"] || i.sdkAuthorize("scope.camera") : i.sdkAuthorize("scope.writePhotosAlbum") : i.sdkAuthorize("scope.record")
                            }, fail: null, complete: null
                        })
                    }, i.prototype.openSetting = function () {
                        wx.openSetting({
                            success: function (e) {
                            }, fail: null, complete: null
                        })
                    }, i.prototype.sdkAuthorize = function (e) {
                        wx.authorize({
                            scope: e, success: function (e) {
                            }, fail: function () {
                            }, complete: null
                        })
                    }, i.prototype.shareM = function (e, t, n, a, i, o, r) {
                        var s = this;
                        if (void 0 === r && (r = ""), w.GameConst.IgnoreShare) v.DEventManage.Instance.event(I.DEvent.ShareSuccess, {pos: e}); else if ("undefined" != typeof wx) {
                            this.checkShared = !0, this.curShareTimer = Date.now(), this.sharePos = e;
                            var l = n, h = "";
                            null != p.GameData.Instance && null != p.GameData.Instance.user && (h = p.GameData.Instance.user.openid);
                            var c = "inviteName=" + p.GameData.Instance.user.nickName + "&openid=" + h + "&pos=" + this.sharePos + "&shareTime=" + o + "&inviteCode=" + p.GameData.Instance.user.uid + "&shareScene=" + this.sharePos,
                                d = a;
                            t && (d = canvas.toTempFilePathSync({
                                destWidth: 500,
                                destHeight: 400
                            })), wx.aldShareAppMessage({
                                title: i,
                                imageUrl: d,
                                query: c,
                                path: c,
                                ald_desc: r || "",
                                success: function (e) {
                                    v.DEventManage.Instance.event(I.DEvent.ShareSuccess, {
                                        pos: s.sharePos,
                                        shareTickets: e.shareTickets,
                                        from: l
                                    })
                                },
                                fail: function () {
                                    v.DEventManage.Instance.event(I.DEvent.ShareFail, {pos: s.sharePos, from: l})
                                },
                                cancel: function (e) {
                                    "undefined" == typeof wx || u.GameShaereManager.Instance.wxCheck() || wx.showModal({
                                        title: "提示",
                                        content: "分享到不同群才能获得奖励!",
                                        showCancel: !0,
                                        cancelText: "取消",
                                        cancelColor: "#000000",
                                        confirmText: "确定",
                                        confirmColor: "#3CC51F",
                                        success: function (e) {
                                        },
                                        fail: function () {
                                        },
                                        complete: function () {
                                        }
                                    }), s.checkShared = !1, s.curShareTimer = 0
                                }
                            }), Laya.timer.clear(this, this.onCheckShare)
                        }
                    }, i.prototype.showVideo = function (t, e, n) {
                        var a = this;
                        if (void 0 === n && (n = ""), 0 < this.lastEndVideoAdTime) {
                            var i = 7e3 - (Date.now() - this.lastEndVideoAdTime);
                            if (0 < i) return i = Math.ceil(i / 1e3), void s.DUIManager.Instance.showTips("间隔时间太短，请等待" + i + "秒")
                        }
                        if ("undefined" == typeof wx) return u.GameShaereManager.Instance.onShowAdCompleted(t), v.DEventManage.Instance.event(I.DEvent.ShowAdCompleted, t), void v.DEventManage.Instance.event(I.DEvent.CloseShowAd, t);
                        var o = "adunit-b6df9f4c85b02693";
                        null !== e && e.length && (o = e), this.showPos = t;
                        wx.getSystemInfoSync().SDKVersion;
                        wx.createRewardedVideoAd && (null == this.rewardedVideoAd && (this.rewardedVideoAd = wx.createRewardedVideoAd({adUnitId: o}), this.rewardedVideoAd.onClose(function (e) {
                            S.GlobalData.fetchingVideoAd = !1, e && e.isEnded || void 0 === e ? (u.GameShaereManager.Instance.onShowAdCompleted(t), v.DEventManage.Instance.event(I.DEvent.ShowAdCompleted, a.showPos), v.DEventManage.Instance.event(I.DEvent.CloseShowAd, a.showPos), a.lastEndVideoAdTime = Date.now(), v.DEventManage.Instance.event(I.DEvent.FinishVideoAd, a.showPos), a.report(D.ReporttType.watchADComplete)) : (v.DEventManage.Instance.event(I.DEvent.CloseShowAd, a.showPos), a.report(D.ReporttType.watchADExit)), r.SoundtManager.Instance.startAll()
                        }), this.rewardedVideoAd.onError(function (e) {
                            S.GlobalData.fetchingVideoAd && (S.GlobalData.fetchingVideoAd = !1, v.DEventManage.Instance.event(I.DEvent.FetchVideoFail, a.showPos), a.report(D.ReporttType.loadVideoError, {
                                errorCode: e.errCode,
                                errMsg: e.errMsg
                            }))
                        }), this.rewardedVideoAd.onLoad(function () {
                            S.GlobalData.fetchingVideoAd = !1
                        })), this.rewardedVideoAd.adUnitId = o, S.GlobalData.fetchingVideoAd = !0, this.rewardedVideoAd.load().then(function () {
                            S.GlobalData.fetchingVideoAd = !1, a.rewardedVideoAd.show(), r.SoundtManager.Instance.stopAll()
                        }).catch(function (e) {
                            S.GlobalData.fetchingVideoAd = !1, a.report(D.ReporttType.loadVideoError, {
                                errorCode: e.errCode,
                                errMsg: e.errMsg
                            })
                        }))
                    }, i.prototype.showBanner = function (n, e, t, a, i, o, r, s, l) {
                        var h = this;
                        if (void 0 === o && (o = 0), void 0 === r && (r = 0), void 0 === s && (s = 0), void 0 === l && (l = !1), "undefined" != typeof wx && wx.createBannerAd) {
                            var c = "adunit-d13e8f659d0a764f";
                            null != e && (c = e);
                            var d = !(c = "92e660c2cdd93fb14028225e1989d4b4");
                            this.bannerShowCount >= w.GameConst.bCount ? d = !0 : Date.now() - this.lastFetchBannerTime >= 1e3 * w.GameConst.bTimer && (d = !0), (d || this.bannerLoadError) && null != this.bannerAd && (this.bannerAd.destroy(), this.bannerAd = null, this.bannerRes = null), this.bannerLoadError = !1, this.showBannerPos = n;
                            var u = i || 300;
                            300 < (u = u / 375 * S.GlobalData.windowWidth) && (u = 300), 375 < S.GlobalData.windowWidth && (o = o / 375 * S.GlobalData.windowWidth, r = r / 375 * S.GlobalData.windowWidth);
                            var p = 10;
                            S.GlobalData.windowHeight, Laya.stage.height;
                            s = s * S.GlobalData.windowWidth / Laya.stage.width, this.bannerShowInfo.hAlign = t, this.bannerShowInfo.vAlign = a, this.bannerShowInfo.pinY = s, this.bannerShowInfo.xOffset = o, this.bannerShowInfo.yOffset = r;
                            var g = function (e, t) {
                                e.show().then(function () {
                                    setTimeout(function () {
                                        v.DEventManage.Instance.event(I.DEvent.ShowBannerCompleted, n)
                                    }, t), M.SDKManager.Instance.report(D.ReporttType.showBanner, {
                                        bannerPos: n,
                                        adUnitID: h.bannerAd.adUnitId
                                    })
                                }).catch(function (e) {
                                })
                            };
                            if (null == this.bannerAd) {
                                this.bannerShowCount = 1, this.lastFetchBannerTime = Date.now();
                                var m, f = 0;
                                u = 300, m = .5 * (S.GlobalData.windowWidth - u), f = S.GlobalData.windowHeight - 72;
                                var y = 0;
                                2 < Laya.stage.height / Laya.stage.width && (y = 100 / 2436 * Laya.stage.width), f -= y, this.bannerAd = wx.createBannerAd({
                                    adUnitId: c,
                                    style: {left: m, top: f, width: u}
                                }), this.bannerAd.lxHide = !1, this.bannerAd.onError(function (e) {
                                    h.report(D.ReporttType.loadBannerError, {
                                        errorCode: e.errCode,
                                        errMsg: e.errMsg
                                    }), h.bannerLoadError = !0
                                }), this.bannerAd.onResize(function (e) {
                                    h.report(D.ReporttType.loadBanner, {duration: (Date.now() - h.lastFetchBannerTime) / 1e3}), h.bannerRes = e, h.adjustBanner()
                                }), this.bannerAd.lxbannerLoadFinish = !1, this.bannerAd.onLoad(function () {
                                    h.bannerAd.lxbannerLoadFinish = !0, h.bannerAd.lxHide || g(h.bannerAd, p)
                                })
                            } else {
                                this.bannerAd.lxHide = !1, this.bannerRes && this.adjustBanner(), p = 0, g(this.bannerAd, p), this.bannerShowCount++
                            }
                            this.bannerAd.style && (this.bannerAd.style.width = u)
                        }
                    }, i.prototype.adjustBanner = function () {
                        var e = this.bannerShowInfo.hAlign, t = this.bannerShowInfo.vAlign, n = this.bannerShowInfo.pinY,
                            a = this.bannerShowInfo.xOffset, i = this.bannerShowInfo.yOffset;
                        if (this.bannerRes) {
                            var o = this.bannerRes;
                            if (null != this.bannerAd && null != this.bannerAd.style) {
                                if (0 == e ? this.bannerAd.style.left = 0 + a : 1 == e ? this.bannerAd.style.left = .5 * (S.GlobalData.windowWidth - o.width) + a : 2 == e && (this.bannerAd.style.left = S.GlobalData.windowWidth - o.width + a), 0 == t) this.bannerAd.style.top = 0 + i; else if (1 == t) this.bannerAd.style.top = .5 * (S.GlobalData.windowHeight - o.height) + i; else if (2 == t) {
                                    var r = 0;
                                    2 < Laya.stage.height / Laya.stage.width && (r = 100 / 2436 * Laya.stage.width), this.bannerAd.style.top = S.GlobalData.windowHeight - o.height + i - r, 0 < n && n < this.bannerAd.style.top && (this.bannerAd.style.top = n + 2)
                                }
                                var s = (this.bannerAd.style.top + o.height) * Laya.stage.width / S.GlobalData.windowWidth,
                                    l = this.bannerAd.style.top * Laya.stage.width / S.GlobalData.windowWidth;
                                v.DEventManage.Instance.event(I.DEvent.BannerPosChange, {
                                    ADPos: this.showBannerPos,
                                    bottom: s,
                                    top: l,
                                    BannerAD: this.bannerAd
                                })
                            }
                        }
                    }, i.prototype.hideBanner = function () {
                        null != this.bannerAd && (this.bannerAd.hide(), this.bannerAd.lxHide = !0)
                    }, i.prototype.report = function (e, t) {
                        wx.aldSendEvent && wx.aldSendEvent(e, t)
                    }, i.prototype.postToOpenDataMessage = function (e, t) {
                        "undefined" != typeof wx && wx.getOpenDataContext && wx.getOpenDataContext().postMessage({
                            text: "",
                            type: e,
                            data: t,
                            openid: p.GameData.Instance.user.openid
                        })
                    }, i.prototype.onCheckShare = function () {
                        if (this.checkShared && 0 < this.curShareTimer) {
                            if (Date.now() - this.curShareTimer >= w.GameConst.ShareTickTimer) {
                                var e = !(!u.GameShaereManager.Instance._callShareCfg || !u.GameShaereManager.Instance._callShareCfg.fromVideoFail);
                                h.GameUtils.finishShare(u.GameShaereManager.Instance._callShareCfg.pos, !0, e)
                            } else if ("undefined" != typeof wx && !u.GameShaereManager.Instance.wxCheck()) {
                                var t = "分享到不同群才能获得奖励!";
                                0 === this.sharePos && (t = ""), t.length && wx.showModal({
                                    title: "提示",
                                    content: "分享到不同群才能获得奖励!",
                                    showCancel: !0,
                                    cancelText: "取消",
                                    cancelColor: "#000000",
                                    confirmText: "确定",
                                    confirmColor: "#3CC51F",
                                    success: function (e) {
                                    },
                                    fail: function () {
                                    },
                                    complete: function () {
                                    }
                                })
                            }
                            this.curShareTimer = 0, this.checkShared = !1
                        }
                    }, i.prototype.onGameFocus = function () {
                        var e = this;
                        setTimeout(function () {
                            e.onCheckShare()
                        }, 100)
                    }, i.prototype.isLowDevice = function () {
                        return M.SDKManager.isAndroid && M.SDKManager.isLowDevice
                    }, i.prototype.reportAnalytics = function (e) {
                    }, i.prototype.updataScoreInfo = function (e) {
                        this.postToOpenDataMessage(a.OpenDataMessageType.updataScoreInfo, e)
                    }, i.prototype.shareVideo = function (e) {
                    }, i.prototype.hasOpenAD = function () {
                        return !1
                    }, i.sInfo = {}, i
                }();
            n.SDKQQ = i
        }, {
            "../conslt/DEvent": 4,
            "../conslt/GameConst": 8,
            "../conslt/GlobalData": 9,
            "../conslt/ReporttType": 11,
            "../core/managee/DEventManage": 12,
            "../core/managee/DUIManager": 13,
            "../core/managee/SoundtManager": 18,
            "../game/conslt/OpenDataMessageType": 20,
            "../game/data/GameData": 21,
            "../game/managre/DataManmager": 26,
            "../game/managre/GameShaereManager": 28,
            "../game/utils/GameUtils": 39,
            "./SDKManager": 42
        }],
        44: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var p = e("../conslt/DEvent"), g = e("../core/managee/DEventManage"),
                u = e("../game/managre/GameShaereManager"), l = e("../game/managre/DataManmager"),
                m = e("../game/utils/GameUtils"), f = e("../game/data/GameData"), y = e("../conslt/GameConst"),
                s = e("../core/managee/GameRecodrderManager"), v = e("../core/managee/DUIManager"),
                h = e("../conslt/ReporttType"), c = e("../core/managee/SoundtManager"), I = e("../conslt/GlobalData"),
                d = e("./SDKManager"), a = e("../core/managee/NetwrokManager"), i = function () {
                    function r() {
                        var t = this;
                        this.bannerAd = null, this.bannerAdPre = null, this.bannerZeroHeightCount = 0, this.bannerShowInfo = {}, this.bannerError = !1, this.bannerLoadFinish = !1, this.checkShared = !0, this.curShareTimer = 0, this.checkSharedVideo = !0, this.curShareVideoTimer = 0, this.info = {}, this.loginParams = {}, this.setNickNameCallback = null, this.setHeadCallback = null, this.showPos = 0, this.sharePos = 0, this.showBannerPos = 0, this.lastFetchBannerTime = 0, this.rewardedVideoAd = null, this.mta = null, this.lastEndVideoAdTime = 0, this.info = r.sInfo, this.loginParams = null, "undefined" != typeof wx && (Laya.MiniAdpter.window.wx.aldOnShareAppMessage(function (e) {
                            return t.onShareAppMessage(e)
                        }), Laya.MiniAdpter.window.wx.showShareMenu({
                            withShareTicket: !0, success: function () {
                            }, fail: function () {
                            }
                        }), g.DEventManage.Instance.on(p.DEvent.GetFocus, this, this.onGameFocus))
                    }

                    return r.prototype.onShareAppMessage = function (e) {
                        var t = u.ShareVideoPos.DefaultShare,
                            n = l.DataManmager.Instance.getVideoShareCfg(u.ShareVideoPos.DefaultShare),
                            a = m.GameUtils.getShareInfoByCfg(n), i = a.shareContent, o = a.imgUrl, r = 0;
                        this.checkShared = !0, this.curShareTimer = Date.now(), this.sharePos = 0;
                        var s = "";
                        return (u.GameShaereManager.Instance._callShareCfg = null) != f.GameData.Instance && null != f.GameData.Instance.user && (s = f.GameData.Instance.user.openid, r = f.GameData.Instance.user.uid), {
                            title: i,
                            imageUrl: o,
                            query: "inviteName=" + f.GameData.Instance.user.nickName + "&openid=" + s + "&pos=" + t + "&shareTime=" + Date.now() + "&inviteCode=" + (0 < r ? r : ""),
                            success: function (e) {
                                g.DEventManage.Instance.event(p.DEvent.ShareSuccess, {
                                    pos: 0,
                                    shareTickets: e.shareTickets,
                                    from: 1
                                })
                            }
                        }
                    }, r.prototype.sdkLogin = function (t, e) {
                        if ("undefined" != typeof wx) {
                            var i = function (e) {
                                r.sInfo.encryptedData = e.encryptedData, r.sInfo.iv = e.iv, r.sInfo.nickName = e.userInfo.nickName, r.sInfo.avatar = e.userInfo.avatarUrl, r.sInfo.sex = e.userInfo.gender, r.sInfo.city = e.userInfo.city, t.runWith(r.sInfo)
                            }, o = function (e) {
                                t.runWith(r.sInfo)
                            };
                            wx.login({
                                pkgName: "", force: !1, success: function (e) {
                                    var t = null == e.code ? "" : e.code,
                                        n = null == e.anonymousCode ? "" : e.anonymousCode, a = !0;
                                    5 < t.length ? a = !1 : n.length, r.sInfo.wxCode = t, r.sInfo.nCode = n, y.GameConst.isAnonymous = a, wx.getSetting({
                                        success: function (e) {
                                            var t = e.authSetting["scope.userInfo"];
                                            !0 === t ? wx.getUserInfo({
                                                withCredentials: !0,
                                                lang: "zh_CN",
                                                success: i,
                                                fail: o,
                                                complete: null
                                            }) : o()
                                        }, fail: function () {
                                            o()
                                        }, complete: null
                                    })
                                }, fail: function () {
                                    f.GameData.Instance.loginError = !0, g.DEventManage.Instance.event(p.DEvent.userLoginFinish, {logined: !1})
                                }, complete: null
                            })
                        } else {
                            f.GameData.Instance.user.loadCacheData()
                        }
                    }, r.prototype.getSetting = function (n, a) {
                        var i = this;
                        wx.getSetting({
                            success: function (e) {
                                var t = e.authSetting;
                                !0 === t["scope.userInfo"] ? i.sdkLogin(n, a) : !1 === t["scope.userInfo"] ? i.openSetting() : t["scope.record"] ? t["scope.writePhotosAlbum"] ? t["scope.camera"] || i.sdkAuthorize("scope.camera") : i.sdkAuthorize("scope.writePhotosAlbum") : i.sdkAuthorize("scope.record")
                            }, fail: null, complete: null
                        })
                    }, r.prototype.openSetting = function () {
                        wx.openSetting({
                            success: function (e) {
                            }, fail: null, complete: null
                        })
                    }, r.prototype.sdkAuthorize = function (e) {
                        wx.authorize({
                            scope: e, success: function (e) {
                            }, fail: function () {
                            }, complete: null
                        })
                    }, r.prototype.shareM = function (e, t, n, a, i, o, r) {
                        var s = this;
                        if (void 0 === r && (r = ""), y.GameConst.IgnoreShare) g.DEventManage.Instance.event(p.DEvent.ShareSuccess, {pos: e}); else if ("undefined" != typeof wx) {
                            this.checkShared = !0, this.curShareTimer = Date.now(), this.sharePos = e;
                            var l = n, h = "";
                            null != f.GameData.Instance && null != f.GameData.Instance.user && (h = f.GameData.Instance.user.openid);
                            var c = "inviteName=" + f.GameData.Instance.user.nickName + "&openid=" + h + "&pos=" + this.sharePos + "&shareTime=" + o + "&inviteCode=" + f.GameData.Instance.user.uid + "&shareScene=" + this.sharePos,
                                d = a;
                            t && (d = canvas.toTempFilePathSync({
                                destWidth: 500,
                                destHeight: 400
                            })), wx.aldShareAppMessage({
                                title: i, imageUrl: d, query: c, path: c, success: function (e) {
                                    g.DEventManage.Instance.event(p.DEvent.ShareSuccess, {
                                        pos: s.sharePos,
                                        shareTickets: e.shareTickets,
                                        from: l
                                    }), s.checkShared = !1, s.curShareTimer = 0, m.GameUtils.finishShare(u.GameShaereManager.Instance._callShareCfg.pos, !0)
                                }, fail: function () {
                                    g.DEventManage.Instance.event(p.DEvent.ShareFail, {pos: s.sharePos, from: l})
                                }, cancel: function (e) {
                                    v.DUIManager.Instance.showTips("请完成分享"), s.checkShared = !1, s.curShareTimer = 0
                                }
                            })
                        }
                    }, r.prototype.shareVideo = function (e) {
                        var n = this, t = Date.now(), a = "";
                        this.sharePos = e, null != f.GameData.Instance && null != f.GameData.Instance.user && (a = f.GameData.Instance.user.openid);
                        var i = "inviteName=" + f.GameData.Instance.user.nickName + "&openid=" + a + "&pos=" + this.sharePos + "&shareTime=" + t + "&inviteCode=" + f.GameData.Instance.user.uid,
                            o = s.GameRecodrderManager.Instance.videoPath;
                        if (o && o.length) {
                            var r = wx.getSystemInfoSync();
                            "Douyin" === r.appName && !0, this.checkSharedVideo = !0, this.curShareVideoTimer = Date.now(), wx.shareAppMessage({
                                channel: "video",
                                query: i,
                                path: i,
                                extra: {videoPath: o, videoTopics: y.GameConst.videoTopics},
                                success: function (e) {
                                    n.checkSharedVideo && (setTimeout(function () {
                                        m.GameUtils.finishShareVideo(n.sharePos)
                                    }, 100), n.checkSharedVideo = !1, n.curShareVideoTimer = 0)
                                },
                                fail: function (e) {
                                    if (n.checkSharedVideo) {
                                        var t = "请完成视频分享";
                                        e && e.errMsg && -1 === e.errMsg.indexOf("cancel") && (t = "分享视频失败"), v.DUIManager.Instance.showTips(t, 2e3), n.checkSharedVideo = !1, n.curShareVideoTimer = 0
                                    }
                                },
                                cancel: function (e) {
                                    n.checkSharedVideo && (v.DUIManager.Instance.showTips("请完成视频分享", 2e3), n.checkSharedVideo = !1, n.curShareVideoTimer = 0)
                                }
                            })
                        }
                    }, r.prototype.showVideo = function (t, e, n) {
                        var a = this;
                        if (void 0 === n && (n = ""), 0 < this.lastEndVideoAdTime) {
                            var i = 7e3 - (Date.now() - this.lastEndVideoAdTime);
                            if (0 < i) return i = Math.ceil(i / 1e3), void v.DUIManager.Instance.showTips("间隔时间太短，请等待" + i + "秒")
                        }
                        if ("undefined" == typeof wx) return u.GameShaereManager.Instance.onShowAdCompleted(t), g.DEventManage.Instance.event(p.DEvent.ShowAdCompleted, t), void g.DEventManage.Instance.event(p.DEvent.CloseShowAd, t);
                        var o = "1i4yu880b631bpi5kn";
                        null !== e && e.length && (o = e), this.showPos = t;
                        wx.getSystemInfoSync().SDKVersion;
                        wx.createRewardedVideoAd && (null == this.rewardedVideoAd && (this.rewardedVideoAd = wx.createRewardedVideoAd({adUnitId: o}), this.rewardedVideoAd.onClose(function (e) {
                            I.GlobalData.fetchingVideoAd = !1, e && e.isEnded || void 0 === e ? (u.GameShaereManager.Instance.onShowAdCompleted(t), g.DEventManage.Instance.event(p.DEvent.ShowAdCompleted, a.showPos), g.DEventManage.Instance.event(p.DEvent.CloseShowAd, a.showPos), a.lastEndVideoAdTime = Date.now(), g.DEventManage.Instance.event(p.DEvent.FinishVideoAd, a.showPos), a.report(h.ReporttType.watchADComplete)) : (g.DEventManage.Instance.event(p.DEvent.CloseShowAd, a.showPos), a.report(h.ReporttType.watchADExit)), c.SoundtManager.Instance.startAll()
                        }), this.rewardedVideoAd.onError(function (e) {
                            if (I.GlobalData.fetchingVideoAd) {
                                I.GlobalData.fetchingVideoAd = !1, g.DEventManage.Instance.event(p.DEvent.FetchVideoFail, a.showPos);
                                var t = u.GameShaereManager.Instance._videoCount,
                                    n = "cnt=" + t + ":code=" + (e.errCode ? e.errCode : "0") + ":msg=" + (e.errMsg || "");
                                d.SDKManager.Instance.report(h.ReporttType.loadVideoError, {info: n, count: t})
                            }
                        }), this.rewardedVideoAd.onLoad(function () {
                            I.GlobalData.fetchingVideoAd = !1;
                            var e = u.GameShaereManager.Instance._videoCount;
                            d.SDKManager.Instance.report(h.ReporttType.videoSuccess, {info: e})
                        })), this.rewardedVideoAd.adUnitId = o, I.GlobalData.fetchingVideoAd = !0, this.rewardedVideoAd.load().then(function () {
                            a.rewardedVideoAd.show(), c.SoundtManager.Instance.stopAll(), I.GlobalData.fetchingVideoAd = !1
                        }).catch(function (e) {
                            a.rewardedVideoAd.load().then(function () {
                                I.GlobalData.fetchingVideoAd = !1
                            })
                        }))
                    }, r.prototype.showBanner = function (n, e, t, a, i, o, r, s) {
                        var l = this;
                        if (void 0 === o && (o = 0), void 0 === r && (r = 0), void 0 === s && (s = 0), "undefined" != typeof wx && wx.createBannerAd) {
                            var h = "505rl6ec5ocii2gq3p";
                            null != e && (h = e);
                            var c = !1;
                            this.bannerShowCount >= y.GameConst.bCount ? c = !0 : Date.now() - this.lastFetchBannerTime >= 1e3 * y.GameConst.bTimer && (c = !0), (c || this.bannerError || !this.bannerLoadFinish) && null != this.bannerAd && (this.bannerAd.lxbannerLoadFinish ? (this.bannerAd.hide(), this.bannerAdPre = this.bannerAd) : this.bannerAd.destroy(), this.bannerAd = null, this.bannerRes = null), this.bannerError = !1, this.showBannerPos = n;
                            375 < I.GlobalData.windowHeight && (o = o / 375 * I.GlobalData.windowHeight, r = r / 375 * I.GlobalData.windowHeight);
                            var d = 10;
                            s = s * (2 * I.GlobalData.windowHeight / Laya.stage.height) / 2, this.bannerShowInfo.hAlign = t, this.bannerShowInfo.vAlign = a, this.bannerShowInfo.pinY = s, this.bannerShowInfo.xOffset = o, this.bannerShowInfo.yOffset = r;
                            var u = function (e, t) {
                                e.show().then(function () {
                                    setTimeout(function () {
                                        g.DEventManage.Instance.event(p.DEvent.ShowBannerCompleted, n)
                                    }, t)
                                }).catch(function (e) {
                                })
                            };
                            if (null == this.bannerAd) this.bannerShowCount = 1, this.lastFetchBannerTime = Date.now(), this.bannerZeroHeightCount = 0, this.bannerAd = wx.createBannerAd({
                                adUnitId: h,
                                style: {left: 0, top: 0, width: 208}
                            }), this.bannerAd.lxHide = !1, this.bannerAd.onError(function (e) {
                                l.bannerAdPre ? (l.bannerAd.destroy(), l.bannerAd = l.bannerAdPre, l.bannerAd.lxHide = !1, l.bannerError = !1, l.bannerLoadFinish = !0, d = 0, u(l.bannerAd, d), l.adjustBanner()) : l.bannerError = !0
                            }), this.bannerAd.onResize(function (e) {
                                l.bannerRes = e, l.adjustBanner()
                            }), this.bannerLoadFinish = !1, this.bannerAd.lxbannerLoadFinish = !1, this.bannerAd.onLoad(function () {
                                l.bannerLoadFinish = !0, l.bannerAd.lxbannerLoadFinish = !0, l.bannerAd.lxHide || u(l.bannerAd, d)
                            }); else this.bannerAd.lxHide = !1, this.bannerRes && this.adjustBanner(), d = 0, u(this.bannerAd, d), this.bannerShowCount++;
                            this.bannerAd.style && (this.bannerAd.style.width = 208)
                        }
                    }, r.prototype.adjustBanner = function () {
                        var e = this.bannerShowInfo.hAlign, t = this.bannerShowInfo.vAlign, n = this.bannerShowInfo.pinY,
                            a = this.bannerShowInfo.xOffset, i = this.bannerShowInfo.yOffset;
                        if (this.bannerRes) {
                            var o = this.bannerRes;
                            if (null != this.bannerAd && null != this.bannerAd.style) {
                                var r = this.bannerAd.style.left, s = this.bannerAd.style.top, l = o.width, h = o.height;
                                l < 128 && (h = (l = 208) / 16 * 9), h <= 0 && (h = l / 16 * 9), 0 == e ? (r = 0 + a, 2 < m.GameUtils.getDeviceRatio() && (r += 20)) : 1 == e ? r = .5 * (I.GlobalData.windowWidth - l) + a : 2 == e && (r = I.GlobalData.windowWidth - l + a, 2 < m.GameUtils.getDeviceRatio() && (r -= 20)), 0 == t ? s = 0 + i : 1 == t ? s = .5 * (I.GlobalData.windowHeight - h) + i : 2 == t && (s = I.GlobalData.windowHeight - h + i, 0 < n && n < s && (s = n + 2)), r == this.bannerAd.style.left && s == this.bannerAd.style.top || (this.bannerAd.style.left = r, this.bannerAd.style.top = s)
                            }
                        }
                    }, r.prototype.hideBanner = function () {
                        null != this.bannerAd && (this.bannerAd.hide(), this.bannerAd.lxHide = !0)
                    }, r.prototype.report = function (e, t) {
                        wx.aldSendEvent && wx.aldSendEvent(e, t)
                    }, r.prototype.showFriendRank = function (e, t) {
                        "undefined" != typeof wx && wx.getOpenDataContext && wx.getOpenDataContext().postMessage({
                            text: "rank",
                            type: e,
                            openid: f.GameData.Instance.user.openid,
                            info: t
                        })
                    }, r.prototype.hideFriendRank = function (e) {
                        "undefined" != typeof wx && wx.getOpenDataContext && wx.getOpenDataContext().postMessage({
                            text: "hideRank",
                            type: e,
                            openid: f.GameData.Instance.user.openid,
                            info: ""
                        })
                    }, r.prototype.showFriendRankPage = function (e, t) {
                        "undefined" != typeof wx && wx.getOpenDataContext && wx.getOpenDataContext().postMessage({
                            text: "rankPage",
                            type: e,
                            openid: f.GameData.Instance.user.openid,
                            info: t
                        })
                    }, r.prototype.queryRank = function (e, t, n) {
                        a.NetwrokManager.Instance.getRankeList(e).then(function (e) {
                            n.runWith({res: e})
                        }).catch(function (e) {
                        })
                    }, r.prototype.uploadGradeData = function (e) {
                        "undefined" != typeof wx && wx.getOpenDataContext && wx.getOpenDataContext().postMessage({
                            text: "gradeData",
                            type: "send",
                            openid: f.GameData.Instance.user.openid,
                            info: e
                        })
                    }, r.prototype.onCheckShare = function () {
                        if (this.checkShared && 0 < this.curShareTimer) {
                            if (Date.now() - this.curShareTimer >= y.GameConst.ShareTickTimer) {
                                var e = !(!u.GameShaereManager.Instance._callShareCfg || !u.GameShaereManager.Instance._callShareCfg.fromVideoFail);
                                m.GameUtils.finishShare(u.GameShaereManager.Instance._callShareCfg.pos, !0, e)
                            } else v.DUIManager.Instance.showTips("请完成分享");
                            this.curShareTimer = 0, this.checkShared = !1
                        }
                    }, r.prototype.onCheckShareVideo = function () {
                        this.checkSharedVideo && 0 < this.curShareVideoTimer && (Date.now() - this.curShareVideoTimer >= y.GameConst.ShareTickTimer ? m.GameUtils.finishShareVideo(this.sharePos) : v.DUIManager.Instance.showTips("请完成视频分享"), this.curShareVideoTimer = 0, this.checkSharedVideo = !1)
                    }, r.prototype.onGameFocus = function () {
                        var e = this;
                        setTimeout(function () {
                            e.onCheckShare(), e.onCheckShareVideo()
                        }, 10)
                    }, r.prototype.isLowDevice = function () {
                        return !1
                    }, r.prototype.reportAnalytics = function (e) {
                    }, r.prototype.postToOpenDataMessage = function (e, t) {
                    }, r.prototype.updataScoreInfo = function () {
                    }, r.prototype.hasOpenAD = function () {
                        return !0
                    }, r.sInfo = {}, r
                }();
            n.SDKTouTiao = i
        }, {
            "../conslt/DEvent": 4,
            "../conslt/GameConst": 8,
            "../conslt/GlobalData": 9,
            "../conslt/ReporttType": 11,
            "../core/managee/DEventManage": 12,
            "../core/managee/DUIManager": 13,
            "../core/managee/GameRecodrderManager": 14,
            "../core/managee/NetwrokManager": 16,
            "../core/managee/SoundtManager": 18,
            "../game/data/GameData": 21,
            "../game/managre/DataManmager": 26,
            "../game/managre/GameShaereManager": 28,
            "../game/utils/GameUtils": 39,
            "./SDKManager": 42
        }],
        45: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var g = e("../core/managee/DEventManage"), m = e("../conslt/DEvent"), f = e("../conslt/GlobalData"),
                y = e("../conslt/GameConst"), u = e("../game/managre/GameShaereManager"),
                l = e("../game/managre/DataManmager"), h = e("../game/utils/GameUtils"), p = e("../game/data/GameData"),
                v = e("../conslt/ReporttType"), r = e("../core/managee/SoundtManager"), a = e("./SDKManager"),
                o = e("../game/conslt/OpenDataMessageType"), s = e("../core/managee/DUIManager"), i = function () {
                    function i() {
                        this.bannerAd = null, this.bannerShowInfo = {}, this.checkShared = !0, this.bannerLoadError = !1, this.info = {}, this.loginParams = {}, this.setNickNameCallback = null, this.setHeadCallback = null, this.showPos = 0, this.sharePos = 0, this.showBannerPos = 0, this.lastFetchBannerTime = 0, this.rewardedVideoAd = null, this.curShareTimer = null, this.lastEndVideoAdTime = 0, this.info = i.sInfo, this.loginParams = null, "undefined" != typeof wx && (Laya.MiniAdpter.window.wx.aldOnShareAppMessage(this.onShareAppMessage), Laya.MiniAdpter.window.wx.showShareMenu({
                            withShareTicket: !0,
                            success: function () {
                            },
                            fail: function () {
                            }
                        }), g.DEventManage.Instance.on(m.DEvent.GetFocus, this, this.onGameFocus))
                    }

                    return i.prototype.onShareAppMessage = function (e) {
                        var t = u.ShareVideoPos.DefaultShare,
                            n = l.DataManmager.Instance.getVideoShareCfg(u.ShareVideoPos.DefaultShare),
                            a = h.GameUtils.getShareInfoByCfg(n), i = a.shareContent, o = a.imgUrl, r = 0, s = "";
                        return null != p.GameData.Instance && null != p.GameData.Instance.user && (s = p.GameData.Instance.user.openid, r = p.GameData.Instance.user.uid), {
                            title: i,
                            imageUrl: o,
                            query: "inviteName=" + p.GameData.Instance.user.nickName + "&openid=" + s + "&pos=" + t + "&shareTime=" + Date.now() + "&inviteCode=" + (0 < r ? r : ""),
                            success: function (e) {
                                g.DEventManage.Instance.event(m.DEvent.ShareSuccess, {
                                    pos: 0,
                                    shareTickets: e.shareTickets,
                                    from: 1
                                })
                            }
                        }
                    }, i.prototype.sdkLogin = function (t, e) {
                        if ("undefined" != typeof wx) {
                            var n = function (e) {
                                i.sInfo.encryptedData = e.encryptedData, i.sInfo.iv = e.iv, i.sInfo.nickName = e.userInfo.nickName, i.sInfo.avatar = e.userInfo.avatarUrl, i.sInfo.sex = e.userInfo.gender, i.sInfo.city = e.userInfo.city, t.runWith(i.sInfo)
                            }, a = function (e) {
                                t.runWith(i.sInfo)
                            };
                            wx.login({
                                success: function (e) {
                                    i.sInfo.wxCode = e.code, wx.getUserInfo({
                                        withCredentials: !0,
                                        lang: "zh_CN",
                                        success: n,
                                        fail: a,
                                        complete: null
                                    })
                                }, fail: function () {
                                    p.GameData.Instance.loginError = !0, g.DEventManage.Instance.event(m.DEvent.userLoginFinish, {logined: !1})
                                }, complete: null, pkgName: y.GameConst.packageName
                            })
                        } else {
                            p.GameData.Instance.user.loadCacheData()
                        }
                    }, i.prototype.getSetting = function (n, a) {
                        var i = this;
                        wx.getSetting({
                            success: function (e) {
                                var t = e.authSetting;
                                !0 === t["scope.userInfo"] ? i.sdkLogin(n, a) : !1 === t["scope.userInfo"] ? i.openSetting() : t["scope.record"] ? t["scope.writePhotosAlbum"] ? t["scope.camera"] || i.sdkAuthorize("scope.camera") : i.sdkAuthorize("scope.writePhotosAlbum") : i.sdkAuthorize("scope.record")
                            }, fail: null, complete: null
                        })
                    }, i.prototype.openSetting = function () {
                        wx.openSetting({
                            success: function (e) {
                            }, fail: null, complete: null
                        })
                    }, i.prototype.sdkAuthorize = function (e) {
                        wx.authorize({
                            scope: e, success: function (e) {
                            }, fail: function () {
                            }, complete: null
                        })
                    }, i.prototype.shareM = function (e, t, n, a, i, o, r) {
                        var s = this;
                        if (void 0 === r && (r = ""), y.GameConst.IgnoreShare) g.DEventManage.Instance.event(m.DEvent.ShareSuccess, {pos: e}); else if ("undefined" != typeof wx) {
                            this.checkShared = !0, this.curShareTimer = Date.now(), this.sharePos = e;
                            var l = n, h = "";
                            null != p.GameData.Instance && null != p.GameData.Instance.user && (h = p.GameData.Instance.user.openid);
                            var c = "inviteName=" + p.GameData.Instance.user.nickName + "&openid=" + h + "&pos=" + this.sharePos + "&shareTime=" + o + "&inviteCode=" + p.GameData.Instance.user.uid + "&shareScene=" + this.sharePos,
                                d = a;
                            t && (d = canvas.toTempFilePathSync({
                                destWidth: 500,
                                destHeight: 400
                            })), wx.aldShareAppMessage({
                                title: i,
                                imageUrl: d,
                                query: c,
                                path: c,
                                ald_desc: r || "",
                                success: function (e) {
                                    g.DEventManage.Instance.event(m.DEvent.ShareSuccess, {
                                        pos: s.sharePos,
                                        shareTickets: e.shareTickets,
                                        from: l
                                    })
                                },
                                fail: function () {
                                    g.DEventManage.Instance.event(m.DEvent.ShareFail, {pos: s.sharePos, from: l})
                                },
                                cancel: function (e) {
                                    "undefined" == typeof wx || u.GameShaereManager.Instance.wxCheck() || wx.showModal({
                                        title: "提示",
                                        content: "分享到不同群才能获得奖励!",
                                        showCancel: !0,
                                        cancelText: "取消",
                                        cancelColor: "#000000",
                                        confirmText: "确定",
                                        confirmColor: "#3CC51F",
                                        success: function (e) {
                                        },
                                        fail: function () {
                                        },
                                        complete: function () {
                                        }
                                    }), s.checkShared = !1, s.curShareTimer = 0
                                }
                            }), Laya.timer.clear(this, this.onCheckShare)
                        }
                    }, i.prototype.showVideo = function (t, e, n) {
                        var a = this;
                        if (void 0 === n && (n = ""), 0 < this.lastEndVideoAdTime) {
                            var i = 7e3 - (Date.now() - this.lastEndVideoAdTime);
                            if (0 < i) return i = Math.ceil(i / 1e3), void s.DUIManager.Instance.showTips("间隔时间太短，请等待" + i + "秒")
                        }
                        if ("undefined" == typeof wx) return u.GameShaereManager.Instance.onShowAdCompleted(t), g.DEventManage.Instance.event(m.DEvent.ShowAdCompleted, t), void g.DEventManage.Instance.event(m.DEvent.CloseShowAd, t);
                        var o = "adunit-b6df9f4c85b02693";
                        null !== e && e.length && (o = e), this.showPos = t;
                        wx.getSystemInfoSync().SDKVersion;
                        wx.createRewardedVideoAd && (null == this.rewardedVideoAd && (this.rewardedVideoAd = wx.createRewardedVideoAd({adUnitId: o}), this.rewardedVideoAd.onClose(function (e) {
                            f.GlobalData.fetchingVideoAd = !1, e && e.isEnded || void 0 === e ? (u.GameShaereManager.Instance.onShowAdCompleted(t), g.DEventManage.Instance.event(m.DEvent.ShowAdCompleted, a.showPos), g.DEventManage.Instance.event(m.DEvent.CloseShowAd, a.showPos), a.lastEndVideoAdTime = Date.now(), g.DEventManage.Instance.event(m.DEvent.FinishVideoAd, a.showPos), a.report(v.ReporttType.watchADComplete)) : (g.DEventManage.Instance.event(m.DEvent.CloseShowAd, a.showPos), a.report(v.ReporttType.watchADExit)), r.SoundtManager.Instance.startAll()
                        }), this.rewardedVideoAd.onError(function (e) {
                            f.GlobalData.fetchingVideoAd && (f.GlobalData.fetchingVideoAd = !1, g.DEventManage.Instance.event(m.DEvent.FetchVideoFail, a.showPos), a.report(v.ReporttType.loadVideoError, {
                                errorCode: e.errCode,
                                errMsg: e.errMsg
                            }))
                        }), this.rewardedVideoAd.onLoad(function () {
                            f.GlobalData.fetchingVideoAd = !1
                        })), this.rewardedVideoAd.adUnitId = o, f.GlobalData.fetchingVideoAd = !0, this.rewardedVideoAd.load().then(function () {
                            f.GlobalData.fetchingVideoAd = !1, a.rewardedVideoAd.show(), r.SoundtManager.Instance.stopAll()
                        }).catch(function (e) {
                            f.GlobalData.fetchingVideoAd = !1, a.report(v.ReporttType.loadVideoError, {
                                errorCode: e.errCode,
                                errMsg: e.errMsg
                            })
                        }))
                    }, i.prototype.showBanner = function (e, t, n, a, i, o, r, s, l) {
                        var h = this;
                        if (void 0 === o && (o = 0), void 0 === r && (r = 0), void 0 === s && (s = 0), void 0 === l && (l = !1), "undefined" != typeof wx && wx.createBannerAd) {
                            var c = "adunit-d13e8f659d0a764f";
                            null != t && (c = t);
                            var d = !1;
                            this.bannerShowCount >= y.GameConst.bCount ? d = !0 : Date.now() - this.lastFetchBannerTime >= 1e3 * y.GameConst.bTimer && (d = !0), (d || this.bannerLoadError) && null != this.bannerAd && (this.bannerAd.destroy(), this.bannerAd = null, this.bannerRes = null), this.bannerLoadError = !1, this.showBannerPos = e;
                            var u = i || 300;
                            300 < (u = u / 375 * f.GlobalData.windowHeight) && (u = 300), 375 < f.GlobalData.windowHeight && (o = o / 375 * f.GlobalData.windowHeight, r = r / 375 * f.GlobalData.windowHeight);
                            var p = 10;
                            if (s = s * (2 * f.GlobalData.windowHeight / Laya.stage.height) / 2, this.bannerShowInfo.hAlign = n, this.bannerShowInfo.vAlign = a, this.bannerShowInfo.pinY = s, this.bannerShowInfo.xOffset = o, this.bannerShowInfo.yOffset = r, null == this.bannerAd) this.bannerShowCount = 1, this.lastFetchBannerTime = Date.now(), this.bannerAd = wx.createBannerAd({
                                adUnitId: c,
                                style: {left: 0, top: 0, width: u}
                            }), this.bannerAd.onError(function (e) {
                                h.report(v.ReporttType.loadBannerError, {
                                    errorCode: e.errCode,
                                    errMsg: e.errMsg
                                }), h.bannerLoadError = !0
                            }), this.bannerAd.onResize(function (e) {
                                h.report(v.ReporttType.loadBanner, {duration: (Date.now() - h.lastFetchBannerTime) / 1e3}), h.bannerRes = e, h.adjustBanner()
                            }); else p = 0, this.bannerShowCount++, this.bannerRes && Laya.timer.once(1, this, this.adjustBanner);
                            this.bannerAd.show().then(function () {
                                h.report(v.ReporttType.showBanner, {
                                    bannerPos: e,
                                    adUnitID: h.bannerAd.adUnitId
                                }), setTimeout(function () {
                                    g.DEventManage.Instance.event(m.DEvent.ShowBannerCompleted, e)
                                }, p)
                            }).catch(function (e) {
                                h.report(v.ReporttType.loadBannerError, {
                                    errorCode: e.errCode,
                                    errMsg: e.errMsg
                                }), h.bannerLoadError = !0
                            }), this.bannerAd.style && (this.bannerAd.style.width = u)
                        }
                    }, i.prototype.adjustBanner = function () {
                        var e = this.bannerShowInfo.hAlign, t = this.bannerShowInfo.vAlign, n = this.bannerShowInfo.pinY,
                            a = this.bannerShowInfo.xOffset, i = this.bannerShowInfo.yOffset;
                        if (this.bannerRes) {
                            var o = this.bannerRes;
                            if (null != this.bannerAd && null != this.bannerAd.style) {
                                if (0 == e ? this.bannerAd.style.left = 0 + a + (2 < h.GameUtils.getDeviceRatio() ? 20 : 0) : 1 == e ? this.bannerAd.style.left = .5 * (f.GlobalData.windowWidth - o.width) + a : 2 == e && (this.bannerAd.style.left = f.GlobalData.windowWidth - o.width + a - (2 < h.GameUtils.getDeviceRatio() ? 20 : 0)), 0 == t) this.bannerAd.style.top = 0 + i; else if (1 == t) this.bannerAd.style.top = .5 * (f.GlobalData.windowHeight - o.height) + i; else if (2 == t) {
                                    var r = 0;
                                    2 < Laya.stage.height / Laya.stage.width && (r = 50 / 2436 * Laya.stage.width), this.bannerAd.style.top = f.GlobalData.windowHeight - o.height + i - r, 0 < n && n < this.bannerAd.style.top && (this.bannerAd.style.top = n + 2)
                                }
                                var s = (this.bannerAd.style.top + o.height) * Laya.stage.width / f.GlobalData.windowWidth,
                                    l = this.bannerAd.style.top * Laya.stage.width / f.GlobalData.windowWidth;
                                g.DEventManage.Instance.event(m.DEvent.BannerPosChange, {
                                    ADPos: this.showBannerPos,
                                    bottom: s,
                                    top: l,
                                    BannerAD: this.bannerAd
                                })
                            }
                        }
                    }, i.prototype.hideBanner = function () {
                        null != this.bannerAd && this.bannerAd.hide()
                    }, i.prototype.report = function (e, t) {
                        wx.aldSendEvent && wx.aldSendEvent(e, t)
                    }, i.prototype.postToOpenDataMessage = function (e, t) {
                    }, i.prototype.onCheckShare = function () {
                        if (this.checkShared && 0 < this.curShareTimer) {
                            if (Date.now() - this.curShareTimer >= y.GameConst.ShareTickTimer) {
                                var e = !(!u.GameShaereManager.Instance._callShareCfg || !u.GameShaereManager.Instance._callShareCfg.fromVideoFail);
                                h.GameUtils.finishShare(u.GameShaereManager.Instance._callShareCfg.pos, !0, e)
                            } else if ("undefined" != typeof wx && !u.GameShaereManager.Instance.wxCheck()) {
                                var t = "分享到不同群才能获得奖励!";
                                0 === this.sharePos && (t = ""), t.length && wx.showModal({
                                    title: "提示",
                                    content: "分享到不同群才能获得奖励!",
                                    showCancel: !0,
                                    cancelText: "取消",
                                    cancelColor: "#000000",
                                    confirmText: "确定",
                                    confirmColor: "#3CC51F",
                                    success: function (e) {
                                    },
                                    fail: function () {
                                    },
                                    complete: function () {
                                    }
                                })
                            }
                            this.curShareTimer = 0, this.checkShared = !1
                        }
                    }, i.prototype.onGameFocus = function () {
                        var e = this;
                        setTimeout(function () {
                            e.onCheckShare()
                        }, 100)
                    }, i.prototype.isLowDevice = function () {
                        return a.SDKManager.isAndroid && a.SDKManager.isLowDevice
                    }, i.prototype.reportAnalytics = function (e) {
                    }, i.prototype.updataScoreInfo = function (e) {
                        this.postToOpenDataMessage(o.OpenDataMessageType.updataScoreInfo, e)
                    }, i.prototype.shareVideo = function (e) {
                    }, i.prototype.hasOpenAD = function () {
                        return !1
                    }, i.sInfo = {}, i
                }();
            n.SDKWeChat = i
        }, {
            "../conslt/DEvent": 4,
            "../conslt/GameConst": 8,
            "../conslt/GlobalData": 9,
            "../conslt/ReporttType": 11,
            "../core/managee/DEventManage": 12,
            "../core/managee/DUIManager": 13,
            "../core/managee/SoundtManager": 18,
            "../game/conslt/OpenDataMessageType": 20,
            "../game/data/GameData": 21,
            "../game/managre/DataManmager": 26,
            "../game/managre/GameShaereManager": 28,
            "../game/utils/GameUtils": 39,
            "./SDKManager": 42
        }],
        46: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a, i, p = Laya.View, g = Laya.ClassUtils.regClass;
            !function (e) {
                var t = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, top: 0, right: 0, left: 0, height: 1334, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {var: "joyStickView", top: 0, right: 0, left: 0, bottom: 0},
                            compId: 3,
                            child: [{
                                type: "Image",
                                props: {
                                    y: 915,
                                    x: 254,
                                    width: 200,
                                    var: "joyStickCenter",
                                    skin: "game/circle.png",
                                    height: 200
                                },
                                compId: 5
                            }, {
                                type: "Button",
                                props: {y: 995, x: 335, width: 40, var: "joyStickBtn", stateNum: 1, height: 40},
                                compId: 6,
                                child: [{
                                    type: "Image",
                                    props: {
                                        y: 50,
                                        x: 50,
                                        width: 40,
                                        var: "thumb",
                                        skin: "game/Joystick.png",
                                        height: 40,
                                        centerY: 0,
                                        centerX: 0,
                                        anchorY: .5,
                                        anchorX: .5
                                    },
                                    compId: 7
                                }]
                            }, {
                                type: "Box",
                                props: {var: "joyStickTouch", top: 0, right: 0, left: 0, bottom: 0},
                                compId: 8
                            }]
                        }, {
                            type: "Box",
                            props: {width: 0, height: 0, centerX: 0, bottom: 300},
                            compId: 11,
                            child: [{
                                type: "Animation",
                                props: {y: 0, x: 0, visible: !1, var: "moveGuideAni", source: "ani/moveGuide.ani"},
                                compId: 10
                            }]
                        }, {
                            type: "Image",
                            props: {
                                var: "coundDownImg",
                                skin: "common/num_5.png",
                                scaleY: 1.5,
                                scaleX: 1.5,
                                centerY: -92,
                                centerX: 0,
                                anchorY: .5,
                                anchorX: .5
                            },
                            compId: 15
                        }, {
                            type: "Box",
                            props: {
                                var: "infoBox",
                                top: 90,
                                runtime: "views/runtime/UIAdapter.ts",
                                right: 0,
                                mouseThrough: !0,
                                mouseEnabled: !1,
                                left: 0,
                                height: 700
                            },
                            compId: 17,
                            child: [{
                                type: "Image",
                                props: {
                                    width: 204,
                                    var: "timeImage",
                                    top: 87,
                                    skin: "game/timeBg2.png",
                                    right: 0,
                                    height: 115
                                },
                                compId: 18,
                                child: [{
                                    type: "Label",
                                    props: {
                                        y: 56,
                                        x: 48,
                                        width: 134,
                                        var: "timeLabel",
                                        valign: "middle",
                                        text: "00:00",
                                        height: 56,
                                        fontSize: 50,
                                        color: "#f4b201",
                                        bold: !0,
                                        align: "center"
                                    },
                                    compId: 14
                                }, {
                                    type: "Label",
                                    props: {
                                        y: 3,
                                        x: 9,
                                        width: 134,
                                        valign: "middle",
                                        text: "剩余时间:",
                                        height: 56,
                                        fontSize: 30,
                                        color: "#FFFFFF",
                                        bold: !0,
                                        align: "center"
                                    },
                                    compId: 33
                                }]
                            }, {
                                type: "Image",
                                props: {
                                    width: 194,
                                    var: "killNumImage",
                                    top: 15,
                                    skin: "game/killBg2.png",
                                    right: 0,
                                    height: 53
                                },
                                compId: 19,
                                child: [{
                                    type: "Label",
                                    props: {
                                        x: 7,
                                        width: 84,
                                        valign: "middle",
                                        text: "击杀：",
                                        height: 46,
                                        fontSize: 32,
                                        color: "#FFFFFF",
                                        centerY: 0,
                                        bold: !0,
                                        align: "center"
                                    },
                                    compId: 32
                                }, {
                                    type: "Label",
                                    props: {
                                        x: 88,
                                        width: 96,
                                        var: "killNumLabel",
                                        valign: "middle",
                                        text: "14",
                                        height: 46,
                                        fontSize: 32,
                                        color: "#F4b201",
                                        centerY: 0,
                                        bold: !0,
                                        align: "center"
                                    },
                                    compId: 20
                                }]
                            }, {
                                type: "Box",
                                props: {y: -11, x: 1, width: 264, name: "rankBox", height: 170},
                                compId: 22,
                                child: [{
                                    type: "Image",
                                    props: {
                                        y: 0,
                                        x: 0,
                                        width: 264,
                                        var: "rankBg",
                                        skin: "game/rankBg.png",
                                        height: 214
                                    },
                                    compId: 23
                                }, {
                                    type: "List",
                                    props: {
                                        y: 0,
                                        x: 0,
                                        width: 264,
                                        var: "rankList",
                                        spaceY: 2,
                                        repeatY: 4,
                                        height: 170
                                    },
                                    compId: 24,
                                    child: [{
                                        type: "GameRankListItem",
                                        props: {runtime: "views/item/GameRankListItemView.ts", renderType: "render"},
                                        compId: 25
                                    }]
                                }]
                            }, {
                                type: "Image",
                                props: {y: 158, x: 2, width: 262, skin: "game/infoBg2.png", height: 59},
                                compId: 27,
                                child: [{
                                    type: "ProgressBar",
                                    props: {
                                        y: 15,
                                        x: 10,
                                        width: 150,
                                        var: "levelProgressBar",
                                        skin: "game/progessBar.png",
                                        height: 32
                                    },
                                    compId: 29,
                                    child: [{
                                        type: "Label",
                                        props: {
                                            y: -3,
                                            x: 3,
                                            width: 145,
                                            var: "progressLabel",
                                            valign: "middle",
                                            text: "300",
                                            height: 35,
                                            fontSize: 30,
                                            color: "#ffffff",
                                            align: "center"
                                        },
                                        compId: 30
                                    }]
                                }, {
                                    type: "Label",
                                    props: {
                                        y: 15,
                                        x: 169,
                                        width: 76,
                                        var: "levelLabel",
                                        valign: "middle",
                                        text: "LV: 20",
                                        height: 33,
                                        fontSize: 27,
                                        color: "#FFF332",
                                        bold: !0,
                                        align: "center"
                                    },
                                    compId: 31
                                }]
                            }]
                        }, {
                            type: "BroadcastView",
                            props: {
                                y: 297,
                                x: 132,
                                visible: !1,
                                var: "commonTips",
                                scaleY: .8,
                                scaleX: .8,
                                runtime: "views/item/BroadcastView.ts",
                                centerX: 0,
                                anchorY: .5,
                                anchorX: .5
                            },
                            compId: 26
                        }],
                        loadList: ["game/circle.png", "game/Joystick.png", "ani/moveGuide.ani", "common/num_5.png", "game/timeBg2.png", "game/killBg2.png", "game/rankBg.png", "game/infoBg2.png", "game/progessBar.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.GameViewUI = t, g("ui.GameViewUI", t);
                var n = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, top: 0, right: 0, left: 0, height: 1334, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {y: 0, x: 0, top: 0, right: 0, left: 0, bottom: 0, bgColor: "#000000", alpha: .7},
                            compId: 3
                        }, {
                            type: "Box",
                            props: {y: 0, x: 0, width: 627, height: 600, centerY: -56, centerX: 0},
                            compId: 4,
                            child: [{
                                type: "Image",
                                props: {
                                    width: 627,
                                    top: 0,
                                    skin: "common/dialogBg.png",
                                    sizeGrid: "50,50,50,50",
                                    right: 0,
                                    name: "bg",
                                    left: 0,
                                    height: 600,
                                    bottom: 0
                                },
                                compId: 10
                            }, {
                                type: "Label",
                                props: {
                                    valign: "middle",
                                    top: 36,
                                    text: "免费金币领取",
                                    name: "title",
                                    fontSize: 50,
                                    color: "#000000",
                                    centerX: 0,
                                    bold: !0,
                                    align: "center"
                                },
                                compId: 6
                            }, {
                                type: "Image",
                                props: {
                                    var: "img",
                                    skin: "common/ic_coin_more.png",
                                    scaleY: 1.2,
                                    scaleX: 1.2,
                                    centerY: -42,
                                    centerX: 0
                                },
                                compId: 11
                            }, {
                                type: "Label",
                                props: {
                                    y: 373,
                                    x: 227.669921875,
                                    var: "coinNum",
                                    text: "+500金币",
                                    strokeColor: "#000000",
                                    stroke: 2,
                                    fontSize: 40,
                                    color: "#f8d344",
                                    bold: !0
                                },
                                compId: 12
                            }, {
                                type: "Button",
                                props: {
                                    width: 278,
                                    var: "btn",
                                    stateNum: 1,
                                    skin: "common/btn.png",
                                    scaleY: 1,
                                    scaleX: 1,
                                    height: 104,
                                    centerX: 0,
                                    bottom: 38,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 13,
                                child: [{
                                    type: "Image",
                                    props: {width: 45, skin: "common/ic_vedio.png", left: 37, height: 45, centerY: 0},
                                    compId: 14
                                }, {
                                    type: "Label",
                                    props: {
                                        valign: "middle",
                                        text: "免费领取",
                                        right: 27,
                                        fontSize: 40,
                                        color: "#84442a",
                                        centerY: 0,
                                        align: "center"
                                    },
                                    compId: 15
                                }]
                            }, {
                                type: "Image",
                                props: {
                                    var: "closeBtn",
                                    skin: "common/ic_skip.png",
                                    centerX: 0,
                                    bottom: -100,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 19
                            }]
                        }],
                        animations: [{
                            nodes: [{
                                target: 13, keyframes: {
                                    scaleY: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 0
                                    }, {
                                        value: 1.1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 3
                                    }, {
                                        value: .9,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 6
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 9
                                    }, {
                                        value: 1.05,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 12
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 15
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 25
                                    }],
                                    scaleX: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 0
                                    }, {
                                        value: 1.1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 3
                                    }, {
                                        value: .9,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 6
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 9
                                    }, {
                                        value: 1.05,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 12
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 15
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 25
                                    }]
                                }
                            }], name: "heartAni", id: 1, frameRate: 24, action: 0
                        }],
                        loadList: ["common/dialogBg.png", "common/ic_coin_more.png", "common/btn.png", "common/ic_vedio.png", "common/ic_skip.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.GetMoneyViewUI = n, g("ui.GetMoneyViewUI", n);
                var a = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, top: 0, right: 0, left: 0, height: 1334, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {top: 0, right: 0, name: "bg", left: 0, bottom: 0, bgColor: "#000000", alpha: .85},
                            compId: 3
                        }, {
                            type: "Box",
                            props: {width: 750, right: 0, left: 0, height: 832, centerY: 0},
                            compId: 4,
                            child: [{
                                type: "Box",
                                props: {width: 530, height: 530, centerX: 0},
                                compId: 6,
                                child: [{
                                    type: "Animation",
                                    props: {y: 265, x: 265, var: "bgAni", source: "ani/Light.ani", autoPlay: !0},
                                    compId: 5
                                }, {
                                    type: "Image",
                                    props: {
                                        var: "gradeImage",
                                        skin: "grade/grade1.png",
                                        scaleY: 2,
                                        scaleX: 2,
                                        centerY: 0,
                                        centerX: 0
                                    },
                                    compId: 8
                                }, {
                                    type: "Label",
                                    props: {
                                        var: "gradeName",
                                        valign: "middle",
                                        text: "青铜",
                                        strokeColor: "#000000",
                                        stroke: 8,
                                        fontSize: 48,
                                        color: "#FFFFFF",
                                        centerY: 80,
                                        centerX: 0,
                                        bold: !0,
                                        align: "center"
                                    },
                                    compId: 9
                                }, {
                                    type: "Image",
                                    props: {top: 0, skin: "settlement/ic_grade_up.png", centerX: 0},
                                    compId: 7
                                }, {
                                    type: "Box",
                                    props: {right: 50, left: 50, height: 80, bottom: 0},
                                    compId: 11,
                                    child: [{
                                        type: "Label",
                                        props: {
                                            valign: "middle",
                                            text: "段位金币加成",
                                            left: 0,
                                            fontSize: 40,
                                            color: "#FFFFFF",
                                            centerY: 0,
                                            align: "center"
                                        },
                                        compId: 10
                                    }, {
                                        type: "Label",
                                        props: {
                                            var: "goldPlus",
                                            valign: "middle",
                                            text: "105%",
                                            right: 0,
                                            fontSize: 55,
                                            color: "#f8d344",
                                            centerY: 0,
                                            align: "right"
                                        },
                                        compId: 12
                                    }]
                                }, {
                                    type: "Button",
                                    props: {
                                        var: "shareBtn",
                                        top: 650,
                                        stateNum: 1,
                                        skin: "common/btn.png",
                                        centerX: 0,
                                        anchorY: .5,
                                        anchorX: .5
                                    },
                                    compId: 13,
                                    child: [{
                                        type: "Image",
                                        props: {x: 45, width: 60, skin: "common/ic_share.png", height: 60, centerY: 0},
                                        compId: 14
                                    }, {
                                        type: "Label",
                                        props: {
                                            x: 117,
                                            text: "炫耀一下",
                                            fontSize: 55,
                                            color: "#84442a",
                                            centerY: 0,
                                            bold: !0
                                        },
                                        compId: 15
                                    }]
                                }, {
                                    type: "Image",
                                    props: {
                                        x: 524,
                                        width: 50,
                                        var: "closeBtn",
                                        top: 39,
                                        skin: "common/ic_close.png",
                                        height: 50,
                                        anchorY: .5,
                                        anchorX: .5
                                    },
                                    compId: 16
                                }]
                            }]
                        }],
                        animations: [{
                            nodes: [{
                                target: 13, keyframes: {
                                    scaleY: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 0
                                    }, {
                                        value: 1.1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 3
                                    }, {
                                        value: .9,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 6
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 9
                                    }, {
                                        value: 1.05,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 12
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 15
                                    }],
                                    scaleX: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 0
                                    }, {
                                        value: 1.1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 3
                                    }, {
                                        value: .9,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 6
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 9
                                    }, {
                                        value: 1.05,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 12
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 15
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 25
                                    }]
                                }
                            }], name: "heartAni", id: 1, frameRate: 24, action: 0
                        }],
                        loadList: ["ani/Light.ani", "grade/grade1.png", "settlement/ic_grade_up.png", "common/btn.png", "common/ic_share.png", "common/ic_close.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.GradeUpViewUI = a, g("ui.GradeUpViewUI", a);
                var i = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, top: 0, right: 0, left: 0, height: 1334, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {
                                top: 0,
                                runtime: "views/runtime/UIAdapter.ts",
                                right: 0,
                                name: "scale",
                                left: 0,
                                bottom: 0
                            },
                            compId: 3,
                            child: [{
                                type: "Image",
                                props: {top: 0, skin: "loading/load_bg.jpg", right: 0, left: 0, bottom: 0},
                                compId: 4
                            }]
                        }, {
                            type: "Box",
                            props: {width: 407, height: 40, centerX: 0, bottom: 147},
                            compId: 9,
                            child: [{
                                type: "Image",
                                props: {y: 0, x: 0, width: 407, skin: "loading/loading_progress_bg.png", height: 40},
                                compId: 15
                            }, {
                                type: "Image",
                                props: {
                                    y: 0,
                                    x: 0,
                                    width: 407,
                                    skin: "loading/loading_progress.png",
                                    sizeGrid: "17,51,22,40",
                                    height: 40
                                },
                                compId: 8,
                                child: [{
                                    type: "Sprite",
                                    props: {
                                        y: 1,
                                        x: 0,
                                        width: 395,
                                        var: "progressImageMask",
                                        renderType: "mask",
                                        height: 36
                                    },
                                    compId: 10
                                }]
                            }, {
                                type: "Label",
                                props: {
                                    width: 410,
                                    var: "loadingLabel",
                                    valign: "middle",
                                    text: "100%",
                                    strokeColor: "#549FE4",
                                    stroke: 4,
                                    right: 0,
                                    left: -3,
                                    height: 40,
                                    fontSize: 40,
                                    color: "#FFFFFF",
                                    bottom: -40,
                                    align: "center"
                                },
                                compId: 11
                            }, {
                                type: "Label",
                                props: {
                                    y: -56,
                                    x: 2.5,
                                    width: 402,
                                    valign: "middle",
                                    text: "素材加载中",
                                    strokeColor: "#549FE4",
                                    stroke: 2,
                                    height: 67,
                                    fontSize: 30,
                                    color: "#FFFFFF",
                                    align: "center"
                                },
                                compId: 12
                            }]
                        }, {
                            type: "Label",
                            props: {
                                x: 120,
                                wordWrap: !0,
                                width: 486,
                                valign: "middle",
                                text: "抵制不良游戏,拒绝盗版游戏。注意自我保护,谨防受骗上当。适度游戏益脑,沉迷游戏伤身。合理安排时间,享受健康生活。",
                                strokeColor: "#549FE4",
                                stroke: 2,
                                leading: 7,
                                height: 58,
                                fontSize: 18,
                                color: "#FFFFFF",
                                bottom: 30,
                                align: "center"
                            },
                            compId: 13
                        }, {type: "Image", props: {y: 105, skin: "loading/logo.png", centerX: 0}, compId: 14}],
                        loadList: ["loading/load_bg.jpg", "loading/loading_progress_bg.png", "loading/loading_progress.png", "loading/logo.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.LoadingViewUI = i, g("ui.LoadingViewUI", i);
                var o = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, top: 0, right: 0, left: 0, height: 1334, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {top: 0, right: 0, left: 0, bottom: 0, bgColor: "#000000", alpha: .7},
                            compId: 18
                        }, {
                            type: "Box",
                            props: {width: 627, height: 500, centerY: -56, centerX: 0},
                            compId: 3,
                            child: [{
                                type: "Image",
                                props: {
                                    y: -311,
                                    x: -62,
                                    width: 627,
                                    top: 0,
                                    skin: "common/dialogBg.png",
                                    sizeGrid: "50,50,50,50",
                                    right: 0,
                                    name: "bg",
                                    left: 0,
                                    height: 500,
                                    bottom: 0
                                },
                                compId: 19
                            }, {
                                type: "Label",
                                props: {
                                    valign: "middle",
                                    top: 36,
                                    text: "匹配中",
                                    name: "title",
                                    fontSize: 50,
                                    color: "#000000",
                                    centerX: 0,
                                    bold: !0,
                                    align: "center"
                                },
                                compId: 7
                            }, {
                                type: "Box",
                                props: {y: 110, width: 627, left: 0, height: 393, bgColor: "#F4EFD1"},
                                compId: 8,
                                child: [{
                                    type: "List",
                                    props: {
                                        y: 30,
                                        width: 602,
                                        var: "matchList",
                                        spaceY: 6,
                                        spaceX: 25,
                                        repeatY: 3,
                                        repeatX: 5,
                                        height: 315,
                                        centerX: 0
                                    },
                                    compId: 16,
                                    child: [{
                                        type: "MatchPlayerItemView",
                                        props: {runtime: "views/item/MatchPlayerItemView.ts", renderType: "render"},
                                        compId: 17
                                    }]
                                }]
                            }]
                        }],
                        loadList: ["common/dialogBg.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.QuickBattleMatchUI = o, g("ui.QuickBattleMatchUI", o);
                var r = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, height: 1334},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {top: 0, right: 0, name: "bg", left: 0, bottom: 0, bgColor: "#000000", alpha: .7},
                            compId: 3
                        }, {
                            type: "Box",
                            props: {width: 704, height: 1e3, centerY: 0, centerX: 0},
                            compId: 4,
                            child: [{
                                type: "Image",
                                props: {
                                    top: 0,
                                    skin: "rank/bg_rank.png",
                                    sizeGrid: "30,30,30,30",
                                    right: 0,
                                    left: 0,
                                    bottom: 0
                                },
                                compId: 5
                            }, {
                                type: "Box",
                                props: {top: -95, right: 0, name: "tabView", left: 0, height: 95},
                                compId: 6,
                                child: [{
                                    type: "Image",
                                    props: {var: "friendBtn", skin: "rank/btn_friend_sel.png", centerX: -155},
                                    compId: 7
                                }, {
                                    type: "Image",
                                    props: {var: "worldBtn", skin: "rank/btn_world.png", centerX: 155},
                                    compId: 8
                                }]
                            }, {
                                type: "Box",
                                props: {width: 681, top: 20, height: 805, centerX: 0},
                                compId: 10,
                                child: [{
                                    type: "Box",
                                    props: {var: "worldView", top: 0, right: 0, left: 0, bottom: 0},
                                    compId: 12,
                                    child: [{
                                        type: "List",
                                        props: {
                                            y: 0,
                                            width: 652,
                                            spaceY: 2,
                                            spaceX: 0,
                                            repeatY: 5,
                                            repeatX: 1,
                                            height: 665,
                                            centerX: 0
                                        },
                                        compId: 13,
                                        child: [{
                                            type: "Box",
                                            props: {width: 652, renderType: "render", name: "rankItem", height: 133},
                                            compId: 14,
                                            child: [{
                                                type: "Image",
                                                props: {width: 652, skin: "rank/bg_rank_item.png", height: 133},
                                                compId: 15
                                            }]
                                        }]
                                    }]
                                }, {
                                    type: "WXOpenDataViewer",
                                    props: {
                                        y: 0,
                                        x: 0,
                                        width: 681,
                                        var: "wxOpen",
                                        iconSign: "wx",
                                        height: 805,
                                        runtime: "laya.ui.WXOpenDataViewer"
                                    },
                                    compId: 11
                                }]
                            }, {
                                type: "Label",
                                props: {
                                    text: ">>点击任意空白区域关闭<<",
                                    fontSize: 30,
                                    color: "#FFFFFF",
                                    centerX: 0,
                                    bottom: -50,
                                    bold: !0,
                                    alpha: .7
                                },
                                compId: 9
                            }]
                        }],
                        loadList: ["rank/bg_rank.png", "rank/btn_friend_sel.png", "rank/btn_world.png", "rank/bg_rank_item.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.RankViewUI = r, g("ui.RankViewUI", r);
                var s = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, top: 0, right: 0, left: 0, height: 1334, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {y: 0, x: 0, top: 0, right: 0, left: 0, bottom: 0, bgColor: "#000000", alpha: .7},
                            compId: 3
                        }, {
                            type: "Box",
                            props: {x: 0, width: 627, height: 560, centerY: -60, centerX: 0},
                            compId: 4,
                            child: [{
                                type: "Image",
                                props: {
                                    width: 627,
                                    top: 0,
                                    skin: "common/dialogBg.png",
                                    sizeGrid: "50,50,50,50",
                                    right: 0,
                                    name: "bg",
                                    left: 0,
                                    height: 650,
                                    bottom: 0
                                },
                                compId: 5
                            }, {
                                type: "Label",
                                props: {
                                    valign: "middle",
                                    top: 36,
                                    text: "录屏成功",
                                    name: "title",
                                    fontSize: 50,
                                    color: "#000000",
                                    centerX: 0,
                                    bold: !0,
                                    align: "center"
                                },
                                compId: 6
                            }, {
                                type: "Image",
                                props: {
                                    var: "img",
                                    skin: "settlement/record_share.png",
                                    scaleY: 1,
                                    scaleX: 1,
                                    centerY: 9,
                                    centerX: 0
                                },
                                compId: 7
                            }, {
                                type: "Label",
                                props: {
                                    y: 470,
                                    text: "录屏成功,赶快发给好友炫耀一下吧!",
                                    fontSize: 35,
                                    color: "#2f195f",
                                    centerX: 0,
                                    bold: !0
                                },
                                compId: 8
                            }, {
                                type: "Button",
                                props: {
                                    width: 278,
                                    var: "btn",
                                    stateNum: 1,
                                    skin: "common/btn.png",
                                    scaleY: 1,
                                    scaleX: 1,
                                    height: 104,
                                    centerX: 0,
                                    bottom: -150,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 9,
                                child: [{
                                    type: "Label",
                                    props: {
                                        valign: "middle",
                                        text: "好的",
                                        fontSize: 40,
                                        color: "#84442a",
                                        centerY: 0,
                                        centerX: 0,
                                        align: "center"
                                    },
                                    compId: 11
                                }]
                            }, {
                                type: "Image",
                                props: {
                                    width: 50,
                                    var: "closeBtn",
                                    top: 30,
                                    skin: "common/ic_close.png",
                                    right: 20,
                                    height: 50,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 12
                            }]
                        }],
                        animations: [{
                            nodes: [{
                                target: 9, keyframes: {
                                    scaleY: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleY",
                                        index: 0
                                    }, {
                                        value: 1.1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleY",
                                        index: 3
                                    }, {
                                        value: .9,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleY",
                                        index: 6
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleY",
                                        index: 9
                                    }, {
                                        value: 1.05,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleY",
                                        index: 12
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleY",
                                        index: 15
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleY",
                                        index: 25
                                    }],
                                    scaleX: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleX",
                                        index: 0
                                    }, {
                                        value: 1.1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleX",
                                        index: 3
                                    }, {
                                        value: .9,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleX",
                                        index: 6
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleX",
                                        index: 9
                                    }, {
                                        value: 1.05,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleX",
                                        index: 12
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleX",
                                        index: 15
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 9,
                                        key: "scaleX",
                                        index: 25
                                    }]
                                }
                            }], name: "heartAni", id: 1, frameRate: 24, action: 0
                        }],
                        loadList: ["common/dialogBg.png", "settlement/record_share.png", "common/btn.png", "common/ic_close.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.RecordShareViewUI = s, g("ui.RecordShareViewUI", s);
                var l = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 720, top: 0, right: 0, left: 0, height: 1280, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {var: "bgBox", top: 0, right: 0, left: 0, bottom: 0},
                            compId: 35,
                            child: [{
                                type: "Box",
                                props: {top: 0, right: 0, left: 0, bottom: 0, bgColor: "#000000", alpha: .7},
                                compId: 47
                            }, {
                                type: "Box",
                                props: {width: 720, right: 0, left: 0, height: 900, gray: !1, centerY: 0},
                                compId: 3,
                                child: [{
                                    type: "Image",
                                    props: {y: 65, skin: "common/revenge.png", centerX: 0},
                                    compId: 49
                                }, {
                                    type: "Image",
                                    props: {
                                        y: 383,
                                        var: "coundDownImg",
                                        skin: "common/num_5.png",
                                        scaleY: 1.3,
                                        scaleX: 1.3,
                                        centerX: 0,
                                        anchorY: .5,
                                        anchorX: .5
                                    },
                                    compId: 48
                                }, {
                                    type: "Label",
                                    props: {
                                        y: 540,
                                        var: "reliveTip",
                                        text: "倒计时结束自动复活，不保留等级",
                                        fontSize: 24,
                                        color: "#919191",
                                        centerX: 0
                                    },
                                    compId: 10
                                }, {
                                    type: "Box",
                                    props: {y: 658, width: 275, var: "moveBox", height: 150, centerX: 0},
                                    compId: 34,
                                    child: [{
                                        type: "Button",
                                        props: {
                                            y: 43,
                                            x: 137,
                                            width: 275,
                                            var: "shareButton",
                                            stateNum: 1,
                                            skin: "common/btn.png",
                                            labelSize: 36,
                                            labelPadding: "0,0,5,30",
                                            labelColors: "#07fff5",
                                            labelBold: !0,
                                            height: 92,
                                            anchorY: .5,
                                            anchorX: .5
                                        },
                                        compId: 12,
                                        child: [{
                                            type: "Script",
                                            props: {playEvent: "mousedown", runtime: "ui.ani.BtnScaleDownUI"},
                                            compId: 15
                                        }, {
                                            type: "Script",
                                            props: {playEvent: "mouseup", runtime: "ui.ani.BtnScaleUpUI"},
                                            compId: 18
                                        }, {
                                            type: "Box",
                                            props: {width: 238, name: "shareBox", height: 74, centerY: 0, centerX: 0},
                                            compId: 30,
                                            child: [{
                                                type: "Text",
                                                props: {
                                                    y: 1.5,
                                                    x: 75,
                                                    width: 149,
                                                    var: "shareBtnText",
                                                    valign: "middle",
                                                    text: "求助复活",
                                                    strokeColor: "#000000",
                                                    stroke: 3,
                                                    height: 49,
                                                    fontSize: 32,
                                                    color: "#FFFFFF",
                                                    bold: !0,
                                                    align: "center",
                                                    runtime: "laya.display.Text"
                                                },
                                                compId: 31
                                            }, {
                                                type: "Text",
                                                props: {
                                                    y: 42,
                                                    x: 65,
                                                    width: 171,
                                                    valign: "middle",
                                                    text: "(保留等级)",
                                                    name: "textInfo",
                                                    height: 32,
                                                    fontSize: 20,
                                                    color: "#FFFFFF",
                                                    bold: !1,
                                                    align: "center",
                                                    runtime: "laya.display.Text"
                                                },
                                                compId: 32
                                            }, {
                                                type: "Image",
                                                props: {x: 18, skin: "common/ic_share1.png", name: "bi", centerY: 0},
                                                compId: 33
                                            }]
                                        }]
                                    }, {
                                        type: "Button",
                                        props: {
                                            y: 43,
                                            x: 137,
                                            width: 275,
                                            var: "watchADButton",
                                            stateNum: 1,
                                            skin: "common/btn.png",
                                            labelSize: 36,
                                            labelPadding: "0,0,5,30",
                                            labelColors: "#07fff5",
                                            labelBold: !0,
                                            height: 92,
                                            anchorY: .5,
                                            anchorX: .5
                                        },
                                        compId: 11,
                                        child: [{
                                            type: "Script",
                                            props: {y: 0, x: 3, playEvent: "mouseup", runtime: "ui.ani.BtnScaleUpUI"},
                                            compId: 17
                                        }, {
                                            type: "Script",
                                            props: {playEvent: "mousedown", runtime: "ui.ani.BtnScaleDownUI"},
                                            compId: 16
                                        }, {
                                            type: "Box",
                                            props: {
                                                y: 0,
                                                width: 238,
                                                name: "videoBox",
                                                height: 74,
                                                centerY: 0,
                                                centerX: 0
                                            },
                                            compId: 26,
                                            child: [{
                                                type: "Text",
                                                props: {
                                                    y: -.5,
                                                    x: 80,
                                                    width: 149,
                                                    valign: "middle",
                                                    text: "看视频复活",
                                                    strokeColor: "#000000",
                                                    stroke: 3,
                                                    height: 49,
                                                    fontSize: 28,
                                                    color: "#FFFFFF",
                                                    bold: !0,
                                                    align: "center",
                                                    runtime: "laya.display.Text"
                                                },
                                                compId: 27
                                            }, {
                                                type: "Text",
                                                props: {
                                                    y: 39,
                                                    x: 69,
                                                    width: 171,
                                                    valign: "middle",
                                                    text: "保留等级",
                                                    name: "textInfo",
                                                    height: 32,
                                                    fontSize: 18,
                                                    color: "#793a00",
                                                    bold: !0,
                                                    align: "center",
                                                    runtime: "laya.display.Text"
                                                },
                                                compId: 28
                                            }, {
                                                type: "Image",
                                                props: {x: 18, skin: "common/ic_vedio1.png", name: "bi", centerY: 0},
                                                compId: 29
                                            }]
                                        }]
                                    }, {
                                        type: "Label",
                                        props: {
                                            width: 240,
                                            var: "continueView",
                                            valign: "middle",
                                            underline: !0,
                                            text: "直接复活",
                                            height: 54,
                                            fontSize: 24,
                                            color: "#cacbcc",
                                            centerY: 50,
                                            centerX: 0,
                                            anchorY: .5,
                                            anchorX: .5,
                                            align: "center"
                                        },
                                        compId: 19
                                    }]
                                }]
                            }]
                        }],
                        loadList: ["common/revenge.png", "common/num_5.png", "common/btn.png", "common/ic_share1.png", "common/ic_vedio1.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.ReliveViewUI = l, g("ui.ReliveViewUI", l);
                var h = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, top: 0, right: 0, left: 0, height: 1334, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {y: 0, x: 0, top: 0, right: 0, left: 0, bottom: 0, bgColor: "#000000", alpha: .7},
                            compId: 3
                        }, {
                            type: "Box",
                            props: {y: 0, x: 0, width: 627, height: 450, centerY: -56, centerX: 0},
                            compId: 4,
                            child: [{
                                type: "Image",
                                props: {
                                    width: 627,
                                    top: 0,
                                    skin: "common/dialogBg.png",
                                    sizeGrid: "50,50,50,50",
                                    right: 0,
                                    name: "bg",
                                    left: 0,
                                    height: 450,
                                    bottom: 0
                                },
                                compId: 5
                            }, {
                                type: "Label",
                                props: {
                                    valign: "middle",
                                    top: 36,
                                    text: "设置",
                                    name: "title",
                                    fontSize: 50,
                                    color: "#000000",
                                    centerX: 0,
                                    bold: !0,
                                    align: "center"
                                },
                                compId: 6
                            }, {
                                type: "Box",
                                props: {width: 300, height: 50, centerY: -50, centerX: 0},
                                compId: 23,
                                child: [{
                                    type: "Label",
                                    props: {
                                        text: "音乐",
                                        strokeColor: "#000000",
                                        stroke: 2,
                                        left: 0,
                                        fontSize: 35,
                                        color: "#FFFFFF",
                                        centerY: 0
                                    },
                                    compId: 24
                                }, {
                                    type: "Button",
                                    props: {
                                        var: "musicBtn",
                                        stateNum: 1,
                                        skin: "common/ic_check.png",
                                        right: 0,
                                        centerY: 0
                                    },
                                    compId: 25
                                }]
                            }, {
                                type: "Box",
                                props: {x: 164, width: 300, height: 50, centerY: 50, centerX: 0},
                                compId: 26,
                                child: [{
                                    type: "Label",
                                    props: {
                                        text: "音效",
                                        strokeColor: "#000000",
                                        stroke: 2,
                                        left: 0,
                                        fontSize: 35,
                                        color: "#FFFFFF",
                                        centerY: 0
                                    },
                                    compId: 27
                                }, {
                                    type: "Button",
                                    props: {
                                        var: "soundBtn",
                                        stateNum: 1,
                                        skin: "common/ic_check.png",
                                        right: 0,
                                        centerY: 0
                                    },
                                    compId: 28
                                }]
                            }, {
                                type: "Label",
                                props: {
                                    var: "versionLabel",
                                    valign: "middle",
                                    text: "v1.0.0",
                                    strokeColor: "#000000",
                                    stroke: 2,
                                    fontSize: 45,
                                    color: "#FFFFFF",
                                    centerX: 0,
                                    bottom: 50,
                                    align: "center"
                                },
                                compId: 29
                            }, {
                                type: "Image",
                                props: {
                                    var: "closeBtn",
                                    skin: "common/ic_skip.png",
                                    centerX: 0,
                                    bottom: -100,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 12
                            }]
                        }],
                        loadList: ["common/dialogBg.png", "common/ic_check.png", "common/ic_skip.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.SettingViewUI = h, g("ui.SettingViewUI", h);
                var c = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, top: 0, right: 0, left: 0, height: 1334, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {top: -1, right: 0, name: "bg", left: 0, bottom: 0, bgColor: "#3e4e21"},
                            compId: 3
                        }, {
                            type: "Box",
                            props: {runtime: "views/runtime/UIAdapter.ts", right: 0, left: 0, height: 1e3, centerY: -1},
                            compId: 4,
                            child: [{
                                type: "Box",
                                props: {top: 199, right: 0, left: 0, height: 350, bgColor: "#2a2a2a"},
                                compId: 5,
                                child: [{
                                    type: "Image",
                                    props: {skin: "settlement/light4.png", centerX: 0, anchorY: 1, anchorX: .5},
                                    compId: 6
                                }, {
                                    type: "Image",
                                    props: {
                                        y: 35,
                                        var: "sortImg",
                                        skin: "settlement/sort99.png",
                                        centerX: 0,
                                        anchorY: 1,
                                        anchorX: .5
                                    },
                                    compId: 7,
                                    child: [{
                                        type: "Label",
                                        props: {
                                            var: "sortNum",
                                            text: "4",
                                            fontSize: 70,
                                            color: "#FFFFFF",
                                            centerX: 0,
                                            bottom: 27,
                                            bold: !0
                                        },
                                        compId: 8
                                    }]
                                }, {
                                    type: "Image",
                                    props: {width: 496, top: 45, skin: "settlement/bg_tip.png", height: 50, centerX: 0},
                                    compId: 12,
                                    child: [{
                                        type: "Image",
                                        props: {
                                            width: 33,
                                            skin: "common/ic_cup.png",
                                            height: 33,
                                            centerY: 0,
                                            centerX: -80
                                        },
                                        compId: 14
                                    }, {
                                        type: "Label",
                                        props: {
                                            width: 100,
                                            var: "cupNum",
                                            valign: "middle",
                                            text: "50",
                                            height: 35,
                                            fontSize: 30,
                                            color: "#f8d344",
                                            centerY: 0,
                                            centerX: 0,
                                            align: "center"
                                        },
                                        compId: 16
                                    }]
                                }, {
                                    type: "GradeItem",
                                    props: {
                                        var: "gradeItem",
                                        centerX: 0,
                                        bottom: 37,
                                        runtime: "views/item/GradeItem.ts"
                                    },
                                    compId: 11
                                }, {
                                    type: "ProgressBar",
                                    props: {
                                        width: 363,
                                        var: "gradeProgress",
                                        skin: "common/progress.png",
                                        sizeGrid: "0,30,0,30",
                                        height: 27,
                                        centerX: 0,
                                        bottom: 5
                                    },
                                    compId: 9,
                                    child: [{
                                        type: "Label",
                                        props: {
                                            width: 60,
                                            var: "curValue",
                                            valign: "middle",
                                            text: "100",
                                            height: 20,
                                            fontSize: 20,
                                            color: "#FFFFFF",
                                            centerY: 0,
                                            centerX: -30,
                                            align: "right"
                                        },
                                        compId: 10
                                    }, {
                                        type: "Label",
                                        props: {
                                            width: 70,
                                            var: "maxValue",
                                            valign: "middle",
                                            text: "/500",
                                            height: 20,
                                            fontSize: 20,
                                            color: "#FFFFFF",
                                            centerY: 0,
                                            centerX: 35,
                                            align: "left"
                                        },
                                        compId: 29
                                    }]
                                }]
                            }, {
                                type: "Button",
                                props: {
                                    var: "btn",
                                    top: 600,
                                    stateNum: 1,
                                    skin: "common/btn1.png",
                                    centerX: 0,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 25,
                                child: [{
                                    type: "Image",
                                    props: {width: 40, skin: "common/ic_coin.png", left: 15, height: 40, centerY: 0},
                                    compId: 26
                                }, {
                                    type: "Label",
                                    props: {
                                        valign: "middle",
                                        text: "点击领取",
                                        right: 10,
                                        fontSize: 28,
                                        color: "#675aa5",
                                        centerY: 0,
                                        align: "center"
                                    },
                                    compId: 27
                                }, {
                                    type: "Label",
                                    props: {
                                        width: 94,
                                        var: "coinNum",
                                        valign: "middle",
                                        text: "222",
                                        left: 65,
                                        height: 35,
                                        fontSize: 35,
                                        color: "#675aa5",
                                        centerY: 0,
                                        align: "left"
                                    },
                                    compId: 28
                                }, {
                                    type: "Script",
                                    props: {y: 0, x: 0, playEvent: "mousedown", runtime: "ui.ani.BtnScaleDownUI"},
                                    compId: 32
                                }, {
                                    type: "Script",
                                    props: {y: 0, x: 0, playEvent: "mouseup", runtime: "ui.ani.BtnScaleUpUI"},
                                    compId: 33
                                }]
                            }, {
                                type: "Button",
                                props: {
                                    x: 375,
                                    var: "vedio3Btn",
                                    top: 730,
                                    stateNum: 1,
                                    skin: "common/btn.png",
                                    centerX: 0,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 17,
                                child: [{
                                    type: "Image",
                                    props: {width: 60, skin: "common/ic_coin.png", left: 20, height: 60, centerY: 0},
                                    compId: 18
                                }, {
                                    type: "Image",
                                    props: {y: 25, x: 270, skin: "common/ic_vedio.png"},
                                    compId: 19
                                }, {
                                    type: "Label",
                                    props: {y: 76, x: 250, text: "翻3倍", fontSize: 35, color: "#84442a"},
                                    compId: 21
                                }, {
                                    type: "Label",
                                    props: {
                                        x: 100,
                                        width: 135,
                                        var: "coinNum3",
                                        valign: "middle",
                                        text: "666",
                                        height: 50,
                                        fontSize: 45,
                                        color: "#84442a",
                                        centerY: 2,
                                        align: "left"
                                    },
                                    compId: 24
                                }]
                            }]
                        }],
                        animations: [{
                            nodes: [{
                                target: 6,
                                keyframes: {
                                    skin: [{
                                        value: "settlement/light1.png",
                                        tweenMethod: "linearNone",
                                        tween: !1,
                                        target: 6,
                                        key: "skin",
                                        index: 0
                                    }, {
                                        value: "settlement/light2.png",
                                        tweenMethod: "linearNone",
                                        tween: !1,
                                        target: 6,
                                        key: "skin",
                                        index: 5
                                    }, {
                                        value: "settlement/light3.png",
                                        tweenMethod: "linearNone",
                                        tween: !1,
                                        target: 6,
                                        key: "skin",
                                        index: 10
                                    }, {
                                        value: "settlement/light4.png",
                                        tweenMethod: "linearNone",
                                        tween: !1,
                                        target: 6,
                                        key: "skin",
                                        index: 15
                                    }]
                                }
                            }], name: "lightAni", id: 1, frameRate: 24, action: 0
                        }, {
                            nodes: [{
                                target: 17, keyframes: {
                                    scaleY: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleY",
                                        index: 0
                                    }, {
                                        value: 1.1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleY",
                                        index: 3
                                    }, {
                                        value: .9,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleY",
                                        index: 6
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleY",
                                        index: 9
                                    }, {
                                        value: 1.05,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleY",
                                        index: 12
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleY",
                                        index: 15
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleY",
                                        index: 25
                                    }],
                                    scaleX: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleX",
                                        index: 0
                                    }, {
                                        value: 1.1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleX",
                                        index: 3
                                    }, {
                                        value: .9,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleX",
                                        index: 6
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleX",
                                        index: 9
                                    }, {
                                        value: 1.05,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleX",
                                        index: 12
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleX",
                                        index: 15
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 17,
                                        key: "scaleX",
                                        index: 25
                                    }]
                                }
                            }], name: "heartAni", id: 2, frameRate: 24, action: 0
                        }],
                        loadList: ["settlement/light4.png", "settlement/sort99.png", "settlement/bg_tip.png", "common/ic_cup.png", "common/progress.png", "common/btn1.png", "common/ic_coin.png", "common/btn.png", "common/ic_vedio.png", "settlement/light1.png", "settlement/light2.png", "settlement/light3.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.SettlementViewUI = c, g("ui.SettlementViewUI", c);
                var d = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, top: 0, right: 0, left: 0, height: 1334, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {top: 0, right: 0, name: "bg", left: 0, bottom: 0, bgColor: "#7cc472"},
                            compId: 28
                        }, {type: "Image", props: {y: 0, x: 0, skin: "start/cityBg.jpg"}, compId: 58}, {
                            type: "Box",
                            props: {width: 750, right: 0, name: "bottomBox", left: 0, height: 650, bottom: 0},
                            compId: 3,
                            child: [{
                                type: "Image",
                                props: {top: 0, skin: "start/bg_bottom.png", right: 0, left: 0, bottom: 0},
                                compId: 4
                            }, {
                                type: "Box",
                                props: {
                                    y: 0,
                                    x: 0,
                                    top: 0,
                                    right: 0,
                                    left: 0,
                                    bottom: 0,
                                    bgColor: "#000000",
                                    alpha: .5
                                },
                                compId: 16
                            }, {
                                type: "List",
                                props: {
                                    width: 710,
                                    var: "list",
                                    top: 30,
                                    spaceY: 10,
                                    spaceX: 10,
                                    repeatY: 3,
                                    repeatX: 3,
                                    height: 420,
                                    centerX: 0
                                },
                                compId: 17,
                                child: [{
                                    type: "Box",
                                    props: {width: 230, renderType: "render", name: "item", height: 185},
                                    compId: 18,
                                    child: [{
                                        type: "Image",
                                        props: {
                                            width: 212,
                                            skin: "skin/bg_item.png",
                                            height: 167,
                                            centerY: 0,
                                            centerX: 0
                                        },
                                        compId: 19
                                    }, {
                                        type: "Image",
                                        props: {width: 160, name: "itemSkin", height: 160, centerY: 0, centerX: 0},
                                        compId: 20
                                    }, {
                                        type: "Image",
                                        props: {skin: "skin/ic_hook.png", right: 12, name: "icHook", bottom: 12},
                                        compId: 21
                                    }, {
                                        type: "Box",
                                        props: {
                                            width: 212,
                                            name: "lockBox",
                                            height: 167,
                                            centerY: 0,
                                            centerX: 0,
                                            bgColor: "#000000",
                                            alpha: .5
                                        },
                                        compId: 22,
                                        child: [{
                                            type: "Image",
                                            props: {
                                                top: 0,
                                                skin: "skin/bg_item.png",
                                                right: 0,
                                                renderType: "mask",
                                                left: 0,
                                                bottom: 0
                                            },
                                            compId: 23
                                        }]
                                    }, {
                                        type: "Image",
                                        props: {skin: "skin/ic_lock.png", right: 15, name: "icLock", bottom: 15},
                                        compId: 24
                                    }, {
                                        type: "Image",
                                        props: {
                                            y: 0,
                                            x: 0,
                                            top: 0,
                                            skin: "skin/item_selected.png",
                                            sizeGrid: "65,65,65,65",
                                            right: 0,
                                            name: "itemSelected",
                                            left: 0,
                                            bottom: 0
                                        },
                                        compId: 32
                                    }]
                                }]
                            }, {
                                type: "Box",
                                props: {right: 0, left: 0, height: 128, bottom: 40},
                                compId: 5,
                                child: [{
                                    type: "Box",
                                    props: {width: 323, var: "unlockBtn", left: 50, height: 128},
                                    compId: 6,
                                    child: [{
                                        type: "Animation",
                                        props: {y: 64, x: 161.5, source: "ani/BtnUnlock.ani"},
                                        compId: 7
                                    }, {
                                        type: "Script",
                                        props: {playEvent: "mousedown", runtime: "ui.ani.BtnScaleDownUI"},
                                        compId: 8
                                    }, {
                                        type: "Script",
                                        props: {playEvent: "mouseup", runtime: "ui.ani.BtnScaleUpUI"},
                                        compId: 9
                                    }, {
                                        type: "Label",
                                        props: {
                                            x: 93,
                                            width: 123,
                                            var: "nulockCoin",
                                            valign: "middle",
                                            text: "5000",
                                            strokeColor: "#58a641",
                                            stroke: 8,
                                            height: 48,
                                            fontSize: 48,
                                            color: "#FFFFFF",
                                            centerY: 1,
                                            align: "center"
                                        },
                                        compId: 10
                                    }]
                                }, {
                                    type: "Box",
                                    props: {
                                        width: 216,
                                        var: "tryBtn",
                                        right: 50,
                                        height: 128,
                                        centerY: 0,
                                        anchorY: .5,
                                        anchorX: .5
                                    },
                                    compId: 11,
                                    child: [{
                                        type: "Animation",
                                        props: {y: 64, x: 108, source: "ani/BtnTry.ani"},
                                        compId: 12
                                    }, {
                                        type: "Script",
                                        props: {y: 0, x: 0, playEvent: "mousedown", runtime: "ui.ani.BtnScaleDownUI"},
                                        compId: 13
                                    }, {
                                        type: "Script",
                                        props: {y: 0, x: 0, playEvent: "mouseup", runtime: "ui.ani.BtnScaleUpUI"},
                                        compId: 14
                                    }]
                                }, {
                                    type: "Image",
                                    props: {
                                        width: 300,
                                        var: "centerBtn",
                                        skin: "common/btn.png",
                                        sizeGrid: "50,50,50,50",
                                        height: 128,
                                        centerY: 0,
                                        centerX: 0,
                                        anchorY: .5,
                                        anchorX: .5
                                    },
                                    compId: 44,
                                    child: [{
                                        type: "Script",
                                        props: {y: 0, x: 0, playEvent: "mousedown", runtime: "ui.ani.BtnScaleDownUI"},
                                        compId: 45
                                    }, {
                                        type: "Script",
                                        props: {y: 0, x: 0, playEvent: "mouseup", runtime: "ui.ani.BtnScaleUpUI"},
                                        compId: 46
                                    }, {
                                        type: "Label",
                                        props: {
                                            var: "centerBtnLabel",
                                            valign: "middle",
                                            text: "使用皮肤",
                                            strokeColor: "#854428",
                                            stroke: 6,
                                            fontSize: 45,
                                            color: "#FFFFFF",
                                            centerY: 0,
                                            centerX: 0,
                                            bold: !0,
                                            align: "center"
                                        },
                                        compId: 47
                                    }]
                                }, {
                                    type: "Label",
                                    props: {
                                        var: "gradeCondition",
                                        valign: "middle",
                                        text: "段位达到王者",
                                        left: 50,
                                        fontSize: 45,
                                        color: "#FFFFFF",
                                        centerY: 0,
                                        align: "center"
                                    },
                                    compId: 48
                                }, {
                                    type: "Box",
                                    props: {width: 350, var: "progressCondition", left: 50, height: 70, centerY: 0},
                                    compId: 49,
                                    child: [{
                                        type: "Label",
                                        props: {
                                            var: "proTitle",
                                            valign: "middle",
                                            top: 0,
                                            text: "试玩看视频5次",
                                            strokeColor: "#000000",
                                            stroke: 2,
                                            left: 0,
                                            fontSize: 30,
                                            color: "#FFFFFF",
                                            align: "center"
                                        },
                                        compId: 50
                                    }, {
                                        type: "ProgressBar",
                                        props: {
                                            var: "progress",
                                            skin: "common/progress.png",
                                            sizeGrid: "0,30,0,30",
                                            right: 0,
                                            left: 0,
                                            height: 27,
                                            bottom: 0
                                        },
                                        compId: 51,
                                        child: [{
                                            type: "Label",
                                            props: {
                                                var: "proValue",
                                                valign: "middle",
                                                text: "100",
                                                strokeColor: "#000000",
                                                stroke: 3,
                                                height: 20,
                                                fontSize: 20,
                                                color: "#FFFFFF",
                                                centerY: 0,
                                                centerX: 0,
                                                align: "center"
                                            },
                                            compId: 52
                                        }]
                                    }]
                                }]
                            }]
                        }, {
                            type: "Box",
                            props: {y: 0, x: 0, top: 0, right: 0, name: "topBox", left: 0, bottom: 620},
                            compId: 34,
                            child: [{
                                type: "Box",
                                props: {width: 500, var: "dinsBox", height: 500, centerX: 0, bottom: 20},
                                compId: 29,
                                child: [{
                                    type: "Script",
                                    props: {onSelect: !0, boolType: !0, runtime: "views/item/DinsShowScript.ts"},
                                    compId: 57
                                }]
                            }]
                        }, {
                            type: "Box",
                            props: {y: 100, x: 0, top: 100, right: 0, name: "headBox", left: 0, height: 109},
                            compId: 35,
                            child: [{
                                type: "Box",
                                props: {
                                    y: 150,
                                    x: 0,
                                    scaleY: .6,
                                    scaleX: .6,
                                    right: 0,
                                    name: "attrBox",
                                    left: 0,
                                    height: 190
                                },
                                compId: 36,
                                child: [{
                                    type: "Image",
                                    props: {
                                        width: 450,
                                        top: 0,
                                        skin: "skin/bg_skin_info.png",
                                        sizeGrid: "0,150,0,50",
                                        height: 90
                                    },
                                    compId: 37,
                                    child: [{
                                        type: "Label",
                                        props: {
                                            y: 20,
                                            text: "速度提升",
                                            left: 10,
                                            fontSize: 50,
                                            color: "#FFFFFF",
                                            centerY: 0,
                                            bold: !0
                                        },
                                        compId: 39
                                    }, {
                                        type: "Label",
                                        props: {
                                            y: 78,
                                            var: "attrSpeed",
                                            text: "100%",
                                            right: 45,
                                            fontSize: 50,
                                            color: "#FFFFFF",
                                            centerY: 0,
                                            bold: !0
                                        },
                                        compId: 38
                                    }]
                                }, {
                                    type: "Image",
                                    props: {
                                        x: 0,
                                        width: 450,
                                        skin: "skin/bg_skin_info.png",
                                        sizeGrid: "0,150,0,50",
                                        height: 90,
                                        bottom: 0
                                    },
                                    compId: 40,
                                    child: [{
                                        type: "Label",
                                        props: {
                                            y: 20,
                                            text: "力量提升",
                                            left: 10,
                                            fontSize: 50,
                                            color: "#FFFFFF",
                                            centerY: 0,
                                            bold: !0
                                        },
                                        compId: 41
                                    }, {
                                        type: "Label",
                                        props: {
                                            y: 78,
                                            var: "attrPower",
                                            text: "100%",
                                            right: 45,
                                            fontSize: 50,
                                            color: "#FFFFFF",
                                            centerY: 0,
                                            bold: !0
                                        },
                                        compId: 42
                                    }]
                                }]
                            }, {
                                type: "Image",
                                props: {var: "closeBtn", skin: "skin/btn_back.png", left: 0, centerY: 0},
                                compId: 27
                            }]
                        }],
                        loadList: ["start/cityBg.jpg", "start/bg_bottom.png", "skin/bg_item.png", "skin/ic_hook.png", "skin/ic_lock.png", "skin/item_selected.png", "ani/BtnUnlock.ani", "ani/BtnTry.ani", "common/btn.png", "common/progress.png", "skin/bg_skin_info.png", "skin/btn_back.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.SkinViewUI = d, g("ui.SkinViewUI", d);
                var u = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 750, top: 0, right: 0, left: 0, height: 1334, bottom: 0},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {top: 0, right: 0, name: "bg", left: 0, bottom: 0, bgColor: "#7f9c42"},
                            compId: 48
                        }, {
                            type: "Box",
                            props: {width: 750, height: 1334, centerY: 0, centerX: 0},
                            compId: 11,
                            child: [{
                                type: "Image",
                                props: {y: -299.85, x: 0, skin: "start/cityTopBg.jpg"},
                                compId: 66
                            }, {
                                type: "Image",
                                props: {skin: "start/cityBottomBg.png", bottom: -299},
                                compId: 67
                            }, {type: "Image", props: {y: 0, x: 0, skin: "start/cityBg.jpg"}, compId: 64}, {
                                type: "Box",
                                props: {y: 834, width: 750, top: 834, name: "bottomView", height: 800, centerX: 0},
                                compId: 12,
                                child: [{
                                    type: "Image",
                                    props: {
                                        top: 0,
                                        skin: "start/bg_bottom.png",
                                        right: 0,
                                        name: "bottomBg",
                                        left: 0,
                                        bottom: 0
                                    },
                                    compId: 7
                                }, {
                                    type: "Box",
                                    props: {y: 0, right: 0, left: 0, height: 200},
                                    compId: 16,
                                    child: [{
                                        type: "Button",
                                        props: {
                                            width: 414,
                                            var: "startButton",
                                            height: 161,
                                            centerY: 0,
                                            centerX: 0,
                                            anchorY: .5,
                                            anchorX: .5
                                        },
                                        compId: 13,
                                        child: [{
                                            type: "Animation",
                                            props: {
                                                y: 161,
                                                x: 414,
                                                width: 414,
                                                source: "ani/BtnStart.ani",
                                                pivotY: 80,
                                                pivotX: 207,
                                                height: 161,
                                                autoPlay: !0
                                            },
                                            compId: 70
                                        }]
                                    }, {
                                        type: "Box",
                                        props: {
                                            width: 100,
                                            var: "rankBtn",
                                            height: 100,
                                            centerY: 0,
                                            centerX: -280,
                                            anchorY: .5,
                                            anchorX: .5
                                        },
                                        compId: 17,
                                        child: [{
                                            type: "Animation",
                                            props: {
                                                y: 50,
                                                x: 50,
                                                width: 100,
                                                var: "rankBtnAni",
                                                source: "ani/BtnRank.ani",
                                                height: 100,
                                                autoPlay: !0
                                            },
                                            compId: 14
                                        }, {
                                            type: "Script",
                                            props: {
                                                y: 0,
                                                x: 0,
                                                playEvent: "mousedown",
                                                runtime: "ui.ani.BtnScaleDownUI"
                                            },
                                            compId: 56
                                        }, {
                                            type: "Script",
                                            props: {y: 0, x: 0, playEvent: "mouseup", runtime: "ui.ani.BtnScaleUpUI"},
                                            compId: 57
                                        }]
                                    }, {
                                        type: "Box",
                                        props: {
                                            width: 100,
                                            var: "skinBtn",
                                            height: 100,
                                            centerY: 0,
                                            centerX: 280,
                                            anchorY: .5,
                                            anchorX: .5
                                        },
                                        compId: 18,
                                        child: [{
                                            type: "Animation",
                                            props: {
                                                y: 50,
                                                x: 50,
                                                width: 100,
                                                var: "skinBtnAni",
                                                source: "ani/BtnSkin.ani",
                                                height: 100,
                                                autoPlay: !0
                                            },
                                            compId: 15
                                        }, {
                                            type: "Script",
                                            props: {
                                                y: 0,
                                                x: 0,
                                                playEvent: "mousedown",
                                                runtime: "ui.ani.BtnScaleDownUI"
                                            },
                                            compId: 58
                                        }, {
                                            type: "Script",
                                            props: {y: 0, x: 0, playEvent: "mouseup", runtime: "ui.ani.BtnScaleUpUI"},
                                            compId: 59
                                        }]
                                    }]
                                }, {
                                    type: "Box",
                                    props: {width: 750, top: 200, height: 120, centerX: 0},
                                    compId: 19,
                                    child: [{
                                        type: "Box",
                                        props: {
                                            y: 60,
                                            x: 140,
                                            width: 200,
                                            height: 100,
                                            centerY: 0,
                                            centerX: -235,
                                            anchorY: .5,
                                            anchorX: .5
                                        },
                                        compId: 61,
                                        child: [{
                                            type: "AttributeItem",
                                            props: {
                                                width: 200,
                                                var: "speedAttr",
                                                height: 100,
                                                centerY: 0,
                                                centerX: 0,
                                                anchorY: .5,
                                                anchorX: .5,
                                                runtime: "views/item/AttributeItem.ts"
                                            },
                                            compId: 51
                                        }]
                                    }, {
                                        type: "Box",
                                        props: {
                                            y: 60,
                                            x: 375,
                                            width: 200,
                                            height: 100,
                                            centerY: 0,
                                            centerX: 0,
                                            anchorY: .5,
                                            anchorX: .5
                                        },
                                        compId: 62,
                                        child: [{
                                            type: "AttributeItem",
                                            props: {
                                                width: 200,
                                                var: "powerAttr",
                                                height: 100,
                                                centerY: 0,
                                                centerX: 0,
                                                anchorY: .5,
                                                anchorX: .5,
                                                runtime: "views/item/AttributeItem.ts"
                                            },
                                            compId: 52
                                        }]
                                    }, {
                                        type: "Box",
                                        props: {
                                            y: 60,
                                            x: 610,
                                            width: 200,
                                            height: 100,
                                            centerY: 0,
                                            centerX: 235,
                                            anchorY: .5,
                                            anchorX: .5
                                        },
                                        compId: 63,
                                        child: [{
                                            type: "AttributeItem",
                                            props: {
                                                width: 200,
                                                var: "growupAttr",
                                                height: 100,
                                                centerY: 0,
                                                centerX: 0,
                                                anchorY: .5,
                                                anchorX: .5,
                                                runtime: "views/item/AttributeItem.ts"
                                            },
                                            compId: 53
                                        }]
                                    }]
                                }]
                            }, {
                                type: "Box",
                                props: {var: "topView", top: 0, right: 0, name: "topView", left: 0, bottom: 500},
                                compId: 35,
                                child: [{
                                    type: "Box",
                                    props: {width: 500, var: "dinsBox", height: 500, centerX: 0, bottom: 20},
                                    compId: 65,
                                    child: [{
                                        type: "Script",
                                        props: {onSelect: !1, runtime: "views/item/DinsShowScript.ts"},
                                        compId: 71
                                    }]
                                }, {
                                    type: "Box",
                                    props: {
                                        var: "gradeView",
                                        right: 0,
                                        name: "gradeView",
                                        left: 0,
                                        height: 300,
                                        bottom: 0
                                    },
                                    compId: 37,
                                    child: [{
                                        type: "Image",
                                        props: {
                                            width: 465,
                                            skin: "common/bg_toast.png",
                                            height: 68,
                                            centerX: 0,
                                            bottom: 5
                                        },
                                        compId: 39,
                                        child: [{
                                            type: "Label",
                                            props: {
                                                width: 188,
                                                var: "gradeNum",
                                                valign: "middle",
                                                text: "50/60",
                                                right: 56,
                                                height: 35,
                                                fontSize: 33,
                                                color: "#f8d344",
                                                centerY: 2,
                                                align: "right"
                                            },
                                            compId: 40
                                        }, {
                                            type: "Image",
                                            props: {
                                                y: 20,
                                                width: 33,
                                                skin: "common/ic_cup.png",
                                                rotation: 0,
                                                right: 7,
                                                height: 33
                                            },
                                            compId: 50
                                        }, {
                                            type: "Label",
                                            props: {
                                                width: 110,
                                                var: "gradeName",
                                                valign: "middle",
                                                text: "青铜",
                                                height: 40,
                                                fontSize: 35,
                                                color: "#FFFFFF",
                                                centerX: -55,
                                                bottom: 15,
                                                bold: !0,
                                                align: "center"
                                            },
                                            compId: 69
                                        }]
                                    }, {
                                        type: "GradeItem",
                                        props: {
                                            width: 260,
                                            var: "gradeItem",
                                            height: 210,
                                            centerX: 0,
                                            bottom: 15,
                                            runtime: "views/item/GradeItem.ts"
                                        },
                                        compId: 49
                                    }]
                                }]
                            }]
                        }, {
                            type: "Box",
                            props: {
                                width: 750,
                                top: 57,
                                runtime: "views/runtime/UIAdapter.ts",
                                right: 0,
                                name: "headView",
                                left: 0,
                                height: 241
                            },
                            compId: 36,
                            child: [{
                                type: "Image",
                                props: {
                                    width: 88,
                                    var: "settingBtn",
                                    skin: "start/btn_setting.png",
                                    left: 0,
                                    height: 71,
                                    centerY: 24
                                },
                                compId: 45
                            }, {
                                type: "Image",
                                props: {skin: "start/bg_coin.png", right: 599, centerY: -80},
                                compId: 46,
                                child: [{
                                    type: "Label",
                                    props: {
                                        width: 90,
                                        var: "coin",
                                        valign: "middle",
                                        text: "777",
                                        left: 55,
                                        height: 35,
                                        fontSize: 30,
                                        color: "#FFFFFF",
                                        centerY: 0,
                                        align: "center"
                                    },
                                    compId: 47
                                }]
                            }, {
                                type: "Image",
                                props: {top: 80, skin: "start/logo.png", name: "logo", centerX: 0},
                                compId: 5
                            }]
                        }],
                        animations: [{
                            nodes: [{
                                target: 13, keyframes: {
                                    scaleY: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 0
                                    }, {
                                        value: 1.1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 3
                                    }, {
                                        value: .9,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 6
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 9
                                    }, {
                                        value: 1.05,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 12
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 15
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleY",
                                        index: 25
                                    }],
                                    scaleX: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 0
                                    }, {
                                        value: 1.1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 3
                                    }, {
                                        value: .9,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 6
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 9
                                    }, {
                                        value: 1.05,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 12
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 15
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 13,
                                        key: "scaleX",
                                        index: 25
                                    }]
                                }
                            }], name: "heartAni", id: 1, frameRate: 24, action: 0
                        }],
                        loadList: ["start/cityTopBg.jpg", "start/cityBottomBg.png", "start/cityBg.jpg", "start/bg_bottom.png", "ani/BtnStart.ani", "ani/BtnRank.ani", "ani/BtnSkin.ani", "common/bg_toast.png", "common/ic_cup.png", "start/btn_setting.png", "start/bg_coin.png", "start/logo.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.StartViewUI = u, g("ui.StartViewUI", u)
            }(n.ui || (n.ui = {})), function (e) {
                var t = function (t) {
                    function e() {
                        var e = t.call(this) || this;
                        return e.effectData = a.ani.BtnScaleDownUI.uiView, e
                    }

                    return __extends(e, t), e.uiView = {
                        type: "View",
                        props: {name: "BtnScaleDown"},
                        compId: 1,
                        child: [{type: "Image", props: {}, compId: 2}],
                        animations: [{
                            nodes: [{
                                target: 2,
                                keyframes: {
                                    x: [{
                                        value: 0,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "x",
                                        index: 0
                                    }],
                                    scaleY: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleY",
                                        index: 0
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleY",
                                        index: 1
                                    }, {
                                        value: .92,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleY",
                                        index: 5
                                    }],
                                    scaleX: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleX",
                                        index: 0
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleX",
                                        index: 1
                                    }, {
                                        value: .92,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleX",
                                        index: 5
                                    }]
                                }
                            }], name: "PressDown", id: 1, frameRate: 24, action: 0
                        }],
                        loadList: [],
                        loadList3D: []
                    }, e
                }(laya.display.EffectAnimation);
                e.BtnScaleDownUI = t, g("ui.ani.BtnScaleDownUI", t);
                var n = function (t) {
                    function e() {
                        var e = t.call(this) || this;
                        return e.effectData = a.ani.BtnScaleUpUI.uiView, e
                    }

                    return __extends(e, t), e.uiView = {
                        type: "View",
                        props: {name: "BtnScaleUp"},
                        compId: 1,
                        child: [{type: "Image", props: {}, compId: 2}],
                        animations: [{
                            nodes: [{
                                target: 2,
                                keyframes: {
                                    x: [{
                                        value: 0,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "x",
                                        index: 0
                                    }],
                                    scaleY: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleY",
                                        index: 0
                                    }, {
                                        value: .92,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleY",
                                        index: 1
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleY",
                                        index: 5
                                    }],
                                    scaleX: [{
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleX",
                                        index: 0
                                    }, {
                                        value: .92,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleX",
                                        index: 1
                                    }, {
                                        value: 1,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 2,
                                        key: "scaleX",
                                        index: 5
                                    }]
                                }
                            }], name: "PressUp", id: 1, frameRate: 24, action: 0
                        }],
                        loadList: [],
                        loadList3D: []
                    }, e
                }(laya.display.EffectAnimation);
                e.BtnScaleUpUI = n, g("ui.ani.BtnScaleUpUI", n)
            }((a = n.ui || (n.ui = {})).ani || (a.ani = {})), function (e) {
                var t = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 100, height: 50},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {y: 0, x: 0, width: 100, height: 50},
                            compId: 3,
                            child: [{
                                type: "Label",
                                props: {
                                    y: 0,
                                    x: 0,
                                    width: 99,
                                    var: "label",
                                    valign: "middle",
                                    text: "+ 50",
                                    strokeColor: "#000000",
                                    stroke: 4,
                                    height: 51,
                                    fontSize: 30,
                                    color: "#FFFFFF",
                                    bold: !0,
                                    align: "center"
                                },
                                compId: 4
                            }]
                        }],
                        animations: [{
                            nodes: [{
                                target: 4,
                                keyframes: {
                                    y: [{
                                        value: 0,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 4,
                                        key: "y",
                                        index: 0
                                    }, {
                                        value: -82,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 4,
                                        key: "y",
                                        index: 10
                                    }],
                                    x: [{
                                        value: 0,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 4,
                                        key: "x",
                                        index: 0
                                    }, {value: 1, tweenMethod: "linearNone", tween: !0, target: 4, key: "x", index: 10}]
                                }
                            }], name: "ani1", id: 1, frameRate: 24, action: 0
                        }],
                        loadList: [],
                        loadList3D: []
                    }, t
                }(p);
                e.AddScroeAniViewUI = t, g("ui.item.AddScroeAniViewUI", t);
                var n = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {
                            y: 50,
                            x: 100,
                            width: 200,
                            runtime: "views/item/AttributeItem.ts",
                            height: 100,
                            anchorY: .5,
                            anchorX: .5
                        },
                        compId: 2,
                        child: [{
                            type: "Animation",
                            props: {y: 50, x: 100, var: "vedioBg", source: "ani/BtnVedioUp.ani"},
                            compId: 4
                        }, {
                            type: "Animation",
                            props: {y: 50, x: 100, var: "bg", source: "ani/BtnUp.ani"},
                            compId: 3
                        }, {
                            type: "Label",
                            props: {
                                y: 15,
                                x: 45,
                                width: 95,
                                var: "coinNum",
                                valign: "middle",
                                text: "100",
                                strokeColor: "#000000",
                                stroke: 3,
                                height: 35,
                                fontSize: 35,
                                color: "#FFFFFF",
                                bold: !0,
                                align: "center"
                            },
                            compId: 5
                        }, {
                            type: "Label",
                            props: {
                                y: 0,
                                x: 0,
                                var: "attrName",
                                top: 65,
                                text: "属性",
                                left: 5,
                                fontSize: 25,
                                color: "#319670",
                                bold: !0
                            },
                            compId: 6
                        }, {
                            type: "Label",
                            props: {
                                y: 0,
                                x: 0,
                                var: "attrValue",
                                top: 66,
                                text: "100%",
                                right: 5,
                                fontSize: 23,
                                color: "#b56910",
                                bold: !0
                            },
                            compId: 7
                        }, {
                            type: "Script",
                            props: {playEvent: "mousedown", runtime: "ui.ani.BtnScaleDownUI"},
                            compId: 8
                        }, {type: "Script", props: {playEvent: "mouseup", runtime: "ui.ani.BtnScaleUpUI"}, compId: 9}],
                        loadList: ["ani/BtnVedioUp.ani", "ani/BtnUp.ani"],
                        loadList3D: []
                    }, t
                }(p);
                e.AttributeItemUI = n, g("ui.item.AttributeItemUI", n);
                var a = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 730, runtime: "views/item/BroadcastView.ts", height: 114},
                        compId: 2,
                        child: [{
                            type: "Image",
                            props: {
                                y: 0,
                                x: 0,
                                visible: !1,
                                var: "bgImageView",
                                skin: "common/combo_bg.png",
                                labels: "label1,label2"
                            },
                            compId: 14
                        }, {
                            type: "Box",
                            props: {visible: !1, var: "imageBox", top: 0, right: 0, left: 0, bottom: 0},
                            compId: 3,
                            child: [{
                                type: "Image",
                                props: {var: "broadcastImageView", centerY: 0, centerX: 0, anchorY: .5, anchorX: .5},
                                compId: 4
                            }]
                        }, {
                            type: "Box",
                            props: {
                                y: 57,
                                x: 365,
                                visible: !1,
                                var: "killBox",
                                top: 0,
                                right: 0,
                                left: 0,
                                bottom: 0,
                                anchorY: .5,
                                anchorX: .5
                            },
                            compId: 5,
                            child: [{
                                type: "Image",
                                props: {
                                    y: 7,
                                    x: 130,
                                    width: 100,
                                    var: "killerAvatarImageView",
                                    skin: "common/default_avatar.png",
                                    height: 100
                                },
                                compId: 7
                            }, {
                                type: "Image",
                                props: {
                                    y: 8,
                                    x: 523,
                                    width: 100,
                                    var: "killedAvatarImageView",
                                    skin: "common/default_avatar.png",
                                    height: 100
                                },
                                compId: 8
                            }, {
                                type: "Label",
                                props: {
                                    y: 33,
                                    x: 298,
                                    width: 161,
                                    valign: "middle",
                                    text: "击杀了",
                                    height: 50,
                                    fontSize: 40,
                                    color: "#FFFFFF",
                                    align: "center"
                                },
                                compId: 19
                            }]
                        }, {
                            type: "Box",
                            props: {visible: !1, var: "firstBloodBox", top: 0, right: 0, left: 0, bottom: 0},
                            compId: 10,
                            child: [{
                                type: "Label",
                                props: {
                                    y: 26,
                                    x: 27,
                                    width: 349,
                                    var: "firstBloodNickNameLabel",
                                    valign: "middle",
                                    text: "玩家玩家玩家玩家玩家",
                                    height: 63,
                                    fontSize: 35,
                                    color: "#2A97DB",
                                    align: "right"
                                },
                                compId: 11
                            }, {
                                type: "Label",
                                props: {
                                    y: 25.5,
                                    x: 376,
                                    width: 230,
                                    valign: "middle",
                                    text: "获得了第一滴血",
                                    height: 63,
                                    fontSize: 35,
                                    color: "#FFFFFF",
                                    align: "left"
                                },
                                compId: 13
                            }]
                        }, {
                            type: "Box",
                            props: {visible: !1, var: "upgradeBox", top: 0, right: 0, left: 0, bottom: 0},
                            compId: 15,
                            child: [{
                                type: "Label",
                                props: {
                                    y: 26,
                                    x: 133,
                                    width: 337,
                                    valign: "middle",
                                    text: "恭喜！您已升级为：",
                                    height: 63,
                                    fontSize: 40,
                                    color: "#FFFFFF",
                                    align: "center"
                                },
                                compId: 17
                            }, {
                                type: "Label",
                                props: {
                                    y: 25.5,
                                    x: 482,
                                    width: 91,
                                    var: "upgradeLevelLabel",
                                    valign: "middle",
                                    text: "LV 2",
                                    height: 63,
                                    fontSize: 40,
                                    color: "#E28A42",
                                    align: "left"
                                },
                                compId: 18
                            }]
                        }],
                        animations: [{
                            nodes: [{
                                target: 4,
                                keyframes: {
                                    scaleY: [{
                                        value: 0,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 4,
                                        key: "scaleY",
                                        index: 0
                                    }, {
                                        value: 1,
                                        tweenMethod: "quadOut",
                                        tween: !0,
                                        target: 4,
                                        key: "scaleY",
                                        index: 16
                                    }],
                                    scaleX: [{
                                        value: 0,
                                        tweenMethod: "linearNone",
                                        tween: !0,
                                        target: 4,
                                        key: "scaleX",
                                        index: 0
                                    }, {
                                        value: 1,
                                        tweenMethod: "quadOut",
                                        tween: !0,
                                        target: 4,
                                        key: "scaleX",
                                        index: 16
                                    }]
                                }
                            }], name: "imageAni", id: 2, frameRate: 24, action: 0
                        }],
                        loadList: ["common/combo_bg.png", "common/default_avatar.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.BroadcastViewUI = a, g("ui.item.BroadcastViewUI", a);
                var i = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 264, runtime: "views/item/GameRankListItemView.ts", height: 40},
                        compId: 2,
                        child: [{
                            type: "Image",
                            props: {
                                x: 24,
                                var: "rankImage",
                                skin: "game/leadboard_No1.png",
                                scaleY: .6,
                                scaleX: .6,
                                rotation: 45,
                                centerY: 0,
                                anchorY: .5,
                                anchorX: .5
                            },
                            compId: 4
                        }, {
                            type: "Label",
                            props: {
                                x: 3,
                                width: 42,
                                var: "numLabel",
                                valign: "middle",
                                text: "4",
                                height: 34,
                                fontSize: 35,
                                color: "#FFFFFF",
                                centerY: 0,
                                align: "center"
                            },
                            compId: 5
                        }, {
                            type: "Label",
                            props: {
                                x: 47,
                                width: 115,
                                var: "nameLabel",
                                valign: "middle",
                                text: "我是昵称昵称我是昵称昵称",
                                overflow: "hidden",
                                height: 30,
                                fontSize: 25,
                                font: "Arial",
                                color: "#FFFFFF",
                                centerY: 0,
                                align: "left"
                            },
                            compId: 6
                        }, {
                            type: "Label",
                            props: {
                                y: 10,
                                x: 150,
                                width: 108,
                                var: "scoreLabel",
                                valign: "middle",
                                text: "22222",
                                overflow: "hidden",
                                height: 30,
                                fontSize: 25,
                                font: "Arial",
                                color: "#FFFFFF",
                                centerY: 0,
                                align: "right"
                            },
                            compId: 9
                        }],
                        loadList: ["game/leadboard_No1.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.GameRankListItemUI = i, g("ui.item.GameRankListItemUI", i);
                var o = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {y: 50, x: 100, width: 200, height: 100, anchorY: .5, anchorX: .5},
                        compId: 2,
                        child: [{
                            type: "Label",
                            props: {
                                y: 44,
                                x: 58,
                                width: 142,
                                var: "levelLabel",
                                valign: "middle",
                                text: "label",
                                height: 35,
                                fontSize: 27,
                                color: "#FFFFFF",
                                bold: !0,
                                align: "left"
                            },
                            compId: 9
                        }, {
                            type: "Label",
                            props: {
                                y: 0,
                                x: 59,
                                width: 168,
                                var: "nickNameLabel",
                                valign: "middle",
                                text: "我们多大大2",
                                height: 56,
                                fontSize: 24,
                                color: "#FFFFFF",
                                align: "left"
                            },
                            compId: 7
                        }, {
                            type: "Image",
                            props: {
                                y: 11.5,
                                x: 20,
                                width: 34,
                                var: "avatar",
                                skin: "common/default_avatar.png",
                                height: 33
                            },
                            compId: 10,
                            child: [{
                                type: "Sprite",
                                props: {renderType: "mask"},
                                compId: 11,
                                child: [{
                                    type: "Circle",
                                    props: {y: 17, x: 17, radius: 17, lineWidth: 1, fillColor: "#ff0000"},
                                    compId: 12
                                }]
                            }]
                        }],
                        loadList: ["common/default_avatar.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.GameUserInfoViewUI = o, g("ui.item.GameUserInfoViewUI", o);
                var r = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 260, runtime: "views/item/GradeItem.ts", height: 210},
                        compId: 2,
                        child: [{
                            type: "Box",
                            props: {y: 0, width: 260, height: 170, centerX: 0},
                            compId: 9,
                            child: [{
                                type: "Image",
                                props: {
                                    y: 108,
                                    x: 130,
                                    width: 119,
                                    var: "img",
                                    skin: "grade/grade1.png",
                                    height: 125,
                                    centerX: 0,
                                    bottom: 0,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 3
                            }, {
                                type: "Image",
                                props: {
                                    y: 110,
                                    x: 25,
                                    width: 40,
                                    var: "star0",
                                    skin: "grade/grade_star_empty.png",
                                    height: 40,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 4
                            }, {
                                type: "Image",
                                props: {
                                    y: 46,
                                    x: 56,
                                    width: 40,
                                    var: "star1",
                                    skin: "grade/grade_star_empty.png",
                                    height: 40,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 5
                            }, {
                                type: "Image",
                                props: {
                                    y: 20,
                                    x: 130,
                                    width: 40,
                                    var: "star2",
                                    skin: "grade/grade_star_empty.png",
                                    height: 40,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 6
                            }, {
                                type: "Image",
                                props: {
                                    y: 46,
                                    x: 204,
                                    width: 40,
                                    var: "star3",
                                    skin: "grade/grade_star_empty.png",
                                    height: 40,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 7
                            }, {
                                type: "Image",
                                props: {
                                    y: 110,
                                    x: 235,
                                    width: 40,
                                    var: "star4",
                                    skin: "grade/grade_star_empty.png",
                                    height: 40,
                                    anchorY: .5,
                                    anchorX: .5
                                },
                                compId: 8
                            }]
                        }, {
                            type: "Label",
                            props: {
                                width: 110,
                                var: "gradeName",
                                valign: "middle",
                                text: "青铜",
                                height: 40,
                                fontSize: 35,
                                color: "#FFFFFF",
                                centerX: 0,
                                bottom: 0,
                                bold: !0,
                                align: "center"
                            },
                            compId: 10
                        }],
                        loadList: ["grade/grade1.png", "grade/grade_star_empty.png"],
                        loadList3D: []
                    }, t
                }(p);
                e.GradeItemUI = r, g("ui.item.GradeItemUI", r);
                var s = function (e) {
                    function t() {
                        return e.call(this) || this
                    }

                    return __extends(t, e), t.prototype.createChildren = function () {
                        e.prototype.createChildren.call(this), this.createView(t.uiView)
                    }, t.uiView = {
                        type: "View",
                        props: {width: 100, runtime: "views/item/MatchPlayerItemView.ts", height: 100},
                        compId: 2,
                        child: [{
                            type: "Image",
                            props: {top: 0, skin: "common/default_avatar.png", right: 0, left: 0, bottom: 0},
                            compId: 3
                        }, {
                            type: "Image",
                            props: {
                                y: 0,
                                x: 0,
                                var: "avatarView",
                                top: 0,
                                skin: "common/default_avatar.png",
                                right: 0,
                                left: 0,
                                bottom: 0
                            },
                            compId: 5
                        }, {
                            type: "Animation",
                            props: {y: 50, x: 50, var: "loadingAni", source: "ani/Loading.ani"},
                            compId: 6
                        }],
                        loadList: ["common/default_avatar.png", "ani/Loading.ani"],
                        loadList3D: []
                    }, t
                }(p);
                e.MatchPlayerItemViewUI = s, g("ui.item.MatchPlayerItemViewUI", s)
            }((i = n.ui || (n.ui = {})).item || (i.item = {}))
        }, {}],
        47: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function () {
                function e() {
                }

                return e.remove = function (e, t) {
                    if (e) for (var n = 0; n < e.length; n++) e[n] === t && (e.splice(n, 1), n--)
                }, e
            }();
            n.ArrayUtil = a
        }, {}],
        48: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function () {
                function e() {
                }

                return e.getCurrentTimeStamp = function () {
                    return Date.now()
                }, e.currentYear = function () {
                    new Date;
                    return (new Date).getFullYear()
                }, e.currentMonth = function () {
                    new Date;
                    return (new Date).getMonth() + 1
                }, e.currentDate = function () {
                    new Date;
                    return (new Date).getDate()
                }, e.currentHours = function () {
                    return (new Date).getHours()
                }, e.currentDay = function () {
                    return (new Date).getDay()
                }, e.isSameDay = function (e, t) {
                    if (864e5 <= t - e) return !1;
                    if (864e5 <= e - t) return !1;
                    var n = new Date;
                    n.setTime(e);
                    var a = new Date;
                    return a.setTime(t), n.getDate() === a.getDate()
                }, e.showTime = function (e) {
                    var t = Math.floor(e / 60), n = e - 60 * t, a = "" + t;
                    t < 10 && (a = "0" + t);
                    var i = "" + n;
                    return n < 10 && (i = "0" + n), a + ":" + i
                }, e.isToday = function (e) {
                    return this.isSameDay(e, Date.now())
                }, e
            }();
            n.DateUtil = a
        }, {}],
        49: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function () {
                function e() {
                }

                return e.getRadian2 = function (e, t, n, a) {
                    var i = n - e, o = a - t;
                    return Math.atan2(o, i)
                }, e.getRandom = function (e, t) {
                    if (e == t) return e;
                    var n = Math.random();
                    return Math.floor(n * t + (1 - n) * e + n)
                }, e.getAngle = function (e, t, n, a) {
                    var i = n - e, o = a - t;
                    if (0 == o) return 0 < i ? 0 : 180;
                    var r = 180 * Math.atan(i / o) / Math.PI;
                    return o < 0 && (r = i < 0 ? 180 + Math.abs(r) : 180 - Math.abs(r)), r = 90 - r
                }, e.getDistance = function (e, t, n, a) {
                    var i = n - e, o = a - t;
                    return Math.sqrt(i * i + o * o)
                }, e.getDistanceSqr = function (e, t, n, a) {
                    var i = n - e, o = a - t;
                    return i * i + o * o
                }, e.degToRad = function (e) {
                    return e * Math.PI / 180
                }, e.radToDeg = function (e) {
                    return 180 * e / Math.PI
                }, e.isCircleCollision = function (e, t, n, a, i, o) {
                    var r = e - a, s = t - i, l = n + o;
                    return r * r + s * s < l * l
                }, e.clamp = function (e, t, n) {
                    return e < t ? t : n < e ? n : e
                }, e.nextNumber = function (e, t) {
                    if (e == t) return e;
                    var n = Math.random();
                    return Math.floor(n * t + (1 - n) * e + n)
                }, e.validPos = function (e, t, n, a, i, o) {
                    var r = e - n;
                    if (r < -i || i < r) return !1;
                    var s = t - a;
                    return !(s < -o || o < s)
                }, e.getInt = function (e) {
                    return Math.floor(e)
                }, e.clearDictionary = function (e) {
                    for (var t in e) delete e[t]
                }, e.getCos = function (e) {
                    return e < 0 && (e += 360), e = Math.floor(e % 360), this.cosVals[e]
                }, e.getSin = function (e) {
                    return e < 0 && (e += 360), e = Math.floor(e % 360), this.sinVals[e]
                }, e.ptInRect = function (e, t, n, a, i, o, r) {
                    return void 0 === r && (r = 0), !(e + r < n || n + i < e - r || t + r < a || a + o < t - r)
                }, e.initSinCosVal = function () {
                    this.sinVals = {}, this.cosVals = {};
                    for (var e = 0; e < 360; e++) {
                        var t = e * Math.PI / 180;
                        this.cosVals[e] = Math.cos(t), this.sinVals[e] = Math.sin(t)
                    }
                }, e.isRectIntersetWithLine = function (e, t, n, a, i) {
                    if (t < e.x && a < e.x || t > e.x && a > e.x) return !1;
                    if (n < e.y && i < e.y || n > e.y && i > e.y) return !1;
                    var o = {x: e.x, y: e.y}, r = {x: e.x, y: e.bottom}, s = {x: e.right, y: e.y},
                        l = {x: e.right, y: e.bottom}, h = r, c = l, d = o, u = s, p = o, g = l, m = g, f = s;
                    do {
                        if (this.isLineCollisionLine(t, n, a, i, o.x, o.y, r.x, r.y)) break;
                        if (this.isLineCollisionLine(t, n, a, i, s.x, s.y, l.x, l.y)) break;
                        if (this.isLineCollisionLine(t, n, a, i, d.x, d.y, u.x, u.y)) break;
                        if (this.isLineCollisionLine(t, n, a, i, h.x, h.y, c.x, c.y)) break;
                        if (this.isLineCollisionLine(t, n, a, i, p.x, p.y, g.x, g.y)) break;
                        if (this.isLineCollisionLine(t, n, a, i, m.x, m.y, f.x, f.y)) break;
                        return !1
                    } while (0);
                    return !0
                }, e.mult = function (e, t, n, a, i, o) {
                    return (e - i) * (a - o) - (n - i) * (t - o)
                }, e.isLineCollisionLine = function (e, t, n, a, i, o, r, s) {
                    return !(Math.max(e, n) < Math.min(i, r)) && (!(Math.max(t, a) < Math.min(o, s)) && (!(Math.max(i, r) < Math.min(e, n)) && (!(Math.max(o, s) < Math.min(t, a)) && (!(this.mult(i, o, n, a, e, t) * this.mult(n, a, r, s, e, t) < 1e-4) && !(this.mult(e, t, r, s, i, o) * this.mult(r, s, n, a, i, o) < 1e-4)))))
                }, e.getTidyAngle = function (e) {
                    return .01 * Math.floor(100 * e % 36e3)
                }, e.isInRange = function (e, t, n, a, i, o) {
                    return e < i && i < t && n < o && o < a
                }, e.getMoveTargetAngle = function (e, t, n, a) {
                    var i = n - e, o = a - t;
                    return o ? i ? Math.atan2(o, i) * this.angle1rad : 0 < o ? 90 : -90 : 0 < i ? 0 : 180
                }, e.isPolygonContainsPoint = function (e, t) {
                    for (var n = 0, a = e.length, i = 0; i < a; i++) {
                        var o = e[i], r = e[(i + 1) % a];
                        o[1] != r[1] && !(t[1] < Math.min(o[1], r[1]) || t[1] >= Math.max(o[1], r[1])) && (t[1] - o[1]) * (r[0] - o[0]) / (r[1] - o[1]) + o[0] > t[0] && n++
                    }
                    return 1 == n % 2
                }, e.fixPoint = function (e, t, n) {
                    return t
                }, e.cosVals = {}, e.sinVals = {}, e.rad1Angle = Math.PI / 180, e.angle1rad = 180 / Math.PI, e
            }();
            n.default = a
        }, {}],
        50: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function () {
                function e() {
                }

                return e.isEmpty = function (e) {
                    return !e || 0 == e.length
                }, e.format = function (e, t) {
                    var n = e;
                    if (null == t.length) {
                        var a = new RegExp("\\{0\\}", "gm");
                        n = n.replace(a, t)
                    } else for (var i = 0; i < t.length; i++) {
                        a = new RegExp("\\{" + i + "\\}", "gm");
                        n = n.replace(a, t[i])
                    }
                    return n
                }, e.getFormatSeconds = function (e, t) {
                    void 0 === t && (t = ":");
                    var n, a = 0, i = 0;
                    return 60 < e && (i = e / 60, e %= 60, 60 < i && (a = i / 60, i %= 60)), n = 10 <= a ? Math.floor(a) + ":" : "0" + Math.floor(a) + ":", n += 10 <= i ? Math.floor(i) + ":" : "0" + Math.floor(i) + ":", n += 10 <= e ? Math.floor(e) + "" : "0" + Math.floor(e)
                }, e.getFormatSeconds2 = function (e, t) {
                    void 0 === t && (t = ":");
                    var n, a = 0, i = 0;
                    return 60 < e && (i = e / 60, e %= 60, 60 < i && (a = i / 60, i %= 60)), n = 10 <= a ? Math.floor(a) + ":" : 0 < a ? "0" + Math.floor(a) + ":" : "", n += 10 <= i ? Math.floor(i) + ":" : "0" + Math.floor(i) + ":", n += 10 <= e ? Math.floor(e) + "" : "0" + Math.floor(e)
                }, e.split = function (e, t) {
                    var n = [];
                    return e.split(t).forEach(function (e) {
                        "" != e && n.push(e)
                    }), n
                }, e.getAvatarUrl = function (e, t) {
                    return void 0 === t && (t = "-img64"), e && e.length ? -1 !== e.indexOf("res7.lexun99.com") ? e + t : e : "common/default_avatar.png"
                }, e.endWith = function (e, t) {
                    var n = t + "$", a = Laya.Pool.getItemByCreateFun(n, function () {
                        return new RegExp(n)
                    }), i = a.test(e);
                    return Laya.Pool.recover(n, a), i
                }, e.startWith = function (e, t) {
                    var n = "^" + t, a = Laya.Pool.getItemByCreateFun(n, function () {
                        return new RegExp(n)
                    }), i = a.test(e);
                    return Laya.Pool.recover(n, a), i
                }, e.replaceAll = function (e, t, n) {
                    return e.split(t).join(n)
                }, e
            }();
            n.StringUtils = a
        }, {}],
        51: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function () {
                function e() {
                }

                return e.currTimer = function () {
                    return Laya.timer.currTimer
                }, e.scale = function () {
                    return Laya.timer.scale
                }, e.currFrame = function () {
                    return Laya.timer.currFrame
                }, e.delta = function () {
                    return Laya.timer.delta
                }, e.once = function (e, t, n, a, i) {
                    void 0 === a && (a = []), void 0 === i && (i = !0), Laya.timer.once(e, t, n, a, i)
                }, e.loop = function (e, t, n, a, i, o) {
                    void 0 === a && (a = []), void 0 === i && (i = !0), void 0 === o && (o = !1), Laya.timer.loop(e, t, n, a, i, o)
                }, e.frameOnce = function (e, t, n, a, i) {
                    Laya.timer.frameOnce(e, t, n, a, i)
                }, e.frameLoop = function (e, t, n, a, i) {
                    void 0 === a && (a = null), void 0 === i && (i = !0), Laya.timer.frameLoop(e, t, n, a, i)
                }, e.clear = function (e, t) {
                    Laya.timer.clear(e, t)
                }, e.clearAll = function (e) {
                    Laya.timer.clearAll(e)
                }, e.callLater = function (e, t, n) {
                    Laya.timer.callLater(e, t, n)
                }, e.runCallLater = function (e, t) {
                    Laya.timer.runCallLater(e, t)
                }, e.runTimer = function (e, t) {
                    Laya.timer.runTimer(e, t)
                }, e
            }();
            n.TimerUtil = a
        }, {}],
        52: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.urlCount = 0, e.urlLoaded = 0, e.arrayBuffer = null, e.parentLoader = null, e.dis = null, e
                }

                return __extends(e, t), e.prototype.onEntryLoaded = function () {
                    this.urlLoaded++, this.urlLoaded >= this.urlCount ? this.parentLoader && this.parentLoader.endLoad(this.data) : this.parseNext()
                }, e.prototype.parseNext = function () {
                    if (this.urlLoaded < this.urlCount) {
                        var e = this.dis.readUTFString(), t = this.dis.readInt32(), n = Laya.Utils.getFileExtension(e),
                            a = null;
                        if ("lm" === n || "lani" === n) a = this.dis.readArrayBuffer(t); else {
                            var i = this.dis.readCustomString(t);
                            a = JSON.parse(i)
                        }
                        var o = new h;
                        o.zipLoader = this;
                        var r = Laya.LoaderManager.createMap[n];
                        o._type = r[0];
                        var s = this.url;
                        s = s.substring(0, s.lastIndexOf("/") + 1) + e, o._url = s, o.on("complete", o, o.onEntryLoaded);
                        var l = Laya3D;
                        "lm" === n ? l._onMeshLmLoaded(o, a) : "lani" === n || "lav" === n ? o.event("complete", a) : "lmat" === n ? l._onMaterilLmatLoaded(o, a) : "lh" === n && l._onHierarchylhLoaded(o, a)
                    }
                }, e.prototype.onFileLoaded = function (e) {
                    this.arrayBuffer = e, this.dis = new Laya.Byte(e), this.dis.endian = Laya.Byte.BIG_ENDIAN, this.urlCount = this.dis.getInt16(), this.urlLoaded = 0, this.parseNext()
                }, e.prototype.onError = function () {
                    this.parentLoader && this.parentLoader.endLoad()
                }, e
            }(Laya.Loader);
            n.ZipLoader = a;
            var h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.zipLoader = null, e
                }

                return __extends(e, t), e.prototype.onEntryLoaded = function (e) {
                    var t = Laya.Utils.getFileExtension(this.url), n = Laya.LoaderManager.createMap[t][1], a = null;
                    (a = "lmat" === t && -1 !== this.url.indexOf("/particle") ? new Laya.ShurikenParticleMaterial : new n).onAsynLoaded(this.url, e), Laya.LoaderManager.cacheRes(Laya.URL.formatURL(this.url), a), this.zipLoader && this.zipLoader.onEntryLoaded()
                }, e
            }(Laya.Loader);
            n.ZipEntryLoader = h;
            var i = function () {
                function e() {
                }

                return e.prototype.onAsynLoaded = function () {
                }, e.prototype._setUrl = function () {
                }, e.initZipLoader = function () {
                    Laya3D._loadZip = function (e) {
                        var t = new a;
                        t.parentLoader = e, t.on("complete", t, t.onFileLoaded), t.on("error", t, t.onError), t.load(e.url, "arraybuffer", !1, null, !0)
                    }, Laya.LoaderManager.createMap.zip = ["ZIP", e], Laya.Loader.parserMap.ZIP = Laya3D._loadZip
                }, e
            }();
            n.ZipFile = i
        }, {}],
        53: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), i = e("../core/managee/DEventManage"), o = e("../conslt/DEvent"),
                r = e("../game/joystick/JoystickModule"), s = e("../core/managee/SoundtManager"),
                l = e("../game/managre/GameMaanager"), h = e("../utils/MathUtil"), c = e("../utils/TimerUtil"),
                d = e("../conslt/DSound"), u = e("./item/BroadcastView"), p = function (t) {
                    function e() {
                        var e = null !== t && t.apply(this, arguments) || this;
                        return e.joyStick = null, e.countDown = 5, e
                    }

                    return __extends(e, t), e.prototype.init = function (e) {
                        this.initJoyStick(), this.regiesterEvent(), this.showGameCD(), this.levelLabel.text = "LV.1", this.killNumLabel.text = "0", this.progressLabel.text = "0", this.levelProgressBar.value = 0, this.refreshRankList()
                    }, e.prototype.uninit = function () {
                        this.uninitJoyStick(), this.unregiesterEvent(), this.timer.clearAll(this), this.hideMoveGuide(), s.SoundtManager.Instance.curBgmName = null, s.SoundtManager.Instance.stopMusic(), Laya.timer.clear(this, this.hideBroadCastView)
                    }, e.prototype.regiesterEvent = function () {
                        i.DEventManage.Instance.on(o.DEvent.ReliveViewShow, this, this.onReliveShow), i.DEventManage.Instance.on(o.DEvent.BattleTimeChange, this, this.onRefreshBattleTime), i.DEventManage.Instance.on(o.DEvent.killNumChange, this, this.onKillNumChange), i.DEventManage.Instance.on(o.DEvent.onAddEnergy, this, this.onAddEnery), i.DEventManage.Instance.on(o.DEvent.kill, this, this.onRoleKill)
                    }, e.prototype.unregiesterEvent = function () {
                        i.DEventManage.Instance.off(o.DEvent.ReliveViewShow, this, this.onReliveShow), i.DEventManage.Instance.off(o.DEvent.BattleTimeChange, this, this.onRefreshBattleTime), i.DEventManage.Instance.off(o.DEvent.killNumChange, this, this.onKillNumChange), i.DEventManage.Instance.off(o.DEvent.onAddEnergy, this, this.onAddEnery), i.DEventManage.Instance.off(o.DEvent.kill, this, this.onRoleKill)
                    }, e.prototype.initJoyStick = function () {
                        this.joyStick = new r.JoystickModule(this.joyStickView, this.joyStickBtn, this.thumb, this.joyStickTouch, this.joyStickCenter), this.joyStick.on(r.JoystickModule.JoystickMoving, this, this.onJoystickMoving), this.joyStick.on(r.JoystickModule.JoystickUp, this, this.onJoystickUp), this.showJoyStick(!1)
                    }, e.prototype.uninitJoyStick = function () {
                        this.joyStick && (this.joyStick.clear(), this.joyStick = null)
                    }, e.prototype.showJoyStick = function (e) {
                        this.joyStickBtn.visible = e, this.joyStickCenter.visible = e
                    }, e.prototype.onJoystickMoving = function (e) {
                        i.DEventManage.Instance.event(o.DEvent.moveInputChange, {deg: e, disRate: 1}), this.showJoyStick(!0)
                    }, e.prototype.onJoystickUp = function () {
                        i.DEventManage.Instance.event(o.DEvent.moveInputChange, {deg: 0, disRate: 0}), this.showJoyStick(!1)
                    }, e.prototype.showGameCD = function () {
                        this.countDown = 3, this.coundDownImg.visible = !0, this.coundDownImg.skin = "common/num_" + this.countDown + ".png", this.timer.loop(1e3, this, this.updateCountDown)
                    }, e.prototype.updateCountDown = function () {
                        this.countDown -= 1, this.coundDownImg.skin = "common/num_" + this.countDown + ".png", this.countDown <= 0 ? (this.coundDownImg.visible = !1, this.showMoveGuide(), i.DEventManage.Instance.event(o.DEvent.gameStartCDEnd), s.SoundtManager.Instance.playSound(d.DSound.gameStart), this.timer.clear(this, this.updateCountDown), this.timer.once(2e3, this, this.hideMoveGuide), s.SoundtManager.Instance.playBattleBgm()) : s.SoundtManager.Instance.playSound(d.DSound.coundDown)
                    }, e.prototype.showMoveGuide = function () {
                        this.moveGuideAni.visible = !0, this.moveGuideAni.play(0, !0)
                    }, e.prototype.hideMoveGuide = function () {
                        this.moveGuideAni.visible = !1, this.moveGuideAni.stop()
                    }, e.prototype.onReliveShow = function (e) {
                        e ? (s.SoundtManager.Instance.curBgmName = null, s.SoundtManager.Instance.stopMusic(), l.GameMaanager.Instance.setGamePause(!0)) : (s.SoundtManager.Instance.playBattleBgm(), l.GameMaanager.Instance.setGamePause(!1), this.updateRecordBtn())
                    }, e.prototype.updateRecordBtn = function () {
                    }, e.prototype.onRefreshBattleTime = function (e) {
                        e <= 30 && 0 < e && (this.timeLabel.color = "#ff0000", c.TimerUtil.once(500, this, this.changeTextColor)), this.showGameCountDown(e);
                        var t = h.default.getInt(e / 60), n = e - 60 * t, a = "";
                        a = 10 <= t ? t.toString() : "0" + t.toString(), a = 10 <= n ? a + ":" + n.toString() : a + ":0" + n.toString(), this.timeLabel.text = a, this.refreshRankList()
                    }, e.prototype.changeTextColor = function () {
                        this.timeLabel.color = "#ffffff"
                    }, e.prototype.showGameCountDown = function (e) {
                        var t = this;
                        e <= 5 && (this.coundDownImg.visible = !0, this.coundDownImg.skin = "common/num_" + Math.floor(e) + ".png", s.SoundtManager.Instance.playSound(d.DSound.coundDown), this.timer.once(500, this, function () {
                            t.coundDownImg.visible = !1
                        }))
                    }, e.prototype.onKillNumChange = function () {
                        l.GameMaanager.Instance.mainRole && (this.killNumLabel.text = "" + l.GameMaanager.Instance.mainRole.killNum)
                    }, e.prototype.refreshRankList = function () {
                        var e = l.GameMaanager.Instance.curScene.roleArr;
                        e.sort(function (e, t) {
                            return t.energy - e.energy
                        });
                        var t = e.map(function (e, t) {
                            return {index: t, nickName: e.roleName, score: e.energy, isHighlight: !1}
                        });
                        this.rankList.dataSource = t, this.rankList.renderHandler = new Laya.Handler(this, this.renderRankListItem)
                    }, e.prototype.renderRankListItem = function (e, t) {
                        var n = e.dataSource;
                        e.updateItem(n)
                    }, e.prototype.onAddEnery = function () {
                        var e = l.GameMaanager.Instance.mainRole;
                        e && (this.levelLabel.text = "LV. " + e.level, this.progressLabel.text = "" + e.energy, this.levelProgressBar.value = e.levelProgress)
                    }, e.prototype.onRoleKill = function (e) {
                        if (e && e.killer === l.GameMaanager.Instance.mainRole) {
                            var t = {
                                viewType: u.BroadcastViewType.Kill,
                                killerAvatar: e.killer.roleData.head,
                                killedAvatar: e.deather.roleData.head,
                                showBg: !0
                            };
                            this.commonTips.visible = !0, this.commonTips.showBroadCastView(t), Laya.timer.once(2e3, this, this.hideBroadCastView, null, !0)
                        }
                    }, e.prototype.hideBroadCastView = function () {
                        this.commonTips.visible = !1
                    }, e
                }(a.ui.GameViewUI);
            n.default = p
        }, {
            "../conslt/DEvent": 4,
            "../conslt/DSound": 7,
            "../core/managee/DEventManage": 12,
            "../core/managee/SoundtManager": 18,
            "../game/joystick/JoystickModule": 23,
            "../game/managre/GameMaanager": 27,
            "../ui/layaMaxUI": 46,
            "../utils/MathUtil": 49,
            "../utils/TimerUtil": 51,
            "./item/BroadcastView": 66
        }],
        54: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), i = e("../core/managee/SoundtManager"), o = e("../core/managee/DUIManager"),
                r = e("../conslt/DIUIConfig"), s = e("../game/managre/GameShaereManager"), l = e("../conslt/DEvent"),
                h = e("../core/managee/DEventManage"), c = e("../conslt/DSound"), d = e("../game/data/GameData"),
                u = function (t) {
                    function e() {
                        var e = null !== t && t.apply(this, arguments) || this;
                        return e.coin = 500, e.curSharePos = s.ShareVideoPos.Unknow, e
                    }

                    return __extends(e, t), e.prototype.init = function (e) {
                        this.registerEvent(), this.initView();
                        var t = this;
                        this.closeBtn.visible = !1, Laya.timer.once(1500, this, function () {
                            t.closeBtn.visible = !0
                        })
                    }, e.prototype.uninit = function () {
                        this.unregisterEvent()
                    }, e.prototype.registerEvent = function () {
                        this.closeBtn.on(Laya.Event.CLICK, this, this.onClosed), this.btn.on(Laya.Event.CLICK, this, this.onVedioBtn), h.DEventManage.Instance.on(l.DEvent.ShowAdCompleted, this, this.onShowAdCompleted), h.DEventManage.Instance.on(l.DEvent.CloseShowAd, this, this.onCloseShowAd)
                    }, e.prototype.unregisterEvent = function () {
                        this.closeBtn.off(Laya.Event.CLICK, this, this.onClosed), this.btn.off(Laya.Event.CLICK, this, this.onVedioBtn), h.DEventManage.Instance.off(l.DEvent.ShowAdCompleted, this, this.onShowAdCompleted), h.DEventManage.Instance.off(l.DEvent.CloseShowAd, this, this.onCloseShowAd)
                    }, e.prototype.initView = function () {
                        this.coinNum.text = "+" + this.coin + "金币", this.heartAni.play(0, !0)
                    }, e.prototype.onClosed = function () {
                        i.SoundtManager.Instance.playUIClick(), o.DUIManager.Instance.closeUI(r.DIUIConfig.GetMoney)
                    }, e.prototype.onVedioBtn = function () {
                        i.SoundtManager.Instance.playUIClick(), this.curSharePos = s.ShareVideoPos.GetMoneyAD, s.GameShaereManager.Instance.showVideoOrrShare(this.curSharePos)
                    }, e.prototype.onShowAdCompleted = function (e) {
                        e === this.curSharePos && (o.DUIManager.Instance.showTips("免费领取成功"), i.SoundtManager.Instance.playSound(c.DSound.Gold), d.GameData.Instance.updateWithChangeData({gold: this.coin}), this.curSharePos = s.ShareVideoPos.Unknow, o.DUIManager.Instance.closeUI(r.DIUIConfig.GetMoney))
                    }, e.prototype.onCloseShowAd = function (e) {
                        e === this.curSharePos && e === s.ShareVideoPos.SettlementAD && o.DUIManager.Instance.showTips("完整看完视频才能领取奖励")
                    }, e
                }(a.ui.GetMoneyViewUI);
            n.default = u
        }, {
            "../conslt/DEvent": 4,
            "../conslt/DIUIConfig": 5,
            "../conslt/DSound": 7,
            "../core/managee/DEventManage": 12,
            "../core/managee/DUIManager": 13,
            "../core/managee/SoundtManager": 18,
            "../game/data/GameData": 21,
            "../game/managre/GameShaereManager": 28,
            "../ui/layaMaxUI": 46
        }],
        55: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), i = e("../game/data/GameData"), o = e("../core/managee/SoundtManager"),
                r = e("../game/managre/GameShaereManager"), s = e("../conslt/DIUIConfig"),
                l = e("../core/managee/DUIManager"), h = e("../conslt/DSound"), c = function (e) {
                    function t() {
                        return null !== e && e.apply(this, arguments) || this
                    }

                    return __extends(t, e), t.prototype.init = function (e) {
                        this.registerEvent(), this.initView();
                        var t = this;
                        this.closeBtn.visible = !1, Laya.timer.once(1500, this, function () {
                            t.closeBtn.visible = !0
                        })
                    }, t.prototype.uninit = function () {
                        this.unregisterEvent()
                    }, t.prototype.registerEvent = function () {
                        this.closeBtn.on(Laya.Event.CLICK, this, this.onClosed), this.shareBtn.on(Laya.Event.CLICK, this, this.onShareBtn)
                    }, t.prototype.unregisterEvent = function () {
                        this.closeBtn.off(Laya.Event.CLICK, this, this.onClosed), this.shareBtn.off(Laya.Event.CLICK, this, this.onShareBtn)
                    }, t.prototype.initView = function () {
                        o.SoundtManager.Instance.playSound(h.DSound.LevelUpdate);
                        var e = i.GameData.Instance.gradeCfg;
                        this.gradeImage.skin = e.icon, this.gradeName.text = e.name, this.goldPlus.text = e.goldPlus + "%", this.bgAni.play(0, !0), this.heartAni.play(0, !0)
                    }, t.prototype.onClosed = function () {
                        o.SoundtManager.Instance.playUIClick(), l.DUIManager.Instance.closeUI(s.DIUIConfig.Settlement), l.DUIManager.Instance.toUI(s.DIUIConfig.Start, null), l.DUIManager.Instance.closeUI(s.DIUIConfig.GradeUp)
                    }, t.prototype.onShareBtn = function () {
                        o.SoundtManager.Instance.playUIClick(), r.GameShaereManager.Instance.showVideoOrrShare(r.ShareVideoPos.GradeUpShare)
                    }, t
                }(a.ui.GradeUpViewUI);
            n.default = c
        }, {
            "../conslt/DIUIConfig": 5,
            "../conslt/DSound": 7,
            "../core/managee/DUIManager": 13,
            "../core/managee/SoundtManager": 18,
            "../game/data/GameData": 21,
            "../game/managre/GameShaereManager": 28,
            "../ui/layaMaxUI": 46
        }],
        56: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), i = e("../game/data/GameData"), o = e("../conslt/DIUIConfig"),
                r = e("../core/managee/DUIManager"), s = e("../core/managee/SoundtManager"),
                l = e("../core/managee/DEventManage"), h = e("../conslt/DEvent"), c = e("../GameMain"),
                d = e("../sdkm/SDKManager"), u = function (t) {
                    function e() {
                        var e = null !== t && t.apply(this, arguments) || this;
                        return e.loadSubpackage = !1, e.loadCompleted = !1, e
                    }

                    return __extends(e, t), e.prototype.init = function (e) {
                        this.loadSubpackage = e.loadSubpackage || !1, this.registerEvent()
                    }, e.prototype.uninit = function () {
                        this.unregisterEvent()
                    }, e.prototype.registerEvent = function () {
                        l.DEventManage.Instance.on(h.DEvent.ResLoadProgress, this, this.onRefreshProgress), l.DEventManage.Instance.on(h.DEvent.StartLoadFinish, this, this.onLoadCompleted), l.DEventManage.Instance.on(h.DEvent.userLoginFinish, this, this.userLoginFinish), l.DEventManage.Instance.on(h.DEvent.SubpackageLoadProgress, this, this.onSubpackageLoadProgress)
                    }, e.prototype.unregisterEvent = function () {
                        l.DEventManage.Instance.off(h.DEvent.ResLoadProgress, this, this.onRefreshProgress), l.DEventManage.Instance.off(h.DEvent.StartLoadFinish, this, this.onLoadCompleted), l.DEventManage.Instance.off(h.DEvent.userLoginFinish, this, this.userLoginFinish), l.DEventManage.Instance.off(h.DEvent.SubpackageLoadProgress, this, this.onSubpackageLoadProgress)
                    }, e.prototype.onRefreshProgress = function (e) {
                        e < 0 && (e = 0), 1 < e && (e = 1), this.loadSubpackage ? this.updateProgress(.5 + e / 2) : this.updateProgress(e)
                    }, e.prototype.onSubpackageLoadProgress = function (e) {
                        e < 0 && (e = 0), 1 < e && (e = 1), this.updateProgress(e / 2)
                    }, e.prototype.updateProgress = function (e) {
                        e < 0 && (e = 0), 1 < e && (e = 1);
                        var t = (100 * e).toFixed(0) + "%";
                        this.loadingLabel.changeText(t || "");
                        var n = Math.floor(369 * e);
                        this.progressImageMask.graphics.clear(), this.progressImageMask.graphics.drawRect(0, 0, n, 40, "#FF0000")
                    }, e.prototype.closeLoadingView = function () {
                        r.DUIManager.Instance.closeUI(o.DIUIConfig.Load)
                    }, e.prototype.showMainView = function () {
                        this.closeLoadingView(), s.SoundtManager.Instance.playBgm(), r.DUIManager.Instance.openUI(o.DIUIConfig.Start)
                    }, e.prototype.onLoadCompleted = function () {
                        this.loadCompleted = !0, i.GameData.Instance.logined ? this.showMainView() : i.GameData.Instance.loginError && this.showtReTryBtn()
                    }, e.prototype.userLoginFinish = function (e) {
                        e.logined ? this.onStart() : this.loadCompleted && this.showtReTryBtn()
                    }, e.prototype.onStart = function () {
                        this.loadCompleted && (i.GameData.Instance.logined ? this.showMainView() : i.GameData.Instance.loginError && c.GameMain.Instance.doLoginAction(null))
                    }, e.prototype.showtReTryBtn = function () {
                        var t = this;
                        "undefined" != typeof wx && (d.SDKManager.IsTencentGame() || d.SDKManager.IsTouTiao()) && wx.showModal({
                            title: "提示",
                            cancelText: "",
                            cancelColor: "#000000",
                            confirmColor: "#3CC51F",
                            showCancel: !1,
                            content: "登录发生错误，请点击重试!",
                            confirmText: "立即重试",
                            success: function (e) {
                                t.onStart()
                            },
                            complete: null,
                            fail: null
                        })
                    }, e
                }(a.ui.LoadingViewUI);
            n.LoadingView = u
        }, {
            "../GameMain": 2,
            "../conslt/DEvent": 4,
            "../conslt/DIUIConfig": 5,
            "../core/managee/DEventManage": 12,
            "../core/managee/DUIManager": 13,
            "../core/managee/SoundtManager": 18,
            "../game/data/GameData": 21,
            "../sdkm/SDKManager": 42,
            "../ui/layaMaxUI": 46
        }],
        57: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), i = e("./item/MatchPlayerItemView"), o = e("../utils/MathUtil"),
                r = e("../core/managee/DEventManage"), s = e("../conslt/DEvent"), l = e("../game/data/GameData"),
                h = e("../game/managre/GameMaanager"), c = function (e) {
                    function t() {
                        return null !== e && e.apply(this, arguments) || this
                    }

                    return __extends(t, e), t.prototype.init = function (e) {
                        this.regiestEvent(), this.updateView()
                    }, t.prototype.uninit = function () {
                        Laya.timer.clearAll(this), this.unregiestEvent()
                    }, t.prototype.regiestEvent = function () {
                    }, t.prototype.unregiestEvent = function () {
                    }, t.prototype.updateView = function () {
                        var e = h.GameMaanager.Instance.generateAIPlayerList(14), a = [], t = new i.MatchPlayItem;
                        t.avatar = l.GameData.Instance.user.avatar, t.time = 0, a.push(t), e.forEach(function (e, t) {
                            var n = new i.MatchPlayItem;
                            n.avatar = e.avatar, n.time = o.default.getRandom(200, 2e3), a.push(n)
                        }), this.matchList.renderHandler = new Laya.Handler(this, this.renderMatchItem), this.matchList.dataSource = a, Laya.timer.once(3e3, this, function () {
                            r.DEventManage.Instance.event(s.DEvent.BattleMatchSuccess)
                        })
                    }, t.prototype.renderMatchItem = function (e, t) {
                        var n = e.dataSource;
                        e.updateItem(n)
                    }, t
                }(a.ui.QuickBattleMatchUI);
            n.default = c
        }, {
            "../conslt/DEvent": 4,
            "../core/managee/DEventManage": 12,
            "../game/data/GameData": 21,
            "../game/managre/GameMaanager": 27,
            "../ui/layaMaxUI": 46,
            "../utils/MathUtil": 49,
            "./item/MatchPlayerItemView": 71
        }],
        58: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), i = e("../core/managee/DEventManage"), o = e("../conslt/DEvent"),
                r = e("../core/managee/SoundtManager"), s = e("../core/managee/DUIManager"),
                l = e("../conslt/DIUIConfig"), h = e("../conslt/DSound"), c = e("../game/data/GameData"),
                d = e("../core/managee/GameRecodrderManager"), u = function (t) {
                    function e() {
                        var e = null !== t && t.apply(this, arguments) || this;
                        return e.coin = 500, e
                    }

                    return __extends(e, t), e.prototype.init = function (e) {
                        this.registerEvent(), this.initView();
                        var t = this;
                        this.closeBtn.visible = !1, Laya.timer.once(1500, this, function () {
                            t.closeBtn.visible = !0
                        })
                    }, e.prototype.uninit = function () {
                        this.unregisterEvent()
                    }, e.prototype.registerEvent = function () {
                        this.closeBtn.on(Laya.Event.CLICK, this, this.onClosed), this.btn.on(Laya.Event.CLICK, this, this.onRecordShareBtn), i.DEventManage.Instance.on(o.DEvent.ShowShareVideoCompleted, this, this.onShowShareViewCompleted)
                    }, e.prototype.unregisterEvent = function () {
                        this.closeBtn.off(Laya.Event.CLICK, this, this.onClosed), this.btn.off(Laya.Event.CLICK, this, this.onRecordShareBtn), i.DEventManage.Instance.off(o.DEvent.ShowShareVideoCompleted, this, this.onShowShareViewCompleted)
                    }, e.prototype.initView = function () {
                        this.heartAni.play(0, !0)
                    }, e.prototype.onClosed = function () {
                        r.SoundtManager.Instance.playUIClick(), s.DUIManager.Instance.closeUI(l.DIUIConfig.RecordShare)
                    }, e.prototype.onRecordShareBtn = function () {
                        r.SoundtManager.Instance.playUIClick(), d.GameRecodrderManager.Instance.shareVideo(1)
                    }, e.prototype.onShowShareViewCompleted = function (e) {
                        1 === e && (s.DUIManager.Instance.showTips("领取分享视频奖励成功"), r.SoundtManager.Instance.playSound(h.DSound.Gold), c.GameData.Instance.updateWithChangeData({gold: this.coin}), s.DUIManager.Instance.closeUI(l.DIUIConfig.RecordShare))
                    }, e
                }(a.ui.RecordShareViewUI);
            n.default = u
        }, {
            "../conslt/DEvent": 4,
            "../conslt/DIUIConfig": 5,
            "../conslt/DSound": 7,
            "../core/managee/DEventManage": 12,
            "../core/managee/DUIManager": 13,
            "../core/managee/GameRecodrderManager": 14,
            "../core/managee/SoundtManager": 18,
            "../game/data/GameData": 21,
            "../ui/layaMaxUI": 46
        }],
        59: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), i = e("../game/managre/GameShaereManager"),
                o = e("../core/managee/DEventManage"), r = e("../conslt/DEvent"),
                s = e("../core/managee/SoundtManager"), l = e("../conslt/DSound"), h = e("../utils/TimerUtil"),
                c = e("../game/managre/GameMaanager"), d = e("../core/managee/DUIManager"),
                u = e("../conslt/DIUIConfig"), p = e("../sdkm/SDKManager"), g = e("../game/managre/DataManmager"),
                m = function (t) {
                    function e() {
                        var e = t.call(this) || this;
                        return e.countDown = 5, e.hasShow = !1, e.curVideoPos = 0, e
                    }

                    return __extends(e, t), e.prototype.init = function (e) {
                        this.hasShow = !0, this.regiestEvent(), this.continueView.visible = !1, Laya.timer.once(2e3, this, this.showContinueView), this.countDown = 5, this.coundDownImg.skin = "common/num_" + this.countDown + ".png", this.coundDownImg.visible = !0, i.GameShaereManager.Instance.canFetchVideo ? (this.watchADButton.visible = !0, this.shareButton.visible = !1) : (this.watchADButton.visible = !1, this.shareButton.visible = !0), this.startCountDown()
                    }, e.prototype.uninit = function () {
                        Laya.timer.clearAll(this), this.unregiestEvent(), this.stopCountDown(), Laya.timer.clear(this, this.showContinueView), this.hasShow = !1
                    }, e.prototype.regiestEvent = function () {
                        this.continueView.on(Laya.Event.CLICK, this, this.onClose), this.shareButton.on(Laya.Event.CLICK, this, this.onShare), this.watchADButton.on(Laya.Event.CLICK, this, this.onShowVideoAd), o.DEventManage.Instance.on(r.DEvent.ShowAdCompleted, this, this.onShowAdCompleted), o.DEventManage.Instance.on(r.DEvent.CloseShowAd, this, this.onCloseShowAd)
                    }, e.prototype.unregiestEvent = function () {
                        this.continueView.off(Laya.Event.CLICK, this, this.onClose), this.shareButton.off(Laya.Event.CLICK, this, this.onShare), this.watchADButton.off(Laya.Event.CLICK, this, this.onShowVideoAd), o.DEventManage.Instance.off(r.DEvent.ShowAdCompleted, this, this.onShowAdCompleted), o.DEventManage.Instance.off(r.DEvent.CloseShowAd, this, this.onCloseShowAd)
                    }, e.prototype.updateCountDown = function () {
                        if (this.countDown -= 1, this.coundDownImg.skin = "common/num_" + this.countDown + ".png", s.SoundtManager.Instance.playSound(l.DSound.coundDown), 0 === this.countDown) return h.TimerUtil.clear(this, this.updateCountDown), void this.onClose()
                    }, e.prototype.startCountDown = function () {
                        this.stopCountDown(), Laya.timer.loop(1e3, this, this.updateCountDown)
                    }, e.prototype.onClose = function () {
                        this.stopCountDown(), c.GameMaanager.Instance.mainRole.relive(g.DataManmager.roleReliveType.INIT), d.DUIManager.Instance.hideUI(u.DIUIConfig.Revive), this.hasShow = !1
                    }, e.prototype.stopCountDown = function () {
                        Laya.timer.clear(this, this.updateCountDown)
                    }, e.prototype.didShow = function () {
                        o.DEventManage.Instance.event(r.DEvent.ReliveViewShow, !0)
                    }, e.prototype.showContinueView = function () {
                        this.continueView.visible = !0, p.SDKManager.IsTouTiao() && (this.continueView.color = "#FFD905")
                    }, e.prototype.onCloseShowAd = function (e) {
                        e === this.curVideoPos && (d.DUIManager.Instance.showTips("完整看完视频才能保级复活"), this.startCountDown())
                    }, e.prototype.didHide = function () {
                        o.DEventManage.Instance.event(r.DEvent.ReliveViewShow, !1)
                    }, e.prototype.onShowVideoAd = function () {
                        this.stopCountDown(), this.curVideoPos = i.ShareVideoPos.ReliveAD, i.GameShaereManager.Instance.showVideoOrrShare(this.curVideoPos)
                    }, e.prototype.reliveOriginLevel = function () {
                        this.stopCountDown(), c.GameMaanager.Instance.mainRole.relive(g.DataManmager.roleReliveType.CONTINUE), d.DUIManager.Instance.hideUI(u.DIUIConfig.Revive), this.hasShow = !1
                    }, e.prototype.onShare = function () {
                        this.stopCountDown(), this.curVideoPos = i.ShareVideoPos.ReliveShare, i.GameShaereManager.Instance.showVideoOrrShare(this.curVideoPos)
                    }, e.prototype.onShowAdCompleted = function (e) {
                        e === this.curVideoPos && (this.reliveOriginLevel(), this.curVideoPos = i.ShareVideoPos.Unknow)
                    }, e
                }(a.ui.ReliveViewUI);
            n.ReliveView = m
        }, {
            "../conslt/DEvent": 4,
            "../conslt/DIUIConfig": 5,
            "../conslt/DSound": 7,
            "../core/managee/DEventManage": 12,
            "../core/managee/DUIManager": 13,
            "../core/managee/SoundtManager": 18,
            "../game/managre/DataManmager": 26,
            "../game/managre/GameMaanager": 27,
            "../game/managre/GameShaereManager": 28,
            "../sdkm/SDKManager": 42,
            "../ui/layaMaxUI": 46,
            "../utils/TimerUtil": 51
        }],
        60: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), i = e("../conslt/GameConst"), o = e("../core/managee/SoundtManager"),
                r = e("../core/managee/DUIManager"), s = e("../conslt/DIUIConfig"), l = function (e) {
                    function t() {
                        return null !== e && e.apply(this, arguments) || this
                    }

                    return __extends(t, e), t.prototype.init = function (e) {
                        this.registerEvent(), this.updateBtns(), this.versionLabel.text = "v " + i.GameConst.ClientVer;
                        var t = this;
                        this.closeBtn.visible = !1, Laya.timer.once(1500, this, function () {
                            t.closeBtn.visible = !0
                        })
                    }, t.prototype.uninit = function () {
                        this.unregisterEvent()
                    }, t.prototype.registerEvent = function () {
                        this.closeBtn.on(Laya.Event.CLICK, this, this.onCloseBtn), this.soundBtn.on(Laya.Event.CLICK, this, this.onSoundBtn), this.musicBtn.on(Laya.Event.CLICK, this, this.onMusicBtn)
                    }, t.prototype.unregisterEvent = function () {
                        this.closeBtn.off(Laya.Event.CLICK, this, this.onCloseBtn), this.soundBtn.off(Laya.Event.CLICK, this, this.onSoundBtn), this.musicBtn.off(Laya.Event.CLICK, this, this.onMusicBtn)
                    }, t.prototype.onCloseBtn = function () {
                        o.SoundtManager.Instance.playUIClick(), r.DUIManager.Instance.closeUI(s.DIUIConfig.Setting)
                    }, t.prototype.updateBtns = function () {
                        var e = o.SoundtManager.Instance.getMusicVolume();
                        this.musicBtn.skin = this.getCheckImage(0 != e);
                        var t = o.SoundtManager.Instance.getSoundVolume();
                        this.soundBtn.skin = this.getCheckImage(0 != t)
                    }, t.prototype.onMusicBtn = function () {
                        o.SoundtManager.Instance.playUIClick();
                        var e = 0 == o.SoundtManager.Instance.getMusicVolume() ? 1 : 0;
                        o.SoundtManager.Instance.setMusicVolume(e), o.SoundtManager.Instance.setMusicMute(0 == e), 1 == e && o.SoundtManager.Instance.playBgm(), this.updateBtns()
                    }, t.prototype.getCheckImage = function (e) {
                        return e ? "common/ic_check.png" : "common/ic_uncheck.png"
                    }, t.prototype.onSoundBtn = function () {
                        o.SoundtManager.Instance.playUIClick();
                        var e = 0 == o.SoundtManager.Instance.getSoundVolume() ? 1 : 0;
                        o.SoundtManager.Instance.setSoundVolume(e), o.SoundtManager.Instance.setSoundMute(0 == e), this.updateBtns()
                    }, t
                }(a.ui.SettingViewUI);
            n.default = l
        }, {
            "../conslt/DIUIConfig": 5,
            "../conslt/GameConst": 8,
            "../core/managee/DUIManager": 13,
            "../core/managee/SoundtManager": 18,
            "../ui/layaMaxUI": 46
        }],
        61: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), h = e("../core/managee/SoundtManager"), i = e("../core/managee/DUIManager"),
                o = e("../conslt/DIUIConfig"), c = e("../game/data/GameData"), d = e("../conslt/DSound"),
                u = e("../game/managre/DataManmager"), p = e("../utils/TimerUtil"),
                r = e("../core/managee/DEventManage"), s = e("../conslt/DEvent"),
                l = e("../game/managre/GameShaereManager"), g = e("../core/managee/GameRecodrderManager"),
                m = function (t) {
                    function e() {
                        var e = null !== t && t.apply(this, arguments) || this;
                        return e.data = null, e.sort = 0, e.coin = 0, e.cfg = null, e.newCfg = null, e.cup = 0, e.newCup = 0, e.addCup = 0, e.hasUp = !1, e.closed = !1, e.playerCup = 0, e.mCup = 0, e.aniTime = 0, e.needDoBtnAni = !1, e.curSharePos = l.ShareVideoPos.Unknow, e
                    }

                    return __extends(e, t), e.prototype.init = function (e) {
                        this.data = e, this.sort = this.data.sort || 1;
                        var t = this.data.energy || 0;
                        this.cup = c.GameData.Instance.cup, this.cfg = c.GameData.Instance.gradeCfg, this.coin = Math.floor(t / 4 * (this.cfg.goldPlus / 100)), this.registerEvent(), this.initView()
                    }, e.prototype.uninit = function () {
                        this.closed = !0, this.unregisterEvent(), this.lightAni.stop()
                    }, e.prototype.registerEvent = function () {
                        this.btn.on(Laya.Event.CLICK, this, this.onBtn), this.vedio3Btn.on(Laya.Event.CLICK, this, this.onVedioBtn), r.DEventManage.Instance.on(s.DEvent.ShowAdCompleted, this, this.onShowAdCompleted), r.DEventManage.Instance.on(s.DEvent.CloseShowAd, this, this.onCloseShowAd)
                    }, e.prototype.unregisterEvent = function () {
                        this.btn.off(Laya.Event.CLICK, this, this.onBtn), this.vedio3Btn.off(Laya.Event.CLICK, this, this.onVedioBtn), r.DEventManage.Instance.off(s.DEvent.ShowAdCompleted, this, this.onShowAdCompleted), r.DEventManage.Instance.off(s.DEvent.CloseShowAd, this, this.onCloseShowAd)
                    }, e.prototype.initView = function () {
                        this.coinNum.text = "" + this.coin, this.coinNum3.text = "" + 3 * this.coin, this.vedio3Btn.visible = !1, this.btn.visible = !1, this.lightAni.play(0, !0), this.initSortView(), this.addCup = this.calcCupBySort(), this.cupNum.text = "0", Laya.Tween.to(this, {labelAddCup: this.addCup}, 1500, Laya.Ease.linearNone), this.gradeItem.showInfo(), this.hasUp = this.gradeItem.addCup(this.addCup), this.doAnimate(), this.afterAni(), h.SoundtManager.Instance.playSound(d.DSound.Victory)
                    }, e.prototype.initSortView = function () {
                        3 < this.sort ? (this.sortImg.skin = "settlement/sort99.png", this.sortNum.text = this.sort + "", this.sortNum.visible = !0) : (this.sortImg.skin = "settlement/sort" + this.sort + ".png", this.sortNum.visible = !1)
                    }, e.prototype.calcCupBySort = function () {
                        var e = 11 - this.sort;
                        return e < 1 && (e = 1), e
                    }, e.prototype.doAnimate = function () {
                        var e = this;
                        h.SoundtManager.Instance.playSound(d.DSound.Progress, 100), this.newCup = c.GameData.Instance.cup, this.newCfg = c.GameData.Instance.gradeCfg;
                        var t = u.DataManmager.Instance.calcGradeProgressInfo(this.cup), n = t.count / t.total,
                            a = u.DataManmager.Instance.calcGradeProgressInfo(this.newCup), i = a.count / a.total;
                        if (this.gradeProgress.value = n, this.curValue.text = "" + Math.floor(t.count), this.maxValue.text = "/" + t.total, this.cfg.id >= this.newCfg.id) {
                            var o = this.calcTimeForPorgress(i - n);
                            Laya.Tween.to(this.gradeProgress, {value: i}, o, Laya.Ease.linearNone, Laya.Handler.create(this, this.aniComplete)), Laya.Tween.to(this, {labelPlayerCup: this.newCup}, o, Laya.Ease.linearNone), this.aniTime = o
                        } else {
                            var r = this.calcTimeForPorgress(1 - n), s = this.calcTimeForPorgress(i - 0),
                                l = u.DataManmager.Instance.nextCupForGrade(this.cfg.id - 1);
                            Laya.Tween.to(this, {labelPlayerCup: l}, r, Laya.Ease.linearNone), Laya.Tween.to(this.gradeProgress, {value: 1}, r, Laya.Ease.linearNone, Laya.Handler.create(this, function () {
                                h.SoundtManager.Instance.playSound(d.DSound.LevelUpdate), e.closed || (e.gradeItem.doAnimate(), p.TimerUtil.once(1e3, e, function () {
                                    this.closed || (this.gradeProgress.value = 0, this.maxValue.text = "/" + a.total, Laya.Tween.to(this, {labelPlayerCup: this.newCup}, r, Laya.Ease.linearNone), Laya.Tween.to(this.gradeProgress, {value: i}, s, Laya.Ease.linearNone, Laya.Handler.create(this, this.aniComplete)))
                                }))
                            })), this.aniTime = r + s + 1e3
                        }
                    }, Object.defineProperty(e.prototype, "labelPlayerCup", {
                        get: function () {
                            return this.playerCup
                        }, set: function (e) {
                            this.playerCup = e, this.curValue.text = "" + Math.floor(e)
                        }, enumerable: !0, configurable: !0
                    }), Object.defineProperty(e.prototype, "labelAddCup", {
                        get: function () {
                            return this.mCup
                        }, set: function (e) {
                            this.mCup = e, this.cupNum.text = "" + Math.floor(e)
                        }, enumerable: !0, configurable: !0
                    }), e.prototype.calcTimeForPorgress = function (e) {
                        var t = 2e3 * e;
                        return Math.max(1500, t)
                    }, e.prototype.aniComplete = function () {
                        h.SoundtManager.Instance.stopSound(d.DSound.Progress), this.curValue.changeText("" + this.newCup)
                    }, e.prototype.afterAni = function () {
                        var t = this;
                        p.TimerUtil.once(this.aniTime, this, function () {
                            t.needDoBtnAni = !0;
                            var e = g.GameRecodrderManager.Instance.videoPath;
                            e && e.length ? i.DUIManager.Instance.createUI(o.DIUIConfig.RecordShare, null) : this.doBtnAni()
                        })
                    }, e.prototype.doBtnAni = function () {
                        var e = this;
                        e.btn.visible = !0, e.btn.scaleX = 0, e.btn.scaleY = 0, Laya.Tween.to(e.btn, {
                            scaleX: 1,
                            scaleY: 1
                        }, 500, Laya.Ease.linearNone, Laya.Handler.create(e, function () {
                            e.vedio3Btn.visible = !0, e.vedio3Btn.scaleX = 0, e.vedio3Btn.scaleY = 0, Laya.Tween.to(e.vedio3Btn, {
                                scaleX: 1,
                                scaleY: 1
                            }, 500, Laya.Ease.linearNone, Laya.Handler.create(e, function () {
                                e.heartAni.play(0, !0)
                            }))
                        })), e.needDoBtnAni = !1
                    }, e.prototype.onBtn = function () {
                        h.SoundtManager.Instance.playUIClick(), i.DUIManager.Instance.showTips("领取成功"), h.SoundtManager.Instance.playSound(d.DSound.Gold), c.GameData.Instance.updateWithChangeData({gold: this.coin}), this.close()
                    }, e.prototype.onVedioBtn = function () {
                        h.SoundtManager.Instance.playUIClick(), this.curSharePos = l.ShareVideoPos.SettlementAD, l.GameShaereManager.Instance.showVideoOrrShare(this.curSharePos)
                    }, e.prototype.close = function () {
                        this.hasUp ? i.DUIManager.Instance.createUI(o.DIUIConfig.GradeUp, null) : (i.DUIManager.Instance.closeUI(o.DIUIConfig.Settlement), i.DUIManager.Instance.toUI(o.DIUIConfig.Start, null))
                    }, e.prototype.onShowAdCompleted = function (e) {
                        e === this.curSharePos && (i.DUIManager.Instance.showTips("领取3倍奖励成功"), h.SoundtManager.Instance.playSound(d.DSound.Gold), c.GameData.Instance.updateWithChangeData({gold: 3 * this.coin}), this.curSharePos = l.ShareVideoPos.Unknow, this.close())
                    }, e.prototype.onCloseShowAd = function (e) {
                        e === this.curSharePos && e === l.ShareVideoPos.SettlementAD && i.DUIManager.Instance.showTips("完整看完视频才能领取奖励")
                    }, e.prototype.didShow = function () {
                        this.needDoBtnAni && this.doBtnAni()
                    }, e
                }(a.ui.SettlementViewUI);
            n.default = m
        }, {
            "../conslt/DEvent": 4,
            "../conslt/DIUIConfig": 5,
            "../conslt/DSound": 7,
            "../core/managee/DEventManage": 12,
            "../core/managee/DUIManager": 13,
            "../core/managee/GameRecodrderManager": 14,
            "../core/managee/SoundtManager": 18,
            "../game/data/GameData": 21,
            "../game/managre/DataManmager": 26,
            "../game/managre/GameShaereManager": 28,
            "../ui/layaMaxUI": 46,
            "../utils/TimerUtil": 51
        }],
        62: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), i = e("../core/managee/DUIManager"), o = e("../core/managee/SoundtManager"),
                r = e("../conslt/DIUIConfig"), s = e("../game/managre/DataManmager"),
                u = e("../game/managre/SkinManager"), l = e("../game/managre/GameMaanager"),
                h = e("../game/managre/GameShaereManager"), p = e("../core/managee/DEventManage"),
                g = e("../conslt/DEvent"), c = function (t) {
                    function e() {
                        var e = null !== t && t.apply(this, arguments) || this;
                        return e.curItemSelected = null, e.curCfg = null, e.curSharePos = h.ShareVideoPos.Unknow, e
                    }

                    return __extends(e, t), e.prototype.init = function (e) {
                        this.registerEvent(), this.initData(), this.initView()
                    }, e.prototype.uninit = function () {
                        this.unregisterEvent()
                    }, e.prototype.registerEvent = function () {
                        this.closeBtn.on(Laya.Event.CLICK, this, this.onCloseBtn), this.centerBtn.on(Laya.Event.CLICK, this, this.onCenterBtn), this.tryBtn.on(Laya.Event.CLICK, this, this.onTryBtn), p.DEventManage.Instance.on(g.DEvent.ShowAdCompleted, this, this.onShowAdCompleted), p.DEventManage.Instance.on(g.DEvent.CloseShowAd, this, this.onCloseShowAd)
                    }, e.prototype.unregisterEvent = function () {
                        this.closeBtn.off(Laya.Event.CLICK, this, this.onCloseBtn), this.centerBtn.off(Laya.Event.CLICK, this, this.onCenterBtn), this.tryBtn.off(Laya.Event.CLICK, this, this.onTryBtn), p.DEventManage.Instance.off(g.DEvent.ShowAdCompleted, this, this.onShowAdCompleted), p.DEventManage.Instance.off(g.DEvent.CloseShowAd, this, this.onCloseShowAd)
                    }, e.prototype.onCloseBtn = function () {
                        o.SoundtManager.Instance.playUIClick(), i.DUIManager.Instance.closeUI(r.DIUIConfig.Skin)
                    }, e.prototype.initData = function () {
                        var e = u.SkinManager.Instance.curSkin;
                        this.curCfg = u.SkinManager.Instance.getSkinCfg(e)
                    }, e.prototype.initView = function () {
                        this.initList(), this.updateView()
                    }, e.prototype.initList = function () {
                        var c = this, d = s.DataManmager.Instance.skinCfg;
                        this.list.vScrollBarSkin = "", this.list.array = d, this.list.selectEnable = !0, this.list.renderHandler = new Laya.Handler(this, function (e, t) {
                            var n = d[t];
                            if (n) {
                                var a = e.getChildByName("itemSkin"), i = e.getChildByName("icHook"),
                                    o = e.getChildByName("lockBox"), r = e.getChildByName("icLock"),
                                    s = e.getChildByName("itemSelected"), l = !u.SkinManager.Instance.hasComplete(n.id);
                                a.skin = n.img, i.visible = !l && u.SkinManager.Instance.curSkin === n.id, o.visible = l, r.visible = l, s.visible = c.curCfg.id === n.id, s.visible && (c.curItemSelected = s);
                                var h = c;
                                e.offAll(null), e.on(Laya.Event.CLICK, c, function () {
                                    c.curCfg.id !== n.id && (null != h.curItemSelected && (h.curItemSelected.visible = !1), s.visible = !0, h.curCfg = n, h.curItemSelected = s, h.updateView(), p.DEventManage.Instance.event(g.DEvent.SkinShowChange, n.id))
                                })
                            }
                        })
                    }, e.prototype.updateView = function () {
                        this.updateAttr(), this.updateBottomView()
                    }, e.prototype.updateAttr = function () {
                        if (this.curCfg) {
                            var e = this.curCfg.attrSpeed - 100, t = this.curCfg.attrPower - 100;
                            this.attrSpeed.text = 0 === e ? "默认" : e + "%", this.attrPower.text = 0 === t ? "默认" : t + "%"
                        }
                    }, e.prototype.updateBottomView = function () {
                        if (this.unlockBtn.visible = !1, this.tryBtn.visible = !1, this.centerBtn.visible = !1, this.gradeCondition.visible = !1, this.progressCondition.visible = !1, this.curCfg) if (u.SkinManager.Instance.hasComplete(this.curCfg.id)) this.centerBtn.visible = !0, u.SkinManager.Instance.curSkin == this.curCfg.id ? (this.centerBtnLabel.text = "已使用", this.centerBtn.disabled = !0) : (this.centerBtnLabel.text = "使用皮肤", this.centerBtn.disabled = !1); else if (this.tryBtn.visible = !0, this.curCfg.conditionType == u.SkinType.grade) this.gradeCondition.visible = !0, this.gradeCondition.text = this.curCfg.condition + "解锁"; else if (this.curCfg.conditionType == u.SkinType.vedio) {
                            this.progressCondition.visible = !0, this.proTitle.text = this.curCfg.condition + "解锁";
                            var e = u.SkinManager.Instance.getSkinInfo(this.curCfg.id);
                            this.progress.value = e.cnt / this.curCfg.conditionCnt, this.proValue.text = e.cnt + "/" + this.curCfg.conditionCnt
                        }
                    }, e.prototype.onCenterBtn = function () {
                        u.SkinManager.Instance.curSkin != this.curCfg.id && (o.SoundtManager.Instance.playUIClick(), u.SkinManager.Instance.curSkin = this.curCfg.id, p.DEventManage.Instance.event(g.DEvent.SkinUsedChange, this.curCfg.id), this.list.refresh(), this.updateBottomView())
                    }, e.prototype.onTryBtn = function () {
                        o.SoundtManager.Instance.playUIClick(), this.curSharePos = h.ShareVideoPos.SkinTryAD, h.GameShaereManager.Instance.showVideoOrrShare(this.curSharePos)
                    }, e.prototype.onShowAdCompleted = function (e) {
                        if (e === this.curSharePos) {
                            if (this.curCfg.conditionType == u.SkinType.grade) u.SkinManager.Instance.setTempSkin(this.curCfg.id); else if (this.curCfg.conditionType == u.SkinType.vedio) {
                                var t = u.SkinManager.Instance.getSkinInfo(this.curCfg.id);
                                t.cnt += 1, u.SkinManager.Instance.setSkinInfo(this.curCfg.id, t), u.SkinManager.Instance.setTempSkin(this.curCfg.id), this.list.refresh(), this.updateBottomView()
                            }
                            this.curSharePos = h.ShareVideoPos.Unknow, l.GameMaanager.Instance.prepareStartGame(0)
                        }
                    }, e.prototype.onCloseShowAd = function (e) {
                        e === this.curSharePos && e === h.ShareVideoPos.SkinTryAD && i.DUIManager.Instance.showTips("完整看完视频才能试玩")
                    }, e
                }(a.ui.SkinViewUI);
            n.default = c
        }, {
            "../conslt/DEvent": 4,
            "../conslt/DIUIConfig": 5,
            "../core/managee/DEventManage": 12,
            "../core/managee/DUIManager": 13,
            "../core/managee/SoundtManager": 18,
            "../game/managre/DataManmager": 26,
            "../game/managre/GameMaanager": 27,
            "../game/managre/GameShaereManager": 28,
            "../game/managre/SkinManager": 29,
            "../ui/layaMaxUI": 46
        }],
        63: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../ui/layaMaxUI"), i = e("../game/managre/GameMaanager"), o = e("../core/managee/SoundtManager"),
                r = e("../core/managee/DUIManager"), s = e("../game/data/GameData"),
                l = e("../core/managee/DEventManage"), h = e("../conslt/DEvent"), c = e("../conslt/DIUIConfig"),
                d = e("../game/managre/AttributeManager"), u = function (e) {
                    function t() {
                        return null !== e && e.apply(this, arguments) || this
                    }

                    return __extends(t, e), t.prototype.init = function (e) {
                        this.regiestEvent(), this.initView()
                    }, t.prototype.uninit = function () {
                        this.unregiestEvent()
                    }, t.prototype.regiestEvent = function () {
                        this.startButton.on(Laya.Event.CLICK, this, this.onStartBtn), this.settingBtn.on(Laya.Event.CLICK, this, this.onSettingBtn), this.rankBtn.on(Laya.Event.CLICK, this, this.onRankBtn), this.skinBtn.on(Laya.Event.CLICK, this, this.onSkinBtn), l.DEventManage.Instance.on(h.DEvent.PlayerGoodsUpdate, this, this.updateCoin), l.DEventManage.Instance.on(h.DEvent.CupChange, this, this.updateGradeInfo)
                    }, t.prototype.unregiestEvent = function () {
                        this.startButton.off(Laya.Event.CLICK, this, this.onStartBtn), this.settingBtn.off(Laya.Event.CLICK, this, this.onSettingBtn), this.rankBtn.off(Laya.Event.CLICK, this, this.onRankBtn), this.skinBtn.off(Laya.Event.CLICK, this, this.onSkinBtn), l.DEventManage.Instance.off(h.DEvent.PlayerGoodsUpdate, this, this.updateCoin), l.DEventManage.Instance.off(h.DEvent.CupChange, this, this.updateGradeInfo)
                    }, t.prototype.initView = function () {
                        this.updateCoin(), this.updateGradeInfo(), this.speedAttr.init(d.AttributeType.speed), this.powerAttr.init(d.AttributeType.power), this.growupAttr.init(d.AttributeType.growup), this.heartAni.play(0, !0)
                    }, t.prototype.onStartBtn = function () {
                        o.SoundtManager.Instance.playUIClick(), i.GameMaanager.Instance.prepareStartGame(0)
                    }, t.prototype.onSettingBtn = function () {
                        o.SoundtManager.Instance.playUIClick(), r.DUIManager.Instance.createUI(c.DIUIConfig.Setting, null)
                    }, t.prototype.onRankBtn = function () {
                        o.SoundtManager.Instance.playUIClick(), r.DUIManager.Instance.showTips("敬请期待...", 1500)
                    }, t.prototype.onSkinBtn = function () {
                        o.SoundtManager.Instance.playUIClick(), r.DUIManager.Instance.createUI(c.DIUIConfig.Skin, null)
                    }, t.prototype.updateCoin = function () {
                        this.coin.text = s.GameData.Instance.gold
                    }, t.prototype.updateGradeInfo = function () {
                        this.gradeItem.showInfo(), this.gradeItem.hideGradeName(), this.gradeName.text = s.GameData.Instance.gradeCfg.name;
                        var e = s.GameData.Instance.gradeProgressInfo;
                        this.gradeNum.text = e.count + "/" + e.total
                    }, t
                }(a.ui.StartViewUI);
            n.default = u
        }, {
            "../conslt/DEvent": 4,
            "../conslt/DIUIConfig": 5,
            "../core/managee/DEventManage": 12,
            "../core/managee/DUIManager": 13,
            "../core/managee/SoundtManager": 18,
            "../game/data/GameData": 21,
            "../game/managre/AttributeManager": 24,
            "../game/managre/GameMaanager": 27,
            "../ui/layaMaxUI": 46
        }],
        64: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = function (e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }

                return __extends(t, e), t.prototype.updateLabel = function (e) {
                    this.label.text = "+ " + e, this.ani1.play(0, !1)
                }, t.prototype.onEnable = function () {
                    this.ani1.on(Laya.Event.COMPLETE, this, this.aniComplete)
                }, t.prototype.onDisable = function () {
                    this.ani1.stop(), this.ani1.off(Laya.Event.COMPLETE, this, this.aniComplete), Laya.Pool.recover("AddScoreLabel", this)
                }, t.prototype.aniComplete = function () {
                    this.parent && this.removeSelf()
                }, t.createLabel = function () {
                    return Laya.Pool.getItemByClass("AddScoreLabel", t)
                }, t
            }(e("../../ui/layaMaxUI").ui.item.AddScroeAniViewUI);
            n.default = a
        }, {"../../ui/layaMaxUI": 46}],
        65: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../ui/layaMaxUI"), i = e("../../game/managre/AttributeManager"),
                o = e("../../core/managee/SoundtManager"), r = e("../../core/managee/DUIManager"),
                s = e("../../game/data/GameData"), l = e("../../conslt/DSound"), h = e("../../conslt/DIUIConfig"),
                c = e("../../game/managre/GameShaereManager"), d = e("../../core/managee/DEventManage"),
                u = e("../../conslt/DEvent"), p = function (t) {
                    function e() {
                        var e = null !== t && t.apply(this, arguments) || this;
                        return e.type = i.AttributeType.speed, e.cfg = null, e.curSharePos = c.ShareVideoPos.Unknow, e
                    }

                    return __extends(e, t), e.prototype.onEnable = function () {
                        this.on(Laya.Event.CLICK, this, this.onBuyClick), d.DEventManage.Instance.on(u.DEvent.ShowAdCompleted, this, this.onShowAdCompleted), d.DEventManage.Instance.on(u.DEvent.CloseShowAd, this, this.onCloseShowAd)
                    }, e.prototype.onDisable = function () {
                        this.off(Laya.Event.CLICK, this, this.onBuyClick), d.DEventManage.Instance.off(u.DEvent.ShowAdCompleted, this, this.onShowAdCompleted), d.DEventManage.Instance.off(u.DEvent.CloseShowAd, this, this.onCloseShowAd)
                    }, e.prototype.init = function (e) {
                        this.type = e, this.updateView()
                    }, e.prototype.updateView = function () {
                        this.cfg = i.AttributeManager.Instance.getAttributeCfg(this.type), this.attrName.text = this.cfg.attrName, this.attrValue.text = this.cfg.attrValue, this.cfg.isMax ? (this.vedioBg.stop(), this.vedioBg.visible = !1, this.bg.stop(), this.bg.visible = !0, this.attrName.color = "#319670", this.attrValue.color = "#319670", this.coinNum.text = "Max", this.coinNum.visible = !0) : this.cfg.showVideo ? (this.vedioBg.play(0, !0), this.vedioBg.visible = !0, this.bg.stop(), this.bg.visible = !1, this.attrName.color = "#b56910", this.attrValue.color = "#b56910", this.coinNum.text = "", this.coinNum.visible = !1) : (this.vedioBg.stop(), this.vedioBg.visible = !1, this.bg.play(0, !0), this.bg.visible = !0, this.attrName.color = "#319670", this.attrValue.color = "#319670", this.coinNum.text = "" + this.cfg.buyCoin, this.coinNum.visible = !0)
                    }, e.prototype.onBuyClick = function () {
                        (o.SoundtManager.Instance.playUIClick(), this.cfg.isMax) ? r.DUIManager.Instance.showTips("已经升级到最大等级了!", 1500) : this.cfg.showVideo ? (this.curSharePos = c.ShareVideoPos.AttributeAD, c.GameShaereManager.Instance.showVideoOrrShare(this.curSharePos)) : s.GameData.Instance.gold >= this.cfg.buyCoin ? (s.GameData.Instance.updateWithChangeData({gold: -this.cfg.buyCoin}), this.doAttrUpdate()) : r.DUIManager.Instance.createUI(h.DIUIConfig.GetMoney, null)
                    }, e.prototype.doAttrUpdate = function (e) {
                        void 0 === e && (e = !1), r.DUIManager.Instance.showTips("升级成功!", 1500), o.SoundtManager.Instance.playSound(l.DSound.AttrUpdate), i.AttributeManager.Instance.addAttributeCfg(this.type, e), this.updateView()
                    }, e.prototype.onShowAdCompleted = function (e) {
                        e === this.curSharePos && this.doAttrUpdate(!0)
                    }, e.prototype.onCloseShowAd = function (e) {
                        e === this.curSharePos && e === c.ShareVideoPos.AttributeAD && r.DUIManager.Instance.showTips("完整看完视频才能升级属性")
                    }, e
                }(a.ui.item.AttributeItemUI);
            n.default = p
        }, {
            "../../conslt/DEvent": 4,
            "../../conslt/DIUIConfig": 5,
            "../../conslt/DSound": 7,
            "../../core/managee/DEventManage": 12,
            "../../core/managee/DUIManager": 13,
            "../../core/managee/SoundtManager": 18,
            "../../game/data/GameData": 21,
            "../../game/managre/AttributeManager": 24,
            "../../game/managre/GameShaereManager": 28,
            "../../ui/layaMaxUI": 46
        }],
        66: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a, i, o = e("../../ui/layaMaxUI");
            (i = a = n.BroadcastViewType || (n.BroadcastViewType = {}))[i.Unknow = 0] = "Unknow", i[i.Kill = 1] = "Kill", i[i.FirstBlood = 2] = "FirstBlood", i[i.Upgrage = 3] = "Upgrage", i[i.Image = 4] = "Image";
            var r = function (e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }

                return __extends(t, e), t.prototype.showBroadCastView = function (e) {
                    if (e) switch (this.hideBroadCastView(), this.bgImageView.visible = e.showBg, e.viewType) {
                        case a.Kill:
                            this.killBox.visible = !0, this.killerAvatarImageView.skin = e.killerAvatar || "common/default_avatar.png", this.killedAvatarImageView.skin = e.killedAvatar || "common/default_avatar.png";
                            break;
                        case a.FirstBlood:
                            this.firstBloodBox.visible = !0, this.firstBloodNickNameLabel.text = "" + (e.nickName || "");
                            break;
                        case a.Upgrage:
                            this.upgradeBox.visible = !0, this.upgradeLevelLabel.text = "" + (e.level || "");
                            break;
                        case a.Image:
                            this.imageBox.visible = !0, this.broadcastImageView.skin = e.imageUrl || "", this.imageAni.play(0, !1)
                    }
                }, t.prototype.hideBroadCastView = function () {
                    this.killBox.visible = !1, this.upgradeBox.visible = !1, this.firstBloodBox.visible = !1, this.imageBox.visible = !1
                }, t
            }(o.ui.item.BroadcastViewUI);
            n.default = r
        }, {"../../ui/layaMaxUI": 46}],
        67: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var o = e("../../game/managre/SkinManager"), a = e("../../core/managee/DEventManage"),
                i = e("../../conslt/DEvent"), r = function (t) {
                    function e() {
                        var e = t.call(this) || this;
                        return e.onSelect = !1, e.gameScene = null, e.dinsSprite = null, e.skinID = -1, e
                    }

                    return __extends(e, t), e.prototype.onEnable = function () {
                        this.initScene(), this.regiestEvent()
                    }, e.prototype.onDisable = function () {
                        this.dinsSprite && (this.dinsSprite.destroy(), this.dinsSprite = null), this.gameScene && (this.gameScene.destroy(!0), this.gameScene = null), this.unregiestEvent(), Laya.timer.clearAll(this)
                    }, e.prototype.regiestEvent = function () {
                        this.onSelect && a.DEventManage.Instance.on(i.DEvent.SkinShowChange, this, this.changeSkin), a.DEventManage.Instance.on(i.DEvent.SkinUsedChange, this, this.changeSkin)
                    }, e.prototype.unregiestEvent = function () {
                        a.DEventManage.Instance.off(i.DEvent.SkinShowChange, this, this.changeSkin), a.DEventManage.Instance.off(i.DEvent.SkinUsedChange, this, this.changeSkin)
                    }, e.prototype.initScene = function () {
                        var i = this;
                        this.gameScene = new Laya.Scene3D, this.owner && this.owner.addChild(this.gameScene), Laya.Sprite3D.load("res/scene/T-Rex.lh", Laya.Handler.create(this, function (e) {
                            if (!i.destroyed) {
                                i.dinsSprite = Laya.Sprite3D.instantiate(e), i.dinsSprite.transform.scale = new Laya.Vector3(.08, .08, .08), i.dinsSprite.transform.rotate(new Laya.Vector3(0, -45, 0), !0, !1), i.dinsSprite.transform.position = new Laya.Vector3(.1, 0, 0), i.gameScene.addChild(i.dinsSprite);
                                var t = new Laya.Camera(0, .1, 1e3);
                                i.gameScene.addChild(t), t.transform.rotate(new Laya.Vector3(0, 0, 0), !0, !1), t.transform.position = new Laya.Vector3(0, 0, 1), t.clearFlag = Laya.BaseCamera.CLEARFLAG_DEPTHONLY;
                                var n = new Laya.DirectionLight;
                                n.color = new Laya.Vector3(1, .9568627, .8392157), n.transform.localPosition = new Laya.Vector3(-9.8, 2.25, 4.63), n.intensity = .8, n.transform.rotate(new Laya.Vector3(0, 0, 0), !0, !1), n.shadow = !1, i.gameScene.addChild(n), i.startPlayAni();
                                var a = o.SkinManager.Instance.curSkin;
                                i.changeSkin(a.id)
                            }
                        }))
                    }, e.prototype.startPlayAni = function () {
                        if (this.dinsSprite) {
                            var e = this.dinsSprite.getComponent(Laya.Animator);
                            e && e.crossFade("idel", .2, 0), Laya.timer.once(5e3, this, this.startPlayAttackAni)
                        }
                    }, e.prototype.startPlayAttackAni = function () {
                        if (this.dinsSprite) {
                            var e = this.dinsSprite.getComponent(Laya.Animator);
                            e && e.crossFade("attack", .2, 0), Laya.timer.once(1500, this, this.startPlayAni)
                        }
                    }, e.prototype.changeSkin = function (e) {
                        if (this.skinID !== e && 0 < (this.skinID = e) && this.dinsSprite) {
                            var t = this.dinsSprite.getChildAt(0);
                            if (t.skinnedMeshRenderer) {
                                var n = new Laya.BlinnPhongMaterial;
                                n.specularColor = new Laya.Vector4(0, 0, 0, 1), n.renderMode = Laya.BlinnPhongMaterial.RENDERMODE_CUTOUT, n.enableLighting = !0, n.albedoIntensity = 1, n.shininess = 1, n.albedoTexture = Laya.loader.getRes("dins/T-Rex_" + (e || 1) + ".jpg"), t.skinnedMeshRenderer.material = n
                            }
                        }
                    }, e
                }(Laya.Script);
            n.default = r
        }, {"../../conslt/DEvent": 4, "../../core/managee/DEventManage": 12, "../../game/managre/SkinManager": 29}],
        68: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../ui/layaMaxUI"), i = e("../../game/utils/GameUtils"), o = function (e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }

                return __extends(t, e), t.prototype.updateItem = function (e) {
                    this.nameLabel.changeText(i.GameUtils.subString(e.nickName, 10, !0)), e.index < 3 ? (this.rankImage.visible = !0, this.numLabel.visible = !1, 0 === e.index ? (this.rankImage.skin = "game/leadboard_No1.png", this.nameLabel.color = "#FFDC00") : 1 === e.index ? (this.rankImage.skin = "game/leadboard_No2.png", this.nameLabel.color = "#FF82C2") : 2 === e.index && (this.rankImage.skin = "game/leadboard_No3.png", this.nameLabel.color = "#D85EFF")) : (this.rankImage.visible = !1, this.numLabel.visible = !0, this.nameLabel.color = "#FFFFFF", this.numLabel.changeText("" + (e.index + 1))), this.scoreLabel.changeText("" + e.score)
                }, t
            }(a.ui.item.GameRankListItemUI);
            n.default = o
        }, {"../../game/utils/GameUtils": 39, "../../ui/layaMaxUI": 46}],
        69: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../ui/layaMaxUI"), i = e("../../game/utils/GameUtils"), o = function (e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }

                return __extends(t, e), t.prototype.updateUserName = function (e, t) {
                    void 0 === t && (t = null), this.nickNameLabel.text = i.GameUtils.subString(e, 18, !0), t && 0 < t.length ? (this.avatar.skin = t, this.avatar.visible = !0, this.nickNameLabel.color = "#FFDC00", this.levelLabel.color = "#FFDC00") : (this.avatar.visible = !1, this.nickNameLabel.color = "#FFFFFF", this.levelLabel.color = "#FFFFFF")
                }, t.prototype.updateLevel = function (e, t) {
                    this.levelLabel.text = e + "级"
                }, t.prototype.showLevelInfo = function (e) {
                }, t
            }(a.ui.item.GameUserInfoViewUI);
            n.default = o
        }, {"../../game/utils/GameUtils": 39, "../../ui/layaMaxUI": 46}],
        70: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../ui/layaMaxUI"), i = e("../../game/data/GameData"),
                o = e("../../core/managee/DEventManage"), r = e("../../conslt/DEvent"), s = function (t) {
                    function e() {
                        var e = t.call(this) || this;
                        return e.cfg = null, e.newCfg = null, e.timeLineArr = [], e
                    }

                    return __extends(e, t), e.prototype.showInfo = function () {
                        this.cfg = i.GameData.Instance.gradeCfg, this.updateView(this.cfg)
                    }, e.prototype.addCup = function (e) {
                        return i.GameData.Instance.cup += e, this.newCfg = i.GameData.Instance.gradeCfg, o.DEventManage.Instance.event(r.DEvent.CupChange), this.newCfg.id > this.cfg.id
                    }, e.prototype.updateView = function (e) {
                        this.gradeName.text = e.name, this.img.skin = e.icon;
                        for (var t = 0; t < 5; t++) this["star" + t].skin = t < e.star ? "grade/grade_star.png" : "grade/grade_star_empty.png"
                    }, e.prototype.hideGradeName = function () {
                        this.gradeName.visible = !1
                    }, e.prototype.doAnimate = function () {
                        this.newCfg.id > this.cfg.id && (this.updateView(this.newCfg), this.showUpdateAnimate())
                    }, e.prototype.showUpdateAnimate = function () {
                        if (0 == this.newCfg.star) {
                            (e = new Laya.TimeLine).to(this.img, {
                                scaleX: .5,
                                scaleY: .5
                            }, 300, null).to(this.img, {scaleX: 1.2, scaleY: 1.2}, 500, null).to(this.img, {
                                scaleX: 1,
                                scaleY: 1
                            }, 200, null).play(0, !1), this.timeLineArr.push(e)
                        } else {
                            var e, t = this["star" + (this.newCfg.star - 1)];
                            t.skin = "grade/grade_star.png", (e = new Laya.TimeLine).to(t, {
                                scaleX: .3,
                                scaleY: .3
                            }, 200, null).to(t, {scaleX: 1, scaleY: 1}, 300, null).to(t, {
                                scaleX: 1.2,
                                scaleY: 1.2
                            }, 200, null).to(t, {scaleX: 1, scaleY: 1}, 300, null).play(0, !1), this.timeLineArr.push(e)
                        }
                    }, e.prototype.clearAnimate = function () {
                        for (var e = 0; e < this.timeLineArr.length; e++) {
                            var t = this.timeLineArr[e];
                            t && t.destroy()
                        }
                    }, e
                }(a.ui.item.GradeItemUI);
            n.default = s
        }, {
            "../../conslt/DEvent": 4,
            "../../core/managee/DEventManage": 12,
            "../../game/data/GameData": 21,
            "../../ui/layaMaxUI": 46
        }],
        71: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var a = e("../../ui/layaMaxUI"), i = e("../../utils/StringUtil"), o = function () {
                this.avatar = "", this.time = 0
            };
            n.MatchPlayItem = o;
            var r = function (e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }

                return __extends(t, e), t.prototype.updateItem = function (e) {
                    var t = this;
                    this.loadingAni.play(), this.loadingAni.visible = !0, this.avatarView.skin = i.StringUtils.getAvatarUrl(e.avatar), this.avatarView.visible = !1, Laya.timer.once(e.time, this, function () {
                        t.loadingAni.stop(), t.loadingAni.visible = !1, t.avatarView.visible = !0
                    })
                }, t.prototype.onDisable = function () {
                    Laya.timer.clearAll(this)
                }, t
            }(a.ui.item.MatchPlayerItemViewUI);
            n.default = r
        }, {"../../ui/layaMaxUI": 46, "../../utils/StringUtil": 50}],
        72: [function (e, t, n) {
            "use strict";
            Object.defineProperty(n, "__esModule", {value: !0});
            var i = e("../../core/managee/DUIManager"), a = function (t) {
                function e() {
                    var e = t.call(this) || this;
                    return e.uiname = "", e.uiname = null, Laya.timer.once(20, e, e.adapter), e
                }

                return __extends(e, t), e.getBangSafeOffX = function () {
                    return Laya.stage.width / Laya.stage.height < 2 ? 0 : 132 / 2436 * Laya.stage.width
                }, e.prototype.adapter = function () {
                    if ("scale" === this.name) {
                        var e = Laya.stage.width / Laya.stage.designWidth,
                            t = Laya.stage.height / Laya.stage.designHeight, n = t < e ? e : t;
                        return this.scaleX = n, this.scaleY = n, this.uiname = this.parent.uiname, void i.DUIManager.Instance.addAdapter(this)
                    }
                    Laya.stage.designHeight, Laya.stage.designWidth;
                    if (!(Laya.stage.height / Laya.stage.width < 2)) {
                        var a = 132 / 2436 * Laya.stage.height;
                        isNaN(this.top) || (this.top = a + this.top)
                    }
                }, e
            }(Laya.Box);
            n.default = a
        }, {"../../core/managee/DUIManager": 13}]
    }, {}, [3]);
});
define("libs/ald-game-conf.js", function (require, module, exports) {
    exports.app_key = "594fdd0d95492f4d04deb2200f7be056", exports.getLocation = !1;
});
define("libs/ald-game.js", function (require, module, exports) {
    !function () {
        function i(e) {
            var n = {};
            return "Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function (e, t) {
                n["[object " + e + "]"] = e.toLowerCase()
            }), null == e ? e : "object" == typeof e || "function" == typeof e ? n[function (e) {
                return Object.prototype.toString.call(e)
            }.call(e)] || "object" : typeof e
        }

        function o(n, e) {
            g++, n.as = w, n.at = v, n.rq_c = g, n.ifo = r, n.ak = s.app_key, n.uu = c, n.v = t, n.st = Date.now(), n.ev = e, n.wsr = p, "" !== function (e) {
                if (void 0 === e || "" === e) return "";
                var t = {};
                for (var n in e) "rawData" != n && "errMsg" != n && (t[n] = e[n]);
                return t
            }(n.ufo) && (n.ufo = n.ufo), n.ec = h, wx.Queue.push(function () {
                return new Promise(function (t, e) {
                    wx.request({
                        url: "https://" + a + ".aldwx.com/d.html",
                        data: n,
                        header: {se: f || "", op: l || "", img: S || ""},
                        method: "GET",
                        fail: function () {
                            t("")
                        },
                        success: function (e) {
                            t(200 == e.statusCode ? "" : "status error")
                        }
                    })
                })
            })
        }

        function u(e) {
            var t = {};
            for (var n in e) t[n] = e[n];
            return t
        }

        function n(e) {
            for (var t = "", n = 0; n < e.length; n++) e[n].length > t.length && (t = e[n]);
            return t
        }

        var t = "2.0.0", a = "glog", s = require("./ald-game-conf");
        s.app_key, s.app_key = s.app_key.replace(/\s/g, ""), wx.request({
            url: "https://" + a + ".aldwx.com/config/app.json",
            method: "GET",
            success: function (e) {
                200 === e.statusCode && (e.data.version, e.data.warn, e.data.error)
            }
        });
        var r = "", c = function () {
                var t = "";
                try {
                    t = wx.getStorageSync("aldstat_uuid"), wx.setStorageSync("ald_ifo", !0)
                } catch (e) {
                    t = "uuid_getstoragesync"
                }
                if (t) r = !1; else {
                    t = function () {
                        function e() {
                            return Math.floor(65536 * (1 + Math.random())).toString(16).substring(1)
                        }

                        return e() + e() + e() + e() + e() + e() + e() + e()
                    }(), r = !0;
                    try {
                        wx.setStorageSync("aldstat_uuid", t)
                    } catch (t) {
                        wx.setStorageSync("aldstat_uuid", "uuid_getstoragesync")
                    }
                }
                return t
            }(), d = {}, f = "", l = "", h = 0, g = "", p = wx.getLaunchOptionsSync(), m = Date.now(),
            v = "" + Date.now() + Math.floor(1e7 * Math.random()),
            w = "" + Date.now() + Math.floor(1e7 * Math.random()), _ = 0, y = "", S = "", x = !0, q = !1,
            e = ["aldSendEvent", "aldOnShareAppMessage", "aldShareAppMessage", "aldSendSession", "aldSendOpenid", "aldLevelEvent"],
            I = ["payStart", "paySuccess", "payFail", "die", "revive", "tools", "award"], b = ["complete", "fail"];
        void 0 === wx.Queue && (wx.Queue = new function () {
            this.concurrency = 4, this.queue = [], this.tasks = [], this.activeCount = 0;
            var s = this;
            this.push = function (a) {
                this.tasks.push(new Promise(function (t, e) {
                    var n = function () {
                        s.activeCount++, a().then(function (e) {
                            t(e)
                        }).then(function () {
                            s.next()
                        })
                    };
                    s.activeCount < s.concurrency ? n() : s.queue.push(n)
                }))
            }, this.all = function () {
                return Promise.all(this.tasks)
            }, this.next = function () {
                s.activeCount--, 0 < s.queue.length && s.queue.shift()()
            }
        }, wx.Queue.all()), Promise.all([new Promise(function (t, e) {
            wx.getSetting({
                success: function (e) {
                    e.authSetting["scope.userInfo"] ? wx.getUserInfo({
                        success: function (e) {
                            S = n(e.userInfo.avatarUrl.split("/")), t(e)
                        }, fail: function () {
                            t("")
                        }
                    }) : t("")
                }, fail: function () {
                    t("")
                }
            })
        }), new Promise(function (t, e) {
            wx.getNetworkType({
                success: function (e) {
                    t(e)
                }, fail: function () {
                    t("")
                }
            })
        }), new Promise(function (t, e) {
            s.getLocation ? wx.getLocation({
                success: function (e) {
                    t(e)
                }, fail: function () {
                    t("")
                }
            }) : wx.getSetting({
                success: function (e) {
                    e.authSetting["scope.userLocation"] && wx.getLocation({
                        success: function (e) {
                            t(e)
                        }, fail: function () {
                            t("")
                        }
                    }), t("")
                }, fail: function () {
                    t("")
                }
            })
        })]).then(function (e) {
            "" !== e[2] ? (d.lat = e[2].latitude || "", d.lng = e[2].longitude || "", d.spd = e[2].speed || "") : (d.lat = "", d.lng = "", d.spd = ""), "" !== e[1] ? d.nt = e[1].networkType || "" : d.nt = "";
            var t = u(d);
            "" !== e[0] && (t.ufo = e[0], y = e[0]), o(t, "init")
        }), wx.onShow(function (e) {
            if (p = e, _ = Date.now(), !x && !q) {
                v = "" + Date.now() + Math.floor(1e7 * Math.random()), r = !1;
                try {
                    wx.setStorageSync("ald_ifo", !1)
                } catch (e) {
                }
            }
            q = x = !1;
            var t = u(d), n = u(d);
            t.sm = _ - m, e.query.ald_share_src && e.shareTicket && "1044" === e.scene ? (n.tp = "ald_share_click", new Promise(function (t, e) {
                "1044" == p.scene ? wx.getShareInfo({
                    shareTicket: p.shareTicket, success: function (e) {
                        t(e)
                    }, fail: function () {
                        t("")
                    }
                }) : t("")
            }).then(function (e) {
                n.ct = e, o(n, "event")
            })) : e.query.ald_share_src && (n.tp = "ald_share_click", n.ct = "1", o(n, "event")), o(t, "show")
        }), wx.onHide(function () {
            var t = u(d);
            t.dr = Date.now() - _, "" === y ? wx.getSetting({
                success: function (e) {
                    e.authSetting["scope.userInfo"] ? wx.getUserInfo({
                        success: function (e) {
                            t.ufo = e, S = n((y = e).userInfo.avatarUrl.split("/")), o(t, "hide")
                        }
                    }) : o(t, "hide")
                }
            }) : o(t, "hide")
        }), wx.onError(function (e) {
            var t = u(d);
            t.tp = "ald_error_message", t.ct = e, h++, o(t, "event")
        });
        var M, k, O = {
            aldSendEvent: function (e, t) {
                var n = u(d);
                "" !== e && "string" == typeof e && e.length <= 255 && (n.tp = e, "string" == typeof t && t.length <= 255 ? (n.ct = String(t), o(n, "event")) : "object" == typeof t ? (JSON.stringify(t).length, n.ct = JSON.stringify(t), o(n, "event")) : (void 0 === t || "" === t) && o(n, "event"))
            }, aldOnShareAppMessage: function (a) {
                wx.onShareAppMessage(function () {
                    q = !0;
                    var e = a(), t = "";
                    t = void 0 !== p.query.ald_share_src ? void 0 !== e.query ? (p.query.ald_share_src.indexOf(c), e.query + "&ald_share_src=" + p.query.ald_share_src + "," + c) : (p.query.ald_share_src.indexOf(c), "ald_share_src=" + p.query.ald_share_src + "," + c) : void 0 !== e.query ? e.query + "&ald_share_src=" + c : "ald_share_src=" + c, "undefined" != i(e.ald_desc) && (t += "&ald_desc=" + e.ald_desc), e.query = t;
                    var n = u(d);
                    return n.ct = e, n.ct.sho = 1, n.tp = "ald_share_chain", o(n, "event"), e
                })
            }, aldShareAppMessage: function (e) {
                q = !0;
                var t = e, n = "";
                n = void 0 !== p.query.ald_share_src ? void 0 !== t.query ? (p.query.ald_share_src.indexOf(c), t.query + "&ald_share_src=" + p.query.ald_share_src + "," + c) : (p.query.ald_share_src.indexOf(c), "ald_share_src=" + p.query.ald_share_src + "," + c) : void 0 !== t.query ? t.query + "&ald_share_src=" + c : "ald_share_src=" + c;
                var a = u(d);
                "undefined" != i(t.ald_desc) && (n += "&ald_desc=" + t.ald_desc), t.query = n, a.ct = t, a.tp = "ald_share_chain", o(a, "event"), wx.shareAppMessage(t)
            }, aldSendSession: function (e) {
                if ("" !== e && e) {
                    var t = u(d);
                    t.tp = "session", t.ct = "session", f = e, "" === y ? wx.getSetting({
                        success: function (e) {
                            e.authSetting["scope.userInfo"] ? wx.getUserInfo({
                                success: function (e) {
                                    t.ufo = e, o(t, "event")
                                }
                            }) : o(t, "event")
                        }
                    }) : ("" !== (t.ufo = y) && (t.gid = ""), o(t, "event"))
                }
            }, aldSendOpenid: function (e) {
                if ("" !== e && e) {
                    l = e;
                    var t = u(d);
                    t.tp = "openid", t.ct = "openid", o(t, "event")
                }
            }
        };
        wx.aldStage = new function () {
            function n(e) {
                return !(!/^\d+(.\d+)*$/.test(e.stageId) || 32 < e.stageId.length || "string" !== i(e.stageName) || 32 < e.stageName.length)
            }

            var a = "", s = "", r = 0;
            this.onStart = function (e) {
                if (n(e)) {
                    var t = {};
                    r = Date.now(), t.sid = e.stageId, t.snm = e.stageName, t.state = "start", s = "" + Date.now() + Math.floor(1e7 * Math.random()), a = t, ("string" === i(e.userId) && e.userId) < 32 && (this.uid = e.uid), this.request()
                }
            }, this.onRunning = function (e) {
                if (n(e)) {
                    var t = {params: {}};
                    if (("string" === i(e.userId) && e.userId) < 32 && (this.uid = e.uid), !i(e.event) && -1 != I.join(",").indexOf(e.event + ",")) return void I.join(",");
                    if (t.event = e.event, "object" === i(e.params)) {
                        if ("string" !== i(e.params.itemName) || 32 < e.params.itemName.length) return;
                        t.params.itnm = e.params.itemName, "string" === i(e.params.itemId) && e.params.itemId.length < 32 && (t.params.itid = e.params.itemId), "number" === i(e.params.itemCount) && e.params.itemCount.length < 32 ? t.params.itco = e.params.itemCount : t.params.itco = 1, -1 !== e.event.indexOf("pay") && ("number" === i(e.params.itemMoney) && e.params.itemMoney.length < 32 ? t.params.money = e.params.itemMoney : t.params.money = 0), "string" === i(e.params.desc) && e.params.desc.length < 64 && (t.params.desc = e.params.desc), t.state = "running", t.sid = e.stageId, t.snm = e.stageName, a = t, this.request()
                    }
                }
            }, this.onEnd = function (e) {
                if (n(e)) {
                    var t = {state: "end"};
                    if (("string" === i(e.userId) && e.userId) < 32 && (this.uid = e.uid), !i(e.event) && -1 !== b.join(",").indexOf(e.event + ",")) return void b.join(",");
                    t.sid = e.stageId, t.snm = e.stageName, t.event = e.event, t.sdr = 0 !== r ? Date.now() - r : "", t.params = {}, "object" === i(e.params) && "string" === i(e.params.desc) && e.params.desc.length < 64 && (t.params.desc = e.params.desc), a = t, this.request()
                }
            }, this.request = function () {
                var e = u(d);
                a.ss = s, e.ct = a, o(e, "screen")
            }
        };
        for (var j = 0; j < e.length; j++) k = O[M = e[j]], Object.defineProperty(wx, M, {
            value: k,
            writable: !1,
            enumerable: !0,
            configurable: !0
        });
        try {
            var D = wx.getSystemInfoSync();
            d.br = D.brand || "", d.md = D.model, d.pr = D.pixelRatio, d.sw = D.screenWidth, d.sh = D.screenHeight, d.ww = D.windowWidth, d.wh = D.windowHeight, d.lang = D.language, d.wv = D.version, d.sv = D.system, d.wvv = D.platform, d.fs = D.fontSizeSetting, d.wsdk = D.SDKVersion, d.bh = D.benchmarkLevel || "", d.bt = D.battery || "", d.wf = D.wifiSignal || "", d.lng = "", d.lat = "", d.nt = "", d.spd = "", d.ufo = ""
        } catch (e) {
        }
    }();
});
define("libs/bytebuffer.js", function (require, module, exports) {
    !function (t, e) {
        "function" == typeof define && define.amd ? define(["long"], e) : "function" == typeof require && "object" == typeof module && module && module.exports ? module.exports = function () {
            var t;
            try {
                t = require("long")
            } catch (t) {
            }
            return e(t)
        }() : (t.dcodeIO = t.dcodeIO || {}).ByteBuffer = e(t.dcodeIO.Long)
    }(this, function (h) {
        "use strict";
        var b = function (t, e, r) {
            if (void 0 === t && (t = b.DEFAULT_CAPACITY), void 0 === e && (e = b.DEFAULT_ENDIAN), void 0 === r && (r = b.DEFAULT_NOASSERT), !r) {
                if ((t |= 0) < 0) throw RangeError("Illegal capacity");
                e = !!e, r = !!r
            }
            this.buffer = 0 === t ? f : new ArrayBuffer(t), this.view = 0 === t ? null : new Uint8Array(this.buffer), this.offset = 0, this.markedOffset = -1, this.limit = t, this.littleEndian = e, this.noAssert = r
        };
        b.VERSION = "5.0.1", b.LITTLE_ENDIAN = !0, b.BIG_ENDIAN = !1, b.DEFAULT_CAPACITY = 16, b.DEFAULT_ENDIAN = b.BIG_ENDIAN, b.DEFAULT_NOASSERT = !1, b.Long = h || null;
        var o = b.prototype;
        o.__isByteBuffer__, Object.defineProperty(o, "__isByteBuffer__", {value: !0, enumerable: !1, configurable: !1});
        var f = new ArrayBuffer(0), r = String.fromCharCode;

        function s(t) {
            var e = 0;
            return function () {
                return e < t.length ? t.charCodeAt(e++) : null
            }
        }

        function a() {
            var t = [], e = [];
            return function () {
                if (0 === arguments.length) return e.join("") + r.apply(String, t);
                1024 < t.length + arguments.length && (e.push(r.apply(String, t)), t.length = 0), Array.prototype.push.apply(t, arguments)
            }
        }

        function i(t, e, r, i, n) {
            var f, o, s = 8 * n - i - 1, h = (1 << s) - 1, a = h >> 1, l = -7, u = r ? n - 1 : 0, g = r ? -1 : 1,
                w = t[e + u];
            for (u += g, f = w & (1 << -l) - 1, w >>= -l, l += s; 0 < l; f = 256 * f + t[e + u], u += g, l -= 8) ;
            for (o = f & (1 << -l) - 1, f >>= -l, l += i; 0 < l; o = 256 * o + t[e + u], u += g, l -= 8) ;
            if (0 === f) f = 1 - a; else {
                if (f === h) return o ? NaN : 1 / 0 * (w ? -1 : 1);
                o += Math.pow(2, i), f -= a
            }
            return (w ? -1 : 1) * o * Math.pow(2, f - i)
        }

        function n(t, e, r, i, n, f) {
            var o, s, h, a = 8 * f - n - 1, l = (1 << a) - 1, u = l >> 1,
                g = 23 === n ? Math.pow(2, -24) - Math.pow(2, -77) : 0, w = i ? 0 : f - 1, b = i ? 1 : -1,
                v = e < 0 || 0 === e && 1 / e < 0 ? 1 : 0;
            for (e = Math.abs(e), isNaN(e) || e === 1 / 0 ? (s = isNaN(e) ? 1 : 0, o = l) : (o = Math.floor(Math.log(e) / Math.LN2), e * (h = Math.pow(2, -o)) < 1 && (o--, h *= 2), 2 <= (e += 1 <= o + u ? g / h : g * Math.pow(2, 1 - u)) * h && (o++, h /= 2), l <= o + u ? (s = 0, o = l) : 1 <= o + u ? (s = (e * h - 1) * Math.pow(2, n), o += u) : (s = e * Math.pow(2, u - 1) * Math.pow(2, n), o = 0)); 8 <= n; t[r + w] = 255 & s, w += b, s /= 256, n -= 8) ;
            for (o = o << n | s, a += n; 0 < a; t[r + w] = 255 & o, w += b, o /= 256, a -= 8) ;
            t[r + w - b] |= 128 * v
        }

        b.accessor = function () {
            return Uint8Array
        }, b.allocate = function (t, e, r) {
            return new b(t, e, r)
        }, b.concat = function (t, e, r, i) {
            "boolean" != typeof e && "string" == typeof e || (i = r, r = e, e = void 0);
            for (var n, f = 0, o = 0, s = t.length; o < s; ++o) b.isByteBuffer(t[o]) || (t[o] = b.wrap(t[o], e)), 0 < (n = t[o].limit - t[o].offset) && (f += n);
            if (0 === f) return new b(0, r, i);
            var h, a = new b(f, r, i);
            for (o = 0; o < s;) (n = (h = t[o++]).limit - h.offset) <= 0 || (a.view.set(h.view.subarray(h.offset, h.limit), a.offset), a.offset += n);
            return a.limit = a.offset, a.offset = 0, a
        }, b.isByteBuffer = function (t) {
            return !0 === (t && t.__isByteBuffer__)
        }, b.type = function () {
            return ArrayBuffer
        }, b.wrap = function (t, e, r, i) {
            if ("string" != typeof e && (i = r, r = e, e = void 0), "string" == typeof t) switch (void 0 === e && (e = "utf8"), e) {
                case"base64":
                    return b.fromBase64(t, r);
                case"hex":
                    return b.fromHex(t, r);
                case"binary":
                    return b.fromBinary(t, r);
                case"utf8":
                    return b.fromUTF8(t, r);
                case"debug":
                    return b.fromDebug(t, r);
                default:
                    throw Error("Unsupported encoding: " + e)
            }
            if (null === t || "object" != typeof t) throw TypeError("Illegal buffer");
            var n;
            if (b.isByteBuffer(t)) return (n = o.clone.call(t)).markedOffset = -1, n;
            if (t instanceof Uint8Array) n = new b(0, r, i), 0 < t.length && (n.buffer = t.buffer, n.offset = t.byteOffset, n.limit = t.byteOffset + t.byteLength, n.view = new Uint8Array(t.buffer)); else if (t instanceof ArrayBuffer) n = new b(0, r, i), 0 < t.byteLength && (n.buffer = t, n.offset = 0, n.limit = t.byteLength, n.view = 0 < t.byteLength ? new Uint8Array(t) : null); else {
                if ("[object Array]" !== Object.prototype.toString.call(t)) throw TypeError("Illegal buffer");
                (n = new b(t.length, r, i)).limit = t.length;
                for (var f = 0; f < t.length; ++f) n.view[f] = t[f]
            }
            return n
        }, o.writeBitSet = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if (!(t instanceof Array)) throw TypeError("Illegal BitSet: Not an array");
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            var i, n = e, f = t.length, o = f >> 3, s = 0;
            for (e += this.writeVarint32(f, e); o--;) i = 1 & !!t[s++] | (1 & !!t[s++]) << 1 | (1 & !!t[s++]) << 2 | (1 & !!t[s++]) << 3 | (1 & !!t[s++]) << 4 | (1 & !!t[s++]) << 5 | (1 & !!t[s++]) << 6 | (1 & !!t[s++]) << 7, this.writeByte(i, e++);
            if (s < f) {
                var h = 0;
                for (i = 0; s < f;) i |= (1 & !!t[s++]) << h++;
                this.writeByte(i, e++)
            }
            return r ? (this.offset = e, this) : e - n
        }, o.readBitSet = function (t) {
            var e = void 0 === t;
            e && (t = this.offset);
            var r, i = this.readVarint32(t), n = i.value, f = n >> 3, o = 0, s = [];
            for (t += i.length; f--;) r = this.readByte(t++), s[o++] = !!(1 & r), s[o++] = !!(2 & r), s[o++] = !!(4 & r), s[o++] = !!(8 & r), s[o++] = !!(16 & r), s[o++] = !!(32 & r), s[o++] = !!(64 & r), s[o++] = !!(128 & r);
            if (o < n) {
                var h = 0;
                for (r = this.readByte(t++); o < n;) s[o++] = !!(r >> h++ & 1)
            }
            return e && (this.offset = t), s
        }, o.readBytes = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + t > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+" + t + ") <= " + this.buffer.byteLength)
            }
            var i = this.slice(e, e + t);
            return r && (this.offset += t), i
        }, o.writeBytes = o.append, o.writeInt8 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal value: " + t + " (not an integer)");
                if (t |= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            e += 1;
            var i = this.buffer.byteLength;
            return i < e && this.resize((i *= 2) > e ? i : e), e -= 1, this.view[e] = t, r && (this.offset += 1), this
        }, o.writeByte = o.writeInt8, o.readInt8 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+1) <= " + this.buffer.byteLength)
            }
            var r = this.view[t];
            return 128 == (128 & r) && (r = -(255 - r + 1)), e && (this.offset += 1), r
        }, o.readByte = o.readInt8, o.writeUint8 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal value: " + t + " (not an integer)");
                if (t >>>= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            e += 1;
            var i = this.buffer.byteLength;
            return i < e && this.resize((i *= 2) > e ? i : e), e -= 1, this.view[e] = t, r && (this.offset += 1), this
        }, o.writeUInt8 = o.writeUint8, o.readUint8 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+1) <= " + this.buffer.byteLength)
            }
            var r = this.view[t];
            return e && (this.offset += 1), r
        }, o.readUInt8 = o.readUint8, o.writeInt16 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal value: " + t + " (not an integer)");
                if (t |= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            e += 2;
            var i = this.buffer.byteLength;
            return i < e && this.resize((i *= 2) > e ? i : e), e -= 2, this.littleEndian ? (this.view[e + 1] = (65280 & t) >>> 8, this.view[e] = 255 & t) : (this.view[e] = (65280 & t) >>> 8, this.view[e + 1] = 255 & t), r && (this.offset += 2), this
        }, o.writeShort = o.writeInt16, o.readInt16 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 2 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+2) <= " + this.buffer.byteLength)
            }
            var r = 0;
            return this.littleEndian ? (r = this.view[t], r |= this.view[t + 1] << 8) : (r = this.view[t] << 8, r |= this.view[t + 1]), 32768 == (32768 & r) && (r = -(65535 - r + 1)), e && (this.offset += 2), r
        }, o.readShort = o.readInt16, o.writeUint16 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal value: " + t + " (not an integer)");
                if (t >>>= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            e += 2;
            var i = this.buffer.byteLength;
            return i < e && this.resize((i *= 2) > e ? i : e), e -= 2, this.littleEndian ? (this.view[e + 1] = (65280 & t) >>> 8, this.view[e] = 255 & t) : (this.view[e] = (65280 & t) >>> 8, this.view[e + 1] = 255 & t), r && (this.offset += 2), this
        }, o.writeUInt16 = o.writeUint16, o.readUint16 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 2 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+2) <= " + this.buffer.byteLength)
            }
            var r = 0;
            return this.littleEndian ? (r = this.view[t], r |= this.view[t + 1] << 8) : (r = this.view[t] << 8, r |= this.view[t + 1]), e && (this.offset += 2), r
        }, o.readUInt16 = o.readUint16, o.writeInt32 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal value: " + t + " (not an integer)");
                if (t |= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            e += 4;
            var i = this.buffer.byteLength;
            return i < e && this.resize((i *= 2) > e ? i : e), e -= 4, this.littleEndian ? (this.view[e + 3] = t >>> 24 & 255, this.view[e + 2] = t >>> 16 & 255, this.view[e + 1] = t >>> 8 & 255, this.view[e] = 255 & t) : (this.view[e] = t >>> 24 & 255, this.view[e + 1] = t >>> 16 & 255, this.view[e + 2] = t >>> 8 & 255, this.view[e + 3] = 255 & t), r && (this.offset += 4), this
        }, o.writeInt = o.writeInt32, o.readInt32 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 4 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+4) <= " + this.buffer.byteLength)
            }
            var r = 0;
            return this.littleEndian ? (r = this.view[t + 2] << 16, r |= this.view[t + 1] << 8, r |= this.view[t], r += this.view[t + 3] << 24 >>> 0) : (r = this.view[t + 1] << 16, r |= this.view[t + 2] << 8, r |= this.view[t + 3], r += this.view[t] << 24 >>> 0), r |= 0, e && (this.offset += 4), r
        }, o.readInt = o.readInt32, o.writeUint32 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal value: " + t + " (not an integer)");
                if (t >>>= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            e += 4;
            var i = this.buffer.byteLength;
            return i < e && this.resize((i *= 2) > e ? i : e), e -= 4, this.littleEndian ? (this.view[e + 3] = t >>> 24 & 255, this.view[e + 2] = t >>> 16 & 255, this.view[e + 1] = t >>> 8 & 255, this.view[e] = 255 & t) : (this.view[e] = t >>> 24 & 255, this.view[e + 1] = t >>> 16 & 255, this.view[e + 2] = t >>> 8 & 255, this.view[e + 3] = 255 & t), r && (this.offset += 4), this
        }, o.writeUInt32 = o.writeUint32, o.readUint32 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 4 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+4) <= " + this.buffer.byteLength)
            }
            var r = 0;
            return this.littleEndian ? (r = this.view[t + 2] << 16, r |= this.view[t + 1] << 8, r |= this.view[t], r += this.view[t + 3] << 24 >>> 0) : (r = this.view[t + 1] << 16, r |= this.view[t + 2] << 8, r |= this.view[t + 3], r += this.view[t] << 24 >>> 0), e && (this.offset += 4), r
        }, o.readUInt32 = o.readUint32, h && (o.writeInt64 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" == typeof t) t = h.fromNumber(t); else if ("string" == typeof t) t = h.fromString(t); else if (!(t && t instanceof h)) throw TypeError("Illegal value: " + t + " (not an integer or Long)");
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            "number" == typeof t ? t = h.fromNumber(t) : "string" == typeof t && (t = h.fromString(t)), e += 8;
            var i = this.buffer.byteLength;
            i < e && this.resize((i *= 2) > e ? i : e), e -= 8;
            var n = t.low, f = t.high;
            return this.littleEndian ? (this.view[e + 3] = n >>> 24 & 255, this.view[e + 2] = n >>> 16 & 255, this.view[e + 1] = n >>> 8 & 255, this.view[e] = 255 & n, e += 4, this.view[e + 3] = f >>> 24 & 255, this.view[e + 2] = f >>> 16 & 255, this.view[e + 1] = f >>> 8 & 255, this.view[e] = 255 & f) : (this.view[e] = f >>> 24 & 255, this.view[e + 1] = f >>> 16 & 255, this.view[e + 2] = f >>> 8 & 255, this.view[e + 3] = 255 & f, e += 4, this.view[e] = n >>> 24 & 255, this.view[e + 1] = n >>> 16 & 255, this.view[e + 2] = n >>> 8 & 255, this.view[e + 3] = 255 & n), r && (this.offset += 8), this
        }, o.writeLong = o.writeInt64, o.readInt64 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 8 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+8) <= " + this.buffer.byteLength)
            }
            var r = 0, i = 0;
            this.littleEndian ? (r = this.view[t + 2] << 16, r |= this.view[t + 1] << 8, r |= this.view[t], r += this.view[t + 3] << 24 >>> 0, t += 4, i = this.view[t + 2] << 16, i |= this.view[t + 1] << 8, i |= this.view[t], i += this.view[t + 3] << 24 >>> 0) : (i = this.view[t + 1] << 16, i |= this.view[t + 2] << 8, i |= this.view[t + 3], i += this.view[t] << 24 >>> 0, t += 4, r = this.view[t + 1] << 16, r |= this.view[t + 2] << 8, r |= this.view[t + 3], r += this.view[t] << 24 >>> 0);
            var n = new h(r, i, !1);
            return e && (this.offset += 8), n
        }, o.readLong = o.readInt64, o.writeUint64 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" == typeof t) t = h.fromNumber(t); else if ("string" == typeof t) t = h.fromString(t); else if (!(t && t instanceof h)) throw TypeError("Illegal value: " + t + " (not an integer or Long)");
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            "number" == typeof t ? t = h.fromNumber(t) : "string" == typeof t && (t = h.fromString(t)), e += 8;
            var i = this.buffer.byteLength;
            i < e && this.resize((i *= 2) > e ? i : e), e -= 8;
            var n = t.low, f = t.high;
            return this.littleEndian ? (this.view[e + 3] = n >>> 24 & 255, this.view[e + 2] = n >>> 16 & 255, this.view[e + 1] = n >>> 8 & 255, this.view[e] = 255 & n, e += 4, this.view[e + 3] = f >>> 24 & 255, this.view[e + 2] = f >>> 16 & 255, this.view[e + 1] = f >>> 8 & 255, this.view[e] = 255 & f) : (this.view[e] = f >>> 24 & 255, this.view[e + 1] = f >>> 16 & 255, this.view[e + 2] = f >>> 8 & 255, this.view[e + 3] = 255 & f, e += 4, this.view[e] = n >>> 24 & 255, this.view[e + 1] = n >>> 16 & 255, this.view[e + 2] = n >>> 8 & 255, this.view[e + 3] = 255 & n), r && (this.offset += 8), this
        }, o.writeUInt64 = o.writeUint64, o.readUint64 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 8 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+8) <= " + this.buffer.byteLength)
            }
            var r = 0, i = 0;
            this.littleEndian ? (r = this.view[t + 2] << 16, r |= this.view[t + 1] << 8, r |= this.view[t], r += this.view[t + 3] << 24 >>> 0, t += 4, i = this.view[t + 2] << 16, i |= this.view[t + 1] << 8, i |= this.view[t], i += this.view[t + 3] << 24 >>> 0) : (i = this.view[t + 1] << 16, i |= this.view[t + 2] << 8, i |= this.view[t + 3], i += this.view[t] << 24 >>> 0, t += 4, r = this.view[t + 1] << 16, r |= this.view[t + 2] << 8, r |= this.view[t + 3], r += this.view[t] << 24 >>> 0);
            var n = new h(r, i, !0);
            return e && (this.offset += 8), n
        }, o.readUInt64 = o.readUint64), o.writeFloat32 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" != typeof t) throw TypeError("Illegal value: " + t + " (not a number)");
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            e += 4;
            var i = this.buffer.byteLength;
            return i < e && this.resize((i *= 2) > e ? i : e), e -= 4, n(this.view, t, e, this.littleEndian, 23, 4), r && (this.offset += 4), this
        }, o.writeFloat = o.writeFloat32, o.readFloat32 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 4 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+4) <= " + this.buffer.byteLength)
            }
            var r = i(this.view, t, this.littleEndian, 23, 4);
            return e && (this.offset += 4), r
        }, o.readFloat = o.readFloat32, o.writeFloat64 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" != typeof t) throw TypeError("Illegal value: " + t + " (not a number)");
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            e += 8;
            var i = this.buffer.byteLength;
            return i < e && this.resize((i *= 2) > e ? i : e), e -= 8, n(this.view, t, e, this.littleEndian, 52, 8), r && (this.offset += 8), this
        }, o.writeDouble = o.writeFloat64, o.readFloat64 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 8 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+8) <= " + this.buffer.byteLength)
            }
            var r = i(this.view, t, this.littleEndian, 52, 8);
            return e && (this.offset += 8), r
        }, o.readDouble = o.readFloat64, b.MAX_VARINT32_BYTES = 5, b.calculateVarint32 = function (t) {
            return (t >>>= 0) < 128 ? 1 : t < 16384 ? 2 : t < 1 << 21 ? 3 : t < 1 << 28 ? 4 : 5
        }, b.zigZagEncode32 = function (t) {
            return ((t |= 0) << 1 ^ t >> 31) >>> 0
        }, b.zigZagDecode32 = function (t) {
            return t >>> 1 ^ -(1 & t) | 0
        }, o.writeVarint32 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal value: " + t + " (not an integer)");
                if (t |= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            var i, n = b.calculateVarint32(t);
            e += n;
            var f = this.buffer.byteLength;
            for (f < e && this.resize((f *= 2) > e ? f : e), e -= n, t >>>= 0; 128 <= t;) i = 127 & t | 128, this.view[e++] = i, t >>>= 7;
            return this.view[e++] = t, r ? (this.offset = e, this) : n
        }, o.writeVarint32ZigZag = function (t, e) {
            return this.writeVarint32(b.zigZagEncode32(t), e)
        }, o.readVarint32 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+1) <= " + this.buffer.byteLength)
            }
            var r, i = 0, n = 0;
            do {
                if (!this.noAssert && t > this.limit) {
                    var f = Error("Truncated");
                    throw f.truncated = !0, f
                }
                r = this.view[t++], i < 5 && (n |= (127 & r) << 7 * i), ++i
            } while (0 != (128 & r));
            return n |= 0, e ? (this.offset = t, n) : {value: n, length: i}
        }, o.readVarint32ZigZag = function (t) {
            var e = this.readVarint32(t);
            return "object" == typeof e ? e.value = b.zigZagDecode32(e.value) : e = b.zigZagDecode32(e), e
        }, h && (b.MAX_VARINT64_BYTES = 10, b.calculateVarint64 = function (t) {
            "number" == typeof t ? t = h.fromNumber(t) : "string" == typeof t && (t = h.fromString(t));
            var e = t.toInt() >>> 0, r = t.shiftRightUnsigned(28).toInt() >>> 0,
                i = t.shiftRightUnsigned(56).toInt() >>> 0;
            return 0 == i ? 0 == r ? e < 16384 ? e < 128 ? 1 : 2 : e < 1 << 21 ? 3 : 4 : r < 16384 ? r < 128 ? 5 : 6 : r < 1 << 21 ? 7 : 8 : i < 128 ? 9 : 10
        }, b.zigZagEncode64 = function (t) {
            return "number" == typeof t ? t = h.fromNumber(t, !1) : "string" == typeof t ? t = h.fromString(t, !1) : !1 !== t.unsigned && (t = t.toSigned()), t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()
        }, b.zigZagDecode64 = function (t) {
            return "number" == typeof t ? t = h.fromNumber(t, !1) : "string" == typeof t ? t = h.fromString(t, !1) : !1 !== t.unsigned && (t = t.toSigned()), t.shiftRightUnsigned(1).xor(t.and(h.ONE).toSigned().negate()).toSigned()
        }, o.writeVarint64 = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("number" == typeof t) t = h.fromNumber(t); else if ("string" == typeof t) t = h.fromString(t); else if (!(t && t instanceof h)) throw TypeError("Illegal value: " + t + " (not an integer or Long)");
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            "number" == typeof t ? t = h.fromNumber(t, !1) : "string" == typeof t ? t = h.fromString(t, !1) : !1 !== t.unsigned && (t = t.toSigned());
            var i = b.calculateVarint64(t), n = t.toInt() >>> 0, f = t.shiftRightUnsigned(28).toInt() >>> 0,
                o = t.shiftRightUnsigned(56).toInt() >>> 0;
            e += i;
            var s = this.buffer.byteLength;
            switch (s < e && this.resize((s *= 2) > e ? s : e), e -= i, i) {
                case 10:
                    this.view[e + 9] = o >>> 7 & 1;
                case 9:
                    this.view[e + 8] = 9 !== i ? 128 | o : 127 & o;
                case 8:
                    this.view[e + 7] = 8 !== i ? f >>> 21 | 128 : f >>> 21 & 127;
                case 7:
                    this.view[e + 6] = 7 !== i ? f >>> 14 | 128 : f >>> 14 & 127;
                case 6:
                    this.view[e + 5] = 6 !== i ? f >>> 7 | 128 : f >>> 7 & 127;
                case 5:
                    this.view[e + 4] = 5 !== i ? 128 | f : 127 & f;
                case 4:
                    this.view[e + 3] = 4 !== i ? n >>> 21 | 128 : n >>> 21 & 127;
                case 3:
                    this.view[e + 2] = 3 !== i ? n >>> 14 | 128 : n >>> 14 & 127;
                case 2:
                    this.view[e + 1] = 2 !== i ? n >>> 7 | 128 : n >>> 7 & 127;
                case 1:
                    this.view[e] = 1 !== i ? 128 | n : 127 & n
            }
            return r ? (this.offset += i, this) : i
        }, o.writeVarint64ZigZag = function (t, e) {
            return this.writeVarint64(b.zigZagEncode64(t), e)
        }, o.readVarint64 = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+1) <= " + this.buffer.byteLength)
            }
            var r = t, i = 0, n = 0, f = 0, o = 0;
            if (i = 127 & (o = this.view[t++]), 128 & o && (i |= (127 & (o = this.view[t++])) << 7, (128 & o || this.noAssert && void 0 === o) && (i |= (127 & (o = this.view[t++])) << 14, (128 & o || this.noAssert && void 0 === o) && (i |= (127 & (o = this.view[t++])) << 21, (128 & o || this.noAssert && void 0 === o) && (n = 127 & (o = this.view[t++]), (128 & o || this.noAssert && void 0 === o) && (n |= (127 & (o = this.view[t++])) << 7, (128 & o || this.noAssert && void 0 === o) && (n |= (127 & (o = this.view[t++])) << 14, (128 & o || this.noAssert && void 0 === o) && (n |= (127 & (o = this.view[t++])) << 21, (128 & o || this.noAssert && void 0 === o) && (f = 127 & (o = this.view[t++]), (128 & o || this.noAssert && void 0 === o) && (f |= (127 & (o = this.view[t++])) << 7, 128 & o || this.noAssert && void 0 === o)))))))))) throw Error("Buffer overrun");
            var s = h.fromBits(i | n << 28, n >>> 4 | f << 24, !1);
            return e ? (this.offset = t, s) : {value: s, length: t - r}
        }, o.readVarint64ZigZag = function (t) {
            var e = this.readVarint64(t);
            return e && e.value instanceof h ? e.value = b.zigZagDecode64(e.value) : e = b.zigZagDecode64(e), e
        }), o.writeCString = function (t, e) {
            var r = void 0 === e;
            r && (e = this.offset);
            var i, n = t.length;
            if (!this.noAssert) {
                if ("string" != typeof t) throw TypeError("Illegal str: Not a string");
                for (i = 0; i < n; ++i) if (0 === t.charCodeAt(i)) throw RangeError("Illegal str: Contains NULL-characters");
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            n = g.calculateUTF16asUTF8(s(t))[1], e += n + 1;
            var f = this.buffer.byteLength;
            return f < e && this.resize((f *= 2) > e ? f : e), e -= n + 1, g.encodeUTF16toUTF8(s(t), function (t) {
                this.view[e++] = t
            }.bind(this)), this.view[e++] = 0, r ? (this.offset = e, this) : n
        }, o.readCString = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+1) <= " + this.buffer.byteLength)
            }
            var r, i = t, n = -1;
            return g.decodeUTF8toUTF16(function () {
                if (0 === n) return null;
                if (t >= this.limit) throw RangeError("Illegal range: Truncated data, " + t + " < " + this.limit);
                return 0 === (n = this.view[t++]) ? null : n
            }.bind(this), r = a(), !0), e ? (this.offset = t, r()) : {string: r(), length: t - i}
        }, o.writeIString = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("string" != typeof t) throw TypeError("Illegal str: Not a string");
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            var i, n = e;
            i = g.calculateUTF16asUTF8(s(t), this.noAssert)[1], e += 4 + i;
            var f = this.buffer.byteLength;
            if (f < e && this.resize((f *= 2) > e ? f : e), e -= 4 + i, this.littleEndian ? (this.view[e + 3] = i >>> 24 & 255, this.view[e + 2] = i >>> 16 & 255, this.view[e + 1] = i >>> 8 & 255, this.view[e] = 255 & i) : (this.view[e] = i >>> 24 & 255, this.view[e + 1] = i >>> 16 & 255, this.view[e + 2] = i >>> 8 & 255, this.view[e + 3] = 255 & i), e += 4, g.encodeUTF16toUTF8(s(t), function (t) {
                this.view[e++] = t
            }.bind(this)), e !== n + 4 + i) throw RangeError("Illegal range: Truncated data, " + e + " == " + (e + 4 + i));
            return r ? (this.offset = e, this) : e - n
        }, o.readIString = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 4 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+4) <= " + this.buffer.byteLength)
            }
            var r = t, i = this.readUint32(t), n = this.readUTF8String(i, b.METRICS_BYTES, t += 4);
            return t += n.length, e ? (this.offset = t, n.string) : {string: n.string, length: t - r}
        }, b.METRICS_CHARS = "c", b.METRICS_BYTES = "b", o.writeUTF8String = function (t, e) {
            var r, i = void 0 === e;
            if (i && (e = this.offset), !this.noAssert) {
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            var n = e;
            r = g.calculateUTF16asUTF8(s(t))[1], e += r;
            var f = this.buffer.byteLength;
            return f < e && this.resize((f *= 2) > e ? f : e), e -= r, g.encodeUTF16toUTF8(s(t), function (t) {
                this.view[e++] = t
            }.bind(this)), i ? (this.offset = e, this) : e - n
        }, o.writeString = o.writeUTF8String, b.calculateUTF8Chars = function (t) {
            return g.calculateUTF16asUTF8(s(t))[0]
        }, b.calculateUTF8Bytes = function (t) {
            return g.calculateUTF16asUTF8(s(t))[1]
        }, b.calculateString = b.calculateUTF8Bytes, o.readUTF8String = function (t, e, r) {
            "number" == typeof e && (r = e, e = void 0);
            var i = void 0 === r;
            if (i && (r = this.offset), void 0 === e && (e = b.METRICS_CHARS), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal length: " + t + " (not an integer)");
                if (t |= 0, "number" != typeof r || r % 1 != 0) throw TypeError("Illegal offset: " + r + " (not an integer)");
                if ((r >>>= 0) < 0 || r + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + r + " (+0) <= " + this.buffer.byteLength)
            }
            var n, f = 0, o = r;
            if (e === b.METRICS_CHARS) {
                if (n = a(), g.decodeUTF8(function () {
                    return f < t && r < this.limit ? this.view[r++] : null
                }.bind(this), function (t) {
                    ++f, g.UTF8toUTF16(t, n)
                }), f !== t) throw RangeError("Illegal range: Truncated data, " + f + " == " + t);
                return i ? (this.offset = r, n()) : {string: n(), length: r - o}
            }
            if (e !== b.METRICS_BYTES) throw TypeError("Unsupported metrics: " + e);
            if (!this.noAssert) {
                if ("number" != typeof r || r % 1 != 0) throw TypeError("Illegal offset: " + r + " (not an integer)");
                if ((r >>>= 0) < 0 || r + t > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + r + " (+" + t + ") <= " + this.buffer.byteLength)
            }
            var s = r + t;
            if (g.decodeUTF8toUTF16(function () {
                return r < s ? this.view[r++] : null
            }.bind(this), n = a(), this.noAssert), r !== s) throw RangeError("Illegal range: Truncated data, " + r + " == " + s);
            return i ? (this.offset = r, n()) : {string: n(), length: r - o}
        }, o.readString = o.readUTF8String, o.writeVString = function (t, e) {
            var r = void 0 === e;
            if (r && (e = this.offset), !this.noAssert) {
                if ("string" != typeof t) throw TypeError("Illegal str: Not a string");
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)");
                if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
            }
            var i, n, f = e;
            i = g.calculateUTF16asUTF8(s(t), this.noAssert)[1], n = b.calculateVarint32(i), e += n + i;
            var o = this.buffer.byteLength;
            if (o < e && this.resize((o *= 2) > e ? o : e), e -= n + i, e += this.writeVarint32(i, e), g.encodeUTF16toUTF8(s(t), function (t) {
                this.view[e++] = t
            }.bind(this)), e !== f + i + n) throw RangeError("Illegal range: Truncated data, " + e + " == " + (e + i + n));
            return r ? (this.offset = e, this) : e - f
        }, o.readVString = function (t) {
            var e = void 0 === t;
            if (e && (t = this.offset), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+1) <= " + this.buffer.byteLength)
            }
            var r = t, i = this.readVarint32(t), n = this.readUTF8String(i.value, b.METRICS_BYTES, t += i.length);
            return t += n.length, e ? (this.offset = t, n.string) : {string: n.string, length: t - r}
        }, o.append = function (t, e, r) {
            "number" != typeof e && "string" == typeof e || (r = e, e = void 0);
            var i = void 0 === r;
            if (i && (r = this.offset), !this.noAssert) {
                if ("number" != typeof r || r % 1 != 0) throw TypeError("Illegal offset: " + r + " (not an integer)");
                if ((r >>>= 0) < 0 || r + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + r + " (+0) <= " + this.buffer.byteLength)
            }
            t instanceof b || (t = b.wrap(t, e));
            var n = t.limit - t.offset;
            if (n <= 0) return this;
            r += n;
            var f = this.buffer.byteLength;
            return f < r && this.resize((f *= 2) > r ? f : r), r -= n, this.view.set(t.view.subarray(t.offset, t.limit), r), t.offset += n, i && (this.offset += n), this
        }, o.appendTo = function (t, e) {
            return t.append(this, e), this
        }, o.assert = function (t) {
            return this.noAssert = !t, this
        }, o.capacity = function () {
            return this.buffer.byteLength
        }, o.clear = function () {
            return this.offset = 0, this.limit = this.buffer.byteLength, this.markedOffset = -1, this
        }, o.clone = function (t) {
            var e = new b(0, this.littleEndian, this.noAssert);
            return e.view = t ? (e.buffer = new ArrayBuffer(this.buffer.byteLength), new Uint8Array(e.buffer)) : (e.buffer = this.buffer, this.view), e.offset = this.offset, e.markedOffset = this.markedOffset, e.limit = this.limit, e
        }, o.compact = function (t, e) {
            if (void 0 === t && (t = this.offset), void 0 === e && (e = this.limit), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal begin: Not an integer");
                if (t >>>= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal end: Not an integer");
                if (e >>>= 0, t < 0 || e < t || e > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + t + " <= " + e + " <= " + this.buffer.byteLength)
            }
            if (0 === t && e === this.buffer.byteLength) return this;
            var r = e - t;
            if (0 === r) return this.buffer = f, this.view = null, 0 <= this.markedOffset && (this.markedOffset -= t), this.offset = 0, this.limit = 0, this;
            var i = new ArrayBuffer(r), n = new Uint8Array(i);
            return n.set(this.view.subarray(t, e)), this.buffer = i, this.view = n, 0 <= this.markedOffset && (this.markedOffset -= t), this.offset = 0, this.limit = r, this
        }, o.copy = function (t, e) {
            if (void 0 === t && (t = this.offset), void 0 === e && (e = this.limit), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal begin: Not an integer");
                if (t >>>= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal end: Not an integer");
                if (e >>>= 0, t < 0 || e < t || e > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + t + " <= " + e + " <= " + this.buffer.byteLength)
            }
            if (t === e) return new b(0, this.littleEndian, this.noAssert);
            var r = e - t, i = new b(r, this.littleEndian, this.noAssert);
            return i.offset = 0, i.limit = r, 0 <= i.markedOffset && (i.markedOffset -= t), this.copyTo(i, 0, t, e), i
        }, o.copyTo = function (t, e, r, i) {
            var n, f;
            if (!this.noAssert && !b.isByteBuffer(t)) throw TypeError("Illegal target: Not a ByteBuffer");
            if (e = (f = void 0 === e) ? t.offset : 0 | e, r = (n = void 0 === r) ? this.offset : 0 | r, i = void 0 === i ? this.limit : 0 | i, e < 0 || e > t.buffer.byteLength) throw RangeError("Illegal target range: 0 <= " + e + " <= " + t.buffer.byteLength);
            if (r < 0 || i > this.buffer.byteLength) throw RangeError("Illegal source range: 0 <= " + r + " <= " + this.buffer.byteLength);
            var o = i - r;
            return 0 === o ? t : (t.ensureCapacity(e + o), t.view.set(this.view.subarray(r, i), e), n && (this.offset += o), f && (t.offset += o), this)
        }, o.ensureCapacity = function (t) {
            var e = this.buffer.byteLength;
            return e < t ? this.resize((e *= 2) > t ? e : t) : this
        }, o.fill = function (t, e, r) {
            var i = void 0 === e;
            if (i && (e = this.offset), "string" == typeof t && 0 < t.length && (t = t.charCodeAt(0)), void 0 === e && (e = this.offset), void 0 === r && (r = this.limit), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal value: " + t + " (not an integer)");
                if (t |= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal begin: Not an integer");
                if (e >>>= 0, "number" != typeof r || r % 1 != 0) throw TypeError("Illegal end: Not an integer");
                if (r >>>= 0, e < 0 || r < e || r > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + e + " <= " + r + " <= " + this.buffer.byteLength)
            }
            if (r <= e) return this;
            for (; e < r;) this.view[e++] = t;
            return i && (this.offset = e), this
        }, o.flip = function () {
            return this.limit = this.offset, this.offset = 0, this
        }, o.mark = function (t) {
            if (t = void 0 === t ? this.offset : t, !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)");
                if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
            }
            return this.markedOffset = t, this
        }, o.order = function (t) {
            if (!this.noAssert && "boolean" != typeof t) throw TypeError("Illegal littleEndian: Not a boolean");
            return this.littleEndian = !!t, this
        }, o.LE = function (t) {
            return this.littleEndian = void 0 === t || !!t, this
        }, o.BE = function (t) {
            return this.littleEndian = void 0 !== t && !t, this
        }, o.prepend = function (t, e, r) {
            "number" != typeof e && "string" == typeof e || (r = e, e = void 0);
            var i = void 0 === r;
            if (i && (r = this.offset), !this.noAssert) {
                if ("number" != typeof r || r % 1 != 0) throw TypeError("Illegal offset: " + r + " (not an integer)");
                if ((r >>>= 0) < 0 || r + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + r + " (+0) <= " + this.buffer.byteLength)
            }
            t instanceof b || (t = b.wrap(t, e));
            var n = t.limit - t.offset;
            if (n <= 0) return this;
            var f = n - r;
            if (0 < f) {
                var o = new ArrayBuffer(this.buffer.byteLength + f), s = new Uint8Array(o);
                s.set(this.view.subarray(r, this.buffer.byteLength), n), this.buffer = o, this.view = s, this.offset += f, 0 <= this.markedOffset && (this.markedOffset += f), this.limit += f, r += f
            } else new Uint8Array(this.buffer);
            return this.view.set(t.view.subarray(t.offset, t.limit), r - n), t.offset = t.limit, i && (this.offset -= n), this
        }, o.prependTo = function (t, e) {
            return t.prepend(this, e), this
        }, o.printDebug = function (t) {
            "function" != typeof t && (t = void 0), t(this.toString() + "\n-------------------------------------------------------------------\n" + this.toDebug(!0))
        }, o.remaining = function () {
            return this.limit - this.offset
        }, o.reset = function () {
            return 0 <= this.markedOffset ? (this.offset = this.markedOffset, this.markedOffset = -1) : this.offset = 0, this
        }, o.resize = function (t) {
            if (!this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal capacity: " + t + " (not an integer)");
                if ((t |= 0) < 0) throw RangeError("Illegal capacity: 0 <= " + t)
            }
            if (this.buffer.byteLength < t) {
                var e = new ArrayBuffer(t), r = new Uint8Array(e);
                r.set(this.view), this.buffer = e, this.view = r
            }
            return this
        }, o.reverse = function (t, e) {
            if (void 0 === t && (t = this.offset), void 0 === e && (e = this.limit), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal begin: Not an integer");
                if (t >>>= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal end: Not an integer");
                if (e >>>= 0, t < 0 || e < t || e > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + t + " <= " + e + " <= " + this.buffer.byteLength)
            }
            return t === e || Array.prototype.reverse.call(this.view.subarray(t, e)), this
        }, o.skip = function (t) {
            if (!this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal length: " + t + " (not an integer)");
                t |= 0
            }
            var e = this.offset + t;
            if (!this.noAssert && (e < 0 || e > this.buffer.byteLength)) throw RangeError("Illegal length: 0 <= " + this.offset + " + " + t + " <= " + this.buffer.byteLength);
            return this.offset = e, this
        }, o.slice = function (t, e) {
            if (void 0 === t && (t = this.offset), void 0 === e && (e = this.limit), !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal begin: Not an integer");
                if (t >>>= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal end: Not an integer");
                if (e >>>= 0, t < 0 || e < t || e > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + t + " <= " + e + " <= " + this.buffer.byteLength)
            }
            var r = this.clone();
            return r.offset = t, r.limit = e, r
        }, o.toBuffer = function (t) {
            var e = this.offset, r = this.limit;
            if (!this.noAssert) {
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: Not an integer");
                if (e >>>= 0, "number" != typeof r || r % 1 != 0) throw TypeError("Illegal limit: Not an integer");
                if (r >>>= 0, e < 0 || r < e || r > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + e + " <= " + r + " <= " + this.buffer.byteLength)
            }
            if (!t && 0 === e && r === this.buffer.byteLength) return this.buffer;
            if (e === r) return f;
            var i = new ArrayBuffer(r - e);
            return new Uint8Array(i).set(new Uint8Array(this.buffer).subarray(e, r), 0), i
        }, o.toArrayBuffer = o.toBuffer, o.toString = function (t, e, r) {
            if (void 0 === t) return "ByteBufferAB(offset=" + this.offset + ",markedOffset=" + this.markedOffset + ",limit=" + this.limit + ",capacity=" + this.capacity() + ")";
            switch ("number" == typeof t && (r = e = t = "utf8"), t) {
                case"utf8":
                    return this.toUTF8(e, r);
                case"base64":
                    return this.toBase64(e, r);
                case"hex":
                    return this.toHex(e, r);
                case"binary":
                    return this.toBinary(e, r);
                case"debug":
                    return this.toDebug();
                case"columns":
                    return this.toColumns();
                default:
                    throw Error("Unsupported encoding: " + t)
            }
        };
        var l = function () {
            for (var t = {}, n = [65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 43, 47], o = [], e = 0, r = n.length; e < r; ++e) o[n[e]] = e;
            return t.encode = function (t, e) {
                for (var r, i; null !== (r = t());) e(n[r >> 2 & 63]), i = (3 & r) << 4, null !== (r = t()) ? (e(n[63 & ((i |= r >> 4 & 15) | r >> 4 & 15)]), i = (15 & r) << 2, null !== (r = t()) ? (e(n[63 & (i | r >> 6 & 3)]), e(n[63 & r])) : (e(n[63 & i]), e(61))) : (e(n[63 & i]), e(61), e(61))
            }, t.decode = function (t, e) {
                var r, i, n;

                function f(t) {
                    throw Error("Illegal character code: " + t)
                }

                for (; null !== (r = t());) if (void 0 === (i = o[r]) && f(r), null !== (r = t()) && (void 0 === (n = o[r]) && f(r), e(i << 2 >>> 0 | (48 & n) >> 4), null !== (r = t()))) {
                    if (void 0 === (i = o[r])) {
                        if (61 === r) break;
                        f(r)
                    }
                    if (e((15 & n) << 4 >>> 0 | (60 & i) >> 2), null !== (r = t())) {
                        if (void 0 === (n = o[r])) {
                            if (61 === r) break;
                            f(r)
                        }
                        e((3 & i) << 6 >>> 0 | n)
                    }
                }
            }, t.test = function (t) {
                return /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)
            }, t
        }();
        o.toBase64 = function (t, e) {
            if (void 0 === t && (t = this.offset), void 0 === e && (e = this.limit), e |= 0, (t |= 0) < 0 || e > this.capacity || e < t) throw RangeError("begin, end");
            var r;
            return l.encode(function () {
                return t < e ? this.view[t++] : null
            }.bind(this), r = a()), r()
        }, b.fromBase64 = function (t, e) {
            if ("string" != typeof t) throw TypeError("str");
            var r = new b(t.length / 4 * 3, e), i = 0;
            return l.decode(s(t), function (t) {
                r.view[i++] = t
            }), r.limit = i, r
        }, b.btoa = function (t) {
            return b.fromBinary(t).toBase64()
        }, b.atob = function (t) {
            return b.fromBase64(t).toBinary()
        }, o.toBinary = function (t, e) {
            if (void 0 === t && (t = this.offset), void 0 === e && (e = this.limit), e |= 0, (t |= 0) < 0 || e > this.capacity() || e < t) throw RangeError("begin, end");
            if (t === e) return "";
            for (var r = [], i = []; t < e;) r.push(this.view[t++]), 1024 <= r.length && (i.push(String.fromCharCode.apply(String, r)), r = []);
            return i.join("") + String.fromCharCode.apply(String, r)
        }, b.fromBinary = function (t, e) {
            if ("string" != typeof t) throw TypeError("str");
            for (var r, i = 0, n = t.length, f = new b(n, e); i < n;) {
                if (255 < (r = t.charCodeAt(i))) throw RangeError("illegal char code: " + r);
                f.view[i++] = r
            }
            return f.limit = n, f
        }, o.toDebug = function (t) {
            for (var e, r = -1, i = this.buffer.byteLength, n = "", f = "", o = ""; r < i;) {
                if (-1 !== r && (n += (e = this.view[r]) < 16 ? "0" + e.toString(16).toUpperCase() : e.toString(16).toUpperCase(), t && (f += 32 < e && e < 127 ? String.fromCharCode(e) : ".")), ++r, t && 0 < r && r % 16 == 0 && r !== i) {
                    for (; n.length < 51;) n += " ";
                    o += n + f + "\n", n = f = ""
                }
                r === this.offset && r === this.limit ? n += r === this.markedOffset ? "!" : "|" : r === this.offset ? n += r === this.markedOffset ? "[" : "<" : r === this.limit ? n += r === this.markedOffset ? "]" : ">" : n += r === this.markedOffset ? "'" : t || 0 !== r && r !== i ? " " : ""
            }
            if (t && " " !== n) {
                for (; n.length < 51;) n += " ";
                o += n + f + "\n"
            }
            return t ? o : n
        }, b.fromDebug = function (t, e, r) {
            for (var i, n, f = t.length, o = new b((f + 1) / 3 | 0, e, r), s = 0, h = 0, a = !1, l = !1, u = !1, g = !1, w = !1; s < f;) {
                switch (i = t.charAt(s++)) {
                    case"!":
                        if (!r) {
                            if (l || u || g) {
                                w = !0;
                                break
                            }
                            l = u = g = !0
                        }
                        o.offset = o.markedOffset = o.limit = h, a = !1;
                        break;
                    case"|":
                        if (!r) {
                            if (l || g) {
                                w = !0;
                                break
                            }
                            l = g = !0
                        }
                        o.offset = o.limit = h, a = !1;
                        break;
                    case"[":
                        if (!r) {
                            if (l || u) {
                                w = !0;
                                break
                            }
                            l = u = !0
                        }
                        o.offset = o.markedOffset = h, a = !1;
                        break;
                    case"<":
                        if (!r) {
                            if (l) {
                                w = !0;
                                break
                            }
                            l = !0
                        }
                        o.offset = h, a = !1;
                        break;
                    case"]":
                        if (!r) {
                            if (g || u) {
                                w = !0;
                                break
                            }
                            g = u = !0
                        }
                        o.limit = o.markedOffset = h, a = !1;
                        break;
                    case">":
                        if (!r) {
                            if (g) {
                                w = !0;
                                break
                            }
                            g = !0
                        }
                        o.limit = h, a = !1;
                        break;
                    case"'":
                        if (!r) {
                            if (u) {
                                w = !0;
                                break
                            }
                            u = !0
                        }
                        o.markedOffset = h, a = !1;
                        break;
                    case" ":
                        a = !1;
                        break;
                    default:
                        if (!r && a) {
                            w = !0;
                            break
                        }
                        if (n = parseInt(i + t.charAt(s++), 16), !r && (isNaN(n) || n < 0 || 255 < n)) throw TypeError("Illegal str: Not a debug encoded string");
                        o.view[h++] = n, a = !0
                }
                if (w) throw TypeError("Illegal str: Invalid symbol at " + s)
            }
            if (!r) {
                if (!l || !g) throw TypeError("Illegal str: Missing offset or limit");
                if (h < o.buffer.byteLength) throw TypeError("Illegal str: Not a debug encoded string (is it hex?) " + h + " < " + f)
            }
            return o
        }, o.toHex = function (t, e) {
            if (t = void 0 === t ? this.offset : t, e = void 0 === e ? this.limit : e, !this.noAssert) {
                if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal begin: Not an integer");
                if (t >>>= 0, "number" != typeof e || e % 1 != 0) throw TypeError("Illegal end: Not an integer");
                if (e >>>= 0, t < 0 || e < t || e > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + t + " <= " + e + " <= " + this.buffer.byteLength)
            }
            for (var r, i = new Array(e - t); t < e;) (r = this.view[t++]) < 16 ? i.push("0", r.toString(16)) : i.push(r.toString(16));
            return i.join("")
        }, b.fromHex = function (t, e, r) {
            if (!r) {
                if ("string" != typeof t) throw TypeError("Illegal str: Not a string");
                if (t.length % 2 != 0) throw TypeError("Illegal str: Length not a multiple of 2")
            }
            for (var i, n = t.length, f = new b(n / 2 | 0, e), o = 0, s = 0; o < n; o += 2) {
                if (i = parseInt(t.substring(o, o + 2), 16), !r && (!isFinite(i) || i < 0 || 255 < i)) throw TypeError("Illegal str: Contains non-hex characters");
                f.view[s++] = i
            }
            return f.limit = s, f
        };
        var u, g = u = {
            MAX_CODEPOINT: 1114111, encodeUTF8: function (t, e) {
                var r = null;
                for ("number" == typeof t && (r = t, t = function () {
                    return null
                }); null !== r || null !== (r = t());) r < 128 ? e(127 & r) : (r < 2048 ? e(r >> 6 & 31 | 192) : (r < 65536 ? e(r >> 12 & 15 | 224) : (e(r >> 18 & 7 | 240), e(r >> 12 & 63 | 128)), e(r >> 6 & 63 | 128)), e(63 & r | 128)), r = null
            }, decodeUTF8: function (t, e) {
                for (var r, i, n, f, o = function (t) {
                    t = t.slice(0, t.indexOf(null));
                    var e = Error(t.toString());
                    throw e.name = "TruncatedError", e.bytes = t, e
                }; null !== (r = t());) if (0 == (128 & r)) e(r); else if (192 == (224 & r)) null === (i = t()) && o([r, i]), e((31 & r) << 6 | 63 & i); else if (224 == (240 & r)) (null === (i = t()) || null === (n = t())) && o([r, i, n]), e((15 & r) << 12 | (63 & i) << 6 | 63 & n); else {
                    if (240 != (248 & r)) throw RangeError("Illegal starting byte: " + r);
                    (null === (i = t()) || null === (n = t()) || null === (f = t())) && o([r, i, n, f]), e((7 & r) << 18 | (63 & i) << 12 | (63 & n) << 6 | 63 & f)
                }
            }, UTF16toUTF8: function (t, e) {
                for (var r, i = null; null !== (r = null !== i ? i : t());) 55296 <= r && r <= 57343 && null !== (i = t()) && 56320 <= i && i <= 57343 ? (e(1024 * (r - 55296) + i - 56320 + 65536), i = null) : e(r);
                null !== i && e(i)
            }, UTF8toUTF16: function (t, e) {
                var r = null;
                for ("number" == typeof t && (r = t, t = function () {
                    return null
                }); null !== r || null !== (r = t());) r <= 65535 ? e(r) : (e(55296 + ((r -= 65536) >> 10)), e(r % 1024 + 56320)), r = null
            }, encodeUTF16toUTF8: function (t, e) {
                u.UTF16toUTF8(t, function (t) {
                    u.encodeUTF8(t, e)
                })
            }, decodeUTF8toUTF16: function (t, e) {
                u.decodeUTF8(t, function (t) {
                    u.UTF8toUTF16(t, e)
                })
            }, calculateCodePoint: function (t) {
                return t < 128 ? 1 : t < 2048 ? 2 : t < 65536 ? 3 : 4
            }, calculateUTF8: function (t) {
                for (var e, r = 0; null !== (e = t());) r += e < 128 ? 1 : e < 2048 ? 2 : e < 65536 ? 3 : 4;
                return r
            }, calculateUTF16asUTF8: function (t) {
                var e = 0, r = 0;
                return u.UTF16toUTF8(t, function (t) {
                    ++e, r += t < 128 ? 1 : t < 2048 ? 2 : t < 65536 ? 3 : 4
                }), [e, r]
            }
        };
        return o.toUTF8 = function (e, r) {
            if (void 0 === e && (e = this.offset), void 0 === r && (r = this.limit), !this.noAssert) {
                if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal begin: Not an integer");
                if (e >>>= 0, "number" != typeof r || r % 1 != 0) throw TypeError("Illegal end: Not an integer");
                if (r >>>= 0, e < 0 || r < e || r > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + e + " <= " + r + " <= " + this.buffer.byteLength)
            }
            var t;
            try {
                g.decodeUTF8toUTF16(function () {
                    return e < r ? this.view[e++] : null
                }.bind(this), t = a())
            } catch (t) {
                if (e !== r) throw RangeError("Illegal range: Truncated data, " + e + " != " + r)
            }
            return t()
        }, b.fromUTF8 = function (t, e, r) {
            if (!r && "string" != typeof t) throw TypeError("Illegal str: Not a string");
            var i = new b(g.calculateUTF16asUTF8(s(t), !0)[1], e, r), n = 0;
            return g.encodeUTF16toUTF8(s(t), function (t) {
                i.view[n++] = t
            }), i.limit = n, i
        }, b
    });
});
define("libs/laya.ani.js", function (require, module, exports) {
    !function (t, e, rt) {
        rt.un, rt.uns;
        var i = rt.static, a = rt.class, s = rt.getset, f = rt.__newvec, h = laya.maths.Bezier, _ = laya.utils.Browser,
            Ct = laya.utils.Byte, r = (laya.Const, laya.events.Event, laya.events.EventDispatcher),
            n = laya.display.Graphics, o = laya.utils.Handler, l = laya.net.Loader, c = laya.maths.MathUtil,
            Ft = laya.maths.Matrix, u = (laya.display.Node, laya.maths.Rectangle),
            p = (laya.renders.Render, laya.resource.Resource), d = (laya.media.SoundChannel, laya.media.SoundManager),
            st = laya.display.Sprite, m = laya.utils.Stat, wt = laya.resource.Texture,
            y = (laya.resource.Texture2D, laya.utils.Timer, laya.net.URL, laya.utils.Utils), kt = function () {
                function t() {
                    this.name = null, this.displayArr = []
                }

                return a(t, "laya.ani.bone.SlotData"), t.prototype.getDisplayByName = function (t) {
                    for (var e = 0, i = this.displayArr.length; e < i; e++) if (this.displayArr[e].attachmentName == t) return e;
                    return -1
                }, t
            }(), x = function () {
                function t() {
                    this.texture = null, this.uvTransform = null, this.useUvTransform = !1, this.canvasPadding = 1, this.uvs = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]), this.vertices = new Float32Array([0, 0, 100, 0, 100, 100, 0, 100]), this.indexes = new Uint16Array([0, 1, 3, 3, 1, 2])
                }

                return a(t, "laya.ani.bone.canvasmesh.MeshData"), t.prototype.getBounds = function () {
                    return u._getWrapRec(this.vertices)
                }, t
            }(), F = function () {
                function t() {
                    this.name = null, this.parentIndex = 0, this.parent = null, this.keyframeWidth = 0, this.lerpType = 0, this.interpolationMethod = null, this.childs = null, this.keyFrame = null, this.playTime = NaN, this.extenData = null, this.dataOffset = 0
                }

                return a(t, "laya.ani.AnimationNodeContent"), t
            }(), w = function () {
                function t() {
                    this.startTime = NaN, this.duration = NaN, this.interpolationData = null, this.data = null, this.dData = null, this.nextData = null
                }

                return a(t, "laya.ani.KeyFramesContent"), t
            }(), g = function () {
                function t(t, e) {
                    this._data = null, this._bones = null, this.target = null, this.rotateMix = NaN, this.translateMix = NaN, this.scaleMix = NaN, this.shearMix = NaN, this._temp = f(2, 0), this._data = t, null == this._bones && (this._bones = []), this.target = e[t.targetIndex];
                    var i, a = 0;
                    for (a = 0, i = t.boneIndexs.length; a < i; a++) this._bones.push(e[t.boneIndexs[a]]);
                    this.rotateMix = t.rotateMix, this.translateMix = t.translateMix, this.scaleMix = t.scaleMix, this.shearMix = t.shearMix
                }

                return a(t, "laya.ani.bone.TfConstraint"), t.prototype.apply = function () {
                    for (var t, e = this.target.resultMatrix.a, i = this.target.resultMatrix.b, a = this.target.resultMatrix.c, r = this.target.resultMatrix.d, s = 0, n = this._bones.length; s < n; s++) {
                        if (t = this._bones[s], 0 < this.rotateMix) {
                            var h = t.resultMatrix.a, l = t.resultMatrix.b, o = t.resultMatrix.c, u = t.resultMatrix.d,
                                c = Math.atan2(a, e) - Math.atan2(o, h) + this._data.offsetRotation * Math.PI / 180;
                            c > Math.PI ? c -= 2 * Math.PI : c < -Math.PI && (c += 2 * Math.PI), c *= this.rotateMix;
                            var _ = Math.cos(c), p = Math.sin(c);
                            t.resultMatrix.a = _ * h - p * o, t.resultMatrix.b = _ * l - p * u, t.resultMatrix.c = p * h + _ * o, t.resultMatrix.d = p * l + _ * u
                        }
                        if (this.translateMix && (this._temp[0] = this._data.offsetX, this._temp[1] = this._data.offsetY, this.target.localToWorld(this._temp), t.resultMatrix.tx += (this._temp[0] - t.resultMatrix.tx) * this.translateMix, t.resultMatrix.ty += (this._temp[1] - t.resultMatrix.ty) * this.translateMix, t.updateChild()), 0 < this.scaleMix) {
                            var d = Math.sqrt(t.resultMatrix.a * t.resultMatrix.a + t.resultMatrix.c * t.resultMatrix.c),
                                f = Math.sqrt(e * e + a * a),
                                m = 1e-5 < d ? (d + (f - d + this._data.offsetScaleX) * this.scaleMix) / d : 0;
                            t.resultMatrix.a *= m, t.resultMatrix.c *= m, d = Math.sqrt(t.resultMatrix.b * t.resultMatrix.b + t.resultMatrix.d * t.resultMatrix.d), f = Math.sqrt(i * i + r * r), m = 1e-5 < d ? (d + (f - d + this._data.offsetScaleY) * this.scaleMix) / d : 0, t.resultMatrix.b *= m, t.resultMatrix.d *= m
                        }
                        if (0 < this.shearMix) {
                            l = t.resultMatrix.b, u = t.resultMatrix.d;
                            var y = Math.atan2(u, l);
                            (c = Math.atan2(r, i) - Math.atan2(a, e) - (y - Math.atan2(t.resultMatrix.c, t.resultMatrix.a))) > Math.PI ? c -= 2 * Math.PI : c < -Math.PI && (c += 2 * Math.PI), c = y + (c + this._data.offsetShearY * Math.PI / 180) * this.shearMix, m = Math.sqrt(l * l + u * u), t.resultMatrix.b = Math.cos(c) * m, t.resultMatrix.d = Math.sin(c) * m
                        }
                    }
                }, t
            }(), Pt = function () {
                function t() {
                    this.name = null, this.target = null, this.positionMode = null, this.spacingMode = null, this.rotateMode = null, this.offsetRotation = NaN, this.position = NaN, this.spacing = NaN, this.rotateMix = NaN, this.translateMix = NaN, this.bones = []
                }

                return a(t, "laya.ani.bone.PathConstraintData"), t
            }(), v = function () {
                function t() {
                }

                return a(t, "laya.ani.bone.UVTools"), t.getRelativeUV = function (t, e, i) {
                    var a = t[0], r = t[2] - t[0], s = t[1], n = t[5] - t[1];
                    i || (i = []), i.length = e.length;
                    var h, l = 0;
                    h = i.length;
                    var o = 1 / r, u = 1 / n;
                    for (l = 0; l < h; l += 2) i[l] = (e[l] - a) * o, i[l + 1] = (e[l + 1] - s) * u;
                    return i
                }, t.getAbsoluteUV = function (t, e, i) {
                    if (0 == t[0] && 0 == t[1] && 1 == t[4] && 1 == t[5]) return i ? (y.copyArray(i, e), i) : e;
                    var a = t[0], r = t[2] - t[0], s = t[1], n = t[5] - t[1];
                    i || (i = []), i.length = e.length;
                    var h, l = 0;
                    for (h = i.length, l = 0; l < h; l += 2) i[l] = e[l] * r + a, i[l + 1] = e[l + 1] * n + s;
                    return i
                }, t
            }(), Ut = function () {
                function t() {
                    this.deformSlotDisplayList = []
                }

                return a(t, "laya.ani.bone.DeformSlotData"), t
            }(), M = function () {
                function v() {
                }

                return a(v, "laya.ani.AnimationParser02"), v.READ_DATA = function () {
                    v._DATA.offset = v._reader.getUint32(), v._DATA.size = v._reader.getUint32()
                }, v.READ_BLOCK = function () {
                    for (var t = v._BLOCK.count = v._reader.getUint16(), e = v._BLOCK.blockStarts = [], i = v._BLOCK.blockLengths = [], a = 0; a < t; a++) e.push(v._reader.getUint32()), i.push(v._reader.getUint32())
                }, v.READ_STRINGS = function () {
                    var t = v._reader.getUint32(), e = v._reader.getUint16(), i = v._reader.pos;
                    v._reader.pos = t + v._DATA.offset;
                    for (var a = 0; a < e; a++) v._strings[a] = v._reader.readUTFString();
                    v._reader.pos = i
                }, v.parse = function (t, e) {
                    v._templet = t;
                    (v._reader = e).__getBuffer();
                    v.READ_DATA(), v.READ_BLOCK(), v.READ_STRINGS();
                    for (var i = 0, a = v._BLOCK.count; i < a; i++) {
                        var r = e.getUint16(), s = v._strings[r], n = v["READ_" + s];
                        if (null == n) throw new Error("model file err,no this function:" + r + " " + s);
                        n.call(null)
                    }
                }, v.READ_ANIMATIONS = function () {
                    var t = v._reader, e = t.__getBuffer(), i = 0, a = 0, r = 0, s = 0, n = t.getUint16(), h = [];
                    for (h.length = n, i = 0; i < n; i++) h[i] = P.interpolation[t.getByte()];
                    var l = t.getUint8();
                    for (v._templet._anis.length = l, i = 0; i < l; i++) {
                        var o = v._templet._anis[i] = new k;
                        o.nodes = new Array;
                        var u = o.name = v._strings[t.getUint16()];
                        v._templet._aniMap[u] = i, o.bone3DMap = {}, o.playTime = t.getFloat32();
                        var c = o.nodes.length = t.getInt16();
                        for (a = o.totalKeyframeDatasLength = 0; a < c; a++) {
                            var _ = o.nodes[a] = new F;
                            _.keyframeWidth = n, _.childs = [];
                            var p = t.getUint16();
                            0 <= p && (_.name = v._strings[p], o.bone3DMap[_.name] = a), _.keyFrame = new Array, _.parentIndex = t.getInt16(), -1 == _.parentIndex ? _.parent = null : _.parent = o.nodes[_.parentIndex], o.totalKeyframeDatasLength += n, _.interpolationMethod = h, null != _.parent && _.parent.childs.push(_);
                            var d = t.getUint16(), f = null, m = null;
                            for (r = 0, s = _.keyFrame.length = d; r < s; r++) {
                                (f = _.keyFrame[r] = new w).startTime = t.getFloat32(), m && (m.duration = f.startTime - m.startTime), f.dData = new Float32Array(n), f.nextData = new Float32Array(n);
                                var y = v._DATA.offset, x = t.getUint32(), g = 4 * n, D = e.slice(y + x, y + x + g);
                                f.data = new Float32Array(D), m = f
                            }
                            f.duration = 0, _.playTime = o.playTime, v._templet._calculateKeyFrame(_, d, n)
                        }
                    }
                }, v._templet = null, v._reader = null, v._strings = [], i(v, ["_BLOCK", function () {
                    return this._BLOCK = {count: 0}
                }, "_DATA", function () {
                    return this._DATA = {offset: 0, size: 0}
                }]), v
            }(), I = function () {
                function t() {
                }

                return a(t, "laya.ani.AnimationParser01"), t.parse = function (t, e) {
                    var i = e.__getBuffer(), a = 0, r = 0, s = 0, n = 0, h = 0, l = 0, o = 0, u = e.readUTFString();
                    t._aniClassName = u;
                    var c, _ = e.readUTFString().split("\n"), p = e.getUint8(), d = e.getUint32(), f = e.getUint32();
                    0 < d && (c = i.slice(d, f));
                    var m = new Ct(c);
                    for (0 < f && (t._publicExtData = i.slice(f, i.byteLength)), t._useParent = !!e.getUint8(), t._anis.length = p, a = 0; a < p; a++) {
                        var y = t._anis[a] = new k;
                        y.nodes = new Array;
                        var x = y.name = _[e.getUint16()];
                        t._aniMap[x] = a, y.bone3DMap = {}, y.playTime = e.getFloat32();
                        var g = y.nodes.length = e.getUint8();
                        for (r = y.totalKeyframeDatasLength = 0; r < g; r++) {
                            var D = y.nodes[r] = new F;
                            D.childs = [];
                            var v = e.getInt16();
                            0 <= v && (D.name = _[v], y.bone3DMap[D.name] = r), D.keyFrame = new Array, D.parentIndex = e.getInt16(), -1 == D.parentIndex ? D.parent = null : D.parent = y.nodes[D.parentIndex], D.lerpType = e.getUint8();
                            var M = e.getUint32();
                            m.pos = M;
                            var I = D.keyframeWidth = m.getUint16();
                            if (y.totalKeyframeDatasLength += I, 0 === D.lerpType || 1 === D.lerpType) for (D.interpolationMethod = [], D.interpolationMethod.length = I, s = 0; s < I; s++) D.interpolationMethod[s] = P.interpolation[m.getUint8()];
                            null != D.parent && D.parent.childs.push(D);
                            var A = e.getUint16();
                            0 < A && (D.extenData = i.slice(e.pos, e.pos + A), e.pos += A);
                            var b, N = e.getUint16(), T = 0;
                            for (s = 0, n = D.keyFrame.length = N; s < n; s++) {
                                if ((b = D.keyFrame[s] = new w).duration = e.getFloat32(), b.startTime = T, 2 === D.lerpType) {
                                    b.interpolationData = [];
                                    var S, C = e.getUint8();
                                    switch (S = e.getFloat32()) {
                                        case 254:
                                            for (b.interpolationData.length = I, o = 0; o < I; o++) b.interpolationData[o] = 0;
                                            break;
                                        case 255:
                                            for (b.interpolationData.length = I, o = 0; o < I; o++) b.interpolationData[o] = 5;
                                            break;
                                        default:
                                            for (b.interpolationData.push(S), l = 1; l < C; l++) b.interpolationData.push(e.getFloat32())
                                    }
                                }
                                for (b.data = new Float32Array(I), b.dData = new Float32Array(I), b.nextData = new Float32Array(I), h = 0; h < I; h++) b.data[h] = e.getFloat32(), -1e-8 < b.data[h] && b.data[h] < 1e-8 && (b.data[h] = 0);
                                T += b.duration
                            }
                            b.startTime = y.playTime, D.playTime = y.playTime, t._calculateKeyFrame(D, N, I)
                        }
                    }
                }, t
            }(), Bt = function () {
                function t() {
                    this.name = null, this.slotArr = []
                }

                return a(t, "laya.ani.bone.SkinData"), t
            }(), D = function () {
                function at(t, e) {
                    this._targetBone = null, this._bones = null, this._data = null, this.name = null, this.mix = NaN, this.bendDirection = NaN, this.isSpine = !0, this._sp = null, this.isDebug = !1, this._data = t, this._targetBone = e[t.targetBoneIndex], this.isSpine = t.isSpine, null == this._bones && (this._bones = []);
                    for (var i = this._bones.length = 0, a = t.boneIndexs.length; i < a; i++) this._bones.push(e[t.boneIndexs[i]]);
                    this.name = t.name, this.mix = t.mix, this.bendDirection = t.bendDirection
                }

                a(at, "laya.ani.bone.IkConstraint");
                var t = at.prototype;
                return t.apply = function () {
                    switch (this._bones.length) {
                        case 1:
                            this._applyIk1(this._bones[0], this._targetBone.resultMatrix.tx, this._targetBone.resultMatrix.ty, this.mix);
                            break;
                        case 2:
                            this.isSpine ? this._applyIk2(this._bones[0], this._bones[1], this._targetBone.resultMatrix.tx, this._targetBone.resultMatrix.ty, this.bendDirection, this.mix) : this._applyIk3(this._bones[0], this._bones[1], this._targetBone.resultMatrix.tx, this._targetBone.resultMatrix.ty, this.bendDirection, this.mix)
                    }
                }, t._applyIk1 = function (t, e, i, a) {
                    var r = t.parentBone,
                        s = 1 / (r.resultMatrix.a * r.resultMatrix.d - r.resultMatrix.b * r.resultMatrix.c),
                        n = e - r.resultMatrix.tx, h = i - r.resultMatrix.ty,
                        l = (n * r.resultMatrix.d - h * r.resultMatrix.c) * s - t.transform.x,
                        o = (h * r.resultMatrix.a - n * r.resultMatrix.b) * s - t.transform.y,
                        u = Math.atan2(o, l) * at.radDeg - 0 - t.transform.skX;
                    t.transform.scX < 0 && (u += 180), 180 < u ? u -= 360 : u < -180 && (u += 360), t.transform.skX = t.transform.skY = t.transform.skX + u * a, t.update()
                }, t.updatePos = function (t, e) {
                    this._sp && this._sp.pos(t, e)
                }, t._applyIk2 = function (t, e, i, a, r, s) {
                    if (0 != s) {
                        var n = t.resultTransform.x, h = t.resultTransform.y, l = t.transform.scX, o = t.transform.scY,
                            u = e.transform.scX, c = 0, _ = 0, p = 0;
                        p = l < 0 ? (l = -l, c = 180, -1) : (c = 0, 1), o < 0 && (o = -o, p = -p), _ = u < 0 ? (u = -u, 180) : 0;
                        var d = e.resultTransform.x, f = NaN, m = NaN, y = NaN, x = t.resultMatrix.a, g = t.resultMatrix.c,
                            D = t.resultMatrix.b, v = t.resultMatrix.d, M = Math.abs(l - o) <= 1e-4;
                        y = M ? (m = x * d + g * (f = e.resultTransform.y) + t.resultMatrix.tx, D * d + v * f + t.resultMatrix.ty) : (f = 0, m = x * d + t.resultMatrix.tx, D * d + t.resultMatrix.ty), this.isDebug && (this._sp || (this._sp = new st, rt.stage.addChild(this._sp)), this._sp.graphics.clear(), this._sp.graphics.drawCircle(i, a, 15, "#ffff00"), this._sp.graphics.drawCircle(m, y, 15, "#ff00ff")), t.setRotation(Math.atan2(y - t.resultMatrix.ty, m - t.resultMatrix.tx));
                        var I = t.parentBone;
                        x = I.resultMatrix.a, g = I.resultMatrix.c, D = I.resultMatrix.b;
                        var A = 1 / (x * (v = I.resultMatrix.d) - g * D), b = i - I.resultMatrix.tx,
                            N = a - I.resultMatrix.ty, T = (b * v - N * g) * A - n, S = (N * x - b * D) * A - h,
                            C = ((b = m - I.resultMatrix.tx) * v - (N = y - I.resultMatrix.ty) * g) * A - n,
                            F = (N * x - b * D) * A - h, w = Math.sqrt(C * C + F * F), k = e.length * u, P = NaN, U = NaN;
                        if (M) {
                            var B = (T * T + S * S - w * w - (k *= l) * k) / (2 * w * k);
                            B < -1 ? B = -1 : 1 < B && (B = 1), U = Math.acos(B) * r, x = w + k * B, g = k * Math.sin(U), P = Math.atan2(S * x - T * g, T * x + S * g)
                        } else {
                            var R = (x = l * k) * x, L = (g = o * k) * g, V = T * T + S * S, E = Math.atan2(S, T),
                                O = -2 * L * w, K = L - R;
                            if (0 < (v = O * O - 4 * K * (D = L * w * w + R * V - R * L))) {
                                var Y = Math.sqrt(v);
                                O < 0 && (Y = -Y);
                                var X = (Y = -(O + Y) / 2) / K, W = D / Y, G = Math.abs(X) < Math.abs(W) ? X : W;
                                G * G <= V && (N = Math.sqrt(V - G * G) * r, P = E - Math.atan2(N, G), U = Math.atan2(N / o, (G - w) / l))
                            }
                            var z = 0, q = Number.MAX_VALUE, H = 0, Z = 0, Q = 0, $ = 0, j = 0, J = 0;
                            $ < (v = (b = w + x) * b) && (Q = 0, $ = v, j = b), (v = (b = w - x) * b) < q && (z = Math.PI, q = v, H = b);
                            var tt = Math.acos(-x * w / (R - L));
                            (v = (b = x * Math.cos(tt) + w) * b + (N = g * Math.sin(tt)) * N) < q && (z = tt, q = v, H = b, Z = N), $ < v && (Q = tt, $ = v, j = b, J = N), U = V <= (q + $) / 2 ? (P = E - Math.atan2(Z * r, H), z * r) : (P = E - Math.atan2(J * r, j), Q * r)
                        }
                        var et = Math.atan2(f, d) * p, it = t.resultTransform.skX;
                        180 < (P = (P - et) * at.radDeg + c - it) ? P -= 360 : P < -180 && (P += 360), t.resultTransform.x = n, t.resultTransform.y = h, t.resultTransform.skX = t.resultTransform.skY = it + P * s, it = e.resultTransform.skX, 180 < (U = ((U + et) * at.radDeg - 0) * p + _ - (it %= 360)) ? U -= 360 : U < -180 && (U += 360), e.resultTransform.x = d, e.resultTransform.y = f, e.resultTransform.skX = e.resultTransform.skY = e.resultTransform.skY + U * s, t.update()
                    }
                }, t._applyIk3 = function (t, e, i, a, r, s) {
                    if (0 != s) {
                        var n, h, l = e.resultMatrix.a * e.length, o = e.resultMatrix.b * e.length, u = l * l + o * o,
                            c = Math.sqrt(u), _ = t.resultMatrix.tx, p = t.resultMatrix.ty, d = e.resultMatrix.tx,
                            f = e.resultMatrix.ty, m = d - _, y = f - p, x = m * m + y * y, g = Math.sqrt(x),
                            D = (m = i - t.resultMatrix.tx) * m + (y = a - t.resultMatrix.ty) * y, v = Math.sqrt(D);
                        if (c + g <= v || v + c <= g || v + g <= c) {
                            var M = NaN;
                            d = _ + (M = c + g <= v ? 1 : -1) * (i - _) * g / v, f = p + M * (a - p) * g / v
                        } else {
                            var I = (x - u + D) / (2 * D), A = Math.sqrt(x - I * I * D) / v, b = _ + m * I, N = p + y * I,
                                T = -y * A, S = m * A;
                            f = 0 < r ? (d = b - T, N - S) : (d = b + T, N + S)
                        }
                        n = d, h = f, this.isDebug && (this._sp || (this._sp = new st, rt.stage.addChild(this._sp)), this._sp.graphics.clear(), this._sp.graphics.drawCircle(_, p, 15, "#ff00ff"), this._sp.graphics.drawCircle(i, a, 15, "#ffff00"), this._sp.graphics.drawCircle(n, h, 15, "#ff00ff"));
                        var C, F;
                        C = Math.atan2(h - t.resultMatrix.ty, n - t.resultMatrix.tx), t.setRotation(C), (F = at._tempMatrix).identity(), F.rotate(C), F.scale(t.resultMatrix.getScaleX(), t.resultMatrix.getScaleY()), F.translate(t.resultMatrix.tx, t.resultMatrix.ty), F.copyTo(t.resultMatrix), t.updateChild();
                        var w, k;
                        w = Math.atan2(a - h, i - n), e.setRotation(w), (k = at._tempMatrix).identity(), k.rotate(w), k.scale(e.resultMatrix.getScaleX(), e.resultMatrix.getScaleY()), k.translate(n, h), F.copyTo(e.resultMatrix), e.updateChild()
                    }
                }, i(at, ["radDeg", function () {
                    return this.radDeg = 180 / Math.PI
                }, "degRad", function () {
                    return this.degRad = Math.PI / 180
                }, "_tempMatrix", function () {
                    return this._tempMatrix = new Ft
                }]), at
            }(), Rt = function () {
                function t() {
                    this.name = null, this.targetIndex = 0, this.rotateMix = NaN, this.translateMix = NaN, this.scaleMix = NaN, this.shearMix = NaN, this.offsetRotation = NaN, this.offsetX = NaN, this.offsetY = NaN, this.offsetScaleX = NaN, this.offsetScaleY = NaN, this.offsetShearY = NaN, this.boneIndexs = []
                }

                return a(t, "laya.ani.bone.TfConstraintData"), t
            }(), k = function () {
                function t() {
                    this.nodes = null, this.name = null, this.playTime = NaN, this.bone3DMap = null, this.totalKeyframeDatasLength = 0
                }

                return a(t, "laya.ani.AnimationContent"), t
            }(), Lt = (function () {
                function t() {
                }

                a(t, "laya.ani.AnimationState"), t.stopped = 0, t.paused = 1, t.playing = 2
            }(), function () {
                function t() {
                    this.skinName = null, this.deformSlotDataList = []
                }

                return a(t, "laya.ani.bone.DeformAniData"), t
            }()), Vt = function () {
                function t() {
                    this.name = null, this.attachmentName = null, this.type = 0, this.transform = null, this.width = NaN, this.height = NaN, this.texture = null, this.bones = null, this.uvs = null, this.weights = null, this.triangles = null, this.vertices = null, this.lengths = null, this.verLen = 0
                }

                a(t, "laya.ani.bone.SkinSlotDisplayData");
                var e = t.prototype;
                return e.createTexture = function (t) {
                    return this.texture || (this.texture = new wt(t.bitmap, this.uvs), this.uvs[0] > this.uvs[4] && this.uvs[1] > this.uvs[5] ? (this.texture.width = t.height, this.texture.height = t.width, this.texture.offsetX = -t.offsetX, this.texture.offsetY = -t.offsetY, this.texture.sourceWidth = t.sourceHeight, this.texture.sourceHeight = t.sourceWidth) : (this.texture.width = t.width, this.texture.height = t.height, this.texture.offsetX = -t.offsetX, this.texture.offsetY = -t.offsetY, this.texture.sourceWidth = t.sourceWidth, this.texture.sourceHeight = t.sourceHeight)), this.texture
                }, e.destory = function () {
                    this.texture && this.texture.destroy()
                }, t
            }(), Et = function () {
                function t() {
                    this.boneSlot = null, this.slotIndex = -1, this.attachment = null, this.deformData = null, this.frameIndex = 0, this.timeList = [], this.vectices = [], this.tweenKeyList = []
                }

                a(t, "laya.ani.bone.DeformSlotDisplayData");
                var e = t.prototype;
                return e.binarySearch1 = function (t, e) {
                    var i = 0, a = t.length - 2;
                    if (0 == a) return 1;
                    for (var r = a >>> 1; ;) {
                        if (t[Math.floor(r + 1)] <= e ? i = r + 1 : a = r, i == a) return i + 1;
                        r = i + a >>> 1
                    }
                    return 0
                }, e.apply = function (t, e, i) {
                    if (void 0 === i && (i = 1), t += .05, !(this.timeList.length <= 0)) {
                        var a = 0;
                        if (!(t < this.timeList[0])) {
                            var r = this.vectices[0].length, s = [], n = this.binarySearch1(this.timeList, t);
                            if (this.frameIndex = n, t >= this.timeList[this.timeList.length - 1]) {
                                var h = this.vectices[this.vectices.length - 1];
                                if (i < 1) for (a = 0; a < r; a++) s[a] += (h[a] - s[a]) * i; else for (a = 0; a < r; a++) s[a] = h[a];
                                this.deformData = s
                            } else {
                                this.tweenKeyList[this.frameIndex];
                                var l = this.vectices[this.frameIndex - 1], o = this.vectices[this.frameIndex],
                                    u = this.timeList[this.frameIndex - 1], c = this.timeList[this.frameIndex];
                                i = this.tweenKeyList[n - 1] ? (t - u) / (c - u) : 0;
                                var _ = NaN;
                                for (a = 0; a < r; a++) _ = l[a], s[a] = _ + (o[a] - _) * i;
                                this.deformData = s
                            }
                        }
                    }
                }, t
            }(), Ot = function () {
                function D() {
                    this.name = null, this.parent = null, this.attachmentName = null, this.srcDisplayIndex = -1, this.type = "src", this.templet = null, this.currSlotData = null, this.currTexture = null, this.currDisplayData = null, this.displayIndex = -1, this.originalIndex = -1, this._diyTexture = null, this._parentMatrix = null, this._resultMatrix = null, this._replaceDic = {}, this._curDiyUV = null, this._curDiyVS = null, this._skinSprite = null, this.deformData = null, this._mVerticleArr = null, this._preGraphicVerticle = null, this._preGraphicMatrix = null
                }

                a(D, "laya.ani.bone.BoneSlot");
                var t = D.prototype;
                return t.showSlotData = function (t, e) {
                    void 0 === e && (e = !0), this.currSlotData = t, e && (this.displayIndex = this.srcDisplayIndex), this.currDisplayData = null, this.currTexture = null
                }, t.showDisplayByName = function (t) {
                    this.currSlotData && this.showDisplayByIndex(this.currSlotData.getDisplayByName(t))
                }, t.replaceDisplayByName = function (t, e) {
                    if (this.currSlotData) {
                        var i;
                        i = this.currSlotData.getDisplayByName(t);
                        var a;
                        a = this.currSlotData.getDisplayByName(e), this.replaceDisplayByIndex(i, a)
                    }
                }, t.replaceDisplayByIndex = function (t, e) {
                    this.currSlotData && (this._replaceDic[t] = e, this.originalIndex == t && this.showDisplayByIndex(t))
                }, t.showDisplayByIndex = function (t) {
                    if (this.originalIndex = t, null != this._replaceDic[t] && (t = this._replaceDic[t]), this.currSlotData && -1 < t && t < this.currSlotData.displayArr.length) {
                        if (this.displayIndex = t, this.currDisplayData = this.currSlotData.displayArr[t], this.currDisplayData) {
                            var e = this.currDisplayData.name;
                            this.currTexture = this.templet.getTexture(e), this.currTexture && 0 == this.currDisplayData.type && this.currDisplayData.uvs && (this.currTexture = this.currDisplayData.createTexture(this.currTexture))
                        }
                    } else this.displayIndex = -1, this.currDisplayData = null, this.currTexture = null
                }, t.replaceSkin = function (t) {
                    this._diyTexture = t, this._curDiyUV && (this._curDiyUV.length = 0), this.currDisplayData && this._diyTexture == this.currDisplayData.texture && (this._diyTexture = null)
                }, t.setParentMatrix = function (t) {
                    this._parentMatrix = t
                }, t.getSaveVerticle = function (t) {
                    return D.useSameMatrixAndVerticle && this._preGraphicVerticle && D.isSameArr(t, this._preGraphicVerticle) ? t = this._preGraphicVerticle : (t = y.copyArray([], t), this._preGraphicVerticle = t), t
                }, t.getSaveMatrix = function (t) {
                    D.useSameMatrixAndVerticle && this._preGraphicMatrix && D.isSameMatrix(t, this._preGraphicMatrix) ? t = this._preGraphicMatrix : (t = t.clone(), this._preGraphicMatrix = t);
                    return t
                }, t.draw = function (t, e, i, a) {
                    if (void 0 === i && (i = !1), void 0 === a && (a = 1), (null != this._diyTexture || null != this.currTexture) && null != this.currDisplayData || this.currDisplayData && 3 == this.currDisplayData.type) {
                        var r, s = this.currTexture;
                        switch (this._diyTexture && (s = this._diyTexture), this.currDisplayData.type) {
                            case 0:
                                if (t) {
                                    var n = this.getDisplayMatrix();
                                    if (this._parentMatrix) {
                                        var h = !1;
                                        if (n) {
                                            var l;
                                            if (Ft.mul(n, this._parentMatrix, Ft.TEMP), l = i ? (null == this._resultMatrix && (this._resultMatrix = new Ft), this._resultMatrix) : D._tempResultMatrix, this._diyTexture && this.currDisplayData.uvs) {
                                                var o = D._tempMatrix;
                                                o.identity(), this.currDisplayData.uvs[1] > this.currDisplayData.uvs[5] && (o.d = -1), this.currDisplayData.uvs[0] > this.currDisplayData.uvs[4] && this.currDisplayData.uvs[1] > this.currDisplayData.uvs[5] && (h = !0, o.rotate(-Math.PI / 2)), Ft.mul(o, Ft.TEMP, l)
                                            } else Ft.TEMP.copyTo(l);
                                            i || (l = this.getSaveMatrix(l)), l._checkTransform(), h ? t.drawTexture(s, -this.currDisplayData.height / 2, -this.currDisplayData.width / 2, this.currDisplayData.height, this.currDisplayData.width, l, a) : t.drawTexture(s, -this.currDisplayData.width / 2, -this.currDisplayData.height / 2, this.currDisplayData.width, this.currDisplayData.height, l, a)
                                        }
                                    }
                                }
                                break;
                            case 1:
                                if (null == (r = i ? (null == this._skinSprite && (this._skinSprite = D.createSkinMesh()), this._skinSprite) : D.createSkinMesh())) return;
                                var u;
                                if (null == this.currDisplayData.bones) {
                                    var c, _ = this.currDisplayData.weights;
                                    this.deformData && (_ = this.deformData), c = this._diyTexture ? (this._curDiyUV || (this._curDiyUV = []), 0 == this._curDiyUV.length && (this._curDiyUV = v.getRelativeUV(this.currTexture.uv, this.currDisplayData.uvs, this._curDiyUV), this._curDiyUV = v.getAbsoluteUV(this._diyTexture.uv, this._curDiyUV, this._curDiyUV)), this._curDiyUV) : this.currDisplayData.uvs, this._mVerticleArr = _;
                                    this.currDisplayData.triangles.length;
                                    u = this.currDisplayData.triangles, this.deformData && (i || (this._mVerticleArr = this.getSaveVerticle(this._mVerticleArr))), r.init2(s, u, this._mVerticleArr, c);
                                    var p, d = this.getDisplayMatrix();
                                    if (this._parentMatrix) if (d) Ft.mul(d, this._parentMatrix, Ft.TEMP), p = i ? (null == this._resultMatrix && (this._resultMatrix = new Ft), this._resultMatrix) : D._tempResultMatrix, Ft.TEMP.copyTo(p), i || (p = this.getSaveMatrix(p)), r.transform = p
                                } else this.skinMesh(e, r);
                                t.drawSkin(r, a);
                                break;
                            case 2:
                                if (null == (r = i ? (null == this._skinSprite && (this._skinSprite = D.createSkinMesh()), this._skinSprite) : D.createSkinMesh())) return;
                                this.skinMesh(e, r), t.drawSkin(r, a)
                        }
                    }
                }, t.skinMesh = function (t, e) {
                    var i, a = this.currTexture, r = this.currDisplayData.bones;
                    i = this._diyTexture ? (a = this._diyTexture, this._curDiyUV || (this._curDiyUV = []), 0 == this._curDiyUV.length && (this._curDiyUV = v.getRelativeUV(this.currTexture.uv, this.currDisplayData.uvs, this._curDiyUV), this._curDiyUV = v.getAbsoluteUV(this._diyTexture.uv, this._curDiyUV, this._curDiyUV)), this._curDiyUV) : this.currDisplayData.uvs;
                    var s, n, h, l = this.currDisplayData.weights, o = this.currDisplayData.triangles, u = 0, c = 0, _ = 0,
                        p = NaN, d = NaN, f = 0, m = 0, y = 0, x = 0;
                    if (D._tempVerticleArr.length = 0, h = D._tempVerticleArr, this.deformData && 0 < this.deformData.length) {
                        var g = 0;
                        for (y = 0, x = r.length; y < x;) {
                            for (_ = r[y++] + y, c = u = 0; y < _; y++) n = t[r[y]], p = l[f] + this.deformData[g++], d = l[f + 1] + this.deformData[g++], m = l[f + 2], u += (p * n.a + d * n.c + n.tx) * m, c += (p * n.b + d * n.d + n.ty) * m, f += 3;
                            h.push(u, c)
                        }
                    } else for (y = 0, x = r.length; y < x;) {
                        for (_ = r[y++] + y, c = u = 0; y < _; y++) n = t[r[y]], p = l[f], d = l[f + 1], m = l[f + 2], u += (p * n.a + d * n.c + n.tx) * m, c += (p * n.b + d * n.d + n.ty) * m, f += 3;
                        h.push(u, c)
                    }
                    this._mVerticleArr = h, s = o, this._mVerticleArr = this.getSaveVerticle(this._mVerticleArr), e.init2(a, s, this._mVerticleArr, i)
                }, t.drawBonePoint = function (t) {
                    t && this._parentMatrix && t.drawCircle(this._parentMatrix.tx, this._parentMatrix.ty, 5, "#ff0000")
                }, t.getDisplayMatrix = function () {
                    return this.currDisplayData ? this.currDisplayData.transform.getMatrix() : null
                }, t.getMatrix = function () {
                    return this._resultMatrix
                }, t.copy = function () {
                    var t = new D;
                    return t.type = "copy", t.name = this.name, t.attachmentName = this.attachmentName, t.srcDisplayIndex = this.srcDisplayIndex, t.parent = this.parent, t.displayIndex = this.displayIndex, t.templet = this.templet, t.currSlotData = this.currSlotData, t.currTexture = this.currTexture, t.currDisplayData = this.currDisplayData, t
                }, D.createSkinMesh = function () {
                    return new T
                }, D.isSameArr = function (t, e) {
                    if (t.length != e.length) return !1;
                    var i, a = 0;
                    for (i = t.length, a = 0; a < i; a++) if (t[a] != e[a]) return !1;
                    return !0
                }, D.isSameMatrix = function (t, e) {
                    return t.a == e.a && t.b == e.b && t.c == e.c && t.d == e.d && Math.abs(t.tx - e.tx) < 1e-5 && Math.abs(t.ty - e.ty) < 1e-5
                }, D.useSameMatrixAndVerticle = !0, D._tempVerticleArr = [], i(D, ["_tempMatrix", function () {
                    return this._tempMatrix = new Ft
                }, "_tempResultMatrix", function () {
                    return this._tempResultMatrix = new Ft
                }]), D
            }(), A = function () {
                function k(t, e) {
                    this.target = null, this.data = null, this.bones = null, this.position = NaN, this.spacing = NaN, this.rotateMix = NaN, this.translateMix = NaN, this._debugKey = !1, this._spaces = null, this._segments = [], this._curves = [], this.data = t, this.position = t.position, this.spacing = t.spacing, this.rotateMix = t.rotateMix, this.translateMix = t.translateMix, this.bones = [];
                    for (var i = this.data.bones, a = 0, r = i.length; a < r; a++) this.bones.push(e[i[a]])
                }

                a(k, "laya.ani.bone.PathConstraint");
                var t = k.prototype;
                return t.apply = function (t, e) {
                    if (this.target) {
                        var i = this.translateMix, a = this.translateMix, r = 0 < a, s = this.data.spacingMode,
                            n = "length" == s, h = this.data.rotateMode, l = "tangent" == h, o = "chainScale" == h, u = [],
                            c = this.bones.length, _ = l ? c : c + 1, p = [];
                        (this._spaces = p)[0] = this.position;
                        var d = this.spacing;
                        if (o || n) for (var f = 0, m = _ - 1; f < m;) {
                            var y = this.bones[f], x = y.length, g = x * y.resultMatrix.a, D = x * y.resultMatrix.b;
                            x = Math.sqrt(g * g + D * D), o && (u[f] = x), p[++f] = n ? Math.max(0, x + d) : d
                        } else for (f = 1; f < _; f++) p[f] = d;
                        var v = this.computeWorldPositions(this.target, t, e, _, l, "percent" == this.data.positionMode, "percent" == s);
                        if (this._debugKey) {
                            for (f = 0; f < v.length; f++) e.drawCircle(v[f++], v[f++], 5, "#00ff00");
                            var M = [];
                            for (f = 0; f < v.length; f++) M.push(v[f++], v[f++]);
                            e.drawLines(0, 0, M, "#ff0000")
                        }
                        var I = v[0], A = v[1], b = this.data.offsetRotation, N = "chain" == h && 0 == b, T = NaN;
                        for (f = 0, T = 3; f < c; f++, T += 3) {
                            (y = this.bones[f]).resultMatrix.tx += (I - y.resultMatrix.tx) * i, y.resultMatrix.ty += (A - y.resultMatrix.ty) * i;
                            var S = (g = v[T]) - I, C = (D = v[T + 1]) - A;
                            if (o && 0 != (x = u[f])) {
                                var F = (Math.sqrt(S * S + C * C) / x - 1) * a + 1;
                                y.resultMatrix.a *= F, y.resultMatrix.c *= F
                            }
                            if (I = g, A = D, r) {
                                var w = y.resultMatrix.a, k = y.resultMatrix.c, P = y.resultMatrix.b, U = y.resultMatrix.d,
                                    B = NaN, R = NaN, L = NaN;
                                B = l ? v[T - 1] : 0 == p[f + 1] ? v[T + 2] : Math.atan2(C, S), B -= Math.atan2(P, w) - b / 180 * Math.PI, N && (R = Math.cos(B), L = Math.sin(B), I += ((x = y.length) * (R * w - L * P) - S) * a, A += (x * (L * w + R * P) - C) * a), B > Math.PI ? B -= 2 * Math.PI : B < -Math.PI && (B += 2 * Math.PI), B *= a, R = Math.cos(B), L = Math.sin(B), y.resultMatrix.a = R * w - L * P, y.resultMatrix.c = R * k - L * U, y.resultMatrix.b = L * w + R * P, y.resultMatrix.d = L * k + R * U
                            }
                        }
                    }
                }, t.computeWorldVertices2 = function (t, e, i, a, r, s) {
                    var n, h, l = t.currDisplayData.bones, o = t.currDisplayData.weights, u = t.currDisplayData.triangles,
                        c = 0, _ = 0, p = 0, d = 0, f = 0, m = 0, y = 0, x = 0, g = 0, D = 0, v = 0;
                    if (null != l) {
                        for (c = 0; c < i; c += 2) _ += (d = l[_]) + 1, p += d;
                        var M = e;
                        for (f = s, m = 3 * p; f < a; f += 2) {
                            for (x = y = 0, d = l[_++], d += _; _ < d; _++, m += 3) {
                                n = M[l[_]].resultMatrix, g = o[m], D = o[m + 1];
                                var I = o[m + 2];
                                y += (g * n.a + D * n.c + n.tx) * I, x += (g * n.b + D * n.d + n.ty) * I
                            }
                            r[f] = y, r[f + 1] = x
                        }
                    } else {
                        var A, b;
                        if (u || (u = o), t.deformData && (u = t.deformData), A = t.parent, e) for (v = e.length, c = 0; c < v; c++) if (e[c].name == A) {
                            h = e[c];
                            break
                        }
                        h && (b = h.resultMatrix), b || (b = k._tempMt);
                        var N = b.tx, T = b.ty, S = b.a, C = b.b, F = b.c, w = b.d;
                        for (h && (w *= h.d), _ = i, f = s; f < a; _ += 2, f += 2) g = u[_], D = u[_ + 1], r[f] = g * S + D * C + N, r[f + 1] = -(g * F + D * w + T)
                    }
                }, t.computeWorldPositions = function (t, e, i, a, r, s, n) {
                    t.currDisplayData.bones, t.currDisplayData.weights, t.currDisplayData.triangles;
                    var h = [], l = 0, o = t.currDisplayData.verLen, u = this.position, c = this._spaces, _ = [], p = [],
                        d = o / 6, f = -1, m = NaN, y = 0, x = 0, g = NaN, D = NaN, v = NaN, M = NaN;
                    if (d--, o -= 4, this.computeWorldVertices2(t, e, 2, o, h, 0), this._debugKey) for (l = 0; l < h.length;) i.drawCircle(h[l++], h[l++], 10, "#ff0000");
                    _ = h, this._curves.length = d;
                    var I = this._curves, A = _[m = 0], b = _[1], N = 0, T = 0, S = 0, C = 0, F = 0, w = 0, k = NaN,
                        P = NaN, U = NaN, B = NaN, R = NaN, L = NaN, V = NaN, E = NaN, O = 0;
                    for (l = 0, O = 2; l < d; l++, O += 6) N = _[O], T = _[O + 1], S = _[O + 2], C = _[O + 3], R = 2 * (k = .1875 * (A - 2 * N + S)) + (U = .09375 * (3 * (N - S) - A + (F = _[O + 4]))), L = 2 * (P = .1875 * (b - 2 * T + C)) + (B = .09375 * (3 * (T - C) - b + (w = _[O + 5]))), V = .75 * (N - A) + k + .16666667 * U, E = .75 * (T - b) + P + .16666667 * B, m += Math.sqrt(V * V + E * E), V += R, E += L, R += U, L += B, m += Math.sqrt(V * V + E * E), V += R, E += L, m += Math.sqrt(V * V + E * E), V += R + U, E += L + B, m += Math.sqrt(V * V + E * E), I[l] = m, A = F, b = w;
                    if (s && (u *= m), n) for (l = 0; l < a; l++) c[l] *= m;
                    var K = this._segments, Y = 0, X = 0;
                    for (X = x = y = l = 0; l < a; l++, y += 3) if ((g = u += D = c[l]) < 0) this.addBeforePosition(g, _, 0, p, y); else if (m < g) this.addAfterPosition(g - m, _, o - 4, p, y); else {
                        for (; ; x++) if (!((M = I[x]) < g)) {
                            0 == x ? g /= M : g = (g - (v = I[x - 1])) / (M - v);
                            break
                        }
                        if (x != f) {
                            var W = 6 * (f = x);
                            for (A = _[W], b = _[W + 1], N = _[W + 2], T = _[W + 3], S = _[W + 4], C = _[W + 5], R = 2 * (k = .03 * (A - 2 * N + S)) + (U = .006 * (3 * (N - S) - A + (F = _[W + 6]))), L = 2 * (P = .03 * (b - 2 * T + C)) + (B = .006 * (3 * (T - C) - b + (w = _[W + 7]))), V = .3 * (N - A) + k + .16666667 * U, E = .3 * (T - b) + P + .16666667 * B, Y = Math.sqrt(V * V + E * E), K[0] = Y, W = 1; W < 8; W++) V += R, E += L, R += U, L += B, Y += Math.sqrt(V * V + E * E), K[W] = Y;
                            V += R, E += L, Y += Math.sqrt(V * V + E * E), K[8] = Y, V += R + U, E += L + B, Y += Math.sqrt(V * V + E * E), K[9] = Y, X = 0
                        }
                        for (g *= Y; ; X++) if (!((M = K[X]) < g)) {
                            0 == X ? g /= M : g = X + (g - (v = K[X - 1])) / (M - v);
                            break
                        }
                        this.addCurvePosition(.1 * g, A, b, N, T, S, C, F, w, p, y, r || 0 < l && 0 == D)
                    }
                    return p
                }, t.addBeforePosition = function (t, e, i, a, r) {
                    var s = e[i], n = e[i + 1], h = e[i + 2] - s, l = e[i + 3] - n, o = Math.atan2(l, h);
                    a[r] = s + t * Math.cos(o), a[r + 1] = n + t * Math.sin(o), a[r + 2] = o
                }, t.addAfterPosition = function (t, e, i, a, r) {
                    var s = e[i + 2], n = e[i + 3], h = s - e[i], l = n - e[i + 1], o = Math.atan2(l, h);
                    a[r] = s + t * Math.cos(o), a[r + 1] = n + t * Math.sin(o), a[r + 2] = o
                }, t.addCurvePosition = function (t, e, i, a, r, s, n, h, l, o, u, c) {
                    0 == t && (t = 1e-4);
                    var _ = t * t, p = _ * t, d = 1 - t, f = d * d, m = f * d, y = d * t, x = 3 * y, g = d * x, D = x * t,
                        v = e * m + a * g + s * D + h * p, M = i * m + r * g + n * D + l * p;
                    o[u] = v, o[u + 1] = M, o[u + 2] = c ? Math.atan2(M - (i * f + r * y * 2 + n * _), v - (e * f + a * y * 2 + s * _)) : 0
                }, k.NONE = -1, k.BEFORE = -2, k.AFTER = -3, i(k, ["_tempMt", function () {
                    return this._tempMt = new Ft
                }]), k
            }(), Kt = function () {
                function t() {
                    this.skX = 0, this.skY = 0, this.scX = 1, this.scY = 1, this.x = 0, this.y = 0, this.skewX = 0, this.skewY = 0, this.mMatrix = null
                }

                a(t, "laya.ani.bone.Transform");
                var e = t.prototype;
                return e.initData = function (t) {
                    null != t.x && (this.x = t.x), null != t.y && (this.y = t.y), null != t.skX && (this.skX = t.skX), null != t.skY && (this.skY = t.skY), null != t.scX && (this.scX = t.scX), null != t.scY && (this.scY = t.scY)
                }, e.getMatrix = function () {
                    var t;
                    return (t = this.mMatrix ? this.mMatrix : this.mMatrix = new Ft).identity(), t.scale(this.scX, this.scY), (this.skewX || this.skewY) && this.skew(t, this.skewX * Math.PI / 180, this.skewY * Math.PI / 180), t.rotate(this.skX * Math.PI / 180), t.translate(this.x, this.y), t
                }, e.skew = function (t, e, i) {
                    var a = Math.sin(i), r = Math.cos(i), s = Math.sin(e), n = Math.cos(e);
                    return t.setTo(t.a * n - t.b * a, t.a * s + t.b * r, t.c * n - t.d * a, t.c * s + t.d * r, t.tx * n - t.ty * a, t.tx * s + t.ty * r), t
                }, t
            }(), Yt = function () {
                function t() {
                    this.time = NaN, this.drawOrder = []
                }

                return a(t, "laya.ani.bone.DrawOrderData"), t
            }(), b = function () {
                function u() {
                }

                return a(u, "laya.ani.math.BezierLerp"), u.getBezierRate = function (t, e, i, a, r) {
                    var s = u._getBezierParamKey(e, i, a, r), n = 100 * s + t;
                    if (u._bezierResultCache[n]) return u._bezierResultCache[n];
                    var h, l = u._getBezierPoints(e, i, a, r, s), o = 0;
                    for (h = l.length, o = 0; o < h; o += 2) if (t <= l[o]) return u._bezierResultCache[n] = l[o + 1], l[o + 1];
                    return u._bezierResultCache[n] = 1
                }, u._getBezierParamKey = function (t, e, i, a) {
                    return 100 * (100 * (100 * (100 * t + e) + i) + a)
                }, u._getBezierPoints = function (t, e, i, a, r) {
                    return u._bezierPointsCache[r] ? u._bezierPointsCache[r] : (s = [0, 0, t, e, i, a, 1, 1], n = (new h).getBezierPoints(s, 100, 3), u._bezierPointsCache[r] = n);
                    var s, n
                }, u._bezierResultCache = {}, u._bezierPointsCache = {}, u
            }(), Xt = function () {
                function r() {
                    this.name = null, this.root = null, this.parentBone = null, this.length = 10, this.transform = null, this.inheritScale = !0, this.inheritRotation = !0, this.rotation = NaN, this.resultRotation = NaN, this.d = -1, this._tempMatrix = null, this._sprite = null, this.resultTransform = new Kt, this.resultMatrix = new Ft, this._children = []
                }

                a(r, "laya.ani.bone.Bone");
                var t = r.prototype;
                return t.setTempMatrix = function (t) {
                    this._tempMatrix = t;
                    var e, i = 0;
                    for (i = 0, e = this._children.length; i < e; i++) this._children[i].setTempMatrix(this._tempMatrix)
                }, t.update = function (t) {
                    var e;
                    if (this.rotation = this.transform.skX, t) e = this.resultTransform.getMatrix(), Ft.mul(e, t, this.resultMatrix), this.resultRotation = this.rotation; else if (this.resultRotation = this.rotation + this.parentBone.resultRotation, this.parentBone) if (this.inheritRotation && this.inheritScale) e = this.resultTransform.getMatrix(), Ft.mul(e, this.parentBone.resultMatrix, this.resultMatrix); else {
                        var i = this.parentBone, a = NaN, r = NaN, s = NaN, n = this.parentBone.resultMatrix;
                        e = this.resultTransform.getMatrix();
                        var h = n.a * e.tx + n.c * e.ty + n.tx, l = n.b * e.tx + n.d * e.ty + n.ty, o = new Ft;
                        this.inheritRotation ? (a = Math.atan2(i.resultMatrix.b, i.resultMatrix.a), r = Math.cos(a), s = Math.sin(a), o.setTo(r, s, -s, r, 0, 0), Ft.mul(this._tempMatrix, o, Ft.TEMP), Ft.TEMP.copyTo(o), e = this.resultTransform.getMatrix(), Ft.mul(e, o, this.resultMatrix), this.resultTransform.scX * this.resultTransform.scY < 0 && this.resultMatrix.rotate(.5 * Math.PI)) : (this.inheritScale, e = this.resultTransform.getMatrix(), Ft.TEMP.identity(), Ft.TEMP.d = this.d, Ft.mul(e, Ft.TEMP, this.resultMatrix)), this.resultMatrix.tx = h, this.resultMatrix.ty = l
                    } else (e = this.resultTransform.getMatrix()).copyTo(this.resultMatrix);
                    var u, c = 0;
                    for (c = 0, u = this._children.length; c < u; c++) this._children[c].update()
                }, t.updateChild = function () {
                    var t, e = 0;
                    for (e = 0, t = this._children.length; e < t; e++) this._children[e].update()
                }, t.setRotation = function (t) {
                    this._sprite && (this._sprite.rotation = 180 * t / Math.PI)
                }, t.updateDraw = function (t, e) {
                    r.ShowBones && !r.ShowBones[this.name] || (this._sprite || (this._sprite = new st, this._sprite.graphics.drawCircle(0, 0, 5, "#ff0000"), this._sprite.graphics.drawLine(0, 0, this.length, 0, "#00ff00"), this._sprite.graphics.fillText(this.name, 0, 0, "20px Arial", "#00ff00", "center"), rt.stage.addChild(this._sprite)), this._sprite.x = t + this.resultMatrix.tx, this._sprite.y = e + this.resultMatrix.ty);
                    var i, a = 0;
                    for (a = 0, i = this._children.length; a < i; a++) this._children[a].updateDraw(t, e)
                }, t.addChild = function (t) {
                    this._children.push(t), t.parentBone = this
                }, t.findBone = function (t) {
                    if (this.name == t) return this;
                    var e, i, a = 0;
                    for (a = 0, e = this._children.length; a < e; a++) if (i = this._children[a].findBone(t)) return i;
                    return null
                }, t.localToWorld = function (t) {
                    var e = t[0], i = t[1];
                    t[0] = e * this.resultMatrix.a + i * this.resultMatrix.c + this.resultMatrix.tx, t[1] = e * this.resultMatrix.b + i * this.resultMatrix.d + this.resultMatrix.ty
                }, r.ShowBones = {}, r
            }(), Wt = function () {
                function t() {
                    this.name = null, this.intValue = 0, this.floatValue = NaN, this.stringValue = null, this.audioValue = null, this.time = NaN
                }

                return a(t, "laya.ani.bone.EventData"), t
            }(), Gt = function () {
                function t() {
                    this.name = null, this.targetBoneName = null, this.bendDirection = 1, this.mix = 1, this.isSpine = !0, this.targetBoneIndex = -1, this.boneNames = [], this.boneIndexs = []
                }

                return a(t, "laya.ani.bone.IkConstraintData"), t
            }(), N = function (t) {
                function e() {
                    this._destroyed = !1, this._templet = null, this._currentTime = NaN, this._currentFrameTime = NaN, this._playStart = NaN, this._playEnd = NaN, this._playDuration = NaN, this._overallDuration = NaN, this._stopWhenCircleFinish = !1, this._elapsedPlaybackTime = NaN, this._startUpdateLoopCount = NaN, this._currentAnimationClipIndex = 0, this._currentKeyframeIndex = 0, this._paused = !1, this._cacheFrameRate = 0, this._cacheFrameRateInterval = NaN, this._cachePlayRate = NaN, this.isCache = !0, this.playbackRate = 1, this.returnToZeroStopped = !1, e.__super.call(this), this._destroyed = !1, this._currentAnimationClipIndex = -1, this._currentKeyframeIndex = -1, this._currentTime = 0, this._overallDuration = Number.MAX_VALUE, this._stopWhenCircleFinish = !1, this._elapsedPlaybackTime = 0, this._startUpdateLoopCount = -1, this._cachePlayRate = 1, this.cacheFrameRate = 60, this.returnToZeroStopped = !1
                }

                a(e, "laya.ani.AnimationPlayer", r);
                var i = e.prototype;
                return rt.imps(i, {"laya.resource.IDestroy": !0}), i._onTempletLoadedComputeFullKeyframeIndices = function (t, e, i) {
                    this._templet === i && this._cachePlayRate === t && this._cacheFrameRate === e && this._computeFullKeyframeIndices()
                }, i._computeFullKeyframeIndices = function () {
                }, i._onAnimationTempletLoaded = function () {
                    this.destroyed || this._calculatePlayDuration()
                }, i._calculatePlayDuration = function () {
                    if (0 !== this.state) {
                        var t = this._templet.getAniDuration(this._currentAnimationClipIndex);
                        0 === this._playEnd && (this._playEnd = t), this._playEnd > t && (this._playEnd = t), this._playDuration = this._playEnd - this._playStart
                    }
                }, i._setPlayParams = function (t, e) {
                    this._currentTime = t, this._currentKeyframeIndex = Math.floor(this.currentPlayTime / e + .01), this._currentFrameTime = this._currentKeyframeIndex * e
                }, i._setPlayParamsWhenStop = function (t, e) {
                    this._currentTime = t, this._currentKeyframeIndex = Math.floor(t / e + .01), this._currentFrameTime = this._currentKeyframeIndex * e, this._currentAnimationClipIndex = -1
                }, i._update = function (t) {
                    if (-1 !== this._currentAnimationClipIndex && !this._paused && this._templet) {
                        var e = this._cacheFrameRateInterval * this._cachePlayRate, i = 0;
                        this._startUpdateLoopCount !== m.loopCount && (i = t * this.playbackRate, this._elapsedPlaybackTime += i);
                        var a = this.playDuration;
                        if (0 !== this._overallDuration && this._elapsedPlaybackTime >= this._overallDuration || 0 === this._overallDuration && this._elapsedPlaybackTime >= a) return this._setPlayParamsWhenStop(a, e), void this.event("stopped");
                        if (i += this._currentTime, 0 < a) {
                            if (a <= i) return this._stopWhenCircleFinish ? (this._setPlayParamsWhenStop(a, e), this._stopWhenCircleFinish = !1, void this.event("stopped")) : (i %= a, this._setPlayParams(i, e), void this.event("complete"));
                            this._setPlayParams(i, e)
                        } else {
                            if (this._stopWhenCircleFinish) return this._setPlayParamsWhenStop(a, e), this._stopWhenCircleFinish = !1, void this.event("stopped");
                            this._currentTime = this._currentFrameTime = this._currentKeyframeIndex = 0, this.event("complete")
                        }
                    }
                }, i._destroy = function () {
                    this.offAll(), this._templet = null, this._destroyed = !0
                }, i.play = function (t, e, i, a, r) {
                    if (void 0 === t && (t = 0), void 0 === e && (e = 1), void 0 === i && (i = 2147483647), void 0 === a && (a = 0), void 0 === r && (r = 0), !this._templet) throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");
                    if (i < 0 || a < 0 || r < 0) throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");
                    if (0 !== r && r < a) throw new Error("AnimationPlayer:start must less than end.");
                    this._currentTime = 0, this._currentFrameTime = 0, this._elapsedPlaybackTime = 0, this.playbackRate = e, this._overallDuration = i, this._playStart = a, this._playEnd = r, this._paused = !1, this._currentAnimationClipIndex = t, this._currentKeyframeIndex = 0, this._startUpdateLoopCount = m.loopCount, this.event("played"), this._calculatePlayDuration(), this._update(0)
                }, i.playByFrame = function (t, e, i, a, r, s) {
                    void 0 === t && (t = 0), void 0 === e && (e = 1), void 0 === i && (i = 2147483647), void 0 === a && (a = 0), void 0 === r && (r = 0), void 0 === s && (s = 30);
                    var n = 1e3 / s;
                    this.play(t, e, i, a * n, r * n)
                }, i.stop = function (t) {
                    void 0 === t && (t = !0), t ? (this._currentTime = this._currentFrameTime = this._currentKeyframeIndex = 0, this._currentAnimationClipIndex = -1, this.event("stopped")) : this._stopWhenCircleFinish = !0
                }, i.destroy = function () {
                }, s(0, i, "playEnd", function () {
                    return this._playEnd
                }), s(0, i, "templet", function () {
                    return this._templet
                }, function (t) {
                    0 !== this.state && this.stop(!0), this._templet !== t && (this._templet = t, this._computeFullKeyframeIndices())
                }), s(0, i, "playStart", function () {
                    return this._playStart
                }), s(0, i, "playDuration", function () {
                    return this._playDuration
                }), s(0, i, "state", function () {
                    return -1 === this._currentAnimationClipIndex ? 0 : this._paused ? 1 : 2
                }), s(0, i, "currentKeyframeIndex", function () {
                    return this._currentKeyframeIndex
                }), s(0, i, "overallDuration", function () {
                    return this._overallDuration
                }), s(0, i, "currentFrameTime", function () {
                    return this._currentFrameTime
                }), s(0, i, "currentAnimationClipIndex", function () {
                    return this._currentAnimationClipIndex
                }), s(0, i, "currentPlayTime", function () {
                    return this._currentTime + this._playStart
                }), s(0, i, "cachePlayRate", function () {
                    return this._cachePlayRate
                }, function (t) {
                    this._cachePlayRate !== t && (this._cachePlayRate = t, this._templet && this._computeFullKeyframeIndices())
                }), s(0, i, "cacheFrameRate", function () {
                    return this._cacheFrameRate
                }, function (t) {
                    this._cacheFrameRate !== t && (this._cacheFrameRate = t, this._cacheFrameRateInterval = 1e3 / this._cacheFrameRate, this._templet && this._computeFullKeyframeIndices())
                }), s(0, i, "currentTime", null, function (t) {
                    if (-1 !== this._currentAnimationClipIndex && this._templet) {
                        if (t < this._playStart || t > this._playEnd) throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");
                        this._startUpdateLoopCount = m.loopCount;
                        var e = this._cacheFrameRateInterval * this._cachePlayRate;
                        this._currentTime = t, this._currentKeyframeIndex = Math.floor(this.currentPlayTime / e), this._currentFrameTime = this._currentKeyframeIndex * e
                    }
                }), s(0, i, "paused", function () {
                    return this._paused
                }, function (t) {
                    (this._paused = t) && this.event("paused")
                }), s(0, i, "cacheFrameRateInterval", function () {
                    return this._cacheFrameRateInterval
                }), s(0, i, "destroyed", function () {
                    return this._destroyed
                }), e
            }(), R = function (t) {
                function e() {
                    e.__super.call(this)
                }

                return a(e, "laya.ani.GraphicsAni", n), e.prototype.drawSkin = function (t, e) {
                    this.drawTriangles(t.texture, 0, 0, t.vertices, t.uvs, t.indexes, t.transform || Ft.EMPTY, e)
                }, e.create = function () {
                    return e._caches.pop() || new e
                }, e.recycle = function (t) {
                    t.clear(), e._caches.push(t)
                }, e._caches = [], e
            }(), T = function (t) {
                function e() {
                    this.transform = null, e.__super.call(this)
                }

                return a(e, "laya.ani.bone.canvasmesh.SkinMeshForGraphic", x), e.prototype.init2 = function (t, e, i, a) {
                    this.transform && (this.transform = null);
                    var r = e || [0, 1, 3, 3, 1, 2];
                    this.texture = t, this.indexes = new Uint16Array(r), this.vertices = new Float32Array(i), this.uvs = new Float32Array(a)
                }, e
            }(), P = function (t) {
                function D() {
                    this._aniMap = {}, this.unfixedLastAniIndex = -1, this._fullFrames = null, this._boneCurKeyFrm = [], D.__super.call(this), this._anis = new Array
                }

                a(D, "laya.ani.AnimationTemplet", p);
                var e = D.prototype;
                return e.parse = function (t) {
                    var e = new Ct(t);
                    this._aniVersion = e.readUTFString(), I.parse(this, e)
                }, e._calculateKeyFrame = function (t, e, i) {
                    var a = t.keyFrame;
                    a[e] = a[0];
                    for (var r = 0; r < e; r++) for (var s = a[r], n = 0; n < i; n++) s.dData[n] = 0 === s.duration ? 0 : (a[r + 1].data[n] - s.data[n]) / s.duration, s.nextData[n] = a[r + 1].data[n];
                    a.length--
                }, e._onAsynLoaded = function (t, e) {
                    var i = new Ct(t);
                    switch (this._aniVersion = i.readUTFString(), this._aniVersion) {
                        case"LAYAANIMATION:02":
                            M.parse(this, i);
                            break;
                        default:
                            I.parse(this, i)
                    }
                }, e.getAnimationCount = function () {
                    return this._anis.length
                }, e.getAnimation = function (t) {
                    return this._anis[t]
                }, e.getAniDuration = function (t) {
                    return this._anis[t].playTime
                }, e.getNodes = function (t) {
                    return this._anis[t].nodes
                }, e.getNodeIndexWithName = function (t, e) {
                    return this._anis[t].bone3DMap[e]
                }, e.getNodeCount = function (t) {
                    return this._anis[t].nodes.length
                }, e.getTotalkeyframesLength = function (t) {
                    return this._anis[t].totalKeyframeDatasLength
                }, e.getPublicExtData = function () {
                    return this._publicExtData
                }, e.getAnimationDataWithCache = function (t, e, i, a) {
                    var r = e[i];
                    if (r) {
                        var s = r[t];
                        return s ? s[a] : null
                    }
                    return null
                }, e.setAnimationDataWithCache = function (t, e, i, a, r) {
                    var s = e[i] || (e[i] = {});
                    (s[t] || (s[t] = []))[a] = r
                }, e.getNodeKeyFrame = function (t, e, i) {
                    var a = this._boneCurKeyFrm[e], r = t.length;
                    (null == a || r <= a) && (a = this._boneCurKeyFrm[e] = 0);
                    var s = t[a], n = i - s.startTime;
                    if (0 == n || 0 < n && s.duration > n) return a;
                    var h = 0;
                    if (0 < n) {
                        for (i += .01, h = a + 1; h < r; h++) if ((s = t[h]).startTime <= i && s.startTime + s.duration > i) return this._boneCurKeyFrm[e] = h;
                        return r - 1
                    }
                    for (h = 0; h < a; h++) if ((s = t[h]).startTime <= i && s.startTime + s.duration > i) return this._boneCurKeyFrm[e] = h;
                    return a
                }, e.getOriginalData = function (t, e, i, a, r) {
                    var s = this._anis[t].nodes, n = this._boneCurKeyFrm;
                    n.length < s.length && (n.length = s.length);
                    for (var h = 0, l = 0, o = s.length, u = 0; l < o; l++) {
                        var c, _ = s[l], p = _.keyFrame;
                        c = p[this.getNodeKeyFrame(p, l, r)], _.dataOffset = u;
                        var d = r - c.startTime, f = _.lerpType;
                        if (f) switch (f) {
                            case 0:
                            case 1:
                                for (h = 0; h < _.keyframeWidth;) h += _.interpolationMethod[h](_, h, e, u + h, c.data, d, c.dData, c.duration, c.nextData);
                                break;
                            case 2:
                                var m = c.interpolationData, y = m.length, x = 0;
                                for (h = 0; h < y;) {
                                    var g = m[h];
                                    switch (g) {
                                        case 6:
                                        case 7:
                                            h += D.interpolation[g](_, x, e, u + x, c.data, d, c.dData, c.duration, c.nextData, m, h + 1);
                                            break;
                                        default:
                                            h += D.interpolation[g](_, x, e, u + x, c.data, d, c.dData, c.duration, c.nextData)
                                    }
                                    x++
                                }
                        } else for (h = 0; h < _.keyframeWidth;) h += _.interpolationMethod[h](_, h, e, u + h, c.data, d, c.dData, c.duration, c.nextData);
                        u += _.keyframeWidth
                    }
                }, e.getNodesCurrentFrameIndex = function (t, e) {
                    var i = this._anis[t].nodes;
                    t !== this.unfixedLastAniIndex && (this.unfixedCurrentFrameIndexes = new Uint32Array(i.length), this.unfixedCurrentTimes = new Float32Array(i.length), this.unfixedLastAniIndex = t);
                    for (var a = 0, r = i.length; a < r; a++) {
                        var s = i[a];
                        for (e < this.unfixedCurrentTimes[a] && (this.unfixedCurrentFrameIndexes[a] = 0), this.unfixedCurrentTimes[a] = e; this.unfixedCurrentFrameIndexes[a] < s.keyFrame.length && !(s.keyFrame[this.unfixedCurrentFrameIndexes[a]].startTime > this.unfixedCurrentTimes[a]);) this.unfixedCurrentFrameIndexes[a]++;
                        this.unfixedCurrentFrameIndexes[a]--
                    }
                    return this.unfixedCurrentFrameIndexes
                }, e.getOriginalDataUnfixedRate = function (t, e, i) {
                    var a = this._anis[t].nodes;
                    t !== this.unfixedLastAniIndex && (this.unfixedCurrentFrameIndexes = new Uint32Array(a.length), this.unfixedCurrentTimes = new Float32Array(a.length), this.unfixedKeyframes = f(a.length), this.unfixedLastAniIndex = t);
                    for (var r = 0, s = 0, n = a.length, h = 0; s < n; s++) {
                        var l = a[s];
                        for (i < this.unfixedCurrentTimes[s] && (this.unfixedCurrentFrameIndexes[s] = 0), this.unfixedCurrentTimes[s] = i; this.unfixedCurrentFrameIndexes[s] < l.keyFrame.length && !(l.keyFrame[this.unfixedCurrentFrameIndexes[s]].startTime > this.unfixedCurrentTimes[s]);) this.unfixedKeyframes[s] = l.keyFrame[this.unfixedCurrentFrameIndexes[s]], this.unfixedCurrentFrameIndexes[s]++;
                        var o = this.unfixedKeyframes[s];
                        l.dataOffset = h;
                        var u = i - o.startTime;
                        if (l.lerpType) switch (l.lerpType) {
                            case 0:
                            case 1:
                                for (r = 0; r < l.keyframeWidth;) r += l.interpolationMethod[r](l, r, e, h + r, o.data, u, o.dData, o.duration, o.nextData);
                                break;
                            case 2:
                                var c = o.interpolationData, _ = c.length, p = 0;
                                for (r = 0; r < _;) {
                                    var d = c[r];
                                    switch (d) {
                                        case 6:
                                        case 7:
                                            r += D.interpolation[d](l, p, e, h + p, o.data, u, o.dData, o.duration, o.nextData, c, r + 1);
                                            break;
                                        default:
                                            r += D.interpolation[d](l, p, e, h + p, o.data, u, o.dData, o.duration, o.nextData)
                                    }
                                    p++
                                }
                        } else for (r = 0; r < l.keyframeWidth;) r += l.interpolationMethod[r](l, r, e, h + r, o.data, u, o.dData, o.duration, o.nextData);
                        h += l.keyframeWidth
                    }
                }, D.interpolation = [D._LinearInterpolation_0 = function (t, e, i, a, r, s, n, h, l, o) {
                    return i[a] = r[e] + s * n[e], 1
                }, D._QuaternionInterpolation_1 = function (t, e, i, a, r, s, n, h, l, o) {
                    var u = 0 === h ? 0 : s / h;
                    return c.slerpQuaternionArray(r, e, l, e, u, i, a), 4
                }, D._AngleInterpolation_2 = function (t, e, i, a, r, s, n, h, l, o) {
                    return 0
                }, D._RadiansInterpolation_3 = function (t, e, i, a, r, s, n, h, l, o) {
                    return 0
                }, D._Matrix4x4Interpolation_4 = function (t, e, i, a, r, s, n, h, l, o) {
                    for (var u = 0; u < 16; u++, e++) i[a + u] = r[e] + s * n[e];
                    return 16
                }, D._NoInterpolation_5 = function (t, e, i, a, r, s, n, h, l, o) {
                    return i[a] = r[e], 1
                }, D._BezierInterpolation_6 = function (t, e, i, a, r, s, n, h, l, o, u) {
                    return void 0 === u && (u = 0), i[a] = r[e] + (l[e] - r[e]) * b.getBezierRate(s / h, o[u], o[u + 1], o[u + 2], o[u + 3]), 5
                }, D._BezierInterpolation_7 = function (t, e, i, a, r, s, n, h, l, o, u) {
                    return void 0 === u && (u = 0), i[a] = o[u + 4] + o[u + 5] * b.getBezierRate((.001 * s + o[u + 6]) / o[u + 7], o[u], o[u + 1], o[u + 2], o[u + 3]), 9
                }], D
            }(), S = (function (e) {
                function f(t) {
                    this._start = 0, this._Pos = 0, this._data = null, this._curIndex = 0, this._preIndex = 0, this._playIndex = 0, this._playing = !1, this._ended = !0, this._count = 0, this._ids = null, this._loadedImage = {}, this._idOfSprite = null, this._parentMovieClip = null, this._movieClipList = null, this._labels = null, this.basePath = null, this._atlasPath = null, this._url = null, this._isRoot = !1, this._completeHandler = null, this._endFrame = -1, this.interval = 30, this.loop = !1, f.__super.call(this), this._ids = {}, this._idOfSprite = [], this._reset(), this._playing = !1, (this._parentMovieClip = t) ? (this._isRoot = !1, this._movieClipList = t._movieClipList, this._movieClipList.push(this)) : (this._movieClipList = [this], this._isRoot = !0, this._setBitUp(16))
                }

                a(f, "laya.ani.swf.MovieClip", e);
                var t = f.prototype;
                t.destroy = function (t) {
                    void 0 === t && (t = !0), this._clear(), e.prototype.destroy.call(this, t)
                }, t._setDisplay = function (t) {
                    e.prototype._setDisplay.call(this, t), this._isRoot && this._$3__onDisplay(t)
                }, t._$3__onDisplay = function (t) {
                    t ? this.timer.loop(this.interval, this, this.updates, null, !0) : this.timer.clear(this, this.updates)
                }, t.updates = function () {
                    if (!this._parentMovieClip) {
                        var t, e = 0;
                        for (t = this._movieClipList.length, e = 0; e < t; e++) this._movieClipList[e] && this._movieClipList[e]._update()
                    }
                }, t.addLabel = function (t, e) {
                    this._labels || (this._labels = {}), this._labels[e] = t
                }, t.removeLabel = function (t) {
                    if (t) {
                        if (!this._labels) for (var e in this._labels) if (this._labels[e] === t) {
                            delete this._labels[e];
                            break
                        }
                    } else this._labels = null
                }, t._update = function () {
                    if (this._data && this._playing) {
                        if (this._playIndex++, this._playIndex >= this._count) {
                            if (!this.loop) return this._playIndex--, void this.stop();
                            this._playIndex = 0
                        }
                        if (this._parseFrame(this._playIndex), this._labels && this._labels[this._playIndex] && this.event("label", this._labels[this._playIndex]), -1 != this._endFrame && this._endFrame == this._playIndex) {
                            if (this._endFrame = -1, null != this._completeHandler) {
                                var t = this._completeHandler;
                                this._completeHandler = null, t.run()
                            }
                            this.stop()
                        }
                    }
                }, t.stop = function () {
                    this._playing = !1
                }, t.gotoAndStop = function (t) {
                    this.index = t, this.stop()
                }, t._clear = function () {
                    if (this.stop(), this._idOfSprite.length = 0, !this._parentMovieClip) {
                        this.timer.clear(this, this.updates);
                        var t, e = 0;
                        for (t = this._movieClipList.length, e = 0; e < t; e++) this._movieClipList[e] != this && this._movieClipList[e]._clear();
                        this._movieClipList.length = 0
                    }
                    var i;
                    for (i in this._atlasPath && l.clearRes(this._atlasPath), this._loadedImage) this._loadedImage[i] && (l.clearRes(i), this._loadedImage[i] = !1);
                    this.removeChildren(), this.graphics = null, this._parentMovieClip = null
                }, t.play = function (t, e) {
                    void 0 === t && (t = 0), void 0 === e && (e = !0), this.loop = e, this._playing = !0, this._data && this._displayFrame(t)
                }, t._displayFrame = function (t) {
                    void 0 === t && (t = -1), -1 != t && (this._curIndex > t && this._reset(), this._parseFrame(t))
                }, t._reset = function (t) {
                    void 0 === t && (t = !0), t && 1 != this._curIndex && this.removeChildren(), this._preIndex = this._curIndex = -1, this._Pos = this._start
                }, t._parseFrame = function (t) {
                    var e, i, a, r = 0, s = 0, n = 0, h = !1, l = this._idOfSprite, o = this._data;
                    for (this._ended && this._reset(), o.pos = this._Pos, this._ended = !1, this._playIndex = t, this._curIndex > t && t < this._preIndex && (this._reset(!0), o.pos = this._Pos); this._curIndex <= t && !this._ended;) switch (o.getUint16()) {
                        case 12:
                            if (r = o.getUint16(), s = this._ids[o.getUint16()], this._Pos = o.pos, o.pos = s, 0 == (n = o.getUint8())) {
                                var u = o.getUint16();
                                if (!(i = l[r])) {
                                    i = l[r] = new st;
                                    var c = new st;
                                    c.loadImage(this.basePath + u + ".png"), this._loadedImage[this.basePath + u + ".png"] = !0, i.addChild(c), c.size(o.getFloat32(), o.getFloat32());
                                    var _ = o._getMatrix();
                                    c.transform = _
                                }
                                i.alpha = 1
                            } else 1 == n && ((e = l[r]) || (l[r] = e = new f(this), e.interval = this.interval, e._ids = this._ids, e.basePath = this.basePath, e._setData(o, s), e._initState(), e.play(0)), e.alpha = 1);
                            o.pos = this._Pos;
                            break;
                        case 3:
                            var p = l[o.getUint16()];
                            p && (this.addChild(p), p.zOrder = o.getUint16(), h = !0);
                            break;
                        case 4:
                            (p = l[o.getUint16()]) && p.removeSelf();
                            break;
                        case 5:
                            l[o.getUint16()][f._ValueList[o.getUint16()]] = o.getFloat32();
                            break;
                        case 6:
                            l[o.getUint16()].visible = 0 < o.getUint8();
                            break;
                        case 7:
                            var d = (i = l[o.getUint16()]).transform || Ft.create();
                            d.setTo(o.getFloat32(), o.getFloat32(), o.getFloat32(), o.getFloat32(), o.getFloat32(), o.getFloat32()), i.transform = d;
                            break;
                        case 8:
                            l[o.getUint16()].setPos(o.getFloat32(), o.getFloat32());
                            break;
                        case 9:
                            l[o.getUint16()].setSize(o.getFloat32(), o.getFloat32());
                            break;
                        case 10:
                            l[o.getUint16()].alpha = o.getFloat32();
                            break;
                        case 11:
                            l[o.getUint16()].setScale(o.getFloat32(), o.getFloat32());
                            break;
                        case 98:
                            a = o.getString(), this.event(a), "stop" == a && this.stop();
                            break;
                        case 99:
                            this._curIndex = o.getUint16(), h && this.updateZOrder();
                            break;
                        case 100:
                            this._count = this._curIndex + 1, this._ended = !0, this._playing && (this.event("enterframe"), this.event("end"), this.event("complete")), this._reset(!1)
                    }
                    this._playing && !this._ended && this.event("enterframe"), this._Pos = o.pos
                }, t._setData = function (t, e) {
                    this._data = t, this._start = e + 3
                }, t.load = function (t, e, i) {
                    var a;
                    void 0 === e && (e = !1), this._url = t, e && (this._atlasPath = i || t.split(".swf")[0] + ".json"), this.stop(), this._clear(), this._movieClipList = [this], a = [{
                        url: t,
                        type: "arraybuffer"
                    }], this._atlasPath && a.push({
                        url: this._atlasPath,
                        type: "atlas"
                    }), rt.loader.load(a, o.create(this, this._onLoaded))
                }, t._onLoaded = function () {
                    var t;
                    (t = l.getRes(this._url)) ? !this._atlasPath || l.getAtlas(this._atlasPath) ? (this.basePath = this._atlasPath ? l.getAtlas(this._atlasPath).dir : this._url.split(".swf")[0] + "/image/", this._initData(t)) : this.event("error", "Atlas not find") : this.event("error", "file not find")
                }, t._initState = function () {
                    this._reset(), this._ended = !1;
                    var t = this._playing;
                    for (this._playing = !1, this._curIndex = 0; !this._ended;) this._parseFrame(++this._curIndex);
                    this._playing = t
                }, t._initData = function (t) {
                    this._data = new Ct(t);
                    var e = 0, i = this._data.getUint16();
                    for (e = 0; e < i; e++) this._ids[this._data.getInt16()] = this._data.getInt32();
                    this.interval = 1e3 / this._data.getUint16(), this._setData(this._data, this._ids[32767]), this._initState(), this.play(0), this.event("loaded"), this._parentMovieClip || this.timer.loop(this.interval, this, this.updates, null, !0)
                }, t.playTo = function (t, e, i) {
                    this._completeHandler = i, this._endFrame = e, this.play(t, !1)
                }, s(0, t, "index", function () {
                    return this._playIndex
                }, function (t) {
                    this._playIndex = t, this._data && this._displayFrame(this._playIndex), this._labels && this._labels[t] && this.event("label", this._labels[t])
                }), s(0, t, "count", function () {
                    return this._count
                }), s(0, t, "playing", function () {
                    return this._playing
                }), s(0, t, "url", null, function (t) {
                    this.load(t)
                }), f._ValueList = ["x", "y", "width", "height", "scaleX", "scaleY", "rotation", "alpha"]
            }(st), function (e) {
                function i(t, e) {
                    this._templet = null, this._player = null, this._curOriginalData = null, this._boneMatrixArray = [], this._lastTime = 0, this._currAniName = null, this._currAniIndex = -1, this._pause = !0, this._aniClipIndex = -1, this._clipIndex = -1, this._skinIndex = 0, this._skinName = "default", this._aniMode = 0, this._graphicsCache = null, this._boneSlotDic = null, this._bindBoneBoneSlotDic = null, this._boneSlotArray = null, this._index = -1, this._total = -1, this._indexControl = !1, this._aniPath = null, this._texturePath = null, this._complete = null, this._loadAniMode = 0, this._yReverseMatrix = null, this._ikArr = null, this._tfArr = null, this._pathDic = null, this._rootBone = null, this._boneList = null, this._aniSectionDic = null, this._eventIndex = 0, this._drawOrderIndex = 0, this._drawOrder = null, this._lastAniClipIndex = -1, this._lastUpdateAniClipIndex = -1, this._playAudio = !0, this._soundChannelArr = [], i.__super.call(this), void 0 === e && (e = 0), t && this.init(t, e)
                }

                a(i, "laya.ani.bone.Skeleton", e);
                var t = i.prototype;
                return t.init = function (t, e) {
                    void 0 === e && (e = 0);
                    var i, a, r, s = 0, n = 0;
                    if (1 == e) for (this._graphicsCache = [], s = 0, n = t.getAnimationCount(); s < n; s++) this._graphicsCache.push([]);
                    if (this._yReverseMatrix = t.yReverseMatrix, this._aniMode = e, this._templet = t, this._templet._addReference(1), this._player = new N, this._player.cacheFrameRate = t.rate, this._player.templet = t, this._player.play(), this._parseSrcBoneMatrix(), this._boneList = t.mBoneArr, this._rootBone = t.mRootBone, this._aniSectionDic = t.aniSectionDic, 0 < t.ikArr.length) for (this._ikArr = [], s = 0, n = t.ikArr.length; s < n; s++) this._ikArr.push(new D(t.ikArr[s], this._boneList));
                    if (0 < t.pathArr.length) for (null == this._pathDic && (this._pathDic = {}), s = 0, n = t.pathArr.length; s < n; s++) i = t.pathArr[s], a = new A(i, this._boneList), (r = this._boneSlotDic[i.name]) && ((a = new A(i, this._boneList)).target = r), this._pathDic[i.name] = a;
                    if (0 < t.tfArr.length) for (this._tfArr = [], s = 0, n = t.tfArr.length; s < n; s++) this._tfArr.push(new g(t.tfArr[s], this._boneList));
                    if (0 < t.skinDataArray.length) {
                        var h = this._templet.skinDataArray[this._skinIndex];
                        this._skinName = h.name
                    }
                    this._player.on("played", this, this._onPlay), this._player.on("stopped", this, this._onStop), this._player.on("paused", this, this._onPause)
                }, t.load = function (t, e, i) {
                    void 0 === i && (i = 0), this._aniPath = t, this._complete = e, this._loadAniMode = i, rt.loader.load([{
                        url: t,
                        type: "arraybuffer"
                    }], o.create(this, this._onLoaded))
                }, t._onLoaded = function () {
                    var t, e = l.getRes(this._aniPath);
                    null != e && (null == C.TEMPLET_DICTIONARY && (C.TEMPLET_DICTIONARY = {}), (t = C.TEMPLET_DICTIONARY[this._aniPath]) ? t.isParseFail ? this._parseFail() : t.isParserComplete ? this._parseComplete() : (t.on("complete", this, this._parseComplete), t.on("error", this, this._parseFail)) : ((t = new C)._setCreateURL(this._aniPath), (C.TEMPLET_DICTIONARY[this._aniPath] = t).on("complete", this, this._parseComplete), t.on("error", this, this._parseFail), t.isParserComplete = !1, t.parseData(null, e)))
                }, t._parseComplete = function () {
                    var t = C.TEMPLET_DICTIONARY[this._aniPath];
                    t && (this.init(t, this._loadAniMode), this.play(0, !0)), this._complete && this._complete.runWith(this)
                }, t._parseFail = function () {
                }, t._onPlay = function () {
                    this.event("played")
                }, t._onStop = function () {
                    var t, e = this._templet.eventAniArr[this._aniClipIndex];
                    if (e && this._eventIndex < e.length) for (; this._eventIndex < e.length; this._eventIndex++) (t = e[this._eventIndex]).time >= this._player.playStart && t.time <= this._player.playEnd && this.event("label", t);
                    this._drawOrder = null, this.event("stopped")
                }, t._onPause = function () {
                    this.event("paused")
                }, t._parseSrcBoneMatrix = function () {
                    var t = 0, e = 0;
                    for (e = this._templet.srcBoneMatrixArr.length, t = 0; t < e; t++) this._boneMatrixArray.push(new Ft);
                    if (0 == this._aniMode) this._boneSlotDic = this._templet.boneSlotDic, this._bindBoneBoneSlotDic = this._templet.bindBoneBoneSlotDic, this._boneSlotArray = this._templet.boneSlotArray; else {
                        null == this._boneSlotDic && (this._boneSlotDic = {}), null == this._bindBoneBoneSlotDic && (this._bindBoneBoneSlotDic = {}), null == this._boneSlotArray && (this._boneSlotArray = []);
                        var i, a, r = this._templet.boneSlotArray;
                        for (t = 0, e = r.length; t < e; t++) i = r[t], null == (a = this._bindBoneBoneSlotDic[i.parent]) && (this._bindBoneBoneSlotDic[i.parent] = a = []), this._boneSlotDic[i.name] = i = i.copy(), a.push(i), this._boneSlotArray.push(i)
                    }
                }, t._emitMissedEvents = function (t, e, i) {
                    void 0 === i && (i = 0);
                    var a = this._templet.eventAniArr[this._player.currentAnimationClipIndex];
                    if (a) {
                        var r, s, n = 0;
                        for (r = a.length, n = i; n < r; n++) (s = a[n]).time >= this._player.playStart && s.time <= this._player.playEnd && this.event("label", s)
                    }
                }, t._update = function (t) {
                    if (void 0 === t && (t = !0), !(this._pause || t && this._indexControl)) {
                        var e = this.timer.currTimer, i = this._player.currentKeyframeIndex, a = e - this._lastTime;
                        if (t ? this._player._update(a) : i = -1, this._lastTime = e, this._player && (this._index = this._clipIndex = this._player.currentKeyframeIndex, !(this._index < 0 || 0 < a && this._clipIndex == i && this._lastUpdateAniClipIndex == this._aniClipIndex))) {
                            this._lastUpdateAniClipIndex = this._aniClipIndex, i > this._clipIndex && 0 != this._eventIndex && (this._emitMissedEvents(this._player.playStart, this._player.playEnd, this._eventIndex), this._eventIndex = 0);
                            var r, s, n = this._templet.eventAniArr[this._aniClipIndex];
                            if (n && this._eventIndex < n.length) {
                                var h = n[this._eventIndex];
                                h.time >= this._player.playStart && h.time <= this._player.playEnd ? this._player.currentPlayTime >= h.time && (this.event("label", h), this._eventIndex++, this._playAudio && h.audioValue && "null" !== h.audioValue && (r = d.playSound(this._player.templet._path + h.audioValue, 1, o.create(this, this._onAniSoundStoped)), d.playbackRate = this._player.playbackRate, r && this._soundChannelArr.push(r))) : h.time < this._player.playStart && this._playAudio && h.audioValue && "null" !== h.audioValue && .1 < this._player.playEnd - this._player.currentPlayTime ? (this._eventIndex++, r = d.playSound(this._player.templet._path + h.audioValue, 1, o.create(this, this._onAniSoundStoped), null, (this._player.currentPlayTime - h.time) / 1e3), d.playbackRate = this._player.playbackRate, r && this._soundChannelArr.push(r)) : this._eventIndex++
                            }
                            0 == this._aniMode ? (s = this._templet.getGrahicsDataWithCache(this._aniClipIndex, this._clipIndex) || this._createGraphics()) && this.graphics != s && (this.graphics = s) : 1 == this._aniMode ? (s = this._getGrahicsDataWithCache(this._aniClipIndex, this._clipIndex) || this._createGraphics()) && this.graphics != s && (this.graphics = s) : this._createGraphics()
                        }
                    }
                }, t._onAniSoundStoped = function (t) {
                    for (var e, i = this._soundChannelArr.length, a = 0; a < i; a++) ((e = this._soundChannelArr[a]).isStopped || t) && (!e.isStopped && e.stop(), this._soundChannelArr.splice(a, 1), i--, a--)
                }, t._createGraphics = function (t) {
                    void 0 === t && (t = -1), -1 == t && (t = this._clipIndex);
                    var e, i = t * this._player.cacheFrameRateInterval,
                        a = this._templet.drawOrderAniArr[this._aniClipIndex];
                    if (a && 0 < a.length) for (this._drawOrderIndex = 0, e = a[this._drawOrderIndex]; i >= e.time && (this._drawOrder = e.drawOrder, this._drawOrderIndex++, !(this._drawOrderIndex >= a.length));) e = a[this._drawOrderIndex];
                    0 == this._aniMode || 1 == this._aniMode ? this.graphics = R.create() : this.graphics instanceof laya.ani.GraphicsAni ? this.graphics.clear() : this.graphics = R.create();
                    var r = this.graphics, s = this._templet.getNodes(this._aniClipIndex), n = 0 == this._player.state;
                    this._templet.getOriginalData(this._aniClipIndex, this._curOriginalData, null, t, n ? i + this._player.cacheFrameRateInterval : i);
                    var h, l, o, u, c = this._aniSectionDic[this._aniClipIndex], _ = 0, p = 0, d = 0, f = 0, m = 0,
                        y = this._templet.srcBoneMatrixArr.length, x = this._curOriginalData;
                    for (m = c[p = 0]; p < y; p++) {
                        var g = (u = this._boneList[p]).resultTransform;
                        o = this._templet.srcBoneMatrixArr[p], g.scX = o.scX * x[_++], g.skX = o.skX + x[_++], g.skY = o.skY + x[_++], g.scY = o.scY * x[_++], g.x = o.x + x[_++], g.y = o.y + x[_++], 8 === this._templet.tMatrixDataLen && (g.skewX = o.skewX + x[_++], g.skewY = o.skewY + x[_++])
                    }
                    var D, v = {}, M = {};
                    for (m += c[1]; p < m; p++) v[(D = s[p]).name] = x[_++], M[D.name] = x[_++], _ += 4;
                    var I, A, b = {}, N = {};
                    for (m += c[2]; p < m; p++) b[(D = s[p]).name] = x[_++], N[D.name] = x[_++], _ += 4;
                    if (this._pathDic) for (m += c[3]; p < m; p++) {
                        if (D = s[p], I = this._pathDic[D.name]) switch (new Ct(D.extenData).getByte()) {
                            case 1:
                                I.position = x[_++];
                                break;
                            case 2:
                                I.spacing = x[_++];
                                break;
                            case 3:
                                I.rotateMix = x[_++], I.translateMix = x[_++]
                        }
                    }
                    if (this._rootBone.update(this._yReverseMatrix || Ft.TEMP.identity()), this._ikArr) for (p = 0, m = this._ikArr.length; p < m; p++) A = this._ikArr[p], b.hasOwnProperty(A.name) && (A.bendDirection = b[A.name]), N.hasOwnProperty(A.name) && (A.mix = N[A.name]), A.apply();
                    if (this._pathDic) for (var T in this._pathDic) (I = this._pathDic[T]).apply(this._boneList, r);
                    if (this._tfArr) for (p = 0, f = this._tfArr.length; p < f; p++) this._tfArr[p].apply();
                    for (p = 0, f = this._boneList.length; p < f; p++) if (u = this._boneList[p], l = this._bindBoneBoneSlotDic[u.name], u.resultMatrix.copyTo(this._boneMatrixArray[p]), l) for (d = 0, m = l.length; d < m; d++) (h = l[d]) && h.setParentMatrix(u.resultMatrix);
                    var S, C, F, w, k = {}, P = this._templet.deformAniArr;
                    if (P && 0 < P.length) {
                        if (this._lastAniClipIndex != this._aniClipIndex) for (this._lastAniClipIndex = this._aniClipIndex, p = 0, m = this._boneSlotArray.length; p < m; p++) (h = this._boneSlotArray[p]).deformData = null;
                        var U, B = P[this._aniClipIndex];
                        for (U in S = B.default, this._setDeform(S, k, this._boneSlotArray, i), B) "default" != U && U != this._skinName && (S = B[U], this._setDeform(S, k, this._boneSlotArray, i));
                        S = B[this._skinName], this._setDeform(S, k, this._boneSlotArray, i)
                    }
                    if (this._drawOrder) for (p = 0, m = this._drawOrder.length; p < m; p++) C = v[(h = this._boneSlotArray[this._drawOrder[p]]).name], F = M[h.name], isNaN(F), isNaN(C) || -2 == C || (this._templet.attachmentNames ? h.showDisplayByName(this._templet.attachmentNames[C]) : h.showDisplayByIndex(C)), k[this._drawOrder[p]] ? (w = k[this._drawOrder[p]], h.currDisplayData && w[h.currDisplayData.attachmentName] ? h.deformData = w[h.currDisplayData.attachmentName] : h.deformData = null) : h.deformData = null, isNaN(F) ? h.draw(r, this._boneMatrixArray, 2 == this._aniMode) : h.draw(r, this._boneMatrixArray, 2 == this._aniMode, F), isNaN(F); else for (p = 0, m = this._boneSlotArray.length; p < m; p++) C = v[(h = this._boneSlotArray[p]).name], F = M[h.name], isNaN(F), isNaN(C) || -2 == C || (this._templet.attachmentNames ? h.showDisplayByName(this._templet.attachmentNames[C]) : h.showDisplayByIndex(C)), k[p] ? (w = k[p], h.currDisplayData && w[h.currDisplayData.attachmentName] ? h.deformData = w[h.currDisplayData.attachmentName] : h.deformData = null) : h.deformData = null, isNaN(F) ? h.draw(r, this._boneMatrixArray, 2 == this._aniMode) : h.draw(r, this._boneMatrixArray, 2 == this._aniMode, F), isNaN(F);
                    return 0 == this._aniMode ? (this._templet.setGrahicsDataWithCache(this._aniClipIndex, t, r), this._checkIsAllParsed(this._aniClipIndex)) : 1 == this._aniMode && this._setGrahicsDataWithCache(this._aniClipIndex, t, r), r
                }, t._checkIsAllParsed = function (t) {
                    var e, i = 0;
                    for (e = Math.floor(.01 + this._templet.getAniDuration(t) / 1e3 * this._player.cacheFrameRate), i = 0; i < e; i++) if (!this._templet.getGrahicsDataWithCache(t, i)) return;
                    this._templet.getGrahicsDataWithCache(t, e) ? this._templet.deleteAniData(t) : this._createGraphics(e)
                }, t._setDeform = function (t, e, i, a) {
                    if (t) {
                        var r, s, n, h = 0, l = 0, o = 0;
                        if (t) for (h = 0, l = t.deformSlotDataList.length; h < l; h++) for (r = t.deformSlotDataList[h], o = 0; o < r.deformSlotDisplayList.length; o++) n = i[(s = r.deformSlotDisplayList[o]).slotIndex], s.apply(a, n), e[s.slotIndex] || (e[s.slotIndex] = {}), e[s.slotIndex][s.attachment] = s.deformData
                    }
                }, t.getAnimNum = function () {
                    return this._templet.getAnimationCount()
                }, t.getAniNameByIndex = function (t) {
                    return this._templet.getAniNameByIndex(t)
                }, t.getSlotByName = function (t) {
                    return this._boneSlotDic[t]
                }, t.showSkinByName = function (t, e) {
                    void 0 === e && (e = !0), this.showSkinByIndex(this._templet.getSkinIndexByName(t), e)
                }, t.showSkinByIndex = function (t, e) {
                    void 0 === e && (e = !0);
                    for (var i = 0; i < this._boneSlotArray.length; i++) this._boneSlotArray[i].showSlotData(null, e);
                    if (this._templet.showSkinByIndex(this._boneSlotDic, t, e)) {
                        var a = this._templet.skinDataArray[t];
                        this._skinIndex = t, this._skinName = a.name
                    }
                    this._clearCache()
                }, t.showSlotSkinByIndex = function (t, e) {
                    if (0 != this._aniMode) {
                        var i = this.getSlotByName(t);
                        i && i.showDisplayByIndex(e), this._clearCache()
                    }
                }, t.showSlotSkinByName = function (t, e) {
                    if (0 != this._aniMode) {
                        var i = this.getSlotByName(t);
                        i && i.showDisplayByName(e), this._clearCache()
                    }
                }, t.replaceSlotSkinName = function (t, e, i) {
                    if (0 != this._aniMode) {
                        var a = this.getSlotByName(t);
                        a && a.replaceDisplayByName(e, i), this._clearCache()
                    }
                }, t.replaceSlotSkinByIndex = function (t, e, i) {
                    if (0 != this._aniMode) {
                        var a = this.getSlotByName(t);
                        a && a.replaceDisplayByIndex(e, i), this._clearCache()
                    }
                }, t.setSlotSkin = function (t, e) {
                    if (0 != this._aniMode) {
                        var i = this.getSlotByName(t);
                        i && i.replaceSkin(e), this._clearCache()
                    }
                }, t._clearCache = function () {
                    if (1 == this._aniMode) for (var t = 0, e = this._graphicsCache.length; t < e; t++) {
                        for (var i = 0, a = this._graphicsCache[t].length; i < a; i++) {
                            var r = this._graphicsCache[t][i];
                            r && r != this.graphics && R.recycle(r)
                        }
                        this._graphicsCache[t].length = 0
                    }
                }, t.play = function (t, e, i, a, r, s, n) {
                    void 0 === i && (i = !0), void 0 === a && (a = 0), void 0 === r && (r = 0), void 0 === s && (s = !0), void 0 === n && (n = !0), this._playAudio = n, this._indexControl = !1;
                    var h = -1, l = NaN;
                    if (l = e ? 2147483647 : 0, "string" == typeof t) for (var o = 0, u = this._templet.getAnimationCount(); o < u; o++) {
                        var c = this._templet.getAnimation(o);
                        if (c && t == c.name) {
                            h = o;
                            break
                        }
                    } else h = t;
                    -1 < h && h < this.getAnimNum() && (this._aniClipIndex = h, (i || this._pause || this._currAniIndex != h) && (this._currAniIndex = h, this._curOriginalData = new Float32Array(this._templet.getTotalkeyframesLength(h)), this._drawOrder = null, this._eventIndex = 0, this._player.play(h, this._player.playbackRate, l, a, r), s && this._templet.showSkinByIndex(this._boneSlotDic, this._skinIndex), this._pause && (this._pause = !1, this._lastTime = _.now(), this.timer.frameLoop(1, this, this._update, null, !0)), this._update()))
                }, t.stop = function () {
                    this._pause || (this._pause = !0, this._player && this._player.stop(!0), 0 < this._soundChannelArr.length && this._onAniSoundStoped(!0), this.timer.clear(this, this._update))
                }, t.playbackRate = function (t) {
                    this._player && (this._player.playbackRate = t)
                }, t.paused = function () {
                    if (!this._pause) {
                        if (this._pause = !0, this._player && (this._player.paused = !0), 0 < this._soundChannelArr.length) for (var t, e = this._soundChannelArr.length, i = 0; i < e; i++) (t = this._soundChannelArr[i]).isStopped || t.pause();
                        this.timer.clear(this, this._update)
                    }
                }, t.resume = function () {
                    if (this._indexControl = !1, this._pause) {
                        if (this._pause = !1, this._player && (this._player.paused = !1), 0 < this._soundChannelArr.length) for (var t, e = this._soundChannelArr.length, i = 0; i < e; i++) (t = this._soundChannelArr[i]).audioBuffer && t.resume();
                        this._lastTime = _.now(), this.timer.frameLoop(1, this, this._update, null, !0)
                    }
                }, t._getGrahicsDataWithCache = function (t, e) {
                    return this._graphicsCache[t][e]
                }, t._setGrahicsDataWithCache = function (t, e, i) {
                    this._graphicsCache[t][e] = i
                }, t.destroy = function (t) {
                    void 0 === t && (t = !0), e.prototype.destroy.call(this, t), this._templet._removeReference(1), this._templet = null, this._player && this._player.offAll(), this._player = null, this._curOriginalData = null, this._boneMatrixArray.length = 0, this._lastTime = 0, this.timer.clear(this, this._update), 0 < this._soundChannelArr.length && this._onAniSoundStoped(!0)
                }, s(0, t, "url", function () {
                    return this._aniPath
                }, function (t) {
                    this.load(t)
                }), s(0, t, "index", function () {
                    return this._index
                }, function (t) {
                    this.player && (this._index = t, this._player.currentTime = 1e3 * this._index / this._player.cacheFrameRate, this._indexControl = !0, this._update(!1))
                }), s(0, t, "total", function () {
                    return this._templet && this._player ? this._total = Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex) / 1e3 * this._player.cacheFrameRate) : this._total = -1, this._total
                }), s(0, t, "templet", function () {
                    return this._templet
                }), s(0, t, "player", function () {
                    return this._player
                }), i.useSimpleMeshInCanvas = !1, i
            }(st)), C = function (e) {
                function r() {
                    this._mainTexture = null, this._textureJson = null, this._graphicsCache = [], this.srcBoneMatrixArr = [], this.ikArr = [], this.tfArr = [], this.pathArr = [], this.boneSlotDic = {}, this.bindBoneBoneSlotDic = {}, this.boneSlotArray = [], this.skinDataArray = [], this.skinDic = {}, this.subTextureDic = {}, this.isParseFail = !1, this.yReverseMatrix = null, this.drawOrderAniArr = [], this.eventAniArr = [], this.attachmentNames = null, this.deformAniArr = [], this._isParseAudio = !1, this._isDestroyed = !1, this._rate = 30, this.isParserComplete = !1, this.aniSectionDic = {}, this._skBufferUrl = null, this._textureDic = {}, this._loadList = null, this._path = null, this._relativeUrl = null, this.tMatrixDataLen = 0, this.mRootBone = null, r.__super.call(this), this.skinSlotDisplayDataArr = [], this.mBoneArr = []
                }

                a(r, "laya.ani.bone.Templet", e);
                var t = r.prototype;
                return t.loadAni = function (t) {
                    this._skBufferUrl = t, rt.loader.load(t, o.create(this, this.onComplete), null, "arraybuffer")
                }, t.onComplete = function (t) {
                    if (this._isDestroyed) this.destroy(); else {
                        var e = l.getRes(this._skBufferUrl);
                        e ? (this._path = this._skBufferUrl.slice(0, this._skBufferUrl.lastIndexOf("/")) + "/", this.parseData(null, e)) : this.event("error", "load failed:" + this._skBufferUrl)
                    }
                }, t.parseData = function (t, e, i) {
                    if (void 0 === i && (i = 30), !this._path) {
                        var a = this._relativeUrl || this.url;
                        if (a) {
                            var r = a.lastIndexOf("/");
                            this._path = 0 < r ? a.slice(0, r) + "/" : ""
                        }
                    }
                    this._mainTexture = t, this._rate = i, this.parse(e)
                }, t.buildArmature = function (t) {
                    return void 0 === t && (t = 0), new S(this, t)
                }, t.parse = function (t) {
                    e.prototype.parse.call(this, t), this.event("loaded", this), this._aniVersion === r.LAYA_ANIMATION_VISION ? this._isParseAudio = !0 : this._aniVersion, this._mainTexture ? this._parsePublicExtData() : this._parseTexturePath()
                }, t._parseTexturePath = function () {
                    if (this._isDestroyed) this.destroy(); else {
                        var t = 0;
                        this._loadList = [];
                        var e, i = new Ct(this.getPublicExtData()), a = 0, r = 0, s = 0, n = i.getInt32(),
                            h = i.readUTFString(), l = h.split("\n");
                        for (t = 0; t < n; t++) e = this._path + l[2 * t], h = l[2 * t + 1], i.getFloat32(), i.getFloat32(), a = i.getFloat32(), r = i.getFloat32(), s = i.getFloat32(), isNaN(s) ? 0 : s, s = i.getFloat32(), isNaN(s) ? 0 : s, s = i.getFloat32(), isNaN(s) ? a : s, s = i.getFloat32(), isNaN(s) ? r : s, -1 == this._loadList.indexOf(e) && this._loadList.push(e);
                        rt.loader.load(this._loadList, o.create(this, this._textureComplete))
                    }
                }, t._textureComplete = function () {
                    for (var t, e = 0, i = this._loadList.length; e < i; e++) t = this._loadList[e], this._textureDic[t] = l.getRes(t);
                    this._parsePublicExtData()
                }, t._parsePublicExtData = function () {
                    var t = 0, e = 0, i = 0, a = 0, r = 0;
                    for (t = 0, r = this.getAnimationCount(); t < r; t++) this._graphicsCache.push([]);
                    var s;
                    s = "Dragon" != this._aniClassName;
                    var n, h, l = new Ct(this.getPublicExtData()), o = 0, u = 0, c = 0, _ = 0, p = 0, d = 0, f = 0, m = 0,
                        y = 0, x = l.getInt32(), g = l.readUTFString(), D = g.split("\n");
                    for (t = 0; t < x; t++) {
                        if (n = this._mainTexture, h = this._path + D[2 * t], g = D[2 * t + 1], null == this._mainTexture && (n = this._textureDic[h]), !n) return this.event("error", this), void (this.isParseFail = !0);
                        o = l.getFloat32(), u = l.getFloat32(), c = l.getFloat32(), _ = l.getFloat32(), y = l.getFloat32(), p = isNaN(y) ? 0 : y, y = l.getFloat32(), d = isNaN(y) ? 0 : y, y = l.getFloat32(), f = isNaN(y) ? c : y, y = l.getFloat32(), m = isNaN(y) ? _ : y, this.subTextureDic[g] = wt.create(n, o, u, c, _, -p, -d, f, m)
                    }
                    this._mainTexture = n;
                    var v, M, I, A, b, N = l.getUint16();
                    for (t = 0; t < N; t++) (v = []).push(l.getUint16()), v.push(l.getUint16()), v.push(l.getUint16()), v.push(l.getUint16()), this.aniSectionDic[t] = v;
                    var T, S = l.getInt16(), C = {};
                    for (t = 0; t < S; t++) M = new Xt, 0 == t ? T = M : M.root = T, M.d = s ? -1 : 1, A = l.readUTFString(), b = l.readUTFString(), M.length = l.getFloat32(), 1 == l.getByte() && (M.inheritRotation = !1), 1 == l.getByte() && (M.inheritScale = !1), M.name = A, b && ((I = C[b]) ? I.addChild(M) : this.mRootBone = M), C[A] = M, this.mBoneArr.push(M);
                    this.tMatrixDataLen = l.getUint16();
                    var F, w, k = l.getUint16(), P = Math.floor(k / this.tMatrixDataLen), U = this.srcBoneMatrixArr;
                    for (t = 0; t < P; t++) (F = new Kt).scX = l.getFloat32(), F.skX = l.getFloat32(), F.skY = l.getFloat32(), F.scY = l.getFloat32(), F.x = l.getFloat32(), F.y = l.getFloat32(), 8 === this.tMatrixDataLen && (F.skewX = l.getFloat32(), F.skewY = l.getFloat32()), U.push(F), (M = this.mBoneArr[t]).transform = F;
                    var B, R = l.getUint16(), L = 0;
                    for (t = 0; t < R; t++) {
                        for (w = new Gt, L = l.getUint16(), e = 0; e < L; e++) w.boneNames.push(l.readUTFString()), w.boneIndexs.push(l.getInt16());
                        w.name = l.readUTFString(), w.targetBoneName = l.readUTFString(), w.targetBoneIndex = l.getInt16(), w.bendDirection = l.getFloat32(), w.mix = l.getFloat32(), w.isSpine = s, this.ikArr.push(w)
                    }
                    var V, E = l.getUint16(), O = 0;
                    for (t = 0; t < E; t++) {
                        for (B = new Rt, O = l.getUint16(), e = 0; e < O; e++) B.boneIndexs.push(l.getInt16());
                        B.name = l.getUTFString(), B.targetIndex = l.getInt16(), B.rotateMix = l.getFloat32(), B.translateMix = l.getFloat32(), B.scaleMix = l.getFloat32(), B.shearMix = l.getFloat32(), B.offsetRotation = l.getFloat32(), B.offsetX = l.getFloat32(), B.offsetY = l.getFloat32(), B.offsetScaleX = l.getFloat32(), B.offsetScaleY = l.getFloat32(), B.offsetShearY = l.getFloat32(), this.tfArr.push(B)
                    }
                    var K = l.getUint16(), Y = 0;
                    for (t = 0; t < K; t++) {
                        for ((V = new Pt).name = l.readUTFString(), Y = l.getUint16(), e = 0; e < Y; e++) V.bones.push(l.getInt16());
                        V.target = l.readUTFString(), V.positionMode = l.readUTFString(), V.spacingMode = l.readUTFString(), V.rotateMode = l.readUTFString(), V.offsetRotation = l.getFloat32(), V.position = l.getFloat32(), V.spacing = l.getFloat32(), V.rotateMix = l.getFloat32(), V.translateMix = l.getFloat32(), this.pathArr.push(V)
                    }
                    var X, W, G, z, q, H = 0, Z = 0, Q = 0, $ = NaN, j = 0, J = l.getInt16();
                    for (t = 0; t < J; t++) {
                        var tt = l.getUint8(), et = {};
                        this.deformAniArr.push(et);
                        for (var it = 0; it < tt; it++) for ((X = new Lt).skinName = l.getUTFString(), et[X.skinName] = X, H = l.getInt16(), e = 0; e < H; e++) for (W = new Ut, X.deformSlotDataList.push(W), Z = l.getInt16(), i = 0; i < Z; i++) for (G = new Et, W.deformSlotDisplayList.push(G), G.slotIndex = l.getInt16(), G.attachment = l.getUTFString(), Q = l.getInt16(), a = 0; a < Q; a++) for (1 == l.getByte() ? G.tweenKeyList.push(!0) : G.tweenKeyList.push(!1), $ = l.getFloat32(), G.timeList.push($), z = [], G.vectices.push(z), j = l.getInt16(), r = 0; r < j; r++) z.push(l.getFloat32())
                    }
                    var at, rt, st = l.getInt16(), nt = 0, ht = 0;
                    for (t = 0; t < st; t++) {
                        for (nt = l.getInt16(), q = [], e = 0; e < nt; e++) {
                            for ((at = new Yt).time = l.getFloat32(), ht = l.getInt16(), i = 0; i < ht; i++) at.drawOrder.push(l.getInt16());
                            q.push(at)
                        }
                        this.drawOrderAniArr.push(q)
                    }
                    var lt, ot = l.getInt16(), ut = 0;
                    for (t = 0; t < ot; t++) {
                        for (ut = l.getInt16(), rt = [], e = 0; e < ut; e++) (lt = new Wt).name = l.getUTFString(), this._isParseAudio && (lt.audioValue = l.getUTFString()), lt.intValue = l.getInt32(), lt.floatValue = l.getFloat32(), lt.stringValue = l.getUTFString(), lt.time = l.getFloat32(), rt.push(lt);
                        this.eventAniArr.push(rt)
                    }
                    var ct = l.getInt16();
                    if (0 < ct) for (this.attachmentNames = [], t = 0; t < ct; t++) this.attachmentNames.push(l.getUTFString());
                    var _t, pt, dt = l.getInt16();
                    for (t = 0; t < dt; t++) (_t = new Ot).name = l.readUTFString(), _t.parent = l.readUTFString(), _t.attachmentName = l.readUTFString(), _t.srcDisplayIndex = _t.displayIndex = l.getInt16(), (_t.templet = this).boneSlotDic[_t.name] = _t, null == (pt = this.bindBoneBoneSlotDic[_t.parent]) && (this.bindBoneBoneSlotDic[_t.parent] = pt = []), pt.push(_t), this.boneSlotArray.push(_t);
                    var ft, mt, yt, xt = l.readUTFString().split("\n"), gt = 0, Dt = l.getUint8(), vt = 0, Mt = 0, It = 0,
                        At = 0, bt = 0, Nt = 0, Tt = 0;
                    for (t = 0; t < Dt; t++) {
                        for ((ft = new Bt).name = xt[gt++], vt = l.getUint8(), e = 0; e < vt; e++) {
                            for ((mt = new kt).name = xt[gt++], _t = this.boneSlotDic[mt.name], Mt = l.getUint8(), i = 0; i < Mt; i++) {
                                if (yt = new Vt, this.skinSlotDisplayDataArr.push(yt), yt.name = xt[gt++], yt.attachmentName = xt[gt++], yt.transform = new Kt, yt.transform.scX = l.getFloat32(), yt.transform.skX = l.getFloat32(), yt.transform.skY = l.getFloat32(), yt.transform.scY = l.getFloat32(), yt.transform.x = l.getFloat32(), yt.transform.y = l.getFloat32(), mt.displayArr.push(yt), yt.width = l.getFloat32(), yt.height = l.getFloat32(), yt.type = l.getUint8(), yt.verLen = l.getUint16(), 0 < (S = l.getUint16())) for (yt.bones = [], a = 0; a < S; a++) {
                                    var St = l.getUint16();
                                    yt.bones.push(St)
                                }
                                if (0 < (It = l.getUint16())) for (yt.uvs = [], a = 0; a < It; a++) yt.uvs.push(l.getFloat32());
                                if (0 < (At = l.getUint16())) for (yt.weights = [], a = 0; a < At; a++) yt.weights.push(l.getFloat32());
                                if (0 < (bt = l.getUint16())) for (yt.triangles = [], a = 0; a < bt; a++) yt.triangles.push(l.getUint16());
                                if (0 < (Nt = l.getUint16())) for (yt.vertices = [], a = 0; a < Nt; a++) yt.vertices.push(l.getFloat32());
                                if (0 < (Tt = l.getUint16())) for (yt.lengths = [], a = 0; a < Tt; a++) yt.lengths.push(l.getFloat32())
                            }
                            ft.slotArr.push(mt)
                        }
                        this.skinDic[ft.name] = ft, this.skinDataArray.push(ft)
                    }
                    1 == l.getUint8() ? (this.yReverseMatrix = new Ft(1, 0, 0, -1, 0, 0), T && T.setTempMatrix(this.yReverseMatrix)) : T && T.setTempMatrix(new Ft), this.showSkinByIndex(this.boneSlotDic, 0), this.isParserComplete = !0, this.event("complete", this)
                }, t.getTexture = function (t) {
                    var e = this.subTextureDic[t];
                    return e || (e = this.subTextureDic[t.substr(0, t.length - 1)]), null == e ? this._mainTexture : e
                }, t.showSkinByIndex = function (t, e, i) {
                    if (void 0 === i && (i = !0), e < 0 && e >= this.skinDataArray.length) return !1;
                    var a, r, s = 0, n = 0, h = this.skinDataArray[e];
                    if (h) {
                        for (s = 0, n = h.slotArr.length; s < n; s++) (r = h.slotArr[s]) && (a = t[r.name]) && (a.showSlotData(r, i), i && "undefined" != a.attachmentName && "null" != a.attachmentName ? a.showDisplayByName(a.attachmentName) : a.showDisplayByIndex(a.displayIndex));
                        return !0
                    }
                    return !1
                }, t.getSkinIndexByName = function (t) {
                    for (var e = 0, i = this.skinDataArray.length; e < i; e++) if (this.skinDataArray[e].name == t) return e;
                    return -1
                }, t.getGrahicsDataWithCache = function (t, e) {
                    return this._graphicsCache[t] && this._graphicsCache[t][e] ? this._graphicsCache[t][e] : null
                }, t._setCreateURL = function (t) {
                    this._relativeUrl = t, laya.resource.Resource.prototype._setCreateURL.call(this, t)
                }, t.setGrahicsDataWithCache = function (t, e, i) {
                    this._graphicsCache[t][e] = i
                }, t.deleteAniData = function (t) {
                    if (this._anis[t]) {
                        var e = this._anis[t];
                        e.bone3DMap = null, e.nodes = null
                    }
                }, t.destroy = function () {
                    var t, e;
                    for (e in this._isDestroyed = !0, this.subTextureDic) (t = this.subTextureDic[e]) && t.destroy();
                    for (e in this._textureDic) (t = this._textureDic[e]) && t.destroy();
                    for (var i = 0, a = this.skinSlotDisplayDataArr.length; i < a; i++) this.skinSlotDisplayDataArr[i].destory();
                    this.skinSlotDisplayDataArr.length = 0, this.url && delete r.TEMPLET_DICTIONARY[this.url], laya.resource.Resource.prototype.destroy.call(this)
                }, t.getAniNameByIndex = function (t) {
                    var e = this.getAnimation(t);
                    return e ? e.name : null
                }, s(0, t, "rate", function () {
                    return this._rate
                }, function (t) {
                    this._rate = t
                }), r.LAYA_ANIMATION_160_VISION = "LAYAANIMATION:1.6.0", r.LAYA_ANIMATION_VISION = "LAYAANIMATION:1.7.0", r.TEMPLET_DICTIONARY = null, r
            }(P)
    }(window, document, Laya);
});
define("libs/laya.core.js", function (require, module, exports) {
    var Laya = window.Laya = function (l, t) {
        var u = {
            __internals: [],
            __packages: {},
            __classmap: {Object: Object, Function: Function, Array: Array, String: String},
            __sysClass: {object: "Object", array: "Array", string: "String", dictionary: "Dictionary"},
            __propun: {writable: !0, enumerable: !1, configurable: !0},
            __presubstr: String.prototype.substr,
            __substr: function (t, e) {
                return 1 == arguments.length ? u.__presubstr.call(this, t) : u.__presubstr.call(this, t, 0 < e ? e : this.length + e)
            },
            __init: function (t) {
                t.forEach(function (t) {
                    t.__init$ && t.__init$()
                })
            },
            __isClass: function (t) {
                return t && (t.__isclass || t == Object || t == String || t == Array)
            },
            __newvec: function (t, e) {
                var i = [];
                i.length = t;
                for (var n = 0; n < t; n++) i[n] = e;
                return i
            },
            __extend: function (t, e) {
                for (var i in e) if (e.hasOwnProperty(i)) {
                    var n = Object.getOwnPropertyDescriptor(e, i), r = n.get, s = n.set;
                    r || s ? r && s ? Object.defineProperty(t, i, n) : (r && Object.defineProperty(t, i, r), s && Object.defineProperty(t, i, s)) : t[i] = e[i]
                }

                function a() {
                    u.un(this, "constructor", t)
                }

                a.prototype = e.prototype, t.prototype = new a, u.un(t.prototype, "__imps", u.__copy({}, e.prototype.__imps))
            },
            __copy: function (t, e) {
                if (!e) return null;
                for (var i in t = t || {}, e) t[i] = e[i];
                return t
            },
            __package: function (t, e) {
                if (!u.__packages[t]) {
                    u.__packages[t] = !0;
                    var i = l, n = t.split(".");
                    if (1 < n.length) for (var r = 0, s = n.length - 1; r < s; r++) {
                        var a = i[n[r]];
                        i = a || (i[n[r]] = {})
                    }
                    i[n[n.length - 1]] || (i[n[n.length - 1]] = e || {})
                }
            },
            __hasOwnProperty: function (t, e) {
                return e = e || this, Object.hasOwnProperty.call(e, t) || function t(e, i) {
                    if (Object.hasOwnProperty.call(i.prototype, e)) return !0;
                    var n = i.prototype.__super;
                    return null == n ? null : t(e, n)
                }(t, e.__class)
            },
            __typeof: function (t, e) {
                if (!t || !e) return !1;
                if (e === String) return "string" == typeof t;
                if (e === Number) return "number" == typeof t;
                if (e.__interface__) e = e.__interface__; else if ("string" != typeof e) return t instanceof e;
                return t.__imps && t.__imps[e] || t.__class == e
            },
            __as: function (t, e) {
                return this.__typeof(t, e) ? t : null
            },
            __int: function (t) {
                return t ? parseInt(t) : 0
            },
            interface: function (t, e) {
                u.__package(t, {});
                var i = u.__internals, n = i[t] = i[t] || {self: t};
                if (e) {
                    var r = e.split(",");
                    n.extend = [];
                    for (var s = 0; s < r.length; s++) {
                        var a = r[s];
                        i[a] = i[a] || {self: a}, n.extend.push(i[a])
                    }
                }
                var o = l, h = t.split(".");
                for (s = 0; s < h.length - 1; s++) o = o[h[s]];
                o[h[h.length - 1]] = {__interface__: t}
            },
            class: function (t, e, i, n) {
                if (i && u.__extend(t, i), e) if (u.__package(e, t), u.__classmap[e] = t, 0 < e.indexOf(".")) {
                    if (0 == e.indexOf("laya.")) {
                        var r = e.split(".");
                        n = n || r[r.length - 1], u[n], u[n] = t
                    }
                } else "Main" == e ? l.Main = t : (u[e], u[e] = t);
                var s = u.un, a = t.prototype;
                s(a, "hasOwnProperty", u.__hasOwnProperty), s(a, "__class", t), s(a, "__super", i), s(a, "__className", e), s(t, "__super", i), s(t, "__className", e), s(t, "__isclass", !0), s(t, "super", function (t) {
                    this.__super.call(t)
                })
            },
            imps: function (t, e) {
                if (!e) return null;
                var r = t.__imps || u.un(t, "__imps", {});

                function s(t) {
                    var e, i;
                    if ((e = u.__internals[t]) && (r[t] = !0, i = e.extend)) for (var n = 0; n < i.length; n++) s(i[n].self)
                }

                for (var i in e) s(i)
            },
            superSet: function (t, e, i, n) {
                var r = t.prototype["_$set_" + i];
                r && r.call(e, n)
            },
            superGet: function (t, e, i) {
                var n = t.prototype["_$get_" + i];
                return n ? n.call(e) : null
            },
            getset: function (t, e, i, n, r) {
                t ? (n && (e["_$GET_" + i] = n), r && (e["_$SET_" + i] = r)) : (n && u.un(e, "_$get_" + i, n), r && u.un(e, "_$set_" + i, r)), n && r ? Object.defineProperty(e, i, {
                    get: n,
                    set: r,
                    enumerable: !1,
                    configurable: !0
                }) : (n && Object.defineProperty(e, i, {
                    get: n,
                    enumerable: !1,
                    configurable: !0
                }), r && Object.defineProperty(e, i, {set: r, enumerable: !1, configurable: !0}))
            },
            static: function (i, n) {
                for (var r = 0, t = n.length; r < t; r += 2) if ("length" == n[r]) i.length = n[r + 1].call(i); else {
                    function e() {
                        var e = n[r], t = n[r + 1];
                        Object.defineProperty(i, e, {
                            get: function () {
                                return delete this[e], this[e] = t.call(this)
                            }, set: function (t) {
                                delete this[e], this[e] = t
                            }, enumerable: !0, configurable: !0
                        })
                    }

                    e()
                }
            },
            un: function (t, e, i) {
                return i || (i = t[e]), u.__propun.value = i, Object.defineProperty(t, e, u.__propun), i
            },
            uns: function (e, t) {
                t.forEach(function (t) {
                    u.un(e, t)
                })
            }
        };
        return l.console = l.console || {
            log: function () {
            }
        }, l.trace = l.console.log, Error.prototype.throwError = function () {
            throw arguments
        }, Object.defineProperty(Array.prototype, "fixed", {enumerable: !1}), u
    }(window, document);
    !function (t, e, i) {
        i.un, i.uns, i.static, i.class, i.getset, i.__newvec
    }(window, document, Laya), function (m, s, y) {
        y.un, y.uns;
        var a = y.static, x = y.class, d = y.getset;
        y.__newvec;
        y.interface("laya.filters.IFilter"), y.interface("laya.resource.IDispose"), y.interface("laya.resource.IDestroy"), y.interface("laya.webgl.submit.ISubmit"), y.interface("laya.resource.ICreateResource"), y.interface("laya.webgl.canvas.save.ISaveData"), y.interface("laya.resource.ISingletonElement");
        d(1, y, "alertGlobalError", null, function (t) {
            var s = 0;
            Lt.window.onerror = t ? function (t, e, i, n, r) {
                s++ < 5 && r && alert("出错啦，请把此信息截图给研发商\n" + t + "\n" + r.stack)
            } : null
        }), y.init = function (t, e, i) {
            for (var n = [], r = 2, s = arguments.length; r < s; r++) n.push(arguments[r]);
            if (!y._isinit) {
                y._isinit = !0, ArrayBuffer.prototype.slice || (ArrayBuffer.prototype.slice = y._arrayBufferSlice), Lt.__init__(), y.systemTimer = new tt(!1), y.startTimer = new tt(!1), y.physicsTimer = new tt(!1), y.updateTimer = new tt(!1), y.lateTimer = new tt(!1), y.timer = new tt(!1), y.loader = new Ne, At.__init__(), Ct.inner_enable(), r = 0;
                for (var a = n.length; r < a; r++) n[r] && n[r].enable && n[r].enable();
                return Rt.isConchApp && ce.enableNative(), Z.beginCheck(), y._currentStage = y.stage = new ai, q.rootPath = q._basePath = y._getUrlPath(), y.render = new Rt(0, 0), y.stage.size(t, e), m.stage = y.stage, P.__init__(), vt.__init__(), R.instance.__init__(y.stage, Rt.canvas), li.__init__(), xe.autoStopMusic = !0, Rt.canvas
            }
        }, y._getUrlPath = function () {
            var t = Lt.window.location, e = t.pathname;
            return e = ":" == e.charAt(2) ? e.substring(1) : e, q.getPath("file:" == t.protocol ? e : t.protocol + "//" + t.host + t.pathname)
        }, y._arrayBufferSlice = function (t, e) {
            var i = new Uint8Array(this, t, e - t), n = new Uint8Array(i.length);
            return n.set(i), n.buffer
        }, y._runScript = function (t) {
            return Lt.window[y._evcode](t)
        }, y.enableDebugPanel = function (t) {
            if (void 0 === t && (t = "libs/laya.debugtool.js"), y.DebugPanel) y.DebugPanel.enable(); else {
                var e = Lt.createElement("script");
                e.onload = function () {
                    y.DebugPanel.enable()
                }, e.src = t, Lt.document.body.appendChild(e)
            }
        }, y.stage = null, y.systemTimer = null, y.startTimer = null, y.physicsTimer = null, y.updateTimer = null, y.lateTimer = null, y.timer = null, y.loader = null, y.version = "2.1.1.1", y.render = null, y._currentStage = null, y._isinit = !1, y.isWXOpenDataContext = !1, y.isWXPosMsg = !1, a(y, ["_evcode", function () {
            return this._evcode = "eval"
        }]);
        var n = function () {
            function g() {
            }

            return x(g, "laya.renders.LayaGLQuickRunner"), g.__init__ = function () {
                g.map[515] = g.alpha_transform_drawLayaGL, g.map[513] = g.alpha_drawLayaGL, g.map[514] = g.transform_drawLayaGL, g.map[8194] = g.transform_drawNodes, g.map[259] = g.alpha_transform_drawTexture, g.map[257] = g.alpha_drawTexture, g.map[258] = g.transform_drawTexture, g.map[8704] = g.drawLayaGL_drawNodes
            }, g.transform_drawTexture = function (t, e, i, n) {
                t._style;
                var r = t.texture;
                e.saveTransform(g.curMat), e.transformByMatrix(t.transform, i, n), e.drawTexture(r, -t.pivotX, -t.pivotY, t._width || r.width, t._height || r.height), e.restoreTransform(g.curMat)
            }, g.alpha_drawTexture = function (t, e, i, n) {
                var r, s = t._style, a = t.texture;
                if (.01 < (r = s.alpha) || t._needRepaint()) {
                    var o = e.globalAlpha;
                    e.globalAlpha *= r, e.drawTexture(a, i - s.pivotX + a.offsetX, n - s.pivotY + a.offsetY, t._width || a.width, t._height || a.height), e.globalAlpha = o
                }
            }, g.alpha_transform_drawTexture = function (t, e, i, n) {
                var r, s = t._style, a = t.texture;
                if (.01 < (r = s.alpha) || t._needRepaint()) {
                    var o = e.globalAlpha;
                    e.globalAlpha *= r, e.saveTransform(g.curMat), e.transformByMatrix(t.transform, i, n), e.drawTexture(a, -s.pivotX + a.offsetX, -s.pivotY + a.offsetY, t._width || a.width, t._height || a.height), e.restoreTransform(g.curMat), e.globalAlpha = o
                }
            }, g.alpha_transform_drawLayaGL = function (t, e, i, n) {
                var r, s = t._style;
                if (.01 < (r = s.alpha) || t._needRepaint()) {
                    var a = e.globalAlpha;
                    e.globalAlpha *= r, e.saveTransform(g.curMat), e.transformByMatrix(t.transform, i, n), t._graphics && t._graphics._render(t, e, -s.pivotX, -s.pivotY), e.restoreTransform(g.curMat), e.globalAlpha = a
                }
            }, g.alpha_drawLayaGL = function (t, e, i, n) {
                var r, s = t._style;
                if (.01 < (r = s.alpha) || t._needRepaint()) {
                    var a = e.globalAlpha;
                    e.globalAlpha *= r, t._graphics && t._graphics._render(t, e, i - s.pivotX, n - s.pivotY), e.globalAlpha = a
                }
            }, g.transform_drawLayaGL = function (t, e, i, n) {
                var r = t._style;
                e.saveTransform(g.curMat), e.transformByMatrix(t.transform, i, n), t._graphics && t._graphics._render(t, e, -r.pivotX, -r.pivotY), e.restoreTransform(g.curMat)
            }, g.transform_drawNodes = function (t, e, i, n) {
                var r = t._getBit(256) && e.drawCallOptimize(!0), s = t._style;
                e.saveTransform(g.curMat), e.transformByMatrix(t.transform, i, n), i = -s.pivotX, n = -s.pivotY;
                var a, o = t._children, h = o.length;
                if (s.viewport) {
                    var l = s.viewport, u = l.x, c = l.y, _ = l.right, f = l.bottom, d = NaN, p = NaN;
                    for (m = 0; m < h; ++m) (a = o[m])._visible && (d = a._x) < _ && d + a.width > u && (p = a._y) < f && p + a.height > c && a.render(e, i, n)
                } else for (var m = 0; m < h; ++m) (a = o[m])._visible && a.render(e, i, n);
                e.restoreTransform(g.curMat), r && e.drawCallOptimize(!1)
            }, g.drawLayaGL_drawNodes = function (t, e, i, n) {
                var r = t._getBit(256) && e.drawCallOptimize(!0), s = t._style;
                i -= s.pivotX, n -= s.pivotY, t._graphics && t._graphics._render(t, e, i, n);
                var a, o = t._children, h = o.length;
                if (s.viewport) {
                    var l = s.viewport, u = l.x, c = l.y, _ = l.right, f = l.bottom, d = NaN, p = NaN;
                    for (m = 0; m < h; ++m) (a = o[m])._visible && (d = a._x) < _ && d + a.width > u && (p = a._y) < f && p + a.height > c && a.render(e, i, n)
                } else for (var m = 0; m < h; ++m) (a = o[m])._visible && a.render(e, i, n);
                r && e.drawCallOptimize(!1)
            }, g.map = {}, a(g, ["curMat", function () {
                return this.curMat = new at
            }]), g
        }(), p = function () {
            function h(t) {
                if (this.arrColor = [], null == t) return this.strColor = "#00000000", this.numColor = 0, void (this.arrColor = [0, 0, 0, 0]);
                var e = 0, i = 0, n = 0;
                if ("string" == typeof t) if (0 <= t.indexOf("rgba(") || 0 <= t.indexOf("rgb(")) {
                    var r, s, a = t;
                    for (r = a.indexOf("("), s = a.indexOf(")"), a = a.substring(r + 1, s), this.arrColor = a.split(","), i = this.arrColor.length, e = 0; e < i; e++) this.arrColor[e] = parseFloat(this.arrColor[e]), e < 3 && (this.arrColor[e] = Math.round(this.arrColor[e]));
                    n = 4 == this.arrColor.length ? 256 * (256 * (256 * this.arrColor[0] + this.arrColor[1]) + this.arrColor[2]) + Math.round(255 * this.arrColor[3]) : 256 * (256 * this.arrColor[0] + this.arrColor[1]) + this.arrColor[2], this.strColor = t
                } else {
                    if ("#" === (this.strColor = t).charAt(0) && (t = t.substr(1)), 3 === (i = t.length) || 4 === i) {
                        var o = "";
                        for (e = 0; e < i; e++) o += t[e] + t[e];
                        t = o
                    }
                    n = parseInt(t, 16)
                } else n = t, this.strColor = ne.toHexColor(n);
                0 <= this.strColor.indexOf("rgba") || 9 === this.strColor.length ? (this.arrColor = [((4278190080 & n) >>> 24) / 255, ((16711680 & n) >> 16) / 255, ((65280 & n) >> 8) / 255, (255 & n) / 255], this.numColor = (4278190080 & n) >>> 24 | (16711680 & n) >> 8 | (65280 & n) << 8 | (255 & n) << 24) : (this.arrColor = [((16711680 & n) >> 16) / 255, ((65280 & n) >> 8) / 255, (255 & n) / 255, 1], this.numColor = 4278190080 | (16711680 & n) >> 16 | 65280 & n | (255 & n) << 16), this.arrColor.__id = ++h._COLODID
            }

            return x(h, "laya.utils.ColorUtils"), h._initDefault = function () {
                for (var t in h._DEFAULT = {}, h._COLOR_MAP) h._SAVE[t] = h._DEFAULT[t] = new h(h._COLOR_MAP[t]);
                return h._DEFAULT
            }, h._initSaveMap = function () {
                for (var t in h._SAVE_SIZE = 0, h._SAVE = {}, h._DEFAULT) h._SAVE[t] = h._DEFAULT[t]
            }, h.create = function (t) {
                var e = t + "", i = h._SAVE[e];
                return null != i ? i : (h._SAVE_SIZE < 1e3 && h._initSaveMap(), h._SAVE[e] = new h(t))
            }, h._SAVE = {}, h._SAVE_SIZE = 0, h._COLOR_MAP = {
                purple: "#800080",
                orange: "#ffa500",
                white: "#FFFFFF",
                red: "#FF0000",
                green: "#00FF00",
                blue: "#0000FF",
                black: "#000000",
                yellow: "#FFFF00",
                gray: "#808080"
            }, h._DEFAULT = h._initDefault(), h._COLODID = 1, h
        }(), o = function () {
            function o() {
            }

            x(o, "laya.webgl.canvas.save.SaveBase");
            var t = o.prototype;
            return y.imps(t, {"laya.webgl.canvas.save.ISaveData": !0}), t.isSaveMark = function () {
                return !1
            }, t.restore = function (t) {
                this._dataObj[this._valueName] = this._value, (o.POOL[o.POOL._length++] = this)._newSubmit && (t._curSubmit = T.RENDERBASE)
            }, o._createArray = function () {
                var t = [];
                return t._length = 0, t
            }, o._init = function () {
                var t = o._namemap = {};
                return t[1] = "ALPHA", t[2] = "fillStyle", t[8] = "font", t[256] = "lineWidth", t[512] = "strokeStyle", t[8192] = "_mergeID", t[1024] = t[2048] = t[4096] = [], t[16384] = "textBaseline", t[32768] = "textAlign", t[65536] = "_nBlendType", t[1048576] = "shader", t[2097152] = "filters", t[8388608] = "_colorFiler", t
            }, o.save = function (t, e, i, n) {
                if ((t._saveMark._saveuse & e) !== e) {
                    t._saveMark._saveuse |= e;
                    var r = o.POOL, s = 0 < r._length ? r[--r._length] : new o;
                    s._value = i[s._valueName = o._namemap[e]], s._dataObj = i, s._newSubmit = n;
                    var a = t._save;
                    a[a._length++] = s
                }
            }, o.POOL = laya.webgl.canvas.save.SaveBase._createArray(), o._namemap = o._init(), o
        }(), T = function () {
            function a(t) {
                this.clipInfoID = -1, this._mesh = null, this._blendFn = null, this._id = 0, this._renderType = 0, this._parent = null, this._startIdx = 0, this._numEle = 0, this._ref = 1, this.shaderValue = null, this._key = new U, void 0 === t && (t = 1e4), this._renderType = t, this._id = ++a.ID
            }

            x(a, "laya.webgl.submit.Submit");
            var t = a.prototype;
            return y.imps(t, {"laya.webgl.submit.ISubmit": !0}), t.getID = function () {
                return this._id
            }, t.releaseRender = function () {
                a.RENDERBASE != this && --this._ref < 1 && ((a.POOL[a._poolSize++] = this).shaderValue.release(), this.shaderValue = null, this._mesh = null, this._parent && (this._parent.releaseRender(), this._parent = null))
            }, t.getRenderType = function () {
                return this._renderType
            }, t.renderSubmit = function () {
                if (0 === this._numEle || !this._mesh || 0 == this._numEle) return 1;
                var t = this.shaderValue.textureHost;
                if (t) {
                    var e = t._getSource();
                    if (!e) return 1;
                    this.shaderValue.texture = e
                }
                var i = Ct.mainContext;
                return this._mesh.useMesh(i), this.shaderValue.upload(), fe.activeBlendFunction !== this._blendFn && (rt.setBlend(i, !0), this._blendFn(i), fe.activeBlendFunction = this._blendFn), i.drawElements(4, this._numEle, 5123, this._startIdx), M.renderBatches++, M.trianglesFaces += this._numEle / 3, 1
            }, t._cloneInit = function (t, e, i, n) {
                t._ref = 1, t._mesh = i, t._id = this._id, t._key.copyFrom(this._key), t._parent = this, t._blendFn = this._blendFn, t._renderType = this._renderType, t._startIdx = n * ft.BYTES_PIDX, t._numEle = this._numEle, t.shaderValue = this.shaderValue, this.shaderValue.ref++, this._ref++
            }, t.clone = function (t, e, i) {
                return null
            }, t.reUse = function (t, e) {
                return 0
            }, t.toString = function () {
                return "ibindex:" + this._startIdx + " num:" + this._numEle + " key=" + this._key
            }, a.__init__ = function () {
                var t = a.RENDERBASE = new a(-1);
                t.shaderValue = new Y(0, 0), t.shaderValue.ALPHA = 1, t._ref = 4294967295
            }, a.create = function (t, e, i) {
                var n = a._poolSize ? a.POOL[--a._poolSize] : new a;
                n._ref = 1, n._mesh = e, n._key.clear(), n._startIdx = e.indexNum * ft.BYTES_PIDX, n._numEle = 0;
                var r = t._nBlendType;
                n._blendFn = t._targets ? fe.targetFns[r] : fe.fns[r], n.shaderValue = i, n.shaderValue.setValue(t._shader2D);
                var s = t._shader2D.filters;
                return s && n.shaderValue.setFilters(s), n
            }, a.createShape = function (t, e, i, n) {
                var r = a._poolSize ? a.POOL[--a._poolSize] : new a;
                r._mesh = e, r._numEle = i, r._startIdx = 2 * e.indexNum, r._ref = 1, r.shaderValue = n, r.shaderValue.setValue(t._shader2D);
                var s = t._nBlendType;
                return r._key.blendShader = s, r._blendFn = t._targets ? fe.targetFns[s] : fe.fns[s], r
            }, a.TYPE_2D = 1e4, a.TYPE_CANVAS = 10003, a.TYPE_CMDSETRT = 10004, a.TYPE_CUSTOM = 10005, a.TYPE_BLURRT = 10006, a.TYPE_CMDDESTORYPRERT = 10007, a.TYPE_DISABLESTENCIL = 10008, a.TYPE_OTHERIBVB = 10009, a.TYPE_PRIMITIVE = 10010, a.TYPE_RT = 10011, a.TYPE_BLUR_RT = 10012, a.TYPE_TARGET = 10013, a.TYPE_CHANGE_VALUE = 10014, a.TYPE_SHAPE = 10015, a.TYPE_TEXTURE = 10016, a.TYPE_FILLTEXTURE = 10017, a.KEY_ONCE = -1, a.KEY_FILLRECT = 1, a.KEY_DRAWTEXTURE = 2, a.KEY_VG = 3, a.KEY_TRIANGLES = 4, a.RENDERBASE = null, a.ID = 1, a.preRender = null, a._poolSize = 0, a.POOL = [], a
        }(), h = function () {
            function l() {
            }

            x(l, "laya.display.cmd.FillTextureCmd");
            var t = l.prototype;
            return t.recover = function () {
                this.texture = null, this.offset = null, this.other = null, W.recover("FillTextureCmd", this)
            }, t.run = function (t, e, i) {
                t.fillTexture(this.texture, this.x + e, this.y + i, this.width, this.height, this.type, this.offset, this.other)
            }, d(0, t, "cmdID", function () {
                return "FillTexture"
            }), l.create = function (t, e, i, n, r, s, a, o) {
                var h = W.getItemByClass("FillTextureCmd", l);
                return h.texture = t, h.x = e, h.y = i, h.width = n, h.height = r, h.type = s, h.offset = a, h.other = o, h
            }, l.ID = "FillTexture", l
        }(), l = function () {
            function t() {
                this._glRender = null
            }

            x(t, "laya.filters.Filter");
            var e = t.prototype;
            return y.imps(e, {"laya.filters.IFilter": !0}), d(0, e, "type", function () {
                return -1
            }), t.BLUR = 16, t.COLOR = 32, t.GLOW = 8, t._filter = function (t, e, i, n) {
                var r = e, s = this._next;
                if (s) {
                    var a = t.filters, o = a.length;
                    if (1 == o && 32 == a[0].type) return e.save(), e.setColorFilter(a[0]), s._fun.call(s, t, e, i, n), void e.restore();
                    var h, l = Y.create(1, 0), u = Ht.TEMP, c = r._curMat, _ = at.create();
                    c.copyTo(_);
                    var f = 0, d = 0, p = null, m = t._cacheStyle.filterCache || null;
                    if (m && 0 == t.getRepaint()) {
                        if ((t._cacheStyle.hasGlowFilter || !1) && (f = 50, d = 25), (h = t.getBounds()).width <= 0 || h.height <= 0) return;
                        h.width += f, h.height += f, u.x = h.x * _.a + h.y * _.c, u.y = h.y * _.d + h.x * _.b, h.x = u.x, h.y = u.y, u.x = h.width * _.a + h.height * _.c, u.y = h.height * _.d + h.width * _.b, h.width = u.x, h.height = u.y
                    } else {
                        t._isHaveGlowFilter() && (f = 50, d = 25), (h = new gt).copyFrom(t.getSelfBounds()), h.x += t.x, h.y += t.y, h.x -= t.pivotX + 4, h.y -= t.pivotY + 4;
                        var g = h.x, v = h.y;
                        if (h.width += f + 8, h.height += f + 8, u.x = h.x * _.a + h.y * _.c, u.y = h.y * _.d + h.x * _.b, h.x = u.x, h.y = u.y, u.x = h.width * _.a + h.height * _.c, u.y = h.height * _.d + h.width * _.b, h.width = u.x, h.height = u.y, h.width <= 0 || h.height <= 0) return;
                        m && ie.releaseRT(m), p = ie.getRT(h.width, h.height);
                        var y = m = ie.getRT(h.width, h.height);
                        t._getCacheStyle().filterCache = m, r.pushRT(), r.useRT(p);
                        var x = t.x - g + d, T = t.y - v + d;
                        s._fun.call(s, t, e, x, T), r.useRT(y);
                        for (var b = 0; b < o; b++) {
                            0 != b && (r.useRT(p), r.drawTarget(y, 0, 0, h.width, h.height, at.TEMP.identity(), l, null, fe.TOINT.overlay), r.useRT(y));
                            var w = a[b];
                            switch (w.type) {
                                case 16:
                                case 8:
                                    w._glRender && w._glRender.render(p, e, h.width, h.height, w);
                                    break;
                                case 32:
                                    r.setColorFilter(w), r.drawTarget(p, 0, 0, h.width, h.height, at.EMPTY.identity(), Y.create(1, 0)), r.setColorFilter(null)
                            }
                        }
                        r.popRT()
                    }
                    if (i = i - d - t.x, n = n - d - t.y, u.setTo(i, n), _.transformPoint(u), i = u.x + h.x, n = u.y + h.y, r._drawRenderTexture(m, i, n, h.width, h.height, at.TEMP.identity(), 1, fi.defuv), p) {
                        var C = Q.create([p], function (t) {
                            t.destroy()
                        }, this);
                        p = null, e.addRenderObject(C)
                    }
                    _.destroy()
                }
            }, t
        }(), u = (function () {
            function e() {
            }

            x(e, "laya.utils.Log"), e.enable = function () {
                e._logdiv || ((e._logdiv = Lt.createElement("div")).style.cssText = "border:white;padding:4px;overflow-y:auto;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;", Lt.document.body.appendChild(e._logdiv), (e._btn = Lt.createElement("button")).innerText = "Hide", e._btn.style.cssText = "z-index:1000001;position: absolute;left:10px;top:10px;", e._btn.onclick = e.toggle, Lt.document.body.appendChild(e._btn))
            }, e.toggle = function () {
                var t = e._logdiv.style;
                "" === t.display ? (e._btn.innerText = "Show", t.display = "none") : (e._btn.innerText = "Hide", t.display = "")
            }, e.print = function (t) {
                e._logdiv && (e.maxCount <= e._count && e.clear(), e._count++, e._logdiv.innerText += t + "\n", e.autoScrollToBottom && e._logdiv.scrollHeight - e._logdiv.scrollTop - e._logdiv.clientHeight < 50 && (e._logdiv.scrollTop = e._logdiv.scrollHeight))
            }, e.clear = function () {
                e._logdiv.innerText = "", e._count = 0
            }, e._logdiv = null, e._btn = null, e._count = 0, e.maxCount = 50, e.autoScrollToBottom = !0
        }(), function () {
            function d() {
                this.preOvers = [], this.preDowns = [], this.preRightDowns = [], this.enable = !0, this._lastClickTime = 0, this._event = new e
            }

            x(d, "laya.events.TouchManager");
            var t = d.prototype;
            return t._clearTempArrs = function () {
                d._oldArr.length = 0, d._newArr.length = 0, d._tEleArr.length = 0
            }, t.getTouchFromArr = function (t, e) {
                var i, n, r = 0;
                for (i = e.length, r = 0; r < i; r++) if ((n = e[r]).id == t) return n;
                return null
            }, t.removeTouchFromArr = function (t, e) {
                var i = 0;
                for (i = e.length - 1; 0 <= i; i--) e[i].id == t && e.splice(i, 1)
            }, t.createTouchO = function (t, e) {
                var i;
                return (i = W.getItem("TouchData") || {}).id = e, i.tar = t, i
            }, t.onMouseDown = function (t, e, i) {
                var n, r, s, a;
                (void 0 === i && (i = !1), this.enable) && (n = this.getTouchFromArr(e, this.preOvers), s = this.getEles(t, null, d._tEleArr), n ? n.tar = t : (r = this.createTouchO(t, e), this.preOvers.push(r)), Lt.onMobile && this.sendEvents(s, "mouseover"), a = i ? this.preDowns : this.preRightDowns, (n = this.getTouchFromArr(e, a)) ? n.tar = t : (r = this.createTouchO(t, e), a.push(r)), this.sendEvents(s, i ? "mousedown" : "rightmousedown"), this._clearTempArrs())
            }, t.sendEvents = function (t, e) {
                var i, n, r, s = 0;
                for (i = t.length, this._event._stoped = !1, n = t[0], s = 0; s < i; s++) {
                    if ((r = t[s]).destroyed) return;
                    if (r.event(e, this._event.setTo(e, r, n)), this._event._stoped) break
                }
            }, t.getEles = function (t, e, i) {
                for (i ? i.length = 0 : i = []; t && t != e;) i.push(t), t = t.parent;
                return i
            }, t.checkMouseOutAndOverOfMove = function (t, e, i) {
                if (void 0 === i && (i = 0), e != t) {
                    var n, r, s = 0, a = 0;
                    if (e.contains(t)) r = this.getEles(t, e, d._tEleArr), this.sendEvents(r, "mouseover"); else if (t.contains(e)) r = this.getEles(e, t, d._tEleArr), this.sendEvents(r, "mouseout"); else {
                        var o, h;
                        (r = d._tEleArr).length = 0, o = this.getEles(e, null, d._oldArr), h = this.getEles(t, null, d._newArr), a = o.length;
                        var l = 0;
                        for (s = 0; s < a; s++) {
                            if (n = o[s], 0 <= (l = h.indexOf(n))) {
                                h.splice(l, h.length - l);
                                break
                            }
                            r.push(n)
                        }
                        0 < r.length && this.sendEvents(r, "mouseout"), 0 < h.length && this.sendEvents(h, "mouseover")
                    }
                }
            }, t.onMouseMove = function (t, e) {
                var i, n;
                this.enable && ((i = this.getTouchFromArr(e, this.preOvers)) ? (this.checkMouseOutAndOverOfMove(t, i.tar), i.tar = t, n = this.getEles(t, null, d._tEleArr)) : (n = this.getEles(t, null, d._tEleArr), this.sendEvents(n, "mouseover"), this.preOvers.push(this.createTouchO(t, e))), this.sendEvents(n, "mousemove"), this._clearTempArrs())
            }, t.getLastOvers = function () {
                return (d._tEleArr.length = 0) < this.preOvers.length && this.preOvers[0].tar ? this.getEles(this.preOvers[0].tar, null, d._tEleArr) : (d._tEleArr.push(y.stage), d._tEleArr)
            }, t.stageMouseOut = function () {
                var t;
                t = this.getLastOvers(), this.preOvers.length = 0, this.sendEvents(t, "mouseout")
            }, t.onMouseUp = function (t, e, i) {
                if (void 0 === i && (i = !1), this.enable) {
                    var n, r, s, a, o, h, l = 0, u = 0, c = Lt.onMobile;
                    if (r = this.getEles(t, null, d._tEleArr), this.sendEvents(r, i ? "mouseup" : "rightmouseup"), h = i ? this.preDowns : this.preRightDowns, n = this.getTouchFromArr(e, h)) {
                        var _, f = Lt.now();
                        if (_ = f - this._lastClickTime < 300, this._lastClickTime = f, t == n.tar) o = r; else for (s = this.getEles(n.tar, null, d._oldArr), (o = d._newArr).length = 0, u = s.length, l = 0; l < u; l++) a = s[l], 0 <= r.indexOf(a) && o.push(a);
                        0 < o.length && this.sendEvents(o, i ? "click" : "rightclick"), i && _ && this.sendEvents(o, "doubleclick"), this.removeTouchFromArr(e, h), n.tar = null, W.recover("TouchData", n)
                    } else ;
                    (n = this.getTouchFromArr(e, this.preOvers)) && c && ((o = this.getEles(n.tar, null, o)) && 0 < o.length && this.sendEvents(o, "mouseout"), this.removeTouchFromArr(e, this.preOvers), n.tar = null, W.recover("TouchData", n)), this._clearTempArrs()
                }
            }, d._oldArr = [], d._newArr = [], d._tEleArr = [], a(d, ["I", function () {
                return this.I = new d
            }]), d
        }()), c = function () {
            function a() {
                this._mesh = null, this._startIdx = 0, this._numEle = 0, this.shaderValue = null, this.blendType = 0, this._ref = 1, this.srcRT = null, this._key = new U
            }

            x(a, "laya.webgl.submit.SubmitTarget");
            var t = a.prototype;
            return y.imps(t, {"laya.webgl.submit.ISubmit": !0}), t.renderSubmit = function () {
                var t = Ct.mainContext;
                this._mesh.useMesh(t);
                var e = this.srcRT;
                return e && (this.shaderValue.texture = e._getSource(), this.shaderValue.upload(), this.blend(), M.renderBatches++, M.trianglesFaces += this._numEle / 3, Ct.mainContext.drawElements(4, this._numEle, 5123, this._startIdx)), 1
            }, t.blend = function () {
                if (fe.activeBlendFunction !== fe.fns[this.blendType]) {
                    var t = Ct.mainContext;
                    t.enable(3042), fe.fns[this.blendType](t), fe.activeBlendFunction = fe.fns[this.blendType]
                }
            }, t.getRenderType = function () {
                return 0
            }, t.releaseRender = function () {
                if (--this._ref < 1) {
                    var t = a.POOL;
                    t[t._length++] = this
                }
            }, t.reUse = function (t, e) {
                return this._startIdx = e, this._ref++, e
            }, a.create = function (t, e, i, n) {
                var r = a.POOL._length ? a.POOL[--a.POOL._length] : new a;
                if (r._mesh = e, r.srcRT = n, r._startIdx = e.indexNum * ft.BYTES_PIDX, r._ref = 1, r._key.clear(), r._numEle = 0, r.blendType = t._nBlendType, r._key.blendShader = r.blendType, r.shaderValue = i, r.shaderValue.setValue(t._shader2D), t._colorFiler) {
                    var s = t._colorFiler;
                    i.defines.add(s.type), i.colorMat = s._mat, i.colorAlpha = s._alpha
                }
                return r
            }, a.POOL = [], a.__init$ = function () {
                a.POOL._length = 0
            }, a
        }(), _ = function () {
            function a() {
            }

            x(a, "laya.display.cmd.DrawImageCmd");
            var t = a.prototype;
            return t.recover = function () {
                this.texture._removeReference(), this.texture = null, W.recover("DrawImageCmd", this)
            }, t.run = function (t, e, i) {
                t.drawTexture(this.texture, this.x + e, this.y + i, this.width, this.height)
            }, d(0, t, "cmdID", function () {
                return "DrawImage"
            }), a.create = function (t, e, i, n, r) {
                var s = W.getItemByClass("DrawImageCmd", a);
                return (s.texture = t)._addReference(), s.x = e, s.y = i, s.width = n, s.height = r, s
            }, a.ID = "DrawImage", a
        }(), r = function () {
            function t() {
                this._id = ne.getGID(), this._resetComp()
            }

            x(t, "laya.components.Component");
            var e = t.prototype;
            return y.imps(e, {
                "laya.resource.ISingletonElement": !0,
                "laya.resource.IDestroy": !0
            }), e._isScript = function () {
                return !1
            }, e._resetComp = function () {
                this._indexInList = -1, this._enabled = !0, this._awaked = !1, this.owner = null
            }, e._getIndexInList = function () {
                return this._indexInList
            }, e._setIndexInList = function (t) {
                this._indexInList = t
            }, e._onAdded = function () {
            }, e._onAwake = function () {
            }, e._onEnable = function () {
            }, e._onDisable = function () {
            }, e._onEnableInScene = function () {
            }, e._onDisableInScene = function () {
            }, e._onDestroy = function () {
            }, e.onReset = function () {
            }, e._parse = function (t) {
            }, e._cloneTo = function (t) {
            }, e._setActive = function (t) {
                t ? (this._awaked || (this._awaked = !0, this._onAwake()), this._enabled && this._onEnable()) : this._enabled && this._onDisable()
            }, e._setActiveInScene = function (t) {
                t ? this._onEnableInScene() : this._onDisableInScene()
            }, e.destroy = function () {
                this.owner && this.owner._destroyComponent(this)
            }, e._destroy = function () {
                this.owner.activeInHierarchy && this._enabled && (this._setActive(!1), this._isScript() && this.onDisable()), this.owner._scene && this._setActiveInScene(!1), this._onDestroy(), this._destroyed = !0, this.onReset !== laya.components.Component.prototype.onReset ? (this.onReset(), this._resetComp(), W.recoverByClass(this)) : this._resetComp()
            }, d(0, e, "id", function () {
                return this._id
            }), d(0, e, "enabled", function () {
                return this._enabled
            }, function (t) {
                this._enabled = t, this.owner && (t ? this.owner.activeInHierarchy && this._onEnable() : this.owner.activeInHierarchy && this._onDisable())
            }), d(0, e, "isSingleton", function () {
                return !0
            }), d(0, e, "destroyed", function () {
                return this._destroyed
            }), t
        }(), g = function () {
            var h;

            function e() {
                this._$0__events = null
            }

            x(e, "laya.events.EventDispatcher");
            var t = e.prototype;
            return t.hasListener = function (t) {
                return !!(this._$0__events && this._$0__events[t])
            }, t.event = function (t, e) {
                if (!this._$0__events || !this._$0__events[t]) return !1;
                var i = this._$0__events[t];
                if (i.run) i.once && delete this._$0__events[t], null != e ? i.runWith(e) : i.run(); else {
                    for (var n = 0, r = i.length; n < r; n++) {
                        var s = i[n];
                        s && (null != e ? s.runWith(e) : s.run()), s && !s.once || (i.splice(n, 1), n--, r--)
                    }
                    0 === i.length && this._$0__events && delete this._$0__events[t]
                }
                return !0
            }, t.on = function (t, e, i, n) {
                return this._createListener(t, e, i, n, !1)
            }, t.once = function (t, e, i, n) {
                return this._createListener(t, e, i, n, !0)
            }, t._createListener = function (t, e, i, n, r, s) {
                void 0 === s && (s = !0), s && this.off(t, e, i, r);
                var a = h.create(e || this, i, n, r);
                this._$0__events || (this._$0__events = {});
                var o = this._$0__events;
                return o[t] ? o[t].run ? o[t] = [o[t], a] : o[t].push(a) : o[t] = a, this
            }, t.off = function (t, e, i, n) {
                if (void 0 === n && (n = !1), !this._$0__events || !this._$0__events[t]) return this;
                var r = this._$0__events[t];
                if (null != r) if (r.run) e && r.caller !== e || null != i && r.method !== i || n && !r.once || (delete this._$0__events[t], r.recover()); else {
                    for (var s = 0, a = 0, o = r.length; a < o; a++) {
                        var h = r[a];
                        h ? !h || e && h.caller !== e || null != i && h.method !== i || n && !h.once || (s++, r[a] = null, h.recover()) : s++
                    }
                    s === o && delete this._$0__events[t]
                }
                return this
            }, t.offAll = function (t) {
                var e = this._$0__events;
                if (!e) return this;
                if (t) this._recoverHandlers(e[t]), delete e[t]; else {
                    for (var i in e) this._recoverHandlers(e[i]);
                    this._$0__events = null
                }
                return this
            }, t.offAllCaller = function (t) {
                if (t && this._$0__events) for (var e in this._$0__events) this.off(e, t, null);
                return this
            }, t._recoverHandlers = function (t) {
                if (t) if (t.run) t.recover(); else for (var e = t.length - 1; -1 < e; e--) t[e] && (t[e].recover(), t[e] = null)
            }, t.isMouseEvent = function (t) {
                return e.MOUSE_EVENTS[t] || !1
            }, e.MOUSE_EVENTS = {
                rightmousedown: !0,
                rightmouseup: !0,
                rightclick: !0,
                mousedown: !0,
                mouseup: !0,
                mousemove: !0,
                mouseover: !0,
                mouseout: !0,
                click: !0,
                doubleclick: !0
            }, e.__init$ = function () {
                Object.defineProperty(laya.events.EventDispatcher.prototype, "_events", {
                    enumerable: !1,
                    writable: !0
                }), h = function (t) {
                    function r(t, e, i, n) {
                        r.__super.call(this, t, e, i, n)
                    }

                    return x(r, "", b), r.prototype.recover = function () {
                        0 < this._id && (this._id = 0, r._pool.push(this.clear()))
                    }, r.create = function (t, e, i, n) {
                        return void 0 === n && (n = !0), r._pool.length ? r._pool.pop().setTo(t, e, i, n) : new r(t, e, i, n)
                    }, r._pool = [], r
                }()
            }, e
        }(), b = function () {
            function r(t, e, i, n) {
                this.once = !1, void (this._id = 0) === n && (n = !1), this.setTo(t, e, i, n)
            }

            x(r, "laya.utils.Handler");
            var t = r.prototype;
            return t.setTo = function (t, e, i, n) {
                return this._id = r._gid++, this.caller = t, this.method = e, this.args = i, this.once = n, this
            }, t.run = function () {
                if (null == this.method) return null;
                var t = this._id, e = this.method.apply(this.caller, this.args);
                return this._id === t && this.once && this.recover(), e
            }, t.runWith = function (t) {
                if (null == this.method) return null;
                var e = this._id;
                if (null == t) var i = this.method.apply(this.caller, this.args); else i = this.args || t.unshift ? this.args ? this.method.apply(this.caller, this.args.concat(t)) : this.method.apply(this.caller, t) : this.method.call(this.caller, t);
                return this._id === e && this.once && this.recover(), i
            }, t.clear = function () {
                return this.caller = null, this.method = null, this.args = null, this
            }, t.recover = function () {
                0 < this._id && (this._id = 0, r._pool.push(this.clear()))
            }, r.create = function (t, e, i, n) {
                return void 0 === n && (n = !0), r._pool.length ? r._pool.pop().setTo(t, e, i, n) : new r(t, e, i, n)
            }, r._pool = [], r._gid = 1, r
        }(), f = function () {
            function t() {
                this.ib = null, this.vb = null;
                Ct.mainContext;
                this.ib = qe.create(35048), this.vb = ti.create(8)
            }

            x(t, "laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");
            var e = t.prototype;
            return e.addSkinMesh = function (t) {
                t.getData2(this.vb, this.ib, this.vb._byteLength / 32)
            }, e.reset = function () {
                this.vb.clear(), this.ib.clear()
            }, t.getInstance = function () {
                return t.instance = t.instance || new t
            }, t.instance = null, t
        }(), v = function () {
            function _() {
            }

            x(_, "laya.display.cmd.DrawTrianglesCmd");
            var t = _.prototype;
            return t.recover = function () {
                this.texture = null, this.vertices = null, this.uvs = null, this.indices = null, this.matrix = null, W.recover("DrawTrianglesCmd", this)
            }, t.run = function (t, e, i) {
                t.drawTriangles(this.texture, this.x + e, this.y + i, this.vertices, this.uvs, this.indices, this.matrix, this.alpha, this.color, this.blendMode)
            }, d(0, t, "cmdID", function () {
                return "DrawTriangles"
            }), _.create = function (t, e, i, n, r, s, a, o, h, l) {
                var u = W.getItemByClass("DrawTrianglesCmd", _);
                if (u.texture = t, u.x = e, u.y = i, u.vertices = n, u.uvs = r, u.indices = s, u.matrix = a, u.alpha = o, h) {
                    u.color = new be;
                    var c = p.create(h).arrColor;
                    u.color.color(255 * c[0], 255 * c[1], 255 * c[2], 255 * c[3])
                }
                return u.blendMode = l, u
            }, _.ID = "DrawTriangles", _
        }(), w = function () {
            function u() {
            }

            x(u, "laya.display.cmd.DrawPieCmd");
            var t = u.prototype;
            return t.recover = function () {
                this.fillColor = null, this.lineColor = null, W.recover("DrawPieCmd", this)
            }, t.run = function (t, e, i) {
                t._drawPie(this.x + e, this.y + i, this.radius, this._startAngle, this._endAngle, this.fillColor, this.lineColor, this.lineWidth, this.vid)
            }, d(0, t, "startAngle", function () {
                return 180 * this._startAngle / Math.PI
            }, function (t) {
                this._startAngle = t * Math.PI / 180
            }), d(0, t, "cmdID", function () {
                return "DrawPie"
            }), d(0, t, "endAngle", function () {
                return 180 * this._endAngle / Math.PI
            }, function (t) {
                this._endAngle = t * Math.PI / 180
            }), u.create = function (t, e, i, n, r, s, a, o, h) {
                var l = W.getItemByClass("DrawPieCmd", u);
                return l.x = t, l.y = e, l.radius = i, l._startAngle = n, l._endAngle = r, l.fillColor = s, l.lineColor = a, l.lineWidth = o, l.vid = h, l
            }, u.ID = "DrawPie", u
        }(), E = function () {
            function t() {
                this.id = NaN, this.save = [], this.toUpperCase = null, this.changed = !1, this._text = null, this.width = -1, this.pageChars = [], this.startID = 0, this.startIDStroke = 0, this.lastGCCnt = 0, this.splitRender = !1
            }

            x(t, "laya.utils.WordText");
            var e = t.prototype;
            return e.setText = function (t) {
                this.changed = !0, this._text = t, this.width = -1, this.cleanCache()
            }, e.toString = function () {
                return this._text
            }, e.charCodeAt = function (t) {
                return this._text ? this._text.charCodeAt(t) : NaN
            }, e.charAt = function (t) {
                return this._text ? this._text.charAt(t) : null
            }, e.cleanCache = function () {
                this.pageChars.forEach(function (t) {
                    var e = t.tex;
                    t.words;
                    1 == t.words.length && e && e.ri && e.destroy()
                }), this.pageChars = [], this.startID = 0
            }, d(0, e, "length", function () {
                return this._text ? this._text.length : 0
            }), t
        }(), C = function () {
            function e(t, e, i) {
                this._stride = 0, this.vertNum = 0, this.indexNum = 0, this._applied = !1, this._vb = null, this._ib = null, this._vao = null, this._attribInfo = null, this._quadNum = 0, this.canReuse = !1, this._stride = t, this._vb = new ti(t, 35048), e ? this._vb._resizeBuffer(e, !1) : ae.webGL2D_MeshAllocMaxMem && this._vb._resizeBuffer(65536 * t, !1), this._ib = new qe, i && this._ib._resizeBuffer(i, !1)
            }

            x(e, "laya.webgl.utils.Mesh2D");
            var t = e.prototype;
            return t.cloneWithNewVB = function () {
                var t = new e(this._stride, 0, 0);
                return t._ib = this._ib, t._quadNum = this._quadNum, t._attribInfo = this._attribInfo, t
            }, t.cloneWithNewVBIB = function () {
                var t = new e(this._stride, 0, 0);
                return t._attribInfo = this._attribInfo, t
            }, t.getVBW = function () {
                return this._vb.setNeedUpload(), this._vb
            }, t.getVBR = function () {
                return this._vb
            }, t.getIBR = function () {
                return this._ib
            }, t.getIBW = function () {
                return this._ib.setNeedUpload(), this._ib
            }, t.createQuadIB = function (t) {
                this._quadNum = t, this._ib._resizeBuffer(6 * t * 2, !1), this._ib.byteLength = this._ib.bufferLength;
                for (var e = this._ib.getUint16Array(), i = 0, n = 0, r = 0; r < t; r++) e[i++] = n, e[i++] = n + 2, e[i++] = n + 1, e[i++] = n, e[i++] = n + 3, e[i++] = n + 2, n += 4;
                this._ib.setNeedUpload()
            }, t.setAttributes = function (t) {
                if (this._attribInfo = t, this._attribInfo.length % 3 != 0) throw"Mesh2D setAttributes error!"
            }, t.configVAO = function (t) {
                if (!this._applied) {
                    this._applied = !0, this._vao || (this._vao = new Ve), this._vao.bind(), this._vb._bindForVAO(), this._ib.setNeedUpload(), this._ib._bind_uploadForVAO();
                    for (var e = this._attribInfo.length / 3, i = 0, n = 0; n < e; n++) {
                        var r = this._attribInfo[i + 1], s = this._attribInfo[i], a = this._attribInfo[i + 2];
                        t.enableVertexAttribArray(n), t.vertexAttribPointer(n, r, s, !1, this._stride, a), i += 3
                    }
                    this._vao.unBind()
                }
            }, t.useMesh = function (t) {
                this._applied || this.configVAO(t), this._vao.bind(), this._vb.bind(), this._ib._bind_upload() || this._ib.bind(), this._vb._bind_upload() || this._vb.bind()
            }, t.getEleNum = function () {
                return this._ib.getBuffer().byteLength / 2
            }, t.releaseMesh = function () {
            }, t.destroy = function () {
            }, t.clearVB = function () {
                this._vb.clear()
            }, e._gvaoid = 0, e
        }(), e = function () {
            function t() {
            }

            x(t, "laya.events.Event");
            var e = t.prototype;
            return e.setTo = function (t, e, i) {
                return this.type = t, this.currentTarget = e, this.target = i, this
            }, e.stopPropagation = function () {
                this._stoped = !0
            }, d(0, e, "stageY", function () {
                return y.stage.mouseY
            }), d(0, e, "charCode", function () {
                return this.nativeEvent.charCode
            }), d(0, e, "touches", function () {
                if (!this.nativeEvent) return null;
                var t = this.nativeEvent.touches;
                if (t) for (var e = y.stage, i = 0, n = t.length; i < n; i++) {
                    var r = t[i], s = Ht.TEMP;
                    s.setTo(r.clientX, r.clientY), e._canvasTransform.invertTransformPoint(s), e.transform.invertTransformPoint(s), r.stageX = s.x, r.stageY = s.y
                }
                return t
            }), d(0, e, "keyLocation", function () {
                return this.nativeEvent.location || this.nativeEvent.keyLocation
            }), d(0, e, "ctrlKey", function () {
                return this.nativeEvent.ctrlKey
            }), d(0, e, "altKey", function () {
                return this.nativeEvent.altKey
            }), d(0, e, "shiftKey", function () {
                return this.nativeEvent.shiftKey
            }), d(0, e, "stageX", function () {
                return y.stage.mouseX
            }), t.EMPTY = new t, t.MOUSE_DOWN = "mousedown", t.MOUSE_UP = "mouseup", t.CLICK = "click", t.RIGHT_MOUSE_DOWN = "rightmousedown", t.RIGHT_MOUSE_UP = "rightmouseup", t.RIGHT_CLICK = "rightclick", t.MOUSE_MOVE = "mousemove", t.MOUSE_OVER = "mouseover", t.MOUSE_OUT = "mouseout", t.MOUSE_WHEEL = "mousewheel", t.ROLL_OVER = "mouseover", t.ROLL_OUT = "mouseout", t.DOUBLE_CLICK = "doubleclick", t.CHANGE = "change", t.CHANGED = "changed", t.RESIZE = "resize", t.ADDED = "added", t.REMOVED = "removed", t.DISPLAY = "display", t.UNDISPLAY = "undisplay", t.ERROR = "error", t.COMPLETE = "complete", t.LOADED = "loaded", t.READY = "ready", t.PROGRESS = "progress", t.INPUT = "input", t.RENDER = "render", t.OPEN = "open", t.MESSAGE = "message", t.CLOSE = "close", t.KEY_DOWN = "keydown", t.KEY_PRESS = "keypress", t.KEY_UP = "keyup", t.FRAME = "enterframe", t.DRAG_START = "dragstart", t.DRAG_MOVE = "dragmove", t.DRAG_END = "dragend", t.ENTER = "enter", t.SELECT = "select", t.BLUR = "blur", t.FOCUS = "focus", t.VISIBILITY_CHANGE = "visibilitychange", t.FOCUS_CHANGE = "focuschange", t.PLAYED = "played", t.PAUSED = "paused", t.STOPPED = "stopped", t.START = "start", t.END = "end", t.COMPONENT_ADDED = "componentadded", t.COMPONENT_REMOVED = "componentremoved", t.RELEASED = "released", t.LINK = "link", t.LABEL = "label", t.FULL_SCREEN_CHANGE = "fullscreenchange", t.DEVICE_LOST = "devicelost", t.TRANSFORM_CHANGED = "transformchanged", t.ANIMATION_CHANGED = "animationchanged", t.TRAIL_FILTER_CHANGE = "trailfilterchange", t.TRIGGER_ENTER = "triggerenter", t.TRIGGER_STAY = "triggerstay", t.TRIGGER_EXIT = "triggerexit", t
        }(), A = function () {
            function S() {
                this.fontSizeInfo = {}, this.charRender = null, this.mapFont = {}, this.fontID = 0, this.mapColor = [], this.colorID = 0, this.fontScaleX = 1, this.fontScaleY = 1, this._curStrPos = 0, this.bmpData32 = null, this.lastFont = null, this.fontSizeW = 0, this.fontSizeH = 0, this.fontSizeOffX = 0, this.fontSizeOffY = 0, this.renderPerChar = !0, this.textureMem = 0, this.fontStr = null, this.textAtlases = [], this.isoTextures = [], this.tmpAtlasPos = new Ht;
                var t = !1, e = y.MiniAdpter;
                e && e.systemInfo && e.systemInfo.system && (t = "ios 10.1.1" === e.systemInfo.system.toLowerCase()), Lt.onMiniGame && !t && (S.isWan1Wan = !0), Lt.onLimixiu && (S.isWan1Wan = !0), this.charRender = Rt.isConchApp ? new ze : new He(S.atlasWidth, S.atlasWidth, S.scaleFontWithCtx, !S.isWan1Wan, !1), S.textRenderInst = this, y.textRender = this, S.atlasWidth2 = S.atlasWidth * S.atlasWidth
            }

            x(S, "laya.webgl.text.TextRender");
            var t = S.prototype;
            return t.setFont = function (t) {
                if (this.lastFont != t) {
                    this.lastFont = t;
                    var e = this.getFontSizeInfo(t._family), i = e >> 24, n = e >> 16 & 255, r = e >> 8 & 255,
                        s = 255 & e, a = t._size / S.standardFontSize;
                    this.fontSizeOffX = Math.ceil(i * a), this.fontSizeOffY = Math.ceil(n * a), this.fontSizeW = Math.ceil(r * a), this.fontSizeH = Math.ceil(s * a), 0 <= t._font.indexOf("italic") ? this.fontStr = t._font.replace("italic", "") : this.fontStr = t._font
                }
            }, t.getNextChar = function (t) {
                var e = t.length, i = this._curStrPos;
                if (e <= i) return null;
                for (var n = i, r = 0; n < e; n++) {
                    var s = t.charCodeAt(n);
                    if (s >>> 11 == 27) {
                        if (1 == r) break;
                        r = 1, n++
                    } else if (65038 === s || 65039 === s) ; else if (8205 == s) r = 2; else if (0 == r) r = 1; else if (1 == r) break
                }
                return this._curStrPos = n, t.substring(i, n)
            }, t.filltext = function (t, e, i, n, r, s, a, o, h, l) {
                if (void 0 === l && (l = 0), !(e.length <= 0)) {
                    var u = pe.Parse(r), c = 0;
                    switch (h) {
                        case"center":
                            c = ct.ENUM_TEXTALIGN_CENTER;
                            break;
                        case"right":
                            c = ct.ENUM_TEXTALIGN_RIGHT
                    }
                    this._fast_filltext(t, e, null, i, n, u, s, a, o, c, l)
                }
            }, t.fillWords = function (t, e, i, n, r, s, a, o) {
                if (e && !(e.length <= 0)) {
                    var h = pe.Parse(r);
                    this._fast_filltext(t, null, e, i, n, h, s, a, o, 0, 0)
                }
            }, t._fast_filltext = function (t, e, i, n, r, s, a, o, h, l, u) {
                if (void 0 === u && (u = 0), !(e && e.length < 1 || i && i.length < 1)) {
                    if (h < 0 && (h = 0), this.setFont(s), this.fontScaleX = this.fontScaleY = 1, !Rt.isConchApp && S.scaleFontWithCtx) {
                        var c = 1, _ = 1;
                        if (_ = Rt.isConchApp ? (c = t._curMat.getScaleX(), t._curMat.getScaleY()) : (c = t.getMatScaleX(), t.getMatScaleY()), c < 1e-4 || _ < .1) return;
                        1 < c && (this.fontScaleX = c), 1 < _ && (this.fontScaleY = _)
                    }
                    s._italic && (t._italicDeg = 13);
                    var f = e, d = !i && e instanceof laya.utils.WordText, p = e, m = !!i, g = d ? f.pageChars : [],
                        v = 0;
                    switch (d ? (p = f._text, (v = f.width) < 0 && (v = f.width = this.charRender.getWidth(this.fontStr, p))) : v = p ? this.charRender.getWidth(this.fontStr, p) : 0, l) {
                        case ct.ENUM_TEXTALIGN_CENTER:
                            n -= v / 2;
                            break;
                        case ct.ENUM_TEXTALIGN_RIGHT:
                            n -= v
                    }
                    f && g && this.hasFreedText(g) && (g = f.pageChars = []);
                    var y = null, x = this.renderPerChar = !d || S.forceSplitRender || m || d && f.splitRender;
                    if (!g || g.length < 1) if (x) {
                        var T, b = 0, w = 0;
                        for (this._curStrPos = 0; ;) {
                            if (m) {
                                var C = i[this._curStrPos++];
                                C ? (T = C.char, b = C.x, w = C.y) : T = null
                            } else T = this.getNextChar(p);
                            if (!T) break;
                            if (!(y = this.getCharRenderInfo(T, s, a, o, h, !1))) break;
                            if (y.isSpace) ; else {
                                var A = g[y.tex.id];
                                if (A) A = A.words; else {
                                    var M = {texgen: y.tex.genID, tex: y.tex, words: []};
                                    A = (g[y.tex.id] = M).words
                                }
                                Rt.isConchApp ? A.push({
                                    ri: y,
                                    x: b,
                                    y: w,
                                    w: y.bmpWidth / this.fontScaleX,
                                    h: y.bmpHeight / this.fontScaleY
                                }) : A.push({
                                    ri: y,
                                    x: b + 1 / this.fontScaleX,
                                    y: w,
                                    w: (y.bmpWidth - 2) / this.fontScaleX,
                                    h: (y.bmpHeight - 1) / this.fontScaleY
                                }), b += y.width
                            }
                        }
                    } else {
                        var E = S.noAtlas || v * this.fontScaleX > S.atlasWidth;
                        y = this.getCharRenderInfo(p, s, a, o, h, E), Rt.isConchApp ? g[0] = {
                            texgen: y.tex.genID,
                            tex: y.tex,
                            words: [{
                                ri: y,
                                x: 0,
                                y: 0,
                                w: y.bmpWidth / this.fontScaleX,
                                h: y.bmpHeight / this.fontScaleY
                            }]
                        } : g[0] = {
                            texgen: y.tex.genID,
                            tex: y.tex,
                            words: [{
                                ri: y,
                                x: 1 / this.fontScaleX,
                                y: 0 / this.fontScaleY,
                                w: (y.bmpWidth - 2) / this.fontScaleX,
                                h: (y.bmpHeight - 1) / this.fontScaleY
                            }]
                        }
                    }
                    this._drawResortedWords(t, n, r, g), t._italicDeg = 0
                }
            }, t._drawResortedWords = function (t, e, i, n) {
                for (var r = t._charSubmitCache && t._charSubmitCache._enbale, s = t._curMat, a = n.length, o = 0; o < a; o++) {
                    var h = n[o];
                    if (h) {
                        var l = h.words, u = l.length;
                        if (!(u <= 0)) for (var c = n[o].tex, _ = 0; _ < u; _++) {
                            var f = l[_], d = f.ri;
                            d.isSpace || (d.touch(), t.drawTexAlign = !0, Rt.isConchApp ? t._drawTextureM(c.texture, e + f.x - d.orix, i + f.y - d.oriy, f.w, f.h, null, 1, d.uv) : t._inner_drawTexture(c.texture, c.texture.bitmap.id, e + f.x - d.orix, i + f.y - d.oriy, f.w, f.h, s, d.uv, 1, r), t.touches && t.touches.push(d))
                        }
                    }
                }
            }, t.hasFreedText = function (t) {
                for (var e = t.length, i = 0; i < e; i++) {
                    var n = t[i];
                    if (n) {
                        var r = n.tex;
                        if (r.__destroyed || r.genID != n.texgen) return !0
                    }
                }
                return !1
            }, t.getCharRenderInfo = function (t, e, i, n, r, s) {
                void 0 === s && (s = !1);
                var a = this.mapFont[e._family];
                null == a && (this.mapFont[e._family] = a = this.fontID++);
                var o = t + "_" + a + "_" + e._size + "_" + i;
                0 < r && (o += "_" + n + r), e._bold && (o += "P"), 1 == this.fontScaleX && 1 == this.fontScaleY || (o += (20 * this.fontScaleX | 0) + "_" + (20 * this.fontScaleY | 0));
                var h = 0, l = this.textAtlases.length, u = null, c = null;
                if (!s) for (h = 0; h < l; h++) if (u = (c = this.textAtlases[h]).charMaps[o]) return u.touch(), u;
                u = new dt, this.charRender.scale(this.fontScaleX, this.fontScaleY), u.char = t, u.height = e._size;
                var _ = e._size / 3 | 0, f = null,
                    d = Math.ceil(this.charRender.getWidth(this.fontStr, t) * this.fontScaleX);
                if (d > this.charRender.canvasWidth && (this.charRender.canvasWidth = Math.min(2048, d + 2 * _)), s) {
                    f = this.charRender.getCharBmp(t, this.fontStr, r, i, n, u, _, _, _, _, null);
                    var p = Qe.getTextTexture(f.width, f.height);
                    p.addChar(f, 0, 0, u.uv), u.tex = p, u.orix = _, u.oriy = _, p.ri = u, this.isoTextures.push(p)
                } else {
                    var m = t.length, g = 1 * r, v = Math.ceil((this.fontSizeW + 2 * g) * this.fontScaleX),
                        y = Math.ceil((this.fontSizeH + 2 * g) * this.fontScaleY);
                    S.imgdtRect[0] = (_ - this.fontSizeOffX - g) * this.fontScaleX | 0, S.imgdtRect[1] = (_ - this.fontSizeOffY - g) * this.fontScaleY | 0, this.renderPerChar || 1 == m ? (S.imgdtRect[2] = Math.max(d, v), S.imgdtRect[3] = Math.max(d, y)) : (S.imgdtRect[2] = -1, S.imgdtRect[3] = y), f = this.charRender.getCharBmp(t, this.fontStr, r, i, n, u, _, _, _, _, S.imgdtRect), c = this.addBmpData(f, u), u.oriy = S.isWan1Wan ? u.orix = _ : (u.orix = this.fontSizeOffX + g, this.fontSizeOffY + g), c.charMaps[o] = u
                }
                return u
            }, t.addBmpData = function (t, e) {
                for (var i = t.width, n = t.height, r = this.textAtlases.length, s = null, a = !1, o = 0; o < r && !(a = (s = this.textAtlases[o]).getAEmpty(i, n, this.tmpAtlasPos)); o++) ;
                if (!a) {
                    if (s = new Ut, this.textAtlases.push(s), !(a = s.getAEmpty(i, n, this.tmpAtlasPos))) throw"err1";
                    this.cleanAtlases()
                }
                return a && (s.texture.addChar(t, this.tmpAtlasPos.x, this.tmpAtlasPos.y, e.uv), e.tex = s.texture), s
            }, t.GC = function () {
                for (var t = 0, e = this.textAtlases.length, i = 0, n = S.destroyAtlasDt, r = 0, s = M.loopCount, a = -1, o = 0, h = null, l = null; t < e; t++) {
                    if (h = (l = this.textAtlases[t]).texture) {
                        h.curUsedCovRate, r += h.curUsedCovRateAtlas;
                        var u = l.usedRate - h.curUsedCovRateAtlas;
                        o < u && (o = u, a = t)
                    }
                    n < (i = s - l.texture.lastTouchTm) && (l.destroy(), this.textAtlases[t] = this.textAtlases[e - 1], e--, t--, a = -1)
                }
                for (this.textAtlases.length = e, e = this.isoTextures.length, t = 0; t < e; t++) i = s - (h = this.isoTextures[t]).lastTouchTm, S.destroyUnusedTextureDt < i && (h.ri.deleted = !0, h.ri.tex = null, h.destroy(), this.isoTextures[t] = this.isoTextures[e - 1], e--, t--);
                this.isoTextures.length = e;
                var c = 1 < this.textAtlases.length && 2 <= this.textAtlases.length - r;
                (S.atlasWidth * S.atlasWidth * 4 * this.textAtlases.length > S.cleanMem || c || S.simClean) && (S.simClean = !1, 0 <= a && ((l = this.textAtlases[a]).destroy(), this.textAtlases[a] = this.textAtlases[this.textAtlases.length - 1], this.textAtlases.length = this.textAtlases.length - 1)), Qe.clean()
            }, t.cleanAtlases = function () {
            }, t.getCharBmp = function (t) {
            }, t.checkBmpLine = function (t, e, i, n) {
                this.bmpData32.buffer != t.data.buffer && (this.bmpData32 = new Uint32Array(t.data.buffer));
                for (var r = t.width * e + i, s = i; s < n; s++) if (0 != this.bmpData32[r++]) return !0;
                return !1
            }, t.updateBbx = function (t, e, i) {
                void 0 === i && (i = !1);
                var n = t.width, r = t.height, s = 0, a = e[1], o = 0, h = a;
                if (this.checkBmpLine(t, a, 0, n)) for (; ;) {
                    if (a <= (h = (a + o) / 2 | 0) + 1) {
                        e[1] = h;
                        break
                    }
                    this.checkBmpLine(t, h, 0, n) ? a = h : o = h
                }
                if (e[3] > r) e[3] = r; else if (h = a = e[3], o = r, this.checkBmpLine(t, a, 0, n)) for (; ;) {
                    if ((h = (a + o) / 2 | 0) - 1 <= a) {
                        e[3] = h;
                        break
                    }
                    this.checkBmpLine(t, h, 0, n) ? a = h : o = h
                }
                if (!i) {
                    var l = e[0], u = n * e[1];
                    for (h = e[1]; h < e[3]; h++) {
                        for (s = 0; s < l; s++) if (0 != this.bmpData32[u + s]) {
                            l = s;
                            break
                        }
                        u += n
                    }
                    e[0] = l;
                    var c = e[2];
                    for (u = n * e[1], h = e[1]; h < e[3]; h++) {
                        for (s = c; s < n; s++) if (0 != this.bmpData32[u + s]) {
                            c = s;
                            break
                        }
                        u += n
                    }
                    e[2] = c
                }
            }, t.getFontSizeInfo = function (t) {
                var e = this.fontSizeInfo[t];
                if (null != e) return e;
                var i = "bold " + S.standardFontSize + "px " + t;
                if (S.isWan1Wan) {
                    this.fontSizeW = 1.5 * this.charRender.getWidth(i, "有"), this.fontSizeH = 1.5 * S.standardFontSize;
                    var n = this.fontSizeW << 8 | this.fontSizeH;
                    return this.fontSizeInfo[t] = n
                }
                S.pixelBBX[0] = S.standardFontSize / 2, S.pixelBBX[1] = S.standardFontSize / 2, S.pixelBBX[2] = S.standardFontSize, S.pixelBBX[3] = S.standardFontSize;
                var r = 16, s = 16;
                this.charRender.scale(1, 1), S.tmpRI.height = S.standardFontSize;
                var a = this.charRender.getCharBmp("g", i, 0, "red", null, S.tmpRI, r, s, 16, 16);
                Rt.isConchApp && (a.data = new Uint8ClampedArray(a.data)), this.bmpData32 = new Uint32Array(a.data.buffer), this.updateBbx(a, S.pixelBBX, !1), a = this.charRender.getCharBmp("有", i, 0, "red", null, S.tmpRI, s, s, 16, 16), Rt.isConchApp && (a.data = new Uint8ClampedArray(a.data)), this.bmpData32 = new Uint32Array(a.data.buffer), S.pixelBBX[2] < r + S.tmpRI.width && (S.pixelBBX[2] = r + S.tmpRI.width), this.updateBbx(a, S.pixelBBX, !1), Rt.isConchApp && (s = r = 0);
                var o = Math.max(r - S.pixelBBX[0], 0) << 24 | Math.max(s - S.pixelBBX[1], 0) << 16 | S.pixelBBX[2] - S.pixelBBX[0] << 8 | S.pixelBBX[3] - S.pixelBBX[1] + 2;
                return this.fontSizeInfo[t] = o
            }, t.printDbgInfo = function () {
                for (var t in this.mapFont) this.getFontSizeInfo(t);
                this.textAtlases.forEach(function (t) {
                    t.texture.id, M.loopCount, t.texture.lastTouchTm;
                    for (var e in t.texture.curUsedCovRate, t.texture.curUsedCovRateAtlas, t.charMaps) {
                        t.charMaps[e];
                        0
                    }
                }), this.isoTextures.forEach(function (t) {
                })
            }, t.showAtlas = function (t, i, e, n, r, s) {
                if (!this.textAtlases[t]) return null;
                var a = new je, o = this.textAtlases[t].texture, h = {
                    width: S.atlasWidth,
                    height: S.atlasWidth,
                    sourceWidth: S.atlasWidth,
                    sourceHeight: S.atlasWidth,
                    offsetX: 0,
                    offsetY: 0,
                    getIsReady: function () {
                        return !0
                    },
                    _addReference: function () {
                    },
                    _removeReference: function () {
                    },
                    _getSource: function () {
                        return o._getSource()
                    },
                    bitmap: {id: o.id},
                    _uv: Ie.DEF_UV
                };
                return a.size = function (t, e) {
                    return this.width = t, this.height = e, a.graphics.clear(), a.graphics.drawRect(0, 0, a.width, a.height, i), a.graphics.drawTexture(h, 0, 0, a.width, a.height), this
                }, a.graphics.drawRect(0, 0, r, s, i), a.graphics.drawTexture(h, 0, 0, r, s), a.pos(e, n), y.stage.addChild(a), a
            }, t.filltext_native = function (t, e, i, n, r, s, a, o, h, l, u) {
                if (void 0 === u && (u = 0), !(e && e.length <= 0 || i && i.length < 1)) {
                    var c = pe.Parse(s), _ = 0;
                    switch (l) {
                        case"center":
                            _ = ct.ENUM_TEXTALIGN_CENTER;
                            break;
                        case"right":
                            _ = ct.ENUM_TEXTALIGN_RIGHT
                    }
                    return this._fast_filltext(t, e, i, n, r, c, a, o, h, _, u)
                }
            }, S.useOldCharBook = !1, S.atlasWidth = 2048, S.noAtlas = !1, S.forceSplitRender = !1, S.forceWholeRender = !1, S.scaleFontWithCtx = !0, S.standardFontSize = 32, S.destroyAtlasDt = 10, S.checkCleanTextureDt = 2e3, S.destroyUnusedTextureDt = 3e3, S.cleanMem = 104857600, S.isWan1Wan = !1, S.showLog = !1, S.debugUV = !1, S.atlasWidth2 = 4194304, S.textRenderInst = null, S.simClean = !1, a(S, ["tmpRI", function () {
                return this.tmpRI = new dt
            }, "pixelBBX", function () {
                return this.pixelBBX = [0, 0, 0, 0]
            }, "imgdtRect", function () {
                return this.imgdtRect = [0, 0, 0, 0]
            }]), S
        }(), M = function () {
            function h() {
            }

            return x(h, "laya.utils.Stat"), d(1, h, "onclick", null, function (t) {
                h._sp && h._sp.on("click", h._sp, t), h._canvas && (h._canvas.source.onclick = t, h._canvas.source.style.pointerEvents = "")
            }), h.show = function (t, e) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), Lt.onMiniGame || Lt.onLimixiu || Rt.isConchApp || Lt.onBDMiniGame || Lt.onKGMiniGame || Lt.onQGMiniGame || Lt.onVVMiniGame || Lt.onAlipayMiniGame || Lt.onBLMiniGame || Lt.onQQMiniGame || (h._useCanvas = !0), h._show = !0, h._fpsData.length = 60, h._view[0] = {
                    title: "FPS(Canvas)",
                    value: "_fpsStr",
                    color: "yellow",
                    units: "int"
                }, h._view[1] = {
                    title: "Sprite",
                    value: "_spriteStr",
                    color: "white",
                    units: "int"
                }, h._view[2] = {
                    title: "RenderBatches",
                    value: "renderBatches",
                    color: "white",
                    units: "int"
                }, h._view[3] = {
                    title: "SavedRenderBatches",
                    value: "savedRenderBatches",
                    color: "white",
                    units: "int"
                }, h._view[4] = {
                    title: "CPUMemory",
                    value: "cpuMemory",
                    color: "yellow",
                    units: "M"
                }, h._view[5] = {
                    title: "GPUMemory",
                    value: "gpuMemory",
                    color: "yellow",
                    units: "M"
                }, h._view[6] = {
                    title: "Shader",
                    value: "shaderCall",
                    color: "white",
                    units: "int"
                }, Rt.is3DMode ? (h._view[0].title = "FPS(3D)", h._view[7] = {
                    title: "TriFaces",
                    value: "trianglesFaces",
                    color: "white",
                    units: "int"
                }, h._view[8] = {
                    title: "FrustumCulling",
                    value: "frustumCulling",
                    color: "white",
                    units: "int"
                }, h._view[9] = {
                    title: "OctreeNodeCulling",
                    value: "octreeNodeCulling",
                    color: "white",
                    units: "int"
                }) : (h._view[0].title = "FPS(WebGL)", h._view[7] = {
                    title: "Canvas",
                    value: "_canvasStr",
                    color: "white",
                    units: "int"
                }), h._useCanvas ? h.createUIPre(t, e) : h.createUI(t, e), h.enable()
            }, h.createUIPre = function (t, e) {
                var i = Lt.pixelRatio;
                (Lt.onQGMiniGame || Lt.onVVMiniGame) && (i = 3), h._width = 180 * i, h._vx = 120 * i, h._height = i * (12 * h._view.length + 3 * i) + 4, h._fontSize = 12 * i;
                for (var n = 0; n < h._view.length; n++) h._view[n].x = 4, h._view[n].y = n * h._fontSize + 2 * i;
                h._canvas || ((h._canvas = new si(!0)).size(h._width, h._height), (h._ctx = h._canvas.getContext("2d")).textBaseline = "top", h._ctx.font = h._fontSize + "px Arial", h._canvas.source.style.cssText = "pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:" + t + "px;top:" + e + "px;width:" + h._width / i + "px;height:" + h._height / i + "px;"), Lt.onKGMiniGame || Lt.container.appendChild(h._canvas.source), h._first = !0, h.loop(), h._first = !1
            }, h.createUI = function (t, e) {
                var i = h._sp, n = Lt.pixelRatio;
                (Lt.onQGMiniGame || Lt.onVVMiniGame) && (n = 3), i || (i = new je, (h._leftText = new ei).pos(5, 5), h._leftText.color = "#ffffff", i.addChild(h._leftText), (h._txt = new ei).pos(80 * n, 5), h._txt.color = "#ffffff", i.addChild(h._txt), h._sp = i), i.pos(t, e);
                for (var r = "", s = 0; s < h._view.length; s++) {
                    r += h._view[s].title + "\n"
                }
                h._leftText.text = r;
                var a = 138 * n, o = n * (12 * h._view.length + 3 * n) + 4;
                h._txt.fontSize = h._fontSize * n, h._leftText.fontSize = h._fontSize * n, i.size(a, o), i.graphics.clear(), i.graphics.alpha(.5), i.graphics.drawRect(0, 0, a, o, "#999999"), i.graphics.alpha(2), h.loop()
            }, h.enable = function () {
                y.systemTimer.frameLoop(1, h, h.loop)
            }, h.hide = function () {
                h._show = !1, y.systemTimer.clear(h, h.loop), h._canvas && Lt.removeElement(h._canvas.source)
            }, h.clear = function () {
                h.trianglesFaces = h.renderBatches = h.savedRenderBatches = h.shaderCall = h.spriteRenderUseCacheCount = h.frustumCulling = h.octreeNodeCulling = h.canvasNormal = h.canvasBitmap = h.canvasReCache = 0
            }, h.loop = function () {
                h._count++;
                var t = Lt.now();
                if (!(t - h._timer < 1e3)) {
                    var e = h._count;
                    if (h.FPS = Math.round(1e3 * e / (t - h._timer)), h._show) {
                        h.trianglesFaces = Math.round(h.trianglesFaces / e), h.renderBatches = h._useCanvas ? Math.round(h.renderBatches / e) : Math.round(h.renderBatches / e) - 1, h.savedRenderBatches = Math.round(h.savedRenderBatches / e), h.shaderCall = Math.round(h.shaderCall / e), h.spriteRenderUseCacheCount = Math.round(h.spriteRenderUseCacheCount / e), h.canvasNormal = Math.round(h.canvasNormal / e), h.canvasBitmap = Math.round(h.canvasBitmap / e), h.canvasReCache = Math.ceil(h.canvasReCache / e), h.frustumCulling = Math.round(h.frustumCulling / e), h.octreeNodeCulling = Math.round(h.octreeNodeCulling / e);
                        var i = 0 < h.FPS ? Math.floor(1e3 / h.FPS).toString() : " ";
                        h._fpsStr = h.FPS + (h.renderSlow ? " slow" : "") + " " + i, h._spriteStr = h._useCanvas ? h.spriteCount - 1 + (h.spriteRenderUseCacheCount ? "/" + h.spriteRenderUseCacheCount : "") : h.spriteCount - 4 + (h.spriteRenderUseCacheCount ? "/" + h.spriteRenderUseCacheCount : ""), h._canvasStr = h.canvasReCache + "/" + h.canvasNormal + "/" + h.canvasBitmap, h.cpuMemory = Me.cpuMemory, h.gpuMemory = Me.gpuMemory, h._useCanvas ? h.renderInfoPre() : h.renderInfo(), h.clear()
                    }
                    h._count = 0, h._timer = t
                }
            }, h.renderInfoPre = function () {
                var t, e, i = 0;
                if (h._canvas) {
                    var n = h._ctx;
                    for (n.clearRect(h._first ? 0 : h._vx, 0, h._width, h._height), i = 0; i < h._view.length; i++) t = h._view[i], h._first && (n.fillStyle = "white", n.fillText(t.title, t.x, t.y)), n.fillStyle = t.color, e = h[t.value], "M" == t.units && (e = Math.floor(e / 1048576 * 100) / 100 + " M"), n.fillText(e + "", t.x + h._vx, t.y)
                }
            }, h.renderInfo = function () {
                for (var t = "", e = 0; e < h._view.length; e++) {
                    var i = h._view[e], n = h[i.value];
                    "M" == i.units && (n = Math.floor(n / 1048576 * 100) / 100 + " M"), "K" == i.units && (n = Math.floor(n / 1024 * 100) / 100 + " K"), t += n + "\n"
                }
                h._txt.text = t
            }, h.FPS = 0, h.loopCount = 0, h.shaderCall = 0, h.renderBatches = 0, h.savedRenderBatches = 0, h.trianglesFaces = 0, h.spriteCount = 0, h.spriteRenderUseCacheCount = 0, h.frustumCulling = 0, h.octreeNodeCulling = 0, h.canvasNormal = 0, h.canvasBitmap = 0, h.canvasReCache = 0, h.renderSlow = !1, h.gpuMemory = 0, h.cpuMemory = 0, h._fpsStr = null, h._canvasStr = null, h._spriteStr = null, h._fpsData = [], h._timer = 0, h._count = 0, h._view = [], h._fontSize = 12, h._txt = null, h._leftText = null, h._sp = null, h._titleSp = null, h._bgSp = null, h._show = !1, h._useCanvas = !1, h._canvas = null, h._ctx = null, h._first = !1, h._vx = NaN, h._width = 0, h._height = 100, h
        }(), S = function () {
            var n;

            function t() {
                this._lastOriX = 0, this._lastOriY = 0, this.paths = [], this._curPath = null
            }

            x(t, "laya.webgl.canvas.Path");
            var e = t.prototype;
            return e.beginPath = function (t) {
                this.paths.length = 1, this._curPath = this.paths[0] = new n, this._curPath.convex = t
            }, e.closePath = function () {
                this._curPath.loop = !0
            }, e.newPath = function () {
                this._curPath = new n, this.paths.push(this._curPath)
            }, e.addPoint = function (t, e) {
                this._curPath.path.push(t, e)
            }, e.push = function (t, e) {
                this._curPath ? 0 < this._curPath.path.length && (this._curPath = new n, this.paths.push(this._curPath)) : (this._curPath = new n, this.paths.push(this._curPath));
                var i = this._curPath;
                i.path = t.slice(), i.convex = e
            }, e.reset = function () {
                this.paths.length = 0
            }, t.__init$ = function () {
                n = function () {
                    function t() {
                        this.path = [], this.loop = !1, this.convex = !1
                    }

                    return x(t, ""), t
                }()
            }, t
        }(), R = function () {
            function o() {
                this.mouseX = 0, this.mouseY = 0, this.disableMouseEvent = !1, this.mouseDownTime = 0, this.mouseMoveAccuracy = 2, this._stage = null, this._captureSp = null, this._captureExlusiveMode = !1, this._hitCaputreSp = !1, this._target = null, this._lastMoveTimer = 0, this._isLeftMouse = !1, this._touchIDs = {}, this._id = 1, this._tTouchID = 0, this._event = new e, this._captureChain = [], this._matrix = new at, this._point = new Ht, this._rect = new gt, this._prePoint = new Ht, this._curTouchID = NaN
            }

            x(o, "laya.events.MouseManager");
            var t = o.prototype;
            return t.__init__ = function (t, e) {
                var i = this;
                this._stage = t;
                var n = this;
                e.oncontextmenu = function (t) {
                    if (o.enabled) return !1
                }, e.addEventListener("mousedown", function (t) {
                    o.enabled && (Lt.onIE || t.preventDefault(), n.mouseDownTime = Lt.now(), i.runEvent(t))
                }), e.addEventListener("mouseup", function (t) {
                    o.enabled && (t.preventDefault(), n.mouseDownTime = -Lt.now(), i.runEvent(t))
                }, !0), e.addEventListener("mousemove", function (t) {
                    if (o.enabled) {
                        t.preventDefault();
                        var e = Lt.now();
                        if (e - n._lastMoveTimer < 10) return;
                        n._lastMoveTimer = e, i.runEvent(t)
                    }
                }, !0), e.addEventListener("mouseout", function (t) {
                    o.enabled && i.runEvent(t)
                }), e.addEventListener("mouseover", function (t) {
                    o.enabled && i.runEvent(t)
                }), e.addEventListener("touchstart", function (t) {
                    o.enabled && (o._isFirstTouch || li.isInputting || t.preventDefault(), n.mouseDownTime = Lt.now(), i.runEvent(t))
                }), e.addEventListener("touchend", function (t) {
                    o.enabled ? (o._isFirstTouch || li.isInputting || t.preventDefault(), o._isFirstTouch = !1, n.mouseDownTime = -Lt.now(), i.runEvent(t)) : i._curTouchID = NaN
                }, !0), e.addEventListener("touchmove", function (t) {
                    o.enabled && (t.preventDefault(), i.runEvent(t))
                }, !0), e.addEventListener("touchcancel", function (t) {
                    o.enabled ? (t.preventDefault(), i.runEvent(t)) : i._curTouchID = NaN
                }, !0), e.addEventListener("mousewheel", function (t) {
                    o.enabled && i.runEvent(t)
                }), e.addEventListener("DOMMouseScroll", function (t) {
                    o.enabled && i.runEvent(t)
                })
            }, t.initEvent = function (t, e) {
                var i, n = this;
                n._event._stoped = !1, n._event.nativeEvent = e || t, n._target = null, this._point.setTo(t.pageX || t.clientX, t.pageY || t.clientY), this._stage._canvasTransform && (this._stage._canvasTransform.invertTransformPoint(this._point), n.mouseX = this._point.x, n.mouseY = this._point.y), n._event.touchId = t.identifier || 0, this._tTouchID = n._event.touchId, (i = u.I._event)._stoped = !1, i.nativeEvent = n._event.nativeEvent, i.touchId = n._event.touchId
            }, t.checkMouseWheel = function (t) {
                this._event.delta = t.wheelDelta ? .025 * t.wheelDelta : -t.detail;
                for (var e = u.I.getLastOvers(), i = 0, n = e.length; i < n; i++) {
                    var r = e[i];
                    r.event("mousewheel", this._event.setTo("mousewheel", r, this._target))
                }
            }, t.onMouseMove = function (t) {
                u.I.onMouseMove(t, this._tTouchID)
            }, t.onMouseDown = function (t) {
                if (li.isInputting && y.stage.focus && y.stage.focus.focus && !y.stage.focus.contains(this._target)) {
                    var e = y.stage.focus._tf || y.stage.focus, i = t._tf || t;
                    i instanceof laya.display.Input && i.multiline == e.multiline ? e._focusOut() : e.focus = !1
                }
                u.I.onMouseDown(t, this._tTouchID, this._isLeftMouse)
            }, t.onMouseUp = function (t) {
                u.I.onMouseUp(t, this._tTouchID, this._isLeftMouse)
            }, t.check = function (t, e, i, n) {
                this._point.setTo(e, i), t.fromParentPoint(this._point), e = this._point.x, i = this._point.y;
                var r = t._style.scrollRect;
                if (r && (this._rect.setTo(r.x, r.y, r.width, r.height), !this._rect.contains(e, i))) return !1;
                if (!this.disableMouseEvent) {
                    if (t.hitTestPrior && !t.mouseThrough && !this.hitTest(t, e, i)) return !1;
                    for (var s = t._children.length - 1; -1 < s; s--) {
                        var a = t._children[s];
                        if (!a.destroyed && 1 < a._mouseState && a._visible && this.check(a, e, i, n)) return !0
                    }
                    for (s = t._extUIChild.length - 1; 0 <= s; s--) {
                        var o = t._extUIChild[s];
                        if (!o.destroyed && 1 < o._mouseState && o._visible && this.check(o, e, i, n)) return !0
                    }
                }
                var h = !(!t.hitTestPrior || t.mouseThrough || this.disableMouseEvent) || this.hitTest(t, e, i);
                return h ? (this._target = t, n.call(this, t), this._target == this._hitCaputreSp && (this._hitCaputreSp = !0)) : n === this.onMouseUp && t === this._stage && (this._target = this._stage, n.call(this, this._target)), h
            }, t.hitTest = function (t, e, i) {
                var n = !1;
                t.scrollRect && (e -= t._style.scrollRect.x, i -= t._style.scrollRect.y);
                var r = t._style.hitArea;
                return r && r._hit ? r.contains(e, i) : ((0 < t.width && 0 < t.height || t.mouseThrough || r) && (n = t.mouseThrough ? t.getGraphicBounds().contains(e, i) : (r || this._rect.setTo(0, 0, t.width, t.height)).contains(e, i)), n)
            }, t._checkAllBaseUI = function (t, e, i) {
                var n = this.handleExclusiveCapture(this.mouseX, this.mouseY, i);
                return !!n || (n = this.check(this._stage, this.mouseX, this.mouseY, i), this.handleCapture(this.mouseX, this.mouseY, i) || n)
            }, t.check3DUI = function (t, e, i) {
                for (var n = this._stage._3dUI, r = 0, s = !1; r < n.length; r++) {
                    var a = n[r];
                    !(this._stage._curUIBase = a).destroyed && 1 < a._mouseState && a._visible && (s = s || this.check(a, this.mouseX, this.mouseY, i))
                }
                return this._stage._curUIBase = this._stage, s
            }, t.handleExclusiveCapture = function (t, e, i) {
                if (this._captureExlusiveMode && this._captureSp && 0 < this._captureChain.length) {
                    var n;
                    this._point.setTo(t, e);
                    for (var r = 0; r < this._captureChain.length; r++) (n = this._captureChain[r]).fromParentPoint(this._point);
                    return this._target = n, i.call(this, n), !0
                }
                return !1
            }, t.handleCapture = function (t, e, i) {
                if (!this._hitCaputreSp && this._captureSp && 0 < this._captureChain.length) {
                    var n;
                    this._point.setTo(t, e);
                    for (var r = 0; r < this._captureChain.length; r++) (n = this._captureChain[r]).fromParentPoint(this._point);
                    return this._target = n, i.call(this, n), !0
                }
                return !1
            }, t.runEvent = function (t) {
                var e, i = 0, n = 0;
                switch ("mousemove" !== t.type && (this._prePoint.x = this._prePoint.y = -1e6), t.type) {
                    case"mousedown":
                        this._touchIDs[0] = this._id++, o._isTouchRespond ? o._isTouchRespond = !1 : (this._isLeftMouse = 0 === t.button, this.initEvent(t), this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseDown));
                        break;
                    case"mouseup":
                        this._isLeftMouse = 0 === t.button, this.initEvent(t), this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseUp);
                        break;
                    case"mousemove":
                        Math.abs(this._prePoint.x - t.clientX) + Math.abs(this._prePoint.y - t.clientY) >= this.mouseMoveAccuracy && (this._prePoint.x = t.clientX, this._prePoint.y = t.clientY, this.initEvent(t), this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseMove));
                        break;
                    case"touchstart":
                        o._isTouchRespond = !0, this._isLeftMouse = !0;
                        var r = t.changedTouches;
                        for (i = 0, n = r.length; i < n; i++) e = r[i], (o.multiTouchEnabled || isNaN(this._curTouchID)) && (this._curTouchID = e.identifier, this._id % 200 == 0 && (this._touchIDs = {}), this._touchIDs[e.identifier] = this._id++, this.initEvent(e, t), this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseDown));
                        break;
                    case"touchend":
                    case"touchcancel":
                        o._isTouchRespond = !0, this._isLeftMouse = !0;
                        var s = t.changedTouches;
                        for (i = 0, n = s.length; i < n; i++) if (e = s[i], o.multiTouchEnabled || e.identifier == this._curTouchID) {
                            this._curTouchID = NaN, this.initEvent(e, t);
                            this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseUp) || this.onMouseUp(null)
                        }
                        break;
                    case"touchmove":
                        var a = t.changedTouches;
                        for (i = 0, n = a.length; i < n; i++) e = a[i], (o.multiTouchEnabled || e.identifier == this._curTouchID) && (this.initEvent(e, t), this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseMove));
                        break;
                    case"wheel":
                    case"mousewheel":
                    case"DOMMouseScroll":
                        this.checkMouseWheel(t);
                        break;
                    case"mouseout":
                        u.I.stageMouseOut();
                        break;
                    case"mouseover":
                        this._stage.event("mouseover", this._event.setTo("mouseover", this._stage, this._stage))
                }
            }, t.setCapture = function (t, e) {
                void 0 === e && (e = !1), this._captureSp = t, this._captureExlusiveMode = e, this._captureChain.length = 0, this._captureChain.push(t);
                for (var i = t; i != y.stage && i != y.stage._curUIBase && (i = i.parent);) this._captureChain.splice(0, 0, i)
            }, t.releaseCapture = function () {
                this._captureSp = null
            }, o.enabled = !0, o.multiTouchEnabled = !0, o._isTouchRespond = !1, o._isFirstTouch = !0, a(o, ["instance", function () {
                return this.instance = new o
            }]), o
        }(), I = function () {
            function t() {
                this.useDic = {}, this.shapeDic = {}, this.shapeLineDic = {}, this._id = 0, this._checkKey = !1, this._freeIdArray = [], Z.regCacheByFunction(ne.bind(this.startDispose, this), ne.bind(this.getCacheList, this))
            }

            x(t, "laya.utils.VectorGraphManager");
            var e = t.prototype;
            return e.getId = function () {
                return this._id++
            }, e.addShape = function (t, e) {
                this.shapeDic[t] = e, this.useDic[t] || (this.useDic[t] = !0)
            }, e.addLine = function (t, e) {
                this.shapeLineDic[t] = e, this.shapeLineDic[t] || (this.shapeLineDic[t] = !0)
            }, e.getShape = function (t) {
                this._checkKey && null != this.useDic[t] && (this.useDic[t] = !0)
            }, e.deleteShape = function (t) {
                this.shapeDic[t] && (this.shapeDic[t] = null, delete this.shapeDic[t]), this.shapeLineDic[t] && (this.shapeLineDic[t] = null, delete this.shapeLineDic[t]), null != this.useDic[t] && delete this.useDic[t]
            }, e.getCacheList = function () {
                var t, e = [];
                for (t in this.shapeDic) e.push(this.shapeDic[t]);
                for (t in this.shapeLineDic) e.push(this.shapeLineDic[t]);
                return e
            }, e.startDispose = function (t) {
                var e;
                for (e in this.useDic) this.useDic[e] = !1;
                this._checkKey = !0
            }, e.endDispose = function () {
                if (this._checkKey) {
                    var t;
                    for (t in this.useDic) this.useDic[t] || this.deleteShape(t);
                    this._checkKey = !1
                }
            }, t.getInstance = function () {
                return t.instance = t.instance || new t
            }, t.instance = null, t
        }(), i = function () {
            function r() {
            }

            return x(r, "laya.maths.MathUtil"), r.subtractVector3 = function (t, e, i) {
                i[0] = t[0] - e[0], i[1] = t[1] - e[1], i[2] = t[2] - e[2]
            }, r.lerp = function (t, e, i) {
                return t * (1 - i) + e * i
            }, r.scaleVector3 = function (t, e, i) {
                i[0] = t[0] * e, i[1] = t[1] * e, i[2] = t[2] * e
            }, r.lerpVector3 = function (t, e, i, n) {
                var r = t[0], s = t[1], a = t[2];
                n[0] = r + i * (e[0] - r), n[1] = s + i * (e[1] - s), n[2] = a + i * (e[2] - a)
            }, r.lerpVector4 = function (t, e, i, n) {
                var r = t[0], s = t[1], a = t[2], o = t[3];
                n[0] = r + i * (e[0] - r), n[1] = s + i * (e[1] - s), n[2] = a + i * (e[2] - a), n[3] = o + i * (e[3] - o)
            }, r.slerpQuaternionArray = function (t, e, i, n, r, s, a) {
                var o, h, l, u, c, _ = t[e + 0], f = t[e + 1], d = t[e + 2], p = t[e + 3], m = i[n + 0], g = i[n + 1],
                    v = i[n + 2], y = i[n + 3];
                return (h = _ * m + f * g + d * v + p * y) < 0 && (h = -h, m = -m, g = -g, v = -v, y = -y), c = 1e-6 < 1 - h ? (o = Math.acos(h), l = Math.sin(o), u = Math.sin((1 - r) * o) / l, Math.sin(r * o) / l) : (u = 1 - r, r), s[a + 0] = u * _ + c * m, s[a + 1] = u * f + c * g, s[a + 2] = u * d + c * v, s[a + 3] = u * p + c * y, s
            }, r.getRotation = function (t, e, i, n) {
                return Math.atan2(n - e, i - t) / Math.PI * 180
            }, r.sortBigFirst = function (t, e) {
                return t == e ? 0 : t < e ? 1 : -1
            }, r.sortSmallFirst = function (t, e) {
                return t == e ? 0 : t < e ? -1 : 1
            }, r.sortNumBigFirst = function (t, e) {
                return parseFloat(e) - parseFloat(t)
            }, r.sortNumSmallFirst = function (t, e) {
                return parseFloat(t) - parseFloat(e)
            }, r.sortByKey = function (i, t, e) {
                var n;
                return void 0 === t && (t = !1), void 0 === e && (e = !0), n = t ? e ? r.sortNumBigFirst : r.sortBigFirst : e ? r.sortNumSmallFirst : r.sortSmallFirst, function (t, e) {
                    return n(t[i], e[i])
                }
            }, r
        }(), P = function () {
            function d(t, e) {
                if (n.map[t]) return this._fun = n.map[t], void (this._next = d.NORENDER);
                switch (this._next = e || d.NORENDER, t) {
                    case 0:
                        return void (this._fun = this._no);
                    case 1:
                        return void (this._fun = this._alpha);
                    case 2:
                        return void (this._fun = this._transform);
                    case 4:
                        return void (this._fun = this._blend);
                    case 8:
                        return void (this._fun = this._canvas);
                    case 32:
                        return void (this._fun = this._mask);
                    case 64:
                        return void (this._fun = this._clip);
                    case 128:
                        return void (this._fun = this._style);
                    case 512:
                        return void (this._fun = this._graphics);
                    case 8192:
                        return void (this._fun = this._children);
                    case 2048:
                        return void (this._fun = this._custom);
                    case 256:
                        return void (this._fun = this._texture);
                    case 16:
                        return void (this._fun = l._filter);
                    case 69905:
                        return void (this._fun = d._initRenderFun)
                }
                this.onCreate(t)
            }

            x(d, "laya.renders.RenderSprite");
            var t = d.prototype;
            return t.onCreate = function (t) {
            }, t._style = function (t, e, i, n) {
                var r = t._style;
                null != r.render && r.render(t, e, i, n);
                var s = this._next;
                s._fun.call(s, t, e, i, n)
            }, t._no = function (t, e, i, n) {
            }, t._custom = function (t, e, i, n) {
                t.customRender(e, i, n), this._next._fun.call(this._next, t, e, i - t.pivotX, n - t.pivotY)
            }, t._clip = function (t, e, i, n) {
                var r = this._next;
                if (r != d.NORENDER) {
                    var s = t._style.scrollRect;
                    e.save(), e.clipRect(i, n, s.width, s.height), r._fun.call(r, t, e, i - s.x, n - s.y), e.restore()
                }
            }, t._texture = function (t, e, i, n) {
                var r = t.texture;
                r._getSource() && e.drawTexture(r, i - t.pivotX + r.offsetX, n - t.pivotY + r.offsetY, t._width || r.width, t._height || r.height);
                var s = this._next;
                s != d.NORENDER && s._fun.call(s, t, e, i, n)
            }, t._graphics = function (t, e, i, n) {
                var r = t._style, s = t._graphics;
                s && s._render(t, e, i - r.pivotX, n - r.pivotY);
                var a = this._next;
                a != d.NORENDER && a._fun.call(a, t, e, i, n)
            }, t._image = function (t, e, i, n) {
                var r = t._style;
                e.drawTexture2(i, n, r.pivotX, r.pivotY, t.transform, t._graphics._one)
            }, t._image2 = function (t, e, i, n) {
                var r = t._style;
                e.drawTexture2(i, n, r.pivotX, r.pivotY, t.transform, t._graphics._one)
            }, t._alpha = function (t, e, i, n) {
                var r;
                if (.01 < (r = t._style.alpha) || t._needRepaint()) {
                    var s = e.globalAlpha;
                    e.globalAlpha *= r;
                    var a = this._next;
                    a._fun.call(a, t, e, i, n), e.globalAlpha = s
                }
            }, t._transform = function (t, e, i, n) {
                var r = t.transform, s = this._next;
                t._style;
                r && s != d.NORENDER ? (e.save(), e.transform(r.a, r.b, r.c, r.d, r.tx + i, r.ty + n), s._fun.call(s, t, e, 0, 0), e.restore()) : s != d.NORENDER && s._fun.call(s, t, e, i, n)
            }, t._children = function (t, e, i, n) {
                var r, s = t._style, a = t._children, o = a.length;
                i -= t.pivotX, n -= t.pivotY;
                var h = t._getBit(256) && e.drawCallOptimize(!0);
                if (s.viewport) {
                    var l = s.viewport, u = l.x, c = l.y, _ = l.right, f = l.bottom, d = NaN, p = NaN;
                    for (m = 0; m < o; ++m) (r = a[m])._visible && (d = r._x) < _ && d + r.width > u && (p = r._y) < f && p + r.height > c && r.render(e, i, n)
                } else for (var m = 0; m < o; ++m) (r = a[m])._visible && r.render(e, i, n);
                h && e.drawCallOptimize(!1)
            }, t._canvas = function (t, e, i, n) {
                var r = t._cacheStyle, s = this._next;
                if (r.enableCanvasRender) {
                    "bitmap" === r.cacheAs ? M.canvasBitmap++ : M.canvasNormal++;
                    var a = !1, o = !1;
                    if (r.canvas) {
                        var h = r.canvas, l = (h.context, h.touches);
                        if (l) for (var u = 0; u < l.length; u++) if (l[u].deleted) {
                            o = !0;
                            break
                        }
                        a = h.isCacheValid && !h.isCacheValid()
                    }
                    if (t._needRepaint() || !r.canvas || o || a || y.stage.isGlobalRepaint()) if ("normal" === r.cacheAs) {
                        if (e._targets) return void s._fun.call(s, t, e, i, n);
                        this._canvas_webgl_normal_repaint(t, e)
                    } else this._canvas_repaint(t, e, i, n);
                    var c = r.cacheRect;
                    e.drawCanvas(r.canvas, i + c.x, n + c.y, c.width, c.height)
                } else s._fun.call(s, t, e, i, n)
            }, t._canvas_repaint = function (t, e, i, n) {
                var r, s, a, o, h, l, u, c, _, f = t._cacheStyle, d = this._next, p = f.canvas, m = f.cacheAs;
                if (u = (_ = f._calculateCacheRect(t, m, i, n)).x, c = _.y, h = (o = f.cacheRect).width * u, l = o.height * c, s = o.x, a = o.y, "bitmap" === m && (2048 < h || 2048 < l)) return f.releaseContext(), void d._fun.call(d, t, e, i, n);
                if (p || (f.createContext(), p = f.canvas), (r = p.context).sprite = t, (p.width != h || p.height != l) && p.size(h, l), "bitmap" === m ? r.asBitmap = !0 : "normal" === m && (r.asBitmap = !1), r.clear(), 1 != u || 1 != c) {
                    var g = r;
                    g.save(), g.scale(u, c), d._fun.call(d, t, r, -s, -a), g.restore(), t._applyFilters()
                } else g = r, d._fun.call(d, t, r, -s, -a), t._applyFilters();
                f.staticCache && (f.reCache = !1), M.canvasReCache++
            }, t._canvas_webgl_normal_repaint = function (t, e) {
                var i = t._cacheStyle, n = this._next, r = i.canvas, s = i.cacheAs;
                i._calculateCacheRect(t, s, 0, 0);
                r || (r = i.canvas = new y.WebGLCacheAsNormalCanvas(e, t));
                var a = r.context;
                r.startRec(), n._fun.call(n, t, a, t.pivotX, t.pivotY), t._applyFilters(), M.canvasReCache++, r.endRec()
            }, t._blend = function (t, e, i, n) {
                var r = t._style, s = this._next;
                r.blendMode ? (e.save(), e.globalCompositeOperation = r.blendMode, s._fun.call(s, t, e, i, n), e.restore()) : s._fun.call(s, t, e, i, n)
            }, t._mask = function (t, e, i, n) {
                var r = this._next, s = t.mask, a = e;
                if (s) {
                    a.save();
                    var o = a.globalCompositeOperation, h = new gt;
                    if (h.copyFrom(s.getBounds()), h.width = Math.round(h.width), h.height = Math.round(h.height), h.x = Math.round(h.x), h.y = Math.round(h.y), 0 < h.width && 0 < h.height) {
                        var l = h.width, u = h.height, c = ie.getRT(l, u);
                        a.breakNextMerge(), a.pushRT(), a.addRenderObject(Q.create([a, c, l, u], d.tmpTarget, this)), s.render(a, -h.x, -h.y), a.breakNextMerge(), a.popRT(), a.save(), a.clipRect(i + h.x - t.getStyle().pivotX, n + h.y - t.getStyle().pivotY, l, u), r._fun.call(r, t, a, i, n), a.restore(), o = a.globalCompositeOperation, a.addRenderObject(Q.create(["mask"], d.setBlendMode, this));
                        var _ = Y.create(1, 0), f = Ie.INV_UV;
                        a.drawTarget(c, i + h.x - t.getStyle().pivotX, n + h.y - t.getStyle().pivotY, l, u, at.TEMP.identity(), _, f, 6), a.addRenderObject(Q.create([c], d.recycleTarget, this)), a.addRenderObject(Q.create([o], d.setBlendMode, this))
                    }
                    a.restore()
                } else r._fun.call(r, t, e, i, n)
            }, d.__init__ = function () {
                n.__init__();
                var t, e, i = 0;
                for (e = new d(69905, null), t = d.renders.length = 16384, i = 0; i < t; i++) d.renders[i] = e;
                d.renders[0] = new d(0, null)
            }, d._initRenderFun = function (t, e, i, n) {
                var r = t._renderType;
                (d.renders[r] = d._getTypeRender(r))._fun(t, e, i, n)
            }, d._getTypeRender = function (t) {
                if (n.map[t]) return new d(t, null);
                for (var e = null, i = 8192; 0 < i;) i & t && (e = new d(i, e)), i >>= 1;
                return e
            }, d.tmpTarget = function (t, e, i, n) {
                e.start(), e.clear(0, 0, 0, 0)
            }, d.recycleTarget = function (t) {
                ie.releaseRT(t)
            }, d.setBlendMode = function (t) {
                var e = Ct.mainContext;
                fe.targetFns[fe.TOINT[t]](e)
            }, d.INIT = 69905, d.renders = [], d.NORENDER = new d(0, null), a(d, ["tempUV", function () {
                return this.tempUV = new Array(8)
            }]), d
        }(), D = (function () {
            function t() {
            }

            x(t, "laya.events.Keyboard"), t.NUMBER_0 = 48, t.NUMBER_1 = 49, t.NUMBER_2 = 50, t.NUMBER_3 = 51, t.NUMBER_4 = 52, t.NUMBER_5 = 53, t.NUMBER_6 = 54, t.NUMBER_7 = 55, t.NUMBER_8 = 56, t.NUMBER_9 = 57, t.A = 65, t.B = 66, t.C = 67, t.D = 68, t.E = 69, t.F = 70, t.G = 71, t.H = 72, t.I = 73, t.J = 74, t.K = 75, t.L = 76, t.M = 77, t.N = 78, t.O = 79, t.P = 80, t.Q = 81, t.R = 82, t.S = 83, t.T = 84, t.U = 85, t.V = 86, t.W = 87, t.X = 88, t.Y = 89, t.Z = 90, t.F1 = 112, t.F2 = 113, t.F3 = 114, t.F4 = 115, t.F5 = 116, t.F6 = 117, t.F7 = 118, t.F8 = 119, t.F9 = 120, t.F10 = 121, t.F11 = 122, t.F12 = 123, t.F13 = 124, t.F14 = 125, t.F15 = 126, t.NUMPAD = 21, t.NUMPAD_0 = 96, t.NUMPAD_1 = 97, t.NUMPAD_2 = 98, t.NUMPAD_3 = 99, t.NUMPAD_4 = 100, t.NUMPAD_5 = 101, t.NUMPAD_6 = 102, t.NUMPAD_7 = 103, t.NUMPAD_8 = 104, t.NUMPAD_9 = 105, t.NUMPAD_ADD = 107, t.NUMPAD_DECIMAL = 110, t.NUMPAD_DIVIDE = 111, t.NUMPAD_ENTER = 108, t.NUMPAD_MULTIPLY = 106, t.NUMPAD_SUBTRACT = 109, t.SEMICOLON = 186, t.EQUAL = 187, t.COMMA = 188, t.MINUS = 189, t.PERIOD = 190, t.SLASH = 191, t.BACKQUOTE = 192, t.LEFTBRACKET = 219, t.BACKSLASH = 220, t.RIGHTBRACKET = 221, t.QUOTE = 222, t.ALTERNATE = 18, t.BACKSPACE = 8, t.CAPS_LOCK = 20, t.COMMAND = 15, t.CONTROL = 17, t.DELETE = 46, t.ENTER = 13, t.ESCAPE = 27, t.PAGE_UP = 33, t.PAGE_DOWN = 34, t.END = 35, t.HOME = 36, t.LEFT = 37, t.UP = 38, t.RIGHT = 39, t.DOWN = 40, t.SHIFT = 16, t.SPACE = 32, t.TAB = 9, t.INSERT = 45
        }(), function () {
            function t() {
            }

            x(t, "laya.display.cmd.RestoreCmd");
            var e = t.prototype;
            return e.recover = function () {
                W.recover("RestoreCmd", this)
            }, e.run = function (t, e, i) {
                t.restore()
            }, d(0, e, "cmdID", function () {
                return "Restore"
            }), t.create = function () {
                return W.getItemByClass("RestoreCmd", t)
            }, t.ID = "Restore", t
        }()), L = function () {
            function e(t, e, i) {
                this._value = 0, this._name2int = t, this._int2name = e, this._int2nameMap = i
            }

            x(e, "laya.webgl.shader.ShaderDefinesBase");
            var t = e.prototype;
            return t.add = function (t) {
                return "string" == typeof t && (t = this._name2int[t]), this._value |= t, this._value
            }, t.addInt = function (t) {
                return this._value |= t, this._value
            }, t.remove = function (t) {
                return "string" == typeof t && (t = this._name2int[t]), this._value &= ~t, this._value
            }, t.isDefine = function (t) {
                return (this._value & t) === t
            }, t.getValue = function () {
                return this._value
            }, t.setValue = function (t) {
                this._value = t
            }, t.toNameDic = function () {
                var t = this._int2nameMap[this._value];
                return t || e._toText(this._value, this._int2name, this._int2nameMap)
            }, e._reg = function (t, e, i, n) {
                n[i[t] = e] = t
            }, e._toText = function (t, e, i) {
                var n = i[t];
                if (n) return n;
                for (var r = {}, s = 1, a = 0; a < 32 && !(t < (s = 1 << a)); a++) if (t & s) {
                    var o = e[s];
                    o && (r[o] = "")
                }
                return i[t] = r
            }, e._toInt = function (t, e) {
                for (var i = t.split("."), n = 0, r = 0, s = i.length; r < s; r++) {
                    var a = e[i[r]];
                    if (!a) throw new Error("Defines to int err:" + t + "/" + i[r]);
                    n |= a
                }
                return n
            }, e
        }(), B = function () {
            function t() {
                this._texture = null, this._fontCharDic = {}, this._fontWidthMap = {}, this._complete = null, this._path = null, this._maxWidth = 0, this._spaceWidth = 10, this._padding = null, this.fontSize = 12, this.autoScaleSize = !1, this.letterSpacing = 0
            }

            x(t, "laya.display.BitmapFont");
            var e = t.prototype;
            return e.loadFont = function (t, e) {
                this._path = t, this._complete = e, t && -1 !== t.indexOf(".fnt") && y.loader.load([{
                    url: t,
                    type: "xml"
                }, {url: t.replace(".fnt", ".png"), type: "image"}], b.create(this, this._onLoaded))
            }, e._onLoaded = function () {
                this.parseFont(De.getRes(this._path), De.getRes(this._path.replace(".fnt", ".png"))), this._complete && this._complete.run()
            }, e.parseFont = function (t, e) {
                if (null != t && null != e) {
                    this._texture = e;
                    var i = t.getElementsByTagName("info");
                    if (!i[0].getAttributeNode) return this.parseFont2(t, e);
                    this.fontSize = parseInt(i[0].getAttributeNode("size").nodeValue);
                    var n, r = i[0].getAttributeNode("padding").nodeValue.split(",");
                    this._padding = [parseInt(r[0]), parseInt(r[1]), parseInt(r[2]), parseInt(r[3])], n = t.getElementsByTagName("char");
                    var s = 0;
                    for (s = 0; s < n.length; s++) {
                        var a = n[s], o = parseInt(a.getAttributeNode("id").nodeValue),
                            h = parseInt(a.getAttributeNode("xoffset").nodeValue) / 1,
                            l = parseInt(a.getAttributeNode("yoffset").nodeValue) / 1,
                            u = parseInt(a.getAttributeNode("xadvance").nodeValue) / 1, c = new gt;
                        c.x = parseInt(a.getAttributeNode("x").nodeValue), c.y = parseInt(a.getAttributeNode("y").nodeValue), c.width = parseInt(a.getAttributeNode("width").nodeValue), c.height = parseInt(a.getAttributeNode("height").nodeValue);
                        var _ = Ie.create(e, c.x, c.y, c.width, c.height, h, l);
                        this._maxWidth = Math.max(this._maxWidth, u + this.letterSpacing), this._fontCharDic[o] = _, this._fontWidthMap[o] = u
                    }
                }
            }, e.parseFont2 = function (t, e) {
                if (null != t && null != e) {
                    this._texture = e;
                    var i = t.getElementsByTagName("info");
                    this.fontSize = parseInt(i[0].attributes.size.nodeValue);
                    var n = i[0].attributes.padding.nodeValue.split(",");
                    this._padding = [parseInt(n[0]), parseInt(n[1]), parseInt(n[2]), parseInt(n[3])];
                    var r = t.getElementsByTagName("char"), s = 0;
                    for (s = 0; s < r.length; s++) {
                        var a = r[s].attributes, o = parseInt(a.id.nodeValue), h = parseInt(a.xoffset.nodeValue) / 1,
                            l = parseInt(a.yoffset.nodeValue) / 1, u = parseInt(a.xadvance.nodeValue) / 1, c = new gt;
                        c.x = parseInt(a.x.nodeValue), c.y = parseInt(a.y.nodeValue), c.width = parseInt(a.width.nodeValue), c.height = parseInt(a.height.nodeValue);
                        var _ = Ie.create(e, c.x, c.y, c.width, c.height, h, l);
                        this._maxWidth = Math.max(this._maxWidth, u + this.letterSpacing), this._fontCharDic[o] = _, this._fontWidthMap[o] = u
                    }
                }
            }, e.getCharTexture = function (t) {
                return this._fontCharDic[t.charCodeAt(0)]
            }, e.destroy = function () {
                if (this._texture) {
                    for (var t in this._fontCharDic) {
                        var e = this._fontCharDic[t];
                        e && e.destroy()
                    }
                    this._texture.destroy(), this._fontCharDic = null, this._fontWidthMap = null, this._texture = null, this._complete = null, this._padding = null
                }
            }, e.setSpaceWidth = function (t) {
                this._spaceWidth = t
            }, e.getCharWidth = function (t) {
                var e = t.charCodeAt(0);
                return this._fontWidthMap[e] ? this._fontWidthMap[e] + this.letterSpacing : " " === t ? this._spaceWidth + this.letterSpacing : 0
            }, e.getTextWidth = function (t) {
                for (var e = 0, i = 0, n = t.length; i < n; i++) e += this.getCharWidth(t.charAt(i));
                return e
            }, e.getMaxWidth = function () {
                return this._maxWidth
            }, e.getMaxHeight = function () {
                return this.fontSize
            }, e._drawText = function (t, e, i, n, r, s) {
                var a, o = this.getTextWidth(t), h = 0;
                "center" === r && (h = (s - o) / 2), "right" === r && (h = s - o);
                for (var l = 0, u = 0, c = t.length; u < c; u++) (a = this.getCharTexture(t.charAt(u))) && (e.graphics.drawImage(a, i + l + h, n), l += this.getCharWidth(t.charAt(u)))
            }, t
        }(), F = function () {
            function s() {
            }

            x(s, "laya.display.cmd.ClipRectCmd");
            var t = s.prototype;
            return t.recover = function () {
                W.recover("ClipRectCmd", this)
            }, t.run = function (t, e, i) {
                t.clipRect(this.x + e, this.y + i, this.width, this.height)
            }, d(0, t, "cmdID", function () {
                return "ClipRect"
            }), s.create = function (t, e, i, n) {
                var r = W.getItemByClass("ClipRectCmd", s);
                return r.x = t, r.y = e, r.width = i, r.height = n, r
            }, s.ID = "ClipRect", s
        }(), O = function () {
            function t() {
                this.ALPHA = 1, this.shaderType = 0, this.defines = new Re, this.fillStyle = Et.DEFAULT, this.strokeStyle = Et.DEFAULT
            }

            return x(t, "laya.webgl.shader.d2.Shader2D"), t.prototype.destroy = function () {
                this.defines = null, this.filters = null
            }, t.__init__ = function () {
                var t, e;
                t = "/*\n\ttexture和fillrect使用的。\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\t\t// 这个是全局的，不用再应用矩阵了。\nvarying vec2 cliped;\nuniform vec2 size;\nuniform vec2 clipOff;\t\t\t// 使用要把clip偏移。cacheas normal用. 只用了[0]\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\n#ifdef MVP3D\n\tuniform mat4 u_MvpMatrix;\n#endif\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n\tvec4 pos = vec4(posuv.xy,0.,1.);\n#ifdef WORLDMAT\n\tpos=mmat*pos;\n#endif\n\tvec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n#ifdef MVP3D\n\tgl_Position=u_MvpMatrix*pos1;\n#else\n\tgl_Position=pos1;\n#endif\n\tv_texcoordAlpha.xy = posuv.zw;\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\n\tv_color = attribColor/255.0;\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\n\t\n\tv_useTex = attribFlags.r/255.0;\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\t\n\tvec2 clpos = clipMatPos.xy;\n\t#ifdef WORLDMAT\n\t\t// 如果有mmat，需要修改clipMatPos,因为 这是cacheas normal （如果不是就错了）， clipMatPos被去掉了偏移\n\t\tif(clipOff[0]>0.0){\n\t\t\tclpos.x+=mmat[3].x;\t//tx\t最简单处理\n\t\t\tclpos.y+=mmat[3].y;\t//ty\n\t\t}\n\t#endif\n\tvec2 clippos = pos.xy - clpos;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n\n}", e = "/*\n\ttexture和fillrect使用的。\n*/\n#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\nuniform sampler2D texture;\nvarying vec2 cliped;\n\n#ifdef BLUR_FILTER\nuniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}\n#endif\n\n#ifdef COLOR_FILTER\nuniform vec4 colorAlpha;\nuniform mat4 colorMat;\n#endif\n\n#ifdef GLOW_FILTER\nuniform vec4 u_color;\nuniform vec4 u_blurInfo1;\nuniform vec4 u_blurInfo2;\n#endif\n\n#ifdef COLOR_ADD\nuniform vec4 colorAdd;\n#endif\n\n#ifdef FILLTEXTURE\t\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\n#endif\nvoid main() {\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n\t\n#ifdef FILLTEXTURE\t\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\n#else\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\n#endif\n\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\n   color.a*=v_color.w;\n   //color.rgb*=v_color.w;\n   color.rgb*=v_color.rgb;\n   gl_FragColor=color;\n   \n   #ifdef COLOR_ADD\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\n\tgl_FragColor.xyz *= colorAdd.a;\n   #endif\n   \n   #ifdef BLUR_FILTER\n\tgl_FragColor =   blur();\n\tgl_FragColor.w*=v_color.w;   \n   #endif\n   \n   #ifdef COLOR_FILTER\n\tmat4 alphaMat =colorMat;\n\n\talphaMat[0][3] *= gl_FragColor.a;\n\talphaMat[1][3] *= gl_FragColor.a;\n\talphaMat[2][3] *= gl_FragColor.a;\n\n\tgl_FragColor = gl_FragColor * alphaMat;\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n   #endif\n   \n   #ifdef GLOW_FILTER\n\tconst float c_IterationTime = 10.0;\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\n\tvec2 vec2Off = vec2(0.0,0.0);\n\tfloat floatOff = c_IterationTime/2.0;\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n\t\t}\n\t}\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\n\tgl_FragColor.rgb *= gl_FragColor.a;   \n   #endif\n   \n}", ni.preCompile2D(0, 1, t, e, null), t = "attribute vec4 position;\nattribute vec4 attribColor;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\nuniform mat4 u_mmat2;\n//uniform vec2 u_pos;\nuniform vec2 size;\nvarying vec4 color;\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\n//vec4 clip=vec4(100.,30.,300.,600.);\nvarying vec2 cliped;\nvoid main(){\n\t\n#ifdef WORLDMAT\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n#else\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n#endif\t\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n  //pos2d.x = dot(clippos,dirx);\n  color=attribColor/255.;\n}", e = "precision mediump float;\n//precision mediump float;\nvarying vec4 color;\n//uniform float alpha;\nvarying vec2 cliped;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=color.a;\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n}", ni.preCompile2D(0, 4, t, e, null), t = "attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}", e = "precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}", ni.preCompile2D(0, 512, t, e, null)
            }, t
        }(), N = function () {
            function l() {
            }

            x(l, "laya.display.cmd.DrawPolyCmd");
            var t = l.prototype;
            return t.recover = function () {
                this.points = null, this.fillColor = null, this.lineColor = null, W.recover("DrawPolyCmd", this)
            }, t.run = function (t, e, i) {
                t._drawPoly(this.x + e, this.y + i, this.points, this.fillColor, this.lineColor, this.lineWidth, this.isConvexPolygon, this.vid)
            }, d(0, t, "cmdID", function () {
                return "DrawPoly"
            }), l.create = function (t, e, i, n, r, s, a, o) {
                var h = W.getItemByClass("DrawPolyCmd", l);
                return h.x = t, h.y = e, h.points = i, h.fillColor = n, h.lineColor = r, h.lineWidth = s, h.isConvexPolygon = a, h.vid = o, h
            }, l.ID = "DrawPoly", l
        }(), k = function () {
            function t() {
                this.fontName = null, this.complete = null, this.err = null, this._fontTxt = null, this._url = null, this._div = null, this._txtWidth = NaN, this._http = null
            }

            x(t, "laya.net.TTFLoader");
            var e = t.prototype;
            return e.load = function (t) {
                var e = (this._url = t).split(".ttf")[0].split("/");
                this.fontName = e[e.length - 1], Rt.isConchApp ? this._loadConch() : Lt.window.FontFace ? this._loadWithFontFace() : this._loadWithCSS()
            }, e._loadConch = function () {
                this._http = new Pe, this._http.on("error", this, this._onErr), this._http.on("complete", this, this._onHttpLoaded), this._http.send(this._url, null, "get", "arraybuffer")
            }, e._onHttpLoaded = function (t) {
                Lt.window.conchTextCanvas.setFontFaceFromBuffer(this.fontName, t), this._clearHttp(), this._complete()
            }, e._clearHttp = function () {
                this._http && (this._http.off("error", this, this._onErr), this._http.off("complete", this, this._onHttpLoaded), this._http = null)
            }, e._onErr = function () {
                this._clearHttp(), this.err && (this.err.runWith("fail:" + this._url), this.err = null)
            }, e._complete = function () {
                y.systemTimer.clear(this, this._complete), y.systemTimer.clear(this, this._checkComplete), this._div && this._div.parentNode && (this._div.parentNode.removeChild(this._div), this._div = null), this.complete && (this.complete.runWith(this), this.complete = null)
            }, e._checkComplete = function () {
                ce.measureText("LayaTTFFont", this._fontTxt).width != this._txtWidth && this._complete()
            }, e._loadWithFontFace = function () {
                var t = new Lt.window.FontFace(this.fontName, "url('" + this._url + "')");
                Lt.window.document.fonts.add(t);
                var e = this;
                t.loaded.then(function () {
                    e._complete()
                }), t.load()
            }, e._createDiv = function () {
                this._div = Lt.createElement("div"), this._div.innerHTML = "laya";
                var t = this._div.style;
                t.fontFamily = this.fontName, t.position = "absolute", t.left = "-100px", t.top = "-100px", Lt.document.body.appendChild(this._div)
            }, e._loadWithCSS = function () {
                var t = this, e = Lt.createElement("style");
                e.type = "text/css", Lt.document.body.appendChild(e), e.textContent = "@font-face { font-family:'" + this.fontName + "'; src:url('" + this._url + "');}", this._fontTxt = "40px " + this.fontName, this._txtWidth = ce.measureText("LayaTTFFont", this._fontTxt).width;
                var i = this;
                e.onload = function () {
                    y.systemTimer.once(1e4, i, t._complete)
                }, y.systemTimer.loop(20, this, this._checkComplete), this._createDiv()
            }, t._testString = "LayaTTFFont", t
        }(), U = function () {
            function t() {
                this.blendShader = 0, this.submitType = 0, this.other = 0, this.clear()
            }

            x(t, "laya.webgl.submit.SubmitKey");
            var e = t.prototype;
            return e.clear = function () {
                this.submitType = -1, this.blendShader = this.other = 0
            }, e.copyFrom = function (t) {
                this.other = t.other, this.blendShader = t.blendShader, this.submitType = t.submitType
            }, e.copyFrom2 = function (t, e, i) {
                this.other = i, this.submitType = e
            }, e.equal3_2 = function (t, e, i) {
                return this.submitType === e && this.other === i && this.blendShader === t.blendShader
            }, e.equal4_2 = function (t, e, i) {
                return this.submitType === e && this.other === i && this.blendShader === t.blendShader
            }, e.equal_3 = function (t) {
                return this.submitType === t.submitType && this.blendShader === t.blendShader
            }, e.equal = function (t) {
                return this.other === t.other && this.submitType === t.submitType && this.blendShader === t.blendShader
            }, t
        }(), W = (function () {
            function t() {
                this._graphicsCmdEncoder = null, this._index = 0, this._paramData = null, this.texture = null, this.x = NaN, this.y = NaN, this.width = NaN, this.height = NaN
            }

            x(t, "laya.display.cmd.DrawCanvasCmd");
            var e = t.prototype;
            e.recover = function () {
                this._graphicsCmdEncoder = null, W.recover("DrawCanvasCmd", this)
            }, d(0, e, "cmdID", function () {
                return "DrawCanvasCmd"
            }), t.create = function (t, e, i, n, r) {
                return null
            }, t.ID = "DrawCanvasCmd", t._DRAW_IMAGE_CMD_ENCODER_ = null, t._PARAM_TEXTURE_POS_ = 2, t._PARAM_VB_POS_ = 5
        }(), function () {
            function s() {
            }

            return x(s, "laya.utils.Pool"), s.getPoolBySign = function (t) {
                return s._poolDic[t] || (s._poolDic[t] = [])
            }, s.clearBySign = function (t) {
                s._poolDic[t] && (s._poolDic[t].length = 0)
            }, s.recover = function (t, e) {
                e.__InPool || (e.__InPool = !0, s.getPoolBySign(t).push(e))
            }, s.recoverByClass = function (t) {
                if (t) {
                    var e = t.__className || t.constructor._$gid;
                    e && s.recover(e, t)
                }
            }, s._getClassSign = function (t) {
                var e = t.__className || t._$gid;
                return e || (t._$gid = e = ne.getGID() + ""), e
            }, s.createByClass = function (t) {
                return s.getItemByClass(s._getClassSign(t), t)
            }, s.getItemByClass = function (t, e) {
                if (!s._poolDic[t]) return new e;
                var i = s.getPoolBySign(t);
                if (i.length) {
                    var n = i.pop();
                    n.__InPool = !1
                } else n = new e;
                return n
            }, s.getItemByCreateFun = function (t, e, i) {
                var n = s.getPoolBySign(t), r = n.length ? n.pop() : e.call(i);
                return r.__InPool = !1, r
            }, s.getItem = function (t) {
                var e = s.getPoolBySign(t), i = e.length ? e.pop() : null;
                return i && (i.__InPool = !1), i
            }, s.POOLSIGN = "__InPool", s._poolDic = {}, s
        }()), G = function () {
            function t(t) {
                this.script = null, this.codes = {}, this.funs = {}, this.curUseID = -1, this.funnames = "", this.script = t;
                for (var e = 0, i = 0, n = 0; !((e = t.indexOf("#begin", e)) < 0);) {
                    for (n = e + 5; !((n = t.indexOf("#end", n)) < 0) && "i" === t.charAt(n + 4);) n += 5;
                    if (n < 0) throw"add include err,no #end:" + t;
                    i = t.indexOf("\n", e);
                    var r = me.splitToWords(t.substr(e, i - e), null);
                    "code" == r[1] ? this.codes[r[2]] = t.substr(i + 1, n - i - 1) : "function" == r[1] && (i = t.indexOf("function", e), i += "function".length, this.funs[r[3]] = t.substr(i + 1, n - i - 1), this.funnames += r[3] + ";"), e = n + 1
                }
            }

            x(t, "laya.webgl.utils.InlcudeFile");
            var e = t.prototype;
            return e.getWith = function (t) {
                var e = t ? this.codes[t] : this.script;
                if (!e) throw"get with error:" + t;
                return e
            }, e.getFunsScript = function (t) {
                var e = "";
                for (var i in this.funs) 0 <= t.indexOf(i + ";") && (e += this.funs[i]);
                return e
            }, t
        }(), V = (function () {
            function t() {
            }

            x(t, "laya.display.SpriteConst"), t.ALPHA = 1, t.TRANSFORM = 2, t.BLEND = 4, t.CANVAS = 8, t.FILTERS = 16, t.MASK = 32, t.CLIP = 64, t.STYLE = 128, t.TEXTURE = 256, t.GRAPHICS = 512, t.LAYAGL3D = 1024, t.CUSTOM = 2048, t.ONECHILD = 4096, t.CHILDS = 8192, t.REPAINT_NONE = 0, t.REPAINT_NODE = 1, t.REPAINT_CACHE = 2, t.REPAINT_ALL = 3
        }(), function () {
            function t() {
                this._glBuffer = null, this._buffer = null, this._bufferType = 0, this._bufferUsage = 0, this._byteLength = 0, this._glBuffer = Dt.instance.createBuffer()
            }

            x(t, "laya.webgl.utils.Buffer");
            var e = t.prototype;
            return e._bindForVAO = function () {
            }, e.bind = function () {
                return !1
            }, e.destroy = function () {
                this._glBuffer && (Dt.instance.deleteBuffer(this._glBuffer), this._glBuffer = null)
            }, d(0, e, "bufferUsage", function () {
                return this._bufferUsage
            }), t._bindedVertexBuffer = null, t._bindedIndexBuffer = null, t
        }()), X = function () {
            function u() {
                this.colorFlt = null
            }

            x(u, "laya.display.cmd.DrawTextureCmd");
            var t = u.prototype;
            return t.recover = function () {
                this.texture._removeReference(), this.texture = null, this.matrix = null, W.recover("DrawTextureCmd", this)
            }, t.run = function (t, e, i) {
                t.drawTextureWithTransform(this.texture, this.x, this.y, this.width, this.height, this.matrix, e, i, this.alpha, this.blendMode, this.colorFlt)
            }, d(0, t, "cmdID", function () {
                return "DrawTexture"
            }), u.create = function (t, e, i, n, r, s, a, o, h) {
                var l = W.getItemByClass("DrawTextureCmd", u);
                return (l.texture = t)._addReference(), l.x = e, l.y = i, l.width = n, l.height = r, l.matrix = s, l.alpha = a, l.color = o, l.blendMode = h, o && (l.colorFlt = new be, l.colorFlt.setColor(o)), l
            }, u.ID = "DrawTexture", u
        }(), Y = function () {
            function n(t, e) {
                this.size = [0, 0], this.alpha = 1, this.ALPHA = 1, this.subID = 0, this.ref = 1, this._cacheID = 0, this.clipMatDir = [99999999, 0, 0, 99999999], this.clipMatPos = [0, 0], this.clipOff = [0, 0], this.defines = new Re, this.mainID = t, this.subID = e, this.textureHost = null, this.texture = null, this.color = null, this.colorAdd = null, this.u_mmat2 = null, this._cacheID = t | e, this._inClassCache = n._cache[this._cacheID], 0 < t && !this._inClassCache && (this._inClassCache = n._cache[this._cacheID] = [], this._inClassCache._length = 0), this.clear()
            }

            x(n, "laya.webgl.shader.d2.value.Value2D");
            var t = n.prototype;
            return t.setValue = function (t) {
            }, t._ShaderWithCompile = function () {
                return ni.withCompile2D(0, this.mainID, this.defines.toNameDic(), this.mainID | this.defines._value, ui.create, this._attribLocation)
            }, t.upload = function () {
                var t = pt;
                pt.worldMatrix4 === pt.TEMPMAT4_ARRAY || this.defines.addInt(128), this.mmat = t.worldMatrix4, pt.matWVP && (this.defines.addInt(2048), this.u_MvpMatrix = pt.matWVP.elements);
                var e = ni.sharders[this.mainID | this.defines._value] || this._ShaderWithCompile();
                e._shaderValueWidth !== t.width || e._shaderValueHeight !== t.height ? (this.size[0] = t.width, this.size[1] = t.height, e._shaderValueWidth = t.width, e._shaderValueHeight = t.height, e.upload(this, null)) : e.upload(this, e._params2dQuick2 || e._make2dQuick2())
            }, t.setFilters = function (t) {
                if (this.filters = t) for (var e, i = t.length, n = 0; n < i; n++) (e = t[n]) && (this.defines.add(e.type), e.action.setValue(this))
            }, t.clear = function () {
                this.defines._value = this.subID + (Ct.shaderHighPrecision ? 1024 : 0), this.clipOff[0] = 0
            }, t.release = function () {
                --this.ref < 1 && (this._inClassCache && (this._inClassCache[this._inClassCache._length++] = this), this.clear(), this.filters = null, this.ref = 1, this.clipOff[0] = 0)
            }, n._initone = function (t, e) {
                n._typeClass[t] = e, n._cache[t] = [], n._cache[t]._length = 0
            }, n.__init__ = function () {
                n._initone(4, Xe), n._initone(512, Ye), n._initone(1, Oe), n._initone(9, Oe)
            }, n.create = function (t, e) {
                var i = n._cache[t | e];
                return i._length ? i[--i._length] : new n._typeClass[t | e](e)
            }, n._cache = [], n._typeClass = [], n.TEMPMAT4_ARRAY = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], n
        }(), H = function () {
            function l() {
            }

            return x(l, "laya.maths.GrahamScan"), l.multiply = function (t, e, i) {
                return (t.x - i.x) * (e.y - i.y) - (e.x - i.x) * (t.y - i.y)
            }, l.dis = function (t, e) {
                return (t.x - e.x) * (t.x - e.x) + (t.y - e.y) * (t.y - e.y)
            }, l._getPoints = function (t, e, i) {
                for (void 0 === e && (e = !1), l._mPointList || (l._mPointList = []); l._mPointList.length < t;) l._mPointList.push(new Ht);
                return i || (i = []), i.length = 0, e ? l.getFrom(i, l._mPointList, t) : l.getFromR(i, l._mPointList, t), i
            }, l.getFrom = function (t, e, i) {
                var n = 0;
                for (n = 0; n < i; n++) t.push(e[n]);
                return t
            }, l.getFromR = function (t, e, i) {
                var n = 0;
                for (n = 0; n < i; n++) t.push(e.pop());
                return t
            }, l.pListToPointList = function (t, e) {
                void 0 === e && (e = !1);
                var i = 0, n = t.length / 2, r = l._getPoints(n, e, l._tempPointList);
                for (i = 0; i < n; i++) r[i].setTo(t[i + i], t[i + i + 1]);
                return r
            }, l.pointListToPlist = function (t) {
                var e, i = 0, n = t.length, r = l._temPList;
                for (i = r.length = 0; i < n; i++) e = t[i], r.push(e.x, e.y);
                return r
            }, l.scanPList = function (t) {
                return ne.copyArray(t, l.pointListToPlist(l.scan(l.pListToPointList(t, !0))))
            }, l.scan = function (t) {
                var e, i, n, r = 0, s = 0, a = 0, o = t.length, h = {};
                for ((i = l._temArr).length = 0, r = (o = t.length) - 1; 0 <= r; r--) n = (e = t[r]).x + "_" + e.y, h.hasOwnProperty(n) || (h[n] = !0, i.push(e));
                for (o = i.length, ne.copyArray(t, i), r = 1; r < o; r++) (t[r].y < t[a].y || t[r].y == t[a].y && t[r].x < t[a].x) && (a = r);
                for (e = t[0], t[0] = t[a], t[a] = e, r = 1; r < o - 1; r++) {
                    for (s = (a = r) + 1; s < o; s++) (0 < l.multiply(t[s], t[a], t[0]) || 0 == l.multiply(t[s], t[a], t[0]) && l.dis(t[0], t[s]) < l.dis(t[0], t[a])) && (a = s);
                    e = t[r], t[r] = t[a], t[a] = e
                }
                if ((i = l._temArr).length = 0, t.length < 3) return ne.copyArray(i, t);
                for (i.push(t[0], t[1], t[2]), r = 3; r < o; r++) {
                    for (; 2 <= i.length && 0 <= l.multiply(t[r], i[i.length - 1], i[i.length - 2]);) i.pop();
                    t[r] && i.push(t[r])
                }
                return i
            }, l._mPointList = null, l._tempPointList = [], l._temPList = [], l._temArr = [], l
        }(), z = function () {
            function n() {
                this._saveuse = 0
            }

            x(n, "laya.webgl.canvas.save.SaveMark");
            var t = n.prototype;
            return y.imps(t, {"laya.webgl.canvas.save.ISaveData": !0}), t.isSaveMark = function () {
                return !0
            }, t.restore = function (t) {
                t._saveMark = this._preSaveMark, n.POOL[n.POOL._length++] = this
            }, n.Create = function (t) {
                var e = n.POOL, i = 0 < e._length ? e[--e._length] : new n;
                return i._saveuse = 0, i._preSaveMark = t._saveMark, t._saveMark = i
            }, n.POOL = o._createArray(), n
        }(), j = function () {
            function c() {
                this.gid = 0, this.repeat = 1, this._count = 0
            }

            x(c, "laya.utils.Tween");
            var t = c.prototype;
            return t.to = function (t, e, i, n, r, s, a) {
                return void 0 === s && (s = 0), void 0 === a && (a = !1), this._create(t, e, i, n, r, s, a, !0, !1, !0)
            }, t.from = function (t, e, i, n, r, s, a) {
                return void 0 === s && (s = 0), void 0 === a && (a = !1), this._create(t, e, i, n, r, s, a, !1, !1, !0)
            }, t._create = function (t, e, i, n, r, s, a, o, h, l) {
                if (!t) throw new Error("Tween:target is null");
                this._target = t, this._duration = i, this._ease = n || e.ease || c.easeNone, this._complete = r || e.complete, this._delay = s, this._props = [], this._usedTimer = 0, this._startTimer = Lt.now(), this._usedPool = h, this._delayParam = null, this.update = e.update;
                var u = t.$_GID || (t.$_GID = ne.getGID());
                return c.tweenMap[u] ? (a && c.clearTween(t), c.tweenMap[u].push(this)) : c.tweenMap[u] = [this], l ? s <= 0 ? this.firstStart(t, e, o) : (this._delayParam = [t, e, o], y.timer.once(s, this, this.firstStart, this._delayParam)) : this._initProps(t, e, o), this
            }, t.firstStart = function (t, e, i) {
                this._delayParam = null, t.destroyed ? this.clear() : (this._initProps(t, e, i), this._beginLoop())
            }, t._initProps = function (t, e, i) {
                for (var n in e) if ("number" == typeof t[n]) {
                    var r = i ? t[n] : e[n], s = i ? e[n] : t[n];
                    this._props.push([n, r, s - r]), i || (t[n] = r)
                }
            }, t._beginLoop = function () {
                y.timer.frameLoop(1, this, this._doEase)
            }, t._doEase = function () {
                this._updateEase(Lt.now())
            }, t._updateEase = function (t) {
                var e = this._target;
                if (e) {
                    if (e.destroyed) return c.clearTween(e);
                    var i = this._usedTimer = t - this._startTimer - this._delay;
                    if (!(i < 0)) {
                        if (i >= this._duration) return this.complete();
                        for (var n = 0 < i ? this._ease(i, 0, 1, this._duration) : 0, r = this._props, s = 0, a = r.length; s < a; s++) {
                            var o = r[s];
                            e[o[0]] = o[1] + n * o[2]
                        }
                        this.update && this.update.run()
                    }
                }
            }, t.complete = function () {
                if (this._target) {
                    y.timer.runTimer(this, this.firstStart);
                    for (var t = this._target, e = this._props, i = this._complete, n = 0, r = e.length; n < r; n++) {
                        var s = e[n];
                        t[s[0]] = s[1] + s[2]
                    }
                    this.update && this.update.run(), this._count++, 0 != this.repeat && this._count >= this.repeat ? (this.clear(), i && i.run()) : this.restart()
                }
            }, t.pause = function () {
                y.timer.clear(this, this._beginLoop), y.timer.clear(this, this._doEase), y.timer.clear(this, this.firstStart);
                var t;
                (t = Lt.now() - this._startTimer - this._delay) < 0 && (this._usedTimer = t)
            }, t.setStartTime = function (t) {
                this._startTimer = t
            }, t.clear = function () {
                this._target && (this._remove(), this._clear())
            }, t._clear = function () {
                this.pause(), y.timer.clear(this, this.firstStart), this._complete = null, this._target = null, this._ease = null, this._props = null, this._delayParam = null, this._usedPool && (this.update = null, W.recover("tween", this))
            }, t.recover = function () {
                this._usedPool = !0, this._clear()
            }, t._remove = function () {
                var t = c.tweenMap[this._target.$_GID];
                if (t) for (var e = 0, i = t.length; e < i; e++) if (t[e] === this) {
                    t.splice(e, 1);
                    break
                }
            }, t.restart = function () {
                if (this.pause(), this._usedTimer = 0, this._startTimer = Lt.now(), this._delayParam) y.timer.once(this._delay, this, this.firstStart, this._delayParam); else {
                    for (var t = this._props, e = 0, i = t.length; e < i; e++) {
                        var n = t[e];
                        this._target[n[0]] = n[1]
                    }
                    y.timer.once(this._delay, this, this._beginLoop)
                }
            }, t.resume = function () {
                this._usedTimer >= this._duration || (this._startTimer = Lt.now() - this._usedTimer - this._delay, this._delayParam ? this._usedTimer < 0 ? y.timer.once(-this._usedTimer, this, this.firstStart, this._delayParam) : this.firstStart.apply(this, this._delayParam) : this._beginLoop())
            }, d(0, t, "progress", null, function (t) {
                var e = t * this._duration;
                this._startTimer = Lt.now() - this._delay - e
            }), c.to = function (t, e, i, n, r, s, a, o) {
                return void 0 === s && (s = 0), void 0 === a && (a = !1), void 0 === o && (o = !0), W.getItemByClass("tween", c)._create(t, e, i, n, r, s, a, !0, o, !0)
            }, c.from = function (t, e, i, n, r, s, a, o) {
                return void 0 === s && (s = 0), void 0 === a && (a = !1), void 0 === o && (o = !0), W.getItemByClass("tween", c)._create(t, e, i, n, r, s, a, !1, o, !0)
            }, c.clearAll = function (t) {
                if (t && t.$_GID) {
                    var e = c.tweenMap[t.$_GID];
                    if (e) {
                        for (var i = 0, n = e.length; i < n; i++) e[i]._clear();
                        e.length = 0
                    }
                }
            }, c.clear = function (t) {
                t.clear()
            }, c.clearTween = function (t) {
                c.clearAll(t)
            }, c.easeNone = function (t, e, i, n) {
                return i * t / n + e
            }, c.tweenMap = [], c
        }(), K = function () {
            function h() {
            }

            x(h, "laya.display.cmd.DrawRectCmd");
            var t = h.prototype;
            return t.recover = function () {
                this.fillColor = null, this.lineColor = null, W.recover("DrawRectCmd", this)
            }, t.run = function (t, e, i) {
                t.drawRect(this.x + e, this.y + i, this.width, this.height, this.fillColor, this.lineColor, this.lineWidth)
            }, d(0, t, "cmdID", function () {
                return "DrawRect"
            }), h.create = function (t, e, i, n, r, s, a) {
                var o = W.getItemByClass("DrawRectCmd", h);
                return o.x = t, o.y = e, o.width = i, o.height = n, o.fillColor = r, o.lineColor = s, o.lineWidth = a, o
            }, h.ID = "DrawRect", h
        }(), $ = function () {
            function t(t, e, i) {
                this.i = null, this.x = null, this.y = null, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = null, this.i = t, this.x = e, this.y = i, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1
            }

            return x(t, "laya.webgl.shapes.EarcutNode"), t
        }(), Q = function () {
            function r() {
                this.fun = null, this._this = null, this.args = null, this._ref = 1, this._key = new U
            }

            x(r, "laya.webgl.submit.SubmitCMD");
            var t = r.prototype;
            return y.imps(t, {"laya.webgl.submit.ISubmit": !0}), t.renderSubmit = function () {
                return this.fun.apply(this._this, this.args), 1
            }, t.getRenderType = function () {
                return 0
            }, t.reUse = function (t, e) {
                return this._ref++, e
            }, t.releaseRender = function () {
                if (--this._ref < 1) {
                    var t = r.POOL;
                    t[t._length++] = this
                }
            }, t.clone = function (t, e, i) {
                return null
            }, r.create = function (t, e, i) {
                var n = r.POOL._length ? r.POOL[--r.POOL._length] : new r;
                return n.fun = e, n.args = t, n._this = i, n._ref = 1, n._key.clear(), n
            }, r.POOL = [], r.__init$ = function () {
                r.POOL._length = 0
            }, r
        }(), q = function () {
            function r(t) {
                this._url = null, this._path = null, this._url = r.formatURL(t), this._path = r.getPath(t)
            }

            x(r, "laya.net.URL");
            var t = r.prototype;
            return d(0, t, "path", function () {
                return this._path
            }), d(0, t, "url", function () {
                return this._url
            }), d(1, r, "basePath", function () {
                return r._basePath
            }, function (t) {
                r._basePath = y._getUrlPath(), r._basePath = r.formatURL(t)
            }), r.formatURL = function (t) {
                if (!t) return "null path";
                if (0 < t.indexOf(":")) return t;
                if (null != r.customFormat && (t = r.customFormat(t)), 0 < t.indexOf(":")) return t;
                var e = t.charAt(0);
                if ("." === e) return r._formatRelativePath(r._basePath + t);
                if ("~" === e) return r.rootPath + t.substring(1);
                if ("d" === e) {
                    if (0 === t.indexOf("data:image")) return t
                } else if ("/" === e) return t;
                return r._basePath + t
            }, r._formatRelativePath = function (t) {
                for (var e = t.split("/"), i = 0, n = e.length; i < n; i++) ".." == e[i] && (e.splice(i - 1, 2), i -= 2);
                return e.join("/")
            }, r.getPath = function (t) {
                var e = t.lastIndexOf("/");
                return 0 < e ? t.substr(0, e + 1) : ""
            }, r.getFileName = function (t) {
                var e = t.lastIndexOf("/");
                return 0 < e ? t.substr(e + 1) : t
            }, r.getAdptedFilePath = function (t) {
                if (!r.exportSceneToJson || !t) return t;
                var e, i, n = 0;
                for (e = r._adpteTypeList.length, n = 0; n < e; n++) i = r._adpteTypeList[n], t = t.replace(i[0], i[1]);
                return t
            }, r.version = {}, r.exportSceneToJson = !1, r._basePath = "", r.rootPath = "", r.customFormat = function (t) {
                var e = r.version[t];
                return !Rt.isConchApp && e && (t += "?v=" + e), t
            }, a(r, ["_adpteTypeList", function () {
                return this._adpteTypeList = [[".scene3d", ".json"], [".scene", ".json"], [".taa", ".json"], [".prefab", ".json"]]
            }]), r
        }(), Z = function () {
            function r() {
            }

            return x(r, "laya.utils.CacheManger"), r.regCacheByFunction = function (t, e) {
                var i;
                r.unRegCacheByFunction(t, e), i = {tryDispose: t, getCacheList: e}, r._cacheList.push(i)
            }, r.unRegCacheByFunction = function (t, e) {
                var i, n = 0;
                for (i = r._cacheList.length, n = 0; n < i; n++) if (r._cacheList[n].tryDispose == t && r._cacheList[n].getCacheList == e) return void r._cacheList.splice(n, 1)
            }, r.forceDispose = function () {
                var t = 0, e = r._cacheList.length;
                for (t = 0; t < e; t++) r._cacheList[t].tryDispose(!0)
            }, r.beginCheck = function (t) {
                void 0 === t && (t = 15e3), y.systemTimer.loop(t, null, r._checkLoop)
            }, r.stopCheck = function () {
                y.systemTimer.clear(null, r._checkLoop)
            }, r._checkLoop = function () {
                var t = r._cacheList;
                if (!(t.length < 1)) {
                    var e, i = Lt.now(), n = 0;
                    for (e = n = t.length; 0 < n && (t[r._index = ++r._index % e].tryDispose(!1), !(Lt.now() - i > r.loopTimeLimit));) n--
                }
            }, r.loopTimeLimit = 2, r._cacheList = [], r._index = 0, r
        }(), J = function () {
            function t() {
                this.reset()
            }

            x(t, "laya.display.css.SpriteStyle");
            var e = t.prototype;
            return e.reset = function () {
                return this.scaleX = this.scaleY = 1, this.skewX = this.skewY = 0, this.pivotX = this.pivotY = this.rotation = 0, this.alpha = 1, this.scrollRect && this.scrollRect.recover(), this.scrollRect = null, this.viewport && this.viewport.recover(), this.viewport = null, this.hitArea = null, this.dragging = null, this.blendMode = null, this
            }, e.recover = function () {
                this !== t.EMPTY && W.recover("SpriteStyle", this.reset())
            }, t.create = function () {
                return W.getItemByClass("SpriteStyle", t)
            }, t.EMPTY = new t, t
        }(), tt = (function () {
            function t(t, e) {
                this.submitStartPos = 0, this.submitEndPos = 0, this.context = null, this.touches = [], this.submits = [], this.sprite = null, this._mesh = null, this._pathMesh = null, this._triangleMesh = null, this.meshlist = [], this._oldMesh = null, this._oldPathMesh = null, this._oldTriMesh = null, this._oldMeshList = null, this.oldTx = 0, this.oldTy = 0, this.cachedClipInfo = new at, this.invMat = new at, this.context = t, this.sprite = e, t._globalClipMatrix.copyTo(this.cachedClipInfo)
            }

            x(t, "laya.webgl.canvas.WebGLCacheAsNormalCanvas");
            var e = t.prototype;
            e.startRec = function () {
                this.context._charSubmitCache._enbale && (this.context._charSubmitCache.enable(!1, this.context), this.context._charSubmitCache.enable(!0, this.context)), this.context._incache = !0, this.touches.length = 0, this.context.touches = this.touches, this.context._globalClipMatrix.copyTo(this.cachedClipInfo), this.submits.length = 0, this.submitStartPos = this.context._submits._length;
                for (var t = 0, e = this.meshlist.length; t < e; t++) {
                    var i = this.meshlist[t];
                    i.canReuse ? i.releaseMesh() : i.destroy()
                }
                this.meshlist.length = 0, this._mesh = Fe.getAMesh(!1), this._pathMesh = Ee.getAMesh(!1), this._triangleMesh = ke.getAMesh(!1), this.meshlist.push(this._mesh), this.meshlist.push(this._pathMesh), this.meshlist.push(this._triangleMesh), this.context._curSubmit = T.RENDERBASE, this._oldMesh = this.context._mesh, this._oldPathMesh = this.context._pathMesh, this._oldTriMesh = this.context._triangleMesh, this._oldMeshList = this.context.meshlist, this.context._mesh = this._mesh, this.context._pathMesh = this._pathMesh, this.context._triangleMesh = this._triangleMesh, this.context.meshlist = this.meshlist, this.oldTx = this.context._curMat.tx, this.oldTy = this.context._curMat.ty, this.context._curMat.tx = 0, this.context._curMat.ty = 0, this.context._curMat.copyTo(this.invMat), this.invMat.invert()
            }, e.endRec = function () {
                this.context._charSubmitCache._enbale && (this.context._charSubmitCache.enable(!1, this.context), this.context._charSubmitCache.enable(!0, this.context));
                var t = this.context._submits;
                this.submitEndPos = t._length;
                for (var e = this.submitEndPos - this.submitStartPos, i = 0; i < e; i++) this.submits.push(t[this.submitStartPos + i]);
                t._length -= e, this.context._mesh = this._oldMesh, this.context._pathMesh = this._oldPathMesh, this.context._triangleMesh = this._oldTriMesh, this.context.meshlist = this._oldMeshList, this.context._curSubmit = T.RENDERBASE, this.context._curMat.tx = this.oldTx, this.context._curMat.ty = this.oldTy, this.context.touches = null, this.context._incache = !1
            }, e.isCacheValid = function () {
                var t = this.context._globalClipMatrix;
                return t.a == this.cachedClipInfo.a && t.b == this.cachedClipInfo.b && t.c == this.cachedClipInfo.c && t.d == this.cachedClipInfo.d && t.tx == this.cachedClipInfo.tx && t.ty == this.cachedClipInfo.ty
            }, e.flushsubmit = function () {
                var e = T.RENDERBASE;
                this.submits.forEach(function (t) {
                    t != T.RENDERBASE && (T.preRender = e, (e = t).renderSubmit())
                })
            }, e.releaseMem = function () {
            }, a(t, ["matI", function () {
                return this.matI = new at
            }])
        }(), function () {
            var h;

            function l(t) {
                this.scale = 1, this.currFrame = 0, this._delta = 0, this._map = [], this._handlers = [], this._temp = [], this._count = 0, this.currTimer = Lt.now(), this._lastTimer = Lt.now(), void 0 === t && (t = !0), t && y.systemTimer && y.systemTimer.frameLoop(1, this, this._update)
            }

            x(l, "laya.utils.Timer");
            var t = l.prototype;
            return t._update = function () {
                if (this.scale <= 0) this._lastTimer = Lt.now(); else {
                    var t = this.currFrame = this.currFrame + this.scale, e = Lt.now();
                    this._delta = (e - this._lastTimer) * this.scale;
                    var i = this.currTimer = this.currTimer + this._delta;
                    this._lastTimer = e;
                    for (var n = this._handlers, r = this._count = 0, s = n.length; r < s; r++) {
                        var a = n[r];
                        if (null !== a.method) {
                            var o = a.userFrame ? t : i;
                            if (o >= a.exeTime) if (a.repeat) if (a.jumpFrame) for (; o >= a.exeTime;) a.exeTime += a.delay, a.run(!1); else a.exeTime += a.delay, a.run(!1), o > a.exeTime && (a.exeTime += Math.ceil((o - a.exeTime) / a.delay) * a.delay); else a.run(!0)
                        } else this._count++
                    }
                    (30 < this._count || t % 200 == 0) && this._clearHandlers()
                }
            }, t._clearHandlers = function () {
                for (var t = this._handlers, e = 0, i = t.length; e < i; e++) {
                    var n = t[e];
                    null !== n.method ? this._temp.push(n) : this._recoverHandler(n)
                }
                this._handlers = this._temp, t.length = 0, this._temp = t
            }, t._recoverHandler = function (t) {
                this._map[t.key] == t && (this._map[t.key] = null), t.clear(), l._pool.push(t)
            }, t._create = function (t, e, i, n, r, s, a) {
                if (!i) return r.apply(n, s), null;
                if (a) {
                    var o = this._getHandler(n, r);
                    if (o) return o.repeat = e, o.userFrame = t, o.delay = i, o.caller = n, o.method = r, o.args = s, o.exeTime = i + (t ? this.currFrame : this.currTimer + Lt.now() - this._lastTimer), o
                }
                return (o = 0 < l._pool.length ? l._pool.pop() : new h).repeat = e, o.userFrame = t, o.delay = i, o.caller = n, o.method = r, o.args = s, o.exeTime = i + (t ? this.currFrame : this.currTimer + Lt.now() - this._lastTimer), this._indexHandler(o), this._handlers.push(o), o
            }, t._indexHandler = function (t) {
                var e = t.caller, i = t.method, n = e ? e.$_GID || (e.$_GID = ne.getGID()) : 0,
                    r = i.$_TID || (i.$_TID = 1e5 * l._mid++);
                t.key = n + r, this._map[t.key] = t
            }, t.once = function (t, e, i, n, r) {
                void 0 === r && (r = !0), this._create(!1, !1, t, e, i, n, r)
            }, t.loop = function (t, e, i, n, r, s) {
                void 0 === r && (r = !0), void 0 === s && (s = !1);
                var a = this._create(!1, !0, t, e, i, n, r);
                a && (a.jumpFrame = s)
            }, t.frameOnce = function (t, e, i, n, r) {
                void 0 === r && (r = !0), this._create(!0, !1, t, e, i, n, r)
            }, t.frameLoop = function (t, e, i, n, r) {
                void 0 === r && (r = !0), this._create(!0, !0, t, e, i, n, r)
            }, t.toString = function () {
                return " handlers:" + this._handlers.length + " pool:" + l._pool.length
            }, t.clear = function (t, e) {
                var i = this._getHandler(t, e);
                i && (this._map[i.key] = null, i.key = 0, i.clear())
            }, t.clearAll = function (t) {
                if (t) for (var e = 0, i = this._handlers.length; e < i; e++) {
                    var n = this._handlers[e];
                    n.caller === t && (this._map[n.key] = null, n.key = 0, n.clear())
                }
            }, t._getHandler = function (t, e) {
                var i = t ? t.$_GID || (t.$_GID = ne.getGID()) : 0, n = e.$_TID || (e.$_TID = 1e5 * l._mid++);
                return this._map[i + n]
            }, t.callLater = function (t, e, i) {
                Qt.I.callLater(t, e, i)
            }, t.runCallLater = function (t, e) {
                Qt.I.runCallLater(t, e)
            }, t.runTimer = function (t, e) {
                var i = this._getHandler(t, e);
                i && null != i.method && (this._map[i.key] = null, i.run(!0))
            }, t.pause = function () {
                this.scale = 0
            }, t.resume = function () {
                this.scale = 1
            }, d(0, t, "delta", function () {
                return this._delta
            }), l._pool = [], l._mid = 1, l.__init$ = function () {
                h = function () {
                    function t() {
                        this.key = 0, this.repeat = !1, this.delay = 0, this.userFrame = !1, this.exeTime = 0, this.caller = null, this.method = null, this.args = null, this.jumpFrame = !1
                    }

                    x(t, "");
                    var e = t.prototype;
                    return e.clear = function () {
                        this.caller = null, this.method = null, this.args = null
                    }, e.run = function (t) {
                        var e = this.caller;
                        if (e && e.destroyed) return this.clear();
                        var i = this.method, n = this.args;
                        t && this.clear(), null != i && (n ? i.apply(e, n) : i.call(e))
                    }, t
                }()
            }, l
        }()), et = function () {
            function o() {
                this.reset()
            }

            x(o, "laya.display.css.CacheStyle");
            var t = o.prototype;
            return t.needBitmapCache = function () {
                return this.cacheForFilters || !!this.mask
            }, t.needEnableCanvasRender = function () {
                return "none" != this.userSetCache || this.cacheForFilters || !!this.mask
            }, t.releaseContext = function () {
                this.canvas && this.canvas.size && (W.recover("CacheCanvas", this.canvas), this.canvas.size(0, 0), this.canvas.width = 0, this.canvas.height = 0), this.canvas = null
            }, t.createContext = function () {
                if (!this.canvas) {
                    this.canvas = W.getItem("CacheCanvas") || new si(!1);
                    var t = this.canvas.context;
                    t || (t = this.canvas.getContext("2d"))
                }
            }, t.releaseFilterCache = function () {
                var t = this.filterCache;
                t && (t.destroy(), t.recycle(), this.filterCache = null)
            }, t.recover = function () {
                this !== o.EMPTY && W.recover("SpriteCache", this.reset())
            }, t.reset = function () {
                return this.releaseContext(), this.releaseFilterCache(), this.cacheAs = "none", this.enableCanvasRender = !1, this.userSetCache = "none", this.cacheForFilters = !1, this.staticCache = !1, this.reCache = !0, this.mask = null, this.maskParent = null, this.filterCache = null, this.filters = null, this.hasGlowFilter = !1, this.cacheRect && this.cacheRect.recover(), this.cacheRect = null, this
            }, t._calculateCacheRect = function (t, e, i, n) {
                var r, s = t._cacheStyle;
                if (s.cacheRect || (s.cacheRect = gt.create()), "bitmap" === e ? ((r = t.getSelfBounds()).width = r.width + 32, r.height = r.height + 32, r.x = r.x - t.pivotX, r.y = r.y - t.pivotY, r.x = r.x - 16, r.y = r.y - 16, r.x = Math.floor(r.x + i) - i, r.y = Math.floor(r.y + n) - n, r.width = Math.floor(r.width), r.height = Math.floor(r.height), s.cacheRect.copyFrom(r)) : s.cacheRect.setTo(-t._style.pivotX, -t._style.pivotY, 1, 1), r = s.cacheRect, t._style.scrollRect) {
                    var a = t._style.scrollRect;
                    r.x -= a.x, r.y -= a.y
                }
                return o._scaleInfo.setTo(1, 1), o._scaleInfo
            }, o.create = function () {
                return W.getItemByClass("SpriteCache", o)
            }, o.EMPTY = new o, o.CANVAS_EXTEND_EDGE = 16, a(o, ["_scaleInfo", function () {
                return this._scaleInfo = new Ht
            }]), o
        }(), it = function () {
            function r() {
                this._mat = new at
            }

            x(r, "laya.webgl.canvas.save.SaveTranslate");
            var t = r.prototype;
            return y.imps(t, {"laya.webgl.canvas.save.ISaveData": !0}), t.isSaveMark = function () {
                return !1
            }, t.restore = function (t) {
                this._mat.copyTo(t._curMat), r.POOL[r.POOL._length++] = this
            }, r.save = function (t) {
                var e = r.POOL, i = 0 < e._length ? e[--e._length] : new r;
                t._curMat.copyTo(i._mat);
                var n = t._save;
                n[n._length++] = i
            }, r.POOL = o._createArray(), r
        }(), nt = function () {
            function h() {
            }

            x(h, "laya.display.cmd.DrawLineCmd");
            var t = h.prototype;
            return t.recover = function () {
                W.recover("DrawLineCmd", this)
            }, t.run = function (t, e, i) {
                t._drawLine(e, i, this.fromX, this.fromY, this.toX, this.toY, this.lineColor, this.lineWidth, this.vid)
            }, d(0, t, "cmdID", function () {
                return "DrawLine"
            }), h.create = function (t, e, i, n, r, s, a) {
                var o = W.getItemByClass("DrawLineCmd", h);
                return o.fromX = t, o.fromY = e, o.toX = i, o.toY = n, o.lineColor = r, o.lineWidth = s, o.vid = a, o
            }, h.ID = "DrawLine", h
        }(), rt = function () {
            function s() {
            }

            x(s, "laya.webgl.WebGLContext");
            var t = s.prototype;
            return t.getContextAttributes = function () {
                return null
            }, t.isContextLost = function () {
            }, t.getSupportedExtensions = function () {
                return null
            }, t.getExtension = function (t) {
                return null
            }, t.activeTexture = function (t) {
            }, t.attachShader = function (t, e) {
            }, t.bindAttribLocation = function (t, e, i) {
            }, t.bindBuffer = function (t, e) {
            }, t.bindFramebuffer = function (t, e) {
            }, t.bindRenderbuffer = function (t, e) {
            }, t.bindTexture = function (t, e) {
            }, t.useTexture = function (t) {
            }, t.blendColor = function (t, e, i, n) {
            }, t.blendEquation = function (t) {
            }, t.blendEquationSeparate = function (t, e) {
            }, t.blendFunc = function (t, e) {
            }, t.blendFuncSeparate = function (t, e, i, n) {
            }, t.bufferData = function (t, e, i) {
            }, t.bufferSubData = function (t, e, i) {
            }, t.checkFramebufferStatus = function (t) {
                return null
            }, t.clear = function (t) {
            }, t.clearColor = function (t, e, i, n) {
            }, t.clearDepth = function (t) {
            }, t.clearStencil = function (t) {
            }, t.colorMask = function (t, e, i, n) {
            }, t.compileShader = function (t) {
            }, t.copyTexImage2D = function (t, e, i, n, r, s, a, o) {
            }, t.copyTexSubImage2D = function (t, e, i, n, r, s, a, o) {
            }, t.createBuffer = function () {
            }, t.createFramebuffer = function () {
            }, t.createProgram = function () {
            }, t.createRenderbuffer = function () {
            }, t.createShader = function (t) {
            }, t.createTexture = function () {
                return null
            }, t.cullFace = function (t) {
            }, t.deleteBuffer = function (t) {
            }, t.deleteFramebuffer = function (t) {
            }, t.deleteProgram = function (t) {
            }, t.deleteRenderbuffer = function (t) {
            }, t.deleteShader = function (t) {
            }, t.deleteTexture = function (t) {
            }, t.depthFunc = function (t) {
            }, t.depthMask = function (t) {
            }, t.depthRange = function (t, e) {
            }, t.detachShader = function (t, e) {
            }, t.disable = function (t) {
            }, t.disableVertexAttribArray = function (t) {
            }, t.drawArrays = function (t, e, i) {
            }, t.drawElements = function (t, e, i, n) {
            }, t.enable = function (t) {
            }, t.enableVertexAttribArray = function (t) {
            }, t.finish = function () {
            }, t.flush = function () {
            }, t.framebufferRenderbuffer = function (t, e, i, n) {
            }, t.framebufferTexture2D = function (t, e, i, n, r) {
            }, t.frontFace = function (t) {
                return null
            }, t.generateMipmap = function (t) {
                return null
            }, t.getActiveAttrib = function (t, e) {
                return null
            }, t.getActiveUniform = function (t, e) {
                return null
            }, t.getAttribLocation = function (t, e) {
                return 0
            }, t.getParameter = function (t) {
                return null
            }, t.getBufferParameter = function (t, e) {
                return null
            }, t.getError = function () {
                return null
            }, t.getFramebufferAttachmentParameter = function (t, e, i) {
            }, t.getProgramParameter = function (t, e) {
                return 0
            }, t.getProgramInfoLog = function (t) {
                return null
            }, t.getRenderbufferParameter = function (t, e) {
                return null
            }, t.getShaderPrecisionFormat = function (t) {
                return null
            }, t.getShaderParameter = function (t, e) {
            }, t.getShaderInfoLog = function (t) {
                return null
            }, t.getShaderSource = function (t) {
                return null
            }, t.getTexParameter = function (t, e) {
            }, t.getUniform = function (t, e) {
            }, t.getUniformLocation = function (t, e) {
                return null
            }, t.getVertexAttrib = function (t, e) {
                return null
            }, t.getVertexAttribOffset = function (t, e) {
                return null
            }, t.hint = function (t, e) {
            }, t.isBuffer = function (t) {
            }, t.isEnabled = function (t) {
            }, t.isFramebuffer = function (t) {
            }, t.isProgram = function (t) {
            }, t.isRenderbuffer = function (t) {
            }, t.isShader = function (t) {
            }, t.isTexture = function (t) {
            }, t.lineWidth = function (t) {
            }, t.linkProgram = function (t) {
            }, t.pixelStorei = function (t, e) {
            }, t.polygonOffset = function (t, e) {
            }, t.readPixels = function (t, e, i, n, r, s, a) {
            }, t.renderbufferStorage = function (t, e, i, n) {
            }, t.sampleCoverage = function (t, e) {
            }, t.scissor = function (t, e, i, n) {
            }, t.shaderSource = function (t, e) {
            }, t.stencilFunc = function (t, e, i) {
            }, t.stencilFuncSeparate = function (t, e, i, n) {
            }, t.stencilMask = function (t) {
            }, t.stencilMaskSeparate = function (t, e) {
            }, t.stencilOp = function (t, e, i) {
            }, t.stencilOpSeparate = function (t, e, i, n) {
            }, t.texImage2D = function (t) {
            }, t.texParameterf = function (t, e, i) {
            },t.texParameteri = function (t, e, i) {
            },t.texSubImage2D = function (t) {
            },t.uniform1f = function (t, e) {
            },t.uniform1fv = function (t, e) {
            },t.uniform1i = function (t, e) {
            },t.uniform1iv = function (t, e) {
            },t.uniform2f = function (t, e, i) {
            },t.uniform2fv = function (t, e) {
            },t.uniform2i = function (t, e, i) {
            },t.uniform2iv = function (t, e) {
            },t.uniform3f = function (t, e, i, n) {
            },t.uniform3fv = function (t, e) {
            },t.uniform3i = function (t, e, i, n) {
            },t.uniform3iv = function (t, e) {
            },t.uniform4f = function (t, e, i, n, r) {
            },t.uniform4fv = function (t, e) {
            },t.uniform4i = function (t, e, i, n, r) {
            },t.uniform4iv = function (t, e) {
            },t.uniformMatrix2fv = function (t, e, i) {
            },t.uniformMatrix3fv = function (t, e, i) {
            },t.uniformMatrix4fv = function (t, e, i) {
            },t.useProgram = function (t) {
            },t.validateProgram = function (t) {
            },t.vertexAttrib1f = function (t, e) {
            },t.vertexAttrib1fv = function (t, e) {
            },t.vertexAttrib2f = function (t, e, i) {
            },t.vertexAttrib2fv = function (t, e) {
            },t.vertexAttrib3f = function (t, e, i, n) {
            },t.vertexAttrib3fv = function (t, e) {
            },t.vertexAttrib4f = function (t, e, i, n, r) {
            },t.vertexAttrib4fv = function (t, e) {
            },t.vertexAttribPointer = function (t, e, i, n, r, s) {
            },t.viewport = function (t, e, i, n) {
            },t.configureBackBuffer = function (t, e, i, n, r) {
                void 0 === n && (n = !0), void 0 === r && (r = !1)
            },t.compressedTexImage2D = function (t) {
            },t.createVertexArray = function () {
                throw"not implemented"
            },t.bindVertexArray = function (t) {
                throw"not implemented"
            },t.deleteVertexArray = function (t) {
                throw"not implemented"
            },t.isVertexArray = function (t) {
                throw"not implemented"
            },s._forceSupportVAOPlatform = function () {
                return Lt.onMiniGame && Lt.onIOS || Lt.onBDMiniGame || Lt.onQGMiniGame
            },s.__init__ = function (t) {
                if (laya.webgl.WebGLContext._checkExtensions(t), !Ct._isWebGL2 && !Rt.isConchApp) {
                    m._setupVertexArrayObject && (s._forceSupportVAOPlatform() ? m._forceSetupVertexArrayObject(t) : m._setupVertexArrayObject(t));
                    var e = (t.rawgl || t).getExtension("OES_vertex_array_object");
                    if (e) {
                        var i = t;
                        i.createVertexArray = function () {
                            return e.createVertexArrayOES()
                        }, i.bindVertexArray = function (t) {
                            e.bindVertexArrayOES(t)
                        }, i.deleteVertexArray = function (t) {
                            e.deleteVertexArrayOES(t)
                        }, i.isVertexArray = function (t) {
                            e.isVertexArrayOES(t)
                        }
                    }
                }
            },s._getExtension = function (t, e) {
                var i = s._extentionVendorPrefixes;
                for (var n in i) {
                    var r = t.getExtension(i[n] + e);
                    if (r) return r
                }
                return null
            },s._checkExtensions = function (t) {
                s._extTextureFilterAnisotropic = s._getExtension(t, "EXT_texture_filter_anisotropic"), s._compressedTextureS3tc = s._getExtension(t, "WEBGL_compressed_texture_s3tc"), s._compressedTexturePvrtc = s._getExtension(t, "WEBGL_compressed_texture_pvrtc"), s._compressedTextureEtc1 = s._getExtension(t, "WEBGL_compressed_texture_etc1"), s._forceSupportVAOPlatform() || (s._angleInstancedArrays = s._getExtension(t, "ANGLE_instanced_arrays"))
            },s.__init_native = function () {
                if (Rt.supportWebGLPlusRendering) {
                    var t = s;
                    t.activeTexture = t.activeTextureForNative, t.bindTexture = t.bindTextureForNative
                }
            },s.useProgram = function (t, e) {
                return s._useProgram !== e && (t.useProgram(e), s._useProgram = e, !0)
            },s.setDepthTest = function (t, e) {
                e !== s._depthTest && ((s._depthTest = e) ? t.enable(2929) : t.disable(2929))
            },s.setDepthMask = function (t, e) {
                e !== s._depthMask && (s._depthMask = e, t.depthMask(e))
            },s.setDepthFunc = function (t, e) {
                e !== s._depthFunc && (s._depthFunc = e, t.depthFunc(e))
            },s.setBlend = function (t, e) {
                e !== s._blend && ((s._blend = e) ? t.enable(3042) : t.disable(3042))
            },s.setBlendFunc = function (t, e, i) {
                (e !== s._sFactor || i !== s._dFactor) && (s._sFactor = s._srcAlpha = e, s._dFactor = s._dstAlpha = i, t.blendFunc(e, i))
            },s.setBlendFuncSeperate = function (t, e, i, n, r) {
                e === s._sFactor && i === s._dFactor && n === s._srcAlpha && r === s._dstAlpha || (s._sFactor = e, s._dFactor = i, s._srcAlpha = n, s._dstAlpha = r, t.blendFuncSeparate(e, i, n, r))
            },s.setCullFace = function (t, e) {
                e !== s._cullFace && ((s._cullFace = e) ? t.enable(2884) : t.disable(2884))
            },s.setFrontFace = function (t, e) {
                e !== s._frontFace && (s._frontFace = e, t.frontFace(e))
            },s.activeTexture = function (t, e) {
                s._activedTextureID !== e && (t.activeTexture(e), s._activedTextureID = e)
            },s.bindTexture = function (t, e, i) {
                s._activeTextures[s._activedTextureID - 33984] !== i && (t.bindTexture(e, i), s._activeTextures[s._activedTextureID - 33984] = i)
            },s.useProgramForNative = function (t, e) {
                return t.useProgram(e), !0
            },s.setDepthTestForNative = function (t, e) {
                e ? t.enable(2929) : t.disable(2929)
            },s.setDepthMaskForNative = function (t, e) {
                t.depthMask(e)
            },s.setDepthFuncForNative = function (t, e) {
                t.depthFunc(e)
            },s.setBlendForNative = function (t, e) {
                e ? t.enable(3042) : t.disable(3042)
            },s.setBlendFuncForNative = function (t, e, i) {
                t.blendFunc(e, i)
            },s.setCullFaceForNative = function (t, e) {
                e ? t.enable(2884) : t.disable(2884)
            },s.setFrontFaceForNative = function (t, e) {
                t.frontFace(e)
            },s.activeTextureForNative = function (t, e) {
                t.activeTexture(e)
            },s.bindTextureForNative = function (t, e, i) {
                t.bindTexture(e, i)
            },s.bindVertexArrayForNative = function (t, e) {
                t.bindVertexArray(e)
            },s.DEPTH_BUFFER_BIT = 256,s.STENCIL_BUFFER_BIT = 1024,s.COLOR_BUFFER_BIT = 16384,s.POINTS = 0,s.LINES = 1,s.LINE_LOOP = 2,s.LINE_STRIP = 3,s.TRIANGLES = 4,s.TRIANGLE_STRIP = 5,s.TRIANGLE_FAN = 6,s.ZERO = 0,s.ONE = 1,s.SRC_COLOR = 768,s.ONE_MINUS_SRC_COLOR = 769,s.SRC_ALPHA = 770,s.ONE_MINUS_SRC_ALPHA = 771,s.DST_ALPHA = 772,s.ONE_MINUS_DST_ALPHA = 773,s.DST_COLOR = 774,s.ONE_MINUS_DST_COLOR = 775,s.SRC_ALPHA_SATURATE = 776,s.FUNC_ADD = 32774,s.BLEND_EQUATION = 32777,s.BLEND_EQUATION_RGB = 32777,s.BLEND_EQUATION_ALPHA = 34877,s.FUNC_SUBTRACT = 32778,s.FUNC_REVERSE_SUBTRACT = 32779,s.BLEND_DST_RGB = 32968,s.BLEND_SRC_RGB = 32969,s.BLEND_DST_ALPHA = 32970,s.BLEND_SRC_ALPHA = 32971,s.CONSTANT_COLOR = 32769,s.ONE_MINUS_CONSTANT_COLOR = 32770,s.CONSTANT_ALPHA = 32771,s.ONE_MINUS_CONSTANT_ALPHA = 32772,s.BLEND_COLOR = 32773,s.ARRAY_BUFFER = 34962,s.ELEMENT_ARRAY_BUFFER = 34963,s.ARRAY_BUFFER_BINDING = 34964,s.ELEMENT_ARRAY_BUFFER_BINDING = 34965,s.STREAM_DRAW = 35040,s.STATIC_DRAW = 35044,s.DYNAMIC_DRAW = 35048,s.BUFFER_SIZE = 34660,s.BUFFER_USAGE = 34661,s.CURRENT_VERTEX_ATTRIB = 34342,s.FRONT = 1028,s.BACK = 1029,s.CULL_FACE = 2884,s.FRONT_AND_BACK = 1032,s.BLEND = 3042,s.DITHER = 3024,s.STENCIL_TEST = 2960,s.DEPTH_TEST = 2929,s.SCISSOR_TEST = 3089,s.POLYGON_OFFSET_FILL = 32823,s.SAMPLE_ALPHA_TO_COVERAGE = 32926,s.SAMPLE_COVERAGE = 32928,s.NO_ERROR = 0,s.INVALID_ENUM = 1280,s.INVALID_VALUE = 1281,s.INVALID_OPERATION = 1282,s.OUT_OF_MEMORY = 1285,s.CW = 2304,s.CCW = 2305,s.LINE_WIDTH = 2849,s.ALIASED_POINT_SIZE_RANGE = 33901,s.ALIASED_LINE_WIDTH_RANGE = 33902,s.CULL_FACE_MODE = 2885,s.FRONT_FACE = 2886,s.DEPTH_RANGE = 2928,s.DEPTH_WRITEMASK = 2930,s.DEPTH_CLEAR_VALUE = 2931,s.DEPTH_FUNC = 2932,s.STENCIL_CLEAR_VALUE = 2961,s.STENCIL_FUNC = 2962,s.STENCIL_FAIL = 2964,s.STENCIL_PASS_DEPTH_FAIL = 2965,s.STENCIL_PASS_DEPTH_PASS = 2966,s.STENCIL_REF = 2967,s.STENCIL_VALUE_MASK = 2963,s.STENCIL_WRITEMASK = 2968,s.STENCIL_BACK_FUNC = 34816,s.STENCIL_BACK_FAIL = 34817,s.STENCIL_BACK_PASS_DEPTH_FAIL = 34818,s.STENCIL_BACK_PASS_DEPTH_PASS = 34819,s.STENCIL_BACK_REF = 36003,s.STENCIL_BACK_VALUE_MASK = 36004,s.STENCIL_BACK_WRITEMASK = 36005,s.VIEWPORT = 2978,s.SCISSOR_BOX = 3088,s.COLOR_CLEAR_VALUE = 3106,s.COLOR_WRITEMASK = 3107,s.UNPACK_ALIGNMENT = 3317,s.PACK_ALIGNMENT = 3333,s.MAX_TEXTURE_SIZE = 3379,s.MAX_VIEWPORT_DIMS = 3386,s.SUBPIXEL_BITS = 3408,s.RED_BITS = 3410,s.GREEN_BITS = 3411,s.BLUE_BITS = 3412,s.ALPHA_BITS = 3413,s.DEPTH_BITS = 3414,s.STENCIL_BITS = 3415,s.POLYGON_OFFSET_UNITS = 10752,s.POLYGON_OFFSET_FACTOR = 32824,s.TEXTURE_BINDING_2D = 32873,s.SAMPLE_BUFFERS = 32936,s.SAMPLES = 32937,s.SAMPLE_COVERAGE_VALUE = 32938,s.SAMPLE_COVERAGE_INVERT = 32939,s.NUM_COMPRESSED_TEXTURE_FORMATS = 34466,s.COMPRESSED_TEXTURE_FORMATS = 34467,s.DONT_CARE = 4352,s.FASTEST = 4353,s.NICEST = 4354,s.GENERATE_MIPMAP_HINT = 33170,s.BYTE = 5120,s.UNSIGNED_BYTE = 5121,s.SHORT = 5122,s.UNSIGNED_SHORT = 5123,s.INT = 5124,s.UNSIGNED_INT = 5125,s.FLOAT = 5126,s.DEPTH_COMPONENT = 6402,s.ALPHA = 6406,s.RGB = 6407,s.RGBA = 6408,s.LUMINANCE = 6409,s.LUMINANCE_ALPHA = 6410,s.UNSIGNED_SHORT_4_4_4_4 = 32819,s.UNSIGNED_SHORT_5_5_5_1 = 32820,s.UNSIGNED_SHORT_5_6_5 = 33635,s.FRAGMENT_SHADER = 35632,s.VERTEX_SHADER = 35633,s.MAX_VERTEX_ATTRIBS = 34921,s.MAX_VERTEX_UNIFORM_VECTORS = 36347,s.MAX_VARYING_VECTORS = 36348,s.MAX_COMBINED_TEXTURE_IMAGE_UNITS = 35661,s.MAX_VERTEX_TEXTURE_IMAGE_UNITS = 35660,s.MAX_TEXTURE_IMAGE_UNITS = 34930,s.MAX_FRAGMENT_UNIFORM_VECTORS = 36349,s.SHADER_TYPE = 35663,s.DELETE_STATUS = 35712,s.LINK_STATUS = 35714,s.VALIDATE_STATUS = 35715,s.ATTACHED_SHADERS = 35717,s.ACTIVE_UNIFORMS = 35718,s.ACTIVE_ATTRIBUTES = 35721,s.SHADING_LANGUAGE_VERSION = 35724,s.CURRENT_PROGRAM = 35725,s.NEVER = 512,s.LESS = 513,s.EQUAL = 514,s.LEQUAL = 515,s.GREATER = 516,s.NOTEQUAL = 517,s.GEQUAL = 518,s.ALWAYS = 519,s.KEEP = 7680,s.REPLACE = 7681,s.INCR = 7682,s.DECR = 7683,s.INVERT = 5386,s.INCR_WRAP = 34055,s.DECR_WRAP = 34056,s.VENDOR = 7936,s.RENDERER = 7937,s.VERSION = 7938,s.NEAREST = 9728,s.LINEAR = 9729,s.NEAREST_MIPMAP_NEAREST = 9984,s.LINEAR_MIPMAP_NEAREST = 9985,s.NEAREST_MIPMAP_LINEAR = 9986,s.LINEAR_MIPMAP_LINEAR = 9987,s.TEXTURE_MAG_FILTER = 10240,s.TEXTURE_MIN_FILTER = 10241,s.TEXTURE_WRAP_S = 10242,s.TEXTURE_WRAP_T = 10243,s.TEXTURE_2D = 3553,s.TEXTURE_3D = 32879,s.TEXTURE = 5890,s.TEXTURE_CUBE_MAP = 34067,s.TEXTURE_BINDING_CUBE_MAP = 34068,s.TEXTURE_CUBE_MAP_POSITIVE_X = 34069,s.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070,s.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071,s.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072,s.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073,s.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074,s.MAX_CUBE_MAP_TEXTURE_SIZE = 34076,s.TEXTURE0 = 33984,s.TEXTURE1 = 33985,s.TEXTURE2 = 33986,s.TEXTURE3 = 33987,s.TEXTURE4 = 33988,s.TEXTURE5 = 33989,s.TEXTURE6 = 33990,s.TEXTURE7 = 33991,s.TEXTURE8 = 33992,s.TEXTURE9 = 33993,s.TEXTURE10 = 33994,s.TEXTURE11 = 33995,s.TEXTURE12 = 33996,s.TEXTURE13 = 33997,s.TEXTURE14 = 33998,s.TEXTURE15 = 33999,s.TEXTURE16 = 34e3,s.TEXTURE17 = 34001,s.TEXTURE18 = 34002,s.TEXTURE19 = 34003,s.TEXTURE20 = 34004,s.TEXTURE21 = 34005,s.TEXTURE22 = 34006,s.TEXTURE23 = 34007,s.TEXTURE24 = 34008,s.TEXTURE25 = 34009,s.TEXTURE26 = 34010,s.TEXTURE27 = 34011,s.TEXTURE28 = 34012,s.TEXTURE29 = 34013,s.TEXTURE30 = 34014,s.TEXTURE31 = 34015,s.ACTIVE_TEXTURE = 34016,s.REPEAT = 10497,s.CLAMP_TO_EDGE = 33071,s.MIRRORED_REPEAT = 33648,s.FLOAT_VEC2 = 35664,s.FLOAT_VEC3 = 35665,s.FLOAT_VEC4 = 35666,s.INT_VEC2 = 35667,s.INT_VEC3 = 35668,s.INT_VEC4 = 35669,s.BOOL = 35670,s.BOOL_VEC2 = 35671,s.BOOL_VEC3 = 35672,s.BOOL_VEC4 = 35673,s.FLOAT_MAT2 = 35674,s.FLOAT_MAT3 = 35675,s.FLOAT_MAT4 = 35676,s.SAMPLER_2D = 35678,s.SAMPLER_CUBE = 35680,s.VERTEX_ATTRIB_ARRAY_ENABLED = 34338,s.VERTEX_ATTRIB_ARRAY_SIZE = 34339,s.VERTEX_ATTRIB_ARRAY_STRIDE = 34340,s.VERTEX_ATTRIB_ARRAY_TYPE = 34341,s.VERTEX_ATTRIB_ARRAY_NORMALIZED = 34922,s.VERTEX_ATTRIB_ARRAY_POINTER = 34373,s.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING = 34975,s.COMPILE_STATUS = 35713,s.LOW_FLOAT = 36336,s.MEDIUM_FLOAT = 36337,s.HIGH_FLOAT = 36338,s.LOW_INT = 36339,s.MEDIUM_INT = 36340,s.HIGH_INT = 36341,s.FRAMEBUFFER = 36160,s.RENDERBUFFER = 36161,s.RGBA4 = 32854,s.RGB5_A1 = 32855,s.RGB565 = 36194,s.DEPTH_COMPONENT16 = 33189,s.STENCIL_INDEX = 6401,s.STENCIL_INDEX8 = 36168,s.DEPTH_STENCIL = 34041,s.RENDERBUFFER_WIDTH = 36162,s.RENDERBUFFER_HEIGHT = 36163,s.RENDERBUFFER_INTERNAL_FORMAT = 36164,s.RENDERBUFFER_RED_SIZE = 36176,s.RENDERBUFFER_GREEN_SIZE = 36177,s.RENDERBUFFER_BLUE_SIZE = 36178,s.RENDERBUFFER_ALPHA_SIZE = 36179,s.RENDERBUFFER_DEPTH_SIZE = 36180,s.RENDERBUFFER_STENCIL_SIZE = 36181,s.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE = 36048,s.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME = 36049,s.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL = 36050,s.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE = 36051,s.COLOR_ATTACHMENT0 = 36064,s.DEPTH_ATTACHMENT = 36096,s.STENCIL_ATTACHMENT = 36128,s.DEPTH_STENCIL_ATTACHMENT = 33306,s.NONE = 0,s.FRAMEBUFFER_COMPLETE = 36053,s.FRAMEBUFFER_INCOMPLETE_ATTACHMENT = 36054,s.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT = 36055,s.FRAMEBUFFER_INCOMPLETE_DIMENSIONS = 36057,s.FRAMEBUFFER_UNSUPPORTED = 36061,s.FRAMEBUFFER_BINDING = 36006,s.RENDERBUFFER_BINDING = 36007,s.MAX_RENDERBUFFER_SIZE = 34024,s.INVALID_FRAMEBUFFER_OPERATION = 1286,s.UNPACK_FLIP_Y_WEBGL = 37440,s.UNPACK_PREMULTIPLY_ALPHA_WEBGL = 37441,s.CONTEXT_LOST_WEBGL = 37442,s.UNPACK_COLORSPACE_CONVERSION_WEBGL = 37443,s.BROWSER_DEFAULT_WEBGL = 37444,s._extTextureFilterAnisotropic = null,s._compressedTextureS3tc = null,s._compressedTexturePvrtc = null,s._compressedTextureEtc1 = null,s._angleInstancedArrays = null,s._glTextureIDs = [33984, 33985, 33986, 33987, 33988, 33989, 33990, 33991],s._useProgram = null,s._depthTest = !0,s._depthMask = !0,s._blend = !1,s._cullFace = !1,s._activedTextureID = 33984,a(s, ["_extentionVendorPrefixes", function () {
                return this._extentionVendorPrefixes = ["", "WEBKIT_", "MOZ_"]
            }, "_activeTextures", function () {
                return this._activeTextures = new Array(8)
            }, "_depthFunc", function () {
                return this._depthFunc = 513
            }, "_sFactor", function () {
                return this._sFactor = 1
            }, "_dFactor", function () {
                return this._dFactor = 0
            }, "_srcAlpha", function () {
                return this._srcAlpha = 1
            }, "_dstAlpha", function () {
                return this._dstAlpha = 0
            }, "_frontFace", function () {
                return this._frontFace = 2305
            }]),s
        }(), st = (function () {
            function n() {
            }

            x(n, "laya.net.ResourceVersion"), n.enable = function (t, e, i) {
                void 0 === i && (i = 2), laya.net.ResourceVersion.type = i, y.loader.load(t, b.create(null, n.onManifestLoaded, [e]), null, "json"), q.customFormat = n.addVersionPrefix
            }, n.onManifestLoaded = function (t, e) {
                n.manifest = e, t.run()
            }, n.addVersionPrefix = function (t) {
                return t = q.getAdptedFilePath(t), n.manifest && n.manifest[t] ? 2 == n.type ? n.manifest[t] : n.manifest[t] + "/" + t : t
            }, n.FOLDER_VERSION = 1, n.FILENAME_VERSION = 2, n.manifest = null, n.type = 1
        }(), function () {
            function a() {
            }

            x(a, "laya.display.cmd.FillWordsCmd");
            var t = a.prototype;
            return t.recover = function () {
                this.words = null, W.recover("FillWordsCmd", this)
            }, t.run = function (t, e, i) {
                t.fillWords(this.words, this.x + e, this.y + i, this.font, this.color)
            }, d(0, t, "cmdID", function () {
                return "FillWords"
            }), a.create = function (t, e, i, n, r) {
                var s = W.getItemByClass("FillWordsCmd", a);
                return s.words = t, s.x = e, s.y = i, s.font = n, s.color = r, s
            }, a.ID = "FillWords", a
        }()), at = function () {
            function o(t, e, i, n, r, s, a) {
                if (this._bTransform = !1, void 0 === t && (t = 1), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 1), void 0 === r && (r = 0), void 0 === s && (s = 0), void 0 === a && (a = 0), null != o._createFun) return o._createFun(t, e, i, n, r, s, a);
                this.a = t, this.b = e, this.c = i, this.d = n, this.tx = r, this.ty = s, this._checkTransform()
            }

            x(o, "laya.maths.Matrix");
            var t = o.prototype;
            return t.identity = function () {
                return this.a = this.d = 1, this.b = this.tx = this.ty = this.c = 0, this._bTransform = !1, this
            }, t._checkTransform = function () {
                return this._bTransform = 1 !== this.a || 0 !== this.b || 0 !== this.c || 1 !== this.d
            }, t.setTranslate = function (t, e) {
                return this.tx = t, this.ty = e, this
            }, t.translate = function (t, e) {
                return this.tx += t, this.ty += e, this
            }, t.scale = function (t, e) {
                return this.a *= t, this.d *= e, this.c *= t, this.b *= e, this.tx *= t, this.ty *= e, this._bTransform = !0, this
            }, t.rotate = function (t) {
                var e = Math.cos(t), i = Math.sin(t), n = this.a, r = this.c, s = this.tx;
                return this.a = n * e - this.b * i, this.b = n * i + this.b * e, this.c = r * e - this.d * i, this.d = r * i + this.d * e, this.tx = s * e - this.ty * i, this.ty = s * i + this.ty * e, this._bTransform = !0, this
            }, t.skew = function (t, e) {
                var i = Math.tan(t), n = Math.tan(e), r = this.a, s = this.b;
                return this.a += n * this.c, this.b += n * this.d, this.c += i * r, this.d += i * s, this
            }, t.invertTransformPoint = function (t) {
                var e = this.a, i = this.b, n = this.c, r = this.d, s = this.tx, a = e * r - i * n, o = r / a,
                    h = -i / a, l = -n / a, u = e / a, c = (n * this.ty - r * s) / a, _ = -(e * this.ty - i * s) / a;
                return t.setTo(o * t.x + l * t.y + c, h * t.x + u * t.y + _)
            }, t.transformPoint = function (t) {
                return t.setTo(this.a * t.x + this.c * t.y + this.tx, this.b * t.x + this.d * t.y + this.ty)
            }, t.transformPointN = function (t) {
                return t.setTo(this.a * t.x + this.c * t.y, this.b * t.x + this.d * t.y)
            }, t.getScaleX = function () {
                return 0 === this.b ? this.a : Math.sqrt(this.a * this.a + this.b * this.b)
            }, t.getScaleY = function () {
                return 0 === this.c ? this.d : Math.sqrt(this.c * this.c + this.d * this.d)
            }, t.invert = function () {
                var t = this.a, e = this.b, i = this.c, n = this.d, r = this.tx, s = t * n - e * i;
                return this.a = n / s, this.b = -e / s, this.c = -i / s, this.d = t / s, this.tx = (i * this.ty - n * r) / s, this.ty = -(t * this.ty - e * r) / s, this
            }, t.setTo = function (t, e, i, n, r, s) {
                return this.a = t, this.b = e, this.c = i, this.d = n, this.tx = r, this.ty = s, this
            }, t.concat = function (t) {
                var e = this.a, i = this.c, n = this.tx;
                return this.a = e * t.a + this.b * t.c, this.b = e * t.b + this.b * t.d, this.c = i * t.a + this.d * t.c, this.d = i * t.b + this.d * t.d, this.tx = n * t.a + this.ty * t.c + t.tx, this.ty = n * t.b + this.ty * t.d + t.ty, this
            }, t.scaleEx = function (t, e) {
                var i = this.a, n = this.b, r = this.c, s = this.d;
                this.d = (this.c = 0 !== n || 0 !== r ? (this.a = t * i, this.b = t * n, e * r) : (this.a = t * i, this.b = 0 * s, 0 * i), e * s), this._bTransform = !0
            }, t.rotateEx = function (t) {
                var e = Math.cos(t), i = Math.sin(t), n = this.a, r = this.b, s = this.c, a = this.d;
                this.d = 0 !== r || 0 !== s ? (this.a = e * n + i * s, this.b = e * r + i * a, this.c = -i * n + e * s, -i * r + e * a) : (this.a = e * n, this.b = i * a, this.c = -i * n, e * a), this._bTransform = !0
            }, t.clone = function () {
                var t = o.create();
                return t.a = this.a, t.b = this.b, t.c = this.c, t.d = this.d, t.tx = this.tx, t.ty = this.ty, t._bTransform = this._bTransform, t
            }, t.copyTo = function (t) {
                return t.a = this.a, t.b = this.b, t.c = this.c, t.d = this.d, t.tx = this.tx, t.ty = this.ty, t._bTransform = this._bTransform, t
            }, t.toString = function () {
                return this.a + "," + this.b + "," + this.c + "," + this.d + "," + this.tx + "," + this.ty
            }, t.destroy = function () {
                this.recover()
            }, t.recover = function () {
                W.recover("Matrix", this.identity())
            }, o.mul = function (t, e, i) {
                var n = t.a, r = t.b, s = t.c, a = t.d, o = t.tx, h = t.ty, l = e.a, u = e.b, c = e.c, _ = e.d,
                    f = e.tx, d = e.ty;
                return i.ty = 0 !== u || 0 !== c ? (i.a = n * l + r * c, i.b = n * u + r * _, i.c = s * l + a * c, i.d = s * u + a * _, i.tx = l * o + c * h + f, u * o + _ * h + d) : (i.a = n * l, i.b = r * _, i.c = s * l, i.d = a * _, i.tx = l * o + f, _ * h + d), i
            }, o.mul16 = function (t, e, i) {
                var n = t.a, r = t.b, s = t.c, a = t.d, o = t.tx, h = t.ty, l = e.a, u = e.b, c = e.c, _ = e.d,
                    f = e.tx, d = e.ty;
                return i[13] = 0 !== u || 0 !== c ? (i[0] = n * l + r * c, i[1] = n * u + r * _, i[4] = s * l + a * c, i[5] = s * u + a * _, i[12] = l * o + c * h + f, u * o + _ * h + d) : (i[0] = n * l, i[1] = r * _, i[4] = s * l, i[5] = a * _, i[12] = l * o + f, _ * h + d), i
            }, o.create = function () {
                return W.getItemByClass("Matrix", o)
            }, o.EMPTY = new o, o.TEMP = new o, o._createFun = null, o
        }(), ot = function () {
            function t(t, e, i, n) {
                this.id = 0, this.name = null, this.color = 0, this.scale = 1, this.datapos = 0, this.datas = new Array(oi.DATANUM), this.id = t, this.color = e, this.name = i, this.scale = n
            }

            return x(t, "laya.utils.PerfData"), t.prototype.addData = function (t) {
                this.datas[this.datapos] = t, this.datapos++, this.datapos %= oi.DATANUM
            }, t
        }(), ht = function () {
            function r() {
            }

            x(r, "laya.display.cmd.TransformCmd");
            var t = r.prototype;
            return t.recover = function () {
                this.matrix = null, W.recover("TransformCmd", this)
            }, t.run = function (t, e, i) {
                t._transform(this.matrix, this.pivotX + e, this.pivotY + i)
            }, d(0, t, "cmdID", function () {
                return "Transform"
            }), r.create = function (t, e, i) {
                var n = W.getItemByClass("TransformCmd", r);
                return n.matrix = t, n.pivotX = e, n.pivotY = i, n
            }, r.ID = "Transform", r
        }(), lt = function () {
            function n() {
            }

            x(n, "laya.display.cmd.DrawTexturesCmd");
            var t = n.prototype;
            return t.recover = function () {
                this.texture._removeReference(), this.texture = null, this.pos = null, W.recover("DrawTexturesCmd", this)
            }, t.run = function (t, e, i) {
                t.drawTextures(this.texture, this.pos, e, i)
            }, d(0, t, "cmdID", function () {
                return "DrawTextures"
            }), n.create = function (t, e) {
                var i = W.getItemByClass("DrawTexturesCmd", n);
                return (i.texture = t)._addReference(), i.pos = e, i
            }, n.ID = "DrawTextures", n
        }(), ut = function () {
            function h() {
            }

            x(h, "laya.display.cmd.DrawCircleCmd");
            var t = h.prototype;
            return t.recover = function () {
                this.fillColor = null, this.lineColor = null, W.recover("DrawCircleCmd", this)
            }, t.run = function (t, e, i) {
                t._drawCircle(this.x + e, this.y + i, this.radius, this.fillColor, this.lineColor, this.lineWidth, this.vid)
            }, d(0, t, "cmdID", function () {
                return "DrawCircle"
            }), h.create = function (t, e, i, n, r, s, a) {
                var o = W.getItemByClass("DrawCircleCmd", h);
                return o.x = t, o.y = e, o.radius = i, o.fillColor = n, o.lineColor = r, o.lineWidth = s, o.vid = a, o
            }, h.ID = "DrawCircle", h
        }(), ct = function () {
            var i;

            function V() {
                if (this._drawTriUseAbsMatrix = !1, this._id = ++V._COUNT, this._other = null, this._renderNextSubmitIndex = 0, this._path = null, this._drawCount = 1, this._renderCount = 0, this._isConvexCmd = !0, this._submits = null, this._curSubmit = null, this._mesh = null, this._pathMesh = null, this._triangleMesh = null, this.meshlist = [], this._clipInCache = !1, this._clipInfoID = 0, this._curMat = null, this._lastMatScaleX = 1, this._lastMatScaleY = 1, this._lastMat_a = 1, this._lastMat_b = 0, this._lastMat_c = 0, this._lastMat_d = 1, this._nBlendType = 0, this._save = null, this._targets = null, this._charSubmitCache = null, this._saveMark = null, this.sprite = null, this._italicDeg = 0, this._lastTex = null, this._fillColor = 0, this._flushCnt = 0, this.defTexture = null, this._colorFiler = null, this.drawTexAlign = !1, this._incache = !1, this.isMain = !1, this._tmpMatrix = new at, this._drawTexToDrawTri_Vert = new Float32Array(8), this._drawTexToDrawTri_Index = new Uint16Array([0, 1, 2, 0, 2, 3]), this._tempUV = new Float32Array(8), this._width = 99999999, this._height = 99999999, this._submitKey = new U, this._transedPoints = new Array(8), this._temp4Points = new Array(8), this._clipRect = V.MAXCLIPRECT, this._globalClipMatrix = new at(99999999, 0, 0, 99999999, 0, 0), this._shader2D = new O, V._contextcount++, !this.defTexture) {
                    var t = new _i(2, 2);
                    t.setPixels(new Uint8Array(16)), t.lock = !0, this.defTexture = new Ie(t)
                }
                this._lastTex = this.defTexture, this.clear()
            }

            x(V, "laya.resource.Context");
            var t = V.prototype;
            return t.drawImage = function (t) {
            }, t.getImageData = function (t) {
            }, t.measureText = function (t) {
                return null
            }, t.setTransform = function (t) {
            }, t.$transform = function (t, e, i, n, r, s) {
            }, t.clearRect = function (t, e, i, n) {
            }, t._drawRect = function (t, e, i, n, r) {
                M.renderBatches++, r && (this.fillStyle = r), this.fillRect(t, e, i, n)
            }, t.drawTexture2 = function (t, e, i, n, r, s) {
            }, t.transformByMatrix = function (t, e, i) {
                this.transform(t.a, t.b, t.c, t.d, t.tx + e, t.ty + i)
            }, t.saveTransform = function (t) {
                this.save()
            }, t.restoreTransform = function (t) {
                this.restore()
            }, t.drawRect = function (t, e, i, n, r, s, a) {
                var o = this;
                null != r && (o.fillStyle = r, o.fillRect(t, e, i, n)), null != s && (o.strokeStyle = s, o.lineWidth = a, o.strokeRect(t, e, i, n))
            }, t.alpha = function (t) {
                this.globalAlpha *= t
            }, t._transform = function (t, e, i) {
                this.translate(e, i), this.transform(t.a, t.b, t.c, t.d, t.tx, t.ty), this.translate(-e, -i)
            }, t._rotate = function (t, e, i) {
                this.translate(e, i), this.rotate(t), this.translate(-e, -i)
            }, t._scale = function (t, e, i, n) {
                this.translate(i, n), this.scale(t, e), this.translate(-i, -n)
            }, t._drawLine = function (t, e, i, n, r, s, a, o, h) {
                this.beginPath(), this.strokeStyle = a, this.lineWidth = o, this.moveTo(t + i, e + n), this.lineTo(t + r, e + s), this.stroke()
            }, t._drawLines = function (t, e, i, n, r, s) {
                this.beginPath(), this.strokeStyle = n, this.lineWidth = r;
                i.length;
                this.addPath(i.slice(), !1, !1, t, e), this.stroke()
            }, t.drawCurves = function (t, e, i, n, r) {
                this.beginPath(), this.strokeStyle = n, this.lineWidth = r, this.moveTo(t + i[0], e + i[1]);
                for (var s = 2, a = i.length; s < a;) this.quadraticCurveTo(t + i[s++], e + i[s++], t + i[s++], e + i[s++]);
                this.stroke()
            }, t._fillAndStroke = function (t, e, i, n) {
                void 0 === n && (n = !1), null != t && (this.fillStyle = t, this.fill()), null != e && 0 < i && (this.strokeStyle = e, this.lineWidth = i, this.stroke())
            }, t._drawCircle = function (t, e, i, n, r, s, a) {
                M.renderBatches++, this.beginPath(!0), this.arc(t, e, i, 0, V.PI2), this.closePath(), this._fillAndStroke(n, r, s)
            }, t._drawPie = function (t, e, i, n, r, s, a, o, h) {
                this.beginPath(), this.moveTo(t, e), this.arc(t, e, i, n, r), this.closePath(), this._fillAndStroke(s, a, o)
            }, t._drawPoly = function (t, e, i, n, r, s, a, o) {
                i.length;
                this.beginPath(), this.addPath(i.slice(), !0, a, t, e), this.closePath(), this._fillAndStroke(n, r, s, a)
            }, t._drawPath = function (t, e, i, n, r) {
                this.beginPath();
                for (var s = 0, a = i.length; s < a; s++) {
                    var o = i[s];
                    switch (o[0]) {
                        case"moveTo":
                            this.moveTo(t + o[1], e + o[2]);
                            break;
                        case"lineTo":
                            this.lineTo(t + o[1], e + o[2]);
                            break;
                        case"arcTo":
                            this.arcTo(t + o[1], e + o[2], t + o[3], e + o[4], o[5]);
                            break;
                        case"closePath":
                            this.closePath()
                    }
                }
                null != n && (this.fillStyle = n.fillStyle, this.fill()), null != r && (this.strokeStyle = r.strokeStyle, this.lineWidth = r.lineWidth || 1, this.lineJoin = r.lineJoin, this.lineCap = r.lineCap, this.miterLimit = r.miterLimit, this.stroke())
            }, t.clearBG = function (t, e, i, n) {
                var r = Ct.mainContext;
                r.clearColor(t, e, i, n), r.clear(16384)
            }, t._getSubmits = function () {
                return this._submits
            }, t._releaseMem = function (t) {
                if (void 0 === t && (t = !1), this._submits) {
                    this._curMat.destroy(), this._curMat = null, this._shader2D.destroy(), this._shader2D = null, this._charSubmitCache.clear();
                    for (var e = 0, i = this._submits._length; e < i; e++) this._submits[e].releaseRender();
                    this._submits.length = 0, this._submits._length = 0, this._submits = null, this._curSubmit = null, this._path = null, this._save = null;
                    var n;
                    for (e = 0, n = this.meshlist.length; e < n; e++) {
                        this.meshlist[e].destroy()
                    }
                    this.meshlist.length = 0, this.sprite = null, t || (this._targets && this._targets.destroy(), this._targets = null)
                }
            }, t.destroy = function (t) {
                void 0 === t && (t = !1), --V._contextcount, this.sprite = null, this._releaseMem(t), this._charSubmitCache.destroy(), this._mesh.destroy(), t || (this._targets && this._targets.destroy(), this._targets = null)
            }, t.clear = function () {
                this._submits || (this._other = i.DEFAULT, this._curMat = at.create(), this._charSubmitCache = new se, this._mesh = Fe.getAMesh(this.isMain), this.meshlist.push(this._mesh), this._pathMesh = Ee.getAMesh(this.isMain), this.meshlist.push(this._pathMesh), this._triangleMesh = ke.getAMesh(this.isMain), this.meshlist.push(this._triangleMesh), this._submits = [], this._save = [z.Create(this)], this._save.length = 10, this._shader2D = new O), this._submitKey.clear(), this._mesh.clearVB(), this._renderCount++, this._drawCount = 1, this._other = i.DEFAULT, this._other.lineWidth = this._shader2D.ALPHA = 1, this._nBlendType = 0, this._clipRect = V.MAXCLIPRECT, this._curSubmit = T.RENDERBASE, T.RENDERBASE._ref = 16777215, T.RENDERBASE._numEle = 0, this._shader2D.fillStyle = this._shader2D.strokeStyle = Et.DEFAULT;
                for (var t = 0, e = this._submits._length; t < e; t++) this._submits[t].releaseRender();
                this._submits._length = 0, this._curMat.identity(), this._other.clear(), this._saveMark = this._save[0], this._save._length = 1
            }, t.size = function (t, e) {
                this._width == t && this._height == e || (this._width = t, this._height = e, this._targets && (this._targets.destroy(), this._targets = new fi(t, e, 1, -1)), Rt._context == this && (Ct.mainContext.viewport(0, 0, t, e), pt.width = t, pt.height = e)), 0 === t && 0 === e && this._releaseMem()
            }, t.getMatScaleX = function () {
                return this._lastMat_a == this._curMat.a && this._lastMat_b == this._curMat.b || (this._lastMatScaleX = this._curMat.getScaleX(), this._lastMat_a = this._curMat.a, this._lastMat_b = this._curMat.b), this._lastMatScaleX
            }, t.getMatScaleY = function () {
                return this._lastMat_c == this._curMat.c && this._lastMat_d == this._curMat.d || (this._lastMatScaleY = this._curMat.getScaleY(), this._lastMat_c = this._curMat.c, this._lastMat_d = this._curMat.d), this._lastMatScaleY
            }, t.setFillColor = function (t) {
                this._fillColor = t
            }, t.getFillColor = function () {
                return this._fillColor
            }, t.translate = function (t, e) {
                0 === t && 0 === e || (it.save(this), this._curMat._bTransform ? (Bt.save(this), this._curMat.tx += t * this._curMat.a + e * this._curMat.c, this._curMat.ty += t * this._curMat.b + e * this._curMat.d) : (this._curMat.tx = t, this._curMat.ty = e))
            }, t.save = function () {
                this._save[this._save._length++] = z.Create(this)
            }, t.restore = function () {
                var t = this._save._length, e = this._nBlendType;
                if (!(t < 1)) {
                    for (var i = t - 1; 0 <= i; i--) {
                        var n = this._save[i];
                        if (n.restore(this), n.isSaveMark()) return void (this._save._length = i)
                    }
                    e != this._nBlendType && (this._curSubmit = T.RENDERBASE)
                }
            }, t.fillText = function (t, e, i, n, r, s) {
                this._fillText(t, null, e, i, n, r, null, 0, null)
            }, t._fillText = function (t, e, i, n, r, s, a, o, h, l) {
                void 0 === l && (l = 0), t ? V._textRender.filltext(this, t, i, n, r, s, a, o, h, l) : e && V._textRender.fillWords(this, e, i, n, r, s, a, o)
            }, t._fast_filltext = function (t, e, i, n, r, s, a, o, h) {
                void 0 === h && (h = 0), V._textRender._fast_filltext(this, t, null, e, i, n, r, s, a, o, h)
            }, t.fillWords = function (t, e, i, n, r) {
                this._fillText(null, t, e, i, n, r, null, -1, null, 0)
            }, t.fillBorderWords = function (t, e, i, n, r, s, a) {
                this._fillBorderText(null, t, e, i, n, r, s, a, null)
            }, t.drawText = function (t, e, i, n, r, s) {
                this._fillText(t, null, e, i, n, p.create(r).strColor, null, -1, s)
            }, t.strokeWord = function (t, e, i, n, r, s, a) {
                this._fillText(t, null, e, i, n, null, p.create(r).strColor, s || 1, a)
            }, t.fillBorderText = function (t, e, i, n, r, s, a, o) {
                this._fillBorderText(t, null, e, i, n, p.create(r).strColor, p.create(s).strColor, a, o)
            }, t._fillBorderText = function (t, e, i, n, r, s, a, o, h) {
                this._fillText(t, e, i, n, r, s, a, o || 1, h)
            }, t._fillRect = function (t, e, i, n, r) {
                var s = this._curSubmit, a = s && 2 === s._key.submitType && s._key.blendShader === this._nBlendType;
                65535 < this._mesh.vertNum + 4 && (this._mesh = Fe.getAMesh(this.isMain), this.meshlist.push(this._mesh), a = !1), a && (a = a && this.isSameClipInfo(s)), this.transformQuad(t, e, i, n, 0, this._curMat, this._transedPoints), this.clipedOff(this._transedPoints) || (this._mesh.addQuad(this._transedPoints, Ie.NO_UV, r, !1), a || (s = this._curSubmit = Te.create(this, this._mesh, Y.create(1, 0)), this._submits[this._submits._length++] = s, this._copyClipInfo(s, this._globalClipMatrix), s.shaderValue.textureHost = this._lastTex, s._key.other = this._lastTex && this._lastTex.bitmap ? this._lastTex.bitmap.id : -1, s._renderType = 10016), this._curSubmit._numEle += 6, this._mesh.indexNum += 6, this._mesh.vertNum += 4)
            }, t.fillRect = function (t, e, i, n, r) {
                var s = r ? Et.create(r) : this._shader2D.fillStyle, a = this.mixRGBandAlpha(s.toInt());
                this._fillRect(t, e, i, n, a)
            }, t.fillTexture = function (t, e, i, n, r, s, a, o) {
                t._getSource() ? this._fillTexture(t, t.width, t.height, t.uvrect, e, i, n, r, s, a.x, a.y) : this.sprite && y.systemTimer.callLater(this, this._repaintSprite)
            }, t._fillTexture = function (t, e, i, n, r, s, a, o, h, l, u) {
                var c = this._curSubmit;
                65535 < this._mesh.vertNum + 4 && (this._mesh = Fe.getAMesh(this.isMain), this.meshlist.push(this._mesh));
                var _ = !0, f = !0;
                switch (h) {
                    case"repeat":
                        break;
                    case"repeat-x":
                        f = !1;
                        break;
                    case"repeat-y":
                        _ = !1;
                        break;
                    case"no-repeat":
                        _ = f = !1
                }
                var d = this._temp4Points, p = 0, m = 0, g = 0, v = 0, y = 0, x = 0;
                if (l < 0 ? (g = r, p = -l % e / e) : g = r + l, u < 0 ? (v = s, m = -u % i / i) : v = s + u, y = r + a, x = s + o, !_ && (y = Math.min(y, r + l + e)), !f && (x = Math.min(x, s + u + i)), !(y < r || x < s || y < g || x < v)) {
                    var T = (y - r - l) / e, b = (x - s - u) / i;
                    if (this.transformQuad(g, v, y - g, x - v, 0, this._curMat, this._transedPoints), d[0] = p, d[1] = m, d[2] = T, d[3] = m, d[4] = T, d[5] = b, d[6] = p, d[7] = b, !this.clipedOff(this._transedPoints)) {
                        var w = this._mixRGBandAlpha(4294967295, this._shader2D.ALPHA);
                        this._mesh.addQuad(this._transedPoints, d, w, !0);
                        var C = Y.create(1, 0);
                        C.defines.add(256), C.u_TexRange = n, c = this._curSubmit = Te.create(this, this._mesh, C), this._submits[this._submits._length++] = c, this._copyClipInfo(c, this._globalClipMatrix), c.shaderValue.textureHost = t, c._renderType = 10016, this._curSubmit._numEle += 6, this._mesh.indexNum += 6, this._mesh.vertNum += 4
                    }
                    this.breakNextMerge()
                }
            }, t.setColorFilter = function (t) {
                o.save(this, 8388608, this, !0), this._colorFiler = t, this._curSubmit = T.RENDERBASE
            }, t.drawTexture = function (t, e, i, n, r) {
                this._drawTextureM(t, e, i, n, r, null, 1, null)
            }, t.drawTextures = function (t, e, i, n) {
                if (t._getSource()) for (var r = e.length / 2, s = 0, a = t.bitmap.id, o = 0; o < r; o++) this._inner_drawTexture(t, a, e[s++] + i, e[s++] + n, 0, 0, null, null, 1, !1); else this.sprite && y.systemTimer.callLater(this, this._repaintSprite)
            }, t._drawTextureAddSubmit = function (t, e) {
                var i = null;
                i = Te.create(this, this._mesh, Y.create(1, 0)), (this._submits[this._submits._length++] = i).shaderValue.textureHost = e, i._key.other = t, i._renderType = 10016, this._curSubmit = i
            }, t._drawTextureM = function (t, e, i, n, r, s, a, o) {
                var h = this.sprite;
                return !!t._getSource(function () {
                    h && h.repaint()
                }) && this._inner_drawTexture(t, t.bitmap.id, e, i, n, r, s, o, a, !1)
            }, t._drawRenderTexture = function (t, e, i, n, r, s, a, o) {
                return this._inner_drawTexture(t, -1, e, i, n, r, s, o, 1, !1)
            }, t.submitDebugger = function () {
                this._submits[this._submits._length++] = Q.create([], function () {
                }, this)
            }, t._copyClipInfo = function (t, e) {
                var i = t.shaderValue.clipMatDir;
                i[0] = e.a, i[1] = e.b, i[2] = e.c, i[3] = e.d;
                var n = t.shaderValue.clipMatPos;
                n[0] = e.tx, n[1] = e.ty, t.clipInfoID = this._clipInfoID, this._clipInCache && (t.shaderValue.clipOff[0] = 1)
            }, t.isSameClipInfo = function (t) {
                return t.clipInfoID === this._clipInfoID
            }, t._useNewTex2DSubmit = function (t, e) {
                65535 < this._mesh.vertNum + e && (this._mesh = Fe.getAMesh(this.isMain), this.meshlist.push(this._mesh));
                var i = Te.create(this, this._mesh, Y.create(1, 0));
                this._submits[this._submits._length++] = this._curSubmit = i, i.shaderValue.textureHost = t, this._copyClipInfo(i, this._globalClipMatrix)
            }, t._drawTexRect = function (t, e, i, n, r) {
                this.transformQuad(t, e, i, n, this._italicDeg, this._curMat, this._transedPoints);
                var s = this._transedPoints;
                s[0] = s[0] + .5 | 0, s[1] = s[1] + .5 | 0, s[2] = s[2] + .5 | 0, s[3] = s[3] + .5 | 0, s[4] = s[4] + .5 | 0, s[5] = s[5] + .5 | 0, s[6] = s[6] + .5 | 0, s[7] = s[7] + .5 | 0, this.clipedOff(this._transedPoints) || (this._mesh.addQuad(this._transedPoints, r, this._fillColor, !0), this._curSubmit._numEle += 6, this._mesh.indexNum += 6, this._mesh.vertNum += 4)
            }, t.drawCallOptimize = function (t) {
                return this._charSubmitCache.enable(t, this), t
            }, t._inner_drawTexture = function (t, e, i, n, r, s, a, o, h, l) {
                var u = this._curSubmit._key;
                if (o = o || t._uv, 4 === u.submitType && u.other === e) {
                    var c = this._drawTexToDrawTri_Vert;
                    c[0] = i, c[1] = n, c[2] = i + r, c[3] = n, c[4] = i + r, c[5] = n + s, c[6] = i, c[7] = n + s, this._drawTriUseAbsMatrix = !0;
                    var _ = this._tempUV;
                    return _[0] = o[0], _[1] = o[1], _[2] = o[2], _[3] = o[3], _[4] = o[4], _[5] = o[5], _[6] = o[6], _[7] = o[7], this.drawTriangles(t, 0, 0, c, _, this._drawTexToDrawTri_Index, a, h, null, null), !(this._drawTriUseAbsMatrix = !1)
                }
                var f = this._mesh, d = this._curSubmit, p = l ? this._charSubmitCache.getPos() : this._transedPoints;
                if (this.transformQuad(i, n, r || t.width, s || t.height, this._italicDeg, a || this._curMat, p), this.drawTexAlign) {
                    var m = Math.round;
                    p[0] = m(p[0]), p[1] = m(p[1]), p[2] = m(p[2]), p[3] = m(p[3]), p[4] = m(p[4]), p[5] = m(p[5]), p[6] = m(p[6]), p[7] = m(p[7]), this.drawTexAlign = !1
                }
                var g = this._mixRGBandAlpha(4294967295, this._shader2D.ALPHA * h);
                if (l) return this._charSubmitCache.add(this, t, e, p, o, g), !0;
                this._drawCount++;
                var v = 0 <= e && 2 === u.submitType && u.other === e;
                return v && (v = v && this.isSameClipInfo(d)), this._lastTex = t, 65535 < f.vertNum + 4 && (f = this._mesh = Fe.getAMesh(this.isMain), this.meshlist.push(f), v = !1), f.addQuad(p, o, g, !0), v || (this._submits[this._submits._length++] = this._curSubmit = d = Te.create(this, f, Y.create(1, 0)), d.shaderValue.textureHost = t, d._key.other = e, this._copyClipInfo(d, this._globalClipMatrix)), d._numEle += 6, f.indexNum += 6, f.vertNum += 4, !0
            }, t.transform4Points = function (t, e, i) {
                var n = e.tx, r = e.ty, s = e.a, a = e.b, o = e.c, h = e.d, l = t[0], u = t[1], c = t[2], _ = t[3],
                    f = t[4], d = t[5], p = t[6], m = t[7];
                e._bTransform ? (i[0] = l * s + u * o + n, i[1] = l * a + u * h + r, i[2] = c * s + _ * o + n, i[3] = c * a + _ * h + r, i[4] = f * s + d * o + n, i[5] = f * a + d * h + r, i[6] = p * s + m * o + n, i[7] = p * a + m * h + r) : (i[0] = l + n, i[1] = u + r, i[2] = c + n, i[3] = _ + r, i[4] = f + n, i[5] = d + r, i[6] = p + n, i[7] = m + r)
            }, t.clipedOff = function (t) {
                return this._clipRect.width <= 0 || this._clipRect.height <= 0
            }, t.transformQuad = function (t, e, i, n, r, s, a) {
                var o = 0;
                0 != r && (o = Math.tan(r * Math.PI / 180) * n);
                var h = t + i, l = e + n, u = s.tx, c = s.ty, _ = s.a, f = s.b, d = s.c, p = s.d, m = t + o, g = e,
                    v = h + o, y = e, x = h, T = l, b = t, w = l;
                s._bTransform ? (a[0] = m * _ + g * d + u, a[1] = m * f + g * p + c, a[2] = v * _ + y * d + u, a[3] = v * f + y * p + c, a[4] = x * _ + T * d + u, a[5] = x * f + T * p + c, a[6] = b * _ + w * d + u, a[7] = b * f + w * p + c) : (a[0] = m + u, a[1] = g + c, a[2] = v + u, a[3] = y + c, a[4] = x + u, a[5] = T + c, a[6] = b + u, a[7] = w + c)
            }, t.pushRT = function () {
                this.addRenderObject(Q.create(null, fi.pushRT, this))
            }, t.popRT = function () {
                this.addRenderObject(Q.create(null, fi.popRT, this)), this.breakNextMerge()
            }, t.useRT = function (t) {
                this.addRenderObject(Q.create([t], function (t) {
                    if (!t) throw"error useRT";
                    t.start(), t.clear(0, 0, 0, 0)
                }, this)), this.breakNextMerge()
            }, t.RTRestore = function (t) {
                this.addRenderObject(Q.create([t], function (t) {
                    t.restore()
                }, this)), this.breakNextMerge()
            }, t.breakNextMerge = function () {
                this._curSubmit = T.RENDERBASE
            }, t._repaintSprite = function () {
                this.sprite && this.sprite.repaint()
            }, t.drawTextureWithTransform = function (t, e, i, n, r, s, a, o, h, l, u) {
                var c = null, _ = this._curMat;
                l && (c = this.globalCompositeOperation, this.globalCompositeOperation = l);
                var f = this._colorFiler;
                if (u && this.setColorFilter(u), !s) return this._drawTextureM(t, e + a, i + o, n, r, _, h, null), l && (this.globalCompositeOperation = c), void (u && this.setColorFilter(f));
                var d = this._tmpMatrix;
                d.a = s.a, d.b = s.b, d.c = s.c, d.d = s.d, d.tx = s.tx + a, d.ty = s.ty + o, d._bTransform = s._bTransform, s && _._bTransform ? (at.mul(d, _, d), (s = d)._bTransform = !0) : (d.tx += _.tx, d.ty += _.ty, s = d), this._drawTextureM(t, e, i, n, r, s, h, null), l && (this.globalCompositeOperation = c), u && this.setColorFilter(f)
            }, t._flushToTarget = function (t, e) {
                pt.worldScissorTest = !1, Ct.mainContext.disable(3089);
                var i = pt.worldAlpha, n = pt.worldMatrix4, r = pt.worldMatrix;
                pt.worldShaderDefines;
                pt.worldMatrix = at.EMPTY, pt.restoreTempArray(), pt.worldMatrix4 = pt.TEMPMAT4_ARRAY, pt.worldAlpha = 1, Ke.activeShader = null, e.start(), 0 < t._submits._length && e.clear(0, 0, 0, 0), t._curSubmit = T.RENDERBASE, t.flush(), t.clear(), e.restore(), t._curSubmit = T.RENDERBASE, Ke.activeShader = null, pt.worldAlpha = i, pt.worldMatrix4 = n, pt.worldMatrix = r
            }, t.drawCanvas = function (t, e, i, n, r) {
                if (t) {
                    var s, a = t.context;
                    if (a._targets) 0 < a._submits._length && (s = Q.create([a, a._targets], this._flushToTarget, this), this._submits[this._submits._length++] = s), this._drawRenderTexture(a._targets, e, i, n, r, null, 1, fi.flipyuv), this._curSubmit = T.RENDERBASE; else {
                        var o = t;
                        o.touches && o.touches.forEach(function (t) {
                            t.touch()
                        }), s = we.create(t, this._shader2D.ALPHA, this._shader2D.filters), (this._submits[this._submits._length++] = s)._key.clear();
                        var h = s._matrix;
                        this._curMat.copyTo(h);
                        var l = h.tx, u = h.ty;
                        h.tx = h.ty = 0, h.transformPoint(Ht.TEMP.setTo(e, i)), h.translate(Ht.TEMP.x + l, Ht.TEMP.y + u), at.mul(o.invMat, h, h), this._curSubmit = T.RENDERBASE
                    }
                }
            }, t.drawTarget = function (t, e, i, n, r, s, a, o, h) {
                void 0 === h && (h = -1), this._drawCount++;
                if (65535 < this._mesh.vertNum + 4 && (this._mesh = Fe.getAMesh(this.isMain), this.meshlist.push(this._mesh)), this.transformQuad(e, i, n, r, 0, s || this._curMat, this._transedPoints), this.clipedOff(this._transedPoints)) return this._curSubmit = T.RENDERBASE, !1;
                this._mesh.addQuad(this._transedPoints, o || Ie.DEF_UV, 4294967295, !0);
                var l = this._curSubmit = c.create(this, this._mesh, a, t);
                return l.blendType = -1 == h ? this._nBlendType : h, this._copyClipInfo(l, this._globalClipMatrix), l._numEle = 6, this._mesh.indexNum += 6, this._mesh.vertNum += 4, this._submits[this._submits._length++] = l, this._curSubmit = T.RENDERBASE, !0
            }, t.drawTriangles = function (t, e, i, n, r, s, a, o, h, l) {
                if (t._getSource()) {
                    this._drawCount++;
                    var u = this._tmpMatrix, c = this._triangleMesh, _ = null, f = !1;
                    h && (_ = this._colorFiler, this._colorFiler = h, this._curSubmit = T.RENDERBASE, f = _ != h);
                    var d = t.bitmap, p = this._curSubmit._key,
                        m = 4 === p.submitType && p.other === d.id && p.blendShader == this._nBlendType;
                    if (65535 < c.vertNum + n.length / 2 && (c = this._triangleMesh = ke.getAMesh(this.isMain), this.meshlist.push(c), m = !1), !m) {
                        var g = this._curSubmit = Te.create(this, c, Y.create(1, 0));
                        g.shaderValue.textureHost = t, g._renderType = 10016, g._key.submitType = 4, g._key.other = d.id, this._copyClipInfo(g, this._globalClipMatrix), this._submits[this._submits._length++] = g
                    }
                    var v = this._mixRGBandAlpha(4294967295, this._shader2D.ALPHA * o);
                    this._drawTriUseAbsMatrix ? c.addData(n, r, s, a, v) : (u.ty = a ? (u.a = a.a, u.b = a.b, u.c = a.c, u.d = a.d, u.tx = a.tx + e, a.ty + i) : (u.a = 1, u.b = 0, u.c = 0, u.d = 1, u.tx = e, i), at.mul(u, this._curMat, u), c.addData(n, r, s, u, v)), this._curSubmit._numEle += s.length, f && (this._colorFiler = _, this._curSubmit = T.RENDERBASE)
                } else this.sprite && y.systemTimer.callLater(this, this._repaintSprite)
            }, t.transform = function (t, e, i, n, r, s) {
                Bt.save(this), at.mul(at.TEMP.setTo(t, e, i, n, r, s), this._curMat, this._curMat), this._curMat._checkTransform()
            }, t._transformByMatrix = function (t, e, i) {
                t.setTranslate(e, i), at.mul(t, this._curMat, this._curMat), t.setTranslate(0, 0), this._curMat._bTransform = !0
            }, t.setTransformByMatrix = function (t) {
                t.copyTo(this._curMat)
            }, t.rotate = function (t) {
                Bt.save(this), this._curMat.rotateEx(t)
            }, t.scale = function (t, e) {
                Bt.save(this), this._curMat.scaleEx(t, e)
            }, t.clipRect = function (t, e, i, n) {
                le.save(this), this._clipRect == V.MAXCLIPRECT ? this._clipRect = new gt(t, e, i, n) : (this._clipRect.width = i, this._clipRect.height = n, this._clipRect.x = t, this._clipRect.y = e), V._clipID_Gen++, V._clipID_Gen %= 1e4, this._clipInfoID = V._clipID_Gen;
                var r = this._globalClipMatrix, s = r.tx, a = r.ty, o = s + r.a, h = a + r.d;
                if (99999999 <= this._clipRect.width ? (r.a = r.d = 99999999, r.b = r.c = r.tx = r.ty = 0) : (this._curMat._bTransform ? (r.tx = this._clipRect.x * this._curMat.a + this._clipRect.y * this._curMat.c + this._curMat.tx, r.ty = this._clipRect.x * this._curMat.b + this._clipRect.y * this._curMat.d + this._curMat.ty, r.a = this._clipRect.width * this._curMat.a, r.b = this._clipRect.width * this._curMat.b, r.c = this._clipRect.height * this._curMat.c, r.d = this._clipRect.height * this._curMat.d) : (r.tx = this._clipRect.x + this._curMat.tx, r.ty = this._clipRect.y + this._curMat.ty, r.a = this._clipRect.width, r.b = r.c = 0, r.d = this._clipRect.height), this._incache && (this._clipInCache = !0)), 0 < r.a && 0 < r.d) {
                    var l = r.tx + r.a, u = r.ty + r.d;
                    l <= s || u <= a || r.tx >= o || r.ty >= h ? (r.a = -.1, r.d = -.1) : (r.tx < s && (r.a -= s - r.tx, r.tx = s), o < l && (r.a -= l - o), r.ty < a && (r.d -= a - r.ty, r.ty = a), h < u && (r.d -= u - h), r.a <= 0 && (r.a = -.1), r.d <= 0 && (r.d = -.1))
                }
            }, t.drawMesh = function (t, e, i, n, r, s, a, o, h) {
                void 0 === h && (h = 0)
            }, t.addRenderObject = function (t) {
                this._submits[this._submits._length++] = t
            }, t.submitElement = function (t, e) {
                Rt._context;
                var i = this._submits, n = i._length;
                e < 0 && (e = i._length);
                for (var r = T.RENDERBASE; t < e;) this._renderNextSubmitIndex = t + 1, i[t] !== T.RENDERBASE ? (T.preRender = r, t += (r = i[t]).renderSubmit()) : t++;
                return n
            }, t.flush = function () {
                var t = this.submitElement(0, this._submits._length);
                this._path && this._path.reset(), f.instance && f.getInstance().reset(), this._curSubmit = T.RENDERBASE;
                for (var e = 0, i = this.meshlist.length; e < i; e++) {
                    var n = this.meshlist[e];
                    n.canReuse ? n.releaseMesh() : n.destroy()
                }
                return this.meshlist.length = 0, this._mesh = Fe.getAMesh(this.isMain), this._pathMesh = Ee.getAMesh(this.isMain), this._triangleMesh = ke.getAMesh(this.isMain), this.meshlist.push(this._mesh, this._pathMesh, this._triangleMesh), this._flushCnt++, this._flushCnt % 60 == 0 && Rt._context == this && A.textRenderInst && A.textRenderInst.GC(), t
            }, t.beginPath = function (t) {
                void 0 === t && (t = !1), this._getPath().beginPath(t)
            }, t.closePath = function () {
                this._path.closePath()
            }, t.addPath = function (t, e, i, n, r) {
                for (var s = 0, a = 0, o = t.length / 2; a < o; a++) {
                    var h = t[s] + n, l = t[s + 1] + r;
                    t[s] = h, t[s + 1] = l, s += 2
                }
                this._getPath().push(t, i)
            }, t.fill = function () {
                var t = this._curMat, e = this._getPath(), i = this._curSubmit,
                    n = 3 === i._key.submitType && i._key.blendShader === this._nBlendType;
                n && (n = n && this.isSameClipInfo(i)), n || (this._curSubmit = this.addVGSubmit(this._pathMesh));
                for (var r, s = this.mixRGBandAlpha(this.fillStyle.toInt()), a = 0, o = 0, h = e.paths.length; o < h; o++) {
                    var l = e.paths[o], u = l.path.length / 2;
                    if (!(u < 3 || 3 == u && !l.convex)) {
                        var c = l.path.concat(), _ = 0, f = 0, d = 0, p = NaN, m = NaN;
                        if (t._bTransform) for (_ = 0; _ < u; _++) d = (f = _ << 1) + 1, p = c[f], m = c[d], c[f] = t.a * p + t.c * m + t.tx, c[d] = t.b * p + t.d * m + t.ty; else for (_ = 0; _ < u; _++) d = (f = _ << 1) + 1, p = c[f], m = c[d], c[f] = p + t.tx, c[d] = m + t.ty;
                        65535 < this._pathMesh.vertNum + u && (this._curSubmit._numEle += a, a = 0, this._pathMesh = Ee.getAMesh(this.isMain), this._curSubmit = this.addVGSubmit(this._pathMesh));
                        var g = this._pathMesh.vertNum;
                        if (l.convex) {
                            var v = u - 2;
                            r = new Array(3 * v);
                            for (var y = 0, x = 0; x < v; x++) r[y++] = g, r[y++] = x + 1 + g, r[y++] = x + 2 + g
                        } else if (r = Vt.earcut(c, null, 2), 0 < g) for (var T = 0; T < r.length; T++) r[T] += g;
                        this._pathMesh.addVertAndIBToMesh(this, c, s, r), a += r.length
                    }
                }
                this._curSubmit._numEle += a
            }, t.addVGSubmit = function (t) {
                var e = T.createShape(this, t, 0, Y.create(4, 0));
                return e._key.submitType = 3, this._submits[this._submits._length++] = e, this._copyClipInfo(e, this._globalClipMatrix), e
            }, t.stroke = function () {
                if (0 < this.lineWidth) {
                    var t = this.mixRGBandAlpha(this.strokeStyle._color.numColor), e = this._getPath(),
                        i = this._curSubmit, n = 3 === i._key.submitType && i._key.blendShader === this._nBlendType;
                    n && (n = n && this.isSameClipInfo(i)), n || (this._curSubmit = this.addVGSubmit(this._pathMesh));
                    for (var r = 0, s = 0, a = e.paths.length; s < a; s++) {
                        var o = e.paths[s];
                        if (!(o.path.length <= 0)) {
                            var h = [], l = [], u = 2 * o.path.length;
                            if (!(u < 2)) {
                                65535 < this._pathMesh.vertNum + u && (this._curSubmit._numEle += r, r = 0, this._pathMesh = Ee.getAMesh(this.isMain), this.meshlist.push(this._pathMesh), this._curSubmit = this.addVGSubmit(this._pathMesh)), zt.createLine2(o.path, h, this.lineWidth, this._pathMesh.vertNum, l, o.loop);
                                var c = l.length / 2, _ = this._curMat, f = 0, d = 0, p = 0, m = NaN, g = NaN;
                                if (_._bTransform) for (f = 0; f < c; f++) p = (d = f << 1) + 1, m = l[d], g = l[p], l[d] = _.a * m + _.c * g + _.tx, l[p] = _.b * m + _.d * g + _.ty; else for (f = 0; f < c; f++) p = (d = f << 1) + 1, m = l[d], g = l[p], l[d] = m + _.tx, l[p] = g + _.ty;
                                this._pathMesh.addVertAndIBToMesh(this, l, t, h), r += h.length
                            }
                        }
                    }
                    this._curSubmit._numEle += r
                }
            }, t.moveTo = function (t, e) {
                var i = this._getPath();
                i.newPath(), i._lastOriX = t, i._lastOriY = e, i.addPoint(t, e)
            }, t.lineTo = function (t, e) {
                var i = this._getPath();
                Math.abs(t - i._lastOriX) < .001 && Math.abs(e - i._lastOriY) < .001 || (i._lastOriX = t, i._lastOriY = e, i.addPoint(t, e))
            }, t.arcTo = function (t, e, i, n, r) {
                var s = 0, a = 0, o = 0, h = this._path._lastOriX - t, l = this._path._lastOriY - e,
                    u = Math.sqrt(h * h + l * l);
                if (!(u <= 1e-6)) {
                    var c = h / u, _ = l / u, f = i - t, d = n - e, p = f * f + d * d, m = Math.sqrt(p);
                    if (!(m <= 1e-6)) {
                        var g = f / m, v = d / m, y = c + g, x = _ + v, T = Math.sqrt(y * y + x * x);
                        if (!(T <= 1e-6)) {
                            var b = y / T, w = x / T, C = Math.acos(b * c + w * _), A = Math.PI / 2 - C,
                                M = (u = r / Math.tan(A)) * c + t, E = u * _ + e, S = Math.sqrt(u * u + r * r),
                                R = t + b * S, I = e + w * S, P = 0, D = 0;
                            if (0 <= c * v - _ * g) {
                                var L = 2 * A / V.SEGNUM;
                                P = Math.sin(L), D = Math.cos(L)
                            } else L = 2 * -A / V.SEGNUM, P = Math.sin(L), D = Math.cos(L);
                            var B = this._path._lastOriX, F = this._path._lastOriY, O = M, N = E;
                            (.1 < Math.abs(O - this._path._lastOriX) || .1 < Math.abs(N - this._path._lastOriY)) && (B = a = O, F = o = N, this._path.addPoint(a, o));
                            var k = M - R, U = E - I;
                            for (s = 0; s < V.SEGNUM; s++) {
                                var W = k * D + U * P, G = -k * P + U * D;
                                a = W + R, o = G + I, (.1 < Math.abs(B - a) || .1 < Math.abs(F - o)) && (this._path.addPoint(a, o), B = a, F = o), k = W, U = G
                            }
                        }
                    }
                }
            }, t.arc = function (t, e, i, n, r, s, a) {
                void 0 === s && (s = !1), void 0 === a && (a = !0);
                var o, h, l = 0, u = 0, c = 0, _ = 0, f = 0, d = 0, p = 0;
                if (u = r - n, s) if (Math.abs(u) >= 2 * Math.PI) u = 2 * -Math.PI; else for (; 0 < u;) u -= 2 * Math.PI; else if (Math.abs(u) >= 2 * Math.PI) u = 2 * Math.PI; else for (; u < 0;) u += 2 * Math.PI;
                var m = this.getMatScaleX(), g = this.getMatScaleY(), v = i * (g < m ? m : g), y = 2 * Math.PI * v;
                o = u / (h = 0 | Math.max(y / 10, 10)) / 2, c = Math.abs(4 / 3 * (1 - Math.cos(o)) / Math.sin(o)), s && (c = -c);
                var x = this._getPath();
                for (p = 0; p <= h; p++) l = n + u * (p / h), _ = Math.cos(l), d = e + Math.sin(l) * i, (f = t + _ * i) == this._path._lastOriX && d == this._path._lastOriY || x.addPoint(f, d);
                _ = Math.cos(r), d = e + Math.sin(r) * i, (f = t + _ * i) == this._path._lastOriX && d == this._path._lastOriY || x.addPoint(f, d)
            }, t.quadraticCurveTo = function (t, e, i, n) {
                for (var r = Nt.I.getBezierPoints([this._path._lastOriX, this._path._lastOriY, t, e, i, n], 30, 2), s = 0, a = r.length / 2; s < a; s++) this.lineTo(r[2 * s], r[2 * s + 1]);
                this.lineTo(i, n)
            }, t.mixRGBandAlpha = function (t) {
                return this._mixRGBandAlpha(t, this._shader2D.ALPHA)
            }, t._mixRGBandAlpha = function (t, e) {
                if (1 <= e) return t;
                var i = (4278190080 & t) >>> 24;
                return 0 != i ? i *= e : i = 255 * e, 16777215 & t | i << 24
            }, t.strokeRect = function (t, e, i, n, r) {
                if (0 < this.lineWidth) {
                    var s = this.mixRGBandAlpha(this.strokeStyle._color.numColor), a = this.lineWidth / 2;
                    this._fillRect(t - a, e - a, i + this.lineWidth, this.lineWidth, s), this._fillRect(t - a, e - a + n, i + this.lineWidth, this.lineWidth, s), this._fillRect(t - a, e + a, this.lineWidth, n - this.lineWidth, s), this._fillRect(t - a + i, e + a, this.lineWidth, n - this.lineWidth, s)
                }
            },t.clip = function () {
            },t.drawParticle = function (t, e, i) {
                i.x = t, i.y = e, this._submits[this._submits._length++] = i
            },t._getPath = function () {
                return this._path || (this._path = new S)
            },t._fillTexture_h = function (t, e, i, n, r, s, a, o) {
                for (var h = s, l = Math.floor(o / n), u = o % n, c = 0; c < l; c++) this._inner_drawTexture(t, e, h, a, n, r, this._curMat, i, 1, !1), h += n;
                if (0 < u) {
                    var _ = i[2] - i[0], f = i[0] + _ * (u / n), d = V.tmpuv1;
                    d[0] = i[0], d[1] = i[1], d[2] = f, d[3] = i[3], d[4] = f, d[5] = i[5], d[6] = i[6], d[7] = i[7], this._inner_drawTexture(t, e, h, a, u, r, this._curMat, d, 1, !1)
                }
            },t._fillTexture_v = function (t, e, i, n, r, s, a, o) {
                for (var h = a, l = Math.floor(o / r), u = o % r, c = 0; c < l; c++) this._inner_drawTexture(t, e, s, h, n, r, this._curMat, i, 1, !1), h += r;
                if (0 < u) {
                    var _ = i[7] - i[1], f = i[1] + _ * (u / r), d = V.tmpuv1;
                    d[0] = i[0], d[1] = i[1], d[2] = i[2], d[3] = i[3], d[4] = i[4], d[5] = f, d[6] = i[6], d[7] = f, this._inner_drawTexture(t, e, s, h, n, u, this._curMat, d, 1, !1)
                }
            },t.drawTextureWithSizeGrid = function (t, e, i, n, r, s, a, o) {
                if (t._getSource()) {
                    e += a, i += o;
                    var h = t.uv, l = t.bitmap.width, u = t.bitmap.height, c = s[0], _ = s[3], f = c / u, d = _ / l,
                        p = s[1], m = s[2], g = p / l, v = m / u, y = s[4], x = !1;
                    if (n == l && (_ = p = 0), r == u && (c = m = 0), n < _ + p) {
                        var T = n;
                        x = !0, n = _ + p, this.save(), this.clipRect(0 + e, 0 + i, T, r)
                    }
                    var b = t.bitmap.id, w = this._curMat, C = this._tempUV, A = h[0], M = h[1], E = h[4], S = h[5],
                        R = A, I = M, P = E, D = S;
                    if (_ && c && (P = A + d, D = M + f, C[0] = A, C[1] = M, C[2] = P, C[3] = M, C[4] = P, C[5] = D, C[6] = A, C[7] = D, this._inner_drawTexture(t, b, e, i, _, c, w, C, 1, !1)), p && c && (R = E - g, P = E, D = (I = M) + f, C[0] = R, C[1] = I, C[2] = P, C[3] = I, C[4] = P, C[5] = D, C[6] = R, C[7] = D, this._inner_drawTexture(t, b, n - p + e, 0 + i, p, c, w, C, 1, !1)), _ && m && (I = S - v, P = (R = A) + d, D = S, C[0] = R, C[1] = I, C[2] = P, C[3] = I, C[4] = P, C[5] = D, C[6] = R, C[7] = D, this._inner_drawTexture(t, b, 0 + e, r - m + i, _, m, w, C, 1, !1)), p && m && (R = E - g, I = S - v, P = E, D = S, C[0] = R, C[1] = I, C[2] = P, C[3] = I, C[4] = P, C[5] = D, C[6] = R, C[7] = D, this._inner_drawTexture(t, b, n - p + e, r - m + i, p, m, w, C, 1, !1)), c && (R = A + d, P = E - g, D = (I = M) + f, C[0] = R, C[1] = I, C[2] = P, C[3] = I, C[4] = P, C[5] = D, C[6] = R, C[7] = D, y ? this._fillTexture_h(t, b, C, t.width - _ - p, c, _ + e, i, n - _ - p) : this._inner_drawTexture(t, b, _ + e, i, n - _ - p, c, w, C, 1, !1)), m && (R = A + d, I = S - v, P = E - g, D = S, C[0] = R, C[1] = I, C[2] = P, C[3] = I, C[4] = P, C[5] = D, C[6] = R, C[7] = D, y ? this._fillTexture_h(t, b, C, t.width - _ - p, m, _ + e, r - m + i, n - _ - p) : this._inner_drawTexture(t, b, _ + e, r - m + i, n - _ - p, m, w, C, 1, !1)), _ && (I = M + f, P = (R = A) + d, D = S - v, C[0] = R, C[1] = I, C[2] = P, C[3] = I, C[4] = P, C[5] = D, C[6] = R, C[7] = D, y ? this._fillTexture_v(t, b, C, _, t.height - c - m, e, c + i, r - c - m) : this._inner_drawTexture(t, b, e, c + i, _, r - c - m, w, C, 1, !1)), p && (R = E - g, I = M + f, P = E, D = S - v, C[0] = R, C[1] = I, C[2] = P, C[3] = I, C[4] = P, C[5] = D, C[6] = R, C[7] = D, y ? this._fillTexture_v(t, b, C, p, t.height - c - m, n - p + e, c + i, r - c - m) : this._inner_drawTexture(t, b, n - p + e, c + i, p, r - c - m, w, C, 1, !1)), R = A + d, I = M + f, P = E - g, D = S - v, C[0] = R, C[1] = I, C[2] = P, C[3] = I, C[4] = P, C[5] = D, C[6] = R, C[7] = D, y) {
                        var L = V.tmpUVRect;
                        L[0] = R, L[1] = I, L[2] = P - R, L[3] = D - I, this._fillTexture(t, t.width - _ - p, t.height - c - m, L, _ + e, c + i, n - _ - p, r - c - m, "repeat", 0, 0)
                    } else this._inner_drawTexture(t, b, _ + e, c + i, n - _ - p, r - c - m, w, C, 1, !1);
                    x && this.restore()
                }
            },d(0, t, "textAlign", function () {
                return this._other.textAlign
            }, function (t) {
                this._other.textAlign === t || (this._other = this._other.make(), o.save(this, 32768, this._other, !1), this._other.textAlign = t)
            }),d(0, t, "lineJoin", function () {
                return null
            }, function (t) {
            }),d(0, t, "fillStyle", function () {
                return this._shader2D.fillStyle
            }, function (t) {
                this._shader2D.fillStyle.equal(t) || (o.save(this, 2, this._shader2D, !1), this._shader2D.fillStyle = Et.create(t), this._submitKey.other = -this._shader2D.fillStyle.toInt())
            }),d(0, t, "lineCap", function () {
                return null
            }, function (t) {
            }),d(0, t, "miterLimit", function () {
                return null
            }, function (t) {
            }),d(0, t, "strokeStyle", function () {
                return this._shader2D.strokeStyle
            }, function (t) {
                this._shader2D.strokeStyle.equal(t) || (o.save(this, 512, this._shader2D, !1), this._shader2D.strokeStyle = Et.create(t), this._submitKey.other = -this._shader2D.strokeStyle.toInt())
            }),d(0, t, "globalCompositeOperation", function () {
                return fe.NAMES[this._nBlendType]
            }, function (t) {
                var e = fe.TOINT[t];
                null == e || this._nBlendType === e || (o.save(this, 65536, this, !0), this._curSubmit = T.RENDERBASE, this._nBlendType = e)
            }),d(0, t, "globalAlpha", function () {
                return this._shader2D.ALPHA
            }, function (t) {
                (t = Math.floor(1e3 * t) / 1e3) != this._shader2D.ALPHA && (o.save(this, 1, this._shader2D, !1), this._shader2D.ALPHA = t)
            }),d(0, t, "asBitmap", null, function (t) {
                if (t) {
                    if (this._targets || (this._targets = new fi(this._width, this._height, 1, -1)), !this._width || !this._height) throw Error("asBitmap no size!")
                } else this._targets && this._targets.destroy(), this._targets = null
            }),d(0, t, "textBaseline", function () {
                return this._other.textBaseline
            }, function (t) {
                this._other.textBaseline === t || (this._other = this._other.make(), o.save(this, 16384, this._other, !1), this._other.textBaseline = t)
            }),d(0, t, "lineWidth", function () {
                return this._other.lineWidth
            }, function (t) {
                this._other.lineWidth === t || (this._other = this._other.make(), o.save(this, 256, this._other, !1), this._other.lineWidth = t)
            }),d(0, t, "font", null, function (t) {
                this._other = this._other.make(), o.save(this, 8, this._other, !1)
            }),d(0, t, "canvas", function () {
                return this._canvas
            }),V.__init__ = function () {
                V.MAXCLIPRECT = new gt(0, 0, 99999999, 99999999), i.DEFAULT = new i
            },V.set2DRenderConfig = function () {
                var t = Dt.instance;
                rt.setBlend(t, !0), rt.setBlendFunc(t, 1, 771), rt.setDepthTest(t, !1), rt.setCullFace(t, !1), rt.setDepthMask(t, !0), rt.setFrontFace(t, 2305), t.viewport(0, 0, pt.width, pt.height)
            },V.ENUM_TEXTALIGN_DEFAULT = 0,V.ENUM_TEXTALIGN_CENTER = 1,V.ENUM_TEXTALIGN_RIGHT = 2,V._SUBMITVBSIZE = 32e3,V._MAXSIZE = 99999999,V._MAXVERTNUM = 65535,V.MAXCLIPRECT = null,V._COUNT = 0,V.SEGNUM = 32,V._contextcount = 0,V.PI2 = 2 * Math.PI,V._clipID_Gen = 0,a(V, ["_textRender", function () {
                return this._textRender = new A
            }, "tmpuv1", function () {
                return this.tmpuv1 = [0, 0, 0, 0, 0, 0, 0, 0]
            }, "tmpUV", function () {
                return this.tmpUV = [0, 0, 0, 0, 0, 0, 0, 0]
            }, "tmpUVRect", function () {
                return this.tmpUVRect = [0, 0, 0, 0]
            }]),V.__init$ = function () {
                i = function () {
                    function t() {
                        this.lineWidth = 1, this.textAlign = null, this.textBaseline = null
                    }

                    x(t, "");
                    var e = t.prototype;
                    return e.clear = function () {
                        this.lineWidth = 1, this.textAlign = this.textBaseline = null
                    }, e.make = function () {
                        return this === t.DEFAULT ? new t : this
                    }, t.DEFAULT = null, t
                }()
            },V
        }(), _t = function () {
            function o() {
            }

            x(o, "laya.filters.BlurFilterGLRender");
            var t = o.prototype;
            return t.render = function (t, e, i, n, r) {
                var s = Y.create(1, 0);
                this.setShaderInfo(s, r, t.width, t.height), e.drawTarget(t, 0, 0, i, n, at.EMPTY.identity(), s)
            }, t.setShaderInfo = function (t, e, i, n) {
                t.defines.add(16);
                var r = t;
                o.blurinfo[0] = i, o.blurinfo[1] = n, r.blurInfo = o.blurinfo;
                var s = e.strength / 3, a = s * s;
                e.strength_sig2_2sig2_gauss1[0] = e.strength, e.strength_sig2_2sig2_gauss1[1] = a, e.strength_sig2_2sig2_gauss1[2] = 2 * a, e.strength_sig2_2sig2_gauss1[3] = 1 / (2 * Math.PI * a), r.strength_sig2_2sig2_gauss1 = e.strength_sig2_2sig2_gauss1
            }, a(o, ["blurinfo", function () {
                return this.blurinfo = new Array(2)
            }]), o
        }(), ft = function () {
            function t() {
            }

            return x(t, "laya.webgl.utils.CONST3D2D"), t.BYTES_PE = 4, t.BYTES_PIDX = 2, t.defaultMatrix4 = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], t.defaultMinusYMatrix4 = [1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], t.uniformMatrix3 = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0], t._TMPARRAY = [], t._OFFSETX = 0, t._OFFSETY = 0, t
        }(), dt = function () {
            function t() {
                this.char = "", this.tex = null, this.deleted = !1, this.pos = 0, this.width = 0, this.height = 0, this.bmpWidth = 0, this.bmpHeight = 0, this.orix = 0, this.oriy = 0, this.touchTick = 0, this.isSpace = !1, this.uv = new Array(8)
            }

            return x(t, "laya.webgl.text.CharRenderInfo"), t.prototype.touch = function () {
                var t = M.loopCount;
                this.touchTick != t && this.tex.touchRect(this, t), this.touchTick = t
            }, t
        }(), pt = (function () {
            function r() {
                this._renderType = 0, this._repaint = 0, this._x = NaN, this._y = NaN
            }

            x(r, "laya.layagl.QuickTestTool");
            var t = r.prototype;
            t.render = function (t, e, i) {
                r._addType(this._renderType), r.showRenderTypeInfo(this._renderType), P.renders[this._renderType]._fun(this, t, e + this._x, i + this._y), this._repaint = 0
            }, t._stageRender = function (t, e, i) {
                r._countStart(), r._PreStageRender.call(y.stage, t, e, i), r._countEnd()
            }, r.getMCDName = function (t) {
                return r._typeToNameDic[t]
            }, r.showRenderTypeInfo = function (t, e) {
                if (void 0 === e && (e = !1), (e || !r.showedDic[t]) && (r.showedDic[t] = !0, !r._rendertypeToStrDic[t])) {
                    var i = [], n = 0;
                    for (n = 1; n <= t;) n & t && i.push(r.getMCDName(n & t)), n <<= 1;
                    r._rendertypeToStrDic[t] = i.join(",")
                }
            }, r.__init__ = function () {
                r._typeToNameDic[1] = "ALPHA", r._typeToNameDic[2] = "TRANSFORM", r._typeToNameDic[256] = "TEXTURE", r._typeToNameDic[512] = "GRAPHICS", r._typeToNameDic[4096] = "ONECHILD", r._typeToNameDic[8192] = "CHILDS", r._typeToNameDic[3] = "TRANSFORM|ALPHA", r._typeToNameDic[8] = "CANVAS", r._typeToNameDic[4] = "BLEND", r._typeToNameDic[16] = "FILTERS", r._typeToNameDic[32] = "MASK", r._typeToNameDic[64] = "CLIP", r._typeToNameDic[1024] = "LAYAGL3D"
            }, r._countStart = function () {
                var t;
                for (t in r._countDic) r._countDic[t] = 0
            }, r._countEnd = function () {
                60 < ++r._i && (r.showCountInfo(), r._i = 0)
            }, r._addType = function (t) {
                r._countDic[t] ? r._countDic[t] += 1 : r._countDic[t] = 1
            }, r.showCountInfo = function () {
                var t;
                for (t in r._countDic) r.showRenderTypeInfo(t, !0)
            }, r.enableQuickTest = function () {
                r.__init__(), je.prototype.render = r.prototype.render, r._PreStageRender = ai.prototype.render, ai.prototype.render = r.prototype._stageRender
            }, r.showedDic = {}, r._rendertypeToStrDic = {}, r._typeToNameDic = {}, r._PreStageRender = null, r._countDic = {}, r._i = 0
        }(), function () {
            function r() {
            }

            return x(r, "laya.webgl.utils.RenderState2D"), r.mat2MatArray = function (t, e) {
                var i = t, n = e;
                return n[0] = i.a, n[1] = i.b, n[2] = r.EMPTYMAT4_ARRAY[2], n[3] = r.EMPTYMAT4_ARRAY[3], n[4] = i.c, n[5] = i.d, n[6] = r.EMPTYMAT4_ARRAY[6], n[7] = r.EMPTYMAT4_ARRAY[7], n[8] = r.EMPTYMAT4_ARRAY[8], n[9] = r.EMPTYMAT4_ARRAY[9], n[10] = r.EMPTYMAT4_ARRAY[10], n[11] = r.EMPTYMAT4_ARRAY[11], n[12] = i.tx, n[13] = i.ty, n[14] = r.EMPTYMAT4_ARRAY[14], n[15] = r.EMPTYMAT4_ARRAY[15], e
            }, r.restoreTempArray = function () {
                r.TEMPMAT4_ARRAY[0] = 1, r.TEMPMAT4_ARRAY[1] = 0, r.TEMPMAT4_ARRAY[4] = 0, r.TEMPMAT4_ARRAY[5] = 1, r.TEMPMAT4_ARRAY[12] = 0, r.TEMPMAT4_ARRAY[13] = 0
            }, r.clear = function () {
                r.worldScissorTest = !1, r.worldAlpha = 1
            }, r._MAXSIZE = 99999999, r.EMPTYMAT4_ARRAY = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], r.worldMatrix4 = r.TEMPMAT4_ARRAY = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], r.matWVP = null, r.worldAlpha = 1, r.worldScissorTest = !1, r.worldShaderDefines = null, r.worldFilters = null, r.width = 0, r.height = 0, a(r, ["worldMatrix", function () {
                return this.worldMatrix = new at
            }]), r
        }()), mt = function () {
            var _, l;

            function g() {
            }

            return x(g, "laya.utils.SceneUtils"), g.getBindFun = function (t) {
                var e = g._funMap.get(t);
                if (null == e) {
                    var i = '"' + t + '"',
                        n = "(function(data){if(data==null)return;with(data){try{\nreturn " + (i = i.replace(/^"\${|}"$/g, "").replace(/\${/g, '"+').replace(/}/g, '+"')) + "\n}catch(e){}}})";
                    e = y._runScript(n), g._funMap.set(t, e)
                }
                return e
            }, g.createByData = function (t, e) {
                var i = l.create();
                if ((t = g.createComp(e, t, t, null, i))._setBit(8, !0), t.hasOwnProperty("_idMap") && (t._idMap = i._idMap), e.animations) {
                    var n, r, s = [], a = e.animations, o = 0, h = a.length;
                    for (o = 0; o < h; o++) {
                        switch (n = new ci, r = a[o], n._setUp(i._idMap, r), (t[r.name] = n)._setControlNode(t), r.action) {
                            case 1:
                                n.play(0, !1);
                                break;
                            case 2:
                                n.play(0, !0)
                        }
                        s.push(n)
                    }
                    t._aniList = s
                }
                return "Scene" === t._$componentType && 0 < t._width && null == e.props.hitTestPrior && !t.mouseThrough && (t.hitTestPrior = !0), i.beginLoad(t), t
            }, g.createInitTool = function () {
                return l.create()
            }, g.createComp = function (t, e, i, n, r) {
                if ("Scene3D" == t.type || "Sprite3D" == t.type) {
                    var s = [], a = y.Utils3D._createSceneByJsonForMaker(t, s, r);
                    return "Sprite3D" == t.type ? y.StaticBatchManager.combine(a, s) : y.StaticBatchManager.combine(null, s), a
                }
                if (!(e = e || g.getCompInstance(t))) return t.props && t.props.runtime, null;
                var o = t.child;
                if (o) for (var h = "List" == e._$componentType, l = 0, u = o.length; l < u; l++) {
                    var c = o[l];
                    if (!e.hasOwnProperty("itemRender") || "render" != c.props.name && "render" !== c.props.renderType) if ("Graphic" == c.type) It._addGraphicsToSprite(c, e); else if (It._isDrawType(c.type)) It._addGraphicToSprite(c, e, !0); else {
                        if (h) {
                            var _ = [], f = g.createComp(c, null, i, _, r);
                            _.length && (f._$bindData = _)
                        } else f = g.createComp(c, null, i, n, r);
                        "Script" == c.type ? f instanceof laya.components.Component ? e._addComponentInstance(f) : "owner" in f ? f.owner = e : "target" in f && (f.target = e) : "mask" == c.props.renderType || "mask" == c.props.name ? e.mask = f : f instanceof laya.display.Node && e.addChild(f)
                    } else e.itemRender = c
                }
                var d = t.props;
                for (var p in d) {
                    var m = d[p];
                    "string" == typeof m && (0 <= m.indexOf("@node:") || 0 <= m.indexOf("@Prefab:")) ? r && r.addNodeRef(e, p, m) : g.setCompValue(e, p, m, i, n)
                }
                return e._afterInited && e._afterInited(), t.compId && r && r._idMap && (r._idMap[t.compId] = e), e
            }, g.setCompValue = function (t, e, i, n, r) {
                if ("string" == typeof i && -1 < i.indexOf("${")) {
                    if (g._sheet || (g._sheet = It.getClass("laya.data.Table")), !g._sheet) return;
                    if (r) r.push(t, e, i); else if (n) {
                        -1 == i.indexOf("].") && (i = i.replace(".", "[0]."));
                        var s, a, o = new _(t, e, i);
                        o.exe(n);
                        for (var h = i.replace(/\[.*?\]\./g, "."); null != (s = g._parseWatchData.exec(h));) {
                            for (var l = s[1]; null != (a = g._parseKeyWord.exec(l));) {
                                var u = a[0], c = n._watchMap[u] || (n._watchMap[u] = []);
                                c.push(o), g._sheet.I.notifer.on(u, n, n.changeData, [u])
                            }
                            (c = n._watchMap[l] || (n._watchMap[l] = [])).push(o), g._sheet.I.notifer.on(l, n, n.changeData, [l])
                        }
                    }
                } else "var" === e && n ? n[i] = t : t[e] = "true" === i || "false" !== i && i
            }, g.getCompInstance = function (t) {
                if ("UIView" == t.type && t.props && t.props.pageData) return g.createByData(null, t.props.pageData);
                var e = t.props && t.props.runtime || t.type, i = It.getClass(e);
                if (!i) throw"Can not find class " + e;
                if ("Script" === t.type && i.prototype._doAwake) {
                    var n = W.createByClass(i);
                    return n._destroyed = !1, n
                }
                return t.props && t.props.hasOwnProperty("renderType") && "instance" == t.props.renderType ? (i.instance || (i.instance = new i), i.instance) : new i
            }, g._sheet = null, a(g, ["_funMap", function () {
                return this._funMap = new At
            }, "_parseWatchData", function () {
                return this._parseWatchData = /\${(.*?)}/g
            }, "_parseKeyWord", function () {
                return this._parseKeyWord = /[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g
            }]), g.__init$ = function () {
                _ = function () {
                    function t(t, e, i) {
                        this.comp = null, this.prop = null, this.value = null, this.comp = t, this.prop = e, this.value = i
                    }

                    return x(t, ""), t.prototype.exe = function (t) {
                        var e = g.getBindFun(this.value);
                        this.comp[this.prop] = e.call(this, t)
                    }, t
                }(), l = function () {
                    function e() {
                        this._nodeRefList = null, this._initList = null, this._loadList = null, this._idMap = null, this._scene = null
                    }

                    x(e, "");
                    var t = e.prototype;
                    return t.reset = function () {
                        this._nodeRefList = null, this._initList = null, this._idMap = null, this._loadList = null, this._scene = null
                    }, t.recover = function () {
                        this.reset(), W.recover("InitTool", this)
                    }, t.addLoadRes = function (t, e) {
                        this._loadList || (this._loadList = []), e ? this._loadList.push({
                            url: t,
                            type: e
                        }) : this._loadList.push(t)
                    }, t.addNodeRef = function (t, e, i) {
                        this._nodeRefList || (this._nodeRefList = []), this._nodeRefList.push([t, e, i]), 0 <= i.indexOf("@Prefab:") && this.addLoadRes(i.replace("@Prefab:", ""), "prefab")
                    }, t.setNodeRef = function () {
                        if (this._nodeRefList) if (this._idMap) {
                            var t, e, i = 0;
                            for (t = this._nodeRefList.length, i = 0; i < t; i++) (e = this._nodeRefList[i])[0][e[1]] = this.getReferData(e[2]);
                            this._nodeRefList = null
                        } else this._nodeRefList = null
                    }, t.getReferData = function (t) {
                        if (0 <= t.indexOf("@Prefab:")) return De.getRes(t.replace("@Prefab:", ""));
                        if (0 <= t.indexOf("@arr:")) {
                            var e, i, n, r = 0;
                            for (i = (e = (t = t.replace("@arr:", "")).split(",")).length, r = 0; r < i; r++) n = e[r], e[r] = n ? this._idMap[n.replace("@node:", "")] : null;
                            return e
                        }
                        return this._idMap[t.replace("@node:", "")]
                    }, t.addInitItem = function (t) {
                        this._initList || (this._initList = []), this._initList.push(t)
                    }, t.doInits = function () {
                        this._initList && (this._initList = null)
                    }, t.finish = function () {
                        this.setNodeRef(), this.doInits(), this._scene._setBit(8, !1), this._scene.parent && this._scene.parent.activeInHierarchy && this._scene.active && this._scene._processActive(), this._scene.event("onViewCreated"), this.recover()
                    }, t.beginLoad = function (t) {
                        this._scene = t, !this._loadList || this._loadList.length < 1 ? this.finish() : y.loader.load(this._loadList, b.create(this, this.finish))
                    }, e.create = function () {
                        var t = W.getItemByClass("InitTool", e);
                        return t._idMap = [], t
                    }, e
                }()
            }, g
        }(), gt = function () {
            function l(t, e, i, n) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), this.x = t, this.y = e, this.width = i, this.height = n
            }

            x(l, "laya.maths.Rectangle");
            var t = l.prototype;
            return t.setTo = function (t, e, i, n) {
                return this.x = t, this.y = e, this.width = i, this.height = n, this
            }, t.reset = function () {
                return this.x = this.y = this.width = this.height = 0, this
            }, t.recover = function () {
                this != l.TEMP && this != l.EMPTY && W.recover("Rectangle", this.reset())
            }, t.copyFrom = function (t) {
                return this.x = t.x, this.y = t.y, this.width = t.width, this.height = t.height, this
            }, t.contains = function (t, e) {
                return !(this.width <= 0 || this.height <= 0) && (t >= this.x && t < this.right && e >= this.y && e < this.bottom)
            }, t.intersects = function (t) {
                return !(t.x > this.x + this.width || t.x + t.width < this.x || t.y > this.y + this.height || t.y + t.height < this.y)
            }, t.intersection = function (t, e) {
                return this.intersects(t) ? (e || (e = new l), e.x = Math.max(this.x, t.x), e.y = Math.max(this.y, t.y), e.width = Math.min(this.right, t.right) - e.x, e.height = Math.min(this.bottom, t.bottom) - e.y, e) : null
            }, t.union = function (t, e) {
                return e || (e = new l), this.clone(e), t.width <= 0 || t.height <= 0 ? e : (e.addPoint(t.x, t.y), e.addPoint(t.right, t.bottom), this)
            }, t.clone = function (t) {
                return t || (t = new l), t.x = this.x, t.y = this.y, t.width = this.width, t.height = this.height, t
            }, t.toString = function () {
                return this.x + "," + this.y + "," + this.width + "," + this.height
            }, t.equals = function (t) {
                return !(!t || t.x !== this.x || t.y !== this.y || t.width !== this.width || t.height !== this.height)
            }, t.addPoint = function (t, e) {
                return this.x > t && (this.width += this.x - t, this.x = t), this.y > e && (this.height += this.y - e, this.y = e), this.width < t - this.x && (this.width = t - this.x), this.height < e - this.y && (this.height = e - this.y), this
            }, t._getBoundPoints = function () {
                var t = l._temB;
                return (t.length = 0) == this.width || 0 == this.height || t.push(this.x, this.y, this.x + this.width, this.y, this.x, this.y + this.height, this.x + this.width, this.y + this.height), t
            }, t.isEmpty = function () {
                return this.width <= 0 || this.height <= 0
            }, d(0, t, "right", function () {
                return this.x + this.width
            }), d(0, t, "bottom", function () {
                return this.y + this.height
            }), l.create = function () {
                return W.getItemByClass("Rectangle", l)
            }, l._getBoundPointS = function (t, e, i, n) {
                var r = l._temA;
                return (r.length = 0) == i || 0 == n || r.push(t, e, t + i, e, t, e + n, t + i, e + n), r
            }, l._getWrapRec = function (t, e) {
                if (!t || t.length < 1) return e ? e.setTo(0, 0, 0, 0) : l.TEMP.setTo(0, 0, 0, 0);
                e = e || laya.maths.Rectangle.create();
                var i, n, r, s, a, o = t.length, h = Ht.TEMP;
                for (r = a = -(n = s = 99999), i = 0; i < o; i += 2) h.x = t[i], h.y = t[i + 1], n = n < h.x ? n : h.x, s = s < h.y ? s : h.y, r = r > h.x ? r : h.x, a = a > h.y ? a : h.y;
                return e.setTo(n, s, r - n, a - s)
            }, l.EMPTY = new l, l.TEMP = new l, l._temB = [], l._temA = [], l
        }(), vt = function () {
            function r() {
            }

            return x(r, "laya.events.KeyBoardManager"), r.__init__ = function () {
                r._addEvent("keydown"), r._addEvent("keypress"), r._addEvent("keyup")
            }, r._addEvent = function (e) {
                Lt.document.addEventListener(e, function (t) {
                    laya.events.KeyBoardManager._dispatch(t, e)
                }, !0)
            }, r._dispatch = function (t, e) {
                if (r.enabled) {
                    r._event._stoped = !1, r._event.nativeEvent = t, r._event.keyCode = t.keyCode || t.which || t.charCode, "keydown" === e ? r._pressKeys[r._event.keyCode] = !0 : "keyup" === e && (r._pressKeys[r._event.keyCode] = null);
                    for (var i = y.stage.focus && null != y.stage.focus.event && y.stage.focus.displayedInStage ? y.stage.focus : y.stage, n = i; n;) n.event(e, r._event.setTo(e, n, i)), n = n.parent
                }
            }, r.hasKeyDown = function (t) {
                return r._pressKeys[t]
            }, r._pressKeys = {}, r.enabled = !0, a(r, ["_event", function () {
                return this._event = new e
            }]), r
        }(), yt = function () {
            function t() {
            }

            return x(t, "laya.layagl.LayaGLRunner"), t.uploadShaderUniforms = function (t, e, i, n) {
                for (var r = i._data, s = e.getArrayData(), a = 0, o = 0, h = s.length; o < h; o++) {
                    var l = s[o];
                    if (n || -1 !== l.textureID) {
                        var u = r[l.dataOffset];
                        null != u && (a += l.fun.call(l.caller, l, u))
                    }
                }
                return a
            }, t.uploadCustomUniform = function (t, e, i, n) {
                var r = 0, s = e[i];
                return s && null != n && (r += s.fun.call(s.caller, s, n)), r
            }, t.uploadShaderUniformsForNative = function (t, e, i) {
                var n = 0;
                0 < i._runtimeCopyValues.length && (n = 1);
                var r = i._data;
                return t.uploadShaderUniforms(e, r, n)
            }, t
        }(), xt = function () {
            function a() {
            }

            x(a, "laya.display.cmd.DrawPathCmd");
            var t = a.prototype;
            return t.recover = function () {
                this.paths = null, this.brush = null, this.pen = null, W.recover("DrawPathCmd", this)
            }, t.run = function (t, e, i) {
                t._drawPath(this.x + e, this.y + i, this.paths, this.brush, this.pen)
            }, d(0, t, "cmdID", function () {
                return "DrawPath"
            }), a.create = function (t, e, i, n, r) {
                var s = W.getItemByClass("DrawPathCmd", a);
                return s.x = t, s.y = e, s.paths = i, s.brush = n, s.pen = r, s
            }, a.ID = "DrawPath", a
        }(), Tt = function () {
            function t() {
                this._nativeVertexArrayObject = null, this._bindedIndexBuffer = null, this._nativeVertexArrayObject = Dt.instance.createVertexArray()
            }

            x(t, "laya.webgl.BufferStateBase");
            var e = t.prototype;
            return e.bind = function () {
                t._curBindedBufferState !== this && (Dt.instance.bindVertexArray(this._nativeVertexArrayObject), t._curBindedBufferState = this)
            }, e.unBind = function () {
                if (t._curBindedBufferState !== this) throw"BufferState: must call bind() function first.";
                Dt.instance.bindVertexArray(null), t._curBindedBufferState = null
            }, e.bindForNative = function () {
                Dt.instance.bindVertexArray(this._nativeVertexArrayObject), t._curBindedBufferState = this
            }, e.unBindForNative = function () {
                Dt.instance.bindVertexArray(null), t._curBindedBufferState = null
            }, e.destroy = function () {
                Dt.instance.deleteVertexArray(this._nativeVertexArrayObject)
            }, t._curBindedBufferState = null, t
        }(), bt = function () {
            function t() {
            }

            x(t, "laya.display.cmd.SaveCmd");
            var e = t.prototype;
            return e.recover = function () {
                W.recover("SaveCmd", this)
            }, e.run = function (t, e, i) {
                t.save()
            }, d(0, e, "cmdID", function () {
                return "Save"
            }), t.create = function () {
                return W.getItemByClass("SaveCmd", t)
            }, t.ID = "Save", t
        }(), wt = function () {
            var t;

            function i() {
            }

            return x(i, "laya.net.LocalStorage"), i.__init__ = function () {
                return i._baseClass || (i._baseClass = t).init(), i.items = i._baseClass.items, i.support = i._baseClass.support
            }, i.setItem = function (t, e) {
                i._baseClass.setItem(t, e)
            }, i.getItem = function (t) {
                return i._baseClass.getItem(t)
            }, i.setJSON = function (t, e) {
                i._baseClass.setJSON(t, e)
            }, i.getJSON = function (t) {
                return i._baseClass.getJSON(t)
            }, i.removeItem = function (t) {
                i._baseClass.removeItem(t)
            }, i.clear = function () {
                i._baseClass.clear()
            }, i._baseClass = null, i.items = null, i.support = !1, i.__init$ = function () {
                t = function () {
                    function i() {
                    }

                    return x(i, ""), i.init = function () {
                        try {
                            i.support = !0, i.items = m.localStorage, i.setItem("laya", "1"), i.removeItem("laya")
                        } catch (t) {
                            i.support = !1
                        }
                    }, i.setItem = function (t, e) {
                        try {
                            i.support && i.items.setItem(t, e)
                        } catch (t) {
                        }
                    }, i.getItem = function (t) {
                        return i.support ? i.items.getItem(t) : null
                    }, i.setJSON = function (t, e) {
                        try {
                            i.support && i.items.setItem(t, JSON.stringify(e))
                        } catch (t) {
                        }
                    }, i.getJSON = function (t) {
                        return JSON.parse(i.support ? i.items.getItem(t) : null)
                    }, i.removeItem = function (t) {
                        i.support && i.items.removeItem(t)
                    }, i.clear = function () {
                        i.support && i.items.clear()
                    }, i.items = null, i.support = !1, i
                }()
            }, i
        }(), Ct = function () {
            function i() {
            }

            return x(i, "laya.webgl.WebGL"), i._uint8ArraySlice = function () {
                for (var t = this.length, e = new Uint8Array(this.length), i = 0; i < t; i++) e[i] = this[i];
                return e
            }, i._float32ArraySlice = function () {
                for (var t = this.length, e = new Float32Array(this.length), i = 0; i < t; i++) e[i] = this[i];
                return e
            }, i._uint16ArraySlice = function (t) {
                var e, i = arguments, n = 0, r = 0;
                if (0 === i.length) for (n = this.length, e = new Uint16Array(n), r = 0; r < n; r++) e[r] = this[r]; else if (2 === i.length) {
                    var s = i[0], a = i[1];
                    if (s < a) for (n = a - s, e = new Uint16Array(n), r = s; r < a; r++) e[r - s] = this[r]; else e = new Uint16Array(0)
                }
                return e
            }, i._nativeRender_enable = function () {
                i.isNativeRender_enable || (i.isNativeRender_enable = !0, rt.__init_native(), ni.prototype.uploadTexture2D = function (t) {
                    var e = rt;
                    e.bindTexture(laya.webgl.WebGL.mainContext, e.TEXTURE_2D, t)
                }, pt.width = Lt.window.innerWidth, pt.height = Lt.window.innerHeight, ce.measureText = function (t, e) {
                    return m.conchTextCanvas.font = e, m.conchTextCanvas.measureText(t)
                }, ce.enableNative = function () {
                    Rt.supportWebGLPlusRendering && (yt.uploadShaderUniforms = yt.uploadShaderUniformsForNative, Ft = m.GLCommandEncoder, Dt = m.LayaGLContext);
                    var t = ai;
                    t.prototype.render = t.prototype.renderToNative
                }, ce.clear = function (t) {
                    ct.set2DRenderConfig();
                    var e = p.create(t).arrColor, i = Dt.instance;
                    e && i.clearColor(e[0], e[1], e[2], e[3]), i.clear(17664), pt.clear()
                }, ce.drawToCanvas = ce.drawToTexture = function (t, e, i, n, r, s) {
                    r -= t.x, s -= t.y, r |= 0, s |= 0, i |= 0, n |= 0;
                    var a = new si(!1), o = a.getContext("2d");
                    return a.size(i, n), o.asBitmap = !0, o._targets.start(), P.renders[e]._fun(t, o, r, s), o.flush(), o._targets.end(), o._targets.restore(), a
                }, fi.prototype._uv = fi.flipyuv, Object.defineProperty(fi.prototype, "uv", {
                    get: function () {
                        return this._uv
                    }, set: function (t) {
                        this._uv = t
                    }
                }), si.prototype.getTexture = function () {
                    return this._texture || (this._texture = this.context._targets, this._texture.uv = fi.flipyuv, this._texture.bitmap = this._texture), this._texture
                })
            }, i.enable = function () {
                return !0
            }, i.inner_enable = function () {
                return Float32Array.prototype.slice || (Float32Array.prototype.slice = i._float32ArraySlice), Uint16Array.prototype.slice || (Uint16Array.prototype.slice = i._uint16ArraySlice), Uint8Array.prototype.slice || (Uint8Array.prototype.slice = i._uint8ArraySlice), Rt.isConchApp && i._nativeRender_enable(), !0
            }, i.onStageResize = function (t, e) {
                null != i.mainContext && (i.mainContext.viewport(0, 0, t, e), pt.width = t, pt.height = e)
            }, i.mainContext = null, i.shaderHighPrecision = !1, i._isWebGL2 = !1, i.isNativeRender_enable = !1, i
        }(), At = function () {
            function n() {
                this._obj = null, this._obj = n.supportWeakMap ? new Lt.window.WeakMap : {}, n.supportWeakMap || n._maps.push(this)
            }

            x(n, "laya.utils.WeakObject");
            var t = n.prototype;
            return t.set = function (t, e) {
                if (null != t) if (n.supportWeakMap) {
                    var i = t;
                    "string" != typeof t && "number" != typeof t || (i = n._keys[t]) || (i = n._keys[t] = {k: t}), this._obj.set(i, e)
                } else "string" == typeof t || "number" == typeof t ? this._obj[t] = e : (t.$_GID || (t.$_GID = ne.getGID()), this._obj[t.$_GID] = e)
            }, t.get = function (t) {
                if (null == t) return null;
                if (n.supportWeakMap) {
                    var e = "string" == typeof t || "number" == typeof t ? n._keys[t] : t;
                    return e ? this._obj.get(e) : null
                }
                return "string" == typeof t || "number" == typeof t ? this._obj[t] : this._obj[t.$_GID]
            }, t.del = function (t) {
                if (null != t) if (n.supportWeakMap) {
                    var e = "string" == typeof t || "number" == typeof t ? n._keys[t] : t;
                    if (!e) return;
                    this._obj.delete(e)
                } else "string" == typeof t || "number" == typeof t ? delete this._obj[t] : delete this._obj[this._obj.$_GID]
            }, t.has = function (t) {
                if (null == t) return !1;
                if (n.supportWeakMap) {
                    var e = "string" == typeof t || "number" == typeof t ? n._keys[t] : t;
                    return this._obj.has(e)
                }
                return "string" == typeof t || "number" == typeof t ? null != this._obj[t] : null != this._obj[this._obj.$_GID]
            }, n.__init__ = function () {
                (n.supportWeakMap = null != Lt.window.WeakMap) || y.systemTimer.loop(n.delInterval, null, n.clearCache)
            }, n.clearCache = function () {
                for (var t = 0, e = n._maps.length; t < e; t++) {
                    n._maps[t]._obj = {}
                }
            }, n.supportWeakMap = !1, n.delInterval = 6e5, n._keys = {}, n._maps = [], a(n, ["I", function () {
                return this.I = new n
            }]), n
        }(), Mt = function () {
            function t() {
            }

            x(t, "laya.display.css.BoundsStyle");
            var e = t.prototype;
            return e.reset = function () {
                return this.bounds && this.bounds.recover(), this.userBounds && this.userBounds.recover(), this.bounds = null, this.userBounds = null, this.temBM = null, this
            }, e.recover = function () {
                W.recover("BoundsStyle", this.reset())
            }, t.create = function () {
                return W.getItemByClass("BoundsStyle", t)
            }, t
        }(), Et = function () {
            function i(t) {
                this._color = null, this.setValue(t)
            }

            x(i, "laya.webgl.canvas.DrawStyle");
            var t = i.prototype;
            return t.setValue = function (t) {
                this._color = t ? t instanceof laya.utils.ColorUtils ? t : p.create(t) : p.create("#000000")
            }, t.reset = function () {
                this._color = p.create("#000000")
            }, t.toInt = function () {
                return this._color.numColor
            }, t.equal = function (t) {
                return "string" == typeof t ? this._color.strColor === t : t instanceof laya.utils.ColorUtils && this._color.numColor === t.numColor
            }, t.toColorStr = function () {
                return this._color.strColor
            }, i.create = function (t) {
                if (t) {
                    var e = t instanceof laya.utils.ColorUtils ? t : p.create(t);
                    return e._drawStyle || (e._drawStyle = new i(t))
                }
                return i.DEFAULT
            }, a(i, ["DEFAULT", function () {
                return this.DEFAULT = new i("#000000")
            }]), i
        }(), St = function () {
            function t() {
            }

            return x(t, "laya.system.System"), t.changeDefinition = function (t, e) {
                y[t] = e;
                var i = t + "=classObj";
                y._runScript(i)
            }, t.__init__ = function () {
            }, t
        }(), Rt = (function () {
            function i() {
            }

            x(i, "laya.display.cmd.DrawParticleCmd");
            var t = i.prototype;
            t.recover = function () {
                this._templ = null, W.recover("DrawParticleCmd", this)
            }, t.run = function (t, e, i) {
                t.drawParticle(e, i, this._templ)
            }, d(0, t, "cmdID", function () {
                return "DrawParticleCmd"
            }), i.create = function (t) {
                var e = W.getItemByClass("DrawParticleCmd", i);
                return e._templ = t, e
            }, i.ID = "DrawParticleCmd"
        }(), function () {
            function i(t, e) {
                this._timeId = 0, i._mainCanvas.source.id = "layaCanvas", i._mainCanvas.source.width = t, i._mainCanvas.source.height = e, laya.renders.Render.isConchApp ? Lt.document.body.appendChild(i._mainCanvas.source) : Lt.onKGMiniGame || Lt.container.appendChild(i._mainCanvas.source), this.initRender(i._mainCanvas, t, e), Lt.window.requestAnimationFrame(function t(e) {
                    y.stage._loop();
                    Lt.window.requestAnimationFrame(t)
                }), y.stage.on("visibilitychange", this, this._onVisibilitychange)
            }

            x(i, "laya.renders.Render");
            var t = i.prototype;
            return t._onVisibilitychange = function () {
                y.stage.isVisibility ? 0 != this._timeId && Lt.window.clearInterval(this._timeId) : this._timeId = Lt.window.setInterval(this._enterFrame, 1e3)
            }, t.initRender = function (t, e, i) {
                var n = Dt.instance = Ct.mainContext = function (t) {
                    var e, i = ["webgl2", "webgl", "experimental-webgl", "webkit-3d", "moz-webgl"];
                    ae.useWebGL2 || i.shift();
                    for (var n = 0; n < i.length; n++) {
                        try {
                            e = t.getContext(i[n], {
                                stencil: ae.isStencil,
                                alpha: ae.isAlpha,
                                antialias: ae.isAntialias,
                                premultipliedAlpha: ae.premultipliedAlpha,
                                preserveDrawingBuffer: ae.preserveDrawingBuffer
                            })
                        } catch (t) {
                        }
                        if (e) return "webgl2" === i[n] && (Ct._isWebGL2 = !0), new Dt, e
                    }
                    return null
                }(laya.renders.Render._mainCanvas.source);
                if (!n) return !1;
                t.size(e, i), rt.__init__(n), ct.__init__(), T.__init__();
                var r = new ct;
                r.isMain = !0, laya.renders.Render._context = r, t._setContext(r), Ct.shaderHighPrecision = !1;
                try {
                    n.getShaderPrecisionFormat(35632, 36338).precision ? Ct.shaderHighPrecision = !0 : Ct.shaderHighPrecision = !1
                } catch (t) {
                }
                return Dt.instance = n, St.__init__(), Re.__init__(), Y.__init__(), O.__init__(), Le.__int__(n), fe._init_(n), !0
            }, t._enterFrame = function (t) {
                y.stage._loop()
            }, d(1, i, "context", function () {
                return i._context
            }), d(1, i, "canvas", function () {
                return i._mainCanvas.source
            }), i._context = null, i._mainCanvas = null, i.supportWebGLPlusCulling = !1, i.supportWebGLPlusAnimation = !1, i.supportWebGLPlusRendering = !1, i.isConchApp = !1, i.is3DMode = !1, i.__init$ = function () {
                (i.isConchApp = null != m.conch) && (i.supportWebGLPlusCulling = !0, i.supportWebGLPlusAnimation = !0, i.supportWebGLPlusRendering = !0)
            }, i
        }()), It = function () {
            function f() {
            }

            return x(f, "laya.utils.ClassUtils"), f.regClass = function (t, e) {
                f._classMap[t] = e
            }, f.regShortClassName = function (t) {
                for (var e = 0; e < t.length; e++) {
                    var i = t[e], n = i.name;
                    f._classMap[n] = i
                }
            }, f.getRegClass = function (t) {
                return f._classMap[t]
            }, f.getClass = function (t) {
                var e = f._classMap[t] || t;
                return "string" == typeof e ? y.__classmap[e] || y[t] : e
            }, f.getInstance = function (t) {
                var e = f.getClass(t);
                return e ? new e : null
            }, f.createByJson = function (t, e, i, n, r) {
                "string" == typeof t && (t = JSON.parse(t));
                var s = t.props;
                if (!e && !(e = r ? r.runWith(t) : f.getInstance(s.runtime || t.type))) return null;
                var a = t.child;
                if (a) for (var o = 0, h = a.length; o < h; o++) {
                    var l = a[o];
                    if ("render" !== l.props.name && "render" !== l.props.renderType || !e._$set_itemRender) if ("Graphic" == l.type) f._addGraphicsToSprite(l, e); else if (f._isDrawType(l.type)) f._addGraphicToSprite(l, e, !0); else {
                        var u = f.createByJson(l, null, i, n, r);
                        "Script" === l.type ? u.hasOwnProperty("owner") ? u.owner = e : u.hasOwnProperty("target") && (u.target = e) : "mask" == l.props.renderType ? e.mask = u : e.addChild(u)
                    } else e.itemRender = l
                }
                if (s) for (var c in s) {
                    var _ = s[c];
                    "var" === c && i ? i[_] = e : _ instanceof Array && "function" == typeof e[c] ? e[c].apply(e, _) : e[c] = _
                }
                return n && t.customProps && n.runWith([e, t]), e.created && e.created(), e
            }, f._addGraphicsToSprite = function (t, e) {
                var i = t.child;
                if (i && !(i.length < 1)) {
                    var n = f._getGraphicsFromSprite(t, e), r = 0, s = 0;
                    t.props && (r = f._getObjVar(t.props, "x", 0), s = f._getObjVar(t.props, "y", 0)), 0 != r && 0 != s && n.translate(r, s);
                    var a, o = 0;
                    for (a = i.length, o = 0; o < a; o++) f._addGraphicToGraphics(i[o], n);
                    0 != r && 0 != s && n.translate(-r, -s)
                }
            }, f._addGraphicToSprite = function (t, e, i) {
                void 0 === i && (i = !1);
                var n = i ? f._getGraphicsFromSprite(t, e) : e.graphics;
                f._addGraphicToGraphics(t, n)
            }, f._getGraphicsFromSprite = function (t, e) {
                if (!t || !t.props) return e.graphics;
                var i = t.props.renderType;
                if ("hit" === i || "unHit" === i) {
                    var n = e._style.hitArea || (e.hitArea = new ye);
                    n[i] || (n[i] = new qt);
                    var r = n[i]
                }
                return r || (r = e.graphics), r
            }, f._getTransformData = function (t) {
                var e;
                (t.hasOwnProperty("pivotX") || t.hasOwnProperty("pivotY")) && (e = e || new at).translate(-f._getObjVar(t, "pivotX", 0), -f._getObjVar(t, "pivotY", 0));
                var i = f._getObjVar(t, "scaleX", 1), n = f._getObjVar(t, "scaleY", 1),
                    r = f._getObjVar(t, "rotation", 0);
                f._getObjVar(t, "skewX", 0), f._getObjVar(t, "skewY", 0);
                return 1 == i && 1 == n && 0 == r || ((e = e || new at).scale(i, n), e.rotate(.0174532922222222 * r)), e
            }, f._addGraphicToGraphics = function (t, e) {
                var i, n;
                if ((i = t.props) && (n = f.DrawTypeDic[t.type])) {
                    var r = e, s = f._getParams(i, n[1], n[2], n[3]), a = f._tM;
                    (a || 1 != f._alpha) && (r.save(), a && r.transform(a), 1 != f._alpha && r.alpha(f._alpha)), r[n[0]].apply(r, s), (a || 1 != f._alpha) && r.restore()
                }
            }, f._adptLineData = function (t) {
                return t[2] = parseFloat(t[0]) + parseFloat(t[2]), t[3] = parseFloat(t[1]) + parseFloat(t[3]), t
            }, f._adptTextureData = function (t) {
                return t[0] = De.getRes(t[0]), t
            }, f._adptLinesData = function (t) {
                return t[2] = f._getPointListByStr(t[2]), t
            }, f._isDrawType = function (t) {
                return "Image" !== t && f.DrawTypeDic.hasOwnProperty(t)
            }, f._getParams = function (t, e, i, n) {
                void 0 === i && (i = 0);
                var r = f._temParam;
                r.length = e.length;
                var s, a, o = 0;
                for (s = e.length, o = 0; o < s; o++) r[o] = f._getObjVar(t, e[o][0], e[o][1]);
                return f._alpha = f._getObjVar(t, "alpha", 1), a = f._getTransformData(t), f._tM = a ? (i || (i = 0), a.translate(r[i], r[i + 1]), r[i] = r[i + 1] = 0, a) : null, n && f[n] && (r = f[n](r)), r
            }, f._getPointListByStr = function (t) {
                var e, i = t.split(","), n = 0;
                for (e = i.length, n = 0; n < e; n++) i[n] = parseFloat(i[n]);
                return i
            }, f._getObjVar = function (t, e, i) {
                return t.hasOwnProperty(e) ? t[e] : i
            }, f._temParam = [], f._classMap = {
                Sprite: je,
                Scene: hi,
                Text: ei,
                Animation: "laya.display.Animation",
                Skeleton: "laya.ani.bone.Skeleton",
                Particle2D: "laya.particle.Particle2D",
                div: "laya.html.dom.HTMLDivParser",
                p: "laya.html.dom.HTMLElement",
                img: "laya.html.dom.HTMLImageElement",
                span: "laya.html.dom.HTMLElement",
                br: "laya.html.dom.HTMLBrElement",
                style: "laya.html.dom.HTMLStyleElement",
                font: "laya.html.dom.HTMLElement",
                a: "laya.html.dom.HTMLElement",
                "#text": "laya.html.dom.HTMLElement",
                link: "laya.html.dom.HTMLLinkElement"
            }, f._tM = null, f._alpha = NaN, a(f, ["DrawTypeDic", function () {
                return this.DrawTypeDic = {
                    Rect: ["drawRect", [["x", 0], ["y", 0], ["width", 0], ["height", 0], ["fillColor", null], ["lineColor", null], ["lineWidth", 1]]],
                    Circle: ["drawCircle", [["x", 0], ["y", 0], ["radius", 0], ["fillColor", null], ["lineColor", null], ["lineWidth", 1]]],
                    Pie: ["drawPie", [["x", 0], ["y", 0], ["radius", 0], ["startAngle", 0], ["endAngle", 0], ["fillColor", null], ["lineColor", null], ["lineWidth", 1]]],
                    Image: ["drawTexture", [["x", 0], ["y", 0], ["width", 0], ["height", 0]]],
                    Texture: ["drawTexture", [["skin", null], ["x", 0], ["y", 0], ["width", 0], ["height", 0]], 1, "_adptTextureData"],
                    FillTexture: ["fillTexture", [["skin", null], ["x", 0], ["y", 0], ["width", 0], ["height", 0], ["repeat", null]], 1, "_adptTextureData"],
                    FillText: ["fillText", [["text", ""], ["x", 0], ["y", 0], ["font", null], ["color", null], ["textAlign", null]], 1],
                    Line: ["drawLine", [["x", 0], ["y", 0], ["toX", 0], ["toY", 0], ["lineColor", null], ["lineWidth", 0]], 0, "_adptLineData"],
                    Lines: ["drawLines", [["x", 0], ["y", 0], ["points", ""], ["lineColor", null], ["lineWidth", 0]], 0, "_adptLinesData"],
                    Curves: ["drawCurves", [["x", 0], ["y", 0], ["points", ""], ["lineColor", null], ["lineWidth", 0]], 0, "_adptLinesData"],
                    Poly: ["drawPoly", [["x", 0], ["y", 0], ["points", ""], ["fillColor", null], ["lineColor", null], ["lineWidth", 1]], 0, "_adptLinesData"]
                }
            }]), f
        }(), Pt = function () {
            function v() {
                this._cacheBoundsType = !1
            }

            x(v, "laya.display.GraphicsBounds");
            var t = v.prototype;
            return t.destroy = function () {
                this._graphics = null, this._cacheBoundsType = !1, this._temp && (this._temp.length = 0), this._rstBoundPoints && (this._rstBoundPoints.length = 0), this._bounds && this._bounds.recover(), this._bounds = null, W.recover("GraphicsBounds", this)
            }, t.reset = function () {
                this._temp && (this._temp.length = 0)
            }, t.getBounds = function (t) {
                return void 0 === t && (t = !1), (!this._bounds || !this._temp || this._temp.length < 1 || t != this._cacheBoundsType) && (this._bounds = gt._getWrapRec(this.getBoundPoints(t), this._bounds)), this._cacheBoundsType = t, this._bounds
            }, t.getBoundPoints = function (t) {
                return void 0 === t && (t = !1), (!this._temp || this._temp.length < 1 || t != this._cacheBoundsType) && (this._temp = this._getCmdPoints(t)), this._cacheBoundsType = t, this._rstBoundPoints = ne.copyArray(this._rstBoundPoints, this._temp)
            }, t._getCmdPoints = function (t) {
                void 0 === t && (t = !1);
                Rt._context;
                var e, i = this._graphics.cmds;
                if ((e = this._temp || (this._temp = [])).length = 0, i || null == this._graphics._one || (v._tempCmds.length = 0, v._tempCmds.push(this._graphics._one), i = v._tempCmds), !i) return e;
                var n = v._tempMatrixArrays;
                n.length = 0;
                var r = v._initMatrix;
                r.identity();
                for (var s, a, o = v._tempMatrix, h = 0, l = i.length; h < l; h++) switch ((s = i[h]).cmdID) {
                    case"Alpha":
                        n.push(r), r = r.clone();
                        break;
                    case"Restore":
                        r = n.pop();
                        break;
                    case"Scale":
                        o.identity(), o.translate(-s.pivotX, -s.pivotY), o.scale(s.scaleX, s.scaleY), o.translate(s.pivotX, s.pivotY), this._switchMatrix(r, o);
                        break;
                    case"Rotate":
                        o.identity(), o.translate(-s.pivotX, -s.pivotY), o.rotate(s.angle), o.translate(s.pivotX, s.pivotY), this._switchMatrix(r, o);
                        break;
                    case"Translate":
                        o.identity(), o.translate(s.tx, s.ty), this._switchMatrix(r, o);
                        break;
                    case"Transform":
                        o.identity(), o.translate(-s.pivotX, -s.pivotY), o.concat(s.matrix), o.translate(s.pivotX, s.pivotY), this._switchMatrix(r, o);
                        break;
                    case"DrawImage":
                    case"FillTexture":
                        v._addPointArrToRst(e, gt._getBoundPointS(s.x, s.y, s.width, s.height), r);
                        break;
                    case"DrawTexture":
                        r.copyTo(o), s.matrix && o.concat(s.matrix), v._addPointArrToRst(e, gt._getBoundPointS(s.x, s.y, s.width, s.height), o);
                        break;
                    case"DrawImage":
                        if (a = s.texture, t) s.width && s.height ? v._addPointArrToRst(e, gt._getBoundPointS(s.x, s.y, s.width, s.height), r) : v._addPointArrToRst(e, gt._getBoundPointS(s.x, s.y, a.width, a.height), r); else {
                            var u = (s.width || a.sourceWidth) / a.width, c = (s.height || a.sourceHeight) / a.height,
                                _ = u * a.sourceWidth, f = c * a.sourceHeight, d = 0 < a.offsetX ? a.offsetX : 0,
                                p = 0 < a.offsetY ? a.offsetY : 0;
                            d *= u, p *= c, v._addPointArrToRst(e, gt._getBoundPointS(s.x - d, s.y - p, _, f), r)
                        }
                        break;
                    case"FillTexture":
                        s.width && s.height ? v._addPointArrToRst(e, gt._getBoundPointS(s.x, s.y, s.width, s.height), r) : (a = s.texture, v._addPointArrToRst(e, gt._getBoundPointS(s.x, s.y, a.width, a.height), r));
                        break;
                    case"DrawTexture":
                        var m;
                        m = s.matrix ? (r.copyTo(o), o.concat(s.matrix), o) : r, t ? s.width && s.height ? v._addPointArrToRst(e, gt._getBoundPointS(s.x, s.y, s.width, s.height), m) : (a = s.texture, v._addPointArrToRst(e, gt._getBoundPointS(s.x, s.y, a.width, a.height), m)) : (a = s.texture, u = (s.width || a.sourceWidth) / a.width, c = (s.height || a.sourceHeight) / a.height, _ = u * a.sourceWidth, f = c * a.sourceHeight, d = 0 < a.offsetX ? a.offsetX : 0, p = 0 < a.offsetY ? a.offsetY : 0, d *= u, p *= c, v._addPointArrToRst(e, gt._getBoundPointS(s.x - d, s.y - p, _, f), m));
                        break;
                    case"DrawRect":
                        v._addPointArrToRst(e, gt._getBoundPointS(s.x, s.y, s.width, s.height), r);
                        break;
                    case"DrawCircle":
                        v._addPointArrToRst(e, gt._getBoundPointS(s.x - s.radius, s.y - s.radius, s.radius + s.radius, s.radius + s.radius), r);
                        break;
                    case"DrawLine":
                        v._tempPoints.length = 0;
                        var g;
                        g = .5 * s.lineWidth, s.fromX == s.toX ? v._tempPoints.push(s.fromX + g, s.fromY, s.toX + g, s.toY, s.fromX - g, s.fromY, s.toX - g, s.toY) : s.fromY == s.toY ? v._tempPoints.push(s.fromX, s.fromY + g, s.toX, s.toY + g, s.fromX, s.fromY - g, s.toX, s.toY - g) : v._tempPoints.push(s.fromX, s.fromY, s.toX, s.toY), v._addPointArrToRst(e, v._tempPoints, r);
                        break;
                    case"DrawCurves":
                        v._addPointArrToRst(e, Nt.I.getBezierPoints(s.points), r, s.x, s.y);
                        break;
                    case"DrawLines":
                    case"DrawPoly":
                        v._addPointArrToRst(e, s.points, r, s.x, s.y);
                        break;
                    case"DrawPath":
                        v._addPointArrToRst(e, this._getPathPoints(s.paths), r, s.x, s.y);
                        break;
                    case"DrawPie":
                        v._addPointArrToRst(e, this._getPiePoints(s.x, s.y, s.radius, s.startAngle, s.endAngle), r)
                }
                return 200 < e.length ? e = ne.copyArray(e, gt._getWrapRec(e)._getBoundPoints()) : 8 < e.length && (e = H.scanPList(e)), e
            }, t._switchMatrix = function (t, e) {
                e.concat(t), e.copyTo(t)
            }, t._getPiePoints = function (t, e, i, n, r) {
                var s = v._tempPoints;
                v._tempPoints.length = 0;
                var a = Math.PI / 180, o = r - n;
                if (360 <= o || o <= -360) return s.push(t - i, e - i), s.push(t + i, e - i), s.push(t + i, e + i), s.push(t - i, e + i), s;
                s.push(t, e);
                var h = o % 360;
                h < 0 && (h += 360);
                var l = n + h, u = n * a, c = l * a;
                s.push(t + i * Math.cos(u), e + i * Math.sin(u)), s.push(t + i * Math.cos(c), e + i * Math.sin(c));
                for (var _ = 90 * Math.ceil(n / 90), f = 90 * Math.floor(l / 90), d = _; d <= f; d += 90) {
                    var p = d * a;
                    s.push(t + i * Math.cos(p), e + i * Math.sin(p))
                }
                return s
            }, t._getPathPoints = function (t) {
                var e, i, n = 0, r = v._tempPoints;
                for (r.length = 0, e = t.length, n = 0; n < e; n++) 1 < (i = t[n]).length && (r.push(i[1], i[2]), 3 < i.length && r.push(i[3], i[4]));
                return r
            }, v.create = function () {
                return W.getItemByClass("GraphicsBounds", v)
            }, v._addPointArrToRst = function (t, e, i, n, r) {
                void 0 === n && (n = 0), void 0 === r && (r = 0);
                var s, a = 0;
                for (s = e.length, a = 0; a < s; a += 2) v._addPointToRst(t, e[a] + n, e[a + 1] + r, i)
            }, v._addPointToRst = function (t, e, i, n) {
                var r = Ht.TEMP;
                r.setTo(e || 0, i || 0), n.transformPoint(r), t.push(r.x, r.y)
            }, v._tempPoints = [], v._tempMatrixArrays = [], v._tempCmds = [], a(v, ["_tempMatrix", function () {
                return this._tempMatrix = new at
            }, "_initMatrix", function () {
                return this._initMatrix = new at
            }]), v
        }(), Dt = function () {
            function t() {
            }

            x(t, "laya.layagl.LayaGL");
            var e = t.prototype;
            return e.createCommandEncoder = function (t, e, i) {
                return void 0 === t && (t = 128), void 0 === e && (e = 64), void 0 === i && (i = !1), new Ft(this, t, e, i)
            }, e.beginCommandEncoding = function (t) {
            }, e.endCommandEncoding = function () {
            }, e.matrix4x4Multiply = function (t, e, i) {
            }, e.evaluateClipDatasRealTime = function (t, e, i, n) {
            }, t.getFrameCount = function () {
                return 0
            }, t.syncBufferToRenderThread = function (t, e) {
                void 0 === e && (e = 0)
            }, t.createArrayBufferRef = function (t, e, i) {
            }, t.createArrayBufferRefs = function (t, e, i, n) {
            }, t.EXECUTE_JS_THREAD_BUFFER = 0, t.EXECUTE_RENDER_THREAD_BUFFER = 1, t.EXECUTE_COPY_TO_RENDER = 2, t.EXECUTE_COPY_TO_RENDER3D = 3, t.ARRAY_BUFFER_TYPE_DATA = 0, t.ARRAY_BUFFER_TYPE_CMD = 1, t.ARRAY_BUFFER_REF_REFERENCE = 0, t.ARRAY_BUFFER_REF_COPY = 1, t.UPLOAD_SHADER_UNIFORM_TYPE_ID = 0, t.UPLOAD_SHADER_UNIFORM_TYPE_DATA = 1, t.instance = null, t
        }(), Lt = function () {
            function p() {
            }

            return x(p, "laya.utils.Browser"), d(1, p, "pixelRatio", function () {
                if (p._pixelRatio < 0) if (p.__init__(), -1 < p.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")) p._pixelRatio = 2; else {
                    var t = p.context,
                        e = t.backingStorePixelRatio || t.webkitBackingStorePixelRatio || t.mozBackingStorePixelRatio || t.msBackingStorePixelRatio || t.oBackingStorePixelRatio || t.backingStorePixelRatio || 1;
                    (p._pixelRatio = (p._window.devicePixelRatio || 1) / e) < 1 && (p._pixelRatio = 1)
                }
                return p._pixelRatio
            }), d(1, p, "height", function () {
                return p.__init__(), (y.stage && y.stage.canvasRotation ? p.clientWidth : p.clientHeight) * p.pixelRatio
            }), d(1, p, "clientWidth", function () {
                return p.__init__(), p._window.innerWidth || p._document.body.clientWidth
            }), d(1, p, "window", function () {
                return p._window || p.__init__()
            }), d(1, p, "clientHeight", function () {
                return p.__init__(), p._window.innerHeight || p._document.body.clientHeight || p._document.documentElement.clientHeight
            }), d(1, p, "width", function () {
                return p.__init__(), (y.stage && y.stage.canvasRotation ? p.clientHeight : p.clientWidth) * p.pixelRatio
            }), d(1, p, "container", function () {
                return p._container || (p.__init__(), (p._container = p.createElement("div")).id = "layaContainer", p._document.body.appendChild(p._container)), p._container
            }, function (t) {
                p._container = t
            }), d(1, p, "document", function () {
                return p.__init__(), p._document
            }), p.__init__ = function () {
                if (p._window) return p._window;
                var e = p._window = m, t = p._document = e.document, i = p.userAgent = e.navigator.userAgent,
                    n = e._layalibs;
                if (n) {
                    n.sort(function (t, e) {
                        return t.i - e.i
                    });
                    for (var r = 0; r < n.length; r++) n[r].f(e, t, y)
                }
                -1 < i.indexOf("MiniGame") && p.window.hasOwnProperty("wx") && (laya.utils.Browser.window.hasOwnProperty("bl") ? y.BLMiniAdapter && y.BLMiniAdapter.enable() : laya.utils.Browser.window.hasOwnProperty("qq") ? y.QQMiniAdapter && y.QQMiniAdapter.enable() : y.MiniAdpter && y.MiniAdpter.enable()), -1 < i.indexOf("SwanGame") && y.BMiniAdapter && y.BMiniAdapter.enable(), "function" == typeof getApp && y.KGMiniAdapter && y.KGMiniAdapter.enable(), -1 < i.indexOf("OPPO") && -1 < i.indexOf("MiniGame") && y.QGMiniAdapter && y.QGMiniAdapter.enable(), -1 < i.indexOf("VVGame") && y.VVMiniAdapter && y.VVMiniAdapter.enable(), -1 < i.indexOf("AlipayMiniGame") && y.ALIMiniAdapter && y.ALIMiniAdapter.enable(), e.trace = console.log, e.requestAnimationFrame = e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || function (t) {
                    return e.setTimeout(t, 1e3 / 60)
                };
                var s = t.body.style;
                s.margin = 0, s.overflow = "hidden", s["-webkit-user-select"] = "none", s["-webkit-tap-highlight-color"] = "rgba(200,200,200,0)";
                for (var a = t.getElementsByTagName("meta"), o = 0, h = !1, l = "width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"; o < a.length;) {
                    var u = a[o];
                    if ("viewport" == u.name) {
                        u.content = l, h = !0;
                        break
                    }
                    o++
                }
                h || ((u = t.createElement("meta")).name = "viewport", u.content = l, t.getElementsByTagName("head")[0].appendChild(u)), p.onMobile = !!m.isConchApp || -1 < i.indexOf("Mobile"), p.onIOS = !!i.match(/\(i[^;]+;(U;)? CPU.+Mac OS X/), p.onIPhone = -1 < i.indexOf("iPhone"), p.onMac = -1 < i.indexOf("Mac OS X"), p.onIPad = -1 < i.indexOf("iPad"), p.onAndroid = -1 < i.indexOf("Android") || -1 < i.indexOf("Adr"), p.onWP = -1 < i.indexOf("Windows Phone"), p.onQQBrowser = -1 < i.indexOf("QQBrowser"), p.onMQQBrowser = -1 < i.indexOf("MQQBrowser") || -1 < i.indexOf("Mobile") && -1 < i.indexOf("QQ"), p.onIE = !!e.ActiveXObject || "ActiveXObject" in e, p.onWeiXin = -1 < i.indexOf("MicroMessenger"), p.onSafari = -1 < i.indexOf("Safari"), p.onPC = !p.onMobile, p.onMiniGame = -1 < i.indexOf("MiniGame"), p.onBDMiniGame = -1 < i.indexOf("SwanGame"), -1 < i.indexOf("OPPO") && -1 < i.indexOf("MiniGame") ? (p.onQGMiniGame = !0, p.onMiniGame = !1) : laya.utils.Browser.window.hasOwnProperty("bl") && -1 < i.indexOf("MiniGame") ? (p.onBLMiniGame = !0, p.onMiniGame = !1) : laya.utils.Browser.window.hasOwnProperty("qq") && -1 < i.indexOf("MiniGame") && (p.onQQMiniGame = !0, p.onMiniGame = !1), p.onVVMiniGame = -1 < i.indexOf("VVGame"), p.onLimixiu = -1 < i.indexOf("limixiu"), p.onKGMiniGame = -1 < i.indexOf("QuickGame"), -1 < i.indexOf("AlipayMiniGame") && (p.onAlipayMiniGame = !0, p.onMiniGame = !1), p.supportLocalStorage = wt.__init__(), p.supportWebAudio = xe.__init__(), Rt._mainCanvas = new si(!0);
                var c = Rt._mainCanvas.source.style;
                c.position = "absolute", c.top = c.left = "0px", c.background = "#000000", p.canvas = new si(!0), p.context = p.canvas.getContext("2d");
                var _ = new si(!0);
                (laya.utils.Browser.onQGMiniGame || laya.utils.Browser.onVVMiniGame) && (_ = Rt._mainCanvas);
                var f = ["webgl", "experimental-webgl", "webkit-3d", "moz-webgl"], d = null;
                for (o = 0; o < f.length; o++) {
                    try {
                        d = _.source.getContext(f[o])
                    } catch (t) {
                    }
                    if (d) {
                        p._supportWebGL = !0;
                        break
                    }
                }
                return e
            }, p.createElement = function (t) {
                return p.__init__(), p._document.createElement(t)
            }, p.getElementById = function (t) {
                return p.__init__(), p._document.getElementById(t)
            }, p.removeElement = function (t) {
                t && t.parentNode && t.parentNode.removeChild(t)
            }, p.now = function () {
                return Date.now()
            }, p.userAgent = null, p.onMobile = !1, p.onIOS = !1, p.onMac = !1, p.onIPhone = !1, p.onIPad = !1, p.onAndroid = !1, p.onWP = !1, p.onQQBrowser = !1, p.onMQQBrowser = !1, p.onSafari = !1, p.onIE = !1, p.onWeiXin = !1, p.onPC = !1, p.onMiniGame = !1, p.onBDMiniGame = !1, p.onVVMiniGame = !1, p.onKGMiniGame = !1, p.onQGMiniGame = !1, p.onBLMiniGame = !1, p.onAlipayMiniGame = !1, p.onQQMiniGame = !1, p.onLimixiu = !1, p.onFirefox = !1, p.onEdge = !1, p.supportWebAudio = !1, p.supportLocalStorage = !1, p.canvas = null, p.context = null, p._window = null, p._document = null, p._container = null, p._pixelRatio = -1, p._supportWebGL = !1, p
        }(), Bt = function () {
            function s() {
                this._matrix = new at
            }

            x(s, "laya.webgl.canvas.save.SaveTransform");
            var t = s.prototype;
            return y.imps(t, {"laya.webgl.canvas.save.ISaveData": !0}), t.isSaveMark = function () {
                return !1
            }, t.restore = function (t) {
                t._curMat = this._savematrix, s.POOL[s.POOL._length++] = this
            }, s.save = function (t) {
                var e = t._saveMark;
                if (2048 != (2048 & e._saveuse)) {
                    e._saveuse |= 2048;
                    var i = s.POOL, n = 0 < i._length ? i[--i._length] : new s;
                    n._savematrix = t._curMat, t._curMat = t._curMat.copyTo(n._matrix);
                    var r = t._save;
                    r[r._length++] = n
                }
            }, s.POOL = o._createArray(), s
        }(), Ft = function () {
            function t(t, e, i, n) {
                this._idata = []
            }

            x(t, "laya.layagl.CommandEncoder");
            var e = t.prototype;
            return e.getArrayData = function () {
                return this._idata
            }, e.getPtrID = function () {
                return 0
            }, e.beginEncoding = function () {
            }, e.endEncoding = function () {
            }, e.clearEncoding = function () {
                this._idata.length = 0
            }, e.getCount = function () {
                return this._idata.length
            }, e.add_ShaderValue = function (t) {
                this._idata.push(t)
            }, e.addShaderUniform = function (t) {
                this.add_ShaderValue(t)
            }, t
        }(), Ot = function () {
            function l() {
            }

            x(l, "laya.display.cmd.FillBorderTextCmd");
            var t = l.prototype;
            return t.recover = function () {
                W.recover("FillBorderTextCmd", this)
            }, t.run = function (t, e, i) {
                t.fillBorderText(this.text, this.x + e, this.y + i, this.font, this.fillColor, this.borderColor, this.lineWidth, this.textAlign)
            }, d(0, t, "cmdID", function () {
                return "FillBorderText"
            }), l.create = function (t, e, i, n, r, s, a, o) {
                var h = W.getItemByClass("FillBorderTextCmd", l);
                return h.text = t, h.x = e, h.y = i, h.font = n, h.fillColor = r, h.borderColor = s, h.lineWidth = a, h.textAlign = o, h
            }, l.ID = "FillBorderText", l
        }(), Nt = function () {
            function t() {
                this._controlPoints = [new Ht, new Ht, new Ht], this._calFun = this.getPoint2
            }

            x(t, "laya.maths.Bezier");
            var e = t.prototype;
            return e._switchPoint = function (t, e) {
                var i = this._controlPoints.shift();
                i.setTo(t, e), this._controlPoints.push(i)
            }, e.getPoint2 = function (t, e) {
                var i = this._controlPoints[0], n = this._controlPoints[1], r = this._controlPoints[2],
                    s = Math.pow(1 - t, 2) * i.x + 2 * t * (1 - t) * n.x + Math.pow(t, 2) * r.x,
                    a = Math.pow(1 - t, 2) * i.y + 2 * t * (1 - t) * n.y + Math.pow(t, 2) * r.y;
                e.push(s, a)
            }, e.getPoint3 = function (t, e) {
                var i = this._controlPoints[0], n = this._controlPoints[1], r = this._controlPoints[2],
                    s = this._controlPoints[3],
                    a = Math.pow(1 - t, 3) * i.x + 3 * n.x * t * (1 - t) * (1 - t) + 3 * r.x * t * t * (1 - t) + s.x * Math.pow(t, 3),
                    o = Math.pow(1 - t, 3) * i.y + 3 * n.y * t * (1 - t) * (1 - t) + 3 * r.y * t * t * (1 - t) + s.y * Math.pow(t, 3);
                e.push(a, o)
            }, e.insertPoints = function (t, e) {
                var i, n = NaN;
                for (i = 1 / (t = 0 < t ? t : 5), n = 0; n <= 1; n += i) this._calFun(n, e)
            }, e.getBezierPoints = function (t, e, i) {
                void 0 === e && (e = 5), void 0 === i && (i = 2);
                var n, r = 0;
                if ((n = t.length) < 2 * (i + 1)) return [];
                var s = [];
                switch (i) {
                    case 2:
                        this._calFun = this.getPoint2;
                        break;
                    case 3:
                        this._calFun = this.getPoint3;
                        break;
                    default:
                        return []
                }
                for (; this._controlPoints.length <= i;) this._controlPoints.push(Ht.create());
                for (r = 0; r < 2 * i; r += 2) this._switchPoint(t[r], t[r + 1]);
                for (r = 2 * i; r < n; r += 2) this._switchPoint(t[r], t[r + 1]), r / 2 % i == 0 && this.insertPoints(e, s);
                return s
            }, a(t, ["I", function () {
                return this.I = new t
            }]), t
        }(), kt = function () {
            function o() {
            }

            x(o, "laya.display.cmd.Draw9GridTexture");
            var t = o.prototype;
            return t.recover = function () {
                this.texture._removeReference(), W.recover("Draw9GridTexture", this)
            }, t.run = function (t, e, i) {
                t.drawTextureWithSizeGrid(this.texture, this.x, this.y, this.width, this.height, this.sizeGrid, e, i)
            }, d(0, t, "cmdID", function () {
                return "Draw9GridTexture"
            }), o.create = function (t, e, i, n, r, s) {
                var a = W.getItemByClass("Draw9GridTexture", o);
                return (a.texture = t)._addReference(), a.x = e, a.y = i, a.width = n, a.height = r, a.sizeGrid = s, a
            }, o.ID = "Draw9GridTexture", o
        }(), Ut = function () {
            function r() {
                this.texWidth = 1024, this.texHeight = 1024, this.atlasgrid = null, this.protectDist = 1, this.texture = null, this.charMaps = {}, this.texHeight = this.texWidth = A.atlasWidth, this.texture = Qe.getTextTexture(this.texWidth, this.texHeight), 256 < this.texWidth / r.atlasGridW && (r.atlasGridW = Math.ceil(this.texWidth / 256)), this.atlasgrid = new Zt(this.texWidth / r.atlasGridW, this.texHeight / r.atlasGridW, this.texture.id)
            }

            x(r, "laya.webgl.text.TextAtlas");
            var t = r.prototype;
            return t.setProtecteDist = function (t) {
                this.protectDist = t
            }, t.getAEmpty = function (t, e, i) {
                var n = this.atlasgrid.addRect(1, Math.ceil(t / r.atlasGridW), Math.ceil(e / r.atlasGridW), i);
                return n && (i.x *= r.atlasGridW, i.y *= r.atlasGridW), n
            }, t.destroy = function () {
                for (var t in this.charMaps) {
                    this.charMaps[t].deleted = !0
                }
                this.texture.discard()
            }, t.printDebugInfo = function () {
            }, d(0, t, "usedRate", function () {
                return this.atlasgrid._used
            }), r.atlasGridW = 16, r
        }(), Wt = function () {
            function t() {
                this._strsToID = {}, this._idToStrs = [], this._length = 0
            }

            x(t, "laya.utils.StringKey");
            var e = t.prototype;
            return e.add = function (t) {
                var e = this._strsToID[t];
                return null != e ? e : (this._idToStrs[this._length] = t, this._strsToID[t] = this._length++)
            }, e.getID = function (t) {
                var e = this._strsToID[t];
                return null == e ? -1 : e
            }, e.getName = function (t) {
                var e = this._idToStrs[t];
                return null == e ? void 0 : e
            }, t
        }(), Gt = function () {
            function t() {
                this.ratio = .92, this.maxOffset = 60, this._dragging = !1, this._clickOnly = !0
            }

            x(t, "laya.utils.Dragging");
            var e = t.prototype;
            return e.start = function (t, e, i, n, r, s, a, o) {
                void 0 === o && (o = .92), this.clearTimer(), this.target = t, this.area = e, this.hasInertia = i, this.elasticDistance = e ? n : 0, this.elasticBackTime = r, this.data = s, this._disableMouseEvent = a, this.ratio = o, this._parent = t.parent, this._clickOnly = !0, this._dragging = !0, this._elasticRateX = this._elasticRateY = 1, this._lastX = this._parent.mouseX, this._lastY = this._parent.mouseY, y.stage.on("mouseup", this, this.onStageMouseUp), y.stage.on("mouseout", this, this.onStageMouseUp), y.systemTimer.frameLoop(1, this, this.loop)
            }, e.clearTimer = function () {
                y.systemTimer.clear(this, this.loop), y.systemTimer.clear(this, this.tweenMove), this._tween && (this._tween.recover(), this._tween = null)
            }, e.stop = function () {
                this._dragging && (R.instance.disableMouseEvent = !1, y.stage.off("mouseup", this, this.onStageMouseUp), y.stage.off("mouseout", this, this.onStageMouseUp), this._dragging = !1, this.target && this.area && this.backToArea(), this.clear())
            }, e.loop = function () {
                var t = this._parent.getMousePoint(), e = t.x, i = t.y, n = e - this._lastX, r = i - this._lastY;
                if (this._clickOnly) {
                    if (!(1 < Math.abs(n * y.stage._canvasTransform.getScaleX()) || 1 < Math.abs(r * y.stage._canvasTransform.getScaleY()))) return;
                    this._clickOnly = !1, this._offsets || (this._offsets = []), this._offsets.length = 0, this.target.event("dragstart", this.data), R.instance.disableMouseEvent = this._disableMouseEvent
                } else this._offsets.push(n, r);
                0 === n && 0 === r || (this._lastX = e, this._lastY = i, this.target.x += n * this._elasticRateX, this.target.y += r * this._elasticRateY, this.area && this.checkArea(), this.target.event("dragmove", this.data))
            }, e.checkArea = function () {
                if (this.elasticDistance <= 0) this.backToArea(); else {
                    if (this.target._x < this.area.x) var t = this.area.x - this.target._x; else t = this.target._x > this.area.x + this.area.width ? this.target._x - this.area.x - this.area.width : 0;
                    if (this._elasticRateX = Math.max(0, 1 - t / this.elasticDistance), this.target._y < this.area.y) var e = this.area.y - this.target.y; else e = this.target._y > this.area.y + this.area.height ? this.target._y - this.area.y - this.area.height : 0;
                    this._elasticRateY = Math.max(0, 1 - e / this.elasticDistance)
                }
            }, e.backToArea = function () {
                this.target.x = Math.min(Math.max(this.target._x, this.area.x), this.area.x + this.area.width), this.target.y = Math.min(Math.max(this.target._y, this.area.y), this.area.y + this.area.height)
            }, e.onStageMouseUp = function (t) {
                if (R.instance.disableMouseEvent = !1, y.stage.off("mouseup", this, this.onStageMouseUp), y.stage.off("mouseout", this, this.onStageMouseUp), y.systemTimer.clear(this, this.loop), !this._clickOnly && this.target) if (this.hasInertia) {
                    this._offsets.length < 1 && this._offsets.push(this._parent.mouseX - this._lastX, this._parent.mouseY - this._lastY), this._offsetX = this._offsetY = 0;
                    for (var e = this._offsets.length, i = Math.min(e, 6), n = this._offsets.length - i, r = e - 1; n < r; r--) this._offsetY += this._offsets[r--], this._offsetX += this._offsets[r];
                    this._offsetX = this._offsetX / i * 2, this._offsetY = this._offsetY / i * 2, Math.abs(this._offsetX) > this.maxOffset && (this._offsetX = 0 < this._offsetX ? this.maxOffset : -this.maxOffset), Math.abs(this._offsetY) > this.maxOffset && (this._offsetY = 0 < this._offsetY ? this.maxOffset : -this.maxOffset), y.systemTimer.frameLoop(1, this, this.tweenMove)
                } else 0 < this.elasticDistance ? this.checkElastic() : this.clear()
            }, e.checkElastic = function () {
                var t = NaN, e = NaN;
                if (this.target.x < this.area.x ? t = this.area.x : this.target._x > this.area.x + this.area.width && (t = this.area.x + this.area.width), this.target.y < this.area.y ? e = this.area.y : this.target._y > this.area.y + this.area.height && (e = this.area.y + this.area.height), isNaN(t) && isNaN(e)) this.clear(); else {
                    var i = {};
                    isNaN(t) || (i.x = t), isNaN(e) || (i.y = e), this._tween = j.to(this.target, i, this.elasticBackTime, ee.sineOut, b.create(this, this.clear), 0, !1, !1)
                }
            }, e.tweenMove = function () {
                this._offsetX *= this.ratio * this._elasticRateX, this._offsetY *= this.ratio * this._elasticRateY, this.target.x += this._offsetX, this.target.y += this._offsetY, this.area && this.checkArea(), this.target.event("dragmove", this.data), (Math.abs(this._offsetX) < 1 && Math.abs(this._offsetY) < 1 || this._elasticRateX < .5 || this._elasticRateY < .5) && (y.systemTimer.clear(this, this.tweenMove), 0 < this.elasticDistance ? this.checkElastic() : this.clear())
            }, e.clear = function () {
                if (this.target) {
                    this.clearTimer();
                    var t = this.target;
                    this.target = null, this._parent = null, t.event("dragend", this.data)
                }
            }, t
        }(), Vt = function () {
            function p() {
            }

            return x(p, "laya.webgl.shapes.Earcut"), p.earcut = function (t, e, i) {
                i = i || 2;
                var n, r, s, a, o, h, l, u = e && e.length, c = u ? e[0] * i : t.length,
                    _ = p.linkedList(t, 0, c, i, !0), f = [];
                if (!_) return f;
                if (u && (_ = p.eliminateHoles(t, e, _, i)), t.length > 80 * i) {
                    n = s = t[0], r = a = t[1];
                    for (var d = i; d < c; d += i) (o = t[d]) < n && (n = o), (h = t[d + 1]) < r && (r = h), s < o && (s = o), a < h && (a = h);
                    l = 0 !== (l = Math.max(s - n, a - r)) ? 1 / l : 0
                }
                return p.earcutLinked(_, f, i, n, r, l), f
            }, p.linkedList = function (t, e, i, n, r) {
                var s, a;
                if (r === 0 < p.signedArea(t, e, i, n)) for (s = e; s < i; s += n) a = p.insertNode(s, t[s], t[s + 1], a); else for (s = i - n; e <= s; s -= n) a = p.insertNode(s, t[s], t[s + 1], a);
                return a && p.equals(a, a.next) && (p.removeNode(a), a = a.next), a
            }, p.filterPoints = function (t, e) {
                if (!t) return t;
                e || (e = t);
                var i, n = t;
                do {
                    if (i = !1, n.steiner || !p.equals(n, n.next) && 0 !== p.area(n.prev, n, n.next)) n = n.next; else {
                        if (p.removeNode(n), (n = e = n.prev) === n.next) break;
                        i = !0
                    }
                } while (i || n !== e);
                return e
            }, p.earcutLinked = function (t, e, i, n, r, s, a) {
                if (t) {
                    !a && s && p.indexCurve(t, n, r, s);
                    for (var o, h, l = t; t.prev !== t.next;) if (o = t.prev, h = t.next, s ? p.isEarHashed(t, n, r, s) : p.isEar(t)) e.push(o.i / i), e.push(t.i / i), e.push(h.i / i), p.removeNode(t), t = h.next, l = h.next; else if ((t = h) === l) {
                        a ? 1 === a ? (t = p.cureLocalIntersections(t, e, i), p.earcutLinked(t, e, i, n, r, s, 2)) : 2 === a && p.splitEarcut(t, e, i, n, r, s) : p.earcutLinked(p.filterPoints(t, null), e, i, n, r, s, 1);
                        break
                    }
                }
            }, p.isEar = function (t) {
                var e = t.prev, i = t, n = t.next;
                if (0 <= p.area(e, i, n)) return !1;
                for (var r = t.next.next; r !== t.prev;) {
                    if (p.pointInTriangle(e.x, e.y, i.x, i.y, n.x, n.y, r.x, r.y) && 0 <= p.area(r.prev, r, r.next)) return !1;
                    r = r.next
                }
                return !0
            }, p.isEarHashed = function (t, e, i, n) {
                var r = t.prev, s = t, a = t.next;
                if (0 <= p.area(r, s, a)) return !1;
                for (var o = r.x < s.x ? r.x < a.x ? r.x : a.x : s.x < a.x ? s.x : a.x, h = r.y < s.y ? r.y < a.y ? r.y : a.y : s.y < a.y ? s.y : a.y, l = r.x > s.x ? r.x > a.x ? r.x : a.x : s.x > a.x ? s.x : a.x, u = r.y > s.y ? r.y > a.y ? r.y : a.y : s.y > a.y ? s.y : a.y, c = p.zOrder(o, h, e, i, n), _ = p.zOrder(l, u, e, i, n), f = t.nextZ; f && f.z <= _;) {
                    if (f !== t.prev && f !== t.next && p.pointInTriangle(r.x, r.y, s.x, s.y, a.x, a.y, f.x, f.y) && 0 <= p.area(f.prev, f, f.next)) return !1;
                    f = f.nextZ
                }
                for (f = t.prevZ; f && f.z >= c;) {
                    if (f !== t.prev && f !== t.next && p.pointInTriangle(r.x, r.y, s.x, s.y, a.x, a.y, f.x, f.y) && 0 <= p.area(f.prev, f, f.next)) return !1;
                    f = f.prevZ
                }
                return !0
            }, p.cureLocalIntersections = function (t, e, i) {
                var n = t;
                do {
                    var r = n.prev, s = n.next.next;
                    !p.equals(r, s) && p.intersects(r, n, n.next, s) && p.locallyInside(r, s) && p.locallyInside(s, r) && (e.push(r.i / i), e.push(n.i / i), e.push(s.i / i), p.removeNode(n), p.removeNode(n.next), n = t = s), n = n.next
                } while (n !== t);
                return n
            }, p.splitEarcut = function (t, e, i, n, r, s) {
                var a = t;
                do {
                    for (var o = a.next.next; o !== a.prev;) {
                        if (a.i !== o.i && p.isValidDiagonal(a, o)) {
                            var h = p.splitPolygon(a, o);
                            return a = p.filterPoints(a, a.next), h = p.filterPoints(h, h.next), p.earcutLinked(a, e, i, n, r, s), void p.earcutLinked(h, e, i, n, r, s)
                        }
                        o = o.next
                    }
                    a = a.next
                } while (a !== t)
            }, p.eliminateHoles = function (t, e, i, n) {
                var r, s, a, o, h, l = [];
                for (r = 0, s = e.length; r < s; r++) a = e[r] * n, o = r < s - 1 ? e[r + 1] * n : t.length, (h = p.linkedList(t, a, o, n, !1)) === h.next && (h.steiner = !0), l.push(p.getLeftmost(h));
                for (l.sort(p.compareX), r = 0; r < l.length; r++) p.eliminateHole(l[r], i), i = p.filterPoints(i, i.next);
                return i
            }, p.compareX = function (t, e) {
                return t.x - e.x
            }, p.eliminateHole = function (t, e) {
                if (e = p.findHoleBridge(t, e)) {
                    var i = p.splitPolygon(e, t);
                    p.filterPoints(i, i.next)
                }
            }, p.findHoleBridge = function (t, e) {
                var i, n = e, r = t.x, s = t.y, a = -1 / 0;
                do {
                    if (s <= n.y && s >= n.next.y && n.next.y !== n.y) {
                        var o = n.x + (s - n.y) * (n.next.x - n.x) / (n.next.y - n.y);
                        if (o <= r && a < o) {
                            if ((a = o) === r) {
                                if (s === n.y) return n;
                                if (s === n.next.y) return n.next
                            }
                            i = n.x < n.next.x ? n : n.next
                        }
                    }
                    n = n.next
                } while (n !== e);
                if (!i) return null;
                if (r === a) return i.prev;
                var h, l = i, u = i.x, c = i.y, _ = 1 / 0;
                for (n = i.next; n !== l;) r >= n.x && n.x >= u && r !== n.x && p.pointInTriangle(s < c ? r : a, s, u, c, s < c ? a : r, s, n.x, n.y) && ((h = Math.abs(s - n.y) / (r - n.x)) < _ || h === _ && n.x > i.x) && p.locallyInside(n, t) && (i = n, _ = h), n = n.next;
                return i
            }, p.indexCurve = function (t, e, i, n) {
                for (var r = t; null === r.z && (r.z = p.zOrder(r.x, r.y, e, i, n)), r.prevZ = r.prev, r.nextZ = r.next, (r = r.next) !== t;) ;
                r.prevZ.nextZ = null, r.prevZ = null, p.sortLinked(r)
            }, p.sortLinked = function (t) {
                var e, i, n, r, s, a, o, h, l = 1;
                do {
                    for (i = t, s = t = null, a = 0; i;) {
                        for (a++, n = i, e = o = 0; e < l && (o++, n = n.nextZ); e++) ;
                        for (h = l; 0 < o || 0 < h && n;) 0 !== o && (0 === h || !n || i.z <= n.z) ? (i = (r = i).nextZ, o--) : (n = (r = n).nextZ, h--), s ? s.nextZ = r : t = r, r.prevZ = s, s = r;
                        i = n
                    }
                    s.nextZ = null, l *= 2
                } while (1 < a);
                return t
            }, p.zOrder = function (t, e, i, n, r) {
                return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - i) * r) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - n) * r) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1
            }, p.getLeftmost = function (t) {
                for (var e = t, i = t; e.x < i.x && (i = e), (e = e.next) !== t;) ;
                return i
            }, p.pointInTriangle = function (t, e, i, n, r, s, a, o) {
                return 0 <= (r - a) * (e - o) - (t - a) * (s - o) && 0 <= (t - a) * (n - o) - (i - a) * (e - o) && 0 <= (i - a) * (s - o) - (r - a) * (n - o)
            }, p.isValidDiagonal = function (t, e) {
                return t.next.i !== e.i && t.prev.i !== e.i && !p.intersectsPolygon(t, e) && p.locallyInside(t, e) && p.locallyInside(e, t) && p.middleInside(t, e)
            }, p.area = function (t, e, i) {
                return (e.y - t.y) * (i.x - e.x) - (e.x - t.x) * (i.y - e.y)
            }, p.equals = function (t, e) {
                return t.x === e.x && t.y === e.y
            }, p.intersects = function (t, e, i, n) {
                return !!(p.equals(t, e) && p.equals(i, n) || p.equals(t, n) && p.equals(i, e)) || 0 < p.area(t, e, i) != 0 < p.area(t, e, n) && 0 < p.area(i, n, t) != 0 < p.area(i, n, e)
            }, p.intersectsPolygon = function (t, e) {
                var i = t;
                do {
                    if (i.i !== t.i && i.next.i !== t.i && i.i !== e.i && i.next.i !== e.i && p.intersects(i, i.next, t, e)) return !0;
                    i = i.next
                } while (i !== t);
                return !1
            }, p.locallyInside = function (t, e) {
                return p.area(t.prev, t, t.next) < 0 ? 0 <= p.area(t, e, t.next) && 0 <= p.area(t, t.prev, e) : p.area(t, e, t.prev) < 0 || p.area(t, t.next, e) < 0
            }, p.middleInside = function (t, e) {
                for (var i = t, n = !1, r = (t.x + e.x) / 2, s = (t.y + e.y) / 2; i.y > s != i.next.y > s && i.next.y !== i.y && r < (i.next.x - i.x) * (s - i.y) / (i.next.y - i.y) + i.x && (n = !n), (i = i.next) !== t;) ;
                return n
            }, p.splitPolygon = function (t, e) {
                var i = new $(t.i, t.x, t.y), n = new $(e.i, e.x, e.y), r = t.next, s = e.prev;
                return (t.next = e).prev = t, (i.next = r).prev = i, (n.next = i).prev = n, (s.next = n).prev = s, n
            }, p.insertNode = function (t, e, i, n) {
                var r = new $(t, e, i);
                return n ? (r.next = n.next, (r.prev = n).next.prev = r, n.next = r) : (r.prev = r).next = r, r
            }, p.removeNode = function (t) {
                t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), t.nextZ && (t.nextZ.prevZ = t.prevZ)
            }, p.signedArea = function (t, e, i, n) {
                for (var r = 0, s = e, a = i - n; s < i; s += n) r += (t[a] - t[s]) * (t[s + 1] + t[a + 1]), a = s;
                return r
            }, p
        }(), Xt = function () {
            function i(t) {
                this.childs = [], this.text = "", this.parent = null, this.name = null, this.noCompile = !1, this.includefiles = null, this.condition = null, this.conditionType = 0, this.useFuns = "", this.z = 0, this.src = null, this.includefiles = t
            }

            x(i, "laya.webgl.utils.ShaderNode");
            var t = i.prototype;
            return t.setParent = function (t) {
                t.childs.push(this), this.z = t.z + 1, this.parent = t
            }, t.setCondition = function (t, e) {
                t && (this.conditionType = e, t = t.replace(/(\s*$)/g, ""), this.condition = function () {
                    return this[t]
                }, this.condition.__condition = t)
            }, t.toscript = function (t, e) {
                return this._toscript(t, e, ++i.__id)
            }, t._toscript = function (n, r, s) {
                if (this.childs.length < 1 && !this.text) return r;
                r.length;
                if (this.condition) {
                    var t = !!this.condition.call(n);
                    if (2 === this.conditionType && (t = !t), !t) return r
                }
                if (this.text && r.push(this.text), 0 < this.childs.length && this.childs.forEach(function (t, e, i) {
                    t._toscript(n, r, s)
                }), 0 < this.includefiles.length && 0 < this.useFuns.length) for (var e, i = 0, a = this.includefiles.length; i < a; i++) this.includefiles[i].curUseID != s && 0 < (e = this.includefiles[i].file.getFunsScript(this.useFuns)).length && (this.includefiles[i].curUseID = s, r[0] = e + r[0]);
                return r
            }, i.__id = 1, i
        }(), Yt = function () {
            function n() {
            }

            x(n, "laya.display.cmd.TranslateCmd");
            var t = n.prototype;
            return t.recover = function () {
                W.recover("TranslateCmd", this)
            }, t.run = function (t, e, i) {
                t.translate(this.tx, this.ty)
            }, d(0, t, "cmdID", function () {
                return "Translate"
            }), n.create = function (t, e) {
                var i = W.getItemByClass("TranslateCmd", n);
                return i.tx = t, i.ty = e, i
            }, n.ID = "Translate", n
        }(), Ht = function () {
            function t(t, e) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), this.x = t, this.y = e
            }

            x(t, "laya.maths.Point");
            var e = t.prototype;
            return e.setTo = function (t, e) {
                return this.x = t, this.y = e, this
            }, e.reset = function () {
                return this.x = this.y = 0, this
            }, e.recover = function () {
                W.recover("Point", this.reset())
            }, e.distance = function (t, e) {
                return Math.sqrt((this.x - t) * (this.x - t) + (this.y - e) * (this.y - e))
            }, e.toString = function () {
                return this.x + "," + this.y
            }, e.normalize = function () {
                var t = Math.sqrt(this.x * this.x + this.y * this.y);
                if (0 < t) {
                    var e = 1 / t;
                    this.x *= e, this.y *= e
                }
            }, e.copy = function (t) {
                return this.setTo(t.x, t.y)
            }, t.create = function () {
                return W.getItemByClass("Point", t)
            }, t.TEMP = new t, t.EMPTY = new t, t
        }(), zt = (function () {
            function t() {
            }

            x(t, "laya.Const"), t.NOT_ACTIVE = 1, t.ACTIVE_INHIERARCHY = 2, t.AWAKED = 4, t.NOT_READY = 8, t.DISPLAY = 16, t.HAS_ZORDER = 32, t.HAS_MOUSE = 64, t.DISPLAYED_INSTAGE = 128, t.DRAWCALL_OPTIMIZE = 256
        }(), function () {
            function D() {
            }

            return x(D, "laya.webgl.shapes.BasePoly"), D.createLine2 = function (t, e, i, n, r, s) {
                if (t.length < 4) return null;
                var a = D.tempData.length > t.length + 2 ? D.tempData : new Array(t.length + 2);
                a[0] = t[0], a[1] = t[1];
                var o = 2, h = 0, l = t.length;
                for (h = 2; h < l; h += 2) .01 < Math.abs(t[h] - t[h - 2]) + Math.abs(t[h + 1] - t[h - 1]) && (a[o++] = t[h], a[o++] = t[h + 1]);
                s && .01 < Math.abs(t[0] - a[o - 2]) + Math.abs(t[1] - a[o - 1]) && (a[o++] = t[0], a[o++] = t[1]);
                var u = r;
                l = o / 2;
                var c, _, f, d, p, m, g, v, y, x, T, b, w, C, A, M, E, S, R, I, P = i / 2;
                f = a[0], d = a[1], x = f - (p = a[2]);
                y = (y = -(d - (m = a[3]))) / (I = Math.sqrt(y * y + x * x)) * P, x = x / I * P;
                for (u.push(f - y, d - x, f + y, d + x), h = 1; h < l - 1; h++) f = a[2 * (h - 1)], d = a[2 * (h - 1) + 1], p = a[2 * h], m = a[2 * h + 1], g = a[2 * (h + 1)], v = a[2 * (h + 1) + 1], x = f - p, b = p - g, A = (-(y = (y = -(d - m)) / (I = Math.sqrt(y * y + x * x)) * P) + f) * (-(x = x / I * P) + m) - (-y + p) * (-x + d), S = (-(T = (T = -(m - v)) / (I = Math.sqrt(T * T + b * b)) * P) + g) * (-(b = b / I * P) + m) - (-T + p) * (-b + v), R = (w = -x + d - (-x + m)) * (E = -T + p - (-T + g)) - (M = -b + v - (-b + m)) * (C = -y + p - (-y + f)), Math.abs(R) < .1 ? (R += 10.1, u.push(p - y, m - x, p + y, m + x)) : (((c = (C * S - E * A) / R) - p) * (c - p) + ((_ = (M * A - w * S) / R) - m) + (_ - m), u.push(c, _, p - (c - p), m - (_ - m)));
                for (f = a[o - 4], d = a[o - 3], x = f - (p = a[o - 2]), y = (y = -(d - (m = a[o - 1]))) / (I = Math.sqrt(y * y + x * x)) * P, x = x / I * P, u.push(p - y, m - x, p + y, m + x), h = 1; h < l; h++) e.push(n + 2 * (h - 1), n + 2 * (h - 1) + 1, n + 2 * h + 1, n + 2 * h + 1, n + 2 * h, n + 2 * (h - 1));
                return u
            }, D.createLineTriangle = function (t, e, i, n, r, s, a) {
                var o = t.slice(), h = o.length, l = o[0], u = o[1], c = o[2], _ = (o[2], 0), f = 0, d = 0, p = 0,
                    m = h / 2;
                if (!(m <= 1) && 2 != m) {
                    for (var g = new Array(4 * m), v = 0, y = 0, x = 0; x < m - 1; x++) l = o[y++], u = o[y++], c = o[y++], p = o[y++] - u, 0 != (d = c - l) && 0 != p && .001 < (_ = Math.sqrt(d * d + p * p)) && (g[f = 4 * v] = l, g[f + 1] = u, g[f + 2] = d / _, g[f + 3] = p / _, v++);
                    for (n ? (l = o[h - 2], u = o[h - 1], c = o[0], p = o[1] - u, 0 != (d = c - l) && 0 != p && .001 < (_ = Math.sqrt(d * d + p * p)) && (g[f = 4 * v] = l, g[f + 1] = u, g[f + 2] = d / _, g[f + 3] = p / _, v++)) : (g[f = 4 * v] = l, g[f + 1] = u, g[f + 2] = d / _, g[f + 3] = p / _, v++), x = y = 0; x < m; x++) {
                        l = o[y], u = o[y + 1], c = o[y + 2], o[y + 3];
                        o[y + 4], o[y + 5]
                    }
                }
            }, a(D, ["tempData", function () {
                return this.tempData = new Array(256)
            }]), D
        }()), jt = function () {
            function s() {
            }

            x(s, "laya.display.cmd.ScaleCmd");
            var t = s.prototype;
            return t.recover = function () {
                W.recover("ScaleCmd", this)
            }, t.run = function (t, e, i) {
                t._scale(this.scaleX, this.scaleY, this.pivotX + e, this.pivotY + i)
            }, d(0, t, "cmdID", function () {
                return "Scale"
            }), s.create = function (t, e, i, n) {
                var r = W.getItemByClass("ScaleCmd", s);
                return r.scaleX = t, r.scaleY = e, r.pivotX = i, r.pivotY = n, r
            }, s.ID = "Scale", s
        }(), Kt = function () {
            function i() {
            }

            x(i, "laya.display.cmd.AlphaCmd");
            var t = i.prototype;
            return t.recover = function () {
                W.recover("AlphaCmd", this)
            }, t.run = function (t, e, i) {
                t.alpha(this.alpha)
            }, d(0, t, "cmdID", function () {
                return "Alpha"
            }), i.create = function (t) {
                var e = W.getItemByClass("AlphaCmd", i);
                return e.alpha = t, e
            }, i.ID = "Alpha", i
        }(), $t = function () {
            function e(t) {
                this._xd_ = !0, this._allocated_ = 8, this._pos_ = 0, this._length = 0, t ? (this._u8d_ = new Uint8Array(t), this._d_ = new DataView(this._u8d_.buffer), this._length = this._d_.byteLength) : this._resizeBuffer(this._allocated_)
            }

            x(e, "laya.utils.Byte");
            var t = e.prototype;
            return t._resizeBuffer = function (e) {
                try {
                    var t = new Uint8Array(e);
                    null != this._u8d_ && (this._u8d_.length <= e ? t.set(this._u8d_) : t.set(this._u8d_.subarray(0, e))), this._u8d_ = t, this._d_ = new DataView(t.buffer)
                } catch (t) {
                    throw"Invalid typed array length:" + e
                }
            }, t.getString = function () {
                return this.readString()
            }, t.readString = function () {
                return this._rUTF(this.getUint16())
            }, t.getFloat32Array = function (t, e) {
                return this.readFloat32Array(t, e)
            }, t.readFloat32Array = function (t, e) {
                var i = t + e;
                i = i > this._length ? this._length : i;
                var n = new Float32Array(this._d_.buffer.slice(t, i));
                return this._pos_ = i, n
            }, t.getUint8Array = function (t, e) {
                return this.readUint8Array(t, e)
            }, t.readUint8Array = function (t, e) {
                var i = t + e;
                i = i > this._length ? this._length : i;
                var n = new Uint8Array(this._d_.buffer.slice(t, i));
                return this._pos_ = i, n
            }, t.getInt16Array = function (t, e) {
                return this.readInt16Array(t, e)
            }, t.readInt16Array = function (t, e) {
                var i = t + e;
                i = i > this._length ? this._length : i;
                var n = new Int16Array(this._d_.buffer.slice(t, i));
                return this._pos_ = i, n
            }, t.getFloat32 = function () {
                return this.readFloat32()
            }, t.readFloat32 = function () {
                if (this._pos_ + 4 > this._length) throw"getFloat32 error - Out of bounds";
                var t = this._d_.getFloat32(this._pos_, this._xd_);
                return this._pos_ += 4, t
            }, t.getFloat64 = function () {
                return this.readFloat64()
            }, t.readFloat64 = function () {
                if (this._pos_ + 8 > this._length) throw"getFloat64 error - Out of bounds";
                var t = this._d_.getFloat64(this._pos_, this._xd_);
                return this._pos_ += 8, t
            }, t.writeFloat32 = function (t) {
                this._ensureWrite(this._pos_ + 4), this._d_.setFloat32(this._pos_, t, this._xd_), this._pos_ += 4
            }, t.writeFloat64 = function (t) {
                this._ensureWrite(this._pos_ + 8), this._d_.setFloat64(this._pos_, t, this._xd_), this._pos_ += 8
            }, t.getInt32 = function () {
                return this.readInt32()
            }, t.readInt32 = function () {
                if (this._pos_ + 4 > this._length) throw"getInt32 error - Out of bounds";
                var t = this._d_.getInt32(this._pos_, this._xd_);
                return this._pos_ += 4, t
            }, t.getUint32 = function () {
                return this.readUint32()
            }, t.readUint32 = function () {
                if (this._pos_ + 4 > this._length) throw"getUint32 error - Out of bounds";
                var t = this._d_.getUint32(this._pos_, this._xd_);
                return this._pos_ += 4, t
            }, t.writeInt32 = function (t) {
                this._ensureWrite(this._pos_ + 4), this._d_.setInt32(this._pos_, t, this._xd_), this._pos_ += 4
            }, t.writeUint32 = function (t) {
                this._ensureWrite(this._pos_ + 4), this._d_.setUint32(this._pos_, t, this._xd_), this._pos_ += 4
            }, t.getInt16 = function () {
                return this.readInt16()
            }, t.readInt16 = function () {
                if (this._pos_ + 2 > this._length) throw"getInt16 error - Out of bounds";
                var t = this._d_.getInt16(this._pos_, this._xd_);
                return this._pos_ += 2, t
            }, t.getUint16 = function () {
                return this.readUint16()
            }, t.readUint16 = function () {
                if (this._pos_ + 2 > this._length) throw"getUint16 error - Out of bounds";
                var t = this._d_.getUint16(this._pos_, this._xd_);
                return this._pos_ += 2, t
            }, t.writeUint16 = function (t) {
                this._ensureWrite(this._pos_ + 2), this._d_.setUint16(this._pos_, t, this._xd_), this._pos_ += 2
            }, t.writeInt16 = function (t) {
                this._ensureWrite(this._pos_ + 2), this._d_.setInt16(this._pos_, t, this._xd_), this._pos_ += 2
            }, t.getUint8 = function () {
                return this.readUint8()
            }, t.readUint8 = function () {
                if (this._pos_ + 1 > this._length) throw"getUint8 error - Out of bounds";
                return this._u8d_[this._pos_++]
            }, t.writeUint8 = function (t) {
                this._ensureWrite(this._pos_ + 1), this._d_.setUint8(this._pos_, t), this._pos_++
            }, t._getUInt8 = function (t) {
                return this._readUInt8(t)
            }, t._readUInt8 = function (t) {
                return this._d_.getUint8(t)
            }, t._getUint16 = function (t) {
                return this._readUint16(t)
            }, t._readUint16 = function (t) {
                return this._d_.getUint16(t, this._xd_)
            }, t._getMatrix = function () {
                return this._readMatrix()
            }, t._readMatrix = function () {
                return new at(this.getFloat32(), this.getFloat32(), this.getFloat32(), this.getFloat32(), this.getFloat32(), this.getFloat32())
            }, t._rUTF = function (t) {
                var e = this._pos_ + t, i = 0, n = String.fromCharCode, r = this._u8d_, s = [], a = 0;
                for (s.length = 1e3; this._pos_ < e;) (i = r[this._pos_++]) < 128 ? 0 != i && (s[a++] = n(i)) : s[a++] = i < 224 ? n((63 & i) << 6 | 127 & r[this._pos_++]) : i < 240 ? n((31 & i) << 12 | (127 & r[this._pos_++]) << 6 | 127 & r[this._pos_++]) : n((15 & i) << 18 | (127 & r[this._pos_++]) << 12 | r[this._pos_++] << 6 & 127 | 127 & r[this._pos_++]), 0;
                return s.length = a, s.join("")
            }, t.getCustomString = function (t) {
                return this.readCustomString(t)
            }, t.readCustomString = function (t) {
                for (var e = "", i = 0, n = 0, r = String.fromCharCode, s = this._u8d_; 0 < t;) if ((n = s[this._pos_]) < 128) e += r(n), this._pos_++, t--; else for (i = n - 128, this._pos_++, t -= i; 0 < i;) n = s[this._pos_++], e += r(s[this._pos_++] << 8 | n), i--;
                return e
            }, t.clear = function () {
                this._pos_ = 0, this.length = 0
            }, t.__getBuffer = function () {
                return this._d_.buffer
            }, t.writeUTFBytes = function (t) {
                for (var e = 0, i = (t += "").length; e < i; e++) {
                    var n = t.charCodeAt(e);
                    n <= 127 ? this.writeByte(n) : n <= 2047 ? (this._ensureWrite(this._pos_ + 2), this._u8d_.set([192 | n >> 6, 128 | 63 & n], this._pos_), this._pos_ += 2) : n <= 65535 ? (this._ensureWrite(this._pos_ + 3), this._u8d_.set([224 | n >> 12, 128 | n >> 6 & 63, 128 | 63 & n], this._pos_), this._pos_ += 3) : (this._ensureWrite(this._pos_ + 4), this._u8d_.set([240 | n >> 18, 128 | n >> 12 & 63, 128 | n >> 6 & 63, 128 | 63 & n], this._pos_), this._pos_ += 4)
                }
            }, t.writeUTFString = function (t) {
                var e = this.pos;
                this.writeUint16(1), this.writeUTFBytes(t);
                var i = this.pos - e - 2;
                this._d_.setUint16(e, i, this._xd_)
            }, t.readUTFString = function () {
                return this.readUTFBytes(this.getInt16())
            }, t.getUTFString = function () {
                return this.readUTFString()
            }, t.readUTFBytes = function (t) {
                if (void 0 === t && (t = -1), 0 === t) return "";
                var e = this.bytesAvailable;
                if (e < t) throw"readUTFBytes error - Out of bounds";
                return t = 0 < t ? t : e, this._rUTF(t)
            }, t.getUTFBytes = function (t) {
                return void 0 === t && (t = -1), this.readUTFBytes(t)
            }, t.writeByte = function (t) {
                this._ensureWrite(this._pos_ + 1), this._d_.setInt8(this._pos_, t), this._pos_ += 1
            }, t.readByte = function () {
                if (this._pos_ + 1 > this._length) throw"readByte error - Out of bounds";
                return this._d_.getInt8(this._pos_++)
            }, t.getByte = function () {
                return this.readByte()
            }, t._ensureWrite = function (t) {
                this._length < t && (this._length = t), this._allocated_ < t && (this.length = t)
            }, t.writeArrayBuffer = function (t, e, i) {
                if (void 0 === e && (e = 0), void 0 === i && (i = 0), e < 0 || i < 0) throw"writeArrayBuffer error - Out of bounds";
                0 == i && (i = t.byteLength - e), this._ensureWrite(this._pos_ + i);
                var n = new Uint8Array(t);
                this._u8d_.set(n.subarray(e, e + i), this._pos_), this._pos_ += i
            }, t.readArrayBuffer = function (t) {
                var e;
                return e = this._u8d_.buffer.slice(this._pos_, this._pos_ + t), this._pos_ = this._pos_ + t, e
            }, d(0, t, "buffer", function () {
                var t = this._d_.buffer;
                return t.byteLength === this._length ? t : t.slice(0, this._length)
            }), d(0, t, "endian", function () {
                return this._xd_ ? "littleEndian" : "bigEndian"
            }, function (t) {
                this._xd_ = "littleEndian" === t
            }), d(0, t, "length", function () {
                return this._length
            }, function (t) {
                this._allocated_ < t ? this._resizeBuffer(this._allocated_ = Math.floor(Math.max(t, 2 * this._allocated_))) : this._allocated_ > t && this._resizeBuffer(this._allocated_ = t), this._length = t
            }), d(0, t, "pos", function () {
                return this._pos_
            }, function (t) {
                this._pos_ = t
            }), d(0, t, "bytesAvailable", function () {
                return this._length - this._pos_
            }), e.getSystemEndian = function () {
                if (!e._sysEndian) {
                    var t = new ArrayBuffer(2);
                    new DataView(t).setInt16(0, 256, !0), e._sysEndian = 256 === new Int16Array(t)[0] ? "littleEndian" : "bigEndian"
                }
                return e._sysEndian
            }, e.BIG_ENDIAN = "bigEndian", e.LITTLE_ENDIAN = "littleEndian", e._sysEndian = null, e
        }(), Qt = function () {
            var a;

            function t() {
                this._pool = [], this._map = [], this._laters = []
            }

            x(t, "laya.utils.CallLater");
            var e = t.prototype;
            return e._update = function () {
                var t = this._laters, e = t.length;
                if (0 < e) {
                    for (var i = 0, n = e - 1; i <= n; i++) {
                        var r = t[i];
                        (this._map[r.key] = null) !== r.method && (r.run(), r.clear()), this._pool.push(r), i === n && (n = t.length - 1)
                    }
                    t.length = 0
                }
            }, e._getHandler = function (t, e) {
                var i = t ? t.$_GID || (t.$_GID = ne.getGID()) : 0, n = e.$_TID || (e.$_TID = 1e5 * tt._mid++);
                return this._map[i + n]
            }, e.callLater = function (t, e, i) {
                if (null == this._getHandler(t, e)) {
                    if (this._pool.length) var n = this._pool.pop(); else n = new a;
                    n.caller = t, n.method = e, n.args = i;
                    var r = t ? t.$_GID : 0, s = e.$_TID;
                    n.key = r + s, this._map[n.key] = n, this._laters.push(n)
                }
            }, e.runCallLater = function (t, e) {
                var i = this._getHandler(t, e);
                i && null != i.method && (this._map[i.key] = null, i.run(), i.clear())
            }, t.I = new t, t.__init$ = function () {
                a = function () {
                    function t() {
                        this.key = 0, this.caller = null, this.method = null, this.args = null
                    }

                    x(t, "");
                    var e = t.prototype;
                    return e.clear = function () {
                        this.caller = null, this.method = null, this.args = null
                    }, e.run = function () {
                        var t = this.caller;
                        if (t && t.destroyed) return this.clear();
                        var e = this.method, i = this.args;
                        null != e && (i ? e.apply(t, i) : e.call(t))
                    }, t
                }()
            }, t
        }(), qt = function () {
            function t() {
                this._sp = null, this._one = null, this._cmds = null, this._vectorgraphArray = null, this._graphicBounds = null, this.autoDestroy = !1, this._render = this._renderEmpty, this._createData()
            }

            x(t, "laya.display.Graphics");
            var e = t.prototype;
            return e._createData = function () {
            }, e._clearData = function () {
            }, e._destroyData = function () {
            }, e.destroy = function () {
                this.clear(!0), this._graphicBounds && this._graphicBounds.destroy(), this._graphicBounds = null, this._vectorgraphArray = null, this._sp && (this._sp._renderType = 0, this._sp._setRenderType(0), this._sp = null), this._destroyData()
            }, e.clear = function (t) {
                if (void 0 === t && (t = !0), t) {
                    var e = this._one;
                    if (this._cmds) {
                        var i = 0, n = this._cmds.length;
                        for (i = 0; i < n; i++) (e = this._cmds[i]).recover();
                        this._cmds.length = 0
                    } else e && e.recover()
                } else this._cmds = null;
                if (this._one = null, this._render = this._renderEmpty, this._clearData(), this._sp && (this._sp._renderType &= -513, this._sp._setRenderType(this._sp._renderType)), this._repaint(), this._vectorgraphArray) {
                    for (i = 0, n = this._vectorgraphArray.length; i < n; i++) I.getInstance().deleteShape(this._vectorgraphArray[i]);
                    this._vectorgraphArray.length = 0
                }
            }, e._clearBoundsCache = function () {
                this._graphicBounds && this._graphicBounds.reset()
            }, e._initGraphicBounds = function () {
                this._graphicBounds || (this._graphicBounds = Pt.create(), this._graphicBounds._graphics = this)
            }, e._repaint = function () {
                this._clearBoundsCache(), this._sp && this._sp.repaint()
            }, e._isOnlyOne = function () {
                return !this._cmds || 0 === this._cmds.length
            }, e.getBounds = function (t) {
                return void 0 === t && (t = !1), this._initGraphicBounds(), this._graphicBounds.getBounds(t)
            }, e.getBoundPoints = function (t) {
                return void 0 === t && (t = !1), this._initGraphicBounds(), this._graphicBounds.getBoundPoints(t)
            }, e.drawImage = function (t, e, i, n, r) {
                if (void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = 0), !t) return null;
                if (n || (n = t.sourceWidth), r || (r = t.sourceHeight), t.getIsReady()) {
                    var s = n / t.sourceWidth, a = r / t.sourceHeight;
                    if (n = t.width * s, r = t.height * a, n <= 0 || r <= 0) return null;
                    e += t.offsetX * s, i += t.offsetY * a
                }
                this._sp && (this._sp._renderType |= 512, this._sp._setRenderType(this._sp._renderType));
                var o = _.create.call(this, t, e, i, n, r);
                return null == this._one ? (this._one = o, this._render = this._renderOneImg) : this._saveToCmd(null, o), this._repaint(), o
            }, e.drawTexture = function (t, e, i, n, r, s, a, o, h) {
                if (void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = 0), void 0 === a && (a = 1), !t || a < .01) return null;
                if (!t.getIsReady()) return null;
                if (n || (n = t.sourceWidth), r || (r = t.sourceHeight), t.getIsReady()) {
                    var l = n / t.sourceWidth, u = r / t.sourceHeight;
                    if (n = t.width * l, r = t.height * u, n <= 0 || r <= 0) return null;
                    e += t.offsetX * l, i += t.offsetY * u
                }
                this._sp && (this._sp._renderType |= 512, this._sp._setRenderType(this._sp._renderType));
                var c = X.create.call(this, t, e, i, n, r, s, a, o, h);
                return this._repaint(), this._saveToCmd(null, c)
            }, e.drawTextures = function (t, e) {
                return t ? this._saveToCmd(Rt._context.drawTextures, lt.create.call(this, t, e)) : null
            }, e.drawTriangles = function (t, e, i, n, r, s, a, o, h, l) {
                return void 0 === o && (o = 1), this._saveToCmd(Rt._context.drawTriangles, v.create.call(this, t, e, i, n, r, s, a, o, h, l))
            }, e.fillTexture = function (t, e, i, n, r, s, a) {
                return void 0 === n && (n = 0), void 0 === r && (r = 0), void 0 === s && (s = "repeat"), t && t.getIsReady() ? this._saveToCmd(Rt._context._fillTexture, h.create.call(this, t, e, i, n, r, s, a || Ht.EMPTY, {})) : null
            }, e._saveToCmd = function (t, e) {
                return this._sp && (this._sp._renderType |= 512, this._sp._setRenderType(this._sp._renderType)), null == this._one ? (this._one = e, this._render = this._renderOne) : (this._render = this._renderAll, 0 === (this._cmds || (this._cmds = [])).length && this._cmds.push(this._one), this._cmds.push(e)), this._repaint(), e
            }, e.clipRect = function (t, e, i, n) {
                return this._saveToCmd(Rt._context.clipRect, F.create.call(this, t, e, i, n))
            }, e.fillText = function (t, e, i, n, r, s) {
                return this._saveToCmd(Rt._context.fillText, he.create.call(this, t, e, i, n || ei.defaultFontStr(), r, s))
            }, e.fillBorderText = function (t, e, i, n, r, s, a, o) {
                return this._saveToCmd(Rt._context.fillBorderText, Ot.create.call(this, t, e, i, n || ei.defaultFontStr(), r, s, a, o))
            }, e.fillWords = function (t, e, i, n, r) {
                return this._saveToCmd(Rt._context.fillWords, st.create.call(this, t, e, i, n || ei.defaultFontStr(), r))
            }, e.fillBorderWords = function (t, e, i, n, r, s, a) {
                return this._saveToCmd(Rt._context.fillBorderWords, ve.create.call(this, t, e, i, n || ei.defaultFontStr(), r, s, a))
            }, e.strokeText = function (t, e, i, n, r, s, a) {
                return this._saveToCmd(Rt._context.fillBorderText, Jt.create.call(this, t, e, i, n || ei.defaultFontStr(), null, r, s, a))
            }, e.alpha = function (t) {
                return this._saveToCmd(Rt._context.alpha, Kt.create.call(this, t))
            }, e.transform = function (t, e, i) {
                return void 0 === e && (e = 0), void 0 === i && (i = 0), this._saveToCmd(Rt._context._transform, ht.create.call(this, t, e, i))
            }, e.rotate = function (t, e, i) {
                return void 0 === e && (e = 0), void 0 === i && (i = 0), this._saveToCmd(Rt._context._rotate, de.create.call(this, t, e, i))
            }, e.scale = function (t, e, i, n) {
                return void 0 === i && (i = 0), void 0 === n && (n = 0), this._saveToCmd(Rt._context._scale, jt.create.call(this, t, e, i, n))
            }, e.translate = function (t, e) {
                return this._saveToCmd(Rt._context.translate, Yt.create.call(this, t, e))
            }, e.save = function () {
                return this._saveToCmd(Rt._context._save, bt.create.call(this))
            }, e.restore = function () {
                return this._saveToCmd(Rt._context.restore, D.create.call(this))
            }, e.replaceText = function (t) {
                this._repaint();
                var e = this._cmds;
                if (e) {
                    for (var i = e.length - 1; -1 < i; i--) if (this._isTextCmd(e[i])) return e[i].text = t, !0
                } else if (this._one && this._isTextCmd(this._one)) return this._one.text = t, !0;
                return !1
            }, e._isTextCmd = function (t) {
                var e = t.cmdID;
                return "FillText" == e || "StrokeText" == e || "FillBorderText" == e
            }, e.replaceTextColor = function (t) {
                this._repaint();
                var e = this._cmds;
                if (e) for (var i = e.length - 1; -1 < i; i--) this._isTextCmd(e[i]) && this._setTextCmdColor(e[i], t); else this._one && this._isTextCmd(this._one) && this._setTextCmdColor(this._one, t)
            }, e._setTextCmdColor = function (t, e) {
                switch (t.cmdID) {
                    case"FillText":
                    case"StrokeText":
                        t.color = e;
                        break;
                    case"FillBorderText":
                    case"FillBorderWords":
                    case"FillBorderText":
                        t.fillColor = e
                }
            }, e.loadImage = function (t, e, i, n, r, s) {
                void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = 0);
                var a = De.getRes(t);
                a ? a.getIsReady() ? this.drawImage(a, e, i, n, r) : a.once("ready", this, this.drawImage, [a, e, i, n, r]) : ((a = new Ie).load(t), De.cacheRes(t, a), a.once("ready", this, this.drawImage, [a, e, i, n, r])), null != s && (a.getIsReady() ? s.call(this._sp) : a.on("ready", this._sp, s))
            }, e._renderEmpty = function (t, e, i, n) {
            }, e._renderAll = function (t, e, i, n) {
                for (var r = this._cmds, s = 0, a = r.length; s < a; s++) r[s].run(e, i, n)
            }, e._renderOne = function (t, e, i, n) {
                e.sprite = t, this._one.run(e, i, n)
            }, e._renderOneImg = function (t, e, i, n) {
                e.sprite = t, this._one.run(e, i, n)
            }, e.drawLine = function (t, e, i, n, r, s) {
                void 0 === s && (s = 1);
                var a = s < 1 || s % 2 == 0 ? 0 : .5;
                return this._saveToCmd(Rt._context._drawLine, nt.create.call(this, t + a, e + a, i + a, n + a, r, s, 0))
            }, e.drawLines = function (t, e, i, n, r) {
                if (void 0 === r && (r = 1), !i || i.length < 4) return null;
                var s = r < 1 || r % 2 == 0 ? 0 : .5;
                return this._saveToCmd(Rt._context._drawLines, re.create.call(this, t + s, e + s, i, n, r, 0))
            }, e.drawCurves = function (t, e, i, n, r) {
                return void 0 === r && (r = 1), this._saveToCmd(Rt._context.drawCurves, oe.create.call(this, t, e, i, n, r))
            }, e.drawRect = function (t, e, i, n, r, s, a) {
                void 0 === a && (a = 1);
                var o = 1 <= a && s ? a / 2 : 0, h = s ? a : 0;
                return this._saveToCmd(Rt._context.drawRect, K.create.call(this, t + o, e + o, i - h, n - h, r, s, a))
            }, e.drawCircle = function (t, e, i, n, r, s) {
                void 0 === s && (s = 1);
                var a = 1 <= s && r ? s / 2 : 0;
                return this._saveToCmd(Rt._context._drawCircle, ut.create.call(this, t, e, i - a, n, r, s, 0))
            }, e.drawPie = function (t, e, i, n, r, s, a, o) {
                void 0 === o && (o = 1);
                var h = 1 <= o && a ? o / 2 : 0, l = a ? o : 0;
                return this._saveToCmd(Rt._context._drawPie, w.create.call(this, t + h, e + h, i - l, ne.toRadian(n), ne.toRadian(r), s, a, o, 0))
            }, e.drawPoly = function (t, e, i, n, r, s) {
                void 0 === s && (s = 1);
                var a = !1;
                a = !(6 < i.length);
                var o = 1 <= s && r ? s % 2 == 0 ? 0 : .5 : 0;
                return this._saveToCmd(Rt._context._drawPoly, N.create.call(this, t + o, e + o, i, n, r, s, a, 0))
            }, e.drawPath = function (t, e, i, n, r) {
                return this._saveToCmd(Rt._context._drawPath, xt.create.call(this, t, e, i, n, r))
            }, e.draw9Grid = function (t, e, i, n, r, s) {
                void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = 0), this._saveToCmd(null, kt.create(t, e, i, n, r, s))
            }, d(0, e, "cmds", function () {
                return this._cmds
            }, function (t) {
                this._sp && (this._sp._renderType |= 512, this._sp._setRenderType(this._sp._renderType)), this._cmds = t, this._render = this._renderAll, this._repaint()
            }), t
        }(), Zt = (function () {
            function r() {
                this.reset()
            }

            x(r, "laya.utils.HTMLChar");
            var t = r.prototype;
            t.setData = function (t, e, i, n) {
                return this.char = t, this.charNum = t.charCodeAt(0), this.x = this.y = 0, this.width = e, this.height = i, this.style = n, this.isWord = !r._isWordRegExp.test(t), this
            }, t.reset = function () {
                return this.x = this.y = this.width = this.height = 0, this.isWord = !1, this.char = null, this.charNum = 0, this.style = null, this
            }, t.recover = function () {
                W.recover("HTMLChar", this.reset())
            }, t._isChar = function () {
                return !0
            }, t._getCSSStyle = function () {
                return this.style
            }, r.create = function () {
                return W.getItemByClass("HTMLChar", r)
            }, r._isWordRegExp = new RegExp("[\\w.]", "")
        }(), function () {
            function t(t, e, i) {
                this.atlasID = 0, this._width = 0, this._height = 0, this._texCount = 0, this._rowInfo = null, this._cells = null, void (this._used = 0) === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), this._cells = null, this._rowInfo = null, this.atlasID = i, this._init(t, e)
            }

            x(t, "laya.webgl.text.AtlasGrid");
            var e = t.prototype;
            return e.addRect = function (t, e, i, n) {
                return !!this._get(e, i, n) && (this._fill(n.x, n.y, e, i, t), this._texCount++, !0)
            }, e._release = function () {
                this._cells = null, this._rowInfo = null
            }, e._init = function (t, e) {
                return this._width = t, this._height = e, this._release(), 0 != this._width && (this._cells = new Uint8Array(this._width * this._height * 3), this._rowInfo = new Uint8Array(this._height), this._used = 0, this._clear(), !0)
            }, e._get = function (t, e, i) {
                if (t > this._width || e > this._height) return !1;
                for (var n = -1, r = -1, s = this._width, a = this._height, o = this._cells, h = 0; h < a; h++) if (!(this._rowInfo[h] < t)) for (var l = 0; l < s;) {
                    var u = 3 * (h * s + l);
                    if (0 != o[u] || o[u + 1] < t || o[u + 2] < e) l += o[u + 1]; else {
                        n = l, r = h;
                        for (var c = 0; c < t; c++) if (o[3 * c + u + 2] < e) {
                            n = -1;
                            break
                        }
                        if (!(n < 0)) return i.x = n, i.y = r, !0;
                        l += o[u + 1]
                    }
                }
                return !1
            }, e._fill = function (t, e, i, n, r) {
                var s = this._width, a = this._height;
                this._check(t + i <= s && e + n <= a);
                for (var o = e; o < n + e; ++o) {
                    this._check(this._rowInfo[o] >= i), this._rowInfo[o] -= i;
                    for (var h = 0; h < i; h++) {
                        var l = 3 * (t + o * s + h);
                        this._check(0 == this._cells[l]), this._cells[l] = r, this._cells[l + 1] = i, this._cells[l + 2] = n
                    }
                }
                if (0 < t) for (o = 0; o < n; ++o) {
                    var u = 0;
                    for (h = t - 1; 0 <= h && 0 == this._cells[3 * ((e + o) * s + h)]; --h, ++u) ;
                    for (h = u; 0 < h; --h) this._cells[3 * ((e + o) * s + t - h) + 1] = h, this._check(0 < h)
                }
                if (0 < e) for (h = t; h < t + i; ++h) {
                    for (u = 0, o = e - 1; 0 <= o && 0 == this._cells[3 * (h + o * s)]; --o, u++) ;
                    for (o = u; 0 < o; --o) this._cells[3 * (h + (e - o) * s) + 2] = o, this._check(0 < o)
                }
                this._used += i * n / (this._width * this._height)
            }, e._check = function (t) {
            }, e._clear = function () {
                for (var t = this._texCount = 0; t < this._height; t++) this._rowInfo[t] = this._width;
                for (var e = 0; e < this._height; e++) for (var i = 0; i < this._width; i++) {
                    var n = 3 * (e * this._width + i);
                    this._cells[n] = 0, this._cells[n + 1] = this._width - i, this._cells[n + 2] = this._width - e
                }
            }, t
        }()), Jt = function () {
            function h() {
            }

            x(h, "laya.display.cmd.StrokeTextCmd");
            var t = h.prototype;
            return t.recover = function () {
                W.recover("StrokeTextCmd", this)
            }, t.run = function (t, e, i) {
                t.strokeWord(this.text, this.x + e, this.y + i, this.font, this.color, this.lineWidth, this.textAlign)
            }, d(0, t, "cmdID", function () {
                return "StrokeText"
            }), h.create = function (t, e, i, n, r, s, a) {
                var o = W.getItemByClass("StrokeTextCmd", h);
                return o.text = t, o.x = e, o.y = i, o.font = n, o.color = r, o.lineWidth = s, o.textAlign = a, o
            }, h.ID = "StrokeText", h
        }(), te = function () {
            function t() {
            }

            x(t, "laya.webgl.text.ICharRender");
            var e = t.prototype;
            return e.getWidth = function (t, e) {
                return 0
            }, e.scale = function (t, e) {
            }, e.getCharBmp = function (t, e, i, n, r, s, a, o, h, l, u) {
                return null
            }, d(0, e, "canvasWidth", function () {
                return 0
            }, function (t) {
            }), t
        }(), ee = function () {
            function o() {
            }

            return x(o, "laya.utils.Ease"), o.linearNone = function (t, e, i, n) {
                return i * t / n + e
            }, o.linearIn = function (t, e, i, n) {
                return i * t / n + e
            }, o.linearInOut = function (t, e, i, n) {
                return i * t / n + e
            }, o.linearOut = function (t, e, i, n) {
                return i * t / n + e
            }, o.bounceIn = function (t, e, i, n) {
                return i - o.bounceOut(n - t, 0, i, n) + e
            }, o.bounceInOut = function (t, e, i, n) {
                return t < .5 * n ? .5 * o.bounceIn(2 * t, 0, i, n) + e : .5 * o.bounceOut(2 * t - n, 0, i, n) + .5 * i + e
            }, o.bounceOut = function (t, e, i, n) {
                return (t /= n) < 1 / 2.75 ? i * (7.5625 * t * t) + e : t < 2 / 2.75 ? i * (7.5625 * (t -= 1.5 / 2.75) * t + .75) + e : t < 2.5 / 2.75 ? i * (7.5625 * (t -= 2.25 / 2.75) * t + .9375) + e : i * (7.5625 * (t -= 2.625 / 2.75) * t + .984375) + e
            }, o.backIn = function (t, e, i, n, r) {
                return void 0 === r && (r = 1.70158), i * (t /= n) * t * ((r + 1) * t - r) + e
            }, o.backInOut = function (t, e, i, n, r) {
                return void 0 === r && (r = 1.70158), (t /= .5 * n) < 1 ? .5 * i * (t * t * ((1 + (r *= 1.525)) * t - r)) + e : i / 2 * ((t -= 2) * t * ((1 + (r *= 1.525)) * t + r) + 2) + e
            }, o.backOut = function (t, e, i, n, r) {
                return void 0 === r && (r = 1.70158), i * ((t = t / n - 1) * t * ((r + 1) * t + r) + 1) + e
            }, o.elasticIn = function (t, e, i, n, r, s) {
                var a;
                return void 0 === r && (r = 0), void 0 === s && (s = 0), 0 == t ? e : 1 == (t /= n) ? e + i : (s || (s = .3 * n), a = !r || 0 < i && r < i || i < 0 && r < -i ? (r = i, s / 4) : s / o.PI2 * Math.asin(i / r), -r * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * n - a) * o.PI2 / s) + e)
            }, o.elasticInOut = function (t, e, i, n, r, s) {
                var a;
                return void 0 === r && (r = 0), void 0 === s && (s = 0), 0 == t ? e : 2 == (t /= .5 * n) ? e + i : (s || (s = n * (.3 * 1.5)), a = !r || 0 < i && r < i || i < 0 && r < -i ? (r = i, s / 4) : s / o.PI2 * Math.asin(i / r), t < 1 ? r * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * n - a) * o.PI2 / s) * -.5 + e : r * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * n - a) * o.PI2 / s) * .5 + i + e)
            }, o.elasticOut = function (t, e, i, n, r, s) {
                var a;
                return void 0 === r && (r = 0), void 0 === s && (s = 0), 0 == t ? e : 1 == (t /= n) ? e + i : (s || (s = .3 * n), a = !r || 0 < i && r < i || i < 0 && r < -i ? (r = i, s / 4) : s / o.PI2 * Math.asin(i / r), r * Math.pow(2, -10 * t) * Math.sin((t * n - a) * o.PI2 / s) + i + e)
            }, o.strongIn = function (t, e, i, n) {
                return i * (t /= n) * t * t * t * t + e
            }, o.strongInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * i * t * t * t * t * t + e : .5 * i * ((t -= 2) * t * t * t * t + 2) + e
            }, o.strongOut = function (t, e, i, n) {
                return i * ((t = t / n - 1) * t * t * t * t + 1) + e
            }, o.sineInOut = function (t, e, i, n) {
                return .5 * -i * (Math.cos(Math.PI * t / n) - 1) + e
            }, o.sineIn = function (t, e, i, n) {
                return -i * Math.cos(t / n * o.HALF_PI) + i + e
            }, o.sineOut = function (t, e, i, n) {
                return i * Math.sin(t / n * o.HALF_PI) + e
            }, o.quintIn = function (t, e, i, n) {
                return i * (t /= n) * t * t * t * t + e
            }, o.quintInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * i * t * t * t * t * t + e : .5 * i * ((t -= 2) * t * t * t * t + 2) + e
            }, o.quintOut = function (t, e, i, n) {
                return i * ((t = t / n - 1) * t * t * t * t + 1) + e
            }, o.quartIn = function (t, e, i, n) {
                return i * (t /= n) * t * t * t + e
            }, o.quartInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * i * t * t * t * t + e : .5 * -i * ((t -= 2) * t * t * t - 2) + e
            }, o.quartOut = function (t, e, i, n) {
                return -i * ((t = t / n - 1) * t * t * t - 1) + e
            }, o.cubicIn = function (t, e, i, n) {
                return i * (t /= n) * t * t + e
            }, o.cubicInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * i * t * t * t + e : .5 * i * ((t -= 2) * t * t + 2) + e
            }, o.cubicOut = function (t, e, i, n) {
                return i * ((t = t / n - 1) * t * t + 1) + e
            }, o.quadIn = function (t, e, i, n) {
                return i * (t /= n) * t + e
            }, o.quadInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * i * t * t + e : .5 * -i * (--t * (t - 2) - 1) + e
            }, o.quadOut = function (t, e, i, n) {
                return -i * (t /= n) * (t - 2) + e
            }, o.expoIn = function (t, e, i, n) {
                return 0 == t ? e : i * Math.pow(2, 10 * (t / n - 1)) + e - .001 * i
            }, o.expoInOut = function (t, e, i, n) {
                return 0 == t ? e : t == n ? e + i : (t /= .5 * n) < 1 ? .5 * i * Math.pow(2, 10 * (t - 1)) + e : .5 * i * (2 - Math.pow(2, -10 * --t)) + e
            }, o.expoOut = function (t, e, i, n) {
                return t == n ? e + i : i * (1 - Math.pow(2, -10 * t / n)) + e
            }, o.circIn = function (t, e, i, n) {
                return -i * (Math.sqrt(1 - (t /= n) * t) - 1) + e
            }, o.circInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * -i * (Math.sqrt(1 - t * t) - 1) + e : .5 * i * (Math.sqrt(1 - (t -= 2) * t) + 1) + e
            }, o.circOut = function (t, e, i, n) {
                return i * Math.sqrt(1 - (t = t / n - 1) * t) + e
            }, o.HALF_PI = .5 * Math.PI, o.PI2 = 2 * Math.PI, o
        }(), ie = (function () {
            function n() {
                this.sign = null, this.maxCount = 1e3
            }

            x(n, "laya.utils.PoolCache");
            var t = n.prototype;
            t.getCacheList = function () {
                return W.getPoolBySign(this.sign)
            }, t.tryDispose = function (t) {
                var e;
                (e = W.getPoolBySign(this.sign)).length > this.maxCount && e.splice(this.maxCount, e.length - this.maxCount)
            }, n.addPoolCacheManager = function (t, e) {
                var i;
                void 0 === e && (e = 100), (i = new n).sign = t, i.maxCount = e, Z.regCacheByFunction(ne.bind(i.tryDispose, i), ne.bind(i.getCacheList, i))
            }
        }(), function () {
            function h() {
            }

            x(h, "laya.webgl.utils.MatirxArray"), h.ArrayMul = function (t, e, i) {
                if (t) if (e) for (var n = NaN, r = NaN, s = NaN, a = NaN, o = 0; o < 4; o++) n = t[o], r = t[o + 4], s = t[o + 8], a = t[o + 12], i[o] = n * e[0] + r * e[1] + s * e[2] + a * e[3], i[o + 4] = n * e[4] + r * e[5] + s * e[6] + a * e[7], i[o + 8] = n * e[8] + r * e[9] + s * e[10] + a * e[11], i[o + 12] = n * e[12] + r * e[13] + s * e[14] + a * e[15]; else h.copyArray(t, i); else h.copyArray(e, i)
            }, h.copyArray = function (t, e) {
                if (t && e) for (var i = 0; i < t.length; i++) e[i] = t[i]
            }
        }(), function () {
            function e() {
            }

            x(e, "laya.utils.Mouse"), d(1, e, "cursor", function () {
                return e._style.cursor
            }, function (t) {
                e._style.cursor = t
            }), e.hide = function () {
                "none" != e.cursor && (e._preCursor = e.cursor, e.cursor = "none")
            }, e.show = function () {
                "none" == e.cursor && (e.cursor = e._preCursor ? e._preCursor : "auto")
            }, e._preCursor = null, a(e, ["_style", function () {
                return this._style = Lt.document.body.style
            }])
        }(), function () {
            function t() {
            }

            return x(t, "laya.webgl.VertexArrayObject"), t
        }()(function () {
            var r = {};

            function c(t, e) {
                var i;
                r[t] = !0, void 0 !== e && (i = e, m.console && m.console.error && m.console.error(i))
            }

            var i = function t(e) {
                var i = e.gl;
                this.ext = e, this.isAlive = !0, this.hasBeenBound = !1, this.elementArrayBuffer = null, this.attribs = new Array(e.maxVertexAttribs);
                for (var n = 0; n < this.attribs.length; n++) {
                    var r = new t.VertexAttrib(i);
                    this.attribs[n] = r
                }
                this.maxAttrib = 0
            };
            (i.VertexAttrib = function (t) {
                this.enabled = !1, this.buffer = null, this.size = 4, this.type = t.FLOAT, this.normalized = !1, this.stride = 16, this.offset = 0, this.cached = "", this.recache()
            }).prototype.recache = function () {
                this.cached = [this.size, this.type, this.normalized, this.stride, this.offset].join(":")
            };
            var n = function (n) {
                var e, i, h = this;
                this.gl = n, i = (e = n).getError, e.getError = function () {
                    for (; (t = i.apply(e)) != e.NO_ERROR && (r[t] = !0), t != e.NO_ERROR;) ;
                    for (var t in r) if (r[t]) return delete r[t], parseInt(t);
                    return e.NO_ERROR
                };
                var l = this.original = {
                    getParameter: n.getParameter,
                    enableVertexAttribArray: n.enableVertexAttribArray,
                    disableVertexAttribArray: n.disableVertexAttribArray,
                    bindBuffer: n.bindBuffer,
                    getVertexAttrib: n.getVertexAttrib,
                    vertexAttribPointer: n.vertexAttribPointer
                };
                n.getParameter = function (t) {
                    return t == h.VERTEX_ARRAY_BINDING_OES ? h.currentVertexArrayObject == h.defaultVertexArrayObject ? null : h.currentVertexArrayObject : l.getParameter.apply(this, arguments)
                }, n.enableVertexAttribArray = function (t) {
                    var e = h.currentVertexArrayObject;
                    return e.maxAttrib = Math.max(e.maxAttrib, t), e.attribs[t].enabled = !0, l.enableVertexAttribArray.apply(this, arguments)
                }, n.disableVertexAttribArray = function (t) {
                    var e = h.currentVertexArrayObject;
                    return e.maxAttrib = Math.max(e.maxAttrib, t), e.attribs[t].enabled = !1, l.disableVertexAttribArray.apply(this, arguments)
                }, n.bindBuffer = function (t, e) {
                    switch (t) {
                        case n.ARRAY_BUFFER:
                            h.currentArrayBuffer = e;
                            break;
                        case n.ELEMENT_ARRAY_BUFFER:
                            h.currentVertexArrayObject.elementArrayBuffer = e
                    }
                    return l.bindBuffer.apply(this, arguments)
                }, n.getVertexAttrib = function (t, e) {
                    var i = h.currentVertexArrayObject.attribs[t];
                    switch (e) {
                        case n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:
                            return i.buffer;
                        case n.VERTEX_ATTRIB_ARRAY_ENABLED:
                            return i.enabled;
                        case n.VERTEX_ATTRIB_ARRAY_SIZE:
                            return i.size;
                        case n.VERTEX_ATTRIB_ARRAY_STRIDE:
                            return i.stride;
                        case n.VERTEX_ATTRIB_ARRAY_TYPE:
                            return i.type;
                        case n.VERTEX_ATTRIB_ARRAY_NORMALIZED:
                            return i.normalized;
                        default:
                            return l.getVertexAttrib.apply(this, arguments)
                    }
                }, n.vertexAttribPointer = function (t, e, i, n, r, s) {
                    var a = h.currentVertexArrayObject;
                    a.maxAttrib = Math.max(a.maxAttrib, t);
                    var o = a.attribs[t];
                    return o.buffer = h.currentArrayBuffer, o.size = e, o.type = i, o.normalized = n, o.stride = r, o.offset = s, o.recache(), l.vertexAttribPointer.apply(this, arguments)
                }, n.instrumentExtension && n.instrumentExtension(this, "OES_vertex_array_object"), n.canvas && n.canvas.addEventListener && n.canvas.addEventListener("webglcontextrestored", function () {
                    var t;
                    t = "OESVertexArrayObject emulation library context restored", m.console && m.console.log && m.console.log(t), h.reset_()
                }, !0), this.reset_()
            };
            n.prototype.VERTEX_ARRAY_BINDING_OES = 34229, n.prototype.reset_ = function () {
                if (void 0 !== this.vertexArrayObjects) for (var t = 0; t < this.vertexArrayObjects.length; ++t) this.vertexArrayObjects.isAlive = !1;
                var e = this.gl;
                this.maxVertexAttribs = e.getParameter(e.MAX_VERTEX_ATTRIBS), this.defaultVertexArrayObject = new i(this), this.currentVertexArrayObject = null, this.currentArrayBuffer = null, this.vertexArrayObjects = [this.defaultVertexArrayObject], this.bindVertexArrayOES(null)
            }, n.prototype.createVertexArrayOES = function () {
                var t = new i(this);
                return this.vertexArrayObjects.push(t), t
            }, n.prototype.deleteVertexArrayOES = function (t) {
                t.isAlive = !1, this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t), 1), this.currentVertexArrayObject == t && this.bindVertexArrayOES(null)
            }, n.prototype.isVertexArrayOES = function (t) {
                return !!(t && t instanceof i && t.hasBeenBound && t.ext == this)
            }, n.prototype.bindVertexArrayOES = function (t) {
                var e = this.gl;
                if (!t || t.isAlive) {
                    var i = this.original, n = this.currentVertexArrayObject;
                    this.currentVertexArrayObject = t || this.defaultVertexArrayObject, this.currentVertexArrayObject.hasBeenBound = !0;
                    var r = this.currentVertexArrayObject;
                    if (n != r) {
                        n && r.elementArrayBuffer == n.elementArrayBuffer || i.bindBuffer.call(e, e.ELEMENT_ARRAY_BUFFER, r.elementArrayBuffer);
                        for (var s = this.currentArrayBuffer, a = Math.max(n ? n.maxAttrib : 0, r.maxAttrib), o = 0; o <= a; o++) {
                            var h = r.attribs[o], l = n ? n.attribs[o] : null;
                            if (n && h.enabled == l.enabled || (h.enabled ? i.enableVertexAttribArray.call(e, o) : i.disableVertexAttribArray.call(e, o)), h.enabled) {
                                var u = !1;
                                n && h.buffer == l.buffer || (s != h.buffer && (i.bindBuffer.call(e, e.ARRAY_BUFFER, h.buffer), s = h.buffer), u = !0), (u || h.cached != l.cached) && i.vertexAttribPointer.call(e, o, h.size, h.type, h.normalized, h.stride, h.offset)
                            }
                        }
                        this.currentArrayBuffer != s && i.bindBuffer.call(e, e.ARRAY_BUFFER, this.currentArrayBuffer)
                    }
                } else c(e.INVALID_OPERATION, "bindVertexArrayOES: attempt to bind deleted arrayObject")
            }, m._setupVertexArrayObject = function (t) {
                var e = t.getSupportedExtensions;
                t.getSupportedExtensions = function () {
                    var t = e.call(this) || [];
                    return t.indexOf("OES_vertex_array_object") < 0 && t.push("OES_vertex_array_object"), t
                };
                var i = t.getExtension;
                t.getExtension = function (t) {
                    var e = i.call(this, t);
                    return e || ("OES_vertex_array_object" !== t ? null : (this.__OESVertexArrayObject || (this.__OESVertexArrayObject = new n(this)), this.__OESVertexArrayObject))
                }
            }, m._forceSetupVertexArrayObject = function (t) {
                var e = t.getSupportedExtensions;
                t.getSupportedExtensions = function () {
                    var t = e.call(this) || [];
                    return t.indexOf("OES_vertex_array_object") < 0 && t.push("OES_vertex_array_object"), t
                };
                var i = t.getExtension;
                t.getExtension = function (t) {
                    if ("OES_vertex_array_object" === t) return this.__OESVertexArrayObject || (this.__OESVertexArrayObject = new n(this)), this.__OESVertexArrayObject;
                    var e = i.call(this, t);
                    return e || null
                }
            }
        }()), function () {
            function s() {
            }

            return x(s, "laya.resource.WebGLRTMgr"), s.getRT = function (t, e) {
                var i, n = 1e4 * (e |= 0) + (t |= 0), r = s.dict[n];
                return r && 0 < r.length ? (i = r.pop())._mgrKey = n : (i = new fi(t, e, 1, -1))._mgrKey = n, i
            }, s.releaseRT = function (t) {
                if (!(t._mgrKey <= 0)) {
                    var e = s.dict[t._mgrKey];
                    !e && (e = [], s.dict[t._mgrKey] = e), t._mgrKey = 0, e.push(t)
                }
            }, s.dict = {}, s
        }()), ne = function () {
            function o() {
            }

            return x(o, "laya.utils.Utils"), o.toRadian = function (t) {
                return t * o._pi2
            }, o.toAngle = function (t) {
                return t * o._pi
            }, o.toHexColor = function (t) {
                if (t < 0 || isNaN(t)) return null;
                for (var e = t.toString(16); e.length < 6;) e = "0" + e;
                return "#" + e
            }, o.getGID = function () {
                return o._gid++
            }, o.concatArray = function (t, e) {
                if (!e) return t;
                if (!t) return e;
                var i = 0, n = e.length;
                for (i = 0; i < n; i++) t.push(e[i]);
                return t
            }, o.clearArray = function (t) {
                return t && (t.length = 0), t
            }, o.copyArray = function (t, e) {
                if (t || (t = []), !e) return t;
                t.length = e.length;
                var i = 0, n = e.length;
                for (i = 0; i < n; i++) t[i] = e[i];
                return t
            }, o.getGlobalRecByPoints = function (t, e, i, n, r) {
                var s, a;
                s = Ht.create().setTo(e, i), s = t.localToGlobal(s), a = Ht.create().setTo(n, r), a = t.localToGlobal(a);
                var o = gt._getWrapRec([s.x, s.y, a.x, a.y]);
                return s.recover(), a.recover(), o
            }, o.getGlobalPosAndScale = function (t) {
                return o.getGlobalRecByPoints(t, 0, 0, 1, 1)
            }, o.bind = function (t, e) {
                return t.bind(e)
            }, o.measureText = function (t, e) {
                return ce.measureText(t, e)
            }, o.updateOrder = function (t) {
                if (!t || t.length < 2) return !1;
                for (var e, i = 1, n = 0, r = t.length, s = NaN; i < r;) {
                    for (e = t[n = i], s = t[n]._zOrder; -1 < --n && t[n]._zOrder > s;) t[n + 1] = t[n];
                    t[n + 1] = e, i++
                }
                return !0
            }, o.transPointList = function (t, e, i) {
                var n = 0, r = t.length;
                for (n = 0; n < r; n += 2) t[n] += e, t[n + 1] += i
            }, o.parseInt = function (t, e) {
                void 0 === e && (e = 0);
                var i = Lt.window.parseInt(t, e);
                return isNaN(i) ? 0 : i
            }, o.getFileExtension = function (t) {
                o._extReg.lastIndex = t.lastIndexOf(".");
                var e = o._extReg.exec(t);
                return e && 1 < e.length ? e[1].toLowerCase() : null
            }, o.getTransformRelativeToWindow = function (t, e, i) {
                var n = y.stage, r = laya.utils.Utils.getGlobalPosAndScale(t), s = n._canvasTransform.clone(), a = s.tx,
                    o = s.ty;
                s.rotate(-Math.PI / 180 * y.stage.canvasDegree), s.scale(y.stage.clientScaleX, y.stage.clientScaleY);
                var h = y.stage.canvasDegree % 180 != 0, l = NaN, u = NaN;
                h ? (l = i + r.y, u = e + r.x, l *= s.d, u *= s.a, 90 == y.stage.canvasDegree ? (l = a - l, u += o) : (l += a, u = o - u)) : (l = e + r.x, u = i + r.y, l *= s.a, u *= s.d, l += a, u += o), u += y.stage._safariOffsetY;
                var c = NaN, _ = NaN;
                return _ = h ? (c = s.d * r.height, s.a * r.width) : (c = s.a * r.width, s.d * r.height), {
                    x: l,
                    y: u,
                    scaleX: c,
                    scaleY: _
                }
            }, o.fitDOMElementInArea = function (t, e, i, n, r, s) {
                t._fitLayaAirInitialized || (t._fitLayaAirInitialized = !0, t.style.transformOrigin = t.style.webKittransformOrigin = "left top", t.style.position = "absolute");
                var a = o.getTransformRelativeToWindow(e, i, n);
                t.style.transform = t.style.webkitTransform = "scale(" + a.scaleX + "," + a.scaleY + ") rotate(" + y.stage.canvasDegree + "deg)", t.style.width = r + "px", t.style.height = s + "px", t.style.left = a.x + "px", t.style.top = a.y + "px"
            }, o.isOkTextureList = function (t) {
                if (!t) return !1;
                var e, i = 0, n = t.length;
                for (i = 0; i < n; i++) if (!(e = t[i]) || !e._getSource()) return !1;
                return !0
            }, o.isOKCmdList = function (t) {
                if (!t) return !1;
                var e = 0, i = t.length;
                for (e = 0; e < i; e++) t[e];
                return !0
            }, o.getQueryString = function (t) {
                if (Lt.onMiniGame) return null;
                if (!m.location || !m.location.search) return null;
                var e = new RegExp("(^|&)" + t + "=([^&]*)(&|$)"), i = m.location.search.substr(1).match(e);
                return null != i ? unescape(i[2]) : null
            }, o._gid = 1, o._pi = 180 / Math.PI, o._pi2 = Math.PI / 180, o._extReg = /\.(\w+)\??/g, o.parseXMLFromString = function (t) {
                var e;
                if (t = t.replace(/>\s+</g, "><"), -1 < (e = (new DOMParser).parseFromString(t, "text/xml")).firstChild.textContent.indexOf("This page contains the following errors")) throw new Error(e.firstChild.firstChild.textContent);
                return e
            }, o
        }(), re = (function () {
            function n() {
            }

            x(n, "laya.webgl.text.ArabicReshaper");
            var t = n.prototype;
            t.characterMapContains = function (t) {
                for (var e = 0; e < n.charsMap.length; ++e) if (n.charsMap[e][0] === t) return !0;
                return !1
            }, t.getCharRep = function (t) {
                for (var e = 0; e < n.charsMap.length; ++e) if (n.charsMap[e][0] === t) return n.charsMap[e];
                return !1
            }, t.getCombCharRep = function (t, e) {
                for (var i = 0; i < n.combCharsMap.length; ++i) if (n.combCharsMap[i][0][0] === t && n.combCharsMap[i][0][1] === e) return n.combCharsMap[i];
                return !1
            }, t.isTransparent = function (t) {
                for (var e = 0; e < n.transChars.length; ++e) if (n.transChars[e] === t) return !0;
                return !1
            }, t.getOriginalCharsFromCode = function (t) {
                var e = 0;
                for (e = 0; e < n.charsMap.length; ++e) if (-1 < n.charsMap[e].indexOf(t)) return String.fromCharCode(n.charsMap[e][0]);
                for (e = 0; e < n.combCharsMap.length; ++e) if (-1 < n.combCharsMap[e].indexOf(t)) return String.fromCharCode(n.combCharsMap[e][0][0]) + String.fromCharCode(n.combCharsMap[e][0][1]);
                return String.fromCharCode(t)
            }, t.convertArabic = function (t) {
                for (var e, i, n = "", r = 0; r < t.length; ++r) {
                    var s = t.charCodeAt(r);
                    if (this.characterMapContains(s)) {
                        for (var a = null, o = null, h = r - 1, l = r + 1; 0 <= h && this.isTransparent(t.charCodeAt(h)); --h) ;
                        for ((!(e = !!(a = 0 <= h ? t.charCodeAt(h) : null) && this.getCharRep(a)) || null == e[2] && null == e[3]) && (a = null); l < t.length && this.isTransparent(t.charCodeAt(l)); ++l) ;
                        if ((!(e = !!(o = l < t.length ? t.charCodeAt(l) : null) && this.getCharRep(o)) || null == e[3] && null == e[4]) && (o = null), 1604 === s && null != o && (1570 === o || 1571 === o || 1573 === o || 1575 === o)) {
                            i = this.getCombCharRep(s, o), n += null != a ? String.fromCharCode(i[4]) : String.fromCharCode(i[1]), ++r;
                            continue
                        }
                        if (e = this.getCharRep(s), null != a && null != o && null != e[3]) {
                            n += String.fromCharCode(e[3]);
                            continue
                        }
                        if (null != a && null != e[4]) {
                            n += String.fromCharCode(e[4]);
                            continue
                        }
                        if (null != o && null != e[2]) {
                            n += String.fromCharCode(e[2]);
                            continue
                        }
                        n += String.fromCharCode(e[1])
                    } else n += String.fromCharCode(s)
                }
                return n
            }, t.convertArabicBack = function (t) {
                var e = "", i = 0, n = 0;
                for (n = 0; n < t.length; ++n) i = t.charCodeAt(n), e += this.getOriginalCharsFromCode(i);
                return e
            }, a(n, ["charsMap", function () {
                return this.charsMap = [[1569, 65152, null, null, null], [1570, 65153, null, null, 65154], [1571, 65155, null, null, 65156], [1572, 65157, null, null, 65158], [1573, 65159, null, null, 65160], [1574, 65161, 65163, 65164, 65162], [1575, 65165, null, null, 65166], [1576, 65167, 65169, 65170, 65168], [1577, 65171, null, null, 65172], [1578, 65173, 65175, 65176, 65174], [1579, 65177, 65179, 65180, 65178], [1580, 65181, 65183, 65184, 65182], [1581, 65185, 65187, 65188, 65186], [1582, 65189, 65191, 65192, 65190], [1583, 65193, null, null, 65194], [1584, 65195, null, null, 65196], [1585, 65197, null, null, 65198], [1586, 65199, null, null, 65200], [1587, 65201, 65203, 65204, 65202], [1588, 65205, 65207, 65208, 65206], [1589, 65209, 65211, 65212, 65210], [1590, 65213, 65215, 65216, 65214], [1591, 65217, 65219, 65220, 65218], [1592, 65221, 65223, 65224, 65222], [1593, 65225, 65227, 65228, 65226], [1594, 65229, 65231, 65232, 65230], [1600, 1600, 1600, 1600, 1600], [1601, 65233, 65235, 65236, 65234], [1602, 65237, 65239, 65240, 65238], [1603, 65241, 65243, 65244, 65242], [1604, 65245, 65247, 65248, 65246], [1605, 65249, 65251, 65252, 65250], [1606, 65253, 65255, 65256, 65254], [1607, 65257, 65259, 65260, 65258], [1608, 65261, null, null, 65262], [1609, 65263, null, null, 65264], [1610, 65265, 65267, 65268, 65266], [1662, 64342, 64344, 64345, 64343], [1740, 64508, 64510, 64511, 64509], [1670, 64378, 64380, 64381, 64379], [1705, 64398, 64400, 64401, 64399], [1711, 64402, 64404, 64405, 64403], [1688, 64394, null, null, 64395]]
            }, "combCharsMap", function () {
                return this.combCharsMap = [[[1604, 1570], 65269, null, null, 65270], [[1604, 1571], 65271, null, null, 65272], [[1604, 1573], 65273, null, null, 65274], [[1604, 1575], 65275, null, null, 65276]]
            }, "transChars", function () {
                return this.transChars = [1552, 1554, 1555, 1556, 1557, 1611, 1612, 1613, 1614, 1615, 1616, 1617, 1618, 1619, 1620, 1621, 1622, 1623, 1624, 1648, 1750, 1751, 1752, 1753, 1754, 1755, 1756, 1759, 1760, 1761, 1762, 1763, 1764, 1767, 1768, 1770, 1771, 1772, 1773]
            }])
        }(), function () {
            function o() {
            }

            x(o, "laya.display.cmd.DrawLinesCmd");
            var t = o.prototype;
            return t.recover = function () {
                this.points = null, this.lineColor = null, W.recover("DrawLinesCmd", this)
            }, t.run = function (t, e, i) {
                t._drawLines(this.x + e, this.y + i, this.points, this.lineColor, this.lineWidth, this.vid)
            }, d(0, t, "cmdID", function () {
                return "DrawLines"
            }), o.create = function (t, e, i, n, r, s) {
                var a = W.getItemByClass("DrawLinesCmd", o);
                return a.x = t, a.y = e, a.points = i, a.lineColor = n, a.lineWidth = r, a.vid = s, a
            }, o.ID = "DrawLines", o
        }()), se = function () {
            function a() {
                this._data = [], this._ndata = 0, this._tex = null, this._imgId = 0, this._clipid = -1, this._enbale = !1, this._colorFiler = null, this._clipMatrix = new at
            }

            x(a, "laya.webgl.text.CharSubmitCache");
            var t = a.prototype;
            return t.clear = function () {
                this._tex = null, this._imgId = -1, this._ndata = 0, this._enbale = !1, this._colorFiler = null
            }, t.destroy = function () {
                this.clear(), this._data.length = 0, this._data = null
            }, t.add = function (t, e, i, n, r, s) {
                0 < this._ndata && (this._tex != e || this._imgId != i || 0 <= this._clipid && this._clipid != t._clipInfoID) && this.submit(t), this._clipid = t._clipInfoID, t._globalClipMatrix.copyTo(this._clipMatrix), this._tex = e, this._imgId = i, this._colorFiler = t._colorFiler, this._data[this._ndata] = n, this._data[this._ndata + 1] = r, this._data[this._ndata + 2] = s, this._ndata += 3
            }, t.getPos = function () {
                return 0 == a.__nPosPool ? new Array(8) : a.__posPool[--a.__nPosPool]
            }, t.enable = function (t, e) {
                t !== this._enbale && (this._enbale = t, this._enbale || this.submit(e))
            }, t.submit = function (t) {
                var e = this._ndata;
                if (e) {
                    var i = t._mesh, n = t._colorFiler;
                    t._colorFiler = this._colorFiler;
                    var r = Te.create(t, i, Y.create(1, 0));
                    t._submits[t._submits._length++] = t._curSubmit = r, r.shaderValue.textureHost = this._tex, r._key.other = this._imgId, t._colorFiler = n, t._copyClipInfo(r, this._clipMatrix), r.clipInfoID = this._clipid;
                    for (var s = 0; s < e; s += 3) i.addQuad(this._data[s], this._data[s + 1], this._data[s + 2], !0), a.__posPool[a.__nPosPool++] = this._data[s];
                    e /= 3, r._numEle += 6 * e, i.indexNum += 6 * e, i.vertNum += 4 * e, t._drawCount += e, this._ndata = 0, M.loopCount % 100 == 0 && (this._data.length = 0)
                }
            }, a.__posPool = [], a.__nPosPool = 0, a
        }(), ae = function () {
            function t() {
            }

            return x(t, "Config"), t.animationInterval = 50, t.isAntialias = !1, t.isAlpha = !1, t.premultipliedAlpha = !0, t.isStencil = !0, t.preserveDrawingBuffer = !1, t.webGL2D_MeshAllocMaxMem = !0, t.is2DPixelArtGame = !1, t.useWebGL2 = !1, t.useRetinalCanvas = !1, t
        }(), oe = function () {
            function a() {
            }

            x(a, "laya.display.cmd.DrawCurvesCmd");
            var t = a.prototype;
            return t.recover = function () {
                this.points = null, this.lineColor = null, W.recover("DrawCurvesCmd", this)
            }, t.run = function (t, e, i) {
                t.drawCurves(this.x + e, this.y + i, this.points, this.lineColor, this.lineWidth)
            }, d(0, t, "cmdID", function () {
                return "DrawCurves"
            }), a.create = function (t, e, i, n, r) {
                var s = W.getItemByClass("DrawCurvesCmd", a);
                return s.x = t, s.y = e, s.points = i, s.lineColor = n, s.lineWidth = r, s
            }, a.ID = "DrawCurves", a
        }(), he = function () {
            function o() {
                this._textIsWorldText = !1, this._fontColor = 4294967295, this._strokeColor = 0, this._nTexAlign = 0, this._fontObj = o._defFontObj
            }

            x(o, "laya.display.cmd.FillTextCmd");
            var t = o.prototype;
            return t.recover = function () {
                W.recover("FillTextCmd", this)
            }, t.run = function (t, e, i) {
                y.stage.isGlobalRepaint() && this._textIsWorldText && this._text.cleanCache(), this._textIsWorldText ? t._fast_filltext(this._text, this.x + e, this.y + i, this._fontObj, this._color, null, 0, this._nTexAlign, 0) : t.drawText(this._text, this.x + e, this.y + i, this._font, this._color, this._textAlign)
            }, d(0, t, "text", function () {
                return this._text
            }, function (t) {
                this._text = t, this._textIsWorldText = t instanceof laya.utils.WordText, this._textIsWorldText && this._text.cleanCache()
            }), d(0, t, "cmdID", function () {
                return "FillText"
            }), d(0, t, "color", function () {
                return this._color
            }, function (t) {
                this._color = t, this._fontColor = p.create(t).numColor, this._textIsWorldText && this._text.cleanCache()
            }), d(0, t, "font", function () {
                return this._font
            }, function (t) {
                this._font = t, this._fontObj = pe.Parse(t), this._textIsWorldText && this._text.cleanCache()
            }), d(0, t, "textAlign", function () {
                return this._textAlign
            }, function (t) {
                switch (this._textAlign = t) {
                    case"center":
                        this._nTexAlign = ct.ENUM_TEXTALIGN_CENTER;
                        break;
                    case"right":
                        this._nTexAlign = ct.ENUM_TEXTALIGN_RIGHT;
                        break;
                    default:
                        this._nTexAlign = ct.ENUM_TEXTALIGN_DEFAULT
                }
                this._textIsWorldText && this._text.cleanCache()
            }), o.create = function (t, e, i, n, r, s) {
                var a = W.getItemByClass("FillTextCmd", o);
                return a.text = t, a._textIsWorldText = t instanceof laya.utils.WordText, a.x = e, a.y = i, a.font = n, a.color = r, a.textAlign = s, a
            }, o.ID = "FillText", a(o, ["_defFontObj", function () {
                return this._defFontObj = new pe(null)
            }]), o
        }(), le = (function () {
            function t() {
            }

            x(t, "laya.webgl.shader.ShaderValue")
        }(), function () {
            function t() {
            }

            x(t, "laya.events.KeyLocation"), t.STANDARD = 0, t.LEFT = 1, t.RIGHT = 2, t.NUM_PAD = 3
        }(), function () {
            function r() {
                this._clipInfoID = -1, this.incache = !1, this._globalClipMatrix = new at, this._clipRect = new gt
            }

            x(r, "laya.webgl.canvas.save.SaveClipRect");
            var t = r.prototype;
            return y.imps(t, {"laya.webgl.canvas.save.ISaveData": !0}), t.isSaveMark = function () {
                return !1
            }, t.restore = function (t) {
                this._globalClipMatrix.copyTo(t._globalClipMatrix), this._clipRect.clone(t._clipRect), t._clipInfoID = this._clipInfoID, r.POOL[r.POOL._length++] = this, t._clipInCache = this.incache
            }, r.save = function (t) {
                if (131072 != (131072 & t._saveMark._saveuse)) {
                    t._saveMark._saveuse |= 131072;
                    var e = r.POOL, i = 0 < e._length ? e[--e._length] : new r;
                    t._globalClipMatrix.copyTo(i._globalClipMatrix), t._clipRect.clone(i._clipRect), i._clipInfoID = t._clipInfoID, i.incache = t._clipInCache;
                    var n = t._save;
                    n[n._length++] = i
                }
            }, r.POOL = o._createArray(), r
        }()), ue = function () {
            function t() {
            }

            x(t, "laya.filters.GlowFilterGLRender");
            var e = t.prototype;
            return e.setShaderInfo = function (t, e, i, n) {
                t.defines.add(n.type);
                var r = t;
                r.u_blurInfo1 = n._sv_blurInfo1;
                var s = n._sv_blurInfo2;
                s[0] = e, s[1] = i, r.u_blurInfo2 = s, r.u_color = n.getColor()
            }, e.render = function (t, e, i, n, r) {
                var s = i, a = n, o = Y.create(1, 0);
                this.setShaderInfo(o, s, a, r);
                var h = Y.create(1, 0), l = at.TEMP.identity();
                e.drawTarget(t, 0, 0, s, a, l, o), e.drawTarget(t, 0, 0, s, a, l, h)
            }, t
        }(), ce = function () {
            function s() {
            }

            return x(s, "laya.utils.RunDriver"), s.createShaderCondition = function (t) {
                var e = "(function() {return " + t + ";})";
                return y._runScript(e)
            }, s.fontMap = [], s.measureText = function (t, e) {
                var i = s.hanzi.test(t);
                if (i && s.fontMap[e]) return s.fontMap[e];
                var n = Lt.context;
                n.font = e;
                var r = n.measureText(t);
                return i && (s.fontMap[e] = r), r
            }, s.drawToCanvas = function (t, e, i, n, r, s) {
                r -= t.x, s -= t.y, r |= 0, s |= 0, i |= 0, n |= 0;
                var a = new ct;
                a.size(i, n), a.asBitmap = !0, a._targets.start(), P.renders[e]._fun(t, a, r, s), a.flush(), a._targets.end(), a._targets.restore();
                var o = a._targets.getData(0, 0, i, n);
                a.destroy();
                for (var h = new ImageData(i, n), l = 4 * i, u = (new Uint8Array(l), h.data), c = n - 1, _ = c * l, f = 0; 0 <= c; c--) u.set(o.subarray(f, f + l), _), _ -= l, f += l;
                var d = new si(!0);
                return d.size(i, n), d.getContext("2d").putImageData(h, 0, 0), d
            }, s.drawToTexture = function (t, e, i, n, r, s) {
                r -= t.x, s -= t.y, r |= 0, s |= 0, i |= 0, n |= 0;
                var a = new ct;
                a.size(i, n), a.asBitmap = !0, a._targets.start(), P.renders[e]._fun(t, a, r, s), a.flush(), a._targets.end(), a._targets.restore();
                var o = new Ie(a._targets, Ie.INV_UV);
                return a.destroy(!0), o
            }, s.changeWebGLSize = function (t, e) {
                Ct.onStageResize(t, e)
            }, s.clear = function (t) {
                ct.set2DRenderConfig(), pt.worldScissorTest && Ct.mainContext.disable(3089);
                var e = Rt.context,
                    i = 0 == e._submits._length || ae.preserveDrawingBuffer ? p.create(t).arrColor : y.stage._wgColor;
                i ? e.clearBG(i[0], i[1], i[2], i[3]) : e.clearBG(0, 0, 0, 0), pt.clear()
            }, s.enableNative = null, a(s, ["hanzi", function () {
                return this.hanzi = new RegExp("^[一-龥]$")
            }]), s
        }(), _e = function () {
            function o() {
            }

            return x(o, "laya.net.AtlasInfoManager"), o.enable = function (t, e) {
                y.loader.load(t, b.create(null, o._onInfoLoaded, [e]), null, "json")
            }, o._onInfoLoaded = function (t, e) {
                var i, n, r, s = 0, a = 0;
                for (i in e) for (n = (r = e[i])[0], a = (r = r[1]).length, s = 0; s < a; s++) o._fileLoadDic[n + r[s]] = i;
                t && t.run()
            }, o.getFileLoadPath = function (t) {
                return o._fileLoadDic[t] || t
            }, o._fileLoadDic = {}, o
        }(), fe = function () {
            function e() {
            }

            return x(e, "laya.webgl.canvas.BlendMode"), e._init_ = function (t) {
                e.fns = [e.BlendNormal, e.BlendAdd, e.BlendMultiply, e.BlendScreen, e.BlendOverlay, e.BlendLight, e.BlendMask, e.BlendDestinationOut], e.targetFns = [e.BlendNormalTarget, e.BlendAddTarget, e.BlendMultiplyTarget, e.BlendScreenTarget, e.BlendOverlayTarget, e.BlendLightTarget, e.BlendMask, e.BlendDestinationOut]
            }, e.BlendNormal = function (t) {
                rt.setBlendFunc(t, 1, 771)
            }, e.BlendAdd = function (t) {
                rt.setBlendFunc(t, 1, 772)
            }, e.BlendMultiply = function (t) {
                rt.setBlendFunc(t, 774, 771)
            }, e.BlendScreen = function (t) {
                rt.setBlendFunc(t, 1, 1)
            }, e.BlendOverlay = function (t) {
                rt.setBlendFunc(t, 1, 769)
            }, e.BlendLight = function (t) {
                rt.setBlendFunc(t, 1, 1)
            }, e.BlendNormalTarget = function (t) {
                rt.setBlendFunc(t, 1, 771)
            }, e.BlendAddTarget = function (t) {
                rt.setBlendFunc(t, 1, 772)
            }, e.BlendMultiplyTarget = function (t) {
                rt.setBlendFunc(t, 774, 771)
            }, e.BlendScreenTarget = function (t) {
                rt.setBlendFunc(t, 1, 1)
            }, e.BlendOverlayTarget = function (t) {
                rt.setBlendFunc(t, 1, 769)
            }, e.BlendLightTarget = function (t) {
                rt.setBlendFunc(t, 1, 1)
            }, e.BlendMask = function (t) {
                rt.setBlendFunc(t, 0, 770)
            }, e.BlendDestinationOut = function (t) {
                rt.setBlendFunc(t, 0, 0)
            }, e.activeBlendFunction = null, e.NAMES = ["normal", "add", "multiply", "screen", "overlay", "light", "mask", "destination-out"], e.TOINT = {
                normal: 0,
                add: 1,
                multiply: 2,
                screen: 3,
                overlay: 4,
                light: 5,
                mask: 6,
                "destination-out": 7,
                lighter: 1
            }, e.NORMAL = "normal", e.ADD = "add", e.MULTIPLY = "multiply", e.SCREEN = "screen", e.OVERLAY = "overlay", e.LIGHT = "light", e.MASK = "mask", e.DESTINATIONOUT = "destination-out", e.LIGHTER = "lighter", e.fns = [], e.targetFns = [], e
        }(), de = function () {
            function r() {
            }

            x(r, "laya.display.cmd.RotateCmd");
            var t = r.prototype;
            return t.recover = function () {
                W.recover("RotateCmd", this)
            }, t.run = function (t, e, i) {
                t._rotate(this.angle, this.pivotX + e, this.pivotY + i)
            }, d(0, t, "cmdID", function () {
                return "Rotate"
            }), r.create = function (t, e, i) {
                var n = W.getItemByClass("RotateCmd", r);
                return n.angle = t, n.pivotX = e, n.pivotY = i, n
            }, r.ID = "Rotate", r
        }(), pe = function () {
            function i(t) {
                this._font = "14px Arial", this._family = "Arial", this._size = 14, this._italic = !1, this._bold = !1, this._id = i._gfontID++, this.setFont(t || this._font)
            }

            return x(i, "laya.utils.FontInfo"), i.prototype.setFont = function (t) {
                var e = (this._font = t).split(" "), i = e.length;
                if (i < 2) 1 == i && 0 < e[0].indexOf("px") && (this._size = parseInt(e[0])); else {
                    for (var n = -1, r = 0; r < i; r++) if (0 < e[r].indexOf("px") || 0 < e[r].indexOf("pt")) {
                        n = r, this._size = parseInt(e[r]), this._size <= 0 && (this._size = 14);
                        break
                    }
                    var s = n + 1, a = e[s];
                    for (s++; s < i; s++) a += " " + e[s];
                    this._family = a.split(",")[0], this._italic = 0 <= e.indexOf("italic"), this._bold = 0 <= e.indexOf("bold")
                }
            }, i.Parse = function (t) {
                if (t === i._lastFont) return i._lastFontInfo;
                var e = i._cache[t];
                return e || (e = i._cache[t] = new i(t)), i._lastFont = t, i._lastFontInfo = e
            }, i.EMPTY = new i(null), i._cache = {}, i._gfontID = 0, i._lastFont = "", i._lastFontInfo = null, i
        }(), me = function () {
            function v(t, e, i, n) {
                this._clearCR = new RegExp("\r", "g");
                var r = this;

                function s(t) {
                    t = t.replace(r._clearCR, "");
                    var e = [], i = new Xt(e);
                    return r._compileToTree(i, t.split("\n"), 0, e, n), i
                }

                Lt.now();
                this._VS = s(t), this._PS = s(e), this._nameMap = i, Lt.now()
            }

            x(v, "laya.webgl.utils.ShaderCompile");
            var t = v.prototype;
            return t._compileToTree = function (t, e, i, n, r) {
                var s, a, o, h, l, u, c, _ = 0, f = 0, d = 0, p = 0;
                for (f = i; f < e.length; f++) if (!((o = e[f]).length < 1) && 0 !== (_ = o.indexOf("//"))) {
                    if (0 <= _ && (o = o.substr(0, _)), s = c || new Xt(n), c = null, s.text = o, s.noCompile = !0, 0 <= (_ = o.indexOf("#"))) {
                        for (h = "#", p = _ + 1, d = o.length; p < d; p++) {
                            var m = o.charAt(p);
                            if (" " === m || "\t" === m || "?" === m) break;
                            h += m
                        }
                        switch (s.name = h) {
                            case"#ifdef":
                            case"#ifndef":
                                if (s.src = o, s.noCompile = null != o.match(/[!&|()=<>]/), s.noCompile || (u = o.replace(/^\s*/, "").split(/\s+/), s.setCondition(u[1], "#ifdef" === h ? 1 : 2), s.text = "//" + s.text), s.setParent(t), t = s, r) for (u = o.substr(p).split(v._splitToWordExps3), p = 0; p < u.length; p++) (o = u[p]).length && (r[o] = !0);
                                continue;
                            case"#if":
                                if (s.src = o, s.noCompile = !0, s.setParent(t), t = s, r) for (u = o.substr(p).split(v._splitToWordExps3), p = 0; p < u.length; p++) (o = u[p]).length && "defined" != o && (r[o] = !0);
                                continue;
                            case"#else":
                                s.src = o, a = (t = t.parent).childs[t.childs.length - 1], s.noCompile = a.noCompile, s.noCompile || (s.condition = a.condition, s.conditionType = 1 == a.conditionType ? 2 : 1, s.text = "//" + s.text + " " + a.text + " " + s.conditionType), s.setParent(t), t = s;
                                continue;
                            case"#endif":
                                a = (t = t.parent).childs[t.childs.length - 1], s.noCompile = a.noCompile, s.noCompile || (s.text = "//" + s.text), s.setParent(t);
                                continue;
                            case"#include":
                                u = v.splitToWords(o, null);
                                var g = v.includes[u[1]];
                                if (!g) throw"ShaderCompile error no this include file:" + u[1];
                                if ((_ = u[0].indexOf("?")) < 0) {
                                    s.setParent(t), o = g.getWith("with" == u[2] ? u[3] : null), this._compileToTree(s, o.split("\n"), 0, n, r), s.text = "";
                                    continue
                                }
                                s.setCondition(u[0].substr(_ + 1), 1), s.text = g.getWith("with" == u[2] ? u[3] : null);
                                break;
                            case"#import":
                                l = (u = v.splitToWords(o, null))[1], n.push({
                                    node: s,
                                    file: v.includes[l],
                                    ofs: s.text.length
                                });
                                continue
                        }
                    } else {
                        if ((a = t.childs[t.childs.length - 1]) && !a.name) {
                            0 < n.length && v.splitToWords(o, a), c = s, a.text += "\n" + o;
                            continue
                        }
                        0 < n.length && v.splitToWords(o, s)
                    }
                    s.setParent(t)
                }
            }, t.createShader = function (t, e, i, n) {
                var r = {}, s = "";
                if (t) for (var a in t) s += "#define " + a + "\n", r[a] = !0;
                var o = this._VS.toscript(r, []), h = this._PS.toscript(r, []);
                return (i || ni.create)(s + o.join("\n"), s + h.join("\n"), e, this._nameMap, n)
            }, v._parseOne = function (t, e, i, n, r, s) {
                var a = {
                    type: v.shaderParamsMap[i[n + 1]],
                    name: i[n + 2],
                    size: isNaN(parseInt(i[n + 3])) ? 1 : parseInt(i[n + 3])
                };
                return s && ("attribute" == r ? t.push(a) : e.push(a)), ":" == i[n + 3] && (a.type = i[n + 4], n += 2), n += 2
            }, v.addInclude = function (t, e) {
                if (!e || 0 === e.length) throw new Error("add shader include file err:" + t);
                if (v.includes[t]) throw new Error("add shader include file err, has add:" + t);
                v.includes[t] = new G(e)
            }, v.preGetParams = function (t, e) {
                var i = [t, e], n = {}, r = [], s = [], a = {}, o = [];
                n.attributes = r, n.uniforms = s, n.defines = a;
                for (var h = 0, l = 0, u = 0; u < 2; u++) {
                    i[u] = i[u].replace(v._removeAnnotation, "");
                    var c, _ = i[u].match(v._reg);
                    for (h = 0, l = _.length; h < l; h++) {
                        var f = _[h];
                        if ("attribute" == f || "uniform" == f) h = v._parseOne(r, s, _, h, f, !0); else {
                            if ("#define" == f) {
                                o[f = _[++h]] = 1;
                                continue
                            }
                            if ("#ifdef" == f) {
                                a[c = _[++h]] = a[c] || [];
                                for (h++; h < l; h++) if ("attribute" == (f = _[h]) || "uniform" == f) h = v._parseOne(r, s, _, h, f, o[c]); else if ("#else" == f) for (h++; h < l; h++) if ("attribute" == (f = _[h]) || "uniform" == f) h = v._parseOne(r, s, _, h, f, !o[c]); else if ("#endif" == f) break
                            }
                        }
                    }
                }
                return n
            }, v.splitToWords = function (t, e) {
                for (var i, n, r = [], s = -1, a = 0, o = t.length; a < o; a++) if (i = t.charAt(a), 0 <= " \t=+-*/&%!<>()'\",;".indexOf(i)) {
                    if (0 <= s && 1 < a - s && (n = t.substr(s, a - s), r.push(n)), '"' == i || "'" == i) {
                        var h = t.indexOf(i, a + 1);
                        if (h < 0) throw"Sharder err:" + t;
                        r.push(t.substr(a + 1, h - a - 1)), a = h, s = -1;
                        continue
                    }
                    "(" == i && e && 0 < r.length && (n = r[r.length - 1] + ";", "vec4;main;".indexOf(n) < 0 && (e.useFuns += n)), s = -1
                } else s < 0 && (s = a);
                return s < o && 1 < o - s && (n = t.substr(s, o - s), r.push(n)), r
            }, v.IFDEF_NO = 0, v.IFDEF_YES = 1, v.IFDEF_ELSE = 2, v.IFDEF_PARENT = 3, v._removeAnnotation = new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)", "g"), v._reg = new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])", "g"), v._splitToWordExps = new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])", "g"), v.includes = {}, a(v, ["shaderParamsMap", function () {
                return this.shaderParamsMap = {
                    float: 5126,
                    int: 5124,
                    bool: 35670,
                    vec2: 35664,
                    vec3: 35665,
                    vec4: 35666,
                    ivec2: 35667,
                    ivec3: 35668,
                    ivec4: 35669,
                    bvec2: 35671,
                    bvec3: 35672,
                    bvec4: 35673,
                    mat2: 35674,
                    mat3: 35675,
                    mat4: 35676,
                    sampler2D: 35678,
                    samplerCube: 35680
                }
            }, "_splitToWordExps3", function () {
                return this._splitToWordExps3 = new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]", "g")
            }]), v
        }(), ge = function () {
            function t() {
                this.json = null
            }

            return x(t, "laya.components.Prefab"), t.prototype.create = function () {
                return this.json ? mt.createByData(null, this.json) : null
            }, t
        }(), ve = function () {
            function h() {
            }

            x(h, "laya.display.cmd.FillBorderWordsCmd");
            var t = h.prototype;
            return t.recover = function () {
                this.words = null, W.recover("FillBorderWordsCmd", this)
            }, t.run = function (t, e, i) {
                t.fillBorderWords(this.words, this.x + e, this.y + i, this.font, this.fillColor, this.borderColor, this.lineWidth)
            }, d(0, t, "cmdID", function () {
                return "FillBorderWords"
            }), h.create = function (t, e, i, n, r, s, a) {
                var o = W.getItemByClass("FillBorderWordsCmd", h);
                return o.words = t, o.x = e, o.y = i, o.font = n, o.fillColor = r, o.borderColor = s, o.lineWidth = a, o
            }, h.ID = "FillBorderWords", h
        }(), ye = function () {
            function c() {
                this._hit = null, this._unHit = null
            }

            x(c, "laya.utils.HitArea");
            var t = c.prototype;
            return t.contains = function (t, e) {
                return !!c._isHitGraphic(t, e, this.hit) && !c._isHitGraphic(t, e, this.unHit)
            }, d(0, t, "hit", function () {
                return this._hit || (this._hit = new qt), this._hit
            }, function (t) {
                this._hit = t
            }), d(0, t, "unHit", function () {
                return this._unHit || (this._unHit = new qt), this._unHit
            }, function (t) {
                this._unHit = t
            }), c._isHitGraphic = function (t, e, i) {
                if (!i) return !1;
                var n = i.cmds;
                if (!n && i._one && ((n = c._cmds).length = 1, n[0] = i._one), !n) return !1;
                var r, s, a = 0;
                for (r = n.length, a = 0; a < r; a++) if (s = n[a]) {
                    switch (s.cmdID) {
                        case"Translate":
                            t -= s.tx, e -= s.ty
                    }
                    if (c._isHitCmd(t, e, s)) return !0
                }
                return !1
            }, c._isHitCmd = function (t, e, i) {
                if (!i) return !1;
                var n = !1;
                switch (i.cmdID) {
                    case"DrawRect":
                        c._rect.setTo(i.x, i.y, i.width, i.height), n = c._rect.contains(t, e);
                        break;
                    case"DrawCircle":
                        n = (t -= i.x) * t + (e -= i.y) * e < i.radius * i.radius;
                        break;
                    case"DrawPoly":
                        t -= i.x, e -= i.y, n = c._ptInPolygon(t, e, i.points)
                }
                return n
            }, c._ptInPolygon = function (t, e, i) {
                var n = c._ptPoint;
                n.setTo(t, e);
                var r, s = 0, a = NaN, o = NaN, h = NaN, l = NaN;
                r = i.length;
                for (var u = 0; u < r; u += 2) {
                    if (a = i[u], o = i[u + 1], h = i[(u + 2) % r], o != (l = i[(u + 3) % r])) if (!(n.y < Math.min(o, l))) if (!(n.y >= Math.max(o, l))) (n.y - o) * (h - a) / (l - o) + a > n.x && s++
                }
                return s % 2 == 1
            }, c._cmds = [], a(c, ["_rect", function () {
                return this._rect = new gt
            }, "_ptPoint", function () {
                return this._ptPoint = new Ht
            }]), c
        }(), xe = function () {
            function h() {
            }

            return x(h, "laya.media.SoundManager"), d(1, h, "useAudioMusic", function () {
                return h._useAudioMusic
            }, function (t) {
                h._useAudioMusic = t, h._musicClass = t ? Ce : null
            }), d(1, h, "autoStopMusic", function () {
                return h._autoStopMusic
            }, function (t) {
                y.stage.off("blur", null, h._stageOnBlur), y.stage.off("focus", null, h._stageOnFocus), y.stage.off("visibilitychange", null, h._visibilityChange), (h._autoStopMusic = t) && (y.stage.on("blur", null, h._stageOnBlur), y.stage.on("focus", null, h._stageOnFocus), y.stage.on("visibilitychange", null, h._visibilityChange))
            }), d(1, h, "muted", function () {
                return h._muted
            }, function (t) {
                t != h._muted && (t && h.stopAllSound(), h.musicMuted = t, h._muted = t)
            }), d(1, h, "musicMuted", function () {
                return h._musicMuted
            }, function (t) {
                t != h._musicMuted && (t ? (h._bgMusic && h._musicChannel && !h._musicChannel.isStopped ? Rt.isConchApp ? h._musicChannel._audio && (h._musicChannel._audio.muted = !0) : h._musicChannel.pause() : h._musicChannel = null, h._musicMuted = t) : (h._musicMuted = t, h._bgMusic && h._musicChannel && (Rt.isConchApp ? h._musicChannel._audio && (h._musicChannel._audio.muted = !1) : h._musicChannel.resume())))
            }), d(1, h, "soundMuted", function () {
                return h._soundMuted
            }, function (t) {
                h._soundMuted = t
            }), h.__init__ = function () {
                var t = Lt.window, e = !!(t.AudioContext || t.webkitAudioContext || t.mozAudioContext);
                return e && Be.initWebAudio(), h._soundClass = e ? Be : Ce, Ce._initMusicAudio(), h._musicClass = Ce, e
            }, h.addChannel = function (t) {
                0 <= h._channels.indexOf(t) || h._channels.push(t)
            }, h.removeChannel = function (t) {
                var e = 0;
                for (e = h._channels.length - 1; 0 <= e; e--) h._channels[e] == t && h._channels.splice(e, 1)
            }, h.disposeSoundLater = function (t) {
                h._lastSoundUsedTimeDic[t] = Lt.now(), h._isCheckingDispose || (h._isCheckingDispose = !0, y.timer.loop(5e3, null, h._checkDisposeSound))
            }, h._checkDisposeSound = function () {
                var t, e = Lt.now(), i = !1;
                for (t in h._lastSoundUsedTimeDic) 3e4 < e - h._lastSoundUsedTimeDic[t] ? (delete h._lastSoundUsedTimeDic[t], h.disposeSoundIfNotUsed(t)) : i = !0;
                i || (h._isCheckingDispose = !1, y.timer.clear(null, h._checkDisposeSound))
            }, h.disposeSoundIfNotUsed = function (t) {
                var e = 0;
                for (e = h._channels.length - 1; 0 <= e; e--) if (h._channels[e].url == t) return;
                h.destroySound(t)
            }, h._visibilityChange = function () {
                y.stage.isVisibility ? h._stageOnFocus() : h._stageOnBlur()
            }, h._stageOnBlur = function () {
                h._isActive = !1, h._musicChannel && (h._musicChannel.isStopped || (h._blurPaused = !0, h._musicChannel.pause())), h.stopAllSound(), y.stage.once("mousedown", null, h._stageOnFocus)
            }, h._recoverWebAudio = function () {
                Be.ctx && "running" != Be.ctx.state && Be.ctx.resume && Be.ctx.resume()
            }, h._stageOnFocus = function () {
                h._isActive = !0, h._recoverWebAudio(), y.stage.off("mousedown", null, h._stageOnFocus), h._blurPaused && h._musicChannel && h._musicChannel.isStopped && (h._blurPaused = !1, h._musicChannel.resume())
            }, h.playSound = function (t, e, i, n, r) {
                if (void 0 === e && (e = 1), void 0 === r && (r = 0), !h._isActive || !t) return null;
                if (h._muted) return null;
                if (h._recoverWebAudio(), (t = q.formatURL(t)) == h._bgMusic) {
                    if (h._musicMuted) return null
                } else {
                    if (Rt.isConchApp) {
                        var s = ne.getFileExtension(t);
                        if ("wav" != s && "ogg" != s) return alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document."), null
                    }
                    if (h._soundMuted) return null
                }
                var a, o;
                return Lt.onMiniGame || Lt.onBLMiniGame || Lt.onQQMiniGame || Lt.onQGMiniGame || Lt.onVVMiniGame || Lt.onBDMiniGame || Lt.onKGMiniGame || (a = y.loader.getRes(t)), n || (n = h._soundClass), a || ((a = new n).load(t), Lt.onMiniGame || Lt.onBLMiniGame || Lt.onQQMiniGame || Lt.onQGMiniGame || Lt.onVVMiniGame || Lt.onBDMiniGame || Lt.onKGMiniGame || De.cacheRes(t, a)), (o = a.play(r, e)) ? (o.url = t, o.volume = t == h._bgMusic ? h.musicVolume : h.soundVolume, o.completeHandler = i, o) : null
            }, h.destroySound = function (t) {
                var e = y.loader.getRes(t);
                e && (De.clearRes(t), e.dispose())
            }, h.playMusic = function (t, e, i, n) {
                return void 0 === e && (e = 0), void 0 === n && (n = 0), t = q.formatURL(t), h._bgMusic = t, h._musicChannel && h._musicChannel.stop(), h._musicChannel = h.playSound(t, e, i, h._musicClass, n)
            }, h.stopSound = function (t) {
                t = q.formatURL(t);
                var e, i = 0;
                for (i = h._channels.length - 1; 0 <= i; i--) (e = h._channels[i]).url == t && e.stop()
            }, h.stopAll = function () {
                h._bgMusic = null;
                var t = 0;
                for (t = h._channels.length - 1; 0 <= t; t--) h._channels[t].stop()
            }, h.stopAllSound = function () {
                var t, e = 0;
                for (e = h._channels.length - 1; 0 <= e; e--) (t = h._channels[e]).url != h._bgMusic && t.stop()
            }, h.stopMusic = function () {
                h._musicChannel && h._musicChannel.stop(), h._bgMusic = null
            }, h.setSoundVolume = function (t, e) {
                if (e) e = q.formatURL(e), h._setVolume(e, t); else {
                    h.soundVolume = t;
                    var i, n = 0;
                    for (n = h._channels.length - 1; 0 <= n; n--) (i = h._channels[n]).url != h._bgMusic && (i.volume = t)
                }
            }, h.setMusicVolume = function (t) {
                h.musicVolume = t, h._setVolume(h._bgMusic, t)
            }, h._setVolume = function (t, e) {
                t = q.formatURL(t);
                var i, n = 0;
                for (n = h._channels.length - 1; 0 <= n; n--) (i = h._channels[n]).url == t && (i.volume = e)
            }, h.musicVolume = 1, h.soundVolume = 1, h.playbackRate = 1, h._useAudioMusic = !0, h._muted = !1, h._soundMuted = !1, h._musicMuted = !1, h._bgMusic = null, h._musicChannel = null, h._channels = [], h._autoStopMusic = !1, h._blurPaused = !1, h._isActive = !0, h._soundClass = null, h._musicClass = null, h._lastSoundUsedTimeDic = {}, h._isCheckingDispose = !1, h.autoReleaseSound = !0, h
        }(), Te = function (t) {
            function a(t) {
                void 0 === t && (t = 1e4), a.__super.call(this, t)
            }

            x(a, "laya.webgl.submit.SubmitTexture", T);
            var e = a.prototype;
            return e.clone = function (t, e, i) {
                var n = a._poolSize ? a.POOL[--a._poolSize] : new a;
                return this._cloneInit(n, t, e, i), n
            }, e.releaseRender = function () {
                --this._ref < 1 && ((a.POOL[a._poolSize++] = this).shaderValue.release(), this._mesh = null, this._parent && (this._parent.releaseRender(), this._parent = null))
            }, e.renderSubmit = function () {
                if (0 === this._numEle) return 1;
                var t = this.shaderValue.textureHost;
                if (t) {
                    var e = t ? t._getSource() : null;
                    if (!e) return 1
                }
                var i = Ct.mainContext;
                this._mesh.useMesh(i);
                var n = T.preRender, r = T.preRender._key;
                return 0 === this._key.blendShader && this._key.submitType === r.submitType && this._key.blendShader === r.blendShader && Ke.activeShader && T.preRender.clipInfoID == this.clipInfoID && n.shaderValue.defines._value === this.shaderValue.defines._value && 0 == (this.shaderValue.defines._value & Re.NOOPTMASK) ? Ke.activeShader.uploadTexture2D(e) : (fe.activeBlendFunction !== this._blendFn && (rt.setBlend(i, !0), this._blendFn(i), fe.activeBlendFunction = this._blendFn), this.shaderValue.texture = e, this.shaderValue.upload()), i.drawElements(4, this._numEle, 5123, this._startIdx), M.renderBatches++, M.trianglesFaces += this._numEle / 3, 1
            }, a.create = function (t, e, i) {
                var n = a._poolSize ? a.POOL[--a._poolSize] : new a(10016);
                n._mesh = e, n._key.clear(), n._key.submitType = 2, n._ref = 1, n._startIdx = e.indexNum * ft.BYTES_PIDX, n._numEle = 0;
                var r = t._nBlendType;
                if (n._key.blendShader = r, n._blendFn = t._targets ? fe.targetFns[r] : fe.fns[r], n.shaderValue = i, t._colorFiler) {
                    var s = t._colorFiler;
                    i.defines.add(s.type), i.colorMat = s._mat, i.colorAlpha = s._alpha
                }
                return n
            }, a._poolSize = 0, a.POOL = [], a
        }(), be = function (t) {
            function r(t) {
                r.__super.call(this), t || (t = this._copyMatrix(r.IDENTITY_MATRIX)), this._mat = new Float32Array(16), this._alpha = new Float32Array(4), this.setByMatrix(t)
            }

            x(r, "laya.filters.ColorFilter", l);
            var e = r.prototype;
            return y.imps(e, {"laya.filters.IFilter": !0}), e.gray = function () {
                return this.setByMatrix(r.GRAY_MATRIX)
            }, e.color = function (t, e, i, n) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 1), this.setByMatrix([1, 0, 0, 0, t, 0, 1, 0, 0, e, 0, 0, 1, 0, i, 0, 0, 0, 1, n])
            }, e.setColor = function (t) {
                var e = p.create(t).arrColor,
                    i = [0, 0, 0, 0, 256 * e[0], 0, 0, 0, 0, 256 * e[1], 0, 0, 0, 0, 256 * e[2], 0, 0, 0, 1, 0];
                return this.setByMatrix(i)
            }, e.setByMatrix = function (t) {
                this._matrix != t && this._copyMatrix(t);
                for (var e = 0, i = 0, n = 0; n < 20; n++) n % 5 != 4 ? this._mat[e++] = t[n] : this._alpha[i++] = t[n];
                return this
            }, e.adjustColor = function (t, e, i, n) {
                return this.adjustHue(n), this.adjustContrast(e), this.adjustBrightness(t), this.adjustSaturation(i), this
            }, e.adjustBrightness = function (t) {
                return 0 == (t = this._clampValue(t, 100)) || isNaN(t) ? this : this._multiplyMatrix([1, 0, 0, 0, t, 0, 1, 0, 0, t, 0, 0, 1, 0, t, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1])
            }, e.adjustContrast = function (t) {
                if (0 == (t = this._clampValue(t, 100)) || isNaN(t)) return this;
                var e = NaN,
                    i = (e = t < 0 ? 127 + t / 100 * 127 : 127 * (e = 0 == (e = t % 1) ? r.DELTA_INDEX[t] : r.DELTA_INDEX[t << 0] * (1 - e) + r.DELTA_INDEX[1 + (t << 0)] * e) + 127) / 127,
                    n = .5 * (127 - e);
                return this._multiplyMatrix([i, 0, 0, 0, n, 0, i, 0, 0, n, 0, 0, i, 0, n, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1])
            }, e.adjustSaturation = function (t) {
                if (0 == (t = this._clampValue(t, 100)) || isNaN(t)) return this;
                var e = 1 + (0 < t ? 3 * t / 100 : t / 100), i = 1 - e, n = .3086 * i, r = .6094 * i, s = .082 * i;
                return this._multiplyMatrix([n + e, r, s, 0, 0, n, r + e, s, 0, 0, n, r, s + e, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1])
            }, e.adjustHue = function (t) {
                if (0 == (t = this._clampValue(t, 180) / 180 * Math.PI) || isNaN(t)) return this;
                var e = Math.cos(t), i = Math.sin(t);
                return this._multiplyMatrix([.213 + .787 * e + -.213 * i, .715 + -.715 * e + -.715 * i, .072 + -.072 * e + .928 * i, 0, 0, .213 + -.213 * e + .143 * i, .715 + e * (1 - .715) + .14 * i, .072 + -.072 * e + -.283 * i, 0, 0, .213 + -.213 * e + -.787 * i, .715 + -.715 * e + .715 * i, .072 + .928 * e + .072 * i, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1])
            }, e.reset = function () {
                return this.setByMatrix(this._copyMatrix(r.IDENTITY_MATRIX))
            }, e._multiplyMatrix = function (t) {
                var e = [];
                this._matrix = this._fixMatrix(this._matrix);
                for (var i = 0; i < 5; i++) {
                    for (var n = 0; n < 5; n++) e[n] = this._matrix[n + 5 * i];
                    for (n = 0; n < 5; n++) {
                        for (var r = 0, s = 0; s < 5; s++) r += t[n + 5 * s] * e[s];
                        this._matrix[n + 5 * i] = r
                    }
                }
                return this.setByMatrix(this._matrix)
            }, e._clampValue = function (t, e) {
                return Math.min(e, Math.max(-e, t))
            }, e._fixMatrix = function (t) {
                return null == t ? r.IDENTITY_MATRIX : (t.length < 25 ? t = t.slice(0, t.length).concat(r.IDENTITY_MATRIX.slice(t.length, 25)) : 25 < t.length && (t = t.slice(0, 25)), t)
            }, e._copyMatrix = function (t) {
                this._matrix || (this._matrix = []);
                for (var e = 0; e < 25; e++) this._matrix[e] = t[e];
                return this._matrix
            }, d(0, e, "type", function () {
                return 32
            }), r.LENGTH = 25, a(r, ["DELTA_INDEX", function () {
                return this.DELTA_INDEX = [0, .01, .02, .04, .05, .06, .07, .08, .1, .11, .12, .14, .15, .16, .17, .18, .2, .21, .22, .24, .25, .27, .28, .3, .32, .34, .36, .38, .4, .42, .44, .46, .48, .5, .53, .56, .59, .62, .65, .68, .71, .74, .77, .8, .83, .86, .89, .92, .95, .98, 1, 1.06, 1.12, 1.18, 1.24, 1.3, 1.36, 1.42, 1.48, 1.54, 1.6, 1.66, 1.72, 1.78, 1.84, 1.9, 1.96, 2, 2.12, 2.25, 2.37, 2.5, 2.62, 2.75, 2.87, 3, 3.2, 3.4, 3.6, 3.8, 4, 4.3, 4.7, 4.9, 5, 5.5, 6, 6.5, 6.8, 7, 7.3, 7.5, 7.8, 8, 8.4, 8.7, 9, 9.4, 9.6, 9.8, 10]
            }, "GRAY_MATRIX", function () {
                return this.GRAY_MATRIX = [.3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, 0, 0, 0, 1, 0]
            }, "IDENTITY_MATRIX", function () {
                return this.IDENTITY_MATRIX = [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]
            }]), r
        }(), we = function (t) {
            function s() {
                this._matrix = new at, this._matrix4 = ft.defaultMatrix4.concat(), s.__super.call(this, 1e4), this.shaderValue = new Y(0, 0)
            }

            x(s, "laya.webgl.submit.SubmitCanvas", T);
            var e = s.prototype;
            return e.renderSubmit = function () {
                var t = pt.worldAlpha, e = pt.worldMatrix4, i = pt.worldMatrix, n = pt.worldFilters,
                    r = pt.worldShaderDefines, s = this.shaderValue, a = this._matrix, o = this._matrix4, h = at.TEMP;
                return at.mul(a, i, h), o[0] = h.a, o[1] = h.b, o[4] = h.c, o[5] = h.d, o[12] = h.tx, o[13] = h.ty, pt.worldMatrix = h.clone(), pt.worldMatrix4 = o, pt.worldAlpha = pt.worldAlpha * s.alpha, s.filters && s.filters.length && (pt.worldFilters = s.filters, pt.worldShaderDefines = s.defines), this.canv.flushsubmit(), pt.worldAlpha = t, pt.worldMatrix4 = e, pt.worldMatrix.destroy(), pt.worldMatrix = i, pt.worldFilters = n, pt.worldShaderDefines = r, 1
            }, e.releaseRender = function () {
                if (--this._ref < 1) {
                    var t = s.POOL;
                    this._mesh = null, t[t._length++] = this
                }
            }, e.clone = function (t, e, i) {
                return null
            }, e.getRenderType = function () {
                return 10003
            }, s.create = function (t, e, i) {
                var n = s.POOL._length ? s.POOL[--s.POOL._length] : new s;
                n.canv = t, n._ref = 1, n._numEle = 0;
                var r = n.shaderValue;
                return r.alpha = e, r.defines.setValue(0), i && i.length && r.setFilters(i), n
            }, s.POOL = [], s.__init$ = function () {
                s.POOL._length = 0
            }, s
        }(), Ce = (function (t) {
            function e() {
                e.__super.call(this)
            }

            x(e, "laya.components.Script", r);
            var i = e.prototype;
            i._onAwake = function () {
                this.onAwake(), this.onStart !== laya.components.Script.prototype.onStart && y.startTimer.callLater(this, this.onStart)
            }, i._onEnable = function () {
                var t = laya.components.Script.prototype;
                this.onTriggerEnter !== t.onTriggerEnter && this.owner.on("triggerenter", this, this.onTriggerEnter), this.onTriggerStay !== t.onTriggerStay && this.owner.on("triggerstay", this, this.onTriggerStay), this.onTriggerExit !== t.onTriggerExit && this.owner.on("triggerexit", this, this.onTriggerExit), this.onMouseDown !== t.onMouseDown && this.owner.on("mousedown", this, this.onMouseDown), this.onMouseUp !== t.onMouseUp && this.owner.on("mouseup", this, this.onMouseUp), this.onClick !== t.onClick && this.owner.on("click", this, this.onClick), this.onStageMouseDown !== t.onStageMouseDown && y.stage.on("mousedown", this, this.onStageMouseDown), this.onStageMouseUp !== t.onStageMouseUp && y.stage.on("mouseup", this, this.onStageMouseUp), this.onStageClick !== t.onStageClick && y.stage.on("click", this, this.onStageClick), this.onStageMouseMove !== t.onStageMouseMove && y.stage.on("mousemove", this, this.onStageMouseMove), this.onDoubleClick !== t.onDoubleClick && this.owner.on("doubleclick", this, this.onDoubleClick), this.onRightClick !== t.onRightClick && this.owner.on("rightclick", this, this.onRightClick), this.onMouseMove !== t.onMouseMove && this.owner.on("mousemove", this, this.onMouseMove), this.onMouseOver !== t.onMouseOver && this.owner.on("mouseover", this, this.onMouseOver), this.onMouseOut !== t.onMouseOut && this.owner.on("mouseout", this, this.onMouseOut), this.onKeyDown !== t.onKeyDown && y.stage.on("keydown", this, this.onKeyDown), this.onKeyPress !== t.onKeyPress && y.stage.on("keypress", this, this.onKeyPress), this.onKeyUp !== t.onKeyUp && y.stage.on("keyup", this, this.onKeyUp), this.onUpdate !== t.onUpdate && y.updateTimer.frameLoop(1, this, this.onUpdate), this.onLateUpdate !== t.onLateUpdate && y.lateTimer.frameLoop(1, this, this.onLateUpdate), this.onPreRender !== t.onPreRender && y.lateTimer.frameLoop(1, this, this.onPreRender)
            }, i._onDisable = function () {
                this.owner.offAllCaller(this), y.stage.offAllCaller(this), y.startTimer.clearAll(this), y.updateTimer.clearAll(this), y.lateTimer.clearAll(this)
            }, i._isScript = function () {
                return !0
            }, i._onDestroy = function () {
                this.onDestroy()
            }, i.onAwake = function () {
            }, i.onEnable = function () {
            }, i.onStart = function () {
            }, i.onTriggerEnter = function (t, e, i) {
            }, i.onTriggerStay = function (t, e, i) {
            }, i.onTriggerExit = function (t, e, i) {
            }, i.onMouseDown = function (t) {
            }, i.onMouseUp = function (t) {
            }, i.onClick = function (t) {
            }, i.onStageMouseDown = function (t) {
            }, i.onStageMouseUp = function (t) {
            }, i.onStageClick = function (t) {
            }, i.onStageMouseMove = function (t) {
            }, i.onDoubleClick = function (t) {
            }, i.onRightClick = function (t) {
            }, i.onMouseMove = function (t) {
            }, i.onMouseOver = function (t) {
            }, i.onMouseOut = function (t) {
            }, i.onKeyDown = function (t) {
            }, i.onKeyPress = function (t) {
            }, i.onKeyUp = function (t) {
            }, i.onUpdate = function () {
            }, i.onLateUpdate = function () {
            }, i.onPreRender = function () {
            }, i.onPostRender = function () {
            }, i.onDisable = function () {
            }, i.onDestroy = function () {
            }, d(0, i, "isSingleton", function () {
                return !1
            })
        }(), function (t) {
            function a() {
                this.url = null, this.audio = null, this.loaded = !1, a.__super.call(this)
            }

            x(a, "laya.media.h5audio.AudioSound", g);
            var e = a.prototype;
            return e.dispose = function () {
                var t = a._audioCache[this.url];
                W.clearBySign("audio:" + this.url), t && (Rt.isConchApp || (t.src = ""), delete a._audioCache[this.url])
            }, e.load = function (t) {
                var e;
                if (t = q.formatURL(t), (this.url = t) == xe._bgMusic ? (a._initMusicAudio(), (e = a._musicAudio).src != t && (a._audioCache[e.src] = null, e = null)) : e = a._audioCache[t], e && 2 <= e.readyState) this.event("complete"); else {
                    e || (e = t == xe._bgMusic ? (a._initMusicAudio(), a._musicAudio) : Lt.createElement("audio"), (a._audioCache[t] = e).src = t), e.addEventListener("canplaythrough", n), e.addEventListener("error", r);
                    var i = this;
                    (this.audio = e).load ? e.load() : r()
                }

                function n() {
                    s(), i.loaded = !0, i.event("complete")
                }

                function r() {
                    e.load = null, s(), i.event("error")
                }

                function s() {
                    e.removeEventListener("canplaythrough", n), e.removeEventListener("error", r)
                }
            }, e.play = function (t, e) {
                if (void 0 === t && (t = 0), void 0 === e && (e = 0), !this.url) return null;
                var i, n;
                if (!(i = this.url == xe._bgMusic ? a._musicAudio : a._audioCache[this.url])) return null;
                n = W.getItem("audio:" + this.url), Rt.isConchApp ? n || ((n = Lt.createElement("audio")).src = this.url) : this.url == xe._bgMusic ? (a._initMusicAudio(), (n = a._musicAudio).src = this.url) : n = n || i.cloneNode(!0);
                var r = new Je(n);
                return r.url = this.url, r.loops = e, r.startTime = t, r.play(), xe.addChannel(r), r
            }, d(0, e, "duration", function () {
                var t;
                return (t = a._audioCache[this.url]) ? t.duration : 0
            }), a._initMusicAudio = function () {
                a._musicAudio || (a._musicAudio || (a._musicAudio = Lt.createElement("audio")), Rt.isConchApp || Lt.document.addEventListener("mousedown", a._makeMusicOK))
            }, a._makeMusicOK = function () {
                Lt.document.removeEventListener("mousedown", a._makeMusicOK), a._musicAudio.src ? a._musicAudio.play() : (a._musicAudio.src = "", a._musicAudio.load())
            }, a._audioCache = {}, a._musicAudio = null, a
        }()), t = (function (t) {
            function e() {
                e.__super.call(this)
            }

            x(e, "laya.media.Sound", g);
            var i = e.prototype;
            i.load = function (t) {
            }, i.play = function (t, e) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), null
            }, i.dispose = function () {
            }, d(0, i, "duration", function () {
                return 0
            })
        }(), function (t) {
            function i(t) {
                i.__super.call(this, 116, 4 * t * 116, 4), this.canReuse = !0, this.setAttributes(laya.webgl.utils.MeshParticle2D._fixattriInfo), this.createQuadIB(t), this._quadNum = t
            }

            x(i, "laya.webgl.utils.MeshParticle2D", C);
            var e = i.prototype;
            e.setMaxParticleNum = function (t) {
                this._vb._resizeBuffer(4 * t * 116, !1), this.createQuadIB(t)
            }, e.releaseMesh = function () {
                this._vb.setByteLength(0), this.vertNum = 0, this.indexNum = 0, laya.webgl.utils.MeshParticle2D._POOL.push(this)
            }, e.destroy = function () {
                this._ib.destroy(), this._vb.destroy(), this._vb.deleteBuffer()
            }, i.getAMesh = function (t) {
                if (laya.webgl.utils.MeshParticle2D._POOL.length) {
                    var e = laya.webgl.utils.MeshParticle2D._POOL.pop();
                    return e.setMaxParticleNum(t), e
                }
                return new i(t)
            }, i.const_stride = 116, i._POOL = [], a(i, ["_fixattriInfo", function () {
                return this._fixattriInfo = [5126, 4, 0, 5126, 3, 16, 5126, 3, 28, 5126, 4, 40, 5126, 4, 56, 5126, 3, 72, 5126, 2, 84, 5126, 4, 92, 5126, 1, 108, 5126, 1, 112]
            }])
        }(), function (t) {
            function a() {
                this._bits = 0, this._parent = null, this.name = "", this.destroyed = !1, this._conchData = null, this._components = null, this._activeChangeScripts = null, this._scene = null, a.__super.call(this), this._children = a.ARRAY_EMPTY, this._extUIChild = a.ARRAY_EMPTY, this.createGLBuffer()
            }

            x(a, "laya.display.Node", g);
            var e = a.prototype;
            return e.createGLBuffer = function () {
            }, e._setBit = function (t, e) {
                16 === t && (this._getBit(t) != e && this._updateDisplayedInstage());
                e ? this._bits |= t : this._bits &= ~t
            }, e._getBit = function (t) {
                return 0 != (this._bits & t)
            }, e._setUpNoticeChain = function () {
                this._getBit(16) && this._setBitUp(16)
            }, e._setBitUp = function (t) {
                var e = this;
                for (e._setBit(t, !0), e = e._parent; e;) {
                    if (e._getBit(t)) return;
                    e._setBit(t, !0), e = e._parent
                }
            }, e.on = function (t, e, i, n) {
                return "display" !== t && "undisplay" !== t || this._getBit(16) || this._setBitUp(16), this._createListener(t, e, i, n, !1)
            }, e.once = function (t, e, i, n) {
                return "display" !== t && "undisplay" !== t || this._getBit(16) || this._setBitUp(16), this._createListener(t, e, i, n, !0)
            }, e.destroy = function (t) {
                void 0 === t && (t = !0), this.destroyed = !0, this._destroyAllComponent(), this._parent && this._parent.removeChild(this), this._children && (t ? this.destroyChildren() : this.removeChildren()), this.onDestroy(), this._children = null, this.offAll()
            }, e.onDestroy = function () {
            }, e.destroyChildren = function () {
                if (this._children) for (var t = 0, e = this._children.length; t < e; t++) this._children[0].destroy(!0)
            }, e.addChild = function (t) {
                if (!t || this.destroyed || t === this) return t;
                if (t._zOrder && this._setBit(32, !0), t._parent === this) {
                    var e = this.getChildIndex(t);
                    e !== this._children.length - 1 && (this._children.splice(e, 1), this._children.push(t), this._childChanged())
                } else t._parent && t._parent.removeChild(t), this._children === a.ARRAY_EMPTY && (this._children = []), this._children.push(t), t._setParent(this), this._childChanged();
                return t
            }, e.addInputChild = function (t) {
                if (this._extUIChild == a.ARRAY_EMPTY) this._extUIChild = [t]; else {
                    if (0 <= this._extUIChild.indexOf(t)) return null;
                    this._extUIChild.push(t)
                }
                return null
            }, e.removeInputChild = function (t) {
                var e = this._extUIChild.indexOf(t);
                0 <= e && this._extUIChild.splice(e, 1)
            }, e.addChildren = function (t) {
                for (var e = arguments, i = 0, n = e.length; i < n;) this.addChild(e[i++])
            }, e.addChildAt = function (t, e) {
                if (!t || this.destroyed || t === this) return t;
                if (t._zOrder && this._setBit(32, !0), 0 <= e && e <= this._children.length) {
                    if (t._parent === this) {
                        var i = this.getChildIndex(t);
                        this._children.splice(i, 1), this._children.splice(e, 0, t), this._childChanged()
                    } else t._parent && t._parent.removeChild(t), this._children === a.ARRAY_EMPTY && (this._children = []), this._children.splice(e, 0, t), t._setParent(this);
                    return t
                }
                throw new Error("appendChildAt:The index is out of bounds")
            }, e.getChildIndex = function (t) {
                return this._children.indexOf(t)
            }, e.getChildByName = function (t) {
                var e = this._children;
                if (e) for (var i = 0, n = e.length; i < n; i++) {
                    var r = e[i];
                    if (r.name === t) return r
                }
                return null
            }, e.getChildAt = function (t) {
                return this._children[t] || null
            }, e.setChildIndex = function (t, e) {
                var i = this._children;
                if (e < 0 || e >= i.length) throw new Error("setChildIndex:The index is out of bounds.");
                var n = this.getChildIndex(t);
                if (n < 0) throw new Error("setChildIndex:node is must child of this object.");
                return i.splice(n, 1), i.splice(e, 0, t), this._childChanged(), t
            }, e._childChanged = function (t) {
            }, e.removeChild = function (t) {
                if (!this._children) return t;
                var e = this._children.indexOf(t);
                return this.removeChildAt(e)
            }, e.removeSelf = function () {
                return this._parent && this._parent.removeChild(this), this
            }, e.removeChildByName = function (t) {
                var e = this.getChildByName(t);
                return e && this.removeChild(e), e
            }, e.removeChildAt = function (t) {
                var e = this.getChildAt(t);
                return e && (this._children.splice(t, 1), e._setParent(null)), e
            }, e.removeChildren = function (t, e) {
                if (void 0 === t && (t = 0), void 0 === e && (e = 2147483647), this._children && 0 < this._children.length) {
                    var i = this._children;
                    if (0 === t && e >= i.length - 1) {
                        var n = i;
                        this._children = a.ARRAY_EMPTY
                    } else n = i.splice(t, e - t);
                    for (var r = 0, s = n.length; r < s; r++) n[r]._setParent(null)
                }
                return this
            }, e.replaceChild = function (t, e) {
                var i = this._children.indexOf(e);
                return -1 < i ? (this._children.splice(i, 1, t), e._setParent(null), t._setParent(this), t) : null
            }, e._setParent = function (t) {
                this._parent !== t && (t ? (this._parent = t, this._onAdded(), this.event("added"), this._getBit(16) && (this._setUpNoticeChain(), t.displayedInStage && this._displayChild(this, !0)), t._childChanged(this)) : (this._onRemoved(), this.event("removed"), this._parent._childChanged(), this._getBit(16) && this._displayChild(this, !1), this._parent = t))
            }, e._updateDisplayedInstage = function () {
                var t;
                t = this;
                for (var e = y.stage, i = !1; t;) {
                    if (t._getBit(16)) {
                        i = t._getBit(128);
                        break
                    }
                    if (t === e || t._getBit(128)) {
                        i = !0;
                        break
                    }
                    t = t._parent
                }
                this._setBit(128, i)
            }, e._setDisplay = function (t) {
                this._getBit(128) !== t && (this._setBit(128, t), t ? this.event("display") : this.event("undisplay"))
            }, e._displayChild = function (t, e) {
                var i = t._children;
                if (i) for (var n = 0, r = i.length; n < r; n++) {
                    var s = i[n];
                    s._getBit(16) && (0 < s._children.length ? this._displayChild(s, e) : s._setDisplay(e))
                }
                t._setDisplay(e)
            }, e.contains = function (t) {
                if (t === this) return !0;
                for (; t;) {
                    if (t._parent === this) return !0;
                    t = t._parent
                }
                return !1
            }, e.timerLoop = function (t, e, i, n, r, s) {
                void 0 === r && (r = !0), void 0 === s && (s = !1), (this.scene ? this.scene.timer : y.timer).loop(t, e, i, n, r, s)
            }, e.timerOnce = function (t, e, i, n, r) {
                void 0 === r && (r = !0), (this.scene ? this.scene.timer : y.timer)._create(!1, !1, t, e, i, n, r)
            }, e.frameLoop = function (t, e, i, n, r) {
                void 0 === r && (r = !0), (this.scene ? this.scene.timer : y.timer)._create(!0, !0, t, e, i, n, r)
            }, e.frameOnce = function (t, e, i, n, r) {
                void 0 === r && (r = !0), (this.scene ? this.scene.timer : y.timer)._create(!0, !1, t, e, i, n, r)
            }, e.clearTimer = function (t, e) {
                (this.scene ? this.scene.timer : y.timer).clear(t, e)
            }, e.callLater = function (t, e) {
                (this.scene ? this.scene.timer : y.timer).callLater(this, t, e)
            }, e.runCallLater = function (t) {
                (this.scene ? this.scene.timer : y.timer).runCallLater(this, t)
            }, e._onActive = function () {
                M.spriteCount++
            }, e._onInActive = function () {
                M.spriteCount--
            }, e._onActiveInScene = function () {
            }, e._onInActiveInScene = function () {
            }, e._parse = function (t, e) {
            }, e._setBelongScene = function (t) {
                if (!this._scene) {
                    if (this._scene = t, this._components) for (var e = 0, i = this._components.length; e < i; e++) this._components[e]._setActiveInScene(!0);
                    for (this._onActiveInScene(), e = 0, i = this._children.length; e < i; e++) this._children[e]._setBelongScene(t)
                }
            }, e._setUnBelongScene = function () {
                if (this._scene !== this) {
                    if (this._onInActiveInScene(), this._components) for (var t = 0, e = this._components.length; t < e; t++) this._components[t]._setActiveInScene(!1);
                    for (this._scene = null, t = 0, e = this._children.length; t < e; t++) this._children[t]._setUnBelongScene()
                }
            }, e.onAwake = function () {
            }, e.onEnable = function () {
            }, e._processActive = function () {
                this._activeChangeScripts || (this._activeChangeScripts = []), this._activeHierarchy(this._activeChangeScripts), this._activeScripts()
            }, e._activeHierarchy = function (t) {
                if (this._setBit(2, !0), this._components) for (var e = 0, i = this._components.length; e < i; e++) {
                    var n = this._components[e];
                    n._setActive(!0), n._isScript() && n._enabled && t.push(n)
                }
                for (this._onActive(), e = 0, i = this._children.length; e < i; e++) {
                    var r = this._children[e];
                    !r._getBit(1) && r._activeHierarchy(t)
                }
                this._getBit(4) || (this._setBit(4, !0), this.onAwake()), this.onEnable()
            }, e._activeScripts = function () {
                for (var t = 0, e = this._activeChangeScripts.length; t < e; t++) this._activeChangeScripts[t].onEnable();
                this._activeChangeScripts.length = 0
            }, e._processInActive = function () {
                this._activeChangeScripts || (this._activeChangeScripts = []), this._inActiveHierarchy(this._activeChangeScripts), this._inActiveScripts()
            }, e._inActiveHierarchy = function (t) {
                if (this._onInActive(), this._components) for (var e = 0, i = this._components.length; e < i; e++) {
                    var n = this._components[e];
                    n._setActive(!1), n._isScript() && n._enabled && t.push(n)
                }
                for (this._setBit(2, !1), e = 0, i = this._children.length; e < i; e++) {
                    var r = this._children[e];
                    r && !r._getBit(1) && r._inActiveHierarchy(t)
                }
                this.onDisable()
            }, e._inActiveScripts = function () {
                for (var t = 0, e = this._activeChangeScripts.length; t < e; t++) this._activeChangeScripts[t].onDisable();
                this._activeChangeScripts.length = 0
            }, e.onDisable = function () {
            }, e._onAdded = function () {
                if (this._activeChangeScripts && 0 !== this._activeChangeScripts.length) throw"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";
                var t = this._parent.scene;
                t && this._setBelongScene(t), this._parent.activeInHierarchy && this.active && this._processActive()
            }, e._onRemoved = function () {
                if (this._activeChangeScripts && 0 !== this._activeChangeScripts.length) throw"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";
                this._parent.activeInHierarchy && this.active && this._processInActive(), this._parent.scene && this._setUnBelongScene()
            }, e._addComponentInstance = function (t) {
                this._components = this._components || [], this._components.push(t), t.owner = this, t._onAdded(), this.activeInHierarchy && (t._setActive(!0), t._isScript() && t._enabled && t.onEnable()), this._scene && t._setActiveInScene(!0)
            }, e._destroyComponent = function (t) {
                if (this._components) for (var e = 0, i = this._components.length; e < i; e++) {
                    var n = this._components[e];
                    if (n === t) {
                        n._destroy(), this._components.splice(e, 1);
                        break
                    }
                }
            }, e._destroyAllComponent = function () {
                if (this._components) {
                    for (var t = 0, e = this._components.length; t < e; t++) {
                        this._components[t]._destroy()
                    }
                    this._components.length = 0
                }
            }, e._cloneTo = function (t, e, i) {
                var n = t;
                if (this._components) for (var r = 0, s = this._components.length; r < s; r++) {
                    var a = n.addComponent(this._components[r].constructor);
                    this._components[r]._cloneTo(a)
                }
            }, e.addComponentIntance = function (t) {
                if (t.owner) throw"Node:the component has belong to other node.";
                if (t.isSingleton && this.getComponent(t.constructor)) throw"Node:the component is singleton,can't add the second one.";
                return this._addComponentInstance(t), t
            }, e.addComponent = function (t) {
                var e = W.createByClass(t);
                if (e._destroyed = !1, e.isSingleton && this.getComponent(t)) throw"无法实例" + t + "组件，" + t + "组件已存在！";
                return this._addComponentInstance(e), e
            }, e.getComponent = function (t) {
                if (this._components) for (var e = 0, i = this._components.length; e < i; e++) {
                    var n = this._components[e];
                    if (y.__typeof(n, t)) return n
                }
                return null
            }, e.getComponents = function (t) {
                var e;
                if (this._components) for (var i = 0, n = this._components.length; i < n; i++) {
                    var r = this._components[i];
                    y.__typeof(r, t) && (e = e || []).push(r)
                }
                return e
            }, d(0, e, "numChildren", function () {
                return this._children.length
            }), d(0, e, "parent", function () {
                return this._parent
            }), d(0, e, "activeInHierarchy", function () {
                return this._getBit(2)
            }), d(0, e, "active", function () {
                return !this._getBit(8) && !this._getBit(1)
            }, function (t) {
                if (t = !!t, !this._getBit(1) !== t) {
                    if (this._activeChangeScripts && 0 !== this._activeChangeScripts.length) throw t ? "Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event." : "Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";
                    this._setBit(1, !t), this._parent && this._parent.activeInHierarchy && (t ? this._processActive() : this._processInActive())
                }
            }), d(0, e, "displayedInStage", function () {
                return this._getBit(16) || this._setBitUp(16), this._getBit(128)
            }), d(0, e, "scene", function () {
                return this._scene
            }), d(0, e, "timer", function () {
                return this.scene ? this.scene.timer : y.timer
            }), a.ARRAY_EMPTY = [], a
        }()), Ae = function (t) {
            function e() {
                this.url = null, this.loops = 0, this.startTime = NaN, this.isStopped = !1, this.completeHandler = null, e.__super.call(this)
            }

            x(e, "laya.media.SoundChannel", g);
            var i = e.prototype;
            return i.play = function () {
            }, i.stop = function () {
                this.completeHandler && this.completeHandler.run()
            }, i.pause = function () {
            }, i.resume = function () {
            }, i.__runComplete = function (t) {
                t && t.run()
            }, d(0, i, "volume", function () {
                return 1
            }, function (t) {
            }), d(0, i, "position", function () {
                return 0
            }), d(0, i, "duration", function () {
                return 0
            }), e
        }(), Me = function (t) {
            function i() {
                this._id = 0, this._url = null, this._cpuMemory = 0, this._gpuMemory = 0, this._destroyed = !1, this._referenceCount = 0, this.lock = !1, this.name = null, i.__super.call(this), this._id = ++i._uniqueIDCounter, this._destroyed = !1, this._referenceCount = 0, (i._idResourcesMap[this.id] = this).lock = !1
            }

            x(i, "laya.resource.Resource", g);
            var e = i.prototype;
            return y.imps(e, {
                "laya.resource.ICreateResource": !0,
                "laya.resource.IDestroy": !0
            }), e._setCPUMemory = function (t) {
                var e = t - this._cpuMemory;
                this._cpuMemory = t, i._addCPUMemory(e)
            }, e._setGPUMemory = function (t) {
                var e = t - this._gpuMemory;
                this._gpuMemory = t, i._addGPUMemory(e)
            }, e._setCreateURL = function (t) {
                var e;
                (t = q.formatURL(t), this._url !== t) && (this._url && ((e = i._urlResourcesMap[this._url]).splice(e.indexOf(this), 1), 0 === e.length && delete i._urlResourcesMap[this._url]), t && ((e = i._urlResourcesMap[t]) || (i._urlResourcesMap[t] = e = []), e.push(this)), this._url = t)
            }, e._addReference = function (t) {
                void 0 === t && (t = 1), this._referenceCount += t
            }, e._removeReference = function (t) {
                void 0 === t && (t = 1), this._referenceCount -= t
            }, e._clearReference = function () {
                this._referenceCount = 0
            }, e._recoverResource = function () {
            }, e._disposeResource = function () {
            }, e._activeResource = function () {
            }, e.destroy = function () {
                var t;
                this._destroyed || (this._destroyed = !0, this.lock = !1, this._disposeResource(), delete i._idResourcesMap[this.id], this._url && ((t = i._urlResourcesMap[this._url]) && (t.splice(t.indexOf(this), 1), 0 === t.length && delete i._urlResourcesMap[this._url]), De.getRes(this._url) == this && delete De.loadedMap[this._url]))
            }, d(0, e, "id", function () {
                return this._id
            }), d(0, e, "gpuMemory", function () {
                return this._gpuMemory
            }), d(0, e, "url", function () {
                return this._url
            }), d(0, e, "cpuMemory", function () {
                return this._cpuMemory
            }), d(0, e, "destroyed", function () {
                return this._destroyed
            }), d(0, e, "referenceCount", function () {
                return this._referenceCount
            }), d(1, i, "cpuMemory", function () {
                return this._cpuMemory
            }, laya.events.EventDispatcher._$SET_cpuMemory), d(1, i, "gpuMemory", function () {
                return this._gpuMemory
            }, laya.events.EventDispatcher._$SET_gpuMemory), i._addCPUMemory = function (t) {
                this._cpuMemory += t
            }, i._addGPUMemory = function (t) {
                this._gpuMemory += t
            }, i._addMemory = function (t, e) {
                this._cpuMemory += t, this._gpuMemory += e
            }, i.getResourceByID = function (t) {
                return i._idResourcesMap[t]
            }, i.getResourceByURL = function (t, e) {
                return void 0 === e && (e = 0), i._urlResourcesMap[t][e]
            }, i.destroyUnusedResources = function () {
                for (var t in i._idResourcesMap) {
                    var e = i._idResourcesMap[t];
                    e.lock || 0 !== e._referenceCount || e.destroy()
                }
            }, i._uniqueIDCounter = 0, i._idResourcesMap = {}, i._urlResourcesMap = {}, i._cpuMemory = 0, i._gpuMemory = 0, i
        }(), Ee = function (t) {
            function i() {
                i.__super.call(this, 12, 4, 4), this.canReuse = !0, this.setAttributes(laya.webgl.utils.MeshVG._fixattriInfo)
            }

            x(i, "laya.webgl.utils.MeshVG", C);
            var e = i.prototype;
            return e.addVertAndIBToMesh = function (t, e, i, n) {
                for (var r = this._vb.needSize(e.length / 2 * 12) >> 2, s = this._vb._floatArray32 || this._vb.getFloat32Array(), a = this._vb._uint32Array, o = 0, h = e.length / 2, l = 0; l < h; l++) s[r++] = e[o], s[r++] = e[o + 1], o += 2, a[r++] = i;
                this._vb.setNeedUpload(), this._ib.append(new Uint16Array(n)), this._ib.setNeedUpload(), this.vertNum += h, this.indexNum += n.length
            }, e.releaseMesh = function () {
                this._vb.setByteLength(0), this._ib.setByteLength(0), this.vertNum = 0, this.indexNum = 0, laya.webgl.utils.MeshVG._POOL.push(this)
            }, e.destroy = function () {
                this._ib.destroy(), this._vb.destroy(), this._ib.disposeResource(), this._vb.deleteBuffer()
            }, i.getAMesh = function (t) {
                var e;
                return e = laya.webgl.utils.MeshVG._POOL.length ? laya.webgl.utils.MeshVG._POOL.pop() : new i, t && e._vb._resizeBuffer(786432, !1), e
            }, i.const_stride = 12, i._POOL = [], a(i, ["_fixattriInfo", function () {
                return this._fixattriInfo = [5126, 2, 0, 5121, 4, 8]
            }]), i
        }(), Se = function (t) {
            var o;

            function s() {
                this._labelDic = null, this._tweenDic = {}, this._tweenDataList = [], this._endTweenDataList = null, this._currTime = 0, this._lastTime = 0, this._startTime = 0, this._index = 0, this._gidIndex = 0, this._firstTweenDic = {}, this._startTimeSort = !1, this._endTimeSort = !1, this._loopKey = !1, this.scale = 1, this._frameRate = 60, this._frameIndex = 0, this._total = 0, s.__super.call(this)
            }

            x(s, "laya.utils.TimeLine", g);
            var e = s.prototype;
            return e.to = function (t, e, i, n, r) {
                return void 0 === r && (r = 0), this._create(t, e, i, n, r, !0)
            }, e.from = function (t, e, i, n, r) {
                return void 0 === r && (r = 0), this._create(t, e, i, n, r, !1)
            }, e._create = function (t, e, i, n, r, s) {
                var a = W.getItemByClass("tweenData", o);
                return a.isTo = s, a.type = 0, a.target = t, a.duration = i, a.data = e, a.startTime = this._startTime + r, a.endTime = a.startTime + a.duration, a.ease = n, this._startTime = Math.max(a.endTime, this._startTime), this._tweenDataList.push(a), this._startTimeSort = !0, this._endTimeSort = !0, this
            }, e.addLabel = function (t, e) {
                var i = W.getItemByClass("tweenData", o);
                return i.type = 1, i.data = t, i.endTime = i.startTime = this._startTime + e, this._labelDic || (this._labelDic = {}), this._labelDic[t] = i, this._tweenDataList.push(i), this
            }, e.removeLabel = function (t) {
                if (this._labelDic && this._labelDic[t]) {
                    var e = this._labelDic[t];
                    if (e) {
                        var i = this._tweenDataList.indexOf(e);
                        -1 < i && this._tweenDataList.splice(i, 1)
                    }
                    delete this._labelDic[t]
                }
            }, e.gotoTime = function (t) {
                if (null != this._tweenDataList && 0 != this._tweenDataList.length) {
                    var e, i, n, r;
                    for (var s in this._firstTweenDic) if (i = this._firstTweenDic[s]) for (var a in i) i.diyTarget.hasOwnProperty(a) && (i.diyTarget[a] = i[a]);
                    for (s in this._tweenDic) (e = this._tweenDic[s]).clear(), delete this._tweenDic[s];
                    if (this._index = 0, this._gidIndex = 0, this._currTime = t, this._lastTime = Lt.now(), null == this._endTweenDataList || this._endTimeSort) {
                        this._endTimeSort = !1, this._endTweenDataList = n = this._tweenDataList.concat(), n.sort(function (t, e) {
                            return t.endTime > e.endTime ? 1 : t.endTime < e.endTime ? -1 : 0
                        })
                    } else n = this._endTweenDataList;
                    for (var o = 0, h = n.length; o < h; o++) if (0 == (r = n[o]).type) {
                        if (!(t >= r.endTime)) break;
                        this._index = Math.max(this._index, o + 1);
                        var l = r.data;
                        if (r.isTo) for (var u in l) r.target[u] = l[u]
                    }
                    for (o = 0, h = this._tweenDataList.length; o < h; o++) 0 == (r = this._tweenDataList[o]).type && t >= r.startTime && t < r.endTime && (this._index = Math.max(this._index, o + 1), this._gidIndex++, (e = W.getItemByClass("tween", j))._create(r.target, r.data, r.duration, r.ease, b.create(this, this._animComplete, [this._gidIndex]), 0, !1, r.isTo, !0, !1), e.setStartTime(this._currTime - (t - r.startTime)), e._updateEase(this._currTime), e.gid = this._gidIndex, this._tweenDic[this._gidIndex] = e)
                }
            }, e.gotoLabel = function (t) {
                if (null != this._labelDic) {
                    var e = this._labelDic[t];
                    e && this.gotoTime(e.startTime)
                }
            }, e.pause = function () {
                y.timer.clear(this, this._update)
            }, e.resume = function () {
                this.play(this._currTime, this._loopKey)
            }, e.play = function (t, e) {
                if (void 0 === t && (t = 0), void 0 === e && (e = !1), this._tweenDataList) {
                    if (this._startTimeSort) {
                        this._startTimeSort = !1, this._tweenDataList.sort(function (t, e) {
                            return t.startTime > e.startTime ? 1 : t.startTime < e.startTime ? -1 : 0
                        });
                        for (var i = 0, n = this._tweenDataList.length; i < n; i++) {
                            var r = this._tweenDataList[i];
                            if (null != r && 0 == r.type) {
                                var s = r.target, a = s.$_GID || (s.$_GID = ne.getGID()), o = null;
                                for (var h in null == this._firstTweenDic[a] ? ((o = {}).diyTarget = s, this._firstTweenDic[a] = o) : o = this._firstTweenDic[a], r.data) null == o[h] && (o[h] = s[h])
                            }
                        }
                    }
                    "string" == typeof t ? this.gotoLabel(t) : this.gotoTime(t), this._loopKey = e, this._lastTime = Lt.now(), y.timer.frameLoop(1, this, this._update)
                }
            }, e._update = function () {
                if (this._currTime >= this._startTime) {
                    if (!this._loopKey) {
                        for (var t in this._tweenDic) (e = this._tweenDic[t]).complete();
                        return this._complete(), void this.pause()
                    }
                    if (this._complete(), !this._tweenDataList) return;
                    this.gotoTime(0)
                }
                var e, i = Lt.now(), n = i - this._lastTime, r = this._currTime += n * this.scale;
                for (t in this._lastTime = i, this._tweenDic) (e = this._tweenDic[t])._updateEase(r);
                if (0 != this._tweenDataList.length && this._index < this._tweenDataList.length) {
                    var s = this._tweenDataList[this._index];
                    r >= s.startTime && (this._index++, 0 == s.type ? (this._gidIndex++, (e = W.getItemByClass("tween", j))._create(s.target, s.data, s.duration, s.ease, b.create(this, this._animComplete, [this._gidIndex]), 0, !1, s.isTo, !0, !1), e.setStartTime(r), e.gid = this._gidIndex, (this._tweenDic[this._gidIndex] = e)._updateEase(r)) : this.event("label", s.data))
                }
            }, e._animComplete = function (t) {
                this._tweenDic[t] && delete this._tweenDic[t]
            }, e._complete = function () {
                this.event("complete")
            }, e.reset = function () {
                var t;
                if (this._labelDic) for (t in this._labelDic) delete this._labelDic[t];
                for (t in this._tweenDic) this._tweenDic[t].clear(), delete this._tweenDic[t];
                for (t in this._firstTweenDic) delete this._firstTweenDic[t];
                if (this._endTweenDataList = null, this._tweenDataList && this._tweenDataList.length) {
                    var e, i = 0;
                    for (e = this._tweenDataList.length, i = 0; i < e; i++) this._tweenDataList[i] && this._tweenDataList[i].destroy()
                }
                this._tweenDataList.length = 0, this._currTime = 0, this._lastTime = 0, this._startTime = 0, this._index = 0, this._gidIndex = 0, this.scale = 1, y.timer.clear(this, this._update)
            }, e.destroy = function () {
                this.reset(), this._labelDic = null, this._tweenDic = null, this._tweenDataList = null, this._firstTweenDic = null
            }, d(0, e, "index", function () {
                return this._frameIndex
            }, function (t) {
                this._frameIndex = t, this.gotoTime(this._frameIndex / this._frameRate * 1e3)
            }), d(0, e, "total", function () {
                return this._total = Math.floor(this._startTime / 1e3 * this._frameRate), this._total
            }), s.to = function (t, e, i, n, r) {
                return void 0 === r && (r = 0), (new s).to(t, e, i, n, r)
            }, s.from = function (t, e, i, n, r) {
                return void 0 === r && (r = 0), (new s).from(t, e, i, n, r)
            }, s.__init$ = function () {
                o = function () {
                    function t() {
                        this.type = 0, this.isTo = !0, this.startTime = NaN, this.endTime = NaN, this.target = null, this.duration = NaN, this.ease = null, this.data = null
                    }

                    return x(t, ""), t.prototype.destroy = function () {
                        this.target = null, this.ease = null, this.data = null, this.isTo = !0, this.type = 0, W.recover("tweenData", this)
                    }, t
                }()
            }, s
        }(), Re = function (t) {
            function i() {
                i.__super.call(this, i.__name2int, i.__int2name, i.__int2nameMap)
            }

            return x(i, "laya.webgl.shader.d2.ShaderDefines2D", L), i.__init__ = function () {
                i.reg("TEXTURE2D", 1), i.reg("PRIMITIVE", 4), i.reg("GLOW_FILTER", 8), i.reg("BLUR_FILTER", 16), i.reg("COLOR_FILTER", 32), i.reg("COLOR_ADD", 64), i.reg("WORLDMAT", 128), i.reg("FILLTEXTURE", 256), i.reg("FSHIGHPRECISION", 1024), i.reg("MVP3D", 2048)
            }, i.reg = function (t, e) {
                L._reg(t, e, i.__name2int, i.__int2name)
            }, i.toText = function (t, e, i) {
                return L._toText(t, e, i)
            }, i.toInt = function (t) {
                return L._toInt(t, i.__name2int)
            }, i.TEXTURE2D = 1, i.PRIMITIVE = 4, i.FILTERGLOW = 8, i.FILTERBLUR = 16, i.FILTERCOLOR = 32, i.COLORADD = 64, i.WORLDMAT = 128, i.FILLTEXTURE = 256, i.SKINMESH = 512, i.SHADERDEFINE_FSHIGHPRECISION = 1024, i.MVP3D = 2048, i.NOOPTMASK = 312, i.__name2int = {}, i.__int2name = [], i.__int2nameMap = [], i
        }(), Ie = function (t) {
            function C(t, e, i, n) {
                this.uvrect = [0, 0, 1, 1], this._destroyed = !1, this._referenceCount = 0, this.$_GID = 0, this.offsetX = 0, this.offsetY = 0, this._w = 0, this._h = 0, this.sourceWidth = 0, this.sourceHeight = 0, this.url = null, this.scaleRate = 1, C.__super.call(this), void 0 === i && (i = 0), void 0 === n && (n = 0), this.setTo(t, e, i, n)
            }

            x(C, "laya.resource.Texture", g);
            var e = C.prototype;
            return e._addReference = function () {
                this._bitmap && this._bitmap._addReference(), this._referenceCount++
            }, e._removeReference = function () {
                this._bitmap && this._bitmap._removeReference(), this._referenceCount--
            }, e._getSource = function (t) {
                return this._destroyed || !this._bitmap ? null : (this.recoverBitmap(t), this._bitmap.destroyed ? null : this.bitmap._getSource())
            }, e._onLoaded = function (t, e) {
                if (e) if (e == this) ; else if (e instanceof laya.resource.Texture) {
                    var i = e;
                    C._create(e, 0, 0, i.width, i.height, 0, 0, i.sourceWidth, i.sourceHeight, this)
                } else this.bitmap = e, this.sourceWidth = this._w = e.width, this.sourceHeight = this._h = e.height; else ;
                t && t.run(), this.event("ready", this)
            }, e.getIsReady = function () {
                return !this._destroyed && !!this._bitmap
            }, e.setTo = function (t, e, i, n) {
                void 0 === i && (i = 0), void 0 === n && (n = 0), this.bitmap = t, this.sourceWidth = i, this.sourceHeight = n, t && (this._w = t.width, this._h = t.height, this.sourceWidth = this.sourceWidth || t.width, this.sourceHeight = this.sourceHeight || t.height), this.uv = e || C.DEF_UV
            }, e.load = function (t, e) {
                this._destroyed || y.loader.load(t, b.create(this, this._onLoaded, [e]), null, "htmlimage", 1, !1, null, !0)
            }, e.getTexturePixels = function (t, e, i, n) {
                var r = 0, s = 0, a = 0, o = this.bitmap, h = o.width, l = o.height;
                if (h < t + i && (i -= t + i - h), l < e + n && (n -= e + n - l), i <= 0 || n <= 0) return null;
                var u = 4 * i, c = null;
                try {
                    c = o.getPixels()
                } catch (t) {
                }
                if (c) {
                    if (0 == t && 0 == e && i == h && n == l) return c;
                    var _ = new Uint8Array(i * n * 4);
                    for (s = (e + n - 1) * (u = 4 * h) + (r = 4 * t), a = n - 1; 0 <= a; a--) _.set(y.slice(s, s + 4 * i), r), r += u, s -= u;
                    return _
                }
                var f = new ct;
                f.size(i, n), f.asBitmap = !0;
                var d = null;
                if (0 != t || 0 != e || i != h || n != l) {
                    var p = (d = d.concat())[0], m = d[1], g = (d[2] - p) / h, v = (d[7] - m) / l;
                    d = [p + t * g, m + e * v, p + (t + i) * g, m + e * v, p + (t + i) * g, m + (e + n) * v, p + t * g, m + (e + n) * v]
                }
                f._drawTextureM(this, 0, 0, i, n, null, 1, d), f._targets.start(), f.flush(), f._targets.end(), f._targets.restore();
                var y = f._targets.getData(0, 0, i, n);
                for (f.destroy(), _ = new Uint8Array(i * n * 4), r = 0, s = (n - 1) * u, a = n - 1; 0 <= a; a--) _.set(y.slice(s, s + u), r), r += u, s -= u;
                return _
            }, e.getPixels = function (t, e, i, n) {
                return Rt.isConchApp ? this._nativeObj.getImageData(t, e, i, n) : this.getTexturePixels(t, e, i, n)
            }, e.recoverBitmap = function (e) {
                var i = this, t = this._bitmap.url;
                this._destroyed || this._bitmap && !this._bitmap.destroyed || !t || y.loader.load(t, b.create(this, function (t) {
                    i.bitmap = t, e && e()
                }), null, "htmlimage", 1, !1, null, !0)
            }, e.disposeBitmap = function () {
                !this._destroyed && this._bitmap && this._bitmap.destroy()
            }, e.destroy = function (t) {
                if (void 0 === t && (t = !1), !this._destroyed) {
                    this._destroyed = !0;
                    var e = this._bitmap;
                    e && (e._removeReference(this._referenceCount), (0 === e.referenceCount || t) && e.destroy(), e = null), this.url && this === y.loader.getRes(this.url) && y.loader.clearRes(this.url)
                }
            }, d(0, e, "height", function () {
                return this._h ? this._h : this.bitmap ? this.uv && this.uv !== C.DEF_UV ? (this.uv[5] - this.uv[1]) * this.bitmap.height : this.bitmap.height : 0
            }, function (t) {
                this._h = t, this.sourceHeight || (this.sourceHeight = t)
            }), d(0, e, "uv", function () {
                return this._uv
            }, function (t) {
                this.uvrect[0] = Math.min(t[0], t[2], t[4], t[6]), this.uvrect[1] = Math.min(t[1], t[3], t[5], t[7]), this.uvrect[2] = Math.max(t[0], t[2], t[4], t[6]) - this.uvrect[0], this.uvrect[3] = Math.max(t[1], t[3], t[5], t[7]) - this.uvrect[1], this._uv = t
            }), d(0, e, "width", function () {
                return this._w ? this._w : this.bitmap ? this.uv && this.uv !== C.DEF_UV ? (this.uv[2] - this.uv[0]) * this.bitmap.width : this.bitmap.width : 0
            }, function (t) {
                this._w = t, this.sourceWidth || (this.sourceWidth = t)
            }), d(0, e, "bitmap", function () {
                return this._bitmap
            }, function (t) {
                this._bitmap && this._bitmap._removeReference(this._referenceCount), (this._bitmap = t) && t._addReference(this._referenceCount)
            }), d(0, e, "destroyed", function () {
                return this._destroyed
            }), C.moveUV = function (t, e, i) {
                for (var n = 0; n < 8; n += 2) i[n] += t, i[n + 1] += e;
                return i
            }, C.create = function (t, e, i, n, r, s, a, o, h) {
                return void 0 === s && (s = 0), void 0 === a && (a = 0), void 0 === o && (o = 0), void 0 === h && (h = 0), C._create(t, e, i, n, r, s, a, o, h)
            }, C._create = function (t, e, i, n, r, s, a, o, h, l) {
                void 0 === s && (s = 0), void 0 === a && (a = 0), void 0 === o && (o = 0), void 0 === h && (h = 0);
                var u, c = t instanceof laya.resource.Texture, _ = c ? t.uv : C.DEF_UV, f = c ? t.bitmap : t;
                f.width && e + n > f.width && (n = f.width - e), f.height && i + r > f.height && (r = f.height - i), l ? (u = l).setTo(f, null, o || n, h || r) : u = new C(f, null, o || n, h || r), u.width = n, u.height = r, u.offsetX = s, u.offsetY = a;
                var d = 1 / f.width, p = 1 / f.height;
                e *= d, i *= p, n *= d, r *= p;
                var m = u.uv[0], g = u.uv[1], v = u.uv[4], y = u.uv[5], x = v - m, T = y - g,
                    b = C.moveUV(_[0], _[1], [e, i, e + n, i, e + n, i + r, e, i + r]);
                u.uv = new Float32Array([m + b[0] * x, g + b[1] * T, v - (1 - b[2]) * x, g + b[3] * T, v - (1 - b[4]) * x, y - (1 - b[5]) * T, m + b[6] * x, y - (1 - b[7]) * T]);
                var w = f.scaleRate;
                return u.scaleRate = w && 1 != w ? (u.sourceWidth /= w, u.sourceHeight /= w, u.width /= w, u.height /= w, w) : 1, u
            }, C.createFromTexture = function (t, e, i, n, r) {
                var s = t.scaleRate;
                1 != s && (e *= s, i *= s, n *= s, r *= s);
                var a = gt.TEMP.setTo(e - t.offsetX, i - t.offsetY, n, r),
                    o = a.intersection(C._rect1.setTo(0, 0, t.width, t.height), C._rect2);
                return o ? C.create(t, o.x, o.y, o.width, o.height, o.x - a.x, o.y - a.y, n, r) : null
            }, C.DEF_UV = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]), C.NO_UV = new Float32Array([0, 0, 0, 0, 0, 0, 0, 0]), C.INV_UV = new Float32Array([0, 1, 1, 1, 1, 0, 0, 0]), C._rect1 = new gt, C._rect2 = new gt, C
        }(), Pe = function (t) {
            function e() {
                this._responseType = null, this._data = null, this._url = null, e.__super.call(this), this._http = new Lt.window.XMLHttpRequest
            }

            x(e, "laya.net.HttpRequest", g);
            var i = e.prototype;
            return i.send = function (t, e, i, n, r) {
                void 0 === i && (i = "get"), void 0 === n && (n = "text"), this._responseType = n, this._data = null, (Lt.onQGMiniGame || Lt.onVVMiniGame || Lt.onQQMiniGame) && (t = encodeURI(t)), this._url = t;
                var s = this, a = this._http;
                if (t = q.getAdptedFilePath(t), a.open(i, t, !0), r) for (var o = 0; o < r.length; o++) a.setRequestHeader(r[o++], r[o]); else Rt.isConchApp || (e && "string" != typeof e ? a.setRequestHeader("Content-Type", "application/json") : a.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"));
                a.responseType = "arraybuffer" !== n ? "text" : "arraybuffer", a.onerror = function (t) {
                    s._onError(t)
                }, a.onabort = function (t) {
                    s._onAbort(t)
                }, a.onprogress = function (t) {
                    s._onProgress(t)
                }, a.onload = function (t) {
                    s._onLoad(t)
                }, a.send(e)
            }, i._onProgress = function (t) {
                t && t.lengthComputable && this.event("progress", t.loaded / t.total)
            }, i._onAbort = function (t) {
                this.error("Request was aborted by user")
            }, i._onError = function (t) {
                this.error("Request failed Status:" + this._http.status + " text:" + this._http.statusText)
            }, i._onLoad = function (t) {
                var e = this._http, i = void 0 !== e.status ? e.status : 200;
                200 === i || 204 === i || 0 === i ? this.complete() : this.error("[" + e.status + "]" + e.statusText + ":" + e.responseURL)
            }, i.error = function (t) {
                this.clear(), this.event("error", t)
            }, i.complete = function () {
                this.clear();
                var e = !0;
                try {
                    "json" === this._responseType ? this._data = JSON.parse(this._http.responseText) : "xml" === this._responseType ? this._data = ne.parseXMLFromString(this._http.responseText) : this._data = this._http.response || this._http.responseText
                } catch (t) {
                    e = !1, this.error(t.message)
                }
                e && this.event("complete", this._data instanceof Array ? [this._data] : this._data)
            }, i.clear = function () {
                var t = this._http;
                t.onerror = t.onabort = t.onprogress = t.onload = null
            }, d(0, i, "url", function () {
                return this._url
            }), d(0, i, "http", function () {
                return this._http
            }), d(0, i, "data", function () {
                return this._data
            }), e
        }(), De = function (t) {
            function M() {
                this._data = null, this._url = null, this._type = null, this._cache = !1, this._http = null, this._useWorkerLoader = !1, this._customParse = !1, this._constructParams = null, this._propertyParams = null, this._createCache = !1, M.__super.call(this)
            }

            x(M, "laya.net.Loader", g);
            var e = M.prototype;
            return e.load = function (t, e, i, n, r, s) {
                if (void 0 === i && (i = !0), void 0 === r && (r = !1), void 0 === s && (s = !1), t) {
                    if (M.setGroup(t, "666"), 0 === (this._url = t).indexOf("data:image") ? e = "image" : t = q.formatURL(t), this._type = e || (e = M.getTypeFromUrl(this._url)), this._cache = i, this._useWorkerLoader = s, this._data = null, s && Ge.enableWorkerLoader(), !r && M.loadedMap[t]) return this._data = M.loadedMap[t], this.event("progress", 1), void this.event("complete", this._data);
                    if (n && M.setGroup(t, n), null != M.parserMap[e]) return this._customParse = !0, void (M.parserMap[e] instanceof laya.utils.Handler ? M.parserMap[e].runWith(this) : M.parserMap[e].call(null, this));
                    if ("image" === e || "htmlimage" === e || "nativeimage" === e) return this._loadImage(t);
                    if ("sound" === e) return this._loadSound(t);
                    if ("ttf" === e) return this._loadTTF(t);
                    var a;
                    switch (e) {
                        case"atlas":
                        case"prefab":
                        case"plf":
                            a = "json";
                            break;
                        case"font":
                            a = "xml";
                            break;
                        case"plfb":
                            a = "arraybuffer";
                            break;
                        default:
                            a = e
                    }
                    M.preLoadedMap[t] ? this.onLoaded(M.preLoadedMap[t]) : (Lt.onVVMiniGame ? (this._http = new Pe, this._http.on("progress", this, this.onProgress), this._http.on("error", this, this.onError), this._http.on("complete", this, this.onLoaded)) : this._http || (this._http = new Pe, this._http.on("progress", this, this.onProgress), this._http.on("error", this, this.onError), this._http.on("complete", this, this.onLoaded)), this._http.send(t, null, "get", a))
                } else this.onLoaded(null)
            }, e._loadTTF = function (t) {
                t = q.formatURL(t);
                var e = new k;
                e.complete = b.create(this, this.onLoaded), e.load(t)
            }, e._loadImage = function (i) {
                i = q.formatURL(i);
                var n, r = this;

                function s() {
                    var t = n;
                    t && (t.onload = null, t.onerror = null, delete M._imgCache[i])
                }

                var t = function () {
                    s(), r.event("error", "Load image failed")
                };
                if ("nativeimage" === this._type) {
                    var e = function () {
                        s(), r.onLoaded(n)
                    };
                    (n = new Lt.window.Image).crossOrigin = "", n.onload = e, n.onerror = t, n.src = i, M._imgCache[i] = n
                } else {
                    var a = ne.getFileExtension(i);
                    if ("ktx" === a || "pvr" === a) {
                        var o;
                        e = function (t) {
                            var e = 0;
                            switch (a) {
                                case"ktx":
                                    e = 5;
                                    break;
                                case"pvr":
                                    e = 12
                            }
                            (n = new _i(0, 0, e, !1, !1)).wrapModeU = 1, n.wrapModeV = 1, n.setCompressData(t), n._setCreateURL(i), s(), r.onLoaded(n)
                        }, (o = new Pe).on("error", null, t), o.on("complete", null, e), o.send(i, null, "get", "arraybuffer")
                    } else {
                        var h = new Lt.window.Image;
                        e = function () {
                            var t = new _i(h.width, h.height, 1, !1, !1);
                            t.wrapModeU = 1, t.wrapModeV = 1, t.loadImageSource(h, !0), t._setCreateURL(i), s(), r.onLoaded(t)
                        }, h.crossOrigin = "", h.onload = e, h.onerror = t, h.src = i, M._imgCache[i] = h
                    }
                }
            }, e._loadSound = function (t) {
                var e = new xe._soundClass, i = this;

                function n() {
                    e.offAll()
                }

                e.on("complete", this, function () {
                    n(), i.onLoaded(e)
                }), e.on("error", this, function () {
                    n(), e.dispose(), i.event("error", "Load sound failed")
                }), e.load(t)
            }, e.onProgress = function (t) {
                "atlas" === this._type ? this.event("progress", .3 * t) : this.event("progress", t)
            }, e.onError = function (t) {
                this.event("error", t)
            }, e.onLoaded = function (t) {
                var e = this._type;
                if ("plfb" == e) this.parsePLFBData(t), this.complete(t); else if ("plf" == e) this.parsePLFData(t), this.complete(t); else if ("image" === e) {
                    var i = new Ie(t);
                    i.url = this._url, this.complete(i)
                } else if ("sound" === e || "htmlimage" === e || "nativeimage" === e) this.complete(t); else if ("atlas" === e) {
                    if (!t.url && !t._setContext) {
                        if (!this._data) {
                            if ((this._data = t).meta && t.meta.image) {
                                var n, r = t.meta.image.split(","), s = 0 <= this._url.indexOf("/") ? "/" : "\\",
                                    a = this._url.lastIndexOf(s), o = 0 <= a ? this._url.substr(0, a + 1) : "";
                                Lt.onAndroid && t.meta.compressTextureAndroid && (n = ".ktx"), Lt.onIOS && t.meta.compressTextureIOS && (n = ".pvr");
                                for (var h = 0, l = r.length; h < l; h++) r[h] = n ? o + r[h].replace(".png", n) : o + r[h]
                            } else r = [this._url.replace(".json", ".png")];
                            r.reverse(), t.toLoads = r, t.pics = []
                        }
                        return this.event("progress", .3 + 1 / r.length * .6), this._loadImage(r.pop())
                    }
                    if (this._data.pics.push(t), 0 < this._data.toLoads.length) return this.event("progress", .3 + 1 / this._data.toLoads.length * .6), this._loadImage(this._data.toLoads.pop());
                    var u = this._data.frames, c = this._url.split("?")[0],
                        _ = this._data.meta && this._data.meta.prefix ? this._data.meta.prefix : c.substring(0, c.lastIndexOf(".")) + "/",
                        f = this._data.pics, d = q.formatURL(this._url), p = M.atlasMap[d] || (M.atlasMap[d] = []);
                    p.dir = _;
                    var m = 1;
                    if (this._data.meta && this._data.meta.scale && 1 != this._data.meta.scale) for (var g in m = parseFloat(this._data.meta.scale), u) {
                        var v, y = u[g], x = f[y.frame.idx ? y.frame.idx : 0], T = q.formatURL(_ + g);
                        x.scaleRate = m, v = Ie._create(x, y.frame.x, y.frame.y, y.frame.w, y.frame.h, y.spriteSourceSize.x, y.spriteSourceSize.y, y.sourceSize.w, y.sourceSize.h, laya.net.Loader.getRes(T)), M.cacheRes(T, v), v.url = T, p.push(T)
                    } else for (g in u) x = f[(y = u[g]).frame.idx ? y.frame.idx : 0], T = q.formatURL(_ + g), v = Ie._create(x, y.frame.x, y.frame.y, y.frame.w, y.frame.h, y.spriteSourceSize.x, y.spriteSourceSize.y, y.sourceSize.w, y.sourceSize.h, laya.net.Loader.getRes(T)), M.cacheRes(T, v), v.url = T, p.push(T);
                    delete this._data.pics, this.complete(this._data)
                } else if ("font" === e) {
                    if (!t._source) return this._data = t, this.event("progress", .5), this._loadImage(this._url.replace(".fnt", ".png"));
                    var b = new B;
                    b.parseFont(this._data, new Ie(t));
                    var w = this._url.split(".fnt")[0].split("/"), C = w[w.length - 1];
                    ei.registerBitmapFont(C, b), this._data = b, this.complete(this._data)
                } else if ("prefab" === e) {
                    var A = new ge;
                    A.json = t, this.complete(A)
                } else this.complete(t)
            }, e.parsePLFData = function (t) {
                var e, i, n;
                for (e in t) switch (n = t[e], e) {
                    case"json":
                    case"text":
                        for (i in n) M.preLoadedMap[q.formatURL(i)] = n[i];
                        break;
                    default:
                        for (i in n) M.preLoadedMap[q.formatURL(i)] = n[i]
                }
            }, e.parsePLFBData = function (t) {
                var e, i, n = 0;
                for (i = (e = new $t(t)).getInt32(), n = 0; n < i; n++) this.parseOnePLFBFile(e)
            }, e.parseOnePLFBFile = function (t) {
                var e, i, n;
                i = t.getUTFString(), e = t.getInt32(), n = t.readArrayBuffer(e), M.preLoadedMap[q.formatURL(i)] = n
            }, e.complete = function (t) {
                this._data = t, this._customParse ? this.event("loaded", t instanceof Array ? [t] : t) : (M._loaders.push(this), M._isWorking || M.checkNext())
            }, e.endLoad = function (t) {
                t && (this._data = t), this._cache && M.cacheRes(this._url, this._data), this.event("progress", 1), this.event("complete", this.data instanceof Array ? [this.data] : this.data)
            }, d(0, e, "url", function () {
                return this._url
            }), d(0, e, "data", function () {
                return this._data
            }), d(0, e, "cache", function () {
                return this._cache
            }), d(0, e, "type", function () {
                return this._type
            }), M.getTypeFromUrl = function (t) {
                var e = ne.getFileExtension(t);
                return e ? M.typeMap[e] : "text"
            }, M.checkNext = function () {
                M._isWorking = !0;
                for (var t = Lt.now(); M._startIndex < M._loaders.length;) if (Lt.now(), M._loaders[M._startIndex].endLoad(), M._startIndex++, Lt.now() - t > M.maxTimeOut) return void y.systemTimer.frameOnce(1, null, M.checkNext);
                M._loaders.length = 0, M._startIndex = 0, M._isWorking = !1
            }, M.clearRes = function (t) {
                t = q.formatURL(t);
                var e = M.getAtlas(t);
                if (e) {
                    for (var i = 0, n = e.length; i < n; i++) {
                        var r = e[i], s = M.getRes(r);
                        delete M.loadedMap[r], s && s.destroy()
                    }
                    e.length = 0, delete M.atlasMap[t], delete M.loadedMap[t]
                } else {
                    var a = M.loadedMap[t];
                    a && (delete M.loadedMap[t], a instanceof laya.resource.Texture && a.bitmap && a.destroy())
                }
            }, M.clearTextureRes = function (t) {
                t = q.formatURL(t);
                var e = laya.net.Loader.getAtlas(t),
                    i = e && 0 < e.length ? laya.net.Loader.getRes(e[0]) : laya.net.Loader.getRes(t);
                i instanceof laya.resource.Texture && i.disposeBitmap()
            }, M.getRes = function (t) {
                return M.loadedMap[q.formatURL(t)]
            }, M.getAtlas = function (t) {
                return M.atlasMap[q.formatURL(t)]
            }, M.cacheRes = function (t, e) {
                t = q.formatURL(t), null != M.loadedMap[t] || (M.loadedMap[t] = e)
            }, M.setGroup = function (t, e) {
                M.groupMap[e] || (M.groupMap[e] = []), M.groupMap[e].push(t)
            }, M.clearResByGroup = function (t) {
                if (M.groupMap[t]) {
                    var e = M.groupMap[t], i = 0, n = e.length;
                    for (i = 0; i < n; i++) M.clearRes(e[i]);
                    e.length = 0
                }
            }, M.TEXT = "text", M.JSON = "json", M.PREFAB = "prefab", M.XML = "xml", M.BUFFER = "arraybuffer", M.IMAGE = "image", M.SOUND = "sound", M.ATLAS = "atlas", M.FONT = "font", M.TTF = "ttf", M.PLF = "plf", M.PLFB = "plfb", M.HIERARCHY = "HIERARCHY", M.MESH = "MESH", M.MATERIAL = "MATERIAL", M.TEXTURE2D = "TEXTURE2D", M.TEXTURECUBE = "TEXTURECUBE", M.ANIMATIONCLIP = "ANIMATIONCLIP", M.AVATAR = "AVATAR", M.TERRAINHEIGHTDATA = "TERRAINHEIGHTDATA", M.TERRAINRES = "TERRAIN", M.typeMap = {
                ttf: "ttf",
                png: "image",
                jpg: "image",
                jpeg: "image",
                ktx: "image",
                pvr: "image",
                txt: "text",
                json: "json",
                prefab: "prefab",
                xml: "xml",
                als: "atlas",
                atlas: "atlas",
                mp3: "sound",
                ogg: "sound",
                wav: "sound",
                part: "json",
                fnt: "font",
                plf: "plf",
                plfb: "plfb",
                scene: "json",
                ani: "json",
                sk: "arraybuffer"
            }, M.parserMap = {}, M.maxTimeOut = 100, M.groupMap = {}, M.loadedMap = {}, M.atlasMap = {}, M.preLoadedMap = {}, M._imgCache = {}, M._loaders = [], M._isWorking = !1, M._startIndex = 0, M
        }(), Le = (function (t) {
            function e(t) {
                this.strength = NaN, this.strength_sig2_2sig2_gauss1 = [], this.strength_sig2_native = null, this.renderFunc = null, e.__super.call(this), void 0 === t && (t = 4), this.strength = t, this._glRender = new _t
            }

            x(e, "laya.filters.BlurFilter", l);
            var i = e.prototype;
            i.getStrenth_sig2_2sig2_native = function () {
                this.strength_sig2_native || (this.strength_sig2_native = new Float32Array(4));
                var t = this.strength / 3, e = t * t;
                return this.strength_sig2_native[0] = this.strength, this.strength_sig2_native[1] = e, this.strength_sig2_native[2] = 2 * e, this.strength_sig2_native[3] = 1 / (2 * Math.PI * e), this.strength_sig2_native
            }, d(0, i, "type", function () {
                return 16
            })
        }(), function (t) {
            function e() {
                this._maxsize = 0, this._upload = !0, this._uploadSize = 0, this._bufferSize = 0, this._u8Array = null, e.__super.call(this)
            }

            x(e, "laya.webgl.utils.Buffer2D", V);
            var i = e.prototype;
            return i.setByteLength = function (t) {
                this._byteLength !== t && (t <= this._bufferSize || this._resizeBuffer(2 * t + 256, !0), this._byteLength = t)
            }, i.needSize = function (t) {
                var e = this._byteLength;
                if (t) {
                    var i = this._byteLength + t;
                    i <= this._bufferSize || this._resizeBuffer(i << 1, !0), this._byteLength = i
                }
                return e
            }, i._bufferData = function () {
                this._maxsize = Math.max(this._maxsize, this._byteLength), M.loopCount % 30 == 0 && (this._buffer.byteLength > this._maxsize + 64 && (this._buffer = this._buffer.slice(0, this._maxsize + 64), this._bufferSize = this._buffer.byteLength, this._checkArrayUse()), this._maxsize = this._byteLength), this._uploadSize < this._buffer.byteLength && (this._uploadSize = this._buffer.byteLength, Dt.instance.bufferData(this._bufferType, this._uploadSize, this._bufferUsage)), Dt.instance.bufferSubData(this._bufferType, 0, new Uint8Array(this._buffer, 0, this._byteLength))
            }, i._bufferSubData = function (t, e, i) {
                if (void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), this._maxsize = Math.max(this._maxsize, this._byteLength), M.loopCount % 30 == 0 && (this._buffer.byteLength > this._maxsize + 64 && (this._buffer = this._buffer.slice(0, this._maxsize + 64), this._bufferSize = this._buffer.byteLength, this._checkArrayUse()), this._maxsize = this._byteLength), this._uploadSize < this._buffer.byteLength && (this._uploadSize = this._buffer.byteLength, Dt.instance.bufferData(this._bufferType, this._uploadSize, this._bufferUsage)), e || i) {
                    var n = this._buffer.slice(e, i);
                    Dt.instance.bufferSubData(this._bufferType, t, n)
                } else Dt.instance.bufferSubData(this._bufferType, t, this._buffer)
            }, i._checkArrayUse = function () {
            }, i._bind_uploadForVAO = function () {
                return !!this._upload && (this._upload = !1, this._bindForVAO(), this._bufferData(), !0)
            }, i._bind_upload = function () {
                return !!this._upload && (this._upload = !1, this.bind(), this._bufferData(), !0)
            }, i._bind_subUpload = function (t, e, i) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), !!this._upload && (this._upload = !1, this.bind(), this._bufferSubData(t, e, i), !0)
            }, i._resizeBuffer = function (t, e) {
                var i = this._buffer;
                if (t <= i.byteLength) return this;
                var n = this._u8Array;
                if (e && i && 0 < i.byteLength) {
                    var r = new ArrayBuffer(t), s = n && n.buffer == i ? n : new Uint8Array(i);
                    (n = this._u8Array = new Uint8Array(r)).set(s, 0), i = this._buffer = r
                } else i = this._buffer = new ArrayBuffer(t), this._u8Array = null;
                return this._checkArrayUse(), this._upload = !0, this._bufferSize = i.byteLength, this
            }, i.append = function (t) {
                this._upload = !0;
                var e, i;
                e = t.byteLength, t instanceof Uint8Array ? (this._resizeBuffer(this._byteLength + e, !0), i = new Uint8Array(this._buffer, this._byteLength)) : t instanceof Uint16Array ? (this._resizeBuffer(this._byteLength + e, !0), i = new Uint16Array(this._buffer, this._byteLength)) : t instanceof Float32Array && (this._resizeBuffer(this._byteLength + e, !0), i = new Float32Array(this._buffer, this._byteLength)), i.set(t, 0), this._byteLength += e, this._checkArrayUse()
            }, i.appendU16Array = function (t, e) {
                this._resizeBuffer(this._byteLength + 2 * e, !0);
                var i = new Uint16Array(this._buffer, this._byteLength, e);
                if (6 == e) i[0] = t[0], i[1] = t[1], i[2] = t[2], i[3] = t[3], i[4] = t[4], i[5] = t[5]; else if (100 <= e) i.set(new Uint16Array(t.buffer, 0, e)); else for (var n = 0; n < e; n++) i[n] = t[n];
                this._byteLength += 2 * e, this._checkArrayUse()
            }, i.appendEx = function (t, e) {
                this._upload = !0;
                var i;
                i = t.byteLength, this._resizeBuffer(this._byteLength + i, !0), new e(this._buffer, this._byteLength).set(t, 0), this._byteLength += i, this._checkArrayUse()
            }, i.appendEx2 = function (t, e, i, n) {
                void 0 === n && (n = 1), this._upload = !0;
                var r, s;
                r = i * n, this._resizeBuffer(this._byteLength + r, !0), s = new e(this._buffer, this._byteLength);
                var a = 0;
                for (a = 0; a < i; a++) s[a] = t[a];
                this._byteLength += r, this._checkArrayUse()
            }, i.getBuffer = function () {
                return this._buffer
            }, i.setNeedUpload = function () {
                this._upload = !0
            }, i.getNeedUpload = function () {
                return this._upload
            }, i.upload = function () {
                var t = this._bind_upload();
                return Dt.instance.bindBuffer(this._bufferType, null), 34962 == this._bufferType && (V._bindedVertexBuffer = null), 34963 == this._bufferType && (V._bindedIndexBuffer = null), Ke.activeShader = null, t
            }, i.subUpload = function (t, e, i) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0);
                var n = this._bind_subUpload();
                return Dt.instance.bindBuffer(this._bufferType, null), 34962 == this._bufferType && (V._bindedVertexBuffer = null), 34963 == this._bufferType && (V._bindedIndexBuffer = null), Ke.activeShader = null, n
            }, i._disposeResource = function () {
                this._upload = !0, this._uploadSize = 0
            }, i.clear = function () {
                this._byteLength = 0, this._upload = !0
            }, d(0, i, "bufferLength", function () {
                return this._buffer.byteLength
            }), d(0, i, "byteLength", null, function (t) {
                this.setByteLength(t)
            }), e.__int__ = function (t) {
            }, e.FLOAT32 = 4, e.SHORT = 2, e
        }()), Be = (function (t) {
            function r(t, e, i, n) {
                this._sv_blurInfo2 = [0, 0, 1, 0], this._color = null, this._color_native = null, this._blurInof1_native = null, this._blurInof2_native = null, r.__super.call(this), this._elements = new Float32Array(9), this._sv_blurInfo1 = new Array(4), void 0 === e && (e = 4), void 0 === i && (i = 6), void 0 === n && (n = 6), this._color = new p(t), this.blur = Math.min(e, 20), this.offX = i, this.offY = n, this._sv_blurInfo1[0] = this._sv_blurInfo1[1] = this.blur, this._sv_blurInfo1[2] = i, this._sv_blurInfo1[3] = -n, this._glRender = new ue
            }

            x(r, "laya.filters.GlowFilter", l);
            var e = r.prototype;
            e.getColor = function () {
                return this._color.arrColor
            }, e.getColorNative = function () {
                this._color_native || (this._color_native = new Float32Array(4));
                var t = this.getColor();
                return this._color_native[0] = t[0], this._color_native[1] = t[1], this._color_native[2] = t[2], this._color_native[3] = t[3], this._color_native
            }, e.getBlurInfo1Native = function () {
                return this._blurInof1_native || (this._blurInof1_native = new Float32Array(4)), this._blurInof1_native[0] = this._blurInof1_native[1] = this.blur, this._blurInof1_native[2] = this.offX, this._blurInof1_native[3] = this.offY, this._blurInof1_native
            }, e.getBlurInfo2Native = function () {
                return this._blurInof2_native || (this._blurInof2_native = new Float32Array(4)), this._blurInof2_native[2] = 1, this._blurInof2_native
            }, d(0, e, "type", function () {
                return 8
            }), d(0, e, "offY", function () {
                return this._elements[6]
            }, function (t) {
                this._elements[6] = t, this._sv_blurInfo1[3] = -t
            }), d(0, e, "offX", function () {
                return this._elements[5]
            }, function (t) {
                this._elements[5] = t, this._sv_blurInfo1[2] = t
            }), d(0, e, "blur", function () {
                return this._elements[4]
            }, function (t) {
                this._elements[4] = t, this._sv_blurInfo1[0] = this._sv_blurInfo1[1] = t
            })
        }(), function (t) {
            function n() {
                this.url = null, this.loaded = !1, this.data = null, this.audioBuffer = null, this.__toPlays = null, this._disposed = !1, n.__super.call(this)
            }

            x(n, "laya.media.webaudio.WebAudioSound", g);
            var e = n.prototype;
            return e.load = function (t) {
                var e = this;
                if (t = q.formatURL(t), this.url = t, this.audioBuffer = n._dataCache[t], this.audioBuffer) this._loaded(this.audioBuffer); else if (n.e.on("loaded:" + t, this, this._loaded), n.e.on("err:" + t, this, this._err), !n.__loadingSound[t]) {
                    n.__loadingSound[t] = !0;
                    var i = new Lt.window.XMLHttpRequest;
                    i.open("GET", t, !0), i.responseType = "arraybuffer", i.onload = function () {
                        e._disposed ? e._removeLoadEvents() : (e.data = i.response, n.buffs.push({
                            buffer: e.data,
                            url: e.url
                        }), n.decode())
                    }, i.onerror = function (t) {
                        e._err()
                    }, i.send()
                }
            }, e._err = function () {
                this._removeLoadEvents(), n.__loadingSound[this.url] = !1, this.event("error")
            }, e._loaded = function (t) {
                this._removeLoadEvents(), this._disposed || (this.audioBuffer = t, n._dataCache[this.url] = this.audioBuffer, this.loaded = !0, this.event("complete"))
            }, e._removeLoadEvents = function () {
                n.e.off("loaded:" + this.url, this, this._loaded), n.e.off("err:" + this.url, this, this._err)
            }, e.__playAfterLoaded = function () {
                if (this.__toPlays) {
                    var t, e, i, n = 0;
                    for (t = (e = this.__toPlays).length, n = 0; n < t; n++) (i = e[n])[2] && !i[2].isStopped && this.play(i[0], i[1], i[2]);
                    this.__toPlays.length = 0
                }
            }, e.play = function (t, e, i) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), i = i || new Ze, this.audioBuffer || this.url && (this.__toPlays || (this.__toPlays = []), this.__toPlays.push([t, e, i]), this.once("complete", this, this.__playAfterLoaded), this.load(this.url)), i.url = this.url, i.loops = e, i.audioBuffer = this.audioBuffer, i.startTime = t, i.play(), xe.addChannel(i), i
            }, e.dispose = function () {
                this._disposed = !0, delete n._dataCache[this.url], delete n.__loadingSound[this.url], this.audioBuffer = null, this.data = null, this.__toPlays = []
            }, d(0, e, "duration", function () {
                return this.audioBuffer ? this.audioBuffer.duration : 0
            }), n.decode = function () {
                n.buffs.length <= 0 || n.isDecoding || (n.isDecoding = !0, n.tInfo = n.buffs.shift(), n.ctx.decodeAudioData(n.tInfo.buffer, n._done, n._fail))
            }, n._done = function (t) {
                n.e.event("loaded:" + n.tInfo.url, t), n.isDecoding = !1, n.decode()
            }, n._fail = function () {
                n.e.event("err:" + n.tInfo.url, null), n.isDecoding = !1, n.decode()
            }, n._playEmptySound = function () {
                if (null != n.ctx) {
                    var t = n.ctx.createBufferSource();
                    t.buffer = n._miniBuffer, t.connect(n.ctx.destination), t.start(0, 0, 0)
                }
            }, n._unlock = function () {
                n._unlocked || (n._playEmptySound(), "running" == n.ctx.state && (Lt.document.removeEventListener("mousedown", n._unlock, !0), Lt.document.removeEventListener("touchend", n._unlock, !0), Lt.document.removeEventListener("touchstart", n._unlock, !0), n._unlocked = !0))
            }, n.initWebAudio = function () {
                "running" != n.ctx.state && (n._unlock(), Lt.document.addEventListener("mousedown", n._unlock, !0), Lt.document.addEventListener("touchend", n._unlock, !0), Lt.document.addEventListener("touchstart", n._unlock, !0))
            }, n._dataCache = {}, n.buffs = [], n.isDecoding = !1, n._unlocked = !1, n.tInfo = null, n.__loadingSound = {}, a(n, ["window", function () {
                return this.window = Lt.window
            }, "webAudioEnabled", function () {
                return this.webAudioEnabled = n.window.AudioContext || n.window.webkitAudioContext || n.window.mozAudioContext
            }, "ctx", function () {
                return this.ctx = n.webAudioEnabled ? new (n.window.AudioContext || n.window.webkitAudioContext || n.window.mozAudioContext) : void 0
            }, "_miniBuffer", function () {
                return this._miniBuffer = n.ctx.createBuffer(1, 1, 22050)
            }, "e", function () {
                return this.e = new g
            }]), n
        }()), Fe = function (t) {
            function i() {
                i.__super.call(this, 24, 4, 4), this.canReuse = !0, this.setAttributes(laya.webgl.utils.MeshQuadTexture._fixattriInfo), laya.webgl.utils.MeshQuadTexture._fixib ? (this._ib = laya.webgl.utils.MeshQuadTexture._fixib, this._quadNum = i._maxIB) : (this.createQuadIB(i._maxIB), laya.webgl.utils.MeshQuadTexture._fixib = this._ib)
            }

            x(i, "laya.webgl.utils.MeshQuadTexture", C);
            var e = i.prototype;
            return e.releaseMesh = function () {
                this._vb.setByteLength(0), this.vertNum = 0, this.indexNum = 0, laya.webgl.utils.MeshQuadTexture._POOL.push(this)
            }, e.destroy = function () {
                this._vb.destroy(), this._vb.deleteBuffer()
            }, e.addQuad = function (t, e, i, n) {
                var r = this._vb, s = r._byteLength >> 2;
                r.setByteLength(s + 24 << 2);
                var a = r._floatArray32 || r.getFloat32Array(), o = r._uint32Array, h = s, l = n ? 255 : 0;
                a[h++] = t[0], a[h++] = t[1], a[h++] = e[0], a[h++] = e[1], o[h++] = i, o[h++] = l, a[h++] = t[2], a[h++] = t[3], a[h++] = e[2], a[h++] = e[3], o[h++] = i, o[h++] = l, a[h++] = t[4], a[h++] = t[5], a[h++] = e[4], a[h++] = e[5], o[h++] = i, o[h++] = l, a[h++] = t[6], a[h++] = t[7], a[h++] = e[6], a[h++] = e[7], o[h++] = i, o[h++] = l, r._upload = !0
            }, i.getAMesh = function (t) {
                var e = null;
                return e = laya.webgl.utils.MeshQuadTexture._POOL.length ? laya.webgl.utils.MeshQuadTexture._POOL.pop() : new i, t && e._vb._resizeBuffer(1572864, !1), e
            }, i.const_stride = 24, i._fixib = null, i._maxIB = 16384, i._POOL = [], a(i, ["_fixattriInfo", function () {
                return this._fixattriInfo = [5126, 4, 0, 5121, 4, 16, 5121, 4, 20]
            }]), i
        }(), Oe = (function (t) {
            function r(t, e, i, n) {
                this._endian = null, this._socket = null, this._connected = !1, this._addInputPosition = 0, this._input = null, this._output = null, this.disableInput = !1, this._byteClass = null, this.protocols = [], r.__super.call(this), void 0 === e && (e = 0), this._byteClass = i || $t, this.protocols = n, this.endian = "bigEndian", t && 0 < e && e < 65535 && this.connect(t, e)
            }

            x(r, "laya.net.Socket", g);
            var e = r.prototype;
            e.connect = function (t, e) {
                var i = "ws://" + t + ":" + e;
                this.connectByUrl(i)
            }, e.connectByUrl = function (t) {
                var e = this;
                null != this._socket && this.close(), this._socket && this.cleanSocket(), this.protocols && 0 != this.protocols.length ? this._socket = new Lt.window.WebSocket(t, this.protocols) : this._socket = new Lt.window.WebSocket(t), this._socket.binaryType = "arraybuffer", this._output = new this._byteClass, this._output.endian = this.endian, this._input = new this._byteClass, this._input.endian = this.endian, this._addInputPosition = 0, this._socket.onopen = function (t) {
                    e._onOpen(t)
                }, this._socket.onmessage = function (t) {
                    e._onMessage(t)
                }, this._socket.onclose = function (t) {
                    e._onClose(t)
                }, this._socket.onerror = function (t) {
                    e._onError(t)
                }
            }, e.cleanSocket = function () {
                this.close(), this._connected = !1, this._socket.onopen = null, this._socket.onmessage = null, this._socket.onclose = null, this._socket.onerror = null, this._socket = null
            }, e.close = function () {
                if (null != this._socket) try {
                    this._socket.close()
                } catch (t) {
                }
            }, e._onOpen = function (t) {
                this._connected = !0, this.event("open", t)
            }, e._onMessage = function (t) {
                if (t && t.data) {
                    var e = t.data;
                    if (this.disableInput && e) this.event("message", e); else {
                        0 < this._input.length && this._input.bytesAvailable < 1 && (this._input.clear(), this._addInputPosition = 0);
                        var i = this._input.pos;
                        !this._addInputPosition && (this._addInputPosition = 0), this._input.pos = this._addInputPosition, e && ("string" == typeof e ? this._input.writeUTFBytes(e) : this._input.writeArrayBuffer(e), this._addInputPosition = this._input.pos, this._input.pos = i), this.event("message", e)
                    }
                }
            }, e._onClose = function (t) {
                this._connected = !1, this.event("close", t)
            }, e._onError = function (t) {
                this.event("error", t)
            }, e.send = function (t) {
                this._socket.send(t)
            }, e.flush = function () {
                if (this._output && 0 < this._output.length) {
                    var e;
                    try {
                        this._socket && this._socket.send(this._output.__getBuffer().slice(0, this._output.length))
                    } catch (t) {
                        e = t
                    }
                    this._output.endian = this.endian, this._output.clear(), e && this.event("error", e)
                }
            }, d(0, e, "input", function () {
                return this._input
            }), d(0, e, "output", function () {
                return this._output
            }), d(0, e, "connected", function () {
                return this._connected
            }), d(0, e, "endian", function () {
                return this._endian
            }, function (t) {
                this._endian = t, null != this._input && (this._input.endian = t), null != this._output && (this._output.endian = t)
            }), r.LITTLE_ENDIAN = "littleEndian", r.BIG_ENDIAN = "bigEndian"
        }(), function (t) {
            function e(t) {
                this.u_colorMatrix = null, this.strength = 0, this.blurInfo = null, this.colorMat = null, this.colorAlpha = null, void 0 === t && (t = 0), e.__super.call(this, 1, t), this._attribLocation = ["posuv", 0, "attribColor", 1, "attribFlags", 2]
            }

            return x(e, "laya.webgl.shader.d2.value.TextureSV", Y), e.prototype.clear = function () {
                this.texture = null, this.shader = null, this.defines._value = this.subID + (Ct.shaderHighPrecision ? 1024 : 0)
            }, e
        }()), Ne = (function (t) {
            function e() {
                e.__super.call(this)
            }

            x(e, "laya.components.CommonScript", r);
            var i = e.prototype;
            i.onAwake = function () {
            }, i.onEnable = function () {
            }, i.onStart = function () {
            }, i.onUpdate = function () {
            }, i.onLateUpdate = function () {
            }, i.onDisable = function () {
            }, i.onDestroy = function () {
            }, d(0, i, "isSingleton", function () {
                return !1
            })
        }(), function (t) {
            var f;

            function d() {
                this.retryNum = 1, this.retryDelay = 0, this.maxLoader = 5, this._loaders = [], this._loaderCount = 0, this._resInfos = [], this._infoPool = [], this._maxPriority = 5, this._failRes = {}, this._statInfo = {
                    count: 1,
                    loaded: 1
                }, d.__super.call(this);
                for (var t = 0; t < this._maxPriority; t++) this._resInfos[t] = []
            }

            x(d, "laya.net.LoaderManager", g);
            var e = d.prototype;
            return e.getProgress = function () {
                return this._statInfo.loaded / this._statInfo.count
            }, e.resetProgress = function () {
                this._statInfo.count = this._statInfo.loaded = 1
            }, e.create = function (t, e, i, n, r, s, a, o) {
                void 0 === a && (a = 1), void 0 === o && (o = !0), this._create(t, !0, e, i, n, r, s, a, o)
            }, e._create = function (t, e, i, n, r, s, a, o, h) {
                if (void 0 === o && (o = 1), void 0 === h && (h = !0), t instanceof Array) {
                    var l = !0, u = t, c = u.length, _ = 0;
                    if (n) var f = b.create(n.caller, n.method, n.args, !1);
                    for (var d = 0; d < c; d++) {
                        var p = u[d];
                        "string" == typeof p && (p = u[d] = {url: p}), p.progress = 0
                    }
                    for (d = 0; d < c; d++) {
                        p = u[d];
                        var m = n ? b.create(null, y, [p], !1) : null, g = n || i ? b.create(null, v, [p]) : null;
                        this._createOne(p.url, e, g, m, p.type || r, p.constructParams || s, p.propertyParams || a, p.priority || o, h)
                    }

                    function v(t, e) {
                        _++, t.progress = 1, e || (l = !1), _ === c && i && i.runWith(l)
                    }

                    function y(t, e) {
                        t.progress = e;
                        for (var i = 0, n = 0; n < c; n++) {
                            i += u[n].progress
                        }
                        var r = i / c;
                        f.runWith(r)
                    }
                } else this._createOne(t, e, i, n, r, s, a, o, h)
            }, e._createOne = function (e, i, n, t, r, s, a, o, h) {
                void 0 === o && (o = 1), void 0 === h && (h = !0);
                var l = this.getRes(e);
                if (l) !i && l instanceof laya.resource.Resource && l._addReference(), t && t.runWith(1), n && n.runWith(l); else {
                    var u = ne.getFileExtension(e);
                    if (r || (r = d.createMap[u] ? d.createMap[u][0] : null), !r) return void this.load(e, n, t, r, o, h);
                    if (!De.parserMap[r]) return void this.load(e, n, t, r, o, h);
                    this._createLoad(e, b.create(null, function (t) {
                        t && (!i && t instanceof laya.resource.Resource && t._addReference(), t._setCreateURL(e));
                        n && n.runWith(t), y.loader.event(e)
                    }), t, r, s, a, o, h, !0)
                }
            }, e.load = function (t, e, i, n, r, s, a, o, h) {
                var l = this;
                if (void 0 === r && (r = 1), void 0 === s && (s = !0), void 0 === o && (o = !1), void 0 === h && (h = !1), t instanceof Array) return this._loadAssets(t, e, i, n, r, s, a);
                var u = De.getRes(t);
                if (o || null == u) {
                    var c;
                    c = t, (t = _e.getFileLoadPath(t)) != c && "nativeimage" !== n ? n = "atlas" : c = null;
                    var _ = d._resMap[t];
                    _ ? (e && (c ? e && _._createListener("complete", this, this._resInfoLoaded, [c, e], !1, !1) : e && _._createListener("complete", e.caller, e.method, e.args, !1, !1)), i && _._createListener("progress", i.caller, i.method, i.args, !1, !1)) : ((_ = this._infoPool.length ? this._infoPool.pop() : new f).url = t, _.type = n, _.cache = s, _.group = a, _.ignoreCache = o, _.useWorkerLoader = h, _.originalUrl = c, e && _.on("complete", e.caller, e.method, e.args), i && _.on("progress", i.caller, i.method, i.args), d._resMap[t] = _, r = r < this._maxPriority ? r : this._maxPriority - 1, this._resInfos[r].push(_), this._statInfo.count++, this.event("progress", this.getProgress()), this._next())
                } else y.systemTimer.frameOnce(1, null, function () {
                    i && i.runWith(1), e && e.runWith(u instanceof Array ? [u] : u), l._loaderCount || l.event("complete")
                });
                return this
            }, e._resInfoLoaded = function (t, e) {
                e.runWith(De.getRes(t))
            }, e._createLoad = function (t, e, i, n, r, s, a, o, h) {
                var l = this;
                if (void 0 === a && (a = 1), void 0 === o && (o = !0), void 0 === h && (h = !1), t instanceof Array) return this._loadAssets(t, e, i, n, a, o);
                var u = De.getRes(t);
                if (null != u) y.systemTimer.frameOnce(1, null, function () {
                    i && i.runWith(1), e && e.runWith(u), l._loaderCount || l.event("complete")
                }); else {
                    var c = d._resMap[t];
                    c ? (e && c._createListener("complete", e.caller, e.method, e.args, !1, !1), i && c._createListener("progress", i.caller, i.method, i.args, !1, !1)) : ((c = this._infoPool.length ? this._infoPool.pop() : new f).url = t, c.type = n, c.cache = !1, c.ignoreCache = h, c.originalUrl = null, c.createCache = o, c.createConstructParams = r, c.createPropertyParams = s, e && c.on("complete", e.caller, e.method, e.args), i && c.on("progress", i.caller, i.method, i.args), d._resMap[t] = c, a = a < this._maxPriority ? a : this._maxPriority - 1, this._resInfos[a].push(c), this._statInfo.count++, this.event("progress", this.getProgress()), this._next())
                }
                return this
            }, e._next = function () {
                if (!(this._loaderCount >= this.maxLoader)) {
                    for (var t = 0; t < this._maxPriority; t++) for (var e = this._resInfos[t]; 0 < e.length;) {
                        var i = e.shift();
                        if (i) return this._doLoad(i)
                    }
                    this._loaderCount || this.event("complete")
                }
            }, e._doLoad = function (e) {
                this._loaderCount++;
                var i = this._loaders.length ? this._loaders.pop() : new De;
                i.on("complete", null, r), i.on("progress", null, function (t) {
                    e.event("progress", t)
                }), i.on("error", null, function (t) {
                    r(null)
                });
                var n = this;

                function r(t) {
                    i.offAll(), i._data = null, i._customParse = !1, n._loaders.push(i), n._endLoad(e, t instanceof Array ? [t] : t), n._loaderCount--, n._next()
                }

                i._constructParams = e.createConstructParams, i._propertyParams = e.createPropertyParams, i._createCache = e.createCache, i.load(e.url, e.type, e.cache, e.group, e.ignoreCache, e.useWorkerLoader)
            }, e._endLoad = function (t, e) {
                var i = t.url;
                if (null == e) {
                    var n = this._failRes[i] || 0;
                    if (n < this.retryNum) return this._failRes[i] = n + 1, void y.systemTimer.once(this.retryDelay, this, this._addReTry, [t], !1);
                    De.clearRes(i), this.event("error", i)
                }
                this._failRes[i] && (this._failRes[i] = 0), delete d._resMap[i], t.originalUrl && (e = De.getRes(t.originalUrl)), t.event("complete", e), t.offAll(), this._infoPool.push(t), this._statInfo.loaded++, this.event("progress", this.getProgress())
            }, e._addReTry = function (t) {
                this._resInfos[this._maxPriority - 1].push(t), this._next()
            }, e.clearRes = function (t) {
                De.clearRes(t)
            }, e.clearTextureRes = function (t) {
                De.clearTextureRes(t)
            }, e.getRes = function (t) {
                return De.getRes(t)
            }, e.cacheRes = function (t, e) {
                De.cacheRes(t, e)
            }, e.setGroup = function (t, e) {
                De.setGroup(t, e)
            }, e.clearResByGroup = function (t) {
                De.clearResByGroup(t)
            }, e.clearUnLoaded = function () {
                for (var t = 0; t < this._maxPriority; t++) {
                    for (var e = this._resInfos[t], i = e.length - 1; -1 < i; i--) {
                        var n = e[i];
                        n && (n.offAll(), this._infoPool.push(n))
                    }
                    e.length = 0
                }
                this._loaderCount = 0, d._resMap = {}
            }, e.cancelLoadByUrls = function (t) {
                if (t) for (var e = 0, i = t.length; e < i; e++) this.cancelLoadByUrl(t[e])
            }, e.cancelLoadByUrl = function (t) {
                for (var e = 0; e < this._maxPriority; e++) for (var i = this._resInfos[e], n = i.length - 1; -1 < n; n--) {
                    var r = i[n];
                    r && r.url === t && (i[n] = null, r.offAll(), this._infoPool.push(r))
                }
                d._resMap[t] && delete d._resMap[t]
            }, e._loadAssets = function (t, i, a, e, n, r, s) {
                void 0 === n && (n = 1), void 0 === r && (r = !0);
                for (var o = t.length, h = 0, l = 0, u = [], c = !0, _ = 0; _ < o; _++) {
                    var f = t[_];
                    "string" == typeof f && (f = {
                        url: f,
                        type: e,
                        size: 1,
                        priority: n
                    }), f.size || (f.size = 1), f.progress = 0, l += f.size, u.push(f);
                    var d = a ? b.create(null, g, [f], !1) : null, p = i || a ? b.create(null, m, [f]) : null;
                    this.load(f.url, p, d, f.type, f.priority || 1, r, f.group || s, !1, f.useWorkerLoader)
                }

                function m(t, e) {
                    h++, t.progress = 1, e || (c = !1), h === o && i && i.runWith(c)
                }

                function g(t, e) {
                    if (null != a) {
                        t.progress = e;
                        for (var i = 0, n = 0; n < u.length; n++) {
                            var r = u[n];
                            i += r.size * r.progress
                        }
                        var s = i / l;
                        a.runWith(s)
                    }
                }

                return this
            }, e.decodeBitmaps = function (t) {
                var e, i = 0, n = t.length;
                for (e = Rt._context, i = 0; i < n; i++) {
                    var r, s;
                    if (r = De.getAtlas(t[i])) this._decodeTexture(r[0], e); else (s = this.getRes(t[i])) && s instanceof laya.resource.Texture && this._decodeTexture(s, e)
                }
            }, e._decodeTexture = function (t, e) {
                var i = t.bitmap;
                if (t && i) {
                    var n = i.source || i.image;
                    if (n && y.__typeof(n, Lt.window.HTMLImageElement)) {
                        e.drawImage(n, 0, 0, 1, 1);
                        e.getImageData(0, 0, 1, 1)
                    }
                }
            }, d.cacheRes = function (t, e) {
                De.cacheRes(t, e)
            }, d._resMap = {}, a(d, ["createMap", function () {
                return this.createMap = {atlas: [null, "atlas"]}
            }]), d.__init$ = function () {
                f = function (t) {
                    function e() {
                        this.url = null, this.type = null, this.cache = !1, this.group = null, this.ignoreCache = !1, this.useWorkerLoader = !1, this.originalUrl = null, this.createCache = !1, this.createConstructParams = null, this.createPropertyParams = null, e.__super.call(this)
                    }

                    return x(e, "", g), e
                }()
            }, d
        }()), ke = function (t) {
            function i() {
                i.__super.call(this, 24, 4, 4), this.canReuse = !0, this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)
            }

            x(i, "laya.webgl.utils.MeshTexture", C);
            var e = i.prototype;
            return e.addData = function (t, e, i, n, r) {
                var s = this._vb, a = this._ib, o = t.length >> 1, h = s.needSize(24 * o) >> 2,
                    l = s._floatArray32 || s.getFloat32Array(), u = s._uint32Array, c = 0, _ = n.a, f = n.b, d = n.c,
                    p = n.d, m = n.tx, g = n.ty, v = 0;
                for (v = 0; v < o; v++) {
                    var y = t[c], x = t[c + 1];
                    l[h] = y * _ + x * d + m, l[h + 1] = y * f + x * p + g, l[h + 2] = e[c], l[h + 3] = e[c + 1], u[h + 4] = r, u[h + 5] = 255, h += 6, c += 2
                }
                s.setNeedUpload();
                var T = this.vertNum, b = i.length, w = a.needSize(i.byteLength), C = a.getUint16Array(), A = w >> 1;
                if (0 < T) {
                    var M = A + b, E = 0;
                    for (v = A; v < M; v++, E++) C[v] = i[E] + T
                } else C.set(i, A);
                a.setNeedUpload(), this.vertNum += o, this.indexNum += i.length
            }, e.releaseMesh = function () {
                this._vb.setByteLength(0), this._ib.setByteLength(0), this.vertNum = 0, this.indexNum = 0, laya.webgl.utils.MeshTexture._POOL.push(this)
            }, e.destroy = function () {
                this._ib.destroy(), this._vb.destroy(), this._ib.disposeResource(), this._vb.deleteBuffer()
            }, i.getAMesh = function (t) {
                var e;
                return e = laya.webgl.utils.MeshTexture._POOL.length ? laya.webgl.utils.MeshTexture._POOL.pop() : new i, t && e._vb._resizeBuffer(1572864, !1), e
            }, i.const_stride = 24, i._POOL = [], a(i, ["_fixattriInfo", function () {
                return this._fixattriInfo = [5126, 4, 0, 5121, 4, 16, 5121, 4, 20]
            }]), i
        }(), Ue = function (t) {
            function n() {
                this.totalCount = 0, this._completeHandler = null, this._toLoadList = null, this._isLoading = !1, this._curUrl = null, n.__super.call(this), this._completeHandler = new b(this, this.onOneLoadComplete), this.reset()
            }

            x(n, "laya.net.SceneLoader", g);
            var e = n.prototype;
            return e.reset = function () {
                this._toLoadList = [], this._isLoading = !1, this.totalCount = 0
            }, e.load = function (t, e, i) {
                if (void 0 === e && (e = !1), void 0 === i && (i = !0), t instanceof Array) {
                    var n, r = 0;
                    for (n = t.length, r = 0; r < n; r++) this._addToLoadList(t[r], e)
                } else this._addToLoadList(t, e);
                i && this._checkNext()
            }, e._addToLoadList = function (t, e) {
                void 0 === e && (e = !1), 0 <= this._toLoadList.indexOf(t) || De.getRes(t) || (e ? this._toLoadList.push({url: t}) : this._toLoadList.push(t), this.totalCount++)
            }, e._checkNext = function () {
                if (!this._isLoading) {
                    if (0 == this._toLoadList.length) return void this.event("complete");
                    var t;
                    "string" == typeof (t = this._toLoadList.pop()) ? this.loadOne(t) : this.loadOne(t.url, !0)
                }
            }, e.loadOne = function (t, e) {
                void 0 === e && (e = !1), this._curUrl = t;
                var i = ne.getFileExtension(this._curUrl);
                e ? y.loader.create(t, this._completeHandler) : n.LoadableExtensions[i] ? y.loader.load(t, this._completeHandler, null, n.LoadableExtensions[i]) : t != _e.getFileLoadPath(t) || n.No3dLoadTypes[i] || !Ne.createMap[i] ? y.loader.load(t, this._completeHandler) : y.loader.create(t, this._completeHandler)
            }, e.onOneLoadComplete = function () {
                this._isLoading = !1, De.getRes(this._curUrl);
                var t, e = ne.getFileExtension(this._curUrl);
                n.LoadableExtensions[e] && ((t = De.getRes(this._curUrl)) && t instanceof laya.components.Prefab && (t = t.json), t && (t.loadList && this.load(t.loadList, !1, !1), t.loadList3D && this.load(t.loadList3D, !0, !1)));
                "sk" == e && this.load(this._curUrl.replace(".sk", ".png"), !1, !1), this.event("progress", this.getProgress()), this._checkNext()
            }, e.getProgress = function () {
                return this.loadedCount / this.totalCount
            }, d(0, e, "loadedCount", function () {
                return this.totalCount - this.leftCount
            }), d(0, e, "leftCount", function () {
                return this._isLoading ? this._toLoadList.length + 1 : this._toLoadList.length
            }), a(n, ["LoadableExtensions", function () {
                return this.LoadableExtensions = {
                    scene: "json",
                    scene3d: "json",
                    ani: "json",
                    ui: "json",
                    prefab: "prefab"
                }
            }, "No3dLoadTypes", function () {
                return this.No3dLoadTypes = {png: !0, jpg: !0, txt: !0}
            }]), n
        }(), We = function (t) {
            function e() {
                this.italic = !1, e.__super.call(this)
            }

            x(e, "laya.display.css.TextStyle", t);
            var i = e.prototype;
            return i.reset = function () {
                return t.prototype.reset.call(this), this.italic = !1, this.align = "left", this.wordWrap = !1, this.leading = 0, this.padding = [0, 0, 0, 0], this.bgColor = null, this.borderColor = null, this.asPassword = !1, this.stroke = 0, this.strokeColor = "#000000", this.bold = !1, this.underline = !1, this.underlineColor = null, this.currBitmapFont = null, this
            }, i.recover = function () {
                this !== e.EMPTY && W.recover("TextStyle", this.reset())
            }, i.render = function (t, e, i, n) {
                (this.bgColor || this.borderColor) && e.drawRect(i, n, t.width, t.height, this.bgColor, this.borderColor, 1)
            }, e.create = function () {
                return W.getItemByClass("TextStyle", e)
            }, e.EMPTY = new e, e
        }(J), Ge = function (t) {
            function r() {
                this.worker = null, this._useWorkerLoader = !1, r.__super.call(this);
                var e = this;
                this.worker = new Worker(r.workerPath), this.worker.onmessage = function (t) {
                    e.workerMessage(t.data)
                }
            }

            x(r, "laya.net.WorkerLoader", g);
            var e = r.prototype;
            return e.workerMessage = function (t) {
                if (t) switch (t.type) {
                    case"Image":
                        this.imageLoaded(t);
                        break;
                    case"Disable":
                        r.enable = !1
                }
            }, e.imageLoaded = function (t) {
                if (t.dataType && "imageBitmap" == t.dataType) {
                    var e = new si(!0), i = e.source.getContext("2d");
                    switch (t.dataType) {
                        case"imageBitmap":
                            var n = t.imageBitmap;
                            e.size(n.width, n.height), i.drawImage(n, 0, 0)
                    }
                    e._setGPUMemory(0);
                    var r = new _i;
                    r.loadImageSource(e.source), this.event(t.url, r)
                } else this.event(t.url, null)
            }, e.loadImage = function (t) {
                this.worker.postMessage(t)
            }, e._loadImage = function (e) {
                var i = this;
                if (this._useWorkerLoader && r._enable) {
                    e = q.formatURL(e);
                    var n = function (t) {
                        laya.net.WorkerLoader.I.off(e, i, n), t ? i.onLoaded(t) : r._preLoadFun.call(i, e)
                    };
                    laya.net.WorkerLoader.I.on(e, i, n), laya.net.WorkerLoader.I.loadImage(e)
                } else r._preLoadFun.call(i, e)
            }, d(1, r, "enable", function () {
                return r._enable
            }, function (t) {
                r._enable != t && (r._enable = t) && null == r._preLoadFun && (r._enable = r.__init__())
            }), r.__init__ = function () {
                return null == r._preLoadFun && (!!Worker && (r._preLoadFun = De.prototype._loadImage, De.prototype._loadImage = r.prototype._loadImage, r.I || (r.I = new r), !0))
            }, r.workerSupported = function () {
                return !!Worker
            }, r.enableWorkerLoader = function () {
                r._tryEnabled || (r.enable = !0, r._tryEnabled = !0)
            }, r.I = null, r.workerPath = "libs/workerloader.js", r._preLoadFun = null, r._enable = !1, r._tryEnabled = !1, r
        }(), Ve = function (t) {
            function e() {
                e.__super.call(this)
            }

            return x(e, "laya.webgl.BufferState2D", Tt), e
        }(), Xe = function (t) {
            function e(t) {
                e.__super.call(this, 4, 0), this._attribLocation = ["position", 0, "attribColor", 1]
            }

            return x(e, "laya.webgl.shader.d2.value.PrimitiveSV", Y), e
        }(), Ye = function (t) {
            function i(t) {
                this.texcoord = null, this.position = null, this.offsetX = 300, this.offsetY = 0, i.__super.call(this, 512, 0);
                var e = 8 * ft.BYTES_PE;
                this.position = [2, 5126, !1, e, 0], this.texcoord = [2, 5126, !1, e, 2 * ft.BYTES_PE], this.color = [4, 5126, !1, e, 4 * ft.BYTES_PE]
            }

            return x(i, "laya.webgl.shader.d2.skinAnishader.SkinSV", Y), i
        }(), He = function (t) {
            function f(t, e, i, n, r) {
                this.ctx = null, this.lastScaleX = 1, this.lastScaleY = 1, this.needResetScale = !1, this.maxTexW = 0, this.maxTexH = 0, this.scaleFontSize = !0, this.showDbgInfo = !1, this.supportImageData = !0, this.settrans = null, f.__super.call(this), void 0 === i && (i = !0), void 0 === n && (n = !0), void 0 === r && (r = !1), this.maxTexW = t, this.maxTexH = e, this.scaleFontSize = i, this.supportImageData = n, this.showDbgInfo = r, f.canvas || ((f.canvas = m.document.createElement("canvas")).width = 1024, f.canvas.height = 512, f.canvas.style.left = "-10000px", f.canvas.style.position = "absolute", s.body.appendChild(f.canvas), this.ctx = f.canvas.getContext("2d"), this.settrans = this.ctx._setTransform || this.ctx.setTransform)
            }

            x(f, "laya.webgl.text.CharRender_Canvas", te);
            var e = f.prototype;
            return e.getWidth = function (t, e) {
                return this.ctx ? (this.ctx._lastFont != t && (this.ctx.font = t, this.ctx._lastFont = t), this.ctx.measureText(e).width) : 0
            }, e.scale = function (t, e) {
                if (!this.supportImageData) return this.lastScaleX = t, void (this.lastScaleY = e);
                this.lastScaleX == t && this.lastScaleY == e || (this.settrans.call(this.ctx, t, 0, 0, e, 0, 0), this.lastScaleX = t, this.lastScaleY = e)
            }, e.getCharBmp = function (t, e, i, n, r, s, a, o, h, l, u) {
                if (!this.supportImageData) return this.getCharCanvas(t, e, i, n, r, s, a, o, h, l);
                var c = this.ctx;
                c.font != e && (c.font = e, c._lastFont = e), s.width = c.measureText(t).width;
                var _ = s.width * this.lastScaleX, f = s.height * this.lastScaleY;
                _ += (a + h) * this.lastScaleX, f += (o + l) * this.lastScaleY, _ = Math.ceil(_), f = Math.ceil(f);
                var d = (_ = Math.min(_, laya.webgl.text.CharRender_Canvas.canvas.width)) + 2 * i + 1,
                    p = (f = Math.min(f, laya.webgl.text.CharRender_Canvas.canvas.height)) + 2 * i + 1;
                u && (d = Math.max(d, u[0] + u[2] + 1), p = Math.max(p, u[1] + u[3] + 1)), c.clearRect(0, 0, d, p), c.save(), c.textBaseline = "top", 0 < i && (c.strokeStyle = r, c.lineWidth = i, c.strokeText(t, a, o)), c.fillStyle = n, c.fillText(t, a, o), this.showDbgInfo && (c.strokeStyle = "#ff0000", c.strokeRect(0, 0, _, f), c.strokeStyle = "#00ff00", c.strokeRect(a, o, s.width, s.height)), u && -1 == u[2] && (u[2] = Math.ceil((s.width + 2 * i) * this.lastScaleX));
                var m = u ? c.getImageData(u[0], u[1], u[2], u[3]) : c.getImageData(0, 0, _, f);
                return c.restore(), s.bmpWidth = m.width, s.bmpHeight = m.height, m
            }, e.getCharCanvas = function (t, e, i, n, r, s, a, o, h, l) {
                var u = this.ctx;
                u.font != e && (u.font = e, u._lastFont = e), s.width = u.measureText(t).width;
                var c = s.width * this.lastScaleX, _ = s.height * this.lastScaleY;
                return c += (a + h) * this.lastScaleX, _ += (o + l) * this.lastScaleY + 1, c = Math.min(c, this.maxTexW), _ = Math.min(_, this.maxTexH), f.canvas.width = Math.min(c + 1, this.maxTexW), f.canvas.height = Math.min(_ + 1, this.maxTexH), u.font = e, u.clearRect(0, 0, c + 1 + i, _ + 1 + i), this.settrans.call(u, 1, 0, 0, 1, 0, 0), u.save(), this.scaleFontSize && u.scale(this.lastScaleX, this.lastScaleY), u.translate(a, o), u.textAlign = "left", u.textBaseline = "top", 0 < i ? (u.strokeStyle = r, u.fillStyle = n, u.lineWidth = i, u.fillAndStrokeText ? u.fillAndStrokeText(t, 0, 0) : (u.strokeText(t, 0, 0), u.fillText(t, 0, 0))) : (u.fillStyle = n, u.fillText(t, 0, 0)), this.showDbgInfo && (u.strokeStyle = "#ff0000", u.strokeRect(0, 0, c, _), u.strokeStyle = "#00ff00", u.strokeRect(0, 0, s.width, s.height)), u.restore(), s.bmpWidth = f.canvas.width, s.bmpHeight = f.canvas.height, f.canvas
            }, d(0, e, "canvasWidth", function () {
                return f.canvas.width
            }, function (t) {
                f.canvas.width != t && (f.canvas.width = t, this.settrans.call(this.ctx, 1, 0, 0, 1, 0, 0), this.ctx.scale(this.lastScaleX, this.lastScaleY))
            }), f.canvas = null, f
        }(), ze = function (t) {
            function e() {
                this.lastFont = "", e.__super.call(this)
            }

            x(e, "laya.webgl.text.CharRender_Native", te);
            var i = e.prototype;
            return i.getWidth = function (t, e) {
                return m.conchTextCanvas ? (m.conchTextCanvas.font = t, this.lastFont = t, m.conchTextCanvas.measureText(e).width) : 0
            }, i.scale = function (t, e) {
            }, i.getCharBmp = function (t, e, i, n, r, s, a, o, h, l, u) {
                if (!m.conchTextCanvas) return null;
                m.conchTextCanvas.font = e, this.lastFont = e;
                s.width = m.conchTextCanvas.measureText(t).width, s.height;
                var c = p.create(r).numColor, _ = p.create(n).numColor,
                    f = m.conchTextCanvas.getTextBitmapData(t, _, 2 < i ? 2 : i, c);
                return s.bmpWidth = f.width, s.bmpHeight = f.height, f
            }, e
        }(), je = function (r) {
            function e() {
                this._x = 0, this._y = 0, this._width = 0, this._height = 0, this._visible = !0, this._mouseState = 0, this._zOrder = 0, this._renderType = 0, this._transform = null, this._tfChanged = !1, this._texture = null, this._boundStyle = null, this._graphics = null, this.mouseThrough = !1, this.autoSize = !1, this.hitTestPrior = !1, e.__super.call(this), this._repaint = 0, this._style = J.EMPTY, this._cacheStyle = et.EMPTY
            }

            x(e, "laya.display.Sprite", r);
            var t = e.prototype;
            return t.destroy = function (t) {
                void 0 === t && (t = !0), r.prototype.destroy.call(this, t), this._style && this._style.recover(), this._cacheStyle && this._cacheStyle.recover(), this._boundStyle && this._boundStyle.recover(), this._style = null, this._cacheStyle = null, this._boundStyle = null, this._transform = null, this._graphics && this._graphics.autoDestroy && this._graphics.destroy(), this._graphics = null, this.texture = null
            }, t.updateZOrder = function () {
                ne.updateOrder(this._children) && this.repaint()
            }, t._getBoundsStyle = function () {
                return this._boundStyle || (this._boundStyle = Mt.create()), this._boundStyle
            }, t._setCustomRender = function () {
            }, t._setCacheAs = function (t) {
            }, t._checkCanvasEnable = function () {
                var t = this._cacheStyle.needEnableCanvasRender();
                (this._getCacheStyle().enableCanvasRender = t) ? (this._cacheStyle.needBitmapCache() ? this._cacheStyle.cacheAs = "bitmap" : this._cacheStyle.cacheAs = this._cacheStyle.userSetCache, this._cacheStyle.reCache = !0, this._renderType |= 8) : (this._cacheStyle.cacheAs = "none", this._cacheStyle.releaseContext(), this._renderType &= -9), this._setCacheAs(this._cacheStyle.cacheAs), this._setRenderType(this._renderType)
            }, t.reCache = function () {
                this._cacheStyle.reCache = !0, this._repaint |= 2
            }, t.getRepaint = function () {
                return this._repaint
            }, t._setX = function (t) {
                this._x = t
            }, t._setY = function (t) {
                this._y = t
            }, t._setWidth = function (t, e) {
            }, t._setHeight = function (t, e) {
            }, t.setSelfBounds = function (t) {
                this._getBoundsStyle().userBounds = t
            }, t.getBounds = function () {
                return this._getBoundsStyle().bounds = gt._getWrapRec(this._boundPointsToParent())
            }, t.getSelfBounds = function () {
                return this._boundStyle && this._boundStyle.userBounds ? this._boundStyle.userBounds : this._graphics || 0 !== this._children.length || this._texture ? this._getBoundsStyle().bounds = gt._getWrapRec(this._getBoundPointsM(!1)) : gt.TEMP.setTo(0, 0, 0, 0)
            }, t._boundPointsToParent = function (t) {
                void 0 === t && (t = !1);
                var e = 0, i = 0;
                this._style && (e = this.pivotX, i = this.pivotY, t = t || 0 !== this._style.rotation, this._style.scrollRect && (e += this._style.scrollRect.x, i += this._style.scrollRect.y));
                var n = this._getBoundPointsM(t);
                if (!n || n.length < 1) return n;
                if (8 != n.length && (n = t ? H.scanPList(n) : gt._getWrapRec(n, gt.TEMP)._getBoundPoints()), !this.transform) return ne.transPointList(n, this._x - e, this._y - i), n;
                var r = Ht.TEMP, s = 0, a = n.length;
                for (s = 0; s < a; s += 2) r.x = n[s], r.y = n[s + 1], this.toParentPoint(r), n[s] = r.x, n[s + 1] = r.y;
                return n
            }, t.getGraphicBounds = function (t) {
                return void 0 === t && (t = !1), this._graphics ? this._graphics.getBounds(t) : gt.TEMP.setTo(0, 0, 0, 0)
            }, t._getBoundPointsM = function (t) {
                if (void 0 === t && (t = !1), this._boundStyle && this._boundStyle.userBounds) return this._boundStyle.userBounds._getBoundPoints();
                if (this._boundStyle || this._getBoundsStyle(), this._boundStyle.temBM || (this._boundStyle.temBM = []), this._style.scrollRect) {
                    var e = ne.clearArray(this._boundStyle.temBM), i = gt.TEMP;
                    return i.copyFrom(this._style.scrollRect), ne.concatArray(e, i._getBoundPoints()), e
                }
                var n, r, s, a;
                this._graphics ? n = this._graphics.getBoundPoints() : (n = ne.clearArray(this._boundStyle.temBM), this._texture && ((i = gt.TEMP).setTo(0, 0, this.width || this._texture.width, this.height || this._texture.height), ne.concatArray(n, i._getBoundPoints())));
                for (var o = 0, h = (a = this._children).length; o < h; o++) (r = a[o]) instanceof laya.display.Sprite && !0 === r._visible && (s = r._boundPointsToParent(t)) && (n = n ? ne.concatArray(n, s) : s);
                return n
            }, t._getCacheStyle = function () {
                return this._cacheStyle === et.EMPTY && (this._cacheStyle = et.create()), this._cacheStyle
            }, t.getStyle = function () {
                return this._style === J.EMPTY && (this._style = J.create()), this._style
            }, t.setStyle = function (t) {
                this._style = t
            }, t._setScaleX = function (t) {
                this._style.scaleX = t
            }, t._setScaleY = function (t) {
                this._style.scaleY = t
            }, t._setRotation = function (t) {
                this._style.rotation = t
            }, t._setSkewX = function (t) {
                this._style.skewX = t
            }, t._setSkewY = function (t) {
                this._style.skewY = t
            }, t._createTransform = function () {
                return at.create()
            }, t._adjustTransform = function () {
                this._tfChanged = !1;
                var t = this._style, e = t.scaleX, i = t.scaleY, n = t.skewX, r = t.skewY, s = t.rotation,
                    a = this._transform || (this._transform = this._createTransform());
                if (s || 1 !== e || 1 !== i || 0 !== n || 0 !== r) {
                    a._bTransform = !0;
                    var o = .0174532922222222 * (s - n), h = .0174532922222222 * (s + r), l = Math.cos(h),
                        u = Math.sin(h), c = Math.sin(o), _ = Math.cos(o);
                    a.a = e * l, a.b = e * u, a.c = -i * c, a.d = i * _, a.tx = a.ty = 0
                } else a.identity(), this._renderType &= -3, this._setRenderType(this._renderType);
                return a
            }, t._setTransform = function (t) {
            }, t._setPivotX = function (t) {
                this.getStyle().pivotX = t
            }, t._getPivotX = function () {
                return this._style.pivotX
            }, t._setPivotY = function (t) {
                this.getStyle().pivotY = t
            }, t._getPivotY = function () {
                return this._style.pivotY
            }, t._setAlpha = function (t) {
                this._style.alpha !== t && (1 !== (this.getStyle().alpha = t) ? this._renderType |= 1 : this._renderType &= -2, this._setRenderType(this._renderType), this.parentRepaint())
            }, t._getAlpha = function () {
                return this._style.alpha
            }, t._setBlendMode = function (t) {
            }, t._setGraphics = function (t) {
            }, t._setGraphicsCallBack = function () {
            }, t._setScrollRect = function (t) {
            }, t.pos = function (t, e, i) {
                if (void 0 === i && (i = !1), this._x !== t || this._y !== e) {
                    if (this.destroyed) return this;
                    if (i) {
                        this._setX(t), this._setY(e), this.parentRepaint(2);
                        var n = this._cacheStyle.maskParent;
                        n && n.repaint(2)
                    } else this.x = t, this.y = e
                }
                return this
            }, t.pivot = function (t, e) {
                return this.pivotX = t, this.pivotY = e, this
            }, t.size = function (t, e) {
                return this.width = t, this.height = e, this
            }, t.scale = function (t, e, i) {
                void 0 === i && (i = !1);
                var n = this.getStyle();
                if (n.scaleX != t || n.scaleY != e) {
                    if (this.destroyed) return this;
                    i ? (this._setScaleX(t), this._setScaleY(e), this._setTranformChange()) : (this.scaleX = t, this.scaleY = e)
                }
                return this
            }, t.skew = function (t, e) {
                return this.skewX = t, this.skewY = e, this
            }, t.render = function (t, e, i) {
                P.renders[this._renderType]._fun(this, t, e + this._x, i + this._y), this._repaint = 0
            }, t.drawToCanvas = function (t, e, i, n) {
                return ce.drawToCanvas(this, this._renderType, t, e, i, n)
            }, t.drawToTexture = function (t, e, i, n) {
                return ce.drawToTexture(this, this._renderType, t, e, i, n)
            }, t.customRender = function (t, e, i) {
                this._repaint = 3
            }, t._applyFilters = function () {
            }, t._setColorFilter = function (t) {
            }, t._isHaveGlowFilter = function () {
                var t, e = 0;
                if (this.filters) for (e = 0; e < this.filters.length; e++) if (8 == this.filters[e].type) return !0;
                for (e = 0, t = this._children.length; e < t; e++) if (this._children[e]._isHaveGlowFilter()) return !0;
                return !1
            }, t.localToGlobal = function (t, e, i) {
                void 0 === e && (e = !1), !0 === e && (t = new Ht(t.x, t.y));
                var n = this;
                for (i = i || y.stage; n && !n.destroyed && n != i;) t = n.toParentPoint(t), n = n.parent;
                return t
            }, t.globalToLocal = function (t, e, i) {
                void 0 === e && (e = !1), e && (t = new Ht(t.x, t.y));
                var n = this, r = [];
                for (i = i || y.stage; n && !n.destroyed && n != i;) r.push(n), n = n.parent;
                for (var s = r.length - 1; 0 <= s;) t = (n = r[s]).fromParentPoint(t), s--;
                return t
            }, t.toParentPoint = function (t) {
                if (!t) return t;
                t.x -= this.pivotX, t.y -= this.pivotY, this.transform && this._transform.transformPoint(t), t.x += this._x, t.y += this._y;
                var e = this._style.scrollRect;
                return e && (t.x -= e.x, t.y -= e.y), t
            }, t.fromParentPoint = function (t) {
                if (!t) return t;
                t.x -= this._x, t.y -= this._y;
                var e = this._style.scrollRect;
                return e && (t.x += e.x, t.y += e.y), this.transform && this._transform.invertTransformPoint(t), t.x += this.pivotX, t.y += this.pivotY, t
            }, t.fromStagePoint = function (t) {
                return t
            }, t.on = function (t, e, i, n) {
                return 1 !== this._mouseState && this.isMouseEvent(t) ? (this.mouseEnabled = !0, this._setBit(64, !0), this._parent && this._$2__onDisplay(), this._createListener(t, e, i, n, !1)) : r.prototype.on.call(this, t, e, i, n)
            }, t.once = function (t, e, i, n) {
                return 1 !== this._mouseState && this.isMouseEvent(t) ? (this.mouseEnabled = !0, this._setBit(64, !0), this._parent && this._$2__onDisplay(), this._createListener(t, e, i, n, !0)) : r.prototype.once.call(this, t, e, i, n)
            }, t._$2__onDisplay = function () {
                if (1 !== this._mouseState) {
                    var t = this;
                    for (t = t.parent; t && 1 !== t._mouseState && !t._getBit(64);) t.mouseEnabled = !0, t._setBit(64, !0), t = t.parent
                }
            }, t._setParent = function (t) {
                r.prototype._setParent.call(this, t), t && this._getBit(64) && this._$2__onDisplay()
            }, t.loadImage = function (t, e) {
                var i = this;
                if (null == t) this.texture = null, r(); else {
                    var n = De.getRes(t);
                    n || ((n = new Ie).load(t), De.cacheRes(t, n)), (this.texture = n).getIsReady() ? r() : n.once("ready", null, r)
                }

                function r() {
                    i.repaint(3), e && e.run()
                }

                return this
            }, t.repaint = function (t) {
                void 0 === t && (t = 2), this._repaint & t || (this._repaint |= t, this.parentRepaint(t)), this._cacheStyle && this._cacheStyle.maskParent && this._cacheStyle.maskParent.repaint(t)
            }, t._needRepaint = function () {
                return 2 & this._repaint && this._cacheStyle.enableCanvasRender && this._cacheStyle.reCache
            }, t._childChanged = function (t) {
                this._children.length ? this._renderType |= 8192 : this._renderType &= -8193, this._setRenderType(this._renderType), t && this._getBit(32) && y.systemTimer.callLater(this, this.updateZOrder), this.repaint(3)
            }, t.parentRepaint = function (t) {
                void 0 === t && (t = 2);
                var e = this._parent;
                !e || e._repaint & t || (e._repaint |= t, e.parentRepaint(t))
            }, t._setMask = function (t) {
            }, t.startDrag = function (t, e, i, n, r, s, a) {
                void 0 === e && (e = !1), void 0 === i && (i = 0), void 0 === n && (n = 300), void 0 === s && (s = !1), void 0 === a && (a = .92), this._style.dragging || (this.getStyle().dragging = new Gt), this._style.dragging.start(this, t, e, i, n, r, s, a)
            }, t.stopDrag = function () {
                this._style.dragging && this._style.dragging.stop()
            }, t._setDisplay = function (t) {
                t || this._cacheStyle && (this._cacheStyle.releaseContext(), this._cacheStyle.releaseFilterCache(), this._cacheStyle.hasGlowFilter && (this._cacheStyle.hasGlowFilter = !1)), r.prototype._setDisplay.call(this, t)
            }, t.hitTestPoint = function (t, e) {
                var i = this.globalToLocal(Ht.TEMP.setTo(t, e));
                return t = i.x, e = i.y, (this._style.hitArea ? this._style.hitArea : 0 < this._width && 0 < this._height ? gt.TEMP.setTo(0, 0, this._width, this._height) : this.getSelfBounds()).contains(t, e)
            }, t.getMousePoint = function () {
                return this.globalToLocal(Ht.TEMP.setTo(y.stage.mouseX, y.stage.mouseY))
            }, t._setTexture = function (t) {
            }, t._setRenderType = function (t) {
            }, t._setTranformChange = function () {
                this._tfChanged = !0, this._renderType |= 2, this.parentRepaint(2)
            }, t._setBgStyleColor = function (t, e, i, n, r) {
            }, t._setBorderStyleColor = function (t, e, i, n, r, s) {
            }, t.captureMouseEvent = function (t) {
                R.instance.setCapture(this, t)
            }, t.releaseMouseEvent = function () {
                R.instance.releaseCapture()
            }, d(0, t, "customRenderEnable", null, function (t) {
                t && (this._renderType |= 2048, this._setRenderType(this._renderType), this._setCustomRender())
            }), d(0, t, "cacheAs", function () {
                return this._cacheStyle.cacheAs
            }, function (t) {
                t !== this._cacheStyle.userSetCache && (this.mask && "normal" === t || (this._setCacheAs(t), this._getCacheStyle().userSetCache = t, this._checkCanvasEnable(), this.repaint()))
            }), d(0, t, "globalScaleY", function () {
                for (var t = 1, e = this; e && e !== y.stage;) t *= e.scaleY, e = e.parent;
                return t
            }), d(0, t, "hitArea", function () {
                return this._style.hitArea
            }, function (t) {
                this.getStyle().hitArea = t
            }), d(0, t, "staticCache", function () {
                return this._cacheStyle.staticCache
            }, function (t) {
                (this._getCacheStyle().staticCache = t) || this.reCache()
            }), d(0, t, "displayWidth", function () {
                return this.width * this.scaleX
            }), d(0, t, "zOrder", function () {
                return this._zOrder
            }, function (t) {
                this._zOrder != t && (this._zOrder = t, this._parent && (t && this._parent._setBit(32, !0), y.systemTimer.callLater(this._parent, this.updateZOrder)))
            }), d(0, t, "rotation", function () {
                return this._style.rotation
            }, function (t) {
                this.getStyle().rotation !== t && (this._setRotation(t), this._setTranformChange())
            }), d(0, t, "width", function () {
                return this.autoSize ? this.texture ? this.texture.width : this._graphics || 0 !== this._children.length ? this.getSelfBounds().width : 0 : this._width || (this.texture ? this.texture.width : 0)
            }, function (t) {
                this._width !== t && (this._width = t, this._setWidth(this.texture, t), this._setTranformChange())
            }), d(0, t, "x", function () {
                return this._x
            }, function (t) {
                if (!this.destroyed && this._x !== t) {
                    this._setX(t), this.parentRepaint(2);
                    var e = this._cacheStyle.maskParent;
                    e && e.repaint(2)
                }
            }), d(0, t, "drawCallOptimize", function () {
                return this._getBit(256)
            }, function (t) {
                this._setBit(256, t)
            }), d(0, t, "texture", function () {
                return this._texture
            }, function (t) {
                "string" == typeof t ? this.loadImage(t) : this._texture != t && (this._texture && this._texture._removeReference(), (this._texture = t) && t._addReference(), this._setTexture(t), this._setWidth(this._texture, this.width), this._setHeight(this._texture, this.height), t ? this._renderType |= 256 : this._renderType &= -257, this._setRenderType(this._renderType), this.repaint())
            }), d(0, t, "globalRotation", function () {
                for (var t = 0, e = this; e && e !== y.stage;) t += e.rotation, e = e.parent;
                return t
            }), d(0, t, "y", function () {
                return this._y
            }, function (t) {
                if (!this.destroyed && this._y !== t) {
                    this._setY(t), this.parentRepaint(2);
                    var e = this._cacheStyle.maskParent;
                    e && e.repaint(2)
                }
            }), d(0, t, "displayHeight", function () {
                return this.height * this.scaleY
            }), d(0, t, "height", function () {
                return this.autoSize ? this.texture ? this.texture.height : this._graphics || 0 !== this._children.length ? this.getSelfBounds().height : 0 : this._height || (this.texture ? this.texture.height : 0)
            }, function (t) {
                this._height !== t && (this._height = t, this._setHeight(this.texture, t), this._setTranformChange())
            }), d(0, t, "blendMode", function () {
                return this._style.blendMode
            }, function (t) {
                this._setBlendMode(t), (this.getStyle().blendMode = t) && "source-over" != t ? this._renderType |= 4 : this._renderType &= -5, this._setRenderType(this._renderType), this.parentRepaint()
            }), d(0, t, "scaleX", function () {
                return this._style.scaleX
            }, function (t) {
                this.getStyle().scaleX !== t && (this._setScaleX(t), this._setTranformChange())
            }), d(0, t, "scaleY", function () {
                return this._style.scaleY
            }, function (t) {
                this.getStyle().scaleY !== t && (this._setScaleY(t), this._setTranformChange())
            }), d(0, t, "stage", function () {
                return y.stage
            }), d(0, t, "skewX", function () {
                return this._style.skewX
            }, function (t) {
                this.getStyle().skewX !== t && (this._setSkewX(t), this._setTranformChange())
            }), d(0, t, "scrollRect", function () {
                return this._style.scrollRect
            }, function (t) {
                this.getStyle().scrollRect = t, this._setScrollRect(t), this.repaint(), t ? this._renderType |= 64 : this._renderType &= -65, this._setRenderType(this._renderType)
            }), d(0, t, "skewY", function () {
                return this._style.skewY
            }, function (t) {
                this.getStyle().skewY !== t && (this._setSkewY(t), this._setTranformChange())
            }),d(0, t, "transform", function () {
                return this._tfChanged ? this._adjustTransform() : this._transform
            }, function (t) {
                this._tfChanged = !1;
                var e = this._transform || (this._transform = this._createTransform());
                t.copyTo(e), this._setTransform(e), t && (this._x = e.tx, this._y = e.ty, e.tx = e.ty = 0), t ? this._renderType |= 2 : this._renderType &= -3, this._setRenderType(this._renderType), this.parentRepaint()
            }),d(0, t, "pivotX", function () {
                return this._getPivotX()
            }, function (t) {
                this._setPivotX(t), this.repaint()
            }),d(0, t, "pivotY", function () {
                return this._getPivotY()
            }, function (t) {
                this._setPivotY(t), this.repaint()
            }),d(0, t, "alpha", function () {
                return this._getAlpha()
            }, function (t) {
                t = t < 0 ? 0 : 1 < t ? 1 : t, this._setAlpha(t)
            }),d(0, t, "visible", function () {
                return this._visible
            }, function (t) {
                this._visible !== t && (this._visible = t, this.parentRepaint(3))
            }),d(0, t, "graphics", function () {
                return this._graphics || (this.graphics = new qt, this._graphics.autoDestroy = !0), this._graphics
            }, function (t) {
                this._graphics && (this._graphics._sp = null), (this._graphics = t) ? (this._setGraphics(t), this._renderType |= 512, t._sp = this) : this._renderType &= -513, this._setRenderType(this._renderType), this.repaint()
            }),d(0, t, "filters", function () {
                return this._cacheStyle.filters
            }, function (t) {
                t && 0 === t.length && (t = null), this._cacheStyle.filters != t && (this._getCacheStyle().filters = t ? t.slice() : null, t && t.length ? (this._setColorFilter(t[0]), this._renderType |= 16) : (this._setColorFilter(null), this._renderType &= -17), this._setRenderType(this._renderType), t && 0 < t.length ? (this._getBit(16) || this._setBitUp(16), 1 == t.length && t[0] instanceof laya.filters.ColorFilter || (this._getCacheStyle().cacheForFilters = !0, this._checkCanvasEnable())) : this._cacheStyle.cacheForFilters && (this._cacheStyle.cacheForFilters = !1, this._checkCanvasEnable()), this._getCacheStyle().hasGlowFilter = this._isHaveGlowFilter(), this.repaint())
            }),d(0, t, "mask", function () {
                return this._cacheStyle.mask
            }, function (t) {
                t && this.mask && this.mask._cacheStyle.maskParent || (this._getCacheStyle().mask = t, this._setMask(t), this._checkCanvasEnable(), t ? t._getCacheStyle().maskParent = this : this.mask && (this.mask._getCacheStyle().maskParent = null), this._renderType |= 32, this._setRenderType(this._renderType), this.parentRepaint(3))
            }),d(0, t, "mouseEnabled", function () {
                return 1 < this._mouseState
            }, function (t) {
                this._mouseState = t ? 2 : 1
            }),d(0, t, "globalScaleX", function () {
                for (var t = 1, e = this; e && e !== y.stage;) t *= e.scaleX, e = e.parent;
                return t
            }),d(0, t, "mouseX", function () {
                return this.getMousePoint().x
            }),d(0, t, "mouseY", function () {
                return this.getMousePoint().y
            }),d(0, t, "viewport", function () {
                return this._style.viewport
            }, function (t) {
                var e;
                "string" == typeof t && (3 < (e = t.split(",")).length && (t = new gt(parseFloat(e[0]), parseFloat(e[1]), parseFloat(e[2]), parseFloat(e[3]))));
                this.getStyle().viewport = t
            }),e.fromImage = function (t) {
                return (new e).loadImage(t)
            },e
        }(t), Ke = function (t) {
            function e() {
                e.__super.call(this)
            }

            return x(e, "laya.webgl.shader.BaseShader", Me), e.activeShader = null, e.bindShader = null, e
        }(), $e = function (t) {
            function e() {
                e.__super.call(this), this._width = -1, this._height = -1
            }

            x(e, "laya.resource.Bitmap", Me);
            var i = e.prototype;
            return i._getSource = function () {
                throw"Bitmap: must override it."
            }, d(0, i, "width", function () {
                return this._width
            }), d(0, i, "height", function () {
                return this._height
            }), e
        }(), Qe = function (t) {
            function n(t, e) {
                this._source = null, this._texW = 0, this._texH = 0, this.__destroyed = !1, this._discardTm = 0, this.genID = 0, this.bitmap = {
                    id: 0,
                    _glTexture: null
                }, this.curUsedCovRate = 0, this.curUsedCovRateAtlas = 0, this.lastTouchTm = 0, this.ri = null, n.__super.call(this), this._texW = t || A.atlasWidth, this._texH = e || A.atlasWidth, this.bitmap.id = this.id, this.lock = !0
            }

            x(n, "laya.webgl.text.TextTexture", Me);
            var e = n.prototype;
            return e.recreateResource = function () {
                if (!this._source) {
                    var t = Rt.isConchApp ? Dt.instance.getDefaultCommandEncoder() : Ct.mainContext,
                        e = this._source = t.createTexture();
                    this.bitmap._glTexture = e, rt.bindTexture(t, 3553, e), t.texImage2D(3553, 0, 6408, this._texW, this._texH, 0, 6408, 5121, null), t.texParameteri(3553, 10241, 9729), t.texParameteri(3553, 10240, 9729), t.texParameteri(3553, 10242, 33071), t.texParameteri(3553, 10243, 33071), A.debugUV && this.fillWhite()
                }
            }, e.addChar = function (t, e, i, n) {
                if (A.isWan1Wan) return this.addCharCanvas(t, e, i, n);
                !this._source && this.recreateResource();
                var r = Rt.isConchApp ? Dt.instance.getDefaultCommandEncoder() : Ct.mainContext;
                rt.bindTexture(r, 3553, this._source), !Rt.isConchApp && r.pixelStorei(37441, !0);
                var s = t.data;
                t.data instanceof Uint8ClampedArray && (s = new Uint8Array(s.buffer)), r.texSubImage2D(3553, 0, e, i, t.width, t.height, 6408, 5121, s), !Rt.isConchApp && r.pixelStorei(37441, !1);
                var a = NaN, o = NaN, h = NaN, l = NaN;
                return l = Rt.isConchApp ? (a = e / this._texW, o = i / this._texH, h = (e + t.width) / this._texW, (i + t.height) / this._texH) : (a = (e + 1) / this._texW, o = i / this._texH, h = (e + t.width - 1) / this._texW, (i + t.height - 1) / this._texH), (n = n || new Array(8))[0] = a, n[1] = o, n[2] = h, n[3] = o, n[4] = h, n[5] = l, n[6] = a, n[7] = l, n
            }, e.addCharCanvas = function (t, e, i, n) {
                !this._source && this.recreateResource();
                var r = Rt.isConchApp ? Dt.instance.getDefaultCommandEncoder() : Ct.mainContext;
                rt.bindTexture(r, 3553, this._source), !Rt.isConchApp && r.pixelStorei(37441, !0), r.texSubImage2D(3553, 0, e, i, 6408, 5121, t), !Rt.isConchApp && r.pixelStorei(37441, !1);
                var s = NaN, a = NaN, o = NaN, h = NaN;
                return h = Rt.isConchApp ? (s = e / this._texW, a = i / this._texH, o = (e + t.width) / this._texW, (i + t.height) / this._texH) : (s = (e + 1) / this._texW, a = (i + 1) / this._texH, o = (e + t.width - 1) / this._texW, (i + t.height - 1) / this._texH), (n = n || new Array(8))[0] = s, n[1] = a, n[2] = o, n[3] = a, n[4] = o, n[5] = h, n[6] = s, n[7] = h, n
            }, e.fillWhite = function () {
                !this._source && this.recreateResource();
                var t = Rt.isConchApp ? Dt.instance.getDefaultCommandEncoder() : Ct.mainContext,
                    e = new Uint8Array(this._texW * this._texH * 4);
                e.fill(255), t.texSubImage2D(3553, 0, 0, 0, this._texW, this._texH, 6408, 5121, e)
            }, e.discard = function () {
                this._texW == A.atlasWidth && this._texH == A.atlasWidth ? (this.genID++, n.poolLen >= n.pool.length && (n.pool = n.pool.concat(new Array(10))), this._discardTm = y.stage.getFrameTm(), n.pool[n.poolLen++] = this) : this.destroy()
            }, e.destroy = function () {
                this.__destroyed = !0;
                var t = Rt.isConchApp ? Dt.instance.getDefaultCommandEncoder() : Ct.mainContext;
                this._source && t.deleteTexture(this._source), this._source = null
            }, e.touchRect = function (t, e) {
                this.lastTouchTm != e && (this.curUsedCovRate = 0, this.curUsedCovRateAtlas = 0, this.lastTouchTm = e);
                var i = A.atlasWidth * A.atlasWidth, n = Ut.atlasGridW * Ut.atlasGridW;
                this.curUsedCovRate += t.bmpWidth * t.bmpHeight / i, this.curUsedCovRateAtlas += Math.ceil(t.bmpWidth / Ut.atlasGridW) * Math.ceil(t.bmpHeight / Ut.atlasGridW) / (i / n)
            }, e._getSource = function () {
                return this._source
            }, e.drawOnScreen = function (t, e) {
            }, d(0, e, "texture", function () {
                return this
            }), n.getTextTexture = function (t, e) {
                if (t != A.atlasWidth || t != A.atlasWidth) return new n(t, e);
                if (0 < n.poolLen) {
                    var i = n.pool[--n.poolLen];
                    return 0 < n.poolLen && n.clean(), i
                }
                return new n(t, e)
            }, n.clean = function () {
                var t = y.stage.getFrameTm();
                if (0 === n.cleanTm && (n.cleanTm = t), t - n.cleanTm >= A.checkCleanTextureDt) {
                    for (var e = 0; e < n.poolLen; e++) {
                        var i = n.pool[e];
                        t - i._discardTm >= A.destroyUnusedTextureDt && (i.destroy(), n.pool[e] = n.pool[n.poolLen - 1], n.poolLen--, e--)
                    }
                    n.cleanTm = t
                }
            }, n.poolLen = 0, n.cleanTm = 0, a(n, ["pool", function () {
                return this.pool = new Array(10)
            }]), n
        }(), qe = function (t) {
            function e(t) {
                this._uint16Array = null, void 0 === t && (t = 35044), e.__super.call(this), this._bufferUsage = t, this._bufferType = 34963, this._buffer = new ArrayBuffer(8)
            }

            x(e, "laya.webgl.utils.IndexBuffer2D", Le);
            var i = e.prototype;
            return i._checkArrayUse = function () {
                this._uint16Array && (this._uint16Array = new Uint16Array(this._buffer))
            }, i.getUint16Array = function () {
                return this._uint16Array || (this._uint16Array = new Uint16Array(this._buffer))
            }, i._bindForVAO = function () {
                Dt.instance.bindBuffer(34963, this._glBuffer)
            }, i.bind = function () {
                return V._bindedIndexBuffer !== this._glBuffer && (Dt.instance.bindBuffer(34963, this._glBuffer), V._bindedIndexBuffer = this._glBuffer, !0)
            }, i.destory = function () {
                this._uint16Array = null, this._buffer = null
            }, i.disposeResource = function () {
                this._disposeResource()
            }, e.create = function (t) {
                return void 0 === t && (t = 35044), new e(t)
            }, e
        }(), Ze = function (t) {
            function e() {
                this.audioBuffer = null, this.gain = null, this.bufferSource = null, this._currentTime = 0, this._volume = 1, this._startTime = 0, this._pauseTime = 0, this._onPlayEnd = null, this.context = Be.ctx, e.__super.call(this), this._onPlayEnd = ne.bind(this.__onPlayEnd, this), this.context.createGain ? this.gain = this.context.createGain() : this.gain = this.context.createGainNode()
            }

            x(e, "laya.media.webaudio.WebAudioSoundChannel", t);
            var i = e.prototype;
            return i.play = function () {
                if (xe.addChannel(this), this.isStopped = !1, this._clearBufferSource(), this.audioBuffer) {
                    if (this.startTime >= this.duration) return this.stop();
                    var t = this.context, e = this.gain, i = t.createBufferSource();
                    (this.bufferSource = i).buffer = this.audioBuffer, i.connect(e), e && e.disconnect(), e.connect(t.destination), i.onended = this._onPlayEnd, this._startTime = Lt.now(), this.gain.gain.setTargetAtTime ? this.gain.gain.setTargetAtTime(this._volume, this.context.currentTime, .001) : this.gain.gain.value = this._volume, 0 == this.loops && (i.loop = !0), i.playbackRate.setTargetAtTime ? i.playbackRate.setTargetAtTime(xe.playbackRate, this.context.currentTime, .001) : i.playbackRate.value = xe.playbackRate, i.start(0, this.startTime), this._currentTime = 0
                }
            }, i.__onPlayEnd = function () {
                if (1 == this.loops) return this.completeHandler && (y.timer.once(10, this, this.__runComplete, [this.completeHandler], !1), this.completeHandler = null), this.stop(), void this.event("complete");
                0 < this.loops && this.loops--, this.startTime = 0, this.play()
            }, i._clearBufferSource = function () {
                if (this.bufferSource) {
                    var t = this.bufferSource;
                    t.stop ? t.stop(0) : t.noteOff(0), t.disconnect(0), t.onended = null, e._tryCleanFailed || this._tryClearBuffer(t), this.bufferSource = null
                }
            }, i._tryClearBuffer = function (t) {
                if (Lt.onMac) try {
                    t.buffer = Be._miniBuffer
                } catch (t) {
                    e._tryCleanFailed = !0
                } else try {
                    t.buffer = null
                } catch (t) {
                    e._tryCleanFailed = !0
                }
            }, i.stop = function () {
                t.prototype.stop.call(this), this._clearBufferSource(), this.audioBuffer = null, this.gain && this.gain.disconnect(), this.isStopped = !0, xe.removeChannel(this), this.completeHandler = null, xe.autoReleaseSound && xe.disposeSoundLater(this.url)
            }, i.pause = function () {
                this.isStopped || (this._pauseTime = this.position), this._clearBufferSource(), this.gain && this.gain.disconnect(), this.isStopped = !0, xe.removeChannel(this), xe.autoReleaseSound && xe.disposeSoundLater(this.url)
            }, i.resume = function () {
                this.startTime = this._pauseTime, this.play()
            }, d(0, i, "position", function () {
                return this.bufferSource ? (Lt.now() - this._startTime) / 1e3 + this.startTime : 0
            }), d(0, i, "duration", function () {
                return this.audioBuffer ? this.audioBuffer.duration : 0
            }), d(0, i, "volume", function () {
                return this._volume
            }, function (t) {
                this._volume = t, this.isStopped || (this.gain.gain.setTargetAtTime ? this.gain.gain.setTargetAtTime(t, this.context.currentTime, .001) : this.gain.gain.value = t)
            }), e._tryCleanFailed = !1, e.SetTargetDelay = .001, e
        }(Ae), Je = function (t) {
            function e(t) {
                this._audio = null, this._onEnd = null, this._resumePlay = null, e.__super.call(this), this._onEnd = ne.bind(this.__onEnd, this), this._resumePlay = ne.bind(this.__resumePlay, this), t.addEventListener("ended", this._onEnd), this._audio = t
            }

            x(e, "laya.media.h5audio.AudioSoundChannel", t);
            var i = e.prototype;
            return i.__onEnd = function () {
                if (1 == this.loops) return this.completeHandler && (y.systemTimer.once(10, this, this.__runComplete, [this.completeHandler], !1), this.completeHandler = null), this.stop(), void this.event("complete");
                0 < this.loops && this.loops--, this.startTime = 0, this.play()
            }, i.__resumePlay = function () {
                if (this._audio && this._audio.removeEventListener("canplay", this._resumePlay), !this.isStopped) try {
                    this._audio.currentTime = this.startTime, Lt.container.appendChild(this._audio), this._audio.play()
                } catch (t) {
                    this.event("error")
                }
            }, i.play = function () {
                this.isStopped = !1;
                try {
                    this._audio.playbackRate = xe.playbackRate, this._audio.currentTime = this.startTime
                } catch (t) {
                    return void this._audio.addEventListener("canplay", this._resumePlay)
                }
                xe.addChannel(this), Lt.container.appendChild(this._audio), "play" in this._audio && this._audio.play()
            }, i.stop = function () {
                t.prototype.stop.call(this), this.isStopped = !0, xe.removeChannel(this), this.completeHandler = null, this._audio && ("pause" in this._audio && Rt.isConchApp && this._audio.stop(), this._audio.pause(), this._audio.removeEventListener("ended", this._onEnd), this._audio.removeEventListener("canplay", this._resumePlay), Lt.onIE || this._audio != Ce._musicAudio && W.recover("audio:" + this.url, this._audio), Lt.removeElement(this._audio), this._audio = null)
            }, i.pause = function () {
                this.isStopped = !0, xe.removeChannel(this), "pause" in this._audio && this._audio.pause()
            }, i.resume = function () {
                this._audio && (this.isStopped = !1, xe.addChannel(this), "play" in this._audio && this._audio.play())
            }, d(0, i, "position", function () {
                return this._audio ? this._audio.currentTime : 0
            }), d(0, i, "duration", function () {
                return this._audio ? this._audio.duration : 0
            }), d(0, i, "volume", function () {
                return this._audio ? this._audio.volume : 1
            }, function (t) {
                this._audio && (this._audio.volume = t)
            }), e
        }(Ae), ti = function (t) {
            function i(t, e) {
                this._floatArray32 = null, this._uint32Array = null, this._vertexStride = 0, i.__super.call(this), this._vertexStride = t, this._bufferUsage = e, this._bufferType = 34962, this._buffer = new ArrayBuffer(8), this._floatArray32 = new Float32Array(this._buffer), this._uint32Array = new Uint32Array(this._buffer)
            }

            x(i, "laya.webgl.utils.VertexBuffer2D", Le);
            var e = i.prototype;
            return e.getFloat32Array = function () {
                return this._floatArray32
            }, e.appendArray = function (t) {
                var e = this._byteLength >> 2;
                this.setByteLength(this._byteLength + 4 * t.length), this.getFloat32Array().set(t, e), this._upload = !0
            }, e._checkArrayUse = function () {
                this._floatArray32 && (this._floatArray32 = new Float32Array(this._buffer)), this._uint32Array && (this._uint32Array = new Uint32Array(this._buffer))
            }, e.deleteBuffer = function () {
                this._disposeResource()
            }, e._bindForVAO = function () {
                Dt.instance.bindBuffer(34962, this._glBuffer)
            }, e.bind = function () {
                return V._bindedVertexBuffer !== this._glBuffer && (Dt.instance.bindBuffer(34962, this._glBuffer), V._bindedVertexBuffer = this._glBuffer, !0)
            }, e.destroy = function () {
                laya.webgl.utils.Buffer.prototype.destroy.call(this), this._byteLength = 0, this._upload = !0, this._buffer = null, this._floatArray32 = null
            }, d(0, e, "vertexStride", function () {
                return this._vertexStride
            }), i.create = function (t, e) {
                return void 0 === e && (e = 35048), new i(t, e)
            }, i
        }(), ei = function (e) {
            function f() {
                this._clipPoint = null, this._text = null, this._isChanged = !1, this._textWidth = 0, this._textHeight = 0, this._lines = [], this._lineWidths = [], this._startX = 0, this._startY = 0, this._words = null, this._charSize = {}, this._valign = "top", this._color = "#000000", this._singleCharRender = !1, f.__super.call(this), this._fontSize = f.defaultFontSize, this._font = f.defaultFont, this.overflow = "visible", this._style = We.EMPTY
            }

            x(f, "laya.display.Text", e);
            var t = f.prototype;
            return t.getStyle = function () {
                return this._style === We.EMPTY && (this._style = We.create()), this._style
            }, t._getTextStyle = function () {
                return this._style === We.EMPTY && (this._style = We.create()), this._style
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), e.prototype.destroy.call(this, t), this._clipPoint = null, this._lines = null, this._lineWidths = null, this._words && this._words.forEach(function (t) {
                    t.cleanCache()
                }), this._words = null, this._charSize = null
            }, t._getBoundPointsM = function (t) {
                void 0 === t && (t = !1);
                var e = gt.TEMP;
                return e.setTo(0, 0, this.width, this.height), e._getBoundPoints()
            }, t.getGraphicBounds = function (t) {
                void 0 === t && (t = !1);
                var e = gt.TEMP;
                return e.setTo(0, 0, this.width, this.height), e
            }, t._getCSSStyle = function () {
                return this._style
            }, t.lang = function (t, e, i, n, r, s, a, o, h, l, u) {
                if (t = f.langPacks && f.langPacks[t] ? f.langPacks[t] : t, arguments.length < 2) this._text = t; else {
                    for (var c = 0, _ = arguments.length; c < _; c++) t = t.replace("{" + c + "}", arguments[c + 1]);
                    this._text = t
                }
            }, t._getContextFont = function () {
                return (this.italic ? "italic " : "") + (this.bold ? "bold " : "") + this.fontSize + "px " + (Lt.onIPhone && laya.display.Text.fontFamilyMap[this.font] || this.font)
            }, t._isPassWordMode = function () {
                var t = this._style.asPassword;
                return "prompt" in this && this.prompt == this._text && (t = !1), t
            }, t._getPassWordTxt = function (t) {
                var e;
                e = "";
                for (var i = t.length; 0 < i; i--) e += "●";
                return e
            }, t._renderText = function () {
                var t = this.padding, e = this._lines.length;
                "visible" != this.overflow && (e = Math.min(e, Math.floor((this.height - t[0] - t[2]) / (this.leading + this._charSize.height)) + 1));
                var i = this.scrollY / (this._charSize.height + this.leading) | 0, n = this.graphics;
                n.clear(!0);
                var r = this._getContextFont();
                Lt.context.font = r;
                var s = t[3], a = "left", o = this._lines, h = this.leading + this._charSize.height,
                    l = this._style.currBitmapFont;
                l && (h = this.leading + l.getMaxHeight());
                var u = t[0];
                if (!l && 0 < this._width && this._textWidth <= this._width && ("right" == this.align ? (a = "right", s = this._width - t[1]) : "center" == this.align && (a = "center", s = .5 * this._width + t[3] - t[1])), 0 < this._height) {
                    var c = this._textHeight > this._height ? "top" : this.valign;
                    "middle" === c ? u = .5 * (this._height - e * h) + t[0] - t[2] : "bottom" === c && (u = this._height - e * h - t[2])
                }
                var _ = this._style;
                if (l && l.autoScaleSize) var f = l.fontSize / this.fontSize;
                if (this._clipPoint) {
                    if (n.save(), l && l.autoScaleSize) {
                        var d = 0, p = 0;
                        d = this._width ? this._width - t[3] - t[1] : this._textWidth, p = this._height ? this._height - t[0] - t[2] : this._textHeight, d *= f, p *= f, n.clipRect(t[3], t[0], d, p)
                    } else n.clipRect(t[3], t[0], this._width ? this._width - t[3] - t[1] : this._textWidth, this._height ? this._height - t[0] - t[2] : this._textHeight);
                    this.repaint()
                }
                var m = _.asPassword;
                "prompt" in this && this.prompt == this._text && (m = !1);
                for (var g = 0, v = 0, y = Math.min(this._lines.length, e + i) || 1, x = i; x < y; x++) {
                    var T, b = o[x];
                    if (m) {
                        var w = b.length;
                        b = "";
                        for (var C = w; 0 < C; C--) b += "●"
                    }
                    if (null == b && (b = ""), g = s - (this._clipPoint ? this._clipPoint.x : 0), v = u + h * x - (this._clipPoint ? this._clipPoint.y : 0), this.underline && this._drawUnderline(a, g, v, x), l) {
                        var A = this.width;
                        l.autoScaleSize && (A = this.width * f), l._drawText(b, this, g, v, this.align, A)
                    } else this._words || (this._words = []), this._words.length > x - i ? T = this._words[x - i] : (T = new E, this._words.push(T)), T.setText(b), T.splitRender = this._singleCharRender, _.stroke ? n.fillBorderText(T, g, v, r, this.color, _.strokeColor, _.stroke, a) : n.fillText(T, g, v, r, this.color, a)
                }
                if (l && l.autoScaleSize) {
                    var M = 1 / f;
                    this.scale(M, M)
                }
                this._clipPoint && n.restore(), this._startX = s, this._startY = u
            }, t._drawUnderline = function (t, e, i, n) {
                var r = this._lineWidths[n];
                switch (t) {
                    case"center":
                        e -= r / 2;
                        break;
                    case"right":
                        e -= r
                }
                i += this._charSize.height, this._graphics.drawLine(e, i, e + r, i, this.underlineColor || this.color, 1)
            }, t.typeset = function () {
                if (this._isChanged = !1, !this._text) return this._clipPoint = null, this._textWidth = this._textHeight = 0, void this.graphics.clear(!0);
                Rt.isConchApp ? m.conchTextCanvas.font = this._getContextFont() : Lt.context.font = this._getContextFont(), this._lines.length = 0, this._lineWidths.length = 0, this._isPassWordMode() ? this._parseLines(this._getPassWordTxt(this._text)) : this._parseLines(this._text), this._evalTextSize(), this._checkEnabledViewportOrNot() ? this._clipPoint || (this._clipPoint = new Ht(0, 0)) : this._clipPoint = null, this._renderText()
            }, t._evalTextSize = function () {
                var t, e = NaN;
                t = Math.max.apply(this, this._lineWidths), e = this._style.currBitmapFont ? this._lines.length * (this._style.currBitmapFont.getMaxHeight() + this.leading) + this.padding[0] + this.padding[2] : this._lines.length * (this._charSize.height + this.leading) + this.padding[0] + this.padding[2], t == this._textWidth && e == this._textHeight || (this._textWidth = t, this._textHeight = e)
            }, t._checkEnabledViewportOrNot = function () {
                return "scroll" == this.overflow && (0 < this._width && this._textWidth > this._width || 0 < this._height && this._textHeight > this._height)
            }, t.changeText = function (t) {
                this._text !== t && (this.lang(t + ""), this._graphics && this._graphics.replaceText(this._text) || this.typeset())
            }, t._parseLines = function (t) {
                var e = this.wordWrap || "hidden" == this.overflow;
                if (e) var i = this._getWordWrapWidth();
                var n = this._style.currBitmapFont;
                if (n) this._charSize.width = n.getMaxWidth(), this._charSize.height = n.getMaxHeight(); else {
                    var r = null;
                    (r = Rt.isConchApp ? m.conchTextCanvas.measureText(this._testWord) : Lt.context.measureText(f._testWord)) || (r = {width: 100}), this._charSize.width = r.width, this._charSize.height = r.height || this.fontSize
                }
                for (var s = t.replace(/\r\n/g, "\n").split("\n"), a = 0, o = s.length; a < o; a++) {
                    var h = s[a];
                    e ? this._parseLine(h, i) : (this._lineWidths.push(this._getTextWidth(h)), this._lines.push(h))
                }
            }, t._parseLine = function (t, e) {
                Lt.context;
                var i, n = this._lines, r = 0, s = NaN, a = NaN, o = 0;
                if ((s = this._getTextWidth(t)) <= e) return n.push(t), void this._lineWidths.push(s);
                s = this._charSize.width, 0 == (r = Math.floor(e / s)) && (r = 1), a = s = this._getTextWidth(t.substring(0, r));
                for (var h = r, l = t.length; h < l; h++) if (e < (a += s = this._getTextWidth(t.charAt(h)))) if (this.wordWrap) {
                    var u = t.substring(o, h);
                    if (u.charCodeAt(u.length - 1) < 255 && (i = /(?:\w|-)+$/.exec(u)) && (h = i.index + o, 0 == i.index ? h += u.length : u = t.substring(o, h)), n.push(u), this._lineWidths.push(a - s), !((o = h) + r < l)) {
                        n.push(t.substring(o, l)), this._lineWidths.push(this._getTextWidth(n[n.length - 1])), o = -1;
                        break
                    }
                    h += r, a = s = this._getTextWidth(t.substring(o, h)), h--
                } else if ("hidden" == this.overflow) return n.push(t.substring(0, h)), void this._lineWidths.push(this._getTextWidth(n[n.length - 1]));
                this.wordWrap && -1 != o && (n.push(t.substring(o, l)), this._lineWidths.push(this._getTextWidth(n[n.length - 1])))
            }, t._getTextWidth = function (t) {
                var e = this._style.currBitmapFont;
                return e ? e.getTextWidth(t) : Rt.isConchApp ? m.conchTextCanvas.measureText(t).width : Lt.context.measureText(t).width
            }, t._getWordWrapWidth = function () {
                var t = this.padding, e = NaN, i = this._style.currBitmapFont;
                return (e = i && i.autoScaleSize ? this._width * (i.fontSize / this.fontSize) : this._width) <= 0 && (e = this.wordWrap ? 100 : Lt.width), e <= 0 && (e = 100), e - t[3] - t[1]
            }, t.getCharPoint = function (t, e) {
                this._isChanged && y.systemTimer.runCallLater(this, this.typeset);
                for (var i = 0, n = this._lines, r = 0, s = 0, a = n.length; s < a; s++) {
                    if (t < (i += n[s].length)) {
                        var o = s;
                        break
                    }
                    r = i
                }
                var h = (this.italic ? "italic " : "") + (this.bold ? "bold " : "") + this.fontSize + "px " + this.font;
                Lt.context.font = h;
                var l = this._getTextWidth(this._text.substring(r, t));
                return (e || new Ht).setTo(this._startX + l - (this._clipPoint ? this._clipPoint.x : 0), this._startY + o * (this._charSize.height + this.leading) - (this._clipPoint ? this._clipPoint.y : 0))
            }, d(0, t, "width", function () {
                return this._width ? this._width : this.textWidth + this.padding[1] + this.padding[3]
            }, function (t) {
                t != this._width && (y.superSet(je, this, "width", t), this.isChanged = !0, this.borderColor && this._setBorderStyleColor(0, 0, this.width, this.height, this.borderColor, 1))
            }), d(0, t, "textWidth", function () {
                return this._isChanged && y.systemTimer.runCallLater(this, this.typeset), this._textWidth
            }), d(0, t, "height", function () {
                return this._height ? this._height : this.textHeight
            }, function (t) {
                t != this._height && (y.superSet(je, this, "height", t), this.isChanged = !0, this.borderColor && this._setBorderStyleColor(0, 0, this.width, this.height, this.borderColor, 1))
            }), d(0, t, "textHeight", function () {
                return this._isChanged && y.systemTimer.runCallLater(this, this.typeset), this._textHeight
            }), d(0, t, "padding", function () {
                return this._style.padding
            }, function (t) {
                if ("string" == typeof t) {
                    var e, i, n = 0;
                    for (i = (e = t.split(",")).length; e.length < 4;) e.push(0);
                    for (n = 0; n < i; n++) e[n] = parseFloat(e[n]) || 0;
                    t = e
                }
                this._getTextStyle().padding = t, this.isChanged = !0
            }), d(0, t, "bold", function () {
                return this._style.bold
            }, function (t) {
                this._getTextStyle().bold = t, this.isChanged = !0
            }), d(0, t, "text", function () {
                return this._text || ""
            }, function (t) {
                this._text !== t && (this.lang(t + ""), this.isChanged = !0, this.event("change"), this.borderColor && this._setBorderStyleColor(0, 0, this.width, this.height, this.borderColor, 1))
            }), d(0, t, "color", function () {
                return this._color
            }, function (t) {
                this._color != t && (this._color = t, !this._isChanged && this._graphics ? this._graphics.replaceTextColor(this.color) : this.isChanged = !0)
            }), d(0, t, "font", function () {
                return this._font
            }, function (t) {
                this._style.currBitmapFont && (this._getTextStyle().currBitmapFont = null, this.scale(1, 1)), f._bitmapFonts && f._bitmapFonts[t] && (this._getTextStyle().currBitmapFont = f._bitmapFonts[t]), this._font = t, this.isChanged = !0
            }), d(0, t, "fontSize", function () {
                return this._fontSize
            }, function (t) {
                this._fontSize != t && (this._fontSize = t, this.isChanged = !0)
            }), d(0, t, "italic", function () {
                return this._style.italic
            }, function (t) {
                this._getTextStyle().italic = t, this.isChanged = !0
            }), d(0, t, "align", function () {
                return this._style.align
            }, function (t) {
                this._getTextStyle().align = t, this.isChanged = !0
            }), d(0, t, "valign", function () {
                return this._valign
            }, function (t) {
                this._valign = t, this.isChanged = !0
            }), d(0, t, "wordWrap", function () {
                return this._style.wordWrap
            }, function (t) {
                this._getTextStyle().wordWrap = t, this.isChanged = !0
            }), d(0, t, "singleCharRender", function () {
                return this._singleCharRender
            }, function (t) {
                this._singleCharRender = t
            }), d(0, t, "leading", function () {
                return this._style.leading
            }, function (t) {
                this._getTextStyle().leading = t, this.isChanged = !0
            }), d(0, t, "bgColor", function () {
                return this._style.bgColor
            }, function (t) {
                this._getTextStyle().bgColor = t, this._renderType |= 128, this._setBgStyleColor(0, 0, this.width, this.height, t), this._setRenderType(this._renderType), this.isChanged = !0
            }), d(0, t, "borderColor", function () {
                return this._style.borderColor
            }, function (t) {
                this._getTextStyle().borderColor = t, this._renderType |= 128, this._setBorderStyleColor(0, 0, this.width, this.height, t, 1), this._setRenderType(this._renderType), this.isChanged = !0
            }), d(0, t, "stroke", function () {
                return this._style.stroke
            }, function (t) {
                this._getTextStyle().stroke = t, this.isChanged = !0
            }), d(0, t, "strokeColor", function () {
                return this._style.strokeColor
            }, function (t) {
                this._getTextStyle().strokeColor = t, this.isChanged = !0
            }), d(0, t, "isChanged", null, function (t) {
                this._isChanged !== t && (this._isChanged = t) && y.systemTimer.callLater(this, this.typeset)
            }), d(0, t, "scrollX", function () {
                return this._clipPoint ? this._clipPoint.x : 0
            }, function (t) {
                if (!("scroll" != this.overflow || this.textWidth < this._width) && this._clipPoint) {
                    t = t < this.padding[3] ? this.padding[3] : t;
                    var e = this._textWidth - this._width;
                    t = e < t ? e : t, this._clipPoint.x = t, this._renderText()
                }
            }), d(0, t, "scrollY", function () {
                return this._clipPoint ? this._clipPoint.y : 0
            }, function (t) {
                if (!("scroll" != this.overflow || this.textHeight < this._height) && this._clipPoint) {
                    t = t < this.padding[0] ? this.padding[0] : t;
                    var e = this._textHeight - this._height;
                    t = e < t ? e : t, this._clipPoint.y = t, this._renderText()
                }
            }), d(0, t, "maxScrollX", function () {
                return this.textWidth < this._width ? 0 : this._textWidth - this._width
            }), d(0, t, "maxScrollY", function () {
                return this.textHeight < this._height ? 0 : this._textHeight - this._height
            }), d(0, t, "lines", function () {
                return this._isChanged && this.typeset(), this._lines
            }), d(0, t, "underlineColor", function () {
                return this._style.underlineColor
            }, function (t) {
                this._getTextStyle().underlineColor = t, this._isChanged || this._renderText()
            }), d(0, t, "underline", function () {
                return this._style.underline
            }, function (t) {
                this._getTextStyle().underline = t
            }), f.defaultFontStr = function () {
                return f.defaultFontSize + "px " + f.defaultFont
            }, f.registerBitmapFont = function (t, e) {
                f._bitmapFonts || (f._bitmapFonts = {}), f._bitmapFonts[t] = e
            }, f.unregisterBitmapFont = function (t, e) {
                if (void 0 === e && (e = !0), f._bitmapFonts && f._bitmapFonts[t]) {
                    var i = f._bitmapFonts[t];
                    e && i.destroy(), delete f._bitmapFonts[t]
                }
            }, f.VISIBLE = "visible", f.SCROLL = "scroll", f.HIDDEN = "hidden", f.defaultFontSize = 12, f.defaultFont = "Arial", f.langPacks = null, f.isComplexText = !1, f._testWord = "游", f._bitmapFonts = null, f.CharacterCache = !0, f.RightToLeft = !1, a(f, ["fontFamilyMap", function () {
                return this.fontFamilyMap = {
                    "报隶": "报隶-简",
                    "黑体": "黑体-简",
                    "楷体": "楷体-简",
                    "兰亭黑": "兰亭黑-简",
                    "隶变": "隶变-简",
                    "凌慧体": "凌慧体-简",
                    "翩翩体": "翩翩体-简",
                    "苹方": "苹方-简",
                    "手札体": "手札体-简",
                    "宋体": "宋体-简",
                    "娃娃体": "娃娃体-简",
                    "魏碑": "魏碑-简",
                    "行楷": "行楷-简",
                    "雅痞": "雅痞-简",
                    "圆体": "圆体-简"
                }
            }]), f
        }(je), ii = function (e) {
            function t() {
                this.loop = !1, this.wrapMode = 0, this._index = 0, this._count = 0, this._isPlaying = !1, this._labels = null, this._isReverse = !1, this._frameRateChanged = !1, this._actionName = null, this._controlNode = null, t.__super.call(this), this._interval = ae.animationInterval, this._setBitUp(16)
            }

            x(t, "laya.display.AnimationBase", e);
            var i = t.prototype;
            return i.play = function (t, e, i) {
                void 0 === t && (t = 0), void 0 === e && (e = !0), void 0 === i && (i = ""), this._isPlaying = !0, this._actionName = i, this.index = "string" == typeof t ? this._getFrameByLabel(t) : t, this.loop = e, this._isReverse = 1 === this.wrapMode, 0 == this.index && this._isReverse && (this.index = this.count - 1), 0 < this.interval && this.timerLoop(this.interval, this, this._frameLoop, null, !0, !0)
            }, i._getFrameByLabel = function (t) {
                for (var e = 0; e < this._count; e++) {
                    var i = this._labels[e];
                    if (i && -1 < i.indexOf(t)) return e
                }
                return 0
            }, i._frameLoop = function () {
                if (this._isReverse) {
                    if (this._index--, this._index < 0) {
                        if (!this.loop) return this._index = 0, this.stop(), void this.event("complete");
                        2 == this.wrapMode ? (this._index = 0 < this._count ? 1 : 0, this._isReverse = !1) : this._index = this._count - 1, this.event("complete")
                    }
                } else if (this._index++, this._index >= this._count) {
                    if (!this.loop) return this._index--, this.stop(), void this.event("complete");
                    2 == this.wrapMode ? (this._index = 0 <= this._count - 2 ? this._count - 2 : 0, this._isReverse = !0) : this._index = 0, this.event("complete")
                }
                this.index = this._index
            }, i._setControlNode = function (t) {
                this._controlNode && (this._controlNode.off("display", this, this._resumePlay), this._controlNode.off("undisplay", this, this._resumePlay)), (this._controlNode = t) && t != this && (t.on("display", this, this._resumePlay), t.on("undisplay", this, this._resumePlay))
            }, i._setDisplay = function (t) {
                e.prototype._setDisplay.call(this, t), this._resumePlay()
            }, i._resumePlay = function () {
                this._isPlaying && (this._controlNode.displayedInStage ? this.play(this._index, this.loop, this._actionName) : this.clearTimer(this, this._frameLoop))
            }, i.stop = function () {
                this._isPlaying = !1, this.clearTimer(this, this._frameLoop)
            }, i.addLabel = function (t, e) {
                this._labels || (this._labels = {}), this._labels[e] || (this._labels[e] = []), this._labels[e].push(t)
            }, i.removeLabel = function (t) {
                if (t) {
                    if (this._labels) for (var e in this._labels) this._removeLabelFromList(this._labels[e], t)
                } else this._labels = null
            }, i._removeLabelFromList = function (t, e) {
                if (t) for (var i = t.length - 1; 0 <= i; i--) t[i] == e && t.splice(i, 1)
            }, i.gotoAndStop = function (t) {
                this.index = "string" == typeof t ? this._getFrameByLabel(t) : t, this.stop()
            }, i._displayToIndex = function (t) {
            }, i.clear = function () {
                return this.stop(), this._labels = null, this
            }, d(0, i, "interval", function () {
                return this._interval
            }, function (t) {
                this._interval != t && (this._frameRateChanged = !0, this._interval = t, this._isPlaying && 0 < t && this.timerLoop(t, this, this._frameLoop, null, !0, !0))
            }), d(0, i, "isPlaying", function () {
                return this._isPlaying
            }), d(0, i, "index", function () {
                return this._index
            }, function (t) {
                if (this._index = t, this._displayToIndex(t), this._labels && this._labels[t]) for (var e = this._labels[t], i = 0, n = e.length; i < n; i++) this.event("label", e[i])
            }), d(0, i, "count", function () {
                return this._count
            }), t.WRAP_POSITIVE = 0, t.WRAP_REVERSE = 1, t.WRAP_PINGPONG = 2, t
        }(je), ni = function (t) {
            function h(t, e, i, n, r) {
                if (this._attribInfo = null, this.customCompile = !1, this._curActTexIndex = 0, this.tag = {}, this._program = null, this._params = null, this._paramsMap = {}, h.__super.call(this), !t || !e) throw"Shader Error";
                this._attribInfo = r, this._id = ++h._count, this._vs = t, this._ps = e, this._nameMap = n || {}, null != i && (h.sharders[i] = this), this.recreateResource(), this.lock = !0
            }

            x(h, "laya.webgl.shader.Shader", Ke);
            var e = h.prototype;
            return e.recreateResource = function () {
                this._compile(), this._setGPUMemory(0)
            }, e._disposeResource = function () {
                Ct.mainContext.deleteShader(this._vshader), Ct.mainContext.deleteShader(this._pshader), Ct.mainContext.deleteProgram(this._program), this._vshader = this._pshader = this._program = null, this._params = null, this._paramsMap = {}, this._setGPUMemory(0), this._curActTexIndex = 0
            }, e._compile = function () {
                if (this._vs && this._ps && !this._params) {
                    var t;
                    this._reCompile = !0, this._params = [], this.customCompile && (t = me.preGetParams(this._vs, this._ps));
                    var e = Ct.mainContext;
                    this._program = e.createProgram(), this._vshader = h._createShader(e, this._vs, 35633), this._pshader = h._createShader(e, this._ps, 35632), e.attachShader(this._program, this._vshader), e.attachShader(this._program, this._pshader);
                    var i, n, r = 0, s = this._attribInfo ? this._attribInfo.length : 0;
                    for (r = 0; r < s; r += 2) e.bindAttribLocation(this._program, this._attribInfo[r + 1], this._attribInfo[r]);
                    if (e.linkProgram(this._program), !this.customCompile && !e.getProgramParameter(this._program, 35714)) throw e.getProgramInfoLog(this._program);
                    var a = this.customCompile ? t.uniforms.length : e.getProgramParameter(this._program, 35718);
                    for (r = 0; r < a; r++) {
                        var o = this.customCompile ? t.uniforms[r] : e.getActiveUniform(this._program, r);
                        0 < (i = {
                            vartype: "uniform",
                            glfun: null,
                            ivartype: 1,
                            location: e.getUniformLocation(this._program, o.name),
                            name: o.name,
                            type: o.type,
                            isArray: !1,
                            isSame: !1,
                            preValue: null,
                            indexOfParams: 0
                        }).name.indexOf("[0]") && (i.name = i.name.substr(0, i.name.length - 3), i.isArray = !0, i.location = e.getUniformLocation(this._program, i.name)), this._params.push(i)
                    }
                    for (r = 0, n = this._params.length; r < n; r++) switch ((i = this._params[r]).indexOfParams = r, i.index = 1, i.value = [i.location, null], i.codename = i.name, i.name = this._nameMap[i.codename] ? this._nameMap[i.codename] : i.codename, (this._paramsMap[i.name] = i)._this = this, i.uploadedValue = [], i.type) {
                        case 5124:
                            i.fun = i.isArray ? this._uniform1iv : this._uniform1i;
                            break;
                        case 5126:
                            i.fun = i.isArray ? this._uniform1fv : this._uniform1f;
                            break;
                        case 35664:
                            i.fun = i.isArray ? this._uniform_vec2v : this._uniform_vec2;
                            break;
                        case 35665:
                            i.fun = i.isArray ? this._uniform_vec3v : this._uniform_vec3;
                            break;
                        case 35666:
                            i.fun = i.isArray ? this._uniform_vec4v : this._uniform_vec4;
                            break;
                        case 35678:
                            i.fun = this._uniform_sampler2D;
                            break;
                        case 35680:
                            i.fun = this._uniform_samplerCube;
                            break;
                        case 35676:
                            i.glfun = e.uniformMatrix4fv, i.fun = this._uniformMatrix4fv;
                            break;
                        case 35670:
                            i.fun = this._uniform1i;
                            break;
                        case 35674:
                        case 35675:
                        default:
                            throw new Error("compile shader err!")
                    }
                }
            }, e.getUniform = function (t) {
                return this._paramsMap[t]
            }, e._uniform1f = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e ? (Ct.mainContext.uniform1f(t.location, i[0] = e), 1) : 0
            }, e._uniform1fv = function (t, e) {
                if (e.length < 4) {
                    var i = t.uploadedValue;
                    return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (Ct.mainContext.uniform1fv(t.location, e), i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3], 1) : 0
                }
                return Ct.mainContext.uniform1fv(t.location, e), 1
            }, e._uniform_vec2 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] ? (Ct.mainContext.uniform2f(t.location, i[0] = e[0], i[1] = e[1]), 1) : 0
            }, e._uniform_vec2v = function (t, e) {
                if (e.length < 2) {
                    var i = t.uploadedValue;
                    return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (Ct.mainContext.uniform2fv(t.location, e), i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3], 1) : 0
                }
                return Ct.mainContext.uniform2fv(t.location, e), 1
            }, e._uniform_vec3 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] ? (Ct.mainContext.uniform3f(t.location, i[0] = e[0], i[1] = e[1], i[2] = e[2]), 1) : 0
            }, e._uniform_vec3v = function (t, e) {
                return Ct.mainContext.uniform3fv(t.location, e), 1
            }, e._uniform_vec4 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (Ct.mainContext.uniform4f(t.location, i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3]), 1) : 0
            }, e._uniform_vec4v = function (t, e) {
                return Ct.mainContext.uniform4fv(t.location, e), 1
            }, e._uniformMatrix2fv = function (t, e) {
                return Ct.mainContext.uniformMatrix2fv(t.location, !1, e), 1
            }, e._uniformMatrix3fv = function (t, e) {
                return Ct.mainContext.uniformMatrix3fv(t.location, !1, e), 1
            }, e._uniformMatrix4fv = function (t, e) {
                return Ct.mainContext.uniformMatrix4fv(t.location, !1, e), 1
            }, e._uniform1i = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e ? (Ct.mainContext.uniform1i(t.location, i[0] = e), 1) : 0
            }, e._uniform1iv = function (t, e) {
                return Ct.mainContext.uniform1iv(t.location, e), 1
            }, e._uniform_ivec2 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] ? (Ct.mainContext.uniform2i(t.location, i[0] = e[0], i[1] = e[1]), 1) : 0
            }, e._uniform_ivec2v = function (t, e) {
                return Ct.mainContext.uniform2iv(t.location, e), 1
            }, e._uniform_vec3i = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] ? (Ct.mainContext.uniform3i(t.location, i[0] = e[0], i[1] = e[1], i[2] = e[2]), 1) : 0
            }, e._uniform_vec3vi = function (t, e) {
                return Ct.mainContext.uniform3iv(t.location, e), 1
            }, e._uniform_vec4i = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (Ct.mainContext.uniform4i(t.location, i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3]), 1) : 0
            }, e._uniform_vec4vi = function (t, e) {
                return Ct.mainContext.uniform4iv(t.location, e), 1
            }, e._uniform_sampler2D = function (t, e) {
                var i = Ct.mainContext, n = t.uploadedValue;
                return null == n[0] ? (n[0] = this._curActTexIndex, i.uniform1i(t.location, this._curActTexIndex), rt.activeTexture(i, 33984 + this._curActTexIndex), rt.bindTexture(i, 3553, e), this._curActTexIndex++, 1) : (rt.activeTexture(i, 33984 + n[0]), rt.bindTexture(i, 3553, e), 0)
            }, e._uniform_samplerCube = function (t, e) {
                var i = Ct.mainContext, n = t.uploadedValue;
                return null == n[0] ? (n[0] = this._curActTexIndex, i.uniform1i(t.location, this._curActTexIndex), rt.activeTexture(i, 33984 + this._curActTexIndex), rt.bindTexture(i, 34067, e), this._curActTexIndex++, 1) : (rt.activeTexture(i, 33984 + n[0]), rt.bindTexture(i, 34067, e), 0)
            }, e._noSetValue = function (t) {
            }, e.uploadOne = function (t, e) {
                rt.useProgram(Ct.mainContext, this._program);
                var i = this._paramsMap[t];
                i.fun.call(this, i, e)
            }, e.uploadTexture2D = function (t) {
                var e = rt;
                e._activeTextures[0] !== t && (e.bindTexture(Ct.mainContext, e.TEXTURE_2D, t), e._activeTextures[0] = t)
            }, e.upload = function (t, e) {
                Ke.activeShader = Ke.bindShader = this;
                var i = Ct.mainContext;
                rt.useProgram(i, this._program), this._reCompile ? (e = this._params, this._reCompile = !1) : e = e || this._params;
                for (var n, r, s = e.length, a = 0, o = 0; o < s; o++) null !== (r = t[(n = e[o]).name]) && (a += n.fun.call(this, n, r));
                M.shaderCall += a
            }, e.uploadArray = function (t, e, i) {
                Ke.activeShader = this, Ke.bindShader = this, rt.useProgram(Ct.mainContext, this._program);
                this._params;
                for (var n, r, s = 0, a = e - 2; 0 <= a; a -= 2) (r = this._paramsMap[t[a]]) && null != (n = t[a + 1]) && (i && i[r.name] && i[r.name].bind(), s += r.fun.call(this, r, n));
                M.shaderCall += s
            }, e.getParams = function () {
                return this._params
            }, e.setAttributesLocation = function (t) {
                this._attribInfo = t
            }, h.getShader = function (t) {
                return h.sharders[t]
            }, h.create = function (t, e, i, n, r) {
                return new h(t, e, i, n, r)
            }, h.withCompile = function (t, e, i, n) {
                if (i && h.sharders[i]) return h.sharders[i];
                var r = h._preCompileShader[2e-4 * t];
                if (!r) throw new Error("withCompile shader err!" + t);
                return r.createShader(e, i, n, null)
            }, h.withCompile2D = function (t, e, i, n, r, s) {
                if (n && h.sharders[n]) return h.sharders[n];
                var a = h._preCompileShader[2e-4 * t + e];
                if (!a) throw new Error("withCompile shader err!" + t + " " + e);
                return a.createShader(i, n, r, s)
            }, h.addInclude = function (t, e) {
                me.addInclude(t, e)
            }, h.preCompile = function (t, e, i, n) {
                h._preCompileShader[2e-4 * t] = new me(e, i, n)
            }, h.preCompile2D = function (t, e, i, n, r) {
                h._preCompileShader[2e-4 * t + e] = new me(i, n, r)
            }, h._createShader = function (t, e, i) {
                var n = t.createShader(i);
                return t.shaderSource(n, e), t.compileShader(n), t.getShaderParameter(n, 35713) ? n : null
            }, h._count = 0, h._preCompileShader = {}, h.SHADERNAME2ID = 2e-4, h.sharders = new Array(32), a(h, ["nameKey", function () {
                return this.nameKey = new Wt
            }]), h
        }(), ri = (function (t) {
            function e() {
                this.url = null, this._channel = null, this._tar = null, this._playEvents = null, this._stopEvents = null, e.__super.call(this), this.visible = !1, this.on("added", this, this._onParentChange), this.on("removed", this, this._onParentChange)
            }

            x(e, "laya.media.SoundNode", je);
            var i = e.prototype;
            i._onParentChange = function () {
                this.target = this.parent
            }, i.play = function (t, e) {
                void 0 === t && (t = 1), isNaN(t) && (t = 1), this.url && (this.stop(), this._channel = xe.playSound(this.url, t, e))
            }, i.stop = function () {
                this._channel && !this._channel.isStopped && this._channel.stop(), this._channel = null
            }, i._setPlayAction = function (t, e, i, n) {
                void 0 === n && (n = !0), this[i] && t && (n ? t.on(e, this, this[i]) : t.off(e, this, this[i]))
            }, i._setPlayActions = function (t, e, i, n) {
                if (void 0 === n && (n = !0), t && e) {
                    var r, s = e.split(","), a = 0;
                    for (r = s.length, a = 0; a < r; a++) this._setPlayAction(t, s[a], i, n)
                }
            }, d(0, i, "playEvent", null, function (t) {
                (this._playEvents = t) && this._tar && this._setPlayActions(this._tar, t, "play")
            }), d(0, i, "target", null, function (t) {
                this._tar && (this._setPlayActions(this._tar, this._playEvents, "play", !1), this._setPlayActions(this._tar, this._stopEvents, "stop", !1)), this._tar = t, this._tar && (this._setPlayActions(this._tar, this._playEvents, "play", !0), this._setPlayActions(this._tar, this._stopEvents, "stop", !0))
            }), d(0, i, "stopEvent", null, function (t) {
                (this._stopEvents = t) && this._tar && this._setPlayActions(this._tar, t, "stop")
            })
        }(), function (t) {
            function i(t, e) {
                i.__super.call(this), this._wrapModeU = 0, this._wrapModeV = 0, this._filterMode = 1, this._readyed = !1, this._width = -1, this._height = -1, this._format = t, this._mipmap = e, this._anisoLevel = 1, this._glTexture = Dt.instance.createTexture()
            }

            x(i, "laya.resource.BaseTexture", $e);
            var e = i.prototype;
            return e._isPot = function (t) {
                return 0 == (t & t - 1)
            }, e._getGLFormat = function () {
                var t = 0;
                switch (this._format) {
                    case 0:
                        t = 6407;
                        break;
                    case 1:
                        t = 6408;
                        break;
                    case 2:
                        t = 6406;
                        break;
                    case 3:
                        if (!rt._compressedTextureS3tc) throw"BaseTexture: not support DXT1 format.";
                        t = rt._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;
                        break;
                    case 4:
                        if (!rt._compressedTextureS3tc) throw"BaseTexture: not support DXT5 format.";
                        t = rt._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;
                        break;
                    case 5:
                        if (!rt._compressedTextureEtc1) throw"BaseTexture: not support ETC1RGB format.";
                        t = rt._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;
                        break;
                    case 9:
                        if (!rt._compressedTexturePvrtc) throw"BaseTexture: not support PVRTCRGB_2BPPV format.";
                        t = rt._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
                        break;
                    case 10:
                        if (!rt._compressedTexturePvrtc) throw"BaseTexture: not support PVRTCRGBA_2BPPV format.";
                        t = rt._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;
                        break;
                    case 11:
                        if (!rt._compressedTexturePvrtc) throw"BaseTexture: not support PVRTCRGB_4BPPV format.";
                        t = rt._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
                        break;
                    case 12:
                        if (!rt._compressedTexturePvrtc) throw"BaseTexture: not support PVRTCRGBA_4BPPV format.";
                        t = rt._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
                        break;
                    default:
                        throw"BaseTexture: unknown texture format."
                }
                return t
            }, e._setFilterMode = function (t) {
                var e = Dt.instance;
                switch (rt.bindTexture(e, this._glTextureType, this._glTexture), t) {
                    case 0:
                        this._mipmap ? e.texParameteri(this._glTextureType, 10241, 9984) : e.texParameteri(this._glTextureType, 10241, 9728), e.texParameteri(this._glTextureType, 10240, 9728);
                        break;
                    case 1:
                        this._mipmap ? e.texParameteri(this._glTextureType, 10241, 9985) : e.texParameteri(this._glTextureType, 10241, 9729), e.texParameteri(this._glTextureType, 10240, 9729);
                        break;
                    case 2:
                        this._mipmap ? e.texParameteri(this._glTextureType, 10241, 9987) : e.texParameteri(this._glTextureType, 10241, 9729), e.texParameteri(this._glTextureType, 10240, 9729);
                        break;
                    default:
                        throw new Error("BaseTexture:unknown filterMode value.")
                }
            }, e._setWarpMode = function (t, e) {
                var i = Dt.instance;
                if (rt.bindTexture(i, this._glTextureType, this._glTexture), this._isPot(this._width) && this._isPot(this._height)) switch (e) {
                    case 0:
                        i.texParameteri(this._glTextureType, t, 10497);
                        break;
                    case 1:
                        i.texParameteri(this._glTextureType, t, 33071)
                } else i.texParameteri(this._glTextureType, t, 33071)
            }, e._setAnisotropy = function (t) {
                var e = rt._extTextureFilterAnisotropic;
                if (e && !Lt.onLimixiu) {
                    t = Math.max(t, 1);
                    var i = Dt.instance;
                    rt.bindTexture(i, this._glTextureType, this._glTexture), t = Math.min(i.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT), t), i.texParameterf(this._glTextureType, e.TEXTURE_MAX_ANISOTROPY_EXT, t)
                }
            }, e._disposeResource = function () {
                this._glTexture && (Dt.instance.deleteTexture(this._glTexture), this._glTexture = null, this._setGPUMemory(0))
            }, e._getSource = function () {
                return this._readyed ? this._glTexture : null
            }, e.generateMipmap = function () {
                this._isPot(this.width) && this._isPot(this.height) && Dt.instance.generateMipmap(this._glTextureType)
            }, d(0, e, "wrapModeU", function () {
                return this._wrapModeU
            }, function (t) {
                this._wrapModeU !== t && (this._wrapModeU = t, -1 !== this._width && this._setWarpMode(10242, t))
            }), d(0, e, "mipmap", function () {
                return this._mipmap
            }), d(0, e, "format", function () {
                return this._format
            }), d(0, e, "wrapModeV", function () {
                return this._wrapModeV
            }, function (t) {
                this._wrapModeV !== t && (this._wrapModeV = t, -1 !== this._height && this._setWarpMode(10243, t))
            }), d(0, e, "defaulteTexture", function () {
                throw"BaseTexture:must override it."
            }), d(0, e, "filterMode", function () {
                return this._filterMode
            }, function (t) {
                t !== this._filterMode && (this._filterMode = t, -1 !== this._width && -1 !== this._height && this._setFilterMode(t))
            }), d(0, e, "anisoLevel", function () {
                return this._anisoLevel
            }, function (t) {
                t !== this._anisoLevel && (this._anisoLevel = Math.max(1, Math.min(16, t)), -1 !== this._width && -1 !== this._height && this._setAnisotropy(t))
            }), i.WARPMODE_REPEAT = 0, i.WARPMODE_CLAMP = 1, i.FILTERMODE_POINT = 0, i.FILTERMODE_BILINEAR = 1, i.FILTERMODE_TRILINEAR = 2, i.FORMAT_R8G8B8 = 0, i.FORMAT_R8G8B8A8 = 1, i.FORMAT_ALPHA8 = 2, i.FORMAT_DXT1 = 3, i.FORMAT_DXT5 = 4, i.FORMAT_ETC1RGB = 5, i.FORMAT_PVRTCRGB_2BPPV = 9, i.FORMAT_PVRTCRGBA_2BPPV = 10, i.FORMAT_PVRTCRGB_4BPPV = 11, i.FORMAT_PVRTCRGBA_4BPPV = 12, i.FORMAT_DEPTH_16 = 0, i.FORMAT_STENCIL_8 = 1, i.FORMAT_DEPTHSTENCIL_16_8 = 2, i.FORMAT_DEPTHSTENCIL_NONE = 3, i
        }()), si = function (t) {
            function e(t) {
                e.__super.call(this), void 0 === t && (t = !1), this._source = t ? Lt.createElement("canvas") : this, this.lock = !0
            }

            x(e, "laya.resource.HTMLCanvas", $e);
            var i = e.prototype;
            return i._getSource = function () {
                return this._source
            }, i.clear = function () {
                this._ctx && this._ctx.clear && this._ctx.clear(), this._texture && (this._texture.destroy(), this._texture = null)
            }, i.destroy = function () {
                laya.resource.Resource.prototype.destroy.call(this), this._setCPUMemory(0), this._ctx && this._ctx.destroy(), this._ctx = null
            }, i.release = function () {
            }, i._setContext = function (t) {
                this._ctx = t
            }, i.getContext = function (t, e) {
                return this.context
            }, i.getMemSize = function () {
                return 0
            }, i.size = function (t, e) {
                (this._width != t || this._height != e || this._source && (this._source.width != t || this._source.height != e)) && (this._width = t, this._height = e, this._setCPUMemory(t * e * 4), this._ctx && this._ctx.size && this._ctx.size(t, e), this._source && (this._source.height = e, this._source.width = t), this._texture && (this._texture.destroy(), this._texture = null))
            }, i.getTexture = function () {
                if (!this._texture) {
                    var t = new _i;
                    t.loadImageSource(this.source), this._texture = new Ie(t)
                }
                return this._texture
            }, i.toBase64 = function (t, e) {
                if (this._source) {
                    if (Rt.isConchApp) {
                        if (2 == conchConfig.threadMode) throw"native 2 thread mode use toBase64Async";
                        var i = this._ctx._targets.sourceWidth, n = this._ctx._targets.sourceHeight,
                            r = this._ctx._targets.getData(0, 0, i, n);
                        return conchToBase64FlipY ? conchToBase64FlipY(t, e, r.buffer, i, n) : conchToBase64(t, e, r.buffer, i, n)
                    }
                    return this._source.toDataURL(t, e)
                }
                return null
            }, i.toBase64Async = function (i, n, r) {
                var s = this._ctx._targets.sourceWidth, a = this._ctx._targets.sourceHeight;
                this._ctx._targets.getDataAsync(0, 0, s, a, function (t) {
                    var e = conchToBase64FlipY ? conchToBase64FlipY(i, n, t.buffer, s, a) : conchToBase64(i, n, t.buffer, s, a);
                    r(e)
                })
            }, d(0, i, "source", function () {
                return this._source
            }), d(0, i, "context", function () {
                return this._ctx ? this._ctx : (this._source == this ? this._ctx = new ct : this._ctx = this._source.getContext(Rt.isConchApp ? "layagl" : "2d"), (this._ctx._canvas = this)._ctx)
            }), e
        }(), ai = (function (t) {
            function e() {
                e.__super.call(this)
            }

            x(e, "laya.resource.HTMLImage", $e), e.create = function (t, e, i) {
                var n = new _i(t, e, i, !1, !1);
                return n.wrapModeU = 1, n.wrapModeV = 1, n
            }
        }(), function (h) {
            function l() {
                this.focus = null, this._frameRate = "fast", this.designWidth = 0, this.designHeight = 0, this.canvasRotation = !1, this.canvasDegree = 0, this.renderingEnabled = !0, this.screenAdaptationEnabled = !0, this._screenMode = "none", this._scaleMode = "noscale", this._alignV = "top", this._alignH = "left", this._bgColor = "black", this._mouseMoveTime = 0, this._renderCount = 0, this._safariOffsetY = 0, this._frameStartTime = 0, this._isFocused = !1, this._isVisibility = !1, this._wgColor = [0, 0, 0, 1], this._scene3Ds = [], this._globalRepaintSet = !1, this._globalRepaintGet = !1, this._curUIBase = null, this.useRetinalCanvas = !1, l.__super.call(this), this.offset = new Ht, this._canvasTransform = new at, this._previousOrientation = Lt.window.orientation, this._3dUI = [];
                var e = this;
                this.transform = this._createTransform(), this.mouseEnabled = !0, this.hitTestPrior = !0, this.autoSize = !1, this._setBit(128, !0), this._setBit(2, !0), this._isFocused = !0, this._isVisibility = !0, this.useRetinalCanvas = ae.useRetinalCanvas;
                var t = Lt.window, i = this;
                t.addEventListener("focus", function () {
                    e._isFocused = !0, i.event("focus"), i.event("focuschange")
                }), t.addEventListener("blur", function () {
                    e._isFocused = !1, i.event("blur"), i.event("focuschange"), i._isInputting() && (li.inputElement.target.focus = !1)
                });
                var n = "visibilityState", r = "visibilitychange", s = t.document;
                void 0 !== s.hidden ? (r = "visibilitychange", n = "visibilityState") : void 0 !== s.mozHidden ? (r = "mozvisibilitychange", n = "mozVisibilityState") : void 0 !== s.msHidden ? (r = "msvisibilitychange", n = "msVisibilityState") : void 0 !== s.webkitHidden && (r = "webkitvisibilitychange", n = "webkitVisibilityState"), t.document.addEventListener(r, function () {
                    "hidden" == Lt.document[n] ? (e._isVisibility = !1, i._isInputting() && (li.inputElement.target.focus = !1)) : e._isVisibility = !0;
                    e.renderingEnabled = e._isVisibility, i.event("visibilitychange")
                }), t.addEventListener("resize", function () {
                    var t = Lt.window.orientation;
                    null != t && t != e._previousOrientation && i._isInputting() && (li.inputElement.target.focus = !1), e._previousOrientation = t, i._isInputting() || (Lt.onSafari && (i._safariOffsetY = (Lt.window.__innerHeight || Lt.document.body.clientHeight || Lt.document.documentElement.clientHeight) - Lt.window.innerHeight), i._resetCanvas())
                }), t.addEventListener("orientationchange", function (t) {
                    i._resetCanvas()
                }), this.on("mousemove", this, this._onmouseMove), Lt.onMobile && this.on("mousedown", this, this._onmouseMove)
            }

            x(l, "laya.display.Stage", h);
            var t = l.prototype;
            return t._isInputting = function () {
                return Lt.onMobile && li.isInputting
            }, t._changeCanvasSize = function () {
                this.setScreenSize(Lt.clientWidth * Lt.pixelRatio, Lt.clientHeight * Lt.pixelRatio)
            }, t._resetCanvas = function () {
                this.screenAdaptationEnabled && this._changeCanvasSize()
            }, t.setScreenSize = function (t, e) {
                var i = !1;
                if ("none" !== this._screenMode && (i = (t / e < 1 ? "vertical" : "horizontal") !== this._screenMode)) {
                    var n = e;
                    e = t, t = n
                }
                this.canvasRotation = i;
                var r = Rt._mainCanvas, s = r.source.style, a = this._canvasTransform.identity(), o = this._scaleMode,
                    h = t / this.designWidth, l = e / this.designHeight,
                    u = this.useRetinalCanvas ? t : this.designWidth, c = this.useRetinalCanvas ? e : this.designHeight,
                    _ = t, f = e, d = Lt.pixelRatio;
                switch (this._width = this.designWidth, this._height = this.designHeight, o) {
                    case"noscale":
                        h = l = 1, _ = this.designWidth, f = this.designHeight;
                        break;
                    case"showall":
                        h = l = Math.min(h, l), u = _ = Math.round(this.designWidth * h), c = f = Math.round(this.designHeight * l);
                        break;
                    case"noborder":
                        h = l = Math.max(h, l), _ = Math.round(this.designWidth * h), f = Math.round(this.designHeight * l);
                        break;
                    case"full":
                        h = l = 1, this._width = u = t, this._height = c = e;
                        break;
                    case"fixedwidth":
                        l = h, this._height = c = Math.round(e / h);
                        break;
                    case"fixedheight":
                        h = l, this._width = u = Math.round(t / l);
                        break;
                    case"fixedauto":
                        t / e < this.designWidth / this.designHeight ? (l = h, this._height = c = Math.round(e / h)) : (h = l, this._width = u = Math.round(t / l))
                }
                this.useRetinalCanvas && (u = t, c = e), h *= this.scaleX, l *= this.scaleY, 1 === h && 1 === l ? this.transform.identity() : (this.transform.a = this._formatData(h / (_ / u)), this.transform.d = this._formatData(l / (f / c))), r.size(u, c), ce.changeWebGLSize(u, c), a.scale(_ / u / d, f / c / d), "left" === this._alignH ? this.offset.x = 0 : "right" === this._alignH ? this.offset.x = t - _ : this.offset.x = .5 * (t - _) / d, "top" === this._alignV ? this.offset.y = 0 : "bottom" === this._alignV ? this.offset.y = e - f : this.offset.y = .5 * (e - f) / d, this.offset.x = Math.round(this.offset.x), this.offset.y = Math.round(this.offset.y), a.translate(this.offset.x, this.offset.y), this._safariOffsetY && a.translate(0, this._safariOffsetY), this.canvasDegree = 0, i && ("horizontal" === this._screenMode ? (a.rotate(Math.PI / 2), a.translate(e / d, 0), this.canvasDegree = 90) : (a.rotate(-Math.PI / 2), a.translate(0, t / d), this.canvasDegree = -90)), a.a = this._formatData(a.a), a.d = this._formatData(a.d), a.tx = this._formatData(a.tx), a.ty = this._formatData(a.ty), this.transform = this.transform, s.transformOrigin = s.webkitTransformOrigin = s.msTransformOrigin = s.mozTransformOrigin = s.oTransformOrigin = "0px 0px 0px", s.transform = s.webkitTransform = s.msTransform = s.mozTransform = s.oTransform = "matrix(" + a.toString() + ")", this._safariOffsetY && a.translate(0, -this._safariOffsetY), a.translate(parseInt(s.left) || 0, parseInt(s.top) || 0), this.visible = !0, this._repaint |= 2, this.event("resize")
            }, t._formatData = function (t) {
                return Math.abs(t) < 1e-6 ? 0 : Math.abs(1 - t) < .001 ? 0 < t ? 1 : -1 : t
            }, t.getMousePoint = function () {
                return Ht.TEMP.setTo(this.mouseX, this.mouseY)
            }, t.repaint = function (t) {
                void 0 === t && (t = 2), this._repaint |= t
            }, t.parentRepaint = function (t) {
                void 0 === t && (t = 2)
            }, t._loop = function () {
                return this._globalRepaintGet = this._globalRepaintSet, this._globalRepaintSet = !1, this.render(Rt._context, 0, 0), !0
            }, t.getFrameTm = function () {
                return this._frameStartTime
            }, t._onmouseMove = function (t) {
                this._mouseMoveTime = Lt.now()
            }, t.getTimeFromFrameStart = function () {
                return Lt.now() - this._frameStartTime
            }, t.render = function (t, e, i) {
                if (l._dbgSprite.graphics.clear(), "sleep" === this._frameRate) {
                    var n = Lt.now();
                    if (!(1e3 <= n - this._frameStartTime)) return;
                    this._frameStartTime = n
                } else {
                    if (!this._visible) return this._renderCount++, void (this._renderCount % 5 == 0 && (Qt.I._update(), M.loopCount++, this._updateTimers()));
                    this._frameStartTime = Lt.now()
                }
                this._renderCount++;
                var r = "slow" !== ("mouse" === this._frameRate ? this._frameStartTime - this._mouseMoveTime < 2e3 ? "fast" : "slow" : this._frameRate),
                    s = this._renderCount % 2 == 0;
                if (M.renderSlow = !r, (r || s) && (Qt.I._update(), M.loopCount++, this.renderingEnabled)) {
                    for (var a = 0, o = this._scene3Ds.length; a < o; a++) this._scene3Ds[a]._update();
                    t.clear(), h.prototype.render.call(this, t, e, i), M._show && M._sp && M._sp.render(t, e, i)
                }
                l._dbgSprite.render(t, 0, 0), !r && s || (this.renderingEnabled && (ce.clear(this._bgColor), t.flush(), I.instance && I.getInstance().endDispose()), this._updateTimers())
            }, t.renderToNative = function (t, e, i) {
                if (this._renderCount++, this._visible) {
                    if (Qt.I._update(), M.loopCount++, this.renderingEnabled) {
                        for (var n = 0, r = this._scene3Ds.length; n < r; n++) this._scene3Ds[n]._update();
                        t.clear(), h.prototype.render.call(this, t, e, i), M._show && M._sp && M._sp.render(t, e, i)
                    }
                    this.renderingEnabled && (ce.clear(this._bgColor), t.flush(), I.instance && I.getInstance().endDispose()), this._updateTimers()
                } else this._renderCount % 5 == 0 && (Qt.I._update(), M.loopCount++, this._updateTimers())
            }, t._updateTimers = function () {
                y.systemTimer._update(), y.startTimer._update(), y.physicsTimer._update(), y.updateTimer._update(), y.lateTimer._update(), y.timer._update()
            }, t._requestFullscreen = function () {
                var t = Lt.document.documentElement;
                t.requestFullscreen ? t.requestFullscreen() : t.mozRequestFullScreen ? t.mozRequestFullScreen() : t.webkitRequestFullscreen ? t.webkitRequestFullscreen() : t.msRequestFullscreen && t.msRequestFullscreen()
            }, t._fullScreenChanged = function () {
                y.stage.event("fullscreenchange")
            }, t.exitFullscreen = function () {
                var t = Lt.document;
                t.exitFullscreen ? t.exitFullscreen() : t.mozCancelFullScreen ? t.mozCancelFullScreen() : t.webkitExitFullscreen && t.webkitExitFullscreen()
            }, t.isGlobalRepaint = function () {
                return this._globalRepaintGet
            }, t.setGlobalRepaint = function () {
                this._globalRepaintSet = !0
            }, t.add3DUI = function (t) {
                var e = t.rootView;
                0 <= this._3dUI.indexOf(e) || this._3dUI.push(e)
            }, t.remove3DUI = function (t) {
                var e = t.rootView, i = this._3dUI.indexOf(e);
                return 0 <= i && (this._3dUI.splice(i, 1), !0)
            }, d(0, t, "clientScaleY", function () {
                return this._transform ? this._transform.getScaleY() : 1
            }), d(0, t, "width", h.prototype._$get_width, function (t) {
                this.designWidth = t, y.superSet(je, this, "width", t), y.systemTimer.callLater(this, this._changeCanvasSize)
            }), d(0, t, "isFocused", function () {
                return this._isFocused
            }), d(0, t, "alignH", function () {
                return this._alignH
            }, function (t) {
                this._alignH = t, y.systemTimer.callLater(this, this._changeCanvasSize)
            }), d(0, t, "height", h.prototype._$get_height, function (t) {
                this.designHeight = t, y.superSet(je, this, "height", t), y.systemTimer.callLater(this, this._changeCanvasSize)
            }), d(0, t, "transform", function () {
                return this._tfChanged && this._adjustTransform(), this._transform = this._transform || this._createTransform()
            }, h.prototype._$set_transform), d(0, t, "isVisibility", function () {
                return this._isVisibility
            }), d(0, t, "scaleMode", function () {
                return this._scaleMode
            }, function (t) {
                this._scaleMode = t, y.systemTimer.callLater(this, this._changeCanvasSize)
            }), d(0, t, "alignV", function () {
                return this._alignV
            }, function (t) {
                this._alignV = t, y.systemTimer.callLater(this, this._changeCanvasSize)
            }), d(0, t, "bgColor", function () {
                return this._bgColor
            }, function (t) {
                this._bgColor = t, this._wgColor = t ? p.create(t).arrColor : null, Lt.onLimixiu ? this._wgColor = p.create(t).arrColor : Rt.canvas.style.background = t || "none"
            }), d(0, t, "mouseX", function () {
                return Math.round(R.instance.mouseX / this.clientScaleX)
            }), d(0, t, "mouseY", function () {
                return Math.round(R.instance.mouseY / this.clientScaleY)
            }), d(0, t, "clientScaleX", function () {
                return this._transform ? this._transform.getScaleX() : 1
            }), d(0, t, "screenMode", function () {
                return this._screenMode
            }, function (t) {
                this._screenMode = t
            }), d(0, t, "visible", h.prototype._$get_visible, function (t) {
                this.visible !== t && (y.superSet(je, this, "visible", t), Rt._mainCanvas.source.style.visibility = t ? "visible" : "hidden")
            }), d(0, t, "fullScreenEnabled", null, function (t) {
                var e = Lt.document, i = Rt.canvas;
                t ? (i.addEventListener("mousedown", this._requestFullscreen), i.addEventListener("touchstart", this._requestFullscreen), e.addEventListener("fullscreenchange", this._fullScreenChanged), e.addEventListener("mozfullscreenchange", this._fullScreenChanged), e.addEventListener("webkitfullscreenchange", this._fullScreenChanged), e.addEventListener("msfullscreenchange", this._fullScreenChanged)) : (i.removeEventListener("mousedown", this._requestFullscreen), i.removeEventListener("touchstart", this._requestFullscreen), e.removeEventListener("fullscreenchange", this._fullScreenChanged), e.removeEventListener("mozfullscreenchange", this._fullScreenChanged), e.removeEventListener("webkitfullscreenchange", this._fullScreenChanged), e.removeEventListener("msfullscreenchange", this._fullScreenChanged))
            }), d(0, t, "frameRate", function () {
                return Rt.isConchApp ? this._frameRateNative : this._frameRate
            }, function (t) {
                if (Rt.isConchApp) {
                    switch (t) {
                        case"fast":
                            m.conch.config.setLimitFPS(60);
                            break;
                        case"mouse":
                            m.conch.config.setMouseFrame(2e3);
                            break;
                        case"slow":
                            m.conch.config.setSlowFrame(!0);
                            break;
                        case"sleep":
                            m.conch.config.setLimitFPS(1)
                    }
                    this._frameRateNative = t
                } else this._frameRate = t
            }), l.SCALE_NOSCALE = "noscale", l.SCALE_EXACTFIT = "exactfit", l.SCALE_SHOWALL = "showall", l.SCALE_NOBORDER = "noborder", l.SCALE_FULL = "full", l.SCALE_FIXED_WIDTH = "fixedwidth", l.SCALE_FIXED_HEIGHT = "fixedheight", l.SCALE_FIXED_AUTO = "fixedauto", l.ALIGN_LEFT = "left", l.ALIGN_RIGHT = "right", l.ALIGN_CENTER = "center", l.ALIGN_TOP = "top", l.ALIGN_MIDDLE = "middle", l.ALIGN_BOTTOM = "bottom", l.SCREEN_NONE = "none", l.SCREEN_HORIZONTAL = "horizontal", l.SCREEN_VERTICAL = "vertical", l.FRAME_FAST = "fast", l.FRAME_SLOW = "slow", l.FRAME_MOUSE = "mouse", l.FRAME_SLEEP = "sleep", a(l, ["_dbgSprite", function () {
                return this._dbgSprite = new je
            }]), l
        }(je)), oi = function (t) {
            function f() {
                this.datas = [], this.hud_width = 800, this.hud_height = 200, this.gMinV = 0, this.gMaxV = 100, this.textSpace = 40, this._now = null, this.sttm = 0, f.__super.call(this), this.xdata = new Array(f.DATANUM), this.ydata = new Array(f.DATANUM), (f.inst = this)._renderType |= 2048, this._setRenderType(this._renderType), this._setCustomRender(), this.addDataDef(0, 16777215, "frame", 1), this.addDataDef(1, 65280, "update", 1), this.addDataDef(2, 16711680, "flush", 1), this._now = performance ? performance.now.bind(performance) : Date.now
            }

            x(f, "laya.utils.PerfHUD", je);
            var e = f.prototype;
            return e.now = function () {
                return this._now()
            }, e.start = function () {
                this.sttm = this._now()
            }, e.end = function (t) {
                var e = this._now() - this.sttm;
                this.updateValue(t, e)
            }, e.config = function (t, e) {
                this.hud_width = t, this.hud_height = e
            }, e.addDataDef = function (t, e, i, n) {
                this.datas[t] = new ot(t, e, i, n)
            }, e.updateValue = function (t, e) {
                this.datas[t].addData(e)
            }, e.v2y = function (t) {
                this._y, this.hud_height, this.gMinV, this.gMaxV;
                return this._y + this.hud_height * (1 - (t - this.gMinV) / this.gMaxV)
            }, e.drawHLine = function (t, e, i, n) {
                var r = this._x, s = (this._x, this.hud_width, this.v2y(e));
                t.fillText(n, r, s - 6, null, "green", null), r += this.textSpace, t.fillStyle = i, t.fillRect(r, s, this._x + this.hud_width, 1, null)
            }, e.customRender = function (t, e, i) {
                var n = performance.now();
                f._lastTm <= 0 && (f._lastTm = n), this.updateValue(0, n - f._lastTm), f._lastTm = n, t.save(), t.fillRect(this._x, this._y, this.hud_width, this.hud_height + 4, "#000000cc"), t.globalAlpha = .9, this.drawHLine(t, 0, "green", "    0"), this.drawHLine(t, 10, "green", "  10"), this.drawHLine(t, 16.667, "red", " "), this.drawHLine(t, 20, "green", "50|20"), this.drawHLine(t, 33.334, "yellow", ""), this.drawHLine(t, 16.667 * 3, "yellow", ""), this.drawHLine(t, 66.668, "yellow", ""), this.drawHLine(t, 50, "green", "20|50"), this.drawHLine(t, 100, "green", "10|100");
                for (var r = 0, s = this.datas.length; r < s; r++) {
                    var a = this.datas[r];
                    if (a) {
                        var o = a.datas.length, h = (this.hud_width - this.textSpace) / o, l = a.datapos,
                            u = this._x + this.textSpace;
                        t.fillStyle = a.color;
                        for (var c = o; l < c; l++) {
                            var _ = this.v2y(a.datas[l] * a.scale);
                            t.fillRect(u, _, h, this.hud_height + this._y - _, null), u += h
                        }
                        for (l = 0; l < a.datapos; l++) _ = this.v2y(a.datas[l] * a.scale), t.fillRect(u, _, h, this.hud_height + this._y - _, null), u += h
                    }
                }
                t.restore()
            }, f._lastTm = 0, f._now = 0, f.DATANUM = 300, f.inst = null, f.drawTexTm = 0, f
        }(), hi = function (n) {
            function h() {
                this.autoDestroyAtClosed = !1, this.url = null, this._timer = null, this._viewCreated = !1, this._idMap = null, this._$componentType = "Scene", h.__super.call(this), this._setBit(8, !0), h.unDestroyedScenes.push(this), (this._scene = this).createChildren()
            }

            x(h, "laya.display.Scene", n);
            var t = h.prototype;
            return t.createChildren = function () {
            }, t.loadScene = function (t) {
                var e = -1 < t.indexOf(".") ? t : t + ".scene", i = y.loader.getRes(e);
                if (i) this.createView(i); else {
                    y.loader.resetProgress();
                    var n = new Ue;
                    n.on("complete", this, this._onSceneLoaded, [e]), n.load(e)
                }
            }, t._onSceneLoaded = function (t) {
                this.createView(De.getRes(t))
            }, t.createView = function (t) {
                t && !this._viewCreated && (this._viewCreated = !0, mt.createByData(this, t))
            }, t.getNodeByID = function (t) {
                return this._idMap ? this._idMap[t] : null
            }, t.open = function (t, e) {
                void 0 === t && (t = !0), t && h.closeAll(), h.root.addChild(this), this.onOpened(e)
            }, t.onOpened = function (t) {
            }, t.close = function (t) {
                this.onClosed(t), this.autoDestroyAtClosed ? this.destroy() : this.removeSelf()
            }, t.onClosed = function (t) {
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this._idMap = null, n.prototype.destroy.call(this, t);
                for (var e = laya.display.Scene.unDestroyedScenes, i = e.length - 1; -1 < i; i--) if (e[i] === this) return void e.splice(i, 1)
            }, t._sizeChanged = function () {
                this.event("resize")
            }, d(0, t, "scaleX", n.prototype._$get_scaleX, function (t) {
                y.superGet(je, this, "scaleX") != t && (y.superSet(je, this, "scaleX", t), this.event("resize"))
            }), d(0, t, "scaleY", n.prototype._$get_scaleY, function (t) {
                y.superGet(je, this, "scaleY") != t && (y.superSet(je, this, "scaleY", t), this.event("resize"))
            }), d(0, t, "width", function () {
                if (this._width) return this._width;
                for (var t = 0, e = this.numChildren - 1; -1 < e; e--) {
                    var i = this.getChildAt(e);
                    i._visible && (t = Math.max(i._x + i.width * i.scaleX, t))
                }
                return t
            }, function (t) {
                y.superGet(je, this, "width") != t && (y.superSet(je, this, "width", t), this.callLater(this._sizeChanged))
            }), d(0, t, "timer", function () {
                return this._timer || y.timer
            }, function (t) {
                this._timer = t
            }), d(0, t, "height", function () {
                if (this._height) return this._height;
                for (var t = 0, e = this.numChildren - 1; -1 < e; e--) {
                    var i = this.getChildAt(e);
                    i._visible && (t = Math.max(i._y + i.height * i.scaleY, t))
                }
                return t
            }, function (t) {
                y.superGet(je, this, "height") != t && (y.superSet(je, this, "height", t), this.callLater(this._sizeChanged))
            }), d(1, h, "root", function () {
                if (!h._root) {
                    function t() {
                        h._root.size(y.stage.width, y.stage.height), h._root.event("resize")
                    }

                    (h._root = y.stage.addChild(new je)).name = "root", y.stage.on("resize", null, t), t()
                }
                return h._root
            }, laya.display.Sprite._$SET_root), h.load = function (r, s, e) {
                y.loader.resetProgress();
                var a = new Ue;

                function o(t) {
                    h._loadPage && h._loadPage.event("progress", t), e && e.runWith(t)
                }

                a.on("progress", null, o), a.once("complete", null, function () {
                    a.off("progress", null, o);
                    var t = De.getRes(r);
                    if (!t) throw"Can not find scene:" + r;
                    if (!t.props) throw"Scene data is error:" + r;
                    var e = t.props.runtime ? t.props.runtime : t.type, i = It.getClass(e);
                    if ("instance" == t.props.renderType) var n = i.instance || (i.instance = new i); else n = new i;
                    {
                        if (!(n && n instanceof laya.display.Node)) throw"Can not find scene:" + e;
                        n.url = r, n._getBit(8) ? (n.on("onViewCreated", null, function () {
                            s && s.runWith(n)
                        }), n.createView(t)) : s && s.runWith(n), h.hideLoadingPage()
                    }
                }), a.load(r)
            }, h.open = function (t, e, i, n, r) {
                if (void 0 === e && (e = !0), i instanceof laya.utils.Handler) {
                    var s = n;
                    n = i, i = s
                }
                h.showLoadingPage(), h.load(t, b.create(null, this._onSceneLoaded, [e, n, i]), r)
            }, h._onSceneLoaded = function (t, e, i, n) {
                n.open(t, i), e && e.runWith(n)
            }, h.close = function (t, e) {
                void 0 === e && (e = "");
                for (var i = !1, n = laya.display.Scene.unDestroyedScenes, r = 0, s = n.length; r < s; r++) {
                    var a = n[r];
                    a && a.parent && a.url === t && a.name == e && (a.close(), i = !0)
                }
                return i
            }, h.closeAll = function () {
                for (var t = laya.display.Scene.root, e = 0, i = t.numChildren; e < i; e++) {
                    var n = t.getChildAt(0);
                    n instanceof laya.display.Scene ? n.close() : n.removeSelf()
                }
            }, h.destroy = function (t, e) {
                void 0 === e && (e = "");
                for (var i = !1, n = laya.display.Scene.unDestroyedScenes, r = 0, s = n.length; r < s; r++) {
                    var a = n[r];
                    a.url === t && a.name == e && (a.destroy(), i = !0)
                }
                return i
            }, h.gc = function () {
                Me.destroyUnusedResources()
            }, h.setLoadingPage = function (t) {
                h._loadPage != t && (h._loadPage = t)
            }, h.showLoadingPage = function (t, e) {
                void 0 === e && (e = 500), h._loadPage && (y.systemTimer.clear(null, h._showLoading), y.systemTimer.clear(null, h._hideLoading), y.systemTimer.once(e, null, h._showLoading, [t], !1))
            }, h._showLoading = function (t) {
                y.stage.addChild(h._loadPage), h._loadPage.onOpened(t)
            }, h._hideLoading = function () {
                h._loadPage.close()
            }, h.hideLoadingPage = function (t) {
                void 0 === t && (t = 500), h._loadPage && (y.systemTimer.clear(null, h._showLoading), y.systemTimer.clear(null, h._hideLoading), y.systemTimer.once(t, null, h._hideLoading))
            }, h.unDestroyedScenes = [], h._root = null, h._loadPage = null, h
        }(je), li = function (e) {
            function r() {
                this._focus = !1, this._multiline = !1, this._editable = !0, this._restrictPattern = null, this._type = "text", this._prompt = "", this._promptColor = "#A9A9A9", this._originColor = "#000000", this._content = "", r.__super.call(this), this._maxChars = 1e5, this._width = 100, this._height = 20, this.multiline = !1, this.overflow = "scroll", this.on("mousedown", this, this._onMouseDown), this.on("undisplay", this, this._onUnDisplay)
            }

            x(r, "laya.display.Input", e);
            var t = r.prototype;
            return t.setSelection = function (t, e) {
                this.focus = !0, laya.display.Input.inputElement.selectionStart = t, laya.display.Input.inputElement.selectionEnd = e
            }, t._onUnDisplay = function (t) {
                this.focus = !1
            }, t._onMouseDown = function (t) {
                this.focus = !0
            }, t._syncInputTransform = function () {
                var t = this.nativeInput, e = ne.getTransformRelativeToWindow(this, this.padding[3], this.padding[0]),
                    i = this._width - this.padding[1] - this.padding[3],
                    n = this._height - this.padding[0] - this.padding[2];
                Rt.isConchApp ? (t.setScale(e.scaleX, e.scaleY), t.setSize(i, n), t.setPos(e.x, e.y)) : (r.inputContainer.style.transform = r.inputContainer.style.webkitTransform = "scale(" + e.scaleX + "," + e.scaleY + ") rotate(" + y.stage.canvasDegree + "deg)", t.style.width = i + "px", t.style.height = n + "px", r.inputContainer.style.left = e.x + "px", r.inputContainer.style.top = e.y + "px")
            }, t.select = function () {
                this.nativeInput.select()
            }, t._setInputMethod = function () {
                r.input.parentElement && r.inputContainer.removeChild(r.input), r.area.parentElement && r.inputContainer.removeChild(r.area), r.inputElement = this._multiline ? r.area : r.input, r.inputContainer.appendChild(r.inputElement), ei.RightToLeft && (r.inputElement.style.direction = "rtl")
            }, t._focusIn = function () {
                laya.display.Input.isInputting = !0;
                var t = this.nativeInput;
                this._focus = !0;
                var e = t.style;
                e.whiteSpace = this.wordWrap ? "pre-wrap" : "nowrap", this._setPromptColor(), t.readOnly = !this._editable, Rt.isConchApp && (t.setType(this._type), t.setForbidEdit(!this._editable)), t.maxLength = this._maxChars;
                this.padding;
                if (t.type = this._type, t.value = this._content, t.placeholder = this._prompt, y.stage.off("keydown", this, this._onKeyDown), y.stage.on("keydown", this, this._onKeyDown), (y.stage.focus = this).event("focus"), Lt.onPC && t.focus(), !(Lt.onMiniGame || Lt.onBDMiniGame || Lt.onQGMiniGame || Lt.onKGMiniGame || Lt.onVVMiniGame || Lt.onAlipayMiniGame || Lt.onBLMiniGame || Lt.onQQMiniGame)) {
                    this._text;
                    this._text = null
                }
                this.typeset(), t.setColor(this._originColor), t.setFontSize(this.fontSize), t.setFontFace(Lt.onIPhone && ei.fontFamilyMap[this.font] || this.font), Rt.isConchApp && t.setMultiAble && t.setMultiAble(this._multiline), e.lineHeight = this.leading + this.fontSize + "px", e.fontStyle = this.italic ? "italic" : "normal", e.fontWeight = this.bold ? "bold" : "normal", e.textAlign = this.align, e.padding = "0 0", this._syncInputTransform(), !Rt.isConchApp && Lt.onPC && y.systemTimer.frameLoop(1, this, this._syncInputTransform)
            }, t._setPromptColor = function () {
                (r.promptStyleDOM = Lt.getElementById("promptStyle")) || ((r.promptStyleDOM = Lt.createElement("style")).setAttribute("id", "promptStyle"), Lt.document.head.appendChild(r.promptStyleDOM)), r.promptStyleDOM.innerText = "input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:" + this._promptColor + "}input:-moz-placeholder, textarea:-moz-placeholder {color:" + this._promptColor + "}input::-moz-placeholder, textarea::-moz-placeholder {color:" + this._promptColor + "}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:" + this._promptColor + "}"
            }, t._focusOut = function () {
                laya.display.Input.isInputting = !1, this._focus = !1, this._text = null, this._content = this.nativeInput.value, this._content ? (y.superSet(ei, this, "text", this._content), y.superSet(ei, this, "color", this._originColor)) : (y.superSet(ei, this, "text", this._prompt), y.superSet(ei, this, "color", this._promptColor)), y.stage.off("keydown", this, this._onKeyDown), y.stage.focus = null, this.event("blur"), this.event("change"), Rt.isConchApp && this.nativeInput.blur(), Lt.onPC && y.systemTimer.clear(this, this._syncInputTransform)
            }, t._onKeyDown = function (t) {
                13 === t.keyCode && (Lt.onMobile && !this._multiline && (this.focus = !1), this.event("enter"))
            }, t.changeText = function (t) {
                this._content = t, this._focus ? (this.nativeInput.value = t || "", this.event("change")) : e.prototype.changeText.call(this, t)
            }, d(0, t, "color", e.prototype._$get_color, function (t) {
                this._focus && this.nativeInput.setColor(t), y.superSet(ei, this, "color", this._content ? t : this._promptColor), this._originColor = t
            }), d(0, t, "multiline", function () {
                return this._multiline
            }, function (t) {
                this._multiline = t, this.valign = t ? "top" : "middle"
            }), d(0, t, "maxChars", function () {
                return this._maxChars
            }, function (t) {
                t <= 0 && (t = 1e5), this._maxChars = t
            }), d(0, t, "text", function () {
                return this._focus ? this.nativeInput.value : this._content || ""
            }, function (t) {
                y.superSet(ei, this, "color", this._originColor), t += "", this._focus ? (this.nativeInput.value = t || "", this.event("change")) : (this._multiline || (t = t.replace(/\r?\n/g, "")), (this._content = t) ? y.superSet(ei, this, "text", t) : (y.superSet(ei, this, "text", this._prompt), y.superSet(ei, this, "color", this.promptColor)))
            }), d(0, t, "nativeInput", function () {
                return this._multiline ? r.area : r.input
            }), d(0, t, "focus", function () {
                return this._focus
            }, function (t) {
                var e = this.nativeInput;
                this._focus !== t && (t ? (e.target ? e.target._focusOut() : this._setInputMethod(), (e.target = this)._focusIn()) : (e.target = null, this._focusOut(), Lt.document.body.scrollTop = 0, e.blur(), Rt.isConchApp ? e.setPos(-1e4, -1e4) : r.inputContainer.contains(e) && r.inputContainer.removeChild(e)))
            }), d(0, t, "editable", function () {
                return this._editable
            }, function (t) {
                this._editable = t, Rt.isConchApp && r.input.setForbidEdit(!t)
            }), d(0, t, "bgColor", e.prototype._$get_bgColor, function (t) {
                y.superSet(ei, this, "bgColor", t), Rt.isConchApp && this.nativeInput.setBgColor(t)
            }), d(0, t, "restrict", function () {
                return this._restrictPattern ? this._restrictPattern.source : ""
            }, function (t) {
                this._restrictPattern = t ? (-1 < (t = "[^" + t + "]").indexOf("^^") && (t = t.replace("^^", "")), new RegExp(t, "g")) : null
            }), d(0, t, "prompt", function () {
                return this._prompt
            }, function (t) {
                !this._text && t && y.superSet(ei, this, "color", this._promptColor), this.promptColor = this._promptColor, this._text ? y.superSet(ei, this, "text", this._text == this._prompt ? t : this._text) : y.superSet(ei, this, "text", t), this._prompt = ei.langPacks && ei.langPacks[t] ? ei.langPacks[t] : t
            }), d(0, t, "promptColor", function () {
                return this._promptColor
            }, function (t) {
                this._promptColor = t, this._content || y.superSet(ei, this, "color", t)
            }), d(0, t, "type", function () {
                return this._type
            }, function (t) {
                this._getTextStyle().asPassword = "password" === t, this._type = t
            }), r.__init__ = function () {
                if (r._createInputElement(), Lt.onMobile) {
                    var t = !1;
                    (Lt.onMiniGame || Lt.onBDMiniGame || Lt.onQGMiniGame || Lt.onKGMiniGame || Lt.onVVMiniGame || Lt.onAlipayMiniGame || Lt.onBLMiniGame || Lt.onQQMiniGame) && (t = !0), Rt.canvas.addEventListener(r.IOS_IFRAME ? t ? "touchend" : "click" : "touchend", r._popupInputMethod)
                }
            }, r._popupInputMethod = function (t) {
                laya.display.Input.isInputting && laya.display.Input.inputElement.focus()
            }, r._createInputElement = function () {
                r._initInput(r.area = Lt.createElement("textarea")), r._initInput(r.input = Lt.createElement("input")), (r.inputContainer = Lt.createElement("div")).style.position = "absolute", r.inputContainer.style.zIndex = 1e5, Lt.container.appendChild(r.inputContainer), r.inputContainer.setPos = function (t, e) {
                    r.inputContainer.style.left = t + "px", r.inputContainer.style.top = e + "px"
                }
            }, r._initInput = function (e) {
                var t = e.style;
                t.cssText = "position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;", t.resize = "none", t.backgroundColor = "transparent", t.border = "none", t.outline = "none", t.zIndex = 1, e.addEventListener("input", r._processInputting), e.addEventListener("mousemove", r._stopEvent), e.addEventListener("mousedown", r._stopEvent), e.addEventListener("touchmove", r._stopEvent), e.setFontFace = function (t) {
                    e.style.fontFamily = t
                }, Rt.isConchApp || (e.setColor = function (t) {
                    e.style.color = t
                }, e.setFontSize = function (t) {
                    e.style.fontSize = t + "px"
                })
            }, r._processInputting = function (t) {
                var e = laya.display.Input.inputElement.target;
                if (e) {
                    var i = laya.display.Input.inputElement.value;
                    e._restrictPattern && (i = i.replace(/\u2006|\x27/g, ""), e._restrictPattern.test(i) && (i = i.replace(e._restrictPattern, ""), laya.display.Input.inputElement.value = i)), e._text = i, e.event("input")
                }
            }, r._stopEvent = function (t) {
                "touchmove" == t.type && t.preventDefault(), t.stopPropagation && t.stopPropagation()
            }, r.TYPE_TEXT = "text", r.TYPE_PASSWORD = "password", r.TYPE_EMAIL = "email", r.TYPE_URL = "url", r.TYPE_NUMBER = "number", r.TYPE_RANGE = "range", r.TYPE_DATE = "date", r.TYPE_MONTH = "month", r.TYPE_WEEK = "week", r.TYPE_TIME = "time", r.TYPE_DATE_TIME = "datetime", r.TYPE_DATE_TIME_LOCAL = "datetime-local", r.TYPE_SEARCH = "search", r.input = null, r.area = null, r.inputElement = null, r.inputContainer = null, r.confirmButton = null, r.promptStyleDOM = null, r.inputHeight = 45, r.isInputting = !1, r.stageMatrix = null, a(r, ["IOS_IFRAME", function () {
                return this.IOS_IFRAME = Lt.onIOS && Lt.window.top != Lt.window.self
            }]), r
        }(ei), ui = (function (n) {
            function c() {
                this._frames = null, this._url = null, c.__super.call(this), this._setControlNode(this)
            }

            x(c, "laya.display.Animation", n);
            var t = c.prototype;
            t.destroy = function (t) {
                void 0 === t && (t = !0), this.stop(), laya.display.Sprite.prototype.destroy.call(this, t), this._frames = null, this._labels = null
            }, t.play = function (t, e, i) {
                void 0 === t && (t = 0), void 0 === e && (e = !0), void 0 === i && (i = ""), i && this._setFramesFromCache(i, !0), n.prototype.play.call(this, t, e, i)
            }, t._setFramesFromCache = function (t, e) {
                if (void 0 === e && (e = !1), this._url && (t = this._url + "#" + t), t && c.framesMap[t]) {
                    var i = c.framesMap[t];
                    return i instanceof Array ? (this._frames = c.framesMap[t], this._count = this._frames.length) : (i.nodeRoot && (c.framesMap[t] = di.parseAnimationByData(i), i = c.framesMap[t]), this._frames = i.frames, this._count = this._frames.length, this._frameRateChanged || (this._interval = i.interval), this._labels = this._copyLabels(i.labels)), !0
                }
                return !1
            }, t._copyLabels = function (t) {
                if (!t) return null;
                var e, i;
                for (i in e = {}, t) e[i] = ne.copyArray([], t[i]);
                return e
            }, t._frameLoop = function () {
                this._visible && .01 < this._style.alpha && this._frames && n.prototype._frameLoop.call(this)
            }, t._displayToIndex = function (t) {
                this._frames && (this.graphics = this._frames[t])
            }, t.clear = function () {
                return n.prototype.clear.call(this), this.stop(), this.graphics = null, this._frames = null, this._labels = null, this
            }, t.loadImages = function (t, e) {
                return void 0 === e && (e = ""), this._url = "", this._setFramesFromCache(e) || (this.frames = c.framesMap[e] ? c.framesMap[e] : c.createFrames(t, e)), this
            }, t.loadAtlas = function (e, i, n) {
                void 0 === n && (n = ""), this._url = "";
                var r = this;
                if (!r._setFramesFromCache(n)) {
                    function t(t) {
                        e === t && (r.frames = c.framesMap[n] ? c.framesMap[n] : c.createFrames(e, n), i && i.run())
                    }

                    De.getAtlas(e) ? t(e) : y.loader.load(e, b.create(null, t, [e]), null, "atlas")
                }
                return this
            }, t.loadAnimation = function (t, e, i) {
                this._url = t;
                return this._actionName || (this._actionName = ""), this._setFramesFromCache(this._actionName) ? (this._setFramesFromCache(this._actionName, !0), this.index = 0, e && e.run()) : !i || De.getAtlas(i) ? this._loadAnimationData(t, e, i) : y.loader.load(i, b.create(this, this._loadAnimationData, [t, e, i]), null, "atlas"), this
            }, t._loadAnimationData = function (o, h, t) {
                var l = this;
                if (!t || De.getAtlas(t)) {
                    var u = this;
                    De.getRes(o) ? e(o) : y.loader.load(o, b.create(null, e, [o]), null, "json")
                }

                function e(t) {
                    if (De.getRes(t)) {
                        if (o === t) {
                            var e;
                            if (c.framesMap[o + "#"]) u._setFramesFromCache(l._actionName, !0), l.index = 0, l._resumePlay(); else {
                                var i = di.parseAnimationData(De.getRes(o));
                                if (!i) return;
                                var n, r = i.animationList, s = 0, a = r.length;
                                for (s = 0; s < a; s++) e = r[s], c.framesMap[o + "#" + e.name] = e, n || (n = e);
                                n && (c.framesMap[o + "#"] = n, u._setFramesFromCache(l._actionName, !0), l.index = 0), l._resumePlay()
                            }
                            h && h.run()
                        }
                        De.clearRes(o)
                    } else c.framesMap[o + "#"] && (u._setFramesFromCache(l._actionName, !0), l.index = 0, l._resumePlay(), h && h.run())
                }
            }, d(0, t, "frames", function () {
                return this._frames
            }, function (t) {
                (this._frames = t) && (this._count = t.length, this._actionName && this._setFramesFromCache(this._actionName, !0), this.index = this._index)
            }), d(0, t, "autoPlay", null, function (t) {
                t ? this.play() : this.stop()
            }), d(0, t, "source", null, function (t) {
                -1 < t.indexOf(".ani") ? this.loadAnimation(t) : -1 < t.indexOf(".json") || -1 < t.indexOf("als") || -1 < t.indexOf("atlas") ? this.loadAtlas(t) : this.loadImages(t.split(","))
            }), d(0, t, "autoAnimation", null, function (t) {
                this.play(0, !0, t)
            }), c.createFrames = function (t, e) {
                var i;
                if ("string" == typeof t) {
                    var n = De.getAtlas(t);
                    if (n && n.length) {
                        i = [];
                        for (var r = 0, s = n.length; r < s; r++) {
                            var a = new qt;
                            a.drawImage(De.getRes(n[r]), 0, 0), i.push(a)
                        }
                    }
                } else if (t instanceof Array) for (i = [], r = 0, s = t.length; r < s; r++) (a = new qt).loadImage(t[r], 0, 0), i.push(a);
                return e && (c.framesMap[e] = i), i
            }, c.clearCache = function (t) {
                var e, i = c.framesMap, n = t + "#";
                for (e in i) e !== t && 0 !== e.indexOf(n) || delete c.framesMap[e]
            }, c.framesMap = {}
        }(ii), function (t) {
            function s(t, e, i, n, r) {
                this._params2dQuick2 = null, this._shaderValueWidth = 0, this._shaderValueHeight = 0, s.__super.call(this, t, e, i, n, r)
            }

            x(s, "laya.webgl.shader.d2.Shader2X", t);
            var e = s.prototype;
            return e._disposeResource = function () {
                t.prototype._disposeResource.call(this), this._params2dQuick2 = null
            }, e.upload2dQuick2 = function (t) {
                this.upload(t, this._params2dQuick2 || this._make2dQuick2())
            }, e._make2dQuick2 = function () {
                if (!this._params2dQuick2) {
                    this._params2dQuick2 = [];
                    for (var t, e = this._params, i = 0, n = e.length; i < n; i++) "size" !== (t = e[i]).name && this._params2dQuick2.push(t)
                }
                return this._params2dQuick2
            }, s.create = function (t, e, i, n, r) {
                return new s(t, e, i, n, r)
            }, s
        }(ni)), ci = function (t) {
            function l() {
                this._targetDic = null, this._animationData = null, this._usedFrames = null, l.__super.call(this), null === l._sortIndexFun && (l._sortIndexFun = i.sortByKey("index", !1, !0))
            }

            x(l, "laya.display.FrameAnimation", t);
            var e = l.prototype;
            return e._setUp = function (t, e) {
                this._targetDic = t, this._animationData = e, this.interval = 1e3 / e.frameRate, e.parsed ? (this._count = e.count, this._labels = e.labels, this._usedFrames = e.animationNewFrames) : (this._usedFrames = [], this._calculateDatas(), e.parsed = !0, e.labels = this._labels, e.count = this._count, e.animationNewFrames = this._usedFrames)
            }, e.clear = function () {
                return t.prototype.clear.call(this), this._targetDic = null, this._animationData = null, this
            }, e._displayToIndex = function (t) {
                if (this._animationData) {
                    t < 0 && (t = 0), t > this._count && (t = this._count);
                    var e = this._animationData.nodes, i = 0, n = e.length;
                    for (i = 0; i < n; i++) this._displayNodeToFrame(e[i], t)
                }
            }, e._displayNodeToFrame = function (t, e, i) {
                i || (i = this._targetDic);
                var n = i[t.target];
                if (n) {
                    var r, s, a, o = t.frames, h = t.keys, l = 0, u = h.length;
                    for (l = 0; l < u; l++) a = (s = o[r = h[l]]).length > e ? s[e] : s[s.length - 1], n[r] = a;
                    var c, _ = t.funkeys;
                    if (0 != (u = _.length)) for (l = 0; l < u; l++) void 0 !== (c = o[r = _[l]])[e] && n[r] && n[r].apply(n, c[e])
                }
            }, e._calculateDatas = function () {
                if (this._animationData) {
                    var t, e = this._animationData.nodes, i = 0, n = e.length;
                    for (i = this._count = 0; i < n; i++) t = e[i], this._calculateKeyFrames(t);
                    this._count += 1
                }
            }, e._calculateKeyFrames = function (t) {
                var e, i, n = t.keyframes, r = t.target;
                for (e in t.frames || (t.frames = {}), t.keys ? t.keys.length = 0 : t.keys = [], t.funkeys ? t.funkeys.length = 0 : t.funkeys = [], t.initValues || (t.initValues = {}), n) {
                    var s = -1 != e.indexOf("()");
                    if (i = n[e], s && (e = e.substr(0, e.length - 2)), t.frames[e] || (t.frames[e] = []), s) {
                        t.funkeys.push(e);
                        for (var a = t.frames[e], o = 0; o < i.length; o++) {
                            var h = i[o];
                            a[h.index] = h.value, h.index > this._count && (this._count = h.index)
                        }
                    } else this._targetDic && this._targetDic[r] && (t.initValues[e] = this._targetDic[r][e]), i.sort(l._sortIndexFun), t.keys.push(e), this._calculateNodePropFrames(i, t.frames[e], e, r)
                }
            }, e.resetNodes = function () {
                if (this._targetDic && this._animationData) {
                    var t, e, i = this._animationData.nodes, n = 0, r = i.length;
                    for (n = 0; n < r; n++) if (e = (t = i[n]).initValues) {
                        var s, a = this._targetDic[t.target];
                        if (a) for (s in e) a[s] = e[s]
                    }
                }
            }, e._calculateNodePropFrames = function (t, e, i, n) {
                var r = 0, s = t.length - 1;
                for (e.length = t[s].index + 1, r = 0; r < s; r++) this._dealKeyFrame(t[r]), this._calculateFrameValues(t[r], t[r + 1], e);
                0 == s && (e[0] = t[0].value, this._usedFrames && (this._usedFrames[t[0].index] = !0)), this._dealKeyFrame(t[r])
            }, e._dealKeyFrame = function (t) {
                t.label && "" != t.label && this.addLabel(t.label, t.index)
            }, e._calculateFrameValues = function (t, e, i) {
                var n, r = 0, s = t.index, a = e.index, o = t.value, h = e.value - t.value, l = a - s,
                    u = this._usedFrames;
                if (a > this._count && (this._count = a), t.tween) for (null == (n = ee[t.tweenMethod]) && (n = ee.linearNone), r = s; r < a; r++) i[r] = n(r - s, o, h, l), u && (u[r] = !0); else for (r = s; r < a; r++) i[r] = o;
                u && (u[t.index] = !0, u[e.index] = !0), i[e.index] = e.value
            }, l._sortIndexFun = null, l
        }(ii), _i = function (t) {
            function a(t, e, i, n, r) {
                if (void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 1), void 0 === n && (n = !0), void 0 === r && (r = !1), a.__super.call(this, i, n), this._glTextureType = 3553, this._width = t, this._height = e, this._canRead = r, this._setWarpMode(10242, this._wrapModeU), this._setWarpMode(10243, this._wrapModeV), this._setFilterMode(this._filterMode), this._setAnisotropy(this._anisoLevel), this._mipmap) {
                    this._mipmapCount = Math.max(Math.ceil(Math.log2(t)) + 1, Math.ceil(Math.log2(2)) + 1);
                    for (var s = 0; s < this._mipmapCount; s++) this._setPixels(null, s, Math.max(t >> s, 1), Math.max(e >> s, 1));
                    this._setGPUMemory(t * e * 4 * (1 + 1 / 3))
                } else this._mipmapCount = 1, this._setGPUMemory(t * e * 4)
            }

            x(a, "laya.resource.Texture2D", ri);
            var e = a.prototype;
            return e._getFormatByteCount = function () {
                switch (this._format) {
                    case 0:
                        return 3;
                    case 1:
                        return 4;
                    case 2:
                        return 1;
                    default:
                        throw"Texture2D: unknown format."
                }
            }, e._setPixels = function (t, e, i, n) {
                var r = Dt.instance, s = this._glTextureType, a = this._getGLFormat();
                rt.bindTexture(r, s, this._glTexture), 0 === this.format ? (r.pixelStorei(3317, 1), r.texImage2D(s, e, a, i, n, 0, a, 5121, t), r.pixelStorei(3317, 4)) : r.texImage2D(s, e, a, i, n, 0, a, 5121, t)
            }, e._calcualatesCompressedDataSize = function (t, e, i) {
                switch (t) {
                    case 3:
                    case 5:
                        return (e + 3 >> 2) * (i + 3 >> 2) * 8;
                    case 4:
                        return (e + 3 >> 2) * (i + 3 >> 2) * 16;
                    case 11:
                    case 12:
                        return Math.floor((Math.max(e, 8) * Math.max(i, 8) * 4 + 7) / 8);
                    case 9:
                    case 10:
                        return Math.floor((Math.max(e, 16) * Math.max(i, 8) * 2 + 7) / 8);
                    default:
                        return 0
                }
            }, e._pharseDDS = function (t) {
                var e = new Int32Array(t, 0, 31);
                if (542327876 != e[0]) throw"Invalid magic number in DDS header";
                if (!(4 & e[20])) throw"Unsupported format, must contain a FourCC code";
                var i = e[21];
                switch (this._format) {
                    case 3:
                        if (827611204 !== i) throw"the FourCC code is not same with texture format.";
                        break;
                    case 4:
                        if (894720068 !== i) throw"the FourCC code is not same with texture format.";
                        break;
                    default:
                        throw"unknown texture format."
                }
                var n = 1;
                if (131072 & e[2]) {
                    if (n = Math.max(1, e[7]), !this._mipmap) throw"the mipmap is not same with Texture2D."
                } else if (this._mipmap) throw"the mipmap is not same with Texture2D.";
                var r = e[4], s = e[3];
                this._width = r, this._height = s;
                var a = e[1] + 4;
                this._upLoadCompressedTexImage2D(t, r, s, n, a, 0)
            }, e._pharseKTX = function (t) {
                var e = new Uint8Array(t, 0, 12);
                if (171 != e[0] || 75 != e[1] || 84 != e[2] || 88 != e[3] || 32 != e[4] || 49 != e[5] || 49 != e[6] || 187 != e[7] || 13 != e[8] || 10 != e[9] || 26 != e[10] || 10 != e[11]) throw"Invalid fileIdentifier in KTX header";
                var i = new Int32Array(e.buffer, e.length, 13);
                switch (i[4]) {
                    case rt._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL:
                        this._format = 5;
                        break;
                    default:
                        throw"unknown texture format."
                }
                var n = i[11], r = i[6], s = i[7];
                this._width = r, this._height = s;
                var a = 64 + i[12];
                this._upLoadCompressedTexImage2D(t, r, s, n, a, 4)
            }, e._pharsePVR = function (t) {
                var e = new Int32Array(t, 0, 13);
                if (55727696 != e[0]) throw"Invalid magic number in PVR header";
                switch (e[2]) {
                    case 0:
                        this._format = 9;
                        break;
                    case 2:
                        this._format = 11;
                        break;
                    case 1:
                        this._format = 10;
                        break;
                    case 3:
                        this._format = 12;
                        break;
                    default:
                        throw"Texture2D:unknown PVR format."
                }
                var i = e[11], n = e[7], r = e[6];
                this._width = n, this._height = r;
                var s = e[12] + 52;
                this._upLoadCompressedTexImage2D(t, n, r, i, s, 0)
            }, e._upLoadCompressedTexImage2D = function (t, e, i, n, r, s) {
                var a = Dt.instance, o = this._glTextureType;
                rt.bindTexture(a, o, this._glTexture);
                for (var h = this._getGLFormat(), l = r, u = 0; u < n; u++) {
                    l += s;
                    var c = this._calcualatesCompressedDataSize(this._format, e, i), _ = new Uint8Array(t, l, c);
                    a.compressedTexImage2D(o, u, h, e, i, 0, _), e = Math.max(e >> 1, 1), i = Math.max(i >> 1, 1), l += c
                }
                var f = l;
                this._setGPUMemory(f), this._readyed = !0, this._activeResource()
            }, e.loadImageSource = function (t, e) {
                void 0 === e && (e = !1);
                var i = t.width, n = t.height;
                this._width = i, this._height = n, this._isPot(i) && this._isPot(n) || (this._mipmap = !1), this._setWarpMode(10242, this._wrapModeU), this._setWarpMode(10243, this._wrapModeV), this._setFilterMode(this._filterMode);
                var r = Dt.instance;
                rt.bindTexture(r, this._glTextureType, this._glTexture);
                var s = this._getGLFormat();
                Rt.isConchApp ? (t instanceof laya.resource.HTMLCanvas || t.setPremultiplyAlpha(e), r.texImage2D(this._glTextureType, 0, 6408, 6408, 5121, t)) : (e && r.pixelStorei(37441, !0), r.texImage2D(this._glTextureType, 0, s, s, 5121, t), e && r.pixelStorei(37441, !1)), this._mipmap ? (r.generateMipmap(this._glTextureType), this._setGPUMemory(i * n * 4 * (1 + 1 / 3))) : this._setGPUMemory(i * n * 4), this._canRead && (Rt.isConchApp ? this._pixels = new Uint8Array(t._nativeObj.getImageData(0, 0, i, n)) : (Lt.canvas.size(i, n), Lt.canvas.clear(), Lt.context.drawImage(t, 0, 0, i, n), this._pixels = new Uint8Array(Lt.context.getImageData(0, 0, i, n).data.buffer))), this._readyed = !0, this._activeResource()
            }, e.setPixels = function (t, e) {
                if (void 0 === e && (e = 0), !t) throw"Texture2D:pixels can't be null.";
                var i = Math.max(this._width >> e, 1), n = Math.max(this._height >> e, 1),
                    r = i * n * this._getFormatByteCount();
                if (t.length < r) throw"Texture2D:pixels length should at least " + r + ".";
                this._setPixels(t, e, i, n), this._canRead && (this._pixels = t), this._readyed = !0, this._activeResource()
            }, e.setSubPixels = function (t, e, i, n, r, s) {
                if (void 0 === s && (s = 0), !r) throw"Texture2D:pixels can't be null.";
                var a = Dt.instance, o = this._glTextureType;
                rt.bindTexture(a, o, this._glTexture);
                var h = this._getGLFormat();
                0 === this._format ? (a.pixelStorei(3317, 1), a.texSubImage2D(o, s, t, e, i, n, h, 5121, r), a.pixelStorei(3317, 4)) : a.texSubImage2D(o, s, t, e, i, n, h, 5121, r), this._readyed = !0, this._activeResource()
            }, e.setCompressData = function (t) {
                switch (this._format) {
                    case 3:
                    case 4:
                        this._pharseDDS(t);
                        break;
                    case 5:
                        this._pharseKTX(t);
                        break;
                    case 9:
                    case 10:
                    case 11:
                    case 12:
                        this._pharsePVR(t);
                        break;
                    default:
                        throw"Texture2D:unkonwn format."
                }
            }, e._recoverResource = function () {
            }, e.getPixels = function () {
                if (this._canRead) return this._pixels;
                throw new Error("Texture2D: must set texture canRead is true.")
            }, d(0, e, "mipmapCount", function () {
                return this._mipmapCount
            }), d(0, e, "defaulteTexture", function () {
                return laya.resource.Texture2D.grayTexture
            }), a.__init__ = function () {
                var t = new Uint8Array(3);
                t[0] = 128, t[1] = 128, t[2] = 128, (a.grayTexture = new a(1, 1, 0, !1, !1)).setPixels(t), a.grayTexture.lock = !0, t[0] = 255, t[1] = 255, t[2] = 255, (a.whiteTexture = new a(1, 1, 0, !1, !1)).setPixels(t), a.whiteTexture.lock = !0, t[0] = 0, t[1] = 0, t[2] = 0, (a.blackTexture = new a(1, 1, 0, !1, !1)).setPixels(t), a.blackTexture.lock = !0
            }, a._parse = function (t, e, i) {
                var n = i ? new a(i[0], i[1], i[2], i[3], i[4]) : new a(0, 0);
                switch (e && (n.wrapModeU = e.wrapModeU, n.wrapModeV = e.wrapModeV, n.filterMode = e.filterMode, n.anisoLevel = e.anisoLevel), n._format) {
                    case 0:
                    case 1:
                        n.loadImageSource(t);
                        break;
                    case 3:
                    case 4:
                    case 5:
                    case 9:
                    case 10:
                    case 11:
                    case 12:
                        n.setCompressData(t);
                        break;
                    default:
                        throw"Texture2D:unkonwn format."
                }
                return n
            }, a.load = function (t, e) {
                y.loader.create(t, e, null, "TEXTURE2D")
            }, a.grayTexture = null, a.whiteTexture = null, a.blackTexture = null, a
        }(), fi = function (t) {
            function r(t, e, i, n) {
                void (this._mgrKey = 0) === i && (i = 0), void 0 === n && (n = 0), r.__super.call(this, i, !1), this._glTextureType = 3553, this._width = t, this._height = e, this._depthStencilFormat = n, this._create(t, e), this.lock = !0
            }

            x(r, "laya.resource.RenderTexture2D", ri);
            var e = r.prototype;
            return e.getIsReady = function () {
                return !0
            }, e._create = function (t, e) {
                var i = Dt.instance;
                this._frameBuffer = i.createFramebuffer(), rt.bindTexture(i, this._glTextureType, this._glTexture);
                var n = this._getGLFormat();
                if (i.texImage2D(this._glTextureType, 0, n, t, e, 0, n, 5121, null), this._setGPUMemory(t * e * 4), i.bindFramebuffer(36160, this._frameBuffer), i.framebufferTexture2D(36160, 36064, 3553, this._glTexture, 0), 3 !== this._depthStencilFormat) switch (this._depthStencilBuffer = i.createRenderbuffer(), i.bindRenderbuffer(36161, this._depthStencilBuffer), this._depthStencilFormat) {
                    case 0:
                        i.renderbufferStorage(36161, 33189, t, e), i.framebufferRenderbuffer(36160, 36096, 36161, this._depthStencilBuffer);
                        break;
                    case 1:
                        i.renderbufferStorage(36161, 36168, t, e), i.framebufferRenderbuffer(36160, 36128, 36161, this._depthStencilBuffer);
                        break;
                    case 2:
                        i.renderbufferStorage(36161, 34041, t, e), i.framebufferRenderbuffer(36160, 33306, 36161, this._depthStencilBuffer)
                }
                i.bindFramebuffer(36160, null), i.bindRenderbuffer(36161, null), this._setWarpMode(10242, this._wrapModeU), this._setWarpMode(10243, this._wrapModeV), this._setFilterMode(this._filterMode), this._setAnisotropy(this._anisoLevel), this._readyed = !0, this._activeResource()
            }, e.generateMipmap = function () {
                this._isPot(this.width) && this._isPot(this.height) ? (this._mipmap = !0, Dt.instance.generateMipmap(this._glTextureType), this._setFilterMode(this._filterMode), this._setGPUMemory(this.width * this.height * 4 * (1 + 1 / 3))) : (this._mipmap = !1, this._setGPUMemory(this.width * this.height * 4))
            }, e.start = function () {
                var t = Dt.instance;
                Dt.instance.bindFramebuffer(36160, this._frameBuffer), this._lastRT = r._currentActive, (r._currentActive = this)._readyed = !0, t.viewport(0, 0, this._width, this._height), this._lastWidth = pt.width, this._lastHeight = pt.height, pt.width = this._width, pt.height = this._height, Ke.activeShader = null
            }, e.end = function () {
                Dt.instance.bindFramebuffer(36160, null), r._currentActive = null, this._readyed = !0
            }, e.restore = function () {
                var t = Dt.instance;
                this._lastRT != r._currentActive && (Dt.instance.bindFramebuffer(36160, this._lastRT ? this._lastRT._frameBuffer : null), r._currentActive = this._lastRT), this._readyed = !0, t.viewport(0, 0, this._lastWidth, this._lastHeight), pt.width = this._lastWidth, pt.height = this._lastHeight, Ke.activeShader = null
            }, e.clear = function (t, e, i, n) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 1);
                var r = Dt.instance;
                r.clearColor(t, e, i, n);
                var s = 16384;
                switch (this._depthStencilFormat) {
                    case 33189:
                        s |= 256;
                        break;
                    case 36168:
                        s |= 1024;
                        break;
                    case 34041:
                        s |= 256, s |= 1024
                }
                r.clear(s)
            }, e.getData = function (t, e, i, n) {
                if (Rt.isConchApp && 2 == conchConfig.threadMode) throw"native 2 thread mode use getDataAsync";
                var r = Dt.instance;
                if (r.bindFramebuffer(36160, this._frameBuffer), !(36053 === r.checkFramebufferStatus(36160))) return r.bindFramebuffer(36160, null), null;
                var s = new Uint8Array(this._width * this._height * 4), a = this._getGLFormat();
                return r.readPixels(t, e, i, n, a, 5121, s), r.bindFramebuffer(36160, null), s
            }, e.getDataAsync = function (t, e, i, n, r) {
                var s = Dt.instance;
                s.bindFramebuffer(36160, this._frameBuffer), s.readPixelsAsync(t, e, i, n, 6408, 5121, function (t) {
                    r(new Uint8Array(t))
                }), s.bindFramebuffer(36160, null)
            }, e.recycle = function () {
            }, e._disposeResource = function () {
                if (this._frameBuffer) {
                    var t = Dt.instance;
                    t.deleteTexture(this._glTexture), t.deleteFramebuffer(this._frameBuffer), t.deleteRenderbuffer(this._depthStencilBuffer), this._glTexture = null, this._frameBuffer = null, this._depthStencilBuffer = null, this._setGPUMemory(0)
                }
            }, d(0, e, "depthStencilFormat", function () {
                return this._depthStencilFormat
            }), d(0, e, "defaulteTexture", function () {
                return _i.grayTexture
            }), d(0, e, "sourceWidth", function () {
                return this._width
            }), d(0, e, "sourceHeight", function () {
                return this._height
            }), d(0, e, "offsetX", function () {
                return 0
            }), d(0, e, "offsetY", function () {
                return 0
            }), d(1, r, "currentActive", function () {
                return r._currentActive
            }, laya.resource.BaseTexture._$SET_currentActive), r.pushRT = function () {
                r.rtStack.push({rt: r._currentActive, w: pt.width, h: pt.height})
            }, r.popRT = function () {
                var t = Dt.instance, e = r.rtStack.pop();
                e && (r._currentActive != e.rt && (Dt.instance.bindFramebuffer(36160, e.rt ? e.rt._frameBuffer : null), r._currentActive = e.rt), t.viewport(0, 0, e.w, e.h), pt.width = e.w, pt.height = e.h)
            }, r._currentActive = null, r.rtStack = [], a(r, ["defuv", function () {
                return this.defuv = [0, 0, 1, 0, 1, 1, 0, 1]
            }, "flipyuv", function () {
                return this.flipyuv = [0, 1, 1, 1, 1, 0, 0, 0]
            }]), r
        }(), di = function (e) {
            var E;

            function S() {
                this.animationList = null, this.animationDic = null, this._nodeList = null, this._nodeDefaultProps = null, this._gList = null, this._nodeIDAniDic = {}, this._rootNode = null, this._nodeGDic = null, S.__super.call(this)
            }

            x(S, "laya.utils.GraphicAnimation", e);
            var t = S.prototype;
            return t._parseNodeList = function (t) {
                this._nodeList || (this._nodeList = []), this._nodeDefaultProps[t.compId] = t.props, t.compId && this._nodeList.push(t.compId);
                var e = t.child;
                if (e) {
                    var i = 0, n = e.length;
                    for (i = 0; i < n; i++) this._parseNodeList(e[i])
                }
            }, t._calGraphicData = function (t) {
                var e;
                if (this._setUp(null, t), this._createGraphicData(), this._nodeIDAniDic) for (e in this._nodeIDAniDic) this._nodeIDAniDic[e] = null
            }, t._createGraphicData = function () {
                var t, e = [], i = 0, n = this.count, r = this._usedFrames;
                for (r || (r = []), i = 0; i < n; i++) !r[i] && t || (t = this._createFrameGraphic(i)), e.push(t);
                this._gList = e
            }, t._createFrameGraphic = function (t) {
                var e = new qt;
                return S._rootMatrix || (S._rootMatrix = new at), this._updateNodeGraphic(this._rootNode, t, S._rootMatrix, e), e
            }, t._updateNodeGraphic = function (t, e, i, n, r) {
                var s, a, o;
                void 0 === r && (r = 1), (s = this._nodeGDic[t.compId] = this._getNodeGraphicData(t.compId, e, this._nodeGDic[t.compId])).resultTransform || (s.resultTransform = new at), a = s.resultTransform, at.mul(s.transform, i, a);
                var h = s.alpha * r;
                if (!(h < .01)) {
                    s.skin && (o = this._getTextureByUrl(s.skin)) && (a._checkTransform() ? (n.drawTexture(o, 0, 0, s.width, s.height, a, h), s.resultTransform = null) : n.drawTexture(o, a.tx, a.ty, s.width, s.height, null, h));
                    var l = t.child;
                    if (l) {
                        var u, c = 0;
                        for (u = l.length, c = 0; c < u; c++) this._updateNodeGraphic(l[c], e, a, n, h)
                    }
                }
            }, t._updateNoChilds = function (t, e) {
                if (t.skin) {
                    var i = this._getTextureByUrl(t.skin);
                    if (i) {
                        var n = t.transform;
                        n._checkTransform();
                        !n._bTransform ? e.drawTexture(i, n.tx, n.ty, t.width, t.height, null, t.alpha) : e.drawTexture(i, 0, 0, t.width, t.height, n.clone(), t.alpha)
                    }
                }
            }, t._updateNodeGraphic2 = function (t, e, i) {
                var n;
                if (n = this._nodeGDic[t.compId] = this._getNodeGraphicData(t.compId, e, this._nodeGDic[t.compId]), t.child) {
                    var r = n.transform;
                    r._checkTransform();
                    var s, a;
                    a = (s = !r._bTransform) && (0 != r.tx || 0 != r.ty);
                    var o;
                    (o = r._bTransform || 1 != n.alpha) && i.save(), 1 != n.alpha && i.alpha(n.alpha), s ? a && i.translate(r.tx, r.ty) : i.transform(r.clone());
                    var h, l = t.child;
                    if (n.skin && (h = this._getTextureByUrl(n.skin)) && i.drawImage(h, 0, 0, n.width, n.height), l) {
                        var u, c = 0;
                        for (u = l.length, c = 0; c < u; c++) this._updateNodeGraphic2(l[c], e, i)
                    }
                    o ? i.restore() : s ? a && i.translate(-r.tx, -r.ty) : i.transform(r.clone().invert())
                } else this._updateNoChilds(n, i)
            }, t._calculateKeyFrames = function (t) {
                e.prototype._calculateKeyFrames.call(this, t), this._nodeIDAniDic[t.target] = t
            }, t.getNodeDataByID = function (t) {
                return this._nodeIDAniDic[t]
            }, t._getParams = function (t, e, i, n) {
                var r = S._temParam;
                r.length = e.length;
                var s = 0, a = e.length;
                for (s = 0; s < a; s++) r[s] = this._getObjVar(t, e[s][0], i, e[s][1], n);
                return r
            }, t._getObjVar = function (t, e, i, n, r) {
                if (t.hasOwnProperty(e)) {
                    var s = t[e];
                    return i >= s.length && (i = s.length - 1), t[e][i]
                }
                return r.hasOwnProperty(e) ? r[e] : n
            }, t._getNodeGraphicData = function (t, e, i) {
                i || (i = new E), i.transform ? i.transform.identity() : i.transform = new at;
                var n = this.getNodeDataByID(t);
                if (!n) return i;
                var r, s = n.frames, a = this._getParams(s, S._drawTextureCmd, e, this._nodeDefaultProps[t]), o = a[0],
                    h = NaN, l = NaN, u = a[5], c = a[6], _ = a[13], f = a[14], d = a[7], p = a[8], m = a[9], g = a[11],
                    v = a[12];
                h = a[3], l = a[4], 0 != h && 0 != l || (o = null), -1 == h && (h = 0), -1 == l && (l = 0), i.skin = o, i.width = h, i.height = l, o && (r = this._getTextureByUrl(o)) && (h || (h = r.sourceWidth), l || (l = r.sourceHeight)), i.alpha = a[10];
                var y = i.transform;
                0 != _ && (u = _ * h), 0 != f && (c = f * l), 0 == u && 0 == c || y.translate(-u, -c);
                var x = null;
                if (m || 1 !== d || 1 !== p || g || v) {
                    (x = S._tempMt).identity(), x._bTransform = !0;
                    var T = .0174532922222222 * (m - g), b = .0174532922222222 * (m + v), w = Math.cos(b),
                        C = Math.sin(b), A = Math.sin(T), M = Math.cos(T);
                    x.a = d * w, x.b = d * C, x.c = -p * A, x.d = p * M, x.tx = x.ty = 0
                }
                return x && (y = at.mul(y, x, y)), y.translate(a[1], a[2]), i
            }, t._getTextureByUrl = function (t) {
                return De.getRes(t)
            }, t.setAniData = function (t, e) {
                if (t.animations) {
                    this._nodeDefaultProps = {}, this._nodeGDic = {}, this._nodeList && (this._nodeList.length = 0), this._rootNode = t, this._parseNodeList(t);
                    var i, n = {}, r = [], s = t.animations, a = 0, o = s.length;
                    for (a = 0; a < o; a++) if (i = s[a], this._labels = null, (!e || e == i.name) && i) {
                        try {
                            this._calGraphicData(i)
                        } catch (t) {
                            this._gList = []
                        }
                        var h = {};
                        h.interval = 1e3 / i.frameRate, h.frames = this._gList, h.labels = this._labels, h.name = i.name, r.push(h), n[i.name] = h
                    }
                    this.animationList = r, this.animationDic = n
                }
                S._temParam.length = 0
            }, t.parseByData = function (t) {
                var e, i;
                e = t.nodeRoot, i = t.aniO, delete t.nodeRoot, delete t.aniO, this._nodeDefaultProps = {}, this._nodeGDic = {}, this._nodeList && (this._nodeList.length = 0), this._rootNode = e, this._parseNodeList(e), this._labels = null;
                try {
                    this._calGraphicData(i)
                } catch (t) {
                    this._gList = []
                }
                var n = t;
                return n.interval = 1e3 / i.frameRate, n.frames = this._gList, n.labels = this._labels, n.name = i.name, n
            }, t.setUpAniData = function (t) {
                if (t.animations) {
                    var e, i = {}, n = [], r = t.animations, s = 0, a = r.length;
                    for (s = 0; s < a; s++) if (e = r[s]) {
                        var o = {};
                        o.name = e.name, o.aniO = e, o.nodeRoot = t, n.push(o), i[e.name] = o
                    }
                    this.animationList = n, this.animationDic = i
                }
            }, t._clear = function () {
                this.animationList = null, this.animationDic = null, this._gList = null, this._nodeGDic = null
            }, S.parseAnimationByData = function (t) {
                var e;
                return S._I || (S._I = new S), e = S._I.parseByData(t), S._I._clear(), e
            }, S.parseAnimationData = function (t) {
                var e;
                return S._I || (S._I = new S), S._I.setUpAniData(t), (e = {}).animationList = S._I.animationList, e.animationDic = S._I.animationDic, S._I._clear(), e
            }, S._temParam = [], S._I = null, S._rootMatrix = null, a(S, ["_drawTextureCmd", function () {
                return this._drawTextureCmd = [["skin", null], ["x", 0], ["y", 0], ["width", -1], ["height", -1], ["pivotX", 0], ["pivotY", 0], ["scaleX", 1], ["scaleY", 1], ["rotation", 0], ["alpha", 1], ["skewX", 0], ["skewY", 0], ["anchorX", 0], ["anchorY", 0]]
            }, "_tempMt", function () {
                return this._tempMt = new at
            }]), S.__init$ = function () {
                E = function () {
                    function t() {
                        this.skin = null, this.transform = null, this.resultTransform = null, this.width = NaN, this.height = NaN, this.alpha = 1
                    }

                    return x(t, ""), t
                }()
            }, S
        }(ci);
        !function (s) {
            function t() {
                this._target = null, this._playEvent = null, this._initData = {}, this._aniKeys = null, this._effectClass = null, t.__super.call(this)
            }

            x(t, "laya.display.EffectAnimation", s);
            var e = t.prototype;
            e._onOtherBegin = function (t) {
                t !== this && this.stop()
            }, e._addEvent = function () {
                this._target && this._playEvent && (this._setControlNode(this._target), this._target.on(this._playEvent, this, this._onPlayAction))
            }, e._onPlayAction = function () {
                this.play(0, !1)
            }, e.play = function (t, e, i) {
                void 0 === t && (t = 0), void 0 === e && (e = !0), void 0 === i && (i = ""), this._target && (this._target.event("effectbegin", [this]), this._recordInitData(), laya.display.AnimationBase.prototype.play.call(this, t, e, i))
            }, e._recordInitData = function () {
                if (this._aniKeys) {
                    var t, e, i = 0;
                    for (t = this._aniKeys.length, i = 0; i < t; i++) e = this._aniKeys[i], this._initData[e] = this._target[e]
                }
            }, e._displayToIndex = function (t) {
                if (this._animationData) {
                    t < 0 && (t = 0), t > this._count && (t = this._count);
                    var e = this._animationData.nodes, i = 0, n = e.length;
                    for (n = 1 < n ? 1 : n, i = 0; i < n; i++) this._displayNodeToFrame(e[i], t)
                }
            }, e._displayNodeToFrame = function (t, e, i) {
                if (this._target) {
                    var n, r, s, a, o, h, l, u = this._target, c = t.frames, _ = t.keys, f = 0, d = _.length,
                        p = t.secondFrames, m = 0;
                    for (f = 0; f < d; f++) r = c[n = _[f]], s = -1 == (m = p[n]) ? this._initData[n] : e < m ? (h = (o = t.keyframes[n])[0]).tween ? (null == (a = ee[h.tweenMethod]) && (a = ee.linearNone), l = o[1], a(e, this._initData[n], l.value - this._initData[n], l.index)) : this._initData[n] : r.length > e ? r[e] : r[r.length - 1], u[n] = s
                }
            }, e._calculateKeyFrames = function (t) {
                s.prototype._calculateKeyFrames.call(this, t);
                var e, i, n = t.keyframes, r = (t.target, {});
                for (e in t.secondFrames = r, n) (i = n[e]).length <= 1 ? r[e] = -1 : r[e] = i[1].index
            }, d(0, e, "target", function () {
                return this._target
            }, function (t) {
                this._target && this._target.off("effectbegin", this, this._onOtherBegin), this._target = t, this._target && this._target.on("effectbegin", this, this._onOtherBegin), this._addEvent()
            }), d(0, e, "playEvent", null, function (t) {
                (this._playEvent = t) && this._addEvent()
            }), d(0, e, "effectData", null, function (t) {
                if (t) {
                    var e = t.animations;
                    if (e && e[0]) {
                        var i = e[0];
                        this._setUp({}, i), i.nodes && i.nodes[0] && (this._aniKeys = i.nodes[0].keys)
                    }
                }
            }), d(0, e, "effectClass", null, function (t) {
                if (this._effectClass = It.getClass(t), this._effectClass) {
                    var e = this._effectClass.uiView;
                    if (e) {
                        var i = e.animations;
                        if (i && i[0]) {
                            var n = i[0];
                            this._setUp({}, n), n.nodes && n.nodes[0] && (this._aniKeys = n.nodes[0].keys)
                        }
                    }
                }
            }), t.EFFECT_BEGIN = "effectbegin"
        }(ci);
        y.__init([Ne, g, ct, S, di, mt, Rt, Q, tt, Qt, wt, we, c, Se])
    }(window, document, Laya), function (t, e, i) {
        i.un, i.uns, i.static;
        var n = i.class;
        i.getset, i.__newvec;
        new (function () {
            function t() {
            }

            return n(t, "LayaMain"), t
        }())
    }(window, document, Laya);
});
define("libs/laya.d3.js", function (require, module, exports) {
    !function (o, t, m) {
        m.un, m.uns;
        var _ = m.static, d = m.class, u = m.getset, w = m.__newvec, n = laya.resource.BaseTexture,
            S = laya.utils.Browser, i = laya.webgl.utils.Buffer, c = laya.webgl.BufferStateBase, s = laya.utils.Byte,
            p = laya.utils.ClassUtils, a = laya.layagl.CommandEncoder, r = laya.components.Component, l = m.Config,
            h = laya.resource.Context, f = (laya.events.Event, laya.events.EventDispatcher), T = laya.utils.Handler,
            E = (laya.webgl.utils.InlcudeFile, laya.layagl.LayaGL), v = laya.layagl.LayaGLRunner, Dt = laya.net.Loader,
            g = laya.net.LoaderManager, z = laya.maths.MathUtil, e = laya.display.Node, y = laya.maths.Point,
            b = laya.renders.Render, D = (laya.resource.RenderTexture2D, laya.resource.Resource),
            x = laya.utils.RunDriver, I = (laya.webgl.shader.Shader, laya.webgl.utils.ShaderCompile),
            R = laya.webgl.utils.ShaderNode, M = laya.display.Sprite, C = laya.utils.Stat, A = laya.webgl.submit.Submit,
            L = laya.webgl.submit.SubmitKey, F = laya.resource.Texture2D, O = (laya.utils.Timer, laya.net.URL),
            N = laya.webgl.WebGL, V = laya.webgl.WebGLContext;
        m.interface("laya.d3.core.IClone"), m.interface("laya.d3.graphics.IVertex"), m.interface("laya.d3.core.scene.IOctreeObject");
        var B = function () {
            function a(t, e, n, i, r) {
                var a;
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === n && (n = 0), void 0 === i && (i = 1), (a = r || new Float32Array(4))[0] = t, a[1] = e, a[2] = n, a[3] = i, this.elements = a
            }

            d(a, "laya.d3.math.Native.ConchQuaternion");
            var t = a.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.scaling = function (t, e) {
                var n = e.elements, i = this.elements;
                n[0] = i[0] * t, n[1] = i[1] * t, n[2] = i[2] * t, n[3] = i[3] * t
            }, t.normalize = function (t) {
                a._normalizeArray(this.elements, t.elements)
            }, t.length = function () {
                var t = this.elements, e = t[0], n = t[1], i = t[2], r = t[3];
                return Math.sqrt(e * e + n * n + i * i + r * r)
            }, t.rotateX = function (t, e) {
                var n = e.elements, i = this.elements;
                t *= .5;
                var r = i[0], a = i[1], o = i[2], s = i[3], l = Math.sin(t), h = Math.cos(t);
                n[0] = r * h + s * l, n[1] = a * h + o * l, n[2] = o * h - a * l, n[3] = s * h - r * l
            }, t.rotateY = function (t, e) {
                var n = e.elements, i = this.elements;
                t *= .5;
                var r = i[0], a = i[1], o = i[2], s = i[3], l = Math.sin(t), h = Math.cos(t);
                n[0] = r * h - o * l, n[1] = a * h + s * l, n[2] = o * h + r * l, n[3] = s * h - a * l
            }, t.rotateZ = function (t, e) {
                var n = e.elements, i = this.elements;
                t *= .5;
                var r = i[0], a = i[1], o = i[2], s = i[3], l = Math.sin(t), h = Math.cos(t);
                n[0] = r * h + a * l, n[1] = a * h - r * l, n[2] = o * h + s * l, n[3] = s * h - o * l
            }, t.getYawPitchRoll = function (t) {
                U.transformQuat(U.ForwardRH, this, a.TEMPVector31), U.transformQuat(U.Up, this, a.TEMPVector32);
                var e = a.TEMPVector32.elements;
                a.angleTo(U.ZERO, a.TEMPVector31, a.TEMPVector33);
                var n = a.TEMPVector33.elements;
                n[0] == Math.PI / 2 ? (n[1] = a.arcTanAngle(e[2], e[0]), n[2] = 0) : n[0] == -Math.PI / 2 ? (n[1] = a.arcTanAngle(-e[2], -e[0]), n[2] = 0) : (He.createRotationY(-n[1], a.TEMPMatrix0), He.createRotationX(-n[0], a.TEMPMatrix1), U.transformCoordinate(a.TEMPVector32, a.TEMPMatrix0, a.TEMPVector32), U.transformCoordinate(a.TEMPVector32, a.TEMPMatrix1, a.TEMPVector32), n[2] = a.arcTanAngle(e[1], -e[0])), n[1] <= -Math.PI && (n[1] = Math.PI), n[2] <= -Math.PI && (n[2] = Math.PI), n[1] >= Math.PI && n[2] >= Math.PI && (n[1] = 0, n[2] = 0, n[0] = Math.PI - n[0]);
                var i = t.elements;
                i[0] = n[1], i[1] = n[0], i[2] = n[2]
            }, t.invert = function (t) {
                var e = t.elements, n = this.elements, i = n[0], r = n[1], a = n[2], o = n[3],
                    s = i * i + r * r + a * a + o * o, l = s ? 1 / s : 0;
                e[0] = -i * l, e[1] = -r * l, e[2] = -a * l, e[3] = o * l
            }, t.identity = function () {
                var t = this.elements;
                t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 1
            }, t.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.elements[0] = t[e + 0], this.elements[1] = t[e + 1], this.elements[2] = t[e + 2], this.elements[3] = t[e + 3]
            }, t.cloneTo = function (t) {
                var e, n, i;
                if ((n = this.elements) !== (i = t.elements)) for (e = 0; e < 4; ++e) i[e] = n[e]
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t.equals = function (t) {
                var e = this.elements, n = t.elements;
                return tt.nearEqual(e[0], n[0]) && tt.nearEqual(e[1], n[1]) && tt.nearEqual(e[2], n[2]) && tt.nearEqual(e[3], n[3])
            }, t.lengthSquared = function () {
                var t = this.elements[0], e = this.elements[1], n = this.elements[2], i = this.elements[3];
                return t * t + e * e + n * n + i * i
            }, u(0, t, "x", function () {
                return this.elements[0]
            }, function (t) {
                this.elements[0] = t
            }), u(0, t, "y", function () {
                return this.elements[1]
            }, function (t) {
                this.elements[1] = t
            }), u(0, t, "z", function () {
                return this.elements[2]
            }, function (t) {
                this.elements[2] = t
            }), u(0, t, "w", function () {
                return this.elements[3]
            }, function (t) {
                this.elements[3] = t
            }), a._dotArray = function (t, e) {
                return t[0] * e[0] + t[1] * e[1] + t[2] * e[2] + t[3] * e[3]
            }, a._normalizeArray = function (t, e) {
                var n = t[0], i = t[1], r = t[2], a = t[3], o = n * n + i * i + r * r + a * a;
                0 < o && (o = 1 / Math.sqrt(o), e[0] = n * o, e[1] = i * o, e[2] = r * o, e[3] = a * o)
            }, a._lerpArray = function (t, e, n, i) {
                var r = 1 - n;
                0 <= a._dotArray(t, e) ? (i[0] = r * t[0] + n * e[0], i[1] = r * t[1] + n * e[1], i[2] = r * t[2] + n * e[2], i[3] = r * t[3] + n * e[3]) : (i[0] = r * t[0] - n * e[0], i[1] = r * t[1] - n * e[1], i[2] = r * t[2] - n * e[2], i[3] = r * t[3] - n * e[3]), a._normalizeArray(i, i)
            }, a.createFromYawPitchRoll = function (t, e, n, i) {
                var r = .5 * n, a = .5 * e, o = .5 * t, s = Math.sin(r), l = Math.cos(r), h = Math.sin(a),
                    u = Math.cos(a), c = Math.sin(o), _ = Math.cos(o), d = i.elements;
                d[0] = _ * h * l + c * u * s, d[1] = c * u * l - _ * h * s, d[2] = _ * u * s - c * h * l, d[3] = _ * u * l + c * h * s
            }, a.multiply = function (t, e, n) {
                var i = t.elements, r = e.elements, a = n.elements, o = i[0], s = i[1], l = i[2], h = i[3], u = r[0],
                    c = r[1], _ = r[2], d = r[3], f = s * _ - l * c, m = l * u - o * _, p = o * c - s * u,
                    T = o * u + s * c + l * _;
                a[0] = o * d + u * h + f, a[1] = s * d + c * h + m, a[2] = l * d + _ * h + p, a[3] = h * d - T
            }, a.arcTanAngle = function (t, e) {
                return 0 == t ? 1 == e ? Math.PI / 2 : -Math.PI / 2 : 0 < t ? Math.atan(e / t) : t < 0 ? 0 < e ? Math.atan(e / t) + Math.PI : Math.atan(e / t) - Math.PI : 0
            }, a.angleTo = function (t, e, n) {
                U.subtract(e, t, a.TEMPVector30), U.normalize(a.TEMPVector30, a.TEMPVector30), n.elements[0] = Math.asin(a.TEMPVector30.y), n.elements[1] = a.arcTanAngle(-a.TEMPVector30.z, -a.TEMPVector30.x)
            }, a.createFromAxisAngle = function (t, e, n) {
                var i = n.elements, r = t.elements;
                e *= .5;
                var a = Math.sin(e);
                i[0] = a * r[0], i[1] = a * r[1], i[2] = a * r[2], i[3] = Math.cos(e)
            }, a.createFromMatrix3x3 = function (t, e) {
                var n, i = e.elements, r = t.elements, a = r[0] + r[4] + r[8];
                if (0 < a) n = Math.sqrt(a + 1), i[3] = .5 * n, n = .5 / n, i[0] = (r[5] - r[7]) * n, i[1] = (r[6] - r[2]) * n, i[2] = (r[1] - r[3]) * n; else {
                    var o = 0;
                    r[4] > r[0] && (o = 1), r[8] > r[3 * o + o] && (o = 2);
                    var s = (o + 1) % 3, l = (o + 2) % 3;
                    n = Math.sqrt(r[3 * o + o] - r[3 * s + s] - r[3 * l + l] + 1), i[o] = .5 * n, n = .5 / n, i[3] = (r[3 * s + l] - r[3 * l + s]) * n, i[s] = (r[3 * s + o] + r[3 * o + s]) * n, i[l] = (r[3 * l + o] + r[3 * o + l]) * n
                }
            }, a.createFromMatrix4x4 = function (t, e) {
                var n, i, r = t.elements, a = e.elements, o = r[0] + r[5] + r[10];
                0 < o ? (n = Math.sqrt(o + 1), a[3] = .5 * n, n = .5 / n, a[0] = (r[6] - r[9]) * n, a[1] = (r[8] - r[2]) * n, a[2] = (r[1] - r[4]) * n) : r[0] >= r[5] && r[0] >= r[10] ? (i = .5 / (n = Math.sqrt(1 + r[0] - r[5] - r[10])), a[0] = .5 * n, a[1] = (r[1] + r[4]) * i, a[2] = (r[2] + r[8]) * i, a[3] = (r[6] - r[9]) * i) : r[5] > r[10] ? (i = .5 / (n = Math.sqrt(1 + r[5] - r[0] - r[10])), a[0] = (r[4] + r[1]) * i, a[1] = .5 * n, a[2] = (r[9] + r[6]) * i, a[3] = (r[8] - r[2]) * i) : (i = .5 / (n = Math.sqrt(1 + r[10] - r[0] - r[5])), a[0] = (r[8] + r[2]) * i, a[1] = (r[9] + r[6]) * i, a[2] = .5 * n, a[3] = (r[1] - r[4]) * i)
            }, a.slerp = function (t, e, n, i) {
                var r, a, o, s, l, h = t.elements, u = e.elements, c = i.elements, _ = h[0], d = h[1], f = h[2],
                    m = h[3], p = u[0], T = u[1], E = u[2], v = u[3];
                return (a = _ * p + d * T + f * E + m * v) < 0 && (a = -a, p = -p, T = -T, E = -E, v = -v), l = 1e-6 < 1 - a ? (r = Math.acos(a), o = Math.sin(r), s = Math.sin((1 - n) * r) / o, Math.sin(n * r) / o) : (s = 1 - n, n), c[0] = s * _ + l * p, c[1] = s * d + l * T, c[2] = s * f + l * E, c[3] = s * m + l * v, c
            }, a.lerp = function (t, e, n, i) {
                a._lerpArray(t.elements, e.elements, n, i.elements)
            }, a.add = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = r[0] + a[0], i[1] = r[1] + a[1], i[2] = r[2] + a[2], i[3] = r[3] + a[3]
            }, a.dot = function (t, e) {
                return a._dotArray(t.elements, e.elements)
            }, a.rotationLookAt = function (t, e, n) {
                a.lookAt(U.ZERO, t, e, n)
            }, a.lookAt = function (t, e, n, i) {
                Be.lookAt(t, e, n, a._tempMatrix3x3), a.rotationMatrix(a._tempMatrix3x3, i)
            }, a.invert = function (t, e) {
                var n = t.elements, i = e.elements, r = t.lengthSquared();
                tt.isZero(r) || (r = 1 / r, i[0] = -n[0] * r, i[1] = -n[1] * r, i[2] = -n[2] * r, i[3] = n[3] * r)
            }, a.rotationMatrix = function (t, e) {
                var n = t.elements, i = n[0], r = n[1], a = n[2], o = n[3], s = n[4], l = n[5], h = n[6], u = n[7],
                    c = n[8], _ = e.elements, d = NaN, f = NaN, m = i + s + c;
                0 < m ? (d = Math.sqrt(m + 1), _[3] = .5 * d, d = .5 / d, _[0] = (l - u) * d, _[1] = (h - a) * d, _[2] = (r - o) * d) : _[3] = s <= i && c <= i ? (f = .5 / (d = Math.sqrt(1 + i - s - c)), _[0] = .5 * d, _[1] = (r + o) * f, _[2] = (a + h) * f, (l - u) * f) : c < s ? (f = .5 / (d = Math.sqrt(1 + s - i - c)), _[0] = (o + r) * f, _[1] = .5 * d, _[2] = (u + l) * f, (h - a) * f) : (f = .5 / (d = Math.sqrt(1 + c - i - s)), _[0] = (h + a) * f, _[1] = (u + l) * f, _[2] = .5 * d, (r - o) * f)
            }, a.DEFAULT = new a, _(a, ["TEMPVector30", function () {
                return this.TEMPVector30 = new U
            }, "TEMPVector31", function () {
                return this.TEMPVector31 = new U
            }, "TEMPVector32", function () {
                return this.TEMPVector32 = new U
            }, "TEMPVector33", function () {
                return this.TEMPVector33 = new U
            }, "TEMPMatrix0", function () {
                return this.TEMPMatrix0 = new He
            }, "TEMPMatrix1", function () {
                return this.TEMPMatrix1 = new He
            }, "_tempMatrix3x3", function () {
                return this._tempMatrix3x3 = new Be
            }, "NAN", function () {
                return this.NAN = new a(NaN, NaN, NaN, NaN)
            }]), a
        }(), P = function () {
            function t(t, e, n, i) {
                this.elements = null, void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === n && (n = 0), void 0 === i && (i = 0);
                var r = this.elements = new Float32Array(4);
                r[0] = t, r[1] = e, r[2] = n, r[3] = i
            }

            d(t, "laya.d3.math.Native.ConchVector4");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.elements[0] = t[e + 0], this.elements[1] = t[e + 1], this.elements[2] = t[e + 2], this.elements[3] = t[e + 3]
            }, e.cloneTo = function (t) {
                var e = t.elements, n = this.elements;
                e[0] = n[0], e[1] = n[1], e[2] = n[2], e[3] = n[3]
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, e.length = function () {
                return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w)
            }, e.lengthSquared = function () {
                return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w
            }, u(0, e, "x", function () {
                return this.elements[0]
            }, function (t) {
                this.elements[0] = t
            }), u(0, e, "y", function () {
                return this.elements[1]
            }, function (t) {
                this.elements[1] = t
            }), u(0, e, "z", function () {
                return this.elements[2]
            }, function (t) {
                this.elements[2] = t
            }), u(0, e, "w", function () {
                return this.elements[3]
            }, function (t) {
                this.elements[3] = t
            }), t.lerp = function (t, e, n, i) {
                var r = i.elements, a = t.elements, o = e.elements, s = a[0], l = a[1], h = a[2], u = a[3];
                r[0] = s + n * (o[0] - s), r[1] = l + n * (o[1] - l), r[2] = h + n * (o[2] - h), r[3] = u + n * (o[3] - u)
            }, t.transformByM4x4 = function (t, e, n) {
                var i = t.elements, r = i[0], a = i[1], o = i[2], s = i[3], l = e.elements, h = n.elements;
                h[0] = r * l[0] + a * l[4] + o * l[8] + s * l[12], h[1] = r * l[1] + a * l[5] + o * l[9] + s * l[13], h[2] = r * l[2] + a * l[6] + o * l[10] + s * l[14], h[3] = r * l[3] + a * l[7] + o * l[11] + s * l[15]
            }, t.equals = function (t, e) {
                var n = t.elements, i = e.elements;
                return tt.nearEqual(Math.abs(n[0]), Math.abs(i[0])) && tt.nearEqual(Math.abs(n[1]), Math.abs(i[1])) && tt.nearEqual(Math.abs(n[2]), Math.abs(i[2])) && tt.nearEqual(Math.abs(n[3]), Math.abs(i[3]))
            }, t.normalize = function (t, e) {
                var n = t.elements, i = e.elements, r = t.length();
                0 < r && (i[0] = n[0] * r, i[1] = n[1] * r, i[2] = n[2] * r, i[3] = n[3] * r)
            }, t.add = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = r[0] + a[0], i[1] = r[1] + a[1], i[2] = r[2] + a[2], i[3] = r[3] + a[3]
            }, t.subtract = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = r[0] - a[0], i[1] = r[1] - a[1], i[2] = r[2] - a[2], i[3] = r[3] - a[3]
            }, t.multiply = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = r[0] * a[0], i[1] = r[1] * a[1], i[2] = r[2] * a[2], i[3] = r[3] * a[3]
            }, t.scale = function (t, e, n) {
                var i = n.elements, r = t.elements;
                i[0] = r[0] * e, i[1] = r[1] * e, i[2] = r[2] * e, i[3] = r[3] * e
            }, t.Clamp = function (t, e, n, i) {
                var r = t.elements, a = r[0], o = r[1], s = r[2], l = r[3], h = e.elements, u = h[0], c = h[1],
                    _ = h[2], d = h[3], f = n.elements, m = f[0], p = f[1], T = f[2], E = f[3], v = i.elements;
                a = (a = m < a ? m : a) < u ? u : a, o = (o = p < o ? p : o) < c ? c : o, s = (s = T < s ? T : s) < _ ? _ : s, l = (l = E < l ? E : l) < d ? d : l, v[0] = a, v[1] = o, v[2] = s, v[3] = l
            }, t.distanceSquared = function (t, e) {
                var n = t.elements, i = e.elements, r = n[0] - i[0], a = n[1] - i[1], o = n[2] - i[2], s = n[3] - i[3];
                return r * r + a * a + o * o + s * s
            }, t.distance = function (t, e) {
                var n = t.elements, i = e.elements, r = n[0] - i[0], a = n[1] - i[1], o = n[2] - i[2], s = n[3] - i[3];
                return Math.sqrt(r * r + a * a + o * o + s * s)
            }, t.dot = function (t, e) {
                var n = t.elements, i = e.elements;
                return n[0] * i[0] + n[1] * i[1] + n[2] * i[2] + n[3] * i[3]
            }, t.min = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = Math.min(r[0], a[0]), i[1] = Math.min(r[1], a[1]), i[2] = Math.min(r[2], a[2]), i[3] = Math.min(r[3], a[3])
            }, t.max = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = Math.max(r[0], a[0]), i[1] = Math.max(r[1], a[1]), i[2] = Math.max(r[2], a[2]), i[3] = Math.max(r[3], a[3])
            }, _(t, ["ZERO", function () {
                return this.ZERO = new t
            }, "ONE", function () {
                return this.ONE = new t(1, 1, 1, 1)
            }, "UnitX", function () {
                return this.UnitX = new t(1, 0, 0, 0)
            }, "UnitY", function () {
                return this.UnitY = new t(0, 1, 0, 0)
            }, "UnitZ", function () {
                return this.UnitZ = new t(0, 0, 1, 0)
            }, "UnitW", function () {
                return this.UnitW = new t(0, 0, 0, 1)
            }]), t
        }(), U = function () {
            function o(t, e, n, i) {
                var r;
                this.elements = null, void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === n && (n = 0), r = i || new Float32Array(3), (this.elements = r)[0] = t, r[1] = e, r[2] = n
            }

            d(o, "laya.d3.math.Native.ConchVector3");
            var t = o.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.setValue = function (t, e, n) {
                this.elements[0] = t, this.elements[1] = e, this.elements[2] = n
            }, t.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.elements[0] = t[e + 0], this.elements[1] = t[e + 1], this.elements[2] = t[e + 2]
            }, t.cloneTo = function (t) {
                var e = t.elements, n = this.elements;
                e[0] = n[0], e[1] = n[1], e[2] = n[2]
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t.toDefault = function () {
                this.elements[0] = 0, this.elements[1] = 0, this.elements[2] = 0
            }, u(0, t, "x", function () {
                return this.elements[0]
            }, function (t) {
                this.elements[0] = t
            }), u(0, t, "y", function () {
                return this.elements[1]
            }, function (t) {
                this.elements[1] = t
            }), u(0, t, "z", function () {
                return this.elements[2]
            }, function (t) {
                this.elements[2] = t
            }), o.distanceSquared = function (t, e) {
                var n = t.elements, i = e.elements, r = n[0] - i[0], a = n[1] - i[1], o = n[2] - i[2];
                return r * r + a * a + o * o
            }, o.distance = function (t, e) {
                var n = t.elements, i = e.elements, r = n[0] - i[0], a = n[1] - i[1], o = n[2] - i[2];
                return Math.sqrt(r * r + a * a + o * o)
            }, o.min = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = Math.min(r[0], a[0]), i[1] = Math.min(r[1], a[1]), i[2] = Math.min(r[2], a[2])
            }, o.max = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = Math.max(r[0], a[0]), i[1] = Math.max(r[1], a[1]), i[2] = Math.max(r[2], a[2])
            }, o.transformQuat = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements, o = r[0], s = r[1], l = r[2], h = a[0], u = a[1],
                    c = a[2], _ = a[3], d = _ * o + u * l - c * s, f = _ * s + c * o - h * l, m = _ * l + h * s - u * o,
                    p = -h * o - u * s - c * l;
                i[0] = d * _ + p * -h + f * -c - m * -u, i[1] = f * _ + p * -u + m * -h - d * -c, i[2] = m * _ + p * -c + d * -u - f * -h
            }, o.scalarLength = function (t) {
                var e = t.elements, n = e[0], i = e[1], r = e[2];
                return Math.sqrt(n * n + i * i + r * r)
            }, o.scalarLengthSquared = function (t) {
                var e = t.elements, n = e[0], i = e[1], r = e[2];
                return n * n + i * i + r * r
            }, o.normalize = function (t, e) {
                var n = t.elements, i = e.elements, r = n[0], a = n[1], o = n[2], s = r * r + a * a + o * o;
                0 < s && (s = 1 / Math.sqrt(s), i[0] = n[0] * s, i[1] = n[1] * s, i[2] = n[2] * s)
            }, o.multiply = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = r[0] * a[0], i[1] = r[1] * a[1], i[2] = r[2] * a[2]
            }, o.scale = function (t, e, n) {
                var i = n.elements, r = t.elements;
                i[0] = r[0] * e, i[1] = r[1] * e, i[2] = r[2] * e
            }, o.lerp = function (t, e, n, i) {
                var r = i.elements, a = t.elements, o = e.elements, s = a[0], l = a[1], h = a[2];
                r[0] = s + n * (o[0] - s), r[1] = l + n * (o[1] - l), r[2] = h + n * (o[2] - h)
            }, o.transformV3ToV3 = function (t, e, n) {
                var i = o._tempVector4;
                o.transformV3ToV4(t, e, i);
                var r = i.elements, a = n.elements;
                a[0] = r[0], a[1] = r[1], a[2] = r[2]
            }, o.transformV3ToV4 = function (t, e, n) {
                var i = t.elements, r = i[0], a = i[1], o = i[2], s = e.elements, l = n.elements;
                l[0] = r * s[0] + a * s[4] + o * s[8] + s[12], l[1] = r * s[1] + a * s[5] + o * s[9] + s[13], l[2] = r * s[2] + a * s[6] + o * s[10] + s[14], l[3] = r * s[3] + a * s[7] + o * s[11] + s[15]
            }, o.TransformNormal = function (t, e, n) {
                var i = t.elements, r = i[0], a = i[1], o = i[2], s = e.elements, l = n.elements;
                l[0] = r * s[0] + a * s[4] + o * s[8], l[1] = r * s[1] + a * s[5] + o * s[9], l[2] = r * s[2] + a * s[6] + o * s[10]
            }, o.transformCoordinate = function (t, e, n) {
                var i = t.elements, r = i[0], a = i[1], o = i[2], s = e.elements,
                    l = r * s[3] + a * s[7] + o * s[11] + s[15], h = n.elements;
                h[0] = r * s[0] + a * s[4] + o * s[8] + s[12] / l, h[1] = r * s[1] + a * s[5] + o * s[9] + s[13] / l, h[2] = r * s[2] + a * s[6] + o * s[10] + s[14] / l
            }, o.Clamp = function (t, e, n, i) {
                var r = t.elements, a = r[0], o = r[1], s = r[2], l = e.elements, h = l[0], u = l[1], c = l[2],
                    _ = n.elements, d = _[0], f = _[1], m = _[2], p = i.elements;
                a = (a = d < a ? d : a) < h ? h : a, o = (o = f < o ? f : o) < u ? u : o, s = (s = m < s ? m : s) < c ? c : s, p[0] = a, p[1] = o, p[2] = s
            }, o.add = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = r[0] + a[0], i[1] = r[1] + a[1], i[2] = r[2] + a[2]
            }, o.subtract = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements;
                i[0] = r[0] - a[0], i[1] = r[1] - a[1], i[2] = r[2] - a[2]
            }, o.cross = function (t, e, n) {
                var i = t.elements, r = e.elements, a = n.elements, o = i[0], s = i[1], l = i[2], h = r[0], u = r[1],
                    c = r[2];
                a[0] = s * c - l * u, a[1] = l * h - o * c, a[2] = o * u - s * h
            }, o.dot = function (t, e) {
                var n = t.elements, i = e.elements;
                return n[0] * i[0] + n[1] * i[1] + n[2] * i[2]
            }, o.equals = function (t, e) {
                var n = t.elements, i = e.elements;
                return tt.nearEqual(n[0], i[0]) && tt.nearEqual(n[1], i[1]) && tt.nearEqual(n[2], i[2])
            }, o.ZERO = new o(0, 0, 0), o.ONE = new o(1, 1, 1), o.NegativeUnitX = new o(-1, 0, 0), o.UnitX = new o(1, 0, 0), o.UnitY = new o(0, 1, 0), o.UnitZ = new o(0, 0, 1), o.ForwardRH = new o(0, 0, -1), o.ForwardLH = new o(0, 0, 1), o.Up = new o(0, 1, 0), o.NAN = new o(NaN, NaN, NaN), _(o, ["_tempVector4", function () {
                return this._tempVector4 = new P
            }]), o
        }(), It = function () {
            function t(t) {
                this._color = null, this.enbale = !1, this._color = t
            }

            d(t, "laya.d3.core.particleShuriKen.module.ColorOverLifetime");
            var e = t.prototype;
            return e.cloneTo = function (t) {
                var e = t;
                this._color.cloneTo(e._color), e.enbale = this.enbale
            }, e.clone = function () {
                var t;
                switch (this._color.type) {
                    case 0:
                        t = Mt.createByConstant(this._color.constant.clone());
                        break;
                    case 1:
                        t = Mt.createByGradient(this._color.gradient.clone());
                        break;
                    case 2:
                        t = Mt.createByRandomTwoConstant(this._color.constantMin.clone(), this._color.constantMax.clone());
                        break;
                    case 3:
                        t = Mt.createByRandomTwoGradient(this._color.gradientMin.clone(), this._color.gradientMax.clone())
                }
                var e = new this.constructor(t);
                return e.enbale = this.enbale, e
            }, u(0, e, "color", function () {
                return this._color
            }), t
        }(), G = function () {
            function t() {
                this.enable = !1, this.randomDirection = !1
            }

            d(t, "laya.d3.core.particleShuriKen.module.shape.BaseShape");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e._getShapeBoundBox = function (t) {
                throw new Error("BaseShape: must override it.")
            }, e._getSpeedBoundBox = function (t) {
                throw new Error("BaseShape: must override it.")
            }, e.generatePositionAndDirection = function (t, e, n, i) {
                throw new Error("BaseShape: must override it.")
            }, e._calculateProceduralBounds = function (t, e, n) {
                this._getShapeBoundBox(t);
                var i = t.min, r = t.max;
                Lt.multiply(i, e, i), Lt.multiply(r, e, r);
                var a = new ze(new Lt, new Lt);
                this.randomDirection ? (a.min = new Lt(-1, -1, -1), a.max = new Lt(1, 1, 1)) : this._getSpeedBoundBox(a);
                var o = new ze(new Lt, new Lt), s = o.min, l = o.max;
                Lt.scale(a.min, n.y, s), Lt.scale(a.max, n.y, l), Lt.add(t.min, s, s), Lt.add(t.max, l, l), Lt.min(t.min, s, t.min), Lt.max(t.max, s, t.max);
                var h = new ze(new Lt, new Lt), u = h.min, c = h.max;
                Lt.scale(a.min, n.x, u), Lt.scale(a.max, n.x, c), Lt.min(h.min, c, s), Lt.max(h.min, c, l), Lt.min(t.min, s, t.min), Lt.max(t.max, s, t.max)
            }, e.cloneTo = function (t) {
                t.enable = this.enable
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t
        }(), H = function () {
            function e() {
                this._attatched = !1, this._indexInCompound = -1, this._compoundParent = null, this._attatchedCollisionObject = null, this._referenceCount = 0, this.needsCustomCollisionCallback = !1, this._scale = new Lt(1, 1, 1), this._centerMatrix = new He, this._localOffset = new Lt(0, 0, 0), this._localRotation = new at(0, 0, 0, 1)
            }

            d(e, "laya.d3.physics.shape.ColliderShape");
            var t = e.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t._setScale = function (t) {
                this._compoundParent ? this.updateLocalTransformations() : (e._nativeScale.setValue(t.x, t.y, t.z), this._nativeShape.setLocalScaling(e._nativeScale))
            }, t._addReference = function () {
                this._referenceCount++
            }, t._removeReference = function () {
                this._referenceCount--
            }, t.updateLocalTransformations = function () {
                if (this._compoundParent) {
                    var t = e._tempVector30;
                    Lt.multiply(this.localOffset, this._scale, t), e._createAffineTransformation(t, this.localRotation, this._centerMatrix.elements)
                } else e._createAffineTransformation(this.localOffset, this.localRotation, this._centerMatrix.elements)
            }, t.cloneTo = function (t) {
                var e = t;
                this._localOffset.cloneTo(e.localOffset), this._localRotation.cloneTo(e.localRotation), e.localOffset = e.localOffset, e.localRotation = e.localRotation
            }, t.clone = function () {
                return null
            }, t.destroy = function () {
                this._nativeShape && (k._physics3D.destroy(this._nativeShape), this._nativeShape = null)
            }, u(0, t, "type", function () {
                return this._type
            }), u(0, t, "localOffset", function () {
                return this._localOffset
            }, function (t) {
                this._localOffset = t, this._compoundParent && this._compoundParent._updateChildTransform(this)
            }), u(0, t, "localRotation", function () {
                return this._localRotation
            }, function (t) {
                this._localRotation = t, this._compoundParent && this._compoundParent._updateChildTransform(this)
            }), e._creatShape = function (t) {
                var e;
                switch (t.type) {
                    case"BoxColliderShape":
                        var n = t.size;
                        e = n ? new hn(n[0], n[1], n[2]) : new hn;
                        break;
                    case"SphereColliderShape":
                        e = new tn(t.radius);
                        break;
                    case"CapsuleColliderShape":
                        e = new an(t.radius, t.height, t.orientation);
                        break;
                    case"MeshColliderShape":
                        var i = new Dn;
                        t.mesh && (i.mesh = Dt.getRes(t.mesh)), e = i;
                        break;
                    case"ConeColliderShape":
                        e = new On(t.radius, t.height, t.orientation);
                        break;
                    case"CylinderColliderShape":
                        e = new pn(t.radius, t.height, t.orientation);
                        break;
                    default:
                        throw"unknown shape type."
                }
                if (t.center) {
                    var r = e.localOffset;
                    r.fromArray(t.center), e.localOffset = r
                }
                return e
            }, e._createAffineTransformation = function (t, e, n) {
                var i = e.x, r = e.y, a = e.z, o = e.w, s = i + i, l = r + r, h = a + a, u = i * s, c = i * l,
                    _ = i * h, d = r * l, f = r * h, m = a * h, p = o * s, T = o * l, E = o * h;
                n[0] = 1 - (d + m), n[1] = c + E, n[2] = _ - T, n[3] = 0, n[4] = c - E, n[5] = 1 - (u + m), n[6] = f + p, n[7] = 0, n[8] = _ + T, n[9] = f - p, n[10] = 1 - (u + d), n[11] = 0, n[12] = t.x, n[13] = t.y, n[14] = t.z, n[15] = 1
            }, e.SHAPEORIENTATION_UPX = 0, e.SHAPEORIENTATION_UPY = 1, e.SHAPEORIENTATION_UPZ = 2, e.SHAPETYPES_BOX = 0, e.SHAPETYPES_SPHERE = 1, e.SHAPETYPES_CYLINDER = 2, e.SHAPETYPES_CAPSULE = 3, e.SHAPETYPES_CONVEXHULL = 4, e.SHAPETYPES_COMPOUND = 5, e.SHAPETYPES_STATICPLANE = 6, e.SHAPETYPES_CONE = 7, _(e, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_nativeScale", function () {
                return this._nativeScale = new k._physics3D.btVector3(1, 1, 1)
            }, "_nativeVector30", function () {
                return this._nativeVector30 = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativQuaternion0", function () {
                return this._nativQuaternion0 = new k._physics3D.btQuaternion(0, 0, 0, 1)
            }, "_nativeTransform0", function () {
                return this._nativeTransform0 = new k._physics3D.btTransform
            }]), e
        }(), k = function () {
            function P() {
            }

            return d(P, "Laya3D"), u(1, P, "enbalePhysics", function () {
                return P._enbalePhysics
            }), P._cancelLoadByUrl = function (t) {
                m.loader.cancelLoadByUrl(t), P._innerFirstLevelLoaderManager.cancelLoadByUrl(t), P._innerSecondLevelLoaderManager.cancelLoadByUrl(t), P._innerThirdLevelLoaderManager.cancelLoadByUrl(t), P._innerFourthLevelLoaderManager.cancelLoadByUrl(t)
            }, P._changeWebGLSize = function (t, e) {
                N.onStageResize(t, e), K.clientWidth = t, K.clientHeight = e
            }, P.__init__ = function (t, e, n) {
                if (l.isAntialias = n.isAntialias, l.isAlpha = n.isAlpha, l.premultipliedAlpha = n.premultipliedAlpha, l.isStencil = n.isStencil, N.enable()) {
                    x.changeWebGLSize = P._changeWebGLSize, b.is3DMode = !0, m.init(t, e), b.supportWebGLPlusRendering || (E.instance = N.mainContext, E.instance.createCommandEncoder = function (t, e, n) {
                        return void 0 === t && (t = 128), void 0 === e && (e = 64), void 0 === n && (n = !1), new a(this, t, e, n)
                    }), P.enableNative3D(), Fn.__init__(), Jn.__init__(), Ei.__init__(), Di.__init__(), yi.__init__(), Bn.__init__(), ci.__init__(), oi.__init__(), fi.__init__(), ii.__init__(), $n.__init__(), Si.__init__(), ni.__init__(), li.__init__(), hi.__init__(), si.__init__(), _i.__init__(), ui.__init__(), Ht.__init__(), ri.defaultMaterial.lock = !0, ci.defaultMaterial.lock = !0, li.defaultMaterial.lock = !0, oi.defaultMaterial.lock = !0, fi.defaultMaterial.lock = !0, $n.defaultMaterial.lock = !0, si.defaultMaterial.lock = !0, ni.defaultMaterial.lock = !0, ii.defaultMaterial.lock = !0, di.defaultMaterial.lock = !0, hi.defaultMaterial.lock = !0, F.__init__(), Ti.__init__(), xn.__init__(), Ln.__init__(), Un.__init__(), Re.__init__(), we.__init__(), gt.__init__();
                    var i = g.createMap;
                    i.lh = ["HIERARCHY", Fn._parse], i.ls = ["HIERARCHY", Qn._parse], i.lm = ["MESH", Gn._parse], i.lmat = ["MATERIAL", Bn._parse], i.ltc = ["TEXTURECUBE", Ti._parse], i.jpg = ["TEXTURE2D", F._parse], i.jpeg = ["TEXTURE2D", F._parse], i.bmp = ["TEXTURE2D", F._parse], i.gif = ["TEXTURE2D", F._parse], i.png = ["TEXTURE2D", F._parse], i.dds = ["TEXTURE2D", F._parse], i.ktx = ["TEXTURE2D", F._parse], i.pvr = ["TEXTURE2D", F._parse], i.lani = ["ANIMATIONCLIP", kn._parse], i.lav = ["AVATAR", zn._parse], i.thdata = ["TERRAINHEIGHTDATA", Hn._pharse];
                    var r = Dt.parserMap;
                    r.HIERARCHY = P._loadHierarchy, r.MESH = P._loadMesh, r.MATERIAL = P._loadMaterial, r.TEXTURECUBE = P._loadTextureCube, r.TEXTURE2D = P._loadTexture2D, r.ANIMATIONCLIP = P._loadAnimationClip, r.AVATAR = P._loadAvatar, P._innerFirstLevelLoaderManager.on("error", null, P._eventLoadManagerError), P._innerSecondLevelLoaderManager.on("error", null, P._eventLoadManagerError), P._innerThirdLevelLoaderManager.on("error", null, P._eventLoadManagerError), P._innerFourthLevelLoaderManager.on("error", null, P._eventLoadManagerError)
                } else alert("Laya3D init error,must support webGL!")
            }, P.enableNative3D = function () {
                if (b.isConchApp) {
                    E = o.LayaGLContext;
                    var t = ot, e = Xn, n = zn, i = we, r = jn;
                    if (b.supportWebGLPlusRendering && (t.prototype._initData = t.prototype._initDataForNative, t.prototype.setBool = t.prototype.setBoolForNative, t.prototype.getBool = t.prototype.getBoolForNative, t.prototype.setInt = t.prototype.setIntForNative, t.prototype.getInt = t.prototype.getIntForNative, t.prototype.setNumber = t.prototype.setNumberForNative, t.prototype.getNumber = t.prototype.getNumberForNative, t.prototype.setVector = t.prototype.setVectorForNative, t.prototype.getVector = t.prototype.getVectorForNative, t.prototype.setVector2 = t.prototype.setVector2ForNative, t.prototype.getVector2 = t.prototype.getVector2ForNative, t.prototype.setVector3 = t.prototype.setVector3ForNative, t.prototype.getVector3 = t.prototype.getVector3ForNative, t.prototype.setQuaternion = t.prototype.setQuaternionForNative, t.prototype.getQuaternion = t.prototype.getQuaternionForNative, t.prototype.setMatrix4x4 = t.prototype.setMatrix4x4ForNative, t.prototype.getMatrix4x4 = t.prototype.getMatrix4x4ForNative, t.prototype.setBuffer = t.prototype.setBufferForNative, t.prototype.getBuffer = t.prototype.getBufferForNative, t.prototype.setTexture = t.prototype.setTextureForNative, t.prototype.getTexture = t.prototype.getTextureForNative, t.prototype.setAttribute = t.prototype.setAttributeForNative, t.prototype.getAttribute = t.prototype.getAttributeForNative, t.prototype.cloneTo = t.prototype.cloneToForNative, t.prototype.getData = t.prototype.getDataForNative, e.prototype._uniformMatrix2fv = e.prototype._uniformMatrix2fvForNative, e.prototype._uniformMatrix3fv = e.prototype._uniformMatrix3fvForNative, e.prototype._uniformMatrix4fv = e.prototype._uniformMatrix4fvForNative, r.prototype._renderUpdateWithCamera = r.prototype._renderUpdateWithCameraForNative), b.supportWebGLPlusCulling && (i.renderObjectCulling = we.renderObjectCullingNative), b.supportWebGLPlusAnimation) {
                        n.prototype._cloneDatasToAnimator = n.prototype._cloneDatasToAnimatorNative, Tn = o.conchFloatKeyframe, Cn = o.conchFloatArrayKeyframe, Vn = o.conchFloatArrayKeyframe, Se = o.conchKeyframeNode, Qt = o.conchKeyframeNodeList;
                        var a = kn;
                        a.prototype._evaluateClipDatasRealTime = a.prototype._evaluateClipDatasRealTimeForNative
                    }
                }
                N.shaderHighPrecision = !1, E.instance.getShaderPrecisionFormat(35632, 36338).precision ? N.shaderHighPrecision = !0 : N.shaderHighPrecision = !1
            }, P.formatRelativePath = function (t, e) {
                var n;
                if (n = t + e, "." === e.charAt(0)) {
                    for (var i = n.split("/"), r = 0, a = i.length; r < a; r++) if (".." == i[r]) {
                        var o = r - 1;
                        0 < o && ".." !== i[o] && (i.splice(o, 2), r -= 2)
                    }
                    n = i.join("/")
                }
                return n
            }, P._endLoad = function (t, e, n) {
                if (n) for (var i = 0, r = n.length; i < r; i++) {
                    var a = Dt.getRes(n[i]);
                    a && a._removeReference()
                }
                t.endLoad(e)
            }, P._eventLoadManagerError = function (t) {
                m.loader.event("error", t)
            }, P._addHierarchyInnerUrls = function (t, e, n, i, r, a, o, s) {
                var l = P.formatRelativePath(i, r);
                return n && (l += n), t.push({url: l, type: a, constructParams: o, propertyParams: s}), e.push(l), l
            }, P._getSprite3DHierarchyInnerUrls = function (t, e, n, i, r, a, o, s) {
                var l = 0, h = 0, u = t.props;
                switch (t.type) {
                    case"Scene3D":
                        var c = u.lightmaps;
                        for (l = 0, h = c.length; l < h; l++) {
                            var _ = c[l];
                            _.path = P._addHierarchyInnerUrls(r, a, o, s, _.path, "TEXTURE2D", _.constructParams, _.propertyParams)
                        }
                        var d = u.reflectionTexture;
                        if (d && (u.reflectionTexture = P._addHierarchyInnerUrls(i, a, o, s, d, "TEXTURECUBE")), u.sky) {
                            var f = u.sky.material;
                            f && (f.path = P._addHierarchyInnerUrls(n, a, o, s, f.path, "MATERIAL"))
                        }
                        break;
                    case"Camera":
                        var m = u.skyboxMaterial;
                        m && (m.path = P._addHierarchyInnerUrls(n, a, o, s, m.path, "MATERIAL"));
                        break;
                    case"TrailSprite3D":
                    case"MeshSprite3D":
                    case"SkinnedMeshSprite3D":
                        var p = u.meshPath;
                        p && (u.meshPath = P._addHierarchyInnerUrls(e, a, o, s, p, "MESH"));
                        var T = u.materials;
                        if (T) for (l = 0, h = T.length; l < h; l++) T[l].path = P._addHierarchyInnerUrls(n, a, o, s, T[l].path, "MATERIAL");
                        break;
                    case"ShuriKenParticle3D":
                        var E = u.meshPath;
                        E && (u.meshPath = P._addHierarchyInnerUrls(e, a, o, s, E, "MESH")), u.material.path = P._addHierarchyInnerUrls(n, a, o, s, u.material.path, "MATERIAL");
                        break;
                    case"Terrain":
                        P._addHierarchyInnerUrls(r, a, o, s, u.dataPath, "TERRAIN")
                }
                var v = t.components;
                if (v) for (var g = 0, S = v.length; g < S; g++) {
                    var y = v[g];
                    switch (y.type) {
                        case"Animator":
                            y.avatarPath;
                            var x = y.avatar;
                            x && (x.path = P._addHierarchyInnerUrls(r, a, o, s, x.path, "AVATAR"));
                            var D = y.clipPaths;
                            if (D) for (l = 0, h = D.length; l < h; l++) D[l] = P._addHierarchyInnerUrls(r, a, o, s, D[l], "ANIMATIONCLIP"); else {
                                var I = y.layers;
                                for (l = 0; l < I.length; l++) for (var R = I[l].states, M = 0, A = R.length; M < A; M++) {
                                    var C = R[M].clipPath;
                                    C && (R[M].clipPath = P._addHierarchyInnerUrls(r, a, o, s, C, "ANIMATIONCLIP"))
                                }
                            }
                            break;
                        case"PhysicsCollider":
                        case"Rigidbody3D":
                        case"CharacterController":
                            var L = y.shapes;
                            for (l = 0; l < L.length; l++) {
                                var O = L[l];
                                if ("MeshColliderShape" === O.type) {
                                    var N = O.mesh;
                                    N && (O.mesh = P._addHierarchyInnerUrls(e, a, o, s, N, "MESH"))
                                }
                            }
                    }
                }
                var V = t.child;
                for (l = 0, h = V.length; l < h; l++) P._getSprite3DHierarchyInnerUrls(V[l], e, n, i, r, a, o, s)
            }, P._loadHierarchy = function (t) {
                t.on("loaded", null, P._onHierarchylhLoaded, [t]), t.load(t.url, "json", !1, null, !0)
            }, P._onHierarchylhLoaded = function (t, e) {
                var n = t.url, i = kt.getURLVerion(n), r = O.getPath(n), a = [], o = [], s = [], l = [], h = [];
                P._getSprite3DHierarchyInnerUrls(e.data, a, o, s, l, h, i, r);
                var u = a.length + o.length + l.length, c = u + 1, _ = 1 / c;
                if (P._onProcessChange(t, 0, _, 1), 0 < l.length) {
                    var d = u / c, f = T.create(null, P._onProcessChange, [t, _, d], !1);
                    P._innerFourthLevelLoaderManager._create(l, !1, T.create(null, P._onHierarchyInnerForthLevResouLoaded, [t, f, e, h, a, o, s, _ + d * l.length, d]), f, null, null, null, 1, !0)
                } else P._onHierarchyInnerForthLevResouLoaded(t, null, e, h, a, o, s, _, d)
            }, P._onHierarchyInnerForthLevResouLoaded = function (t, e, n, i, r, a, o, s, l) {
                if (e && e.recover(), 0 < o.length) {
                    var h = T.create(null, P._onProcessChange, [t, s, l], !1);
                    P._innerThirdLevelLoaderManager._create(o, !1, T.create(null, P._onHierarchyInnerThirdLevResouLoaded, [t, h, n, i, r, a, s + l * a.length, l]), e, null, null, null, 1, !0)
                } else P._onHierarchyInnerThirdLevResouLoaded(t, null, n, i, r, a, s, l)
            }, P._onHierarchyInnerThirdLevResouLoaded = function (t, e, n, i, r, a, o, s) {
                if (e && e.recover(), 0 < a.length) {
                    var l = T.create(null, P._onProcessChange, [t, o, s], !1);
                    P._innerSecondLevelLoaderManager._create(a, !1, T.create(null, P._onHierarchyInnerSecondLevResouLoaded, [t, l, n, i, r, o + s * a.length, s]), e, null, null, null, 1, !0)
                } else P._onHierarchyInnerSecondLevResouLoaded(t, null, n, i, r, o, s)
            }, P._onHierarchyInnerSecondLevResouLoaded = function (t, e, n, i, r, a, o) {
                if (e && e.recover(), 0 < r.length) {
                    var s = T.create(null, P._onProcessChange, [t, a, o], !1);
                    P._innerFirstLevelLoaderManager._create(r, !1, T.create(null, P._onHierarchyInnerFirstLevResouLoaded, [t, s, n, i]), e, null, null, null, 1, !0)
                } else P._onHierarchyInnerFirstLevResouLoaded(t, null, n, i)
            }, P._onHierarchyInnerFirstLevResouLoaded = function (t, e, n, i) {
                e && e.recover(), t._cache = t._createCache;
                var r = "Scene3D" === n.data.type ? Qn._parse(n, t._propertyParams, t._constructParams) : Fn._parse(n, t._propertyParams, t._constructParams);
                P._endLoad(t, r, i)
            }, P._loadMesh = function (t) {
                t.on("loaded", null, P._onMeshLmLoaded, [t]), t.load(t.url, "arraybuffer", !1, null, !0)
            }, P._onMeshLmLoaded = function (t, e) {
                t._cache = t._createCache;
                var n = Gn._parse(e, t._propertyParams, t._constructParams);
                P._endLoad(t, n)
            }, P._loadMaterial = function (t) {
                t.on("loaded", null, P._onMaterilLmatLoaded, [t]), t.load(t.url, "json", !1, null, !0)
            }, P._onMaterilLmatLoaded = function (t, e) {
                var n, i = t.url, r = kt.getURLVerion(i), a = O.getPath(i), o = [], s = [];
                e.customProps;
                switch (e.version) {
                    case"LAYAMATERIAL:01":
                    case"LAYAMATERIAL:02":
                        var l = 0, h = 0, u = e.props.textures;
                        if (u) for (l = 0, h = u.length; l < h; l++) {
                            var c = u[l], _ = c.path;
                            _ && (n = P.formatRelativePath(a, _), r && (n += r), o.push({
                                url: n,
                                constructParams: c.constructParams,
                                propertyParams: c.propertyParams
                            }), s.push(n), c.path = n)
                        }
                        break;
                    default:
                        throw new Error("Laya3D:unkonwn version.")
                }
                var d = o.length, f = d + 1, m = 1 / f;
                if (P._onProcessChange(t, 0, m, 1), 0 < d) {
                    var p = T.create(null, P._onProcessChange, [t, m, d / f], !1);
                    P._innerFourthLevelLoaderManager._create(o, !1, T.create(null, P._onMateialTexturesLoaded, [t, p, e, s]), p, null, null, null, 1, !0)
                } else P._onMateialTexturesLoaded(t, null, e, null)
            }, P._onMateialTexturesLoaded = function (t, e, n, i) {
                t._cache = t._createCache;
                var r = Bn._parse(n, t._propertyParams, t._constructParams);
                P._endLoad(t, r, i), e && e.recover()
            }, P._loadAvatar = function (n) {
                n.on("loaded", null, function (t) {
                    n._cache = n._createCache;
                    var e = zn._parse(t, n._propertyParams, n._constructParams);
                    P._endLoad(n, e)
                }), n.load(n.url, "json", !1, null, !0)
            }, P._loadAnimationClip = function (n) {
                n.on("loaded", null, function (t) {
                    n._cache = n._createCache;
                    var e = kn._parse(t, n._propertyParams, n._constructParams);
                    P._endLoad(n, e)
                }), n.load(n.url, "arraybuffer", !1, null, !0)
            }, P._loadTexture2D = function (n) {
                var t, e = n.url, i = e.lastIndexOf(".") + 1, r = e.indexOf("?"), a = -1 == r ? e.length : r;
                switch (e.substr(i, a - i)) {
                    case"jpg":
                    case"jpeg":
                    case"bmp":
                    case"gif":
                    case"png":
                        t = "nativeimage";
                        break;
                    case"dds":
                    case"ktx":
                    case"pvr":
                        t = "arraybuffer"
                }
                n.on("loaded", null, function (t) {
                    n._cache = n._createCache;
                    var e = F._parse(t, n._propertyParams, n._constructParams);
                    P._endLoad(n, e)
                }), n.load(n.url, t, !1, null, !0)
            }, P._loadTextureCube = function (t) {
                t.on("loaded", null, P._onTextureCubeLtcLoaded, [t]), t.load(t.url, "json", !1, null, !0)
            }, P._onTextureCubeLtcLoaded = function (t, e) {
                var n = O.getPath(t.url),
                    i = [P.formatRelativePath(n, e.front), P.formatRelativePath(n, e.back), P.formatRelativePath(n, e.left), P.formatRelativePath(n, e.right), P.formatRelativePath(n, e.up), P.formatRelativePath(n, e.down)];
                P._onProcessChange(t, 0, 1 / 7, 1);
                var r = T.create(null, P._onProcessChange, [t, 1 / 7, 6 / 7], !1);
                P._innerFourthLevelLoaderManager.load(i, T.create(null, P._onTextureCubeImagesLoaded, [t, i, r]), r, "nativeimage")
            }, P._onTextureCubeImagesLoaded = function (t, e, n) {
                for (var i = new Array(6), r = 0; r < 6; r++) i[r] = Dt.getRes(e[r]);
                t._cache = t._createCache;
                var a = Ti._parse(i, t._propertyParams, t._constructParams);
                for (n.recover(), r = 0; r < 6; r++) Dt.clearRes(e[r]);
                P._endLoad(t, a)
            }, P._onProcessChange = function (t, e, n, i) {
                (i = e + i * n) < 1 && t.event("progress", i)
            }, P.init = function (t, e, n, i) {
                if (!P._isInit) {
                    P._isInit = !0, (n = n || ue._default).cloneTo(P._config), P._editerEnvironment = P._config._editerEnvironment;
                    var r = o.Physics3D;
                    null == r ? (P._enbalePhysics = !1, P.__init__(t, e, P._config), i && i.run()) : (P._enbalePhysics = !0, r(1024 * P._config.defaultPhysicsMemory * 1024).then(function () {
                        P.__init__(t, e, P._config), i && i.run()
                    }))
                }
            }, P.HIERARCHY = "HIERARCHY", P.MESH = "MESH", P.MATERIAL = "MATERIAL", P.TEXTURE2D = "TEXTURE2D", P.TEXTURECUBE = "TEXTURECUBE", P.ANIMATIONCLIP = "ANIMATIONCLIP", P.AVATAR = "AVATAR", P.TERRAINHEIGHTDATA = "TERRAINHEIGHTDATA", P.TERRAINRES = "TERRAIN", P._isInit = !1, P._enbalePhysics = !1, P._editerEnvironment = !1, _(P, ["_innerFirstLevelLoaderManager", function () {
                return this._innerFirstLevelLoaderManager = new g
            }, "_innerSecondLevelLoaderManager", function () {
                return this._innerSecondLevelLoaderManager = new g
            }, "_innerThirdLevelLoaderManager", function () {
                return this._innerThirdLevelLoaderManager = new g
            }, "_innerFourthLevelLoaderManager", function () {
                return this._innerFourthLevelLoaderManager = new g
            }, "_physics3D", function () {
                return this._physics3D = o.Physics3D
            }, "_config", function () {
                return this._config = new ue
            }, "physicsSettings", function () {
                return this.physicsSettings = new et
            }]), P
        }(), Rt = function () {
            function i() {
                this._type = 0, this._constant = 0, this._overTime = null, this._constantMin = 0, this._constantMax = 0, this._overTimeMin = null, this._overTimeMax = null
            }

            d(i, "laya.d3.core.particleShuriKen.module.FrameOverTime");
            var t = i.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.cloneTo = function (t) {
                var e = t;
                e._type = this._type, e._constant = this._constant, this._overTime.cloneTo(e._overTime), e._constantMin = this._constantMin, e._constantMax = this._constantMax, this._overTimeMin.cloneTo(e._overTimeMin), this._overTimeMax.cloneTo(e._overTimeMax)
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, t, "frameOverTimeData", function () {
                return this._overTime
            }), u(0, t, "constant", function () {
                return this._constant
            }), u(0, t, "type", function () {
                return this._type
            }), u(0, t, "frameOverTimeDataMin", function () {
                return this._overTimeMin
            }), u(0, t, "constantMin", function () {
                return this._constantMin
            }), u(0, t, "frameOverTimeDataMax", function () {
                return this._overTimeMax
            }), u(0, t, "constantMax", function () {
                return this._constantMax
            }), i.createByConstant = function (t) {
                var e = new i;
                return e._type = 0, e._constant = t, e
            }, i.createByOverTime = function (t) {
                var e = new i;
                return e._type = 1, e._overTime = t, e
            }, i.createByRandomTwoConstant = function (t, e) {
                var n = new i;
                return n._type = 2, n._constantMin = t, n._constantMax = e, n
            }, i.createByRandomTwoOverTime = function (t, e) {
                var n = new i;
                return n._type = 3, n._overTimeMin = t, n._overTimeMax = e, n
            }, i
        }(), X = function () {
            function t() {
                this.cull = 0, this.blend = 0, this.srcBlend = 0, this.dstBlend = 0, this.srcBlendRGB = 0, this.dstBlendRGB = 0, this.srcBlendAlpha = 0, this.dstBlendAlpha = 0, this.blendConstColor = null, this.blendEquation = 0, this.blendEquationRGB = 0, this.blendEquationAlpha = 0, this.depthTest = 0, this.depthWrite = !1, this.cull = 2, this.blend = 0, this.srcBlend = 1, this.dstBlend = 0, this.srcBlendRGB = 1, this.dstBlendRGB = 0, this.srcBlendAlpha = 1, this.dstBlendAlpha = 0, this.blendConstColor = new Ct(1, 1, 1, 1), this.blendEquation = 0, this.blendEquationRGB = 0, this.blendEquationAlpha = 0, this.depthTest = 515, this.depthWrite = !0
            }

            d(t, "laya.d3.core.material.RenderState");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.cloneTo = function (t) {
                var e = t;
                e.cull = this.cull, e.blend = this.blend, e.srcBlend = this.srcBlend, e.dstBlend = this.dstBlend, e.srcBlendRGB = this.srcBlendRGB, e.dstBlendRGB = this.dstBlendRGB, e.srcBlendAlpha = this.srcBlendAlpha, e.dstBlendAlpha = this.dstBlendAlpha, this.blendConstColor.cloneTo(e.blendConstColor), e.blendEquation = this.blendEquation, e.blendEquationRGB = this.blendEquationRGB, e.blendEquationAlpha = this.blendEquationAlpha, e.depthTest = this.depthTest, e.depthWrite = this.depthWrite
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t.CULL_NONE = 0, t.CULL_FRONT = 1, t.CULL_BACK = 2, t.BLEND_DISABLE = 0, t.BLEND_ENABLE_ALL = 1, t.BLEND_ENABLE_SEPERATE = 2, t.BLENDPARAM_ZERO = 0, t.BLENDPARAM_ONE = 1, t.BLENDPARAM_SRC_COLOR = 768, t.BLENDPARAM_ONE_MINUS_SRC_COLOR = 769, t.BLENDPARAM_DST_COLOR = 774, t.BLENDPARAM_ONE_MINUS_DST_COLOR = 775, t.BLENDPARAM_SRC_ALPHA = 770, t.BLENDPARAM_ONE_MINUS_SRC_ALPHA = 771, t.BLENDPARAM_DST_ALPHA = 772, t.BLENDPARAM_ONE_MINUS_DST_ALPHA = 773, t.BLENDPARAM_SRC_ALPHA_SATURATE = 776, t.BLENDEQUATION_ADD = 0, t.BLENDEQUATION_SUBTRACT = 1, t.BLENDEQUATION_REVERSE_SUBTRACT = 2, t.DEPTHTEST_OFF = 0, t.DEPTHTEST_NEVER = 512, t.DEPTHTEST_LESS = 513, t.DEPTHTEST_EQUAL = 514, t.DEPTHTEST_LEQUAL = 515, t.DEPTHTEST_GREATER = 516, t.DEPTHTEST_NOTEQUAL = 517, t.DEPTHTEST_GEQUAL = 518, t.DEPTHTEST_ALWAYS = 519, t
        }(), W = function () {
            function t(t, e) {
                this.origin = null, this.direction = null, this.origin = t, this.direction = e
            }

            return d(t, "laya.d3.math.Ray"), t
        }(), Y = function () {
            function t() {
                this._idCounter = 0, this.colliderA = null, this.colliderB = null, this.distance = 0, this.normal = new Lt, this.positionOnA = new Lt, this.positionOnB = new Lt, this._id = ++this._idCounter
            }

            return d(t, "laya.d3.physics.ContactPoint"), t
        }(), Z = function () {
            function s() {
                this._initBatchSprites = [], this._staticBatches = {}, this._batchRenderElementPoolIndex = 0, this._batchRenderElementPool = []
            }

            d(s, "laya.d3.graphics.StaticBatchManager");
            var t = s.prototype;
            return t._partition = function (t, e, n) {
                for (var i = t[Math.floor((n + e) / 2)]; e <= n;) {
                    for (; this._compare(t[e], i) < 0;) e++;
                    for (; 0 < this._compare(t[n], i);) n--;
                    if (e < n) {
                        var r = t[e];
                        t[e] = t[n], t[n] = r, e++, n--
                    } else if (e === n) {
                        e++;
                        break
                    }
                }
                return e
            }, t._quickSort = function (t, e, n) {
                if (1 < t.length) {
                    var i = this._partition(t, e, n), r = i - 1;
                    e < r && this._quickSort(t, e, r), i < n && this._quickSort(t, i, n)
                }
            }, t._compare = function (t, e) {
                throw"StaticBatch:must override this function."
            }, t._initStaticBatchs = function (t) {
                throw"StaticBatch:must override this function."
            }, t._getBatchRenderElementFromPool = function () {
                throw"StaticBatch:must override this function."
            }, t._addBatchSprite = function (t) {
                this._initBatchSprites.push(t)
            }, t._clear = function () {
                this._batchRenderElementPoolIndex = 0
            }, t._garbageCollection = function () {
                throw"StaticBatchManager: must override it."
            }, t.dispose = function () {
                this._staticBatches = null
            }, s._registerManager = function (t) {
                s._managers.push(t)
            }, s._addToStaticBatchQueue = function (t, e) {
                t instanceof laya.d3.core.RenderableSprite3D && t.isStatic && e.push(t);
                for (var n = 0, i = t.numChildren; n < i; n++) s._addToStaticBatchQueue(t._children[n], e)
            }, s.combine = function (t, e) {
                e || (e = [], t && s._addToStaticBatchQueue(t, e));
                var n = e.length;
                if (0 < n) {
                    for (var i = 0; i < n; i++) {
                        var r = e[i];
                        r.isStatic && r._addToInitStaticBatchManager()
                    }
                    for (var a = 0, o = s._managers.length; a < o; a++) {
                        s._managers[a]._initStaticBatchs(t)
                    }
                }
            }, s._managers = [], s
        }(), j = function () {
            function t() {
            }

            d(t, "laya.d3.core.render.command.Command");
            var e = t.prototype;
            return e.run = function () {
            }, e.recover = function () {
            }, t
        }(), K = function () {
            function t() {
            }

            return d(t, "laya.d3.core.render.RenderContext3D"), t.clientWidth = 0, t.clientHeight = 0, _(t, ["_instance", function () {
                return this._instance = new t
            }]), t
        }(), q = (function () {
            function t() {
            }

            d(t, "laya.d3.core.GradientMode"), t.Blend = 0, t.Fixed = 1
        }(), function () {
            function t() {
                this.length = 0, this.elements = []
            }

            return d(t, "laya.d3.component.SingletonList"), t.prototype._add = function (t) {
                this.length === this.elements.length ? this.elements.push(t) : this.elements[this.length] = t
            }, t
        }()), Q = function () {
            function e() {
                this._batchRenderElementPool = []
            }

            d(e, "laya.d3.graphics.DynamicBatchManager");
            var t = e.prototype;
            return t._clear = function () {
                this._batchRenderElementPoolIndex = 0
            }, t._getBatchRenderElementFromPool = function () {
                throw"StaticBatch:must override this function."
            }, t.dispose = function () {
            }, e._registerManager = function (t) {
                e._managers.push(t)
            }, e._managers = [], e
        }(), J = (function () {
            function t() {
                this._damping = NaN, this._impulseClamp = NaN, this._tau = NaN, this._pivotInA = new Lt, this._pivotInB = new Lt
            }

            d(t, "laya.d3.physics.constraints.Point2PointConstraint");
            var e = t.prototype;
            u(0, e, "pivotInA", function () {
                return this._pivotInA
            }, function (t) {
                this._pivotInA = t
            }), u(0, e, "pivotInB", function () {
                return this._pivotInB
            }, function (t) {
                this._pivotInB = t
            }), u(0, e, "damping", function () {
                return this._damping
            }, function (t) {
                this._damping = t
            }), u(0, e, "impulseClamp", function () {
                return this._impulseClamp
            }, function (t) {
                this._impulseClamp = t
            }), u(0, e, "tau", function () {
                return this._tau
            }, function (t) {
                this._tau = t
            })
        }(), function () {
            function t() {
                this._destroyed = !1
            }

            d(t, "laya.d3.core.GeometryElement");
            var e = t.prototype;
            return m.imps(e, {"laya.resource.IDestroy": !0}), e._getType = function () {
                throw"GeometryElement:must override it."
            }, e._prepareRender = function (t) {
                return !0
            }, e._render = function (t) {
                throw"GeometryElement:must override it."
            }, e.destroy = function () {
                this._destroyed || (this._destroyed = !0)
            }, u(0, e, "destroyed", function () {
                return this._destroyed
            }), t._typeCounter = 0, t
        }()), $ = function () {
            function t(t, e) {
                this._position = null, this._textureCoordinate0 = null, this._position = t, this._textureCoordinate0 = e
            }

            d(t, "laya.d3.graphics.Vertex.VertexPositionTexture0");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.graphics.IVertex": !0}), u(0, e, "position", function () {
                return this._position
            }), u(0, e, "textureCoordinate0", function () {
                return this._textureCoordinate0
            }), u(0, e, "vertexDeclaration", function () {
                return t._vertexDeclaration
            }), u(1, t, "vertexDeclaration", function () {
                return t._vertexDeclaration
            }), _(t, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(20, [new zt(0, "vector3", 0), new zt(12, "vector2", 2)])
            }]), t
        }(), tt = function () {
            function n() {
            }

            return d(n, "laya.d3.math.MathUtils3D"), n.isZero = function (t) {
                return Math.abs(t) < n.zeroTolerance
            }, n.nearEqual = function (t, e) {
                return !!n.isZero(t - e)
            }, n.fastInvSqrt = function (t) {
                return n.isZero(t) ? t : 1 / Math.sqrt(t)
            }, _(n, ["zeroTolerance", function () {
                return this.zeroTolerance = 1e-6
            }, "MaxValue", function () {
                return this.MaxValue = 340282347e30
            }, "MinValue", function () {
                return this.MinValue = -340282347e30
            }]), n
        }(), Mt = function () {
            function i() {
                this._type = 0, this._constant = null, this._constantMin = null, this._constantMax = null, this._gradient = null, this._gradientMin = null, this._gradientMax = null
            }

            d(i, "laya.d3.core.particleShuriKen.module.GradientColor");
            var t = i.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.cloneTo = function (t) {
                var e = t;
                e._type = this._type, this._constant.cloneTo(e._constant), this._constantMin.cloneTo(e._constantMin), this._constantMax.cloneTo(e._constantMax), this._gradient.cloneTo(e._gradient), this._gradientMin.cloneTo(e._gradientMin), this._gradientMax.cloneTo(e._gradientMax)
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, t, "gradient", function () {
                return this._gradient
            }), u(0, t, "constant", function () {
                return this._constant
            }), u(0, t, "type", function () {
                return this._type
            }), u(0, t, "gradientMin", function () {
                return this._gradientMin
            }), u(0, t, "constantMin", function () {
                return this._constantMin
            }), u(0, t, "gradientMax", function () {
                return this._gradientMax
            }), u(0, t, "constantMax", function () {
                return this._constantMax
            }), i.createByConstant = function (t) {
                var e = new i;
                return e._type = 0, e._constant = t, e
            }, i.createByGradient = function (t) {
                var e = new i;
                return e._type = 1, e._gradient = t, e
            }, i.createByRandomTwoConstant = function (t, e) {
                var n = new i;
                return n._type = 2, n._constantMin = t, n._constantMax = e, n
            }, i.createByRandomTwoGradient = function (t, e) {
                var n = new i;
                return n._type = 3, n._gradientMin = t, n._gradientMax = e, n
            }, i
        }(), et = (function () {
            function t(t, e) {
                this._width = 0, this._height = 0, this._width = t, this._height = e
            }

            d(t, "laya.d3.utils.Size");
            var e = t.prototype;
            u(0, e, "width", function () {
                return -1 === this._width ? K.clientWidth : this._width
            }), u(0, e, "height", function () {
                return -1 === this._height ? K.clientHeight : this._height
            }), u(1, t, "fullScreen", function () {
                return new t(-1, -1)
            })
        }(), function () {
            function t() {
                this.flags = 0, this.maxSubSteps = 1, this.fixedTimeStep = 1 / 60
            }

            return d(t, "laya.d3.physics.PhysicsSettings"), t
        }()), nt = function () {
            function T(t, e) {
                this.normal = null, this.distance = NaN, void 0 === e && (e = 0), this.normal = t, this.distance = e
            }

            return d(T, "laya.d3.math.Plane"), T.prototype.normalize = function () {
                var t = this.normal.x, e = this.normal.y, n = this.normal.z, i = 1 / Math.sqrt(t * t + e * e + n * n);
                this.normal.x = t * i, this.normal.y = e * i, this.normal.z = n * i, this.distance *= i
            }, T.createPlaneBy3P = function (t, e, n) {
                var i = e.x - t.x, r = e.y - t.y, a = e.z - t.z, o = n.x - t.x, s = n.y - t.y, l = n.z - t.z,
                    h = r * l - a * s, u = a * o - i * l, c = i * s - r * o, _ = 1 / Math.sqrt(h * h + u * u + c * c),
                    d = h * _, f = u * _, m = c * _;
                T._TEMPVec3.x = d, T._TEMPVec3.y = f, T._TEMPVec3.z = m;
                var p = -(d * t.x + f * t.y + m * t.z);
                return new T(T._TEMPVec3, p)
            }, T.PlaneIntersectionType_Back = 0, T.PlaneIntersectionType_Front = 1, T.PlaneIntersectionType_Intersecting = 2, _(T, ["_TEMPVec3", function () {
                return this._TEMPVec3 = new Lt
            }]), T
        }(), it = function () {
            function t() {
                this.ambientColor = null, this.diffuseColor = null, this.specularColor = null
            }

            return d(t, "laya.d3.terrain.unit.MaterialInfo"), t
        }(), rt = function () {
            function e(t, e) {
                this._mode = 0, this._maxColorRGBKeysCount = 0, this._maxColorAlphaKeysCount = 0, this._colorRGBKeysCount = 0, this._colorAlphaKeysCount = 0, this._alphaElements = null, this._rgbElements = null, this._maxColorRGBKeysCount = t, this._maxColorAlphaKeysCount = e, this._rgbElements = new Float32Array(4 * t), this._alphaElements = new Float32Array(2 * e)
            }

            d(e, "laya.d3.core.Gradient");
            var t = e.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.addColorRGB = function (t, e) {
                if (this._colorRGBKeysCount < this._maxColorRGBKeysCount) {
                    var n = 4 * this._colorRGBKeysCount;
                    this._rgbElements[n] = t, this._rgbElements[n + 1] = e.r, this._rgbElements[n + 2] = e.g, this._rgbElements[n + 3] = e.b, this._colorRGBKeysCount++
                }
            }, t.addColorAlpha = function (t, e) {
                if (this._colorAlphaKeysCount < this._maxColorAlphaKeysCount) {
                    var n = 2 * this._colorAlphaKeysCount;
                    this._alphaElements[n] = t, this._alphaElements[n + 1] = e, this._colorAlphaKeysCount++
                }
            }, t.updateColorRGB = function (t, e, n) {
                if (t < this._colorRGBKeysCount) {
                    var i = 4 * t;
                    this._rgbElements[i] = e, this._rgbElements[i + 1] = n.r, this._rgbElements[i + 2] = n.g, this._rgbElements[i + 3] = n.b
                }
            }, t.updateColorAlpha = function (t, e, n) {
                if (t < this._colorAlphaKeysCount) {
                    var i = 2 * t;
                    this._alphaElements[i] = e, this._alphaElements[i + 1] = n
                }
            }, t.cloneTo = function (t) {
                var e = t, n = 0, i = 0;
                e._colorAlphaKeysCount = this._colorAlphaKeysCount;
                var r = e._alphaElements;
                for (r.length = this._alphaElements.length, n = 0, i = this._alphaElements.length; n < i; n++) r[n] = this._alphaElements[n];
                e._colorRGBKeysCount = this._colorRGBKeysCount;
                var a = e._rgbElements;
                for (a.length = this._rgbElements.length, n = 0, i = this._rgbElements.length; n < i; n++) a[n] = this._rgbElements[n]
            }, t.clone = function () {
                var t = new e(this._maxColorRGBKeysCount, this._maxColorAlphaKeysCount);
                return this.cloneTo(t), t
            }, u(0, t, "colorRGBKeysCount", function () {
                return this._colorRGBKeysCount / 4
            }), u(0, t, "mode", function () {
                return this._mode
            }, function (t) {
                this._mode = t
            }), u(0, t, "colorAlphaKeysCount", function () {
                return this._colorAlphaKeysCount / 2
            }), u(0, t, "maxColorRGBKeysCount", function () {
                return this._maxColorRGBKeysCount
            }), u(0, t, "maxColorAlphaKeysCount", function () {
                return this._maxColorAlphaKeysCount
            }), e
        }(), at = function () {
            function a(t, e, n, i, r) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === n && (n = 0), void 0 === i && (i = 1), this.x = t, this.y = e, this.z = n, this.w = i
            }

            d(a, "laya.d3.math.Quaternion");
            var t = a.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.scaling = function (t, e) {
                e.x = this.x * t, e.y = this.y * t, e.z = this.z * t, e.w = this.w * t
            }, t.normalize = function (t) {
                var e = this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;
                0 < e && (e = 1 / Math.sqrt(e), t.x = this.x * e, t.y = this.y * e, t.z = this.z * e, t.w = this.w * e)
            }, t.length = function () {
                return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w)
            }, t.rotateX = function (t, e) {
                t *= .5;
                var n = Math.sin(t), i = Math.cos(t);
                e.x = this.x * i + this.w * n, e.y = this.y * i + this.z * n, e.z = this.z * i - this.y * n, e.w = this.w * i - this.x * n
            }, t.rotateY = function (t, e) {
                t *= .5;
                var n = Math.sin(t), i = Math.cos(t);
                e.x = this.x * i - this.z * n, e.y = this.y * i + this.w * n, e.z = this.z * i + this.x * n, e.w = this.w * i - this.y * n
            }, t.rotateZ = function (t, e) {
                t *= .5;
                var n = Math.sin(t), i = Math.cos(t);
                e.x = this.x * i + this.y * n, e.y = this.y * i - this.x * n, e.z = this.z * i + this.w * n, e.w = this.w * i - this.z * n
            }, t.getYawPitchRoll = function (t) {
                Lt.transformQuat(Lt._ForwardRH, this, a.TEMPVector31), Lt.transformQuat(Lt._Up, this, a.TEMPVector32);
                var e = a.TEMPVector32;
                a.angleTo(Lt._ZERO, a.TEMPVector31, a.TEMPVector33);
                var n = a.TEMPVector33;
                n.x == Math.PI / 2 ? (n.y = a.arcTanAngle(e.z, e.x), n.z = 0) : n.x == -Math.PI / 2 ? (n.y = a.arcTanAngle(-e.z, -e.x), n.z = 0) : (He.createRotationY(-n.y, a.TEMPMatrix0), He.createRotationX(-n.x, a.TEMPMatrix1), Lt.transformCoordinate(a.TEMPVector32, a.TEMPMatrix0, a.TEMPVector32), Lt.transformCoordinate(a.TEMPVector32, a.TEMPMatrix1, a.TEMPVector32), n.z = a.arcTanAngle(e.y, -e.x)), n.y <= -Math.PI && (n.y = Math.PI), n.z <= -Math.PI && (n.z = Math.PI), n.y >= Math.PI && n.z >= Math.PI && (n.y = 0, n.z = 0, n.x = Math.PI - n.x);
                var i = t;
                i.x = n.y, i.y = n.x, i.z = n.z
            }, t.invert = function (t) {
                var e = this.x, n = this.y, i = this.z, r = this.w, a = e * e + n * n + i * i + r * r,
                    o = a ? 1 / a : 0;
                t.x = -e * o, t.y = -n * o, t.z = -i * o, t.w = r * o
            }, t.identity = function () {
                this.x = 0, this.y = 0, this.z = 0, this.w = 1
            }, t.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.x = t[e + 0], this.y = t[e + 1], this.z = t[e + 2], this.w = t[e + 3]
            }, t.cloneTo = function (t) {
                this !== t && (t.x = this.x, t.y = this.y, t.z = this.z, t.w = this.w)
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t.equals = function (t) {
                return tt.nearEqual(this.x, t.x) && tt.nearEqual(this.y, t.y) && tt.nearEqual(this.z, t.z) && tt.nearEqual(this.w, t.w)
            }, t.lengthSquared = function () {
                return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w
            }, t.forNativeElement = function (t) {
                t ? (this.elements = t, this.elements[0] = this.x, this.elements[1] = this.y, this.elements[2] = this.z, this.elements[3] = this.w) : this.elements = new Float32Array([this.x, this.y, this.z, this.w]), Ot.rewriteNumProperty(this, "x", 0), Ot.rewriteNumProperty(this, "y", 1), Ot.rewriteNumProperty(this, "z", 2), Ot.rewriteNumProperty(this, "w", 3)
            }, a.createFromYawPitchRoll = function (t, e, n, i) {
                var r = .5 * n, a = .5 * e, o = .5 * t, s = Math.sin(r), l = Math.cos(r), h = Math.sin(a),
                    u = Math.cos(a), c = Math.sin(o), _ = Math.cos(o);
                i.x = _ * h * l + c * u * s, i.y = c * u * l - _ * h * s, i.z = _ * u * s - c * h * l, i.w = _ * u * l + c * h * s
            }, a.multiply = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z, o = t.w, s = e.x, l = e.y, h = e.z, u = e.w, c = r * h - a * l,
                    _ = a * s - i * h, d = i * l - r * s, f = i * s + r * l + a * h;
                n.x = i * u + s * o + c, n.y = r * u + l * o + _, n.z = a * u + h * o + d, n.w = o * u - f
            }, a.arcTanAngle = function (t, e) {
                return 0 == t ? 1 == e ? Math.PI / 2 : -Math.PI / 2 : 0 < t ? Math.atan(e / t) : t < 0 ? 0 < e ? Math.atan(e / t) + Math.PI : Math.atan(e / t) - Math.PI : 0
            }, a.angleTo = function (t, e, n) {
                Lt.subtract(e, t, a.TEMPVector30), Lt.normalize(a.TEMPVector30, a.TEMPVector30), n.x = Math.asin(a.TEMPVector30.y), n.y = a.arcTanAngle(-a.TEMPVector30.z, -a.TEMPVector30.x)
            }, a.createFromAxisAngle = function (t, e, n) {
                e *= .5;
                var i = Math.sin(e);
                n.x = i * t.x, n.y = i * t.y, n.z = i * t.z, n.w = Math.cos(e)
            }, a.createFromMatrix4x4 = function (t, e) {
                var n, i, r = t.elements, a = r[0] + r[5] + r[10];
                0 < a ? (n = Math.sqrt(a + 1), e.w = .5 * n, n = .5 / n, e.x = (r[6] - r[9]) * n, e.y = (r[8] - r[2]) * n, e.z = (r[1] - r[4]) * n) : r[0] >= r[5] && r[0] >= r[10] ? (i = .5 / (n = Math.sqrt(1 + r[0] - r[5] - r[10])), e.x = .5 * n, e.y = (r[1] + r[4]) * i, e.z = (r[2] + r[8]) * i, e.w = (r[6] - r[9]) * i) : r[5] > r[10] ? (i = .5 / (n = Math.sqrt(1 + r[5] - r[0] - r[10])), e.x = (r[4] + r[1]) * i, e.y = .5 * n, e.z = (r[9] + r[6]) * i, e.w = (r[8] - r[2]) * i) : (i = .5 / (n = Math.sqrt(1 + r[10] - r[0] - r[5])), e.x = (r[8] + r[2]) * i, e.y = (r[9] + r[6]) * i, e.z = .5 * n, e.w = (r[1] - r[4]) * i)
            }, a.slerp = function (t, e, n, i) {
                var r, a, o, s, l, h = t.x, u = t.y, c = t.z, _ = t.w, d = e.x, f = e.y, m = e.z, p = e.w;
                return (a = h * d + u * f + c * m + _ * p) < 0 && (a = -a, d = -d, f = -f, m = -m, p = -p), l = 1e-6 < 1 - a ? (r = Math.acos(a), o = Math.sin(r), s = Math.sin((1 - n) * r) / o, Math.sin(n * r) / o) : (s = 1 - n, n), i.x = s * h + l * d, i.y = s * u + l * f, i.z = s * c + l * m, i.w = s * _ + l * p, i
            }, a.lerp = function (t, e, n, i) {
                var r = 1 - n;
                0 <= a.dot(t, e) ? (i.x = r * t.x + n * e.x, i.y = r * t.y + n * e.y, i.z = r * t.z + n * e.z, i.w = r * t.w + n * e.w) : (i.x = r * t.x - n * e.x, i.y = r * t.y - n * e.y, i.z = r * t.z - n * e.z, i.w = r * t.w - n * e.w), i.normalize(i)
            }, a.add = function (t, e, n) {
                n.x = t.x + e.x, n.y = t.y + e.y, n.z = t.z + e.z, n.w = t.w + e.w
            }, a.dot = function (t, e) {
                return t.x * e.x + t.y * e.y + t.z * e.z + t.w * e.w
            }, a.rotationLookAt = function (t, e, n) {
                a.lookAt(Lt._ZERO, t, e, n)
            }, a.lookAt = function (t, e, n, i) {
                Be.lookAt(t, e, n, a._tempMatrix3x3), a.rotationMatrix(a._tempMatrix3x3, i)
            }, a.invert = function (t, e) {
                var n = t.lengthSquared();
                tt.isZero(n) || (n = 1 / n, e.x = -t.x * n, e.y = -t.y * n, e.z = -t.z * n, e.w = t.w * n)
            }, a.rotationMatrix = function (t, e) {
                var n = t.elements, i = n[0], r = n[1], a = n[2], o = n[3], s = n[4], l = n[5], h = n[6], u = n[7],
                    c = n[8], _ = NaN, d = NaN, f = i + s + c;
                0 < f ? (_ = Math.sqrt(f + 1), e.w = .5 * _, _ = .5 / _, e.x = (l - u) * _, e.y = (h - a) * _, e.z = (r - o) * _) : e.w = s <= i && c <= i ? (d = .5 / (_ = Math.sqrt(1 + i - s - c)), e.x = .5 * _, e.y = (r + o) * d, e.z = (a + h) * d, (l - u) * d) : c < s ? (d = .5 / (_ = Math.sqrt(1 + s - i - c)), e.x = (o + r) * d, e.y = .5 * _, e.z = (u + l) * d, (h - a) * d) : (d = .5 / (_ = Math.sqrt(1 + c - i - s)), e.x = (h + a) * d, e.y = (u + l) * d, e.z = .5 * _, (r - o) * d)
            }, a.DEFAULT = new a, _(a, ["TEMPVector30", function () {
                return this.TEMPVector30 = new Lt
            }, "TEMPVector31", function () {
                return this.TEMPVector31 = new Lt
            }, "TEMPVector32", function () {
                return this.TEMPVector32 = new Lt
            }, "TEMPVector33", function () {
                return this.TEMPVector33 = new Lt
            }, "TEMPMatrix0", function () {
                return this.TEMPMatrix0 = new He
            }, "TEMPMatrix1", function () {
                return this.TEMPMatrix1 = new He
            }, "_tempMatrix3x3", function () {
                return this._tempMatrix3x3 = new Be
            }, "NAN", function () {
                return this.NAN = new a(NaN, NaN, NaN, NaN)
            }]), a
        }(), ot = function () {
            function i(t) {
                this._ownerResource = null, this._data = null, this._int32Data = null, this._float32Data = null, this._nativeArray = null, this._frameCount = 0, this._runtimeCopyValues = [], this._ownerResource = t, this._initData()
            }

            d(i, "laya.d3.shader.ShaderData");
            var t = i.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t._initData = function () {
                this._data = new Object
            }, t.getData = function () {
                return this._data
            }, t.getBool = function (t) {
                return this._data[t]
            }, t.setBool = function (t, e) {
                this._data[t] = e
            }, t.getInt = function (t) {
                return this._data[t]
            }, t.setInt = function (t, e) {
                this._data[t] = e
            }, t.getNumber = function (t) {
                return this._data[t]
            }, t.setNumber = function (t, e) {
                this._data[t] = e
            }, t.getVector2 = function (t) {
                return this._data[t]
            }, t.setVector2 = function (t, e) {
                this._data[t] = e
            }, t.getVector3 = function (t) {
                return this._data[t]
            }, t.setVector3 = function (t, e) {
                this._data[t] = e
            }, t.getVector = function (t) {
                return this._data[t]
            }, t.setVector = function (t, e) {
                this._data[t] = e
            }, t.getQuaternion = function (t) {
                return this._data[t]
            }, t.setQuaternion = function (t, e) {
                this._data[t] = e
            }, t.getMatrix4x4 = function (t) {
                return this._data[t]
            }, t.setMatrix4x4 = function (t, e) {
                this._data[t] = e
            }, t.getBuffer = function (t) {
                return this._data[t]
            }, t.setBuffer = function (t, e) {
                this._data[t] = e
            }, t.setTexture = function (t, e) {
                var n = this._data[t];
                this._data[t] = e, this._ownerResource && 0 < this._ownerResource.referenceCount && (n && n._removeReference(), e && e._addReference())
            }, t.getTexture = function (t) {
                return this._data[t]
            }, t.setAttribute = function (t, e) {
                this._data[t] = e
            }, t.getAttribute = function (t) {
                return this._data[t]
            }, t.getLength = function () {
                return this._data.length
            }, t.setLength = function (t) {
                this._data.length = t
            }, t.cloneTo = function (t) {
                var e = t._data;
                for (var n in this._data) {
                    var i = this._data[n];
                    if (null != i) if ("number" == typeof i) e[n] = i; else if ("number" == typeof i && Math.floor(i) == i) e[n] = i; else if ("boolean" == typeof i) e[n] = i; else if (i instanceof laya.d3.math.Vector2) {
                        var r = e[n] || (e[n] = new Ot);
                        i.cloneTo(r), e[n] = r
                    } else if (i instanceof laya.d3.math.Vector3) {
                        var a = e[n] || (e[n] = new Lt);
                        i.cloneTo(a), e[n] = a
                    } else if (i instanceof laya.d3.math.Vector4) {
                        var o = e[n] || (e[n] = new Ct);
                        i.cloneTo(o), e[n] = o
                    } else if (i instanceof laya.d3.math.Matrix4x4) {
                        var s = e[n] || (e[n] = new He);
                        i.cloneTo(s), e[n] = s
                    } else i instanceof laya.resource.BaseTexture && (e[n] = i)
                }
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t.cloneToForNative = function (t) {
                var e = t;
                0 < this._int32Data.length - e._int32Data.length && e.needRenewArrayBufferForNative(this._int32Data.length), e._int32Data.set(this._int32Data, 0);
                var n = e._nativeArray, i = this._nativeArray.length;
                n.length = i;
                for (var r = 0; r < i; r++) {
                    var a = this._nativeArray[r];
                    if (a) if ("number" == typeof a) n[r] = a, e.setNumber(r, a); else if ("number" == typeof a && Math.floor(a) == a) n[r] = a, e.setInt(r, a); else if ("boolean" == typeof a) n[r] = a, e.setBool(r, a); else if (a instanceof laya.d3.math.Vector2) {
                        var o = n[r] || (n[r] = new Ot);
                        a.cloneTo(o), n[r] = o, e.setVector2(r, o)
                    } else if (a instanceof laya.d3.math.Vector3) {
                        var s = n[r] || (n[r] = new Lt);
                        a.cloneTo(s), n[r] = s, e.setVector3(r, s)
                    } else if (a instanceof laya.d3.math.Vector4) {
                        var l = n[r] || (n[r] = new Ct);
                        a.cloneTo(l), n[r] = l, e.setVector(r, l)
                    } else if (a instanceof laya.d3.math.Matrix4x4) {
                        var h = n[r] || (n[r] = new He);
                        a.cloneTo(h), n[r] = h, e.setMatrix4x4(r, h)
                    } else a instanceof laya.resource.BaseTexture && (n[r] = a, e.setTexture(r, a))
                }
            }, t._initDataForNative = function () {
                this._frameCount = -1, this._runtimeCopyValues.length = 0, this._nativeArray = [], this._data = new ArrayBuffer(32), this._int32Data = new Int32Array(this._data), this._float32Data = new Float32Array(this._data), E.createArrayBufferRef(this._data, 0, !0)
            }, t.needRenewArrayBufferForNative = function (t) {
                if (t >= this._int32Data.length) {
                    var e = 4 * (t + 1), n = this._int32Data, i = this._data.conchRef, r = this._data._ptrID;
                    this._data = new ArrayBuffer(e), this._int32Data = new Int32Array(this._data), this._float32Data = new Float32Array(this._data), this._data.conchRef = i, this._data._ptrID = r, n && this._int32Data.set(n, 0), conch.updateArrayBufferRef(this._data._ptrID, i.isSyncToRender(), this._data)
                }
            }, t.getDataForNative = function () {
                return this._nativeArray
            }, t.getIntForNative = function (t) {
                return this._int32Data[t]
            }, t.setIntForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._int32Data[t] = e, this._nativeArray[t] = e
            }, t.getBoolForNative = function (t) {
                return 1 == this._int32Data[t]
            }, t.setBoolForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._int32Data[t] = e, this._nativeArray[t] = e
            }, t.getNumberForNative = function (t) {
                return this._float32Data[t]
            }, t.setNumberForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._float32Data[t] = e, this._nativeArray[t] = e
            }, t.getMatrix4x4ForNative = function (t) {
                return this._nativeArray[t]
            }, t.setMatrix4x4ForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._nativeArray[t] = e;
                var n = this.setReferenceForNative(e.elements);
                this._int32Data[t] = n
            }, t.getVectorForNative = function (t) {
                return this._nativeArray[t]
            }, t.setVectorForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), (this._nativeArray[t] = e).elements || e.forNativeElement();
                var n = this.setReferenceForNative(e.elements);
                this._int32Data[t] = n
            }, t.getVector2ForNative = function (t) {
                return this._nativeArray[t]
            }, t.setVector2ForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), (this._nativeArray[t] = e).elements || e.forNativeElement();
                var n = this.setReferenceForNative(e.elements);
                this._int32Data[t] = n
            }, t.getVector3ForNative = function (t) {
                return this._nativeArray[t]
            }, t.setVector3ForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), (this._nativeArray[t] = e).elements || e.forNativeElement();
                var n = this.setReferenceForNative(e.elements);
                this._int32Data[t] = n
            }, t.getQuaternionForNative = function (t) {
                return this._nativeArray[t]
            }, t.setQuaternionForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), (this._nativeArray[t] = e).elements || e.forNativeElement();
                var n = this.setReferenceForNative(e.elements);
                this._int32Data[t] = n
            }, t.getBufferForNative = function (t) {
                return this._nativeArray[t]
            }, t.setBufferForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._nativeArray[t] = e;
                var n = this.setReferenceForNative(e);
                this._int32Data[t] = n
            }, t.getAttributeForNative = function (t) {
                return this._nativeArray[t]
            }, t.setAttributeForNative = function (t, e) {
                (this._nativeArray[t] = e)._ptrID || E.createArrayBufferRef(e, 0, !0), E.syncBufferToRenderThread(e), this._int32Data[t] = e._ptrID
            }, t.getTextureForNative = function (t) {
                return this._nativeArray[t]
            }, t.setTextureForNative = function (t, e) {
                if (e) {
                    this.needRenewArrayBufferForNative(t);
                    var n = this._nativeArray[t];
                    this._nativeArray[t] = e, this._int32Data[t] = e._glTexture.id, this._ownerResource && 0 < this._ownerResource.referenceCount && (n && n._removeReference(), e && e._addReference())
                }
            }, t.setReferenceForNative = function (t) {
                this.clearRuntimeCopyArray();
                var e = 0, n = 0;
                return i._SET_RUNTIME_VALUE_MODE_REFERENCE_ ? (E.createArrayBufferRefs(t, 0, !0, 0), e = 0, n = t.getPtrID(e)) : (E.createArrayBufferRefs(t, 0, !0, 1), e = t.getRefNum() - 1, n = t.getPtrID(e), this._runtimeCopyValues.push({
                    obj: t,
                    refID: e,
                    ptrID: n
                })), E.syncBufferToRenderThread(t, e), n
            }, t.clearRuntimeCopyArray = function () {
                var t = E.getFrameCount();
                if (this._frameCount != t) {
                    this._frameCount = t;
                    for (var e = 0, n = this._runtimeCopyValues.length; e < n; e++) {
                        this._runtimeCopyValues[e].obj.clearRefNum()
                    }
                    this._runtimeCopyValues.length = 0
                }
            }, i.setRuntimeValueMode = function (t) {
                i._SET_RUNTIME_VALUE_MODE_REFERENCE_ = t
            }, i._SET_RUNTIME_VALUE_MODE_REFERENCE_ = !0, i
        }(), st = function () {
            function y() {
                this._boundingSphere = null, this._boundingBox = null, this._sizeOfY = null, this._currentLODLevel = 0, this._lastDistanceToEye = NaN, this._originalBoundingSphere = null, this._originalBoundingBox = null, this._originalBoundingBoxCorners = null, this._bUseStrip = !1, this._gridSize = NaN, this._beginGridX = 0, this._beginGridZ = 0, this._LODError = null, y.__init__(), this._currentLODLevel = 0
            }

            d(y, "laya.d3.terrain.TerrainLeaf");
            var t = y.prototype;
            return t.calcVertextNorml = function (t, e, n, i, r, a) {
                var o = 0, s = 0;
                s = -1 * y.getHeightFromTerrainHeightData(t - 1, e - 1, n, i, r), s += -1 * y.getHeightFromTerrainHeightData(t - 1, e, n, i, r), s += -1 * y.getHeightFromTerrainHeightData(t - 1, e + 1, n, i, r), s += 1 * y.getHeightFromTerrainHeightData(t + 1, e - 1, n, i, r), s += 1 * y.getHeightFromTerrainHeightData(t + 1, e, n, i, r), s += 1 * y.getHeightFromTerrainHeightData(t + 1, e + 1, n, i, r), o = -1 * y.getHeightFromTerrainHeightData(t - 1, e - 1, n, i, r), o += -1 * y.getHeightFromTerrainHeightData(t, e - 1, n, i, r), o += -1 * y.getHeightFromTerrainHeightData(t + 1, e - 1, n, i, r), o += 1 * y.getHeightFromTerrainHeightData(t - 1, e + 1, n, i, r), o += 1 * y.getHeightFromTerrainHeightData(t, e + 1, n, i, r), o += 1 * y.getHeightFromTerrainHeightData(t + 1, e + 1, n, i, r), a.x = -s, a.y = 6, a.z = -o, Lt.normalize(a, a)
            }, t.calcVertextNormlUV = function (t, e, n, i, r) {
                r.x = t / n, r.y = e / i, r.z = e / i
            }, t.calcVertextBuffer = function (t, e, n, i, r, a, o, s, l, h, u, c) {
                if (1 == c && !y.__ADAPT_MATRIX__) {
                    y.__ADAPT_MATRIX__ = new He;
                    var _ = new He;
                    He.createRotationY(Math.PI, y.__ADAPT_MATRIX__), He.createTranslate(new Lt(0, 0, (u - 1) * r), _), He.multiply(_, y.__ADAPT_MATRIX__, y.__ADAPT_MATRIX__), y.__ADAPT_MATRIX_INV__ = new He, y.__ADAPT_MATRIX__.invert(y.__ADAPT_MATRIX_INV__)
                }
                this._gridSize = r, this._beginGridX = t * y.CHUNK_GRID_NUM + n, this._beginGridZ = e * y.CHUNK_GRID_NUM + i;
                for (var d = o * s, f = 2147483647, m = -2147483648, p = new Lt, T = 0, E = y.LEAF_GRID_NUM + 1; T < E; T++) for (var v = 0, g = y.LEAF_GRID_NUM + 1; v < g; v++) y.__VECTOR3__.x = (this._beginGridX + v) * this._gridSize, y.__VECTOR3__.z = (this._beginGridZ + T) * this._gridSize, y.__VECTOR3__.y = l[(this._beginGridZ + T) * h + (this._beginGridX + v)], f = y.__VECTOR3__.y < f ? y.__VECTOR3__.y : f, m = y.__VECTOR3__.y > m ? y.__VECTOR3__.y : m, y.__ADAPT_MATRIX__ && Lt.transformV3ToV3(y.__VECTOR3__, y.__ADAPT_MATRIX__, y.__VECTOR3__), a[d] = y.__VECTOR3__.x, a[++d] = y.__VECTOR3__.y, a[++d] = y.__VECTOR3__.z, d++, this.calcVertextNormlUV(this._beginGridX + v, this._beginGridZ + T, h, u, p), a[d] = p.x, a[++d] = p.y, a[++d] = p.z, a[++d] = (n + v) / y.CHUNK_GRID_NUM, a[++d] = (i + T) / y.CHUNK_GRID_NUM, a[++d] = this._beginGridX + v, a[++d] = this._beginGridZ + T, d++;
                this._sizeOfY = new Ot(f - 1, m + 1), this.calcLODErrors(l, h, u), this.calcOriginalBoudingBoxAndSphere()
            }, t.calcSkirtVertextBuffer = function (t, e, n, i, r, a, o, s, l, h, u) {
                this._gridSize = r, this._beginGridX = t * y.CHUNK_GRID_NUM + n, this._beginGridZ = e * y.CHUNK_GRID_NUM + i;
                var c = o * s, _ = 0, d = 0, f = y.LEAF_GRID_NUM + 1, m = new Lt, p = 0, T = 0;
                for (_ = 0; _ < 2; _++) for (d = 0; d < f; d++) y.__VECTOR3__.x = (this._beginGridX + d) * this._gridSize, y.__VECTOR3__.y = 1 == _ ? l[this._beginGridZ * h + (this._beginGridX + d)] : -this._gridSize, y.__VECTOR3__.z = (this._beginGridZ + 0) * this._gridSize, y.__ADAPT_MATRIX__ && Lt.transformV3ToV3(y.__VECTOR3__, y.__ADAPT_MATRIX__, y.__VECTOR3__), a[c] = y.__VECTOR3__.x, a[++c] = y.__VECTOR3__.y, a[++c] = y.__VECTOR3__.z, c++, p = 0 == _ ? this._beginGridZ - 1 : this._beginGridZ, this.calcVertextNormlUV(this._beginGridX + d, p, h, u, m), a[c] = m.x, a[++c] = m.y, a[++c] = m.z, a[++c] = (n + d) / y.CHUNK_GRID_NUM, a[++c] = (i + 0) / y.CHUNK_GRID_NUM, a[++c] = this._beginGridX + d, a[++c] = p, c++;
                for (_ = 0; _ < 2; _++) for (d = 0; d < f; d++) y.__VECTOR3__.x = (this._beginGridX + d) * this._gridSize, y.__VECTOR3__.y = 0 == _ ? l[(this._beginGridZ + y.LEAF_GRID_NUM) * h + (this._beginGridX + d)] : -this._gridSize, y.__VECTOR3__.z = (this._beginGridZ + y.LEAF_GRID_NUM) * this._gridSize, y.__ADAPT_MATRIX__ && Lt.transformV3ToV3(y.__VECTOR3__, y.__ADAPT_MATRIX__, y.__VECTOR3__), a[c] = y.__VECTOR3__.x, a[++c] = y.__VECTOR3__.y, a[++c] = y.__VECTOR3__.z, c++, p = 0 == _ ? this._beginGridZ + y.LEAF_GRID_NUM : this._beginGridZ + y.LEAF_GRID_NUM + 1, this.calcVertextNormlUV(this._beginGridX + d, p, h, u, m), a[c] = m.x, a[++c] = m.y, a[++c] = m.z, a[++c] = (n + d) / y.CHUNK_GRID_NUM, a[++c] = (i + y.LEAF_GRID_NUM) / y.CHUNK_GRID_NUM, a[++c] = this._beginGridX + d, a[++c] = p, c++;
                for (_ = 0; _ < 2; _++) for (d = 0; d < f; d++) y.__VECTOR3__.x = (this._beginGridX + 0) * this._gridSize, y.__VECTOR3__.y = 0 == _ ? l[(this._beginGridZ + d) * h + (this._beginGridX + 0)] : -this._gridSize, y.__VECTOR3__.z = (this._beginGridZ + d) * this._gridSize, y.__ADAPT_MATRIX__ && Lt.transformV3ToV3(y.__VECTOR3__, y.__ADAPT_MATRIX__, y.__VECTOR3__), a[c] = y.__VECTOR3__.x, a[++c] = y.__VECTOR3__.y, a[++c] = y.__VECTOR3__.z, c++, T = 0 == _ ? this._beginGridX : this._beginGridX - 1, this.calcVertextNormlUV(T, this._beginGridZ + d, h, u, m), a[c] = m.x, a[++c] = m.y, a[++c] = m.z, a[++c] = (n + 0) / y.CHUNK_GRID_NUM, a[++c] = (i + d) / y.CHUNK_GRID_NUM, a[++c] = T, a[++c] = this._beginGridZ + d, c++;
                for (_ = 0; _ < 2; _++) for (d = 0; d < f; d++) y.__VECTOR3__.x = (this._beginGridX + y.LEAF_GRID_NUM) * this._gridSize, y.__VECTOR3__.y = 1 == _ ? l[(this._beginGridZ + d) * h + (this._beginGridX + y.LEAF_GRID_NUM)] : -this._gridSize, y.__VECTOR3__.z = (this._beginGridZ + d) * this._gridSize, y.__ADAPT_MATRIX__ && Lt.transformV3ToV3(y.__VECTOR3__, y.__ADAPT_MATRIX__, y.__VECTOR3__), a[c] = y.__VECTOR3__.x, a[++c] = y.__VECTOR3__.y, a[++c] = y.__VECTOR3__.z, c++, T = 0 == _ ? this._beginGridX + y.LEAF_GRID_NUM + 1 : this._beginGridX + y.LEAF_GRID_NUM, this.calcVertextNormlUV(T, this._beginGridZ + d, h, u, m), a[c] = m.x, a[++c] = m.y, a[++c] = m.z, a[++c] = (n + y.LEAF_GRID_NUM) / y.CHUNK_GRID_NUM, a[++c] = (i + d) / y.CHUNK_GRID_NUM, a[++c] = T, a[++c] = this._beginGridZ + d, c++
            }, t.calcOriginalBoudingBoxAndSphere = function () {
                var t = new Lt(this._beginGridX * this._gridSize, this._sizeOfY.x, this._beginGridZ * this._gridSize),
                    e = new Lt((this._beginGridX + y.LEAF_GRID_NUM) * this._gridSize, this._sizeOfY.y, (this._beginGridZ + y.LEAF_GRID_NUM) * this._gridSize);
                y.__ADAPT_MATRIX__ && (Lt.transformV3ToV3(t, y.__ADAPT_MATRIX__, t), Lt.transformV3ToV3(e, y.__ADAPT_MATRIX__, e)), this._originalBoundingBox = new ze(t, e);
                var n = new Lt;
                Lt.subtract(e, t, n), Lt.scale(n, .5, n);
                var i = new Lt;
                Lt.add(t, n, i), this._originalBoundingSphere = new Et(i, Lt.scalarLength(n)), this._originalBoundingBoxCorners = w(8, null), this._originalBoundingBox.getCorners(this._originalBoundingBoxCorners), this._boundingBox = new ze(new Lt(-.5, -.5, -.5), new Lt(.5, .5, .5)), this._boundingSphere = new Et(new Lt(0, 0, 0), 1)
            }, t.calcLeafBoudingBox = function (t) {
                for (var e = 0; e < 8; e++) Lt.transformCoordinate(this._originalBoundingBoxCorners[e], t, We._tempBoundBoxCorners[e]);
                ze.createfromPoints(We._tempBoundBoxCorners, this._boundingBox)
            }, t.calcLeafBoudingSphere = function (t, e) {
                Lt.transformCoordinate(this._originalBoundingSphere.center, t, this._boundingSphere.center), this._boundingSphere.radius = this._originalBoundingSphere.radius * e
            }, t.calcLODErrors = function (t, e, n) {
                this._LODError = new Float32Array(y._maxLODLevel + 1);
                for (var i = 1, r = 0, a = y._maxLODLevel + 1; r < a; r++) {
                    for (var o = 0, s = 0, l = y.LEAF_GRID_NUM; s < l; s += i) for (var h = 0, u = y.LEAF_GRID_NUM; h < u; h += i) for (var c = t[(this._beginGridZ + s) * e + (this._beginGridX + h)], _ = t[(this._beginGridZ + s) * e + (this._beginGridX + h) + i], d = t[(this._beginGridZ + s + i) * e + (this._beginGridX + h)], f = t[(this._beginGridZ + s + i) * e + (this._beginGridX + h) + i], m = 0; m < i; m++) for (var p = m / i, T = 0; T < i; T++) {
                        var E = T / i, v = t[(this._beginGridZ + s + m) * e + (this._beginGridX + h) + T],
                            g = E + p <= 1 ? c + (_ - c) * E + (d - c) * p : f + (d - f) * (1 - E) + (_ - f) * (1 - p),
                            S = Math.abs(g - v);
                        o = Math.max(o, S)
                    }
                    i *= 2, this._LODError[r] = o
                }
            }, t.determineLod = function (t, e, n, i) {
                var r = Lt.distance(t, this._boundingSphere.center), a = y._maxLODLevel;
                if (!i) {
                    if (this._lastDistanceToEye == r) return this._currentLODLevel;
                    this._lastDistanceToEye > r && (a = this._currentLODLevel)
                }
                for (var o = a; 1 <= o; o--) if (ei.LOD_DISTANCE_FACTOR * this._LODError[o] / r * e < n) {
                    this._currentLODLevel = o;
                    break
                }
                return this._lastDistanceToEye = r, this._currentLODLevel
            }, y.__init__ = function () {
                if (!y._bInit) {
                    var t = y.CHUNK_GRID_NUM / y.LEAF_GRID_NUM * (y.CHUNK_GRID_NUM / y.LEAF_GRID_NUM);
                    y._planeLODIndex = w(t);
                    var e = 0, n = 0, i = 0, r = 0, a = 0, o = 0, s = null, l = null;
                    for (e = 0; e < t; e++) y._planeLODIndex[e] = new Array(y._maxLODLevel + 1);
                    for (e = 0, r = y._maxLODLevel + 1; e < r; e++) y._planeLODIndex[0][e] = y.calcPlaneLODIndex(e);
                    for (e = 1; e < t; e++) for (o = e * y.LEAF_PLANE_VERTEXT_COUNT, n = 0, a = y._maxLODLevel + 1; n < a; n++) {
                        for (s = y._planeLODIndex[0][n], l = new Uint16Array(s.length), i = 0; i < s.length; i++) l[i] = s[i] + o;
                        y._planeLODIndex[e][n] = l
                    }
                    for (y._skirtLODIndex = w(t), e = 0; e < t; e++) y._skirtLODIndex[e] = new Array(y._maxLODLevel + 1);
                    for (e = 0, r = y._maxLODLevel + 1; e < r; e++) y._skirtLODIndex[0][e] = y.calcSkirtLODIndex(e);
                    for (e = 1; e < t; e++) for (o = e * y.LEAF_SKIRT_VERTEXT_COUNT, n = 0, a = y._maxLODLevel + 1; n < a; n++) {
                        for (s = y._skirtLODIndex[0][n], l = new Uint16Array(s.length), i = 0; i < s.length; i++) l[i] = s[i] + o;
                        y._skirtLODIndex[e][n] = l
                    }
                    y._bInit = !0
                }
            }, y.getPlaneLODIndex = function (t, e) {
                return y._planeLODIndex[t][e]
            }, y.getSkirtLODIndex = function (t, e) {
                return y._skirtLODIndex[t][e]
            }, y.calcPlaneLODIndex = function (t) {
                y._maxLODLevel < t && (t = y._maxLODLevel);
                var e = y.LEAF_GRID_NUM + 1, n = 0, i = null,
                    r = laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM / Math.pow(2, t);
                i = new Uint16Array(r * r * 6);
                for (var a = laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM / r, o = 0; o < y.LEAF_GRID_NUM; o += a) for (var s = 0; s < y.LEAF_GRID_NUM; s += a) i[n] = (o + a) * e + s, i[++n] = o * e + s, i[++n] = o * e + s + a, i[++n] = o * e + s + a, i[++n] = (o + a) * e + s + a, i[++n] = (o + a) * e + s, n++;
                return i
            }, y.calcSkirtLODIndex = function (t) {
                y._maxLODLevel < t && (t = y._maxLODLevel);
                var e = y.CHUNK_GRID_NUM / y.LEAF_GRID_NUM * (y.CHUNK_GRID_NUM / y.LEAF_GRID_NUM) * y.LEAF_PLANE_VERTEXT_COUNT,
                    n = y.LEAF_GRID_NUM + 1, i = 0, r = null,
                    a = laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM / Math.pow(2, t);
                r = new Uint16Array(4 * a * 6);
                for (var o = laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM / a, s = 0; s < 4; s++) {
                    for (var l = 0; l < y.LEAF_GRID_NUM; l += o) r[i] = e + n + l, r[++i] = e + l, r[++i] = e + l + o, r[++i] = e + l + o, r[++i] = e + n + l + o, r[++i] = e + n + l, i++;
                    e += 2 * n
                }
                return r
            }, y.getHeightFromTerrainHeightData = function (t, e, n, i, r) {
                return n[(e = r <= (e = e < 0 ? 0 : e) ? r - 1 : e) * i + (t = i <= (t = t < 0 ? 0 : t) ? i - 1 : t)]
            }, y.CHUNK_GRID_NUM = 64, y.LEAF_GRID_NUM = 32, y.__ADAPT_MATRIX__ = null, y.__ADAPT_MATRIX_INV__ = null, y._planeLODIndex = null, y._skirtLODIndex = null, y._bInit = !1, _(y, ["LEAF_PLANE_VERTEXT_COUNT", function () {
                return this.LEAF_PLANE_VERTEXT_COUNT = (y.LEAF_GRID_NUM + 1) * (y.LEAF_GRID_NUM + 1)
            }, "LEAF_SKIRT_VERTEXT_COUNT", function () {
                return this.LEAF_SKIRT_VERTEXT_COUNT = 2 * (y.LEAF_GRID_NUM + 1) * 4
            }, "LEAF_VERTEXT_COUNT", function () {
                return this.LEAF_VERTEXT_COUNT = y.LEAF_PLANE_VERTEXT_COUNT + y.LEAF_SKIRT_VERTEXT_COUNT
            }, "LEAF_PLANE_MAX_INDEX_COUNT", function () {
                return this.LEAF_PLANE_MAX_INDEX_COUNT = y.LEAF_GRID_NUM * y.LEAF_GRID_NUM * 6
            }, "LEAF_SKIRT_MAX_INDEX_COUNT", function () {
                return this.LEAF_SKIRT_MAX_INDEX_COUNT = 4 * y.LEAF_GRID_NUM * 6
            }, "LEAF_MAX_INDEX_COUNT", function () {
                return this.LEAF_MAX_INDEX_COUNT = y.LEAF_PLANE_MAX_INDEX_COUNT + y.LEAF_SKIRT_MAX_INDEX_COUNT
            }, "__VECTOR3__", function () {
                return this.__VECTOR3__ = new Lt
            }, "_maxLODLevel", function () {
                return this._maxLODLevel = Math.log2(y.LEAF_GRID_NUM)
            }]), y
        }(), lt = function () {
            function t() {
            }

            return d(t, "laya.d3.graphics.Vertex.VertexShuriKenParticle"), t.PARTICLE_CORNERTEXTURECOORDINATE0 = 0, t.PARTICLE_POSITION0 = 1, t.PARTICLE_COLOR0 = 2, t.PARTICLE_TEXTURECOORDINATE0 = 3, t.PARTICLE_SHAPEPOSITIONSTARTLIFETIME = 4, t.PARTICLE_DIRECTIONTIME = 5, t.PARTICLE_STARTCOLOR0 = 6, t.PARTICLE_ENDCOLOR0 = 7, t.PARTICLE_STARTSIZE = 8, t.PARTICLE_STARTROTATION = 9, t.PARTICLE_STARTSPEED = 10, t.PARTICLE_RANDOM0 = 11, t.PARTICLE_RANDOM1 = 12, t.PARTICLE_SIMULATIONWORLDPOSTION = 13, t.PARTICLE_SIMULATIONWORLDROTATION = 14, t
        }(), At = function () {
            function t(t) {
                this._size = null, this.enbale = !1, this._size = t
            }

            d(t, "laya.d3.core.particleShuriKen.module.SizeOverLifetime");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.cloneTo = function (t) {
                var e = t;
                this._size.cloneTo(e._size), e.enbale = this.enbale
            }, e.clone = function () {
                var t;
                switch (this._size.type) {
                    case 0:
                        t = this._size.separateAxes ? Ee.createByGradientSeparate(this._size.gradientX.clone(), this._size.gradientY.clone(), this._size.gradientZ.clone()) : Ee.createByGradient(this._size.gradient.clone());
                        break;
                    case 1:
                        t = this._size.separateAxes ? Ee.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(), this._size.constantMaxSeparate.clone()) : Ee.createByRandomTwoConstant(this._size.constantMin, this._size.constantMax);
                        break;
                    case 2:
                        t = this._size.separateAxes ? Ee.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(), this._size.gradientYMin.clone(), this._size.gradientZMin.clone(), this._size.gradientXMax.clone(), this._size.gradientYMax.clone(), this._size.gradientZMax.clone()) : Ee.createByRandomTwoGradient(this._size.gradientMin.clone(), this._size.gradientMax.clone())
                }
                var e = new this.constructor(t);
                return e.enbale = this.enbale, e
            }, u(0, e, "size", function () {
                return this._size
            }), t
        }(), ht = function () {
            function t() {
                this.time = NaN
            }

            d(t, "laya.d3.core.Keyframe");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.cloneTo = function (t) {
                t.time = this.time
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t
        }(), Ct = function () {
            function t(t, e, n, i) {
                this.x = NaN, this.y = NaN, this.z = NaN, this.w = NaN, void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === n && (n = 0), void 0 === i && (i = 0), this.x = t, this.y = e, this.z = n, this.w = i
            }

            d(t, "laya.d3.math.Vector4");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.setValue = function (t, e, n, i) {
                this.x = t, this.y = e, this.z = n, this.w = i
            }, e.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.x = t[e + 0], this.y = t[e + 1], this.z = t[e + 2], this.w = t[e + 3]
            }, e.cloneTo = function (t) {
                var e = t;
                e.x = this.x, e.y = this.y, e.z = this.z, e.w = this.w
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, e.length = function () {
                return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w)
            }, e.lengthSquared = function () {
                return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w
            }, e.forNativeElement = function (t) {
                t ? (this.elements = t, this.elements[0] = this.x, this.elements[1] = this.y, this.elements[2] = this.z, this.elements[3] = this.w) : this.elements = new Float32Array([this.x, this.y, this.z, this.w]), Ot.rewriteNumProperty(this, "x", 0), Ot.rewriteNumProperty(this, "y", 1), Ot.rewriteNumProperty(this, "z", 2), Ot.rewriteNumProperty(this, "w", 3)
            }, t.lerp = function (t, e, n, i) {
                var r = t.x, a = t.y, o = t.z, s = t.w;
                i.x = r + n * (e.x - r), i.y = a + n * (e.y - a), i.z = o + n * (e.z - o), i.w = s + n * (e.w - s)
            }, t.transformByM4x4 = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z, o = t.w, s = e.elements;
                n.x = i * s[0] + r * s[4] + a * s[8] + o * s[12], n.y = i * s[1] + r * s[5] + a * s[9] + o * s[13], n.z = i * s[2] + r * s[6] + a * s[10] + o * s[14], n.w = i * s[3] + r * s[7] + a * s[11] + o * s[15]
            }, t.equals = function (t, e) {
                return tt.nearEqual(Math.abs(t.x), Math.abs(e.x)) && tt.nearEqual(Math.abs(t.y), Math.abs(e.y)) && tt.nearEqual(Math.abs(t.z), Math.abs(e.z)) && tt.nearEqual(Math.abs(t.w), Math.abs(e.w))
            }, t.normalize = function (t, e) {
                var n = t.length();
                0 < n && (e.x = t.x * n, e.y = t.y * n, e.z = t.z * n, e.w = t.w * n)
            }, t.add = function (t, e, n) {
                n.x = t.x + e.x, n.y = t.y + e.y, n.z = t.z + e.z, n.w = t.w + e.w
            }, t.subtract = function (t, e, n) {
                n.x = t.x - e.x, n.y = t.y - e.y, n.z = t.z - e.z, n.w = t.w - e.w
            }, t.multiply = function (t, e, n) {
                n.x = t.x * e.x, n.y = t.y * e.y, n.z = t.z * e.z, n.w = t.w * e.w
            }, t.scale = function (t, e, n) {
                n.x = t.x * e, n.y = t.y * e, n.z = t.z * e, n.w = t.w * e
            }, t.Clamp = function (t, e, n, i) {
                var r = t.x, a = t.y, o = t.z, s = t.w, l = e.x, h = e.y, u = e.z, c = e.w, _ = n.x, d = n.y, f = n.z,
                    m = n.w;
                r = (r = _ < r ? _ : r) < l ? l : r, a = (a = d < a ? d : a) < h ? h : a, o = (o = f < o ? f : o) < u ? u : o, s = (s = m < s ? m : s) < c ? c : s, i.x = r, i.y = a, i.z = o, i.w = s
            }, t.distanceSquared = function (t, e) {
                var n = t.x - e.x, i = t.y - e.y, r = t.z - e.z, a = t.w - e.w;
                return n * n + i * i + r * r + a * a
            }, t.distance = function (t, e) {
                var n = t.x - e.x, i = t.y - e.y, r = t.z - e.z, a = t.w - e.w;
                return Math.sqrt(n * n + i * i + r * r + a * a)
            }, t.dot = function (t, e) {
                return t.x * e.x + t.y * e.y + t.z * e.z + t.w * e.w
            }, t.min = function (t, e, n) {
                n.x = Math.min(t.x, e.x), n.y = Math.min(t.y, e.y), n.z = Math.min(t.z, e.z), n.w = Math.min(t.w, e.w)
            }, t.max = function (t, e, n) {
                n.x = Math.max(t.x, e.x), n.y = Math.max(t.y, e.y), n.z = Math.max(t.z, e.z), n.w = Math.max(t.w, e.w)
            }, _(t, ["ZERO", function () {
                return this.ZERO = new t
            }, "ONE", function () {
                return this.ONE = new t(1, 1, 1, 1)
            }, "UnitX", function () {
                return this.UnitX = new t(1, 0, 0, 0)
            }, "UnitY", function () {
                return this.UnitY = new t(0, 1, 0, 0)
            }, "UnitZ", function () {
                return this.UnitZ = new t(0, 0, 1, 0)
            }, "UnitW", function () {
                return this.UnitW = new t(0, 0, 0, 1)
            }]), t
        }(), ut = function () {
            function t(t) {
                if (this._counter = 0, this.defines = {}, t) for (var e in this._counter = t._counter, t.defines) this.defines[e] = t.defines[e]
            }

            return d(t, "laya.d3.shader.ShaderDefines"), t.prototype.registerDefine = function (t) {
                var e = Math.pow(2, this._counter++);
                return this.defines[e] = t, e
            }, t
        }(), Lt = function () {
            function r(t, e, n, i) {
                this.x = NaN, this.y = NaN, this.z = NaN, void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === n && (n = 0), this.x = t, this.y = e, this.z = n
            }

            d(r, "laya.d3.math.Vector3");
            var t = r.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.setValue = function (t, e, n) {
                this.x = t, this.y = e, this.z = n
            }, t.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.x = t[e + 0], this.y = t[e + 1], this.z = t[e + 2]
            }, t.cloneTo = function (t) {
                var e = t;
                e.x = this.x, e.y = this.y, e.z = this.z
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t.toDefault = function () {
                this.x = 0, this.y = 0, this.z = 0
            }, t.forNativeElement = function (t) {
                t ? (this.elements = t, this.elements[0] = this.x, this.elements[1] = this.y, this.elements[2] = this.z) : this.elements = new Float32Array([this.x, this.y, this.z]), Ot.rewriteNumProperty(this, "x", 0), Ot.rewriteNumProperty(this, "y", 1), Ot.rewriteNumProperty(this, "z", 2)
            }, r.distanceSquared = function (t, e) {
                var n = t.x - e.x, i = t.y - e.y, r = t.z - e.z;
                return n * n + i * i + r * r
            }, r.distance = function (t, e) {
                var n = t.x - e.x, i = t.y - e.y, r = t.z - e.z;
                return Math.sqrt(n * n + i * i + r * r)
            }, r.min = function (t, e, n) {
                n.x = Math.min(t.x, e.x), n.y = Math.min(t.y, e.y), n.z = Math.min(t.z, e.z)
            }, r.max = function (t, e, n) {
                n.x = Math.max(t.x, e.x), n.y = Math.max(t.y, e.y), n.z = Math.max(t.z, e.z)
            }, r.transformQuat = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z, o = e.x, s = e.y, l = e.z, h = e.w, u = h * i + s * a - l * r,
                    c = h * r + l * i - o * a, _ = h * a + o * r - s * i, d = -o * i - s * r - l * a;
                n.x = u * h + d * -o + c * -l - _ * -s, n.y = c * h + d * -s + _ * -o - u * -l, n.z = _ * h + d * -l + u * -s - c * -o
            }, r.scalarLength = function (t) {
                var e = t.x, n = t.y, i = t.z;
                return Math.sqrt(e * e + n * n + i * i)
            }, r.scalarLengthSquared = function (t) {
                var e = t.x, n = t.y, i = t.z;
                return e * e + n * n + i * i
            }, r.normalize = function (t, e) {
                var n = t.x, i = t.y, r = t.z, a = n * n + i * i + r * r;
                0 < a && (a = 1 / Math.sqrt(a), e.x = t.x * a, e.y = t.y * a, e.z = t.z * a)
            }, r.multiply = function (t, e, n) {
                n.x = t.x * e.x, n.y = t.y * e.y, n.z = t.z * e.z
            }, r.scale = function (t, e, n) {
                n.x = t.x * e, n.y = t.y * e, n.z = t.z * e
            }, r.lerp = function (t, e, n, i) {
                var r = t.x, a = t.y, o = t.z;
                i.x = r + n * (e.x - r), i.y = a + n * (e.y - a), i.z = o + n * (e.z - o)
            }, r.transformV3ToV3 = function (t, e, n) {
                var i = r._tempVector4;
                r.transformV3ToV4(t, e, i), n.x = i.x, n.y = i.y, n.z = i.z
            }, r.transformV3ToV4 = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z, o = e.elements;
                n.x = i * o[0] + r * o[4] + a * o[8] + o[12], n.y = i * o[1] + r * o[5] + a * o[9] + o[13], n.z = i * o[2] + r * o[6] + a * o[10] + o[14], n.w = i * o[3] + r * o[7] + a * o[11] + o[15]
            }, r.TransformNormal = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z, o = e.elements;
                n.x = i * o[0] + r * o[4] + a * o[8], n.y = i * o[1] + r * o[5] + a * o[9], n.z = i * o[2] + r * o[6] + a * o[10]
            }, r.transformCoordinate = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z, o = e.elements, s = i * o[3] + r * o[7] + a * o[11] + o[15];
                n.x = i * o[0] + r * o[4] + a * o[8] + o[12] / s, n.y = i * o[1] + r * o[5] + a * o[9] + o[13] / s, n.z = i * o[2] + r * o[6] + a * o[10] + o[14] / s
            }, r.Clamp = function (t, e, n, i) {
                var r = t.x, a = t.y, o = t.z, s = e.x, l = e.y, h = e.z, u = n.x, c = n.y, _ = n.z;
                r = (r = u < r ? u : r) < s ? s : r, a = (a = c < a ? c : a) < l ? l : a, o = (o = _ < o ? _ : o) < h ? h : o, i.x = r, i.y = a, i.z = o
            }, r.add = function (t, e, n) {
                n.x = t.x + e.x, n.y = t.y + e.y, n.z = t.z + e.z
            }, r.subtract = function (t, e, n) {
                n.x = t.x - e.x, n.y = t.y - e.y, n.z = t.z - e.z
            }, r.cross = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z, o = e.x, s = e.y, l = e.z;
                n.x = r * l - a * s, n.y = a * o - i * l, n.z = i * s - r * o
            }, r.dot = function (t, e) {
                return t.x * e.x + t.y * e.y + t.z * e.z
            }, r.equals = function (t, e) {
                return tt.nearEqual(t.x, e.x) && tt.nearEqual(t.y, e.y) && tt.nearEqual(t.z, e.z)
            }, r._ZERO = new r(0, 0, 0), r._ONE = new r(1, 1, 1), r._NegativeUnitX = new r(-1, 0, 0), r._UnitX = new r(1, 0, 0), r._UnitY = new r(0, 1, 0), r._UnitZ = new r(0, 0, 1), r._ForwardRH = new r(0, 0, -1), r._ForwardLH = new r(0, 0, 1), r._Up = new r(0, 1, 0), _(r, ["_tempVector4", function () {
                return this._tempVector4 = new Ct
            }]), r
        }(), Ot = function () {
            function e(t, e) {
                this.x = NaN, this.y = NaN, void 0 === t && (t = 0), void 0 === e && (e = 0), this.x = t, this.y = e
            }

            d(e, "laya.d3.math.Vector2");
            var t = e.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.setValue = function (t, e) {
                this.x = t, this.y = e
            }, t.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.x = t[e + 0], this.y = t[e + 1]
            }, t.cloneTo = function (t) {
                var e = t;
                e.x = this.x, e.y = this.y
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t.forNativeElement = function (t) {
                t ? (this.elements = t, this.elements[0] = this.x, this.elements[1] = this.y) : this.elements = new Float32Array([this.x, this.y]), e.rewriteNumProperty(this, "x", 0), e.rewriteNumProperty(this, "y", 1)
            }, e.scale = function (t, e, n) {
                n.x = t.x * e, n.y = t.y * e
            }, e.dot = function (t, e) {
                return t.x * e.x + t.y * e.y
            }, e.normalize = function (t, e) {
                var n = t.x, i = t.y, r = n * n + i * i;
                0 < r && (r = 1 / Math.sqrt(r), e.x = n * r, e.y = i * r)
            }, e.scalarLength = function (t) {
                var e = t.x, n = t.y;
                return Math.sqrt(e * e + n * n)
            }, e.rewriteNumProperty = function (t, e, n) {
                Object.defineProperty(t, e, {
                    get: function () {
                        return this.elements[n]
                    }, set: function (t) {
                        this.elements[n] = t
                    }
                })
            }, _(e, ["ZERO", function () {
                return this.ZERO = new e(0, 0)
            }, "ONE", function () {
                return this.ONE = new e(1, 1)
            }]), e
        }(), ct = function () {
            function t() {
            }

            d(t, "laya.d3.component.AnimatorPlayState");
            var e = t.prototype;
            return e._resetPlayState = function (t) {
                this._finish = !1, this._startPlayTime = t, this._elapsedTime = t, this._playEventIndex = 0, this._lastIsFront = !0
            }, e._cloneTo = function (t) {
                t._finish = this._finish, t._startPlayTime = this._startPlayTime, t._elapsedTime = this._elapsedTime, t._playEventIndex = this._playEventIndex, t._lastIsFront = this._lastIsFront
            }, u(0, e, "normalizedTime", function () {
                return this._normalizedTime
            }), u(0, e, "duration", function () {
                return this._duration
            }), t
        }(), Nt = function () {
            function t(t) {
                this._velocity = null, this.enbale = !1, this.space = 0, this._velocity = t
            }

            d(t, "laya.d3.core.particleShuriKen.module.VelocityOverLifetime");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.cloneTo = function (t) {
                var e = t;
                this._velocity.cloneTo(e._velocity), e.enbale = this.enbale, e.space = this.space
            }, e.clone = function () {
                var t;
                switch (this._velocity.type) {
                    case 0:
                        t = ye.createByConstant(this._velocity.constant.clone());
                        break;
                    case 1:
                        t = ye.createByGradient(this._velocity.gradientX.clone(), this._velocity.gradientY.clone(), this._velocity.gradientZ.clone());
                        break;
                    case 2:
                        t = ye.createByRandomTwoConstant(this._velocity.constantMin.clone(), this._velocity.constantMax.clone());
                        break;
                    case 3:
                        t = ye.createByRandomTwoGradient(this._velocity.gradientXMin.clone(), this._velocity.gradientYMin.clone(), this._velocity.gradientZMin.clone(), this._velocity.gradientXMax.clone(), this._velocity.gradientYMax.clone(), this._velocity.gradientZMax.clone())
                }
                var e = new this.constructor(t);
                return e.enbale = this.enbale, e.space = this.space, e
            }, u(0, e, "velocity", function () {
                return this._velocity
            }), t
        }(), _t = function () {
            function t() {
            }

            return d(t, "laya.d3.loaders.MeshReader"), t.read = function (t, e, n) {
                var i = new s(t);
                i.pos = 0;
                var r = i.readUTFString();
                switch (r) {
                    case"LAYAMODEL:0301":
                    case"LAYAMODEL:0400":
                    case"LAYAMODEL:0401":
                        mt.parse(i, r, e, n);
                        break;
                    case"LAYAMODEL:05":
                    case"LAYAMODEL:COMPRESSION_05":
                        dt.parse(i, r, e, n);
                        break;
                    default:
                        throw new Error("MeshReader: unknown mesh version.")
                }
                e._setSubMeshes(n)
            }, t
        }(), dt = (function () {
            function t() {
            }

            d(t, "laya.d3.core.scene.SceneManager")
        }(), function () {
            function t() {
            }

            d(t, "laya.d3.math.ContainmentType"), t.Disjoint = 0, t.Contains = 1, t.Intersects = 2
        }(), function () {
            function P() {
            }

            return d(P, "laya.d3.loaders.LoadModelV05"), P.parse = function (t, e, n, i) {
                P._mesh = n, P._subMeshes = i, P._version = e, P._readData = t, P.READ_DATA(), P.READ_BLOCK(), P.READ_STRINGS();
                for (var r = 0, a = P._BLOCK.count; r < a; r++) {
                    P._readData.pos = P._BLOCK.blockStarts[r];
                    var o = P._readData.getUint16(), s = P._strings[o], l = P["READ_" + s];
                    if (null == l) throw new Error("model file err,no this function:" + o + " " + s);
                    l.call(null)
                }
                P._mesh._bindPoseIndices = new Uint16Array(P._bindPoseIndices), P._bindPoseIndices.length = 0, P._strings.length = 0, P._readData = null, P._version = null, P._mesh = null, P._subMeshes = null
            }, P._readString = function () {
                return P._strings[P._readData.getUint16()]
            }, P.READ_DATA = function () {
                P._DATA.offset = P._readData.getUint32(), P._DATA.size = P._readData.getUint32()
            }, P.READ_BLOCK = function () {
                for (var t = P._BLOCK.count = P._readData.getUint16(), e = P._BLOCK.blockStarts = [], n = P._BLOCK.blockLengths = [], i = 0; i < t; i++) e.push(P._readData.getUint32()), n.push(P._readData.getUint32())
            }, P.READ_STRINGS = function () {
                var t = P._readData.getUint32(), e = P._readData.getUint16(), n = P._readData.pos;
                P._readData.pos = t + P._DATA.offset;
                for (var i = 0; i < e; i++) P._strings[i] = P._readData.readUTFString();
                P._readData.pos = n
            }, P.READ_MESH = function () {
                var t = 0, e = 0, n = (P._readString(), P._readData.__getBuffer()), i = P._readData.getInt16(),
                    r = P._DATA.offset;
                for (t = 0; t < i; t++) {
                    var a = r + P._readData.getUint32(), o = P._readData.getUint32(), s = P._readString(),
                        l = pt.getVertexDeclaration(s, !1), h = l.vertexStride, u = new ArrayBuffer(h * o),
                        c = new Float32Array(u), _ = s.split(","), d = _.length;
                    switch (P._version) {
                        case"LAYAMODEL:05":
                            c = new Float32Array(n.slice(a, a + o * h));
                            break;
                        case"LAYAMODEL:COMPRESSION_05":
                            var f = P._readData.pos;
                            c = new Float32Array(u);
                            var m = new Uint8Array(u);
                            P._readData.pos = a;
                            for (var p = 0; p < o; p++) for (var T = 0, E = p * h, v = 0; v < d; v++) switch (_[v]) {
                                case"POSITION":
                                    c[T = E / 4] = gt.convertToNumber(P._readData.getUint16()), c[T + 1] = gt.convertToNumber(P._readData.getUint16()), c[T + 2] = gt.convertToNumber(P._readData.getUint16()), E += 12;
                                    break;
                                case"NORMAL":
                                    c[T = E / 4] = P._readData.getUint8() / 127.5 - 1, c[T + 1] = P._readData.getUint8() / 127.5 - 1, c[T + 2] = P._readData.getUint8() / 127.5 - 1, E += 12;
                                    break;
                                case"COLOR":
                                    c[T = E / 4] = P._readData.getUint8() / 255, c[T + 1] = P._readData.getUint8() / 255, c[T + 2] = P._readData.getUint8() / 255, c[T + 3] = P._readData.getUint8() / 255, E += 16;
                                    break;
                                case"UV":
                                case"UV1":
                                    c[T = E / 4] = gt.convertToNumber(P._readData.getUint16()), c[T + 1] = gt.convertToNumber(P._readData.getUint16()), E += 8;
                                    break;
                                case"BLENDWEIGHT":
                                    c[T = E / 4] = P._readData.getUint8() / 255, c[T + 1] = P._readData.getUint8() / 255, c[T + 2] = P._readData.getUint8() / 255, c[T + 3] = P._readData.getUint8() / 255, E += 16;
                                    break;
                                case"BLENDINDICES":
                                    m[E] = P._readData.getUint8(), m[E + 1] = P._readData.getUint8(), m[E + 2] = P._readData.getUint8(), m[E + 3] = P._readData.getUint8(), E += 4;
                                    break;
                                case"TANGENT":
                                    c[T = E / 4] = P._readData.getUint8() / 127.5 - 1, c[T + 1] = P._readData.getUint8() / 127.5 - 1, c[T + 2] = P._readData.getUint8() / 127.5 - 1, c[T + 3] = P._readData.getUint8() / 127.5 - 1, E += 16
                            }
                            P._readData.pos = f
                    }
                    var g = new Ke(u.byteLength, 35044, !0);
                    g.vertexDeclaration = l, g.setData(c), P._mesh._vertexBuffers.push(g), P._mesh._vertexCount += g.vertexCount, e += 4 * c.length
                }
                var S = r + P._readData.getUint32(), y = P._readData.getUint32(),
                    x = new Uint16Array(n.slice(S, S + y)), D = new qe("ushort", y / 2, 35044, !0);
                D.setData(x), P._mesh._indexBuffer = D, P._mesh._setBuffer(P._mesh._vertexBuffers, D), e += 2 * D.indexCount, P._mesh._setCPUMemory(e), P._mesh._setGPUMemory(e);
                var I = P._mesh._boneNames = [], R = P._readData.getUint16();
                for (I.length = R, t = 0; t < R; t++) I[t] = P._strings[P._readData.getUint16()];
                var M = P._readData.getUint32(), A = P._readData.getUint32(),
                    C = new Float32Array(n.slice(r + M, r + M + A)), L = C.length, O = L / 16,
                    N = P._mesh._inverseBindPosesBuffer = new ArrayBuffer(4 * L);
                for (P._mesh._inverseBindPoses = w(O), t = 0; t < L; t += 16) {
                    var V = new He(C[t + 0], C[t + 1], C[t + 2], C[t + 3], C[t + 4], C[t + 5], C[t + 6], C[t + 7], C[t + 8], C[t + 9], C[t + 10], C[t + 11], C[t + 12], C[t + 13], C[t + 14], C[t + 15], new Float32Array(N, 4 * t, 16));
                    P._mesh._inverseBindPoses[t / 16] = V
                }
                return !0
            }, P.READ_SUBMESH = function () {
                var t = P._readData.__getBuffer(), e = new on(P._mesh), n = P._readData.getInt16(),
                    i = P._readData.getUint32(), r = P._readData.getUint32(), a = P._mesh._indexBuffer;
                e._indexBuffer = a, e._indexStart = i, e._indexCount = r, e._indices = new Uint16Array(a.getData().buffer, 2 * i, r);
                var o = P._mesh._vertexBuffers[n];
                e._vertexBuffer = o;
                var s = P._DATA.offset, l = e._subIndexBufferStart, h = e._subIndexBufferCount, u = e._boneIndicesList,
                    c = P._readData.getUint16();
                l.length = c, h.length = c, u.length = c;
                for (var _ = P._mesh._skinDataPathMarks, d = P._bindPoseIndices, f = P._subMeshes.length, m = 0; m < c; m++) {
                    l[m] = P._readData.getUint32(), h[m] = P._readData.getUint32();
                    for (var p = P._readData.getUint32(), T = P._readData.getUint32(), E = u[m] = new Uint16Array(t.slice(s + p, s + p + T)), v = 0, g = E.length; v < g; v++) {
                        var S = E[v], y = d.indexOf(S);
                        -1 === y ? (E[v] = d.length, d.push(S), _.push([f, m, v])) : E[v] = y
                    }
                }
                return P._subMeshes.push(e), !0
            }, P._strings = [], P._readData = null, P._version = null, P._mesh = null, P._subMeshes = null, P._bindPoseIndices = [], _(P, ["_BLOCK", function () {
                return this._BLOCK = {count: 0}
            }, "_DATA", function () {
                return this._DATA = {offset: 0, size: 0}
            }]), P
        }()), ft = function () {
            function t(t, e, n, i) {
                this.r = NaN, this.g = NaN, this.b = NaN, this.a = NaN, void 0 === t && (t = 1), void 0 === e && (e = 1), void 0 === n && (n = 1), void 0 === i && (i = 1), this.r = t, this.g = e, this.b = n, this.a = i
            }

            d(t, "laya.d3.math.Color");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.toLinear = function (t) {
                t.r = kt.gammaToLinearSpace(this.r), t.g = kt.gammaToLinearSpace(this.g), t.b = kt.gammaToLinearSpace(this.b)
            }, e.toGamma = function (t) {
                t.r = kt.linearToGammaSpace(this.r), t.g = kt.linearToGammaSpace(this.g), t.b = kt.linearToGammaSpace(this.b)
            }, e.cloneTo = function (t) {
                var e = t;
                e.r = this.r, e.g = this.g, e.b = this.b, e.a = this.a
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, e.forNativeElement = function (t) {
                t ? (this.elements = t, this.elements[0] = this.r, this.elements[1] = this.g, this.elements[2] = this.b, this.elements[3] = this.a) : this.elements = new Float32Array([this.r, this.g, this.b, this.a]), Ot.rewriteNumProperty(this, "r", 0), Ot.rewriteNumProperty(this, "g", 1), Ot.rewriteNumProperty(this, "b", 2), Ot.rewriteNumProperty(this, "a", 3)
            }, _(t, ["RED", function () {
                return this.RED = new t(1, 0, 0, 1)
            }, "GREEN", function () {
                return this.GREEN = new t(0, 1, 0, 1)
            }, "BLUE", function () {
                return this.BLUE = new t(0, 0, 1, 1)
            }, "CYAN", function () {
                return this.CYAN = new t(0, 1, 1, 1)
            }, "YELLOW", function () {
                return this.YELLOW = new t(1, .92, .016, 1)
            }, "MAGENTA", function () {
                return this.MAGENTA = new t(1, 0, 1, 1)
            }, "GRAY", function () {
                return this.GRAY = new t(.5, .5, .5, 1)
            }, "WHITE", function () {
                return this.WHITE = new t(1, 1, 1, 1)
            }, "BLACK", function () {
                return this.BLACK = new t(0, 0, 0, 1)
            }]), t
        }(), mt = function () {
            function D() {
            }

            return d(D, "laya.d3.loaders.LoadModelV04"), D.parse = function (t, e, n, i) {
                D._mesh = n, D._subMeshes = i, D._version = e, D._readData = t, D.READ_DATA(), D.READ_BLOCK(), D.READ_STRINGS();
                for (var r = 0, a = D._BLOCK.count; r < a; r++) {
                    D._readData.pos = D._BLOCK.blockStarts[r];
                    var o = D._readData.getUint16(), s = D._strings[o], l = D["READ_" + s];
                    if (null == l) throw new Error("model file err,no this function:" + o + " " + s);
                    l.call(null)
                }
                D._mesh._bindPoseIndices = new Uint16Array(D._bindPoseIndices), D._bindPoseIndices.length = 0, D._strings.length = 0, D._readData = null, D._version = null, D._mesh = null, D._subMeshes = null
            }, D._readString = function () {
                return D._strings[D._readData.getUint16()]
            }, D.READ_DATA = function () {
                D._DATA.offset = D._readData.getUint32(), D._DATA.size = D._readData.getUint32()
            }, D.READ_BLOCK = function () {
                for (var t = D._BLOCK.count = D._readData.getUint16(), e = D._BLOCK.blockStarts = [], n = D._BLOCK.blockLengths = [], i = 0; i < t; i++) e.push(D._readData.getUint32()), n.push(D._readData.getUint32())
            }, D.READ_STRINGS = function () {
                var t = D._readData.getUint32(), e = D._readData.getUint16(), n = D._readData.pos;
                D._readData.pos = t + D._DATA.offset;
                for (var i = 0; i < e; i++) D._strings[i] = D._readData.readUTFString();
                D._readData.pos = n
            }, D.READ_MESH = function () {
                D._readString();
                var t = D._readData.__getBuffer(), e = 0, n = 0, i = D._readData.getInt16(), r = D._DATA.offset;
                for (e = 0; e < i; e++) {
                    var a, o = r + D._readData.getUint32(), s = D._readData.getUint32(),
                        l = new Float32Array(t.slice(o, o + s)), h = D._readString();
                    switch (D._version) {
                        case"LAYAMODEL:0301":
                        case"LAYAMODEL:0400":
                            a = pt.getVertexDeclaration(h);
                            break;
                        case"LAYAMODEL:0401":
                            a = pt.getVertexDeclaration(h, !1);
                            break;
                        default:
                            throw new Error("LoadModelV03: unknown version.")
                    }
                    if (!a) throw new Error("LoadModelV03: unknown vertexDeclaration.");
                    var u = new Ke(4 * l.length, 35044, !0);
                    u.vertexDeclaration = a, u.setData(l), D._mesh._vertexBuffers.push(u), D._mesh._vertexCount += u.vertexCount, n += 4 * l.length
                }
                var c = r + D._readData.getUint32(), _ = D._readData.getUint32(),
                    d = new Uint16Array(t.slice(c, c + _)), f = new qe("ushort", _ / 2, 35044, !0);
                f.setData(d), n += 2 * (D._mesh._indexBuffer = f).indexCount, D._mesh._setBuffer(D._mesh._vertexBuffers, f), D._mesh._setCPUMemory(n), D._mesh._setGPUMemory(n);
                var m = D._mesh._boneNames = [], p = D._readData.getUint16();
                for (m.length = p, e = 0; e < p; e++) m[e] = D._strings[D._readData.getUint16()];
                D._readData.pos += 8;
                var T = D._readData.getUint32(), E = D._readData.getUint32(),
                    v = new Float32Array(t.slice(r + T, r + T + E)), g = v.length, S = g / 16,
                    y = D._mesh._inverseBindPosesBuffer = new ArrayBuffer(4 * g);
                for (D._mesh._inverseBindPoses = w(S), e = 0; e < g; e += 16) {
                    var x = new He(v[e + 0], v[e + 1], v[e + 2], v[e + 3], v[e + 4], v[e + 5], v[e + 6], v[e + 7], v[e + 8], v[e + 9], v[e + 10], v[e + 11], v[e + 12], v[e + 13], v[e + 14], v[e + 15], new Float32Array(y, 4 * e, 16));
                    D._mesh._inverseBindPoses[e / 16] = x
                }
                return !0
            }, D.READ_SUBMESH = function () {
                var t = D._readData.__getBuffer(), e = new on(D._mesh), n = D._readData.getInt16();
                D._readData.getUint32(), D._readData.getUint32();
                var i = D._readData.getUint32(), r = D._readData.getUint32(), a = D._mesh._indexBuffer;
                e._indexBuffer = a, e._indexStart = i, e._indexCount = r, e._indices = new Uint16Array(a.getData().buffer, 2 * i, r);
                var o = D._mesh._vertexBuffers[n];
                e._vertexBuffer = o;
                var s = D._DATA.offset, l = e._subIndexBufferStart, h = e._subIndexBufferCount, u = e._boneIndicesList,
                    c = D._readData.getUint16();
                l.length = c, h.length = c, u.length = c;
                for (var _ = D._mesh._skinDataPathMarks, d = D._bindPoseIndices, f = D._subMeshes.length, m = 0; m < c; m++) {
                    l[m] = D._readData.getUint32(), h[m] = D._readData.getUint32();
                    for (var p = D._readData.getUint32(), T = D._readData.getUint32(), E = u[m] = new Uint16Array(t.slice(s + p, s + p + T)), v = 0, g = E.length; v < g; v++) {
                        var S = E[v], y = d.indexOf(S);
                        -1 === y ? (E[v] = d.length, d.push(S), _.push([f, m, v])) : E[v] = y
                    }
                }
                return D._subMeshes.push(e), !0
            }, D._strings = [], D._readData = null, D._version = null, D._mesh = null, D._subMeshes = null, D._bindPoseIndices = [], _(D, ["_BLOCK", function () {
                return this._BLOCK = {count: 0}
            }, "_DATA", function () {
                return this._DATA = {offset: 0, size: 0}
            }]), D
        }(), pt = function () {
            function h() {
            }

            return d(h, "laya.d3.graphics.Vertex.VertexMesh"), h.getVertexDeclaration = function (t, e) {
                void 0 === e && (e = !0);
                var n = h._vertexDeclarationMap[t + (e ? "_0" : "_1")];
                if (!n) {
                    for (var i = t.split(","), r = 0, a = [], o = 0, s = i.length; o < s; o++) {
                        var l;
                        switch (i[o]) {
                            case"POSITION":
                                l = new zt(r, "vector3", 0), r += 12;
                                break;
                            case"NORMAL":
                                l = new zt(r, "vector3", 3), r += 12;
                                break;
                            case"COLOR":
                                l = new zt(r, "vector4", 1), r += 16;
                                break;
                            case"UV":
                                l = new zt(r, "vector2", 2), r += 8;
                                break;
                            case"UV1":
                                l = new zt(r, "vector2", 7), r += 8;
                                break;
                            case"BLENDWEIGHT":
                                l = new zt(r, "vector4", 6), r += 16;
                                break;
                            case"BLENDINDICES":
                                e ? (l = new zt(r, "vector4", 5), r += 16) : (l = new zt(r, "byte4", 5), r += 4);
                                break;
                            case"TANGENT":
                                l = new zt(r, "vector4", 4), r += 16;
                                break;
                            default:
                                throw"VertexMesh: unknown vertex flag."
                        }
                        a.push(l)
                    }
                    n = new fe(r, a), h._vertexDeclarationMap[t + (e ? "_0" : "_1")] = n
                }
                return n
            }, h.MESH_POSITION0 = 0, h.MESH_COLOR0 = 1, h.MESH_TEXTURECOORDINATE0 = 2, h.MESH_NORMAL0 = 3, h.MESH_TANGENT0 = 4, h.MESH_BLENDINDICES0 = 5, h.MESH_BLENDWEIGHT0 = 6, h.MESH_TEXTURECOORDINATE1 = 7, h.MESH_WORLDMATRIX_ROW0 = 8, h.MESH_WORLDMATRIX_ROW1 = 9, h.MESH_WORLDMATRIX_ROW2 = 10, h.MESH_WORLDMATRIX_ROW3 = 11, h.MESH_MVPMATRIX_ROW0 = 12, h.MESH_MVPMATRIX_ROW1 = 13, h.MESH_MVPMATRIX_ROW2 = 14, h.MESH_MVPMATRIX_ROW3 = 15, h._vertexDeclarationMap = {}, _(h, ["instanceWorldMatrixDeclaration", function () {
                return this.instanceWorldMatrixDeclaration = new fe(64, [new zt(0, "vector4", 8), new zt(16, "vector4", 9), new zt(32, "vector4", 10), new zt(48, "vector4", 11)])
            }, "instanceMVPMatrixDeclaration", function () {
                return this.instanceMVPMatrixDeclaration = new fe(64, [new zt(0, "vector4", 12), new zt(16, "vector4", 13), new zt(32, "vector4", 14), new zt(48, "vector4", 15)])
            }]), h
        }(), Tt = function () {
            function t() {
                this._destroyed = !1, this._emissionRate = 0, this._bursts = null, this.enbale = !1, this._destroyed = !1, this.emissionRate = 10, this._bursts = []
            }

            d(t, "laya.d3.core.particleShuriKen.module.Emission");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0, "laya.resource.IDestroy": !0}), e.destroy = function () {
                this._bursts = null, this._destroyed = !0
            }, e.getBurstsCount = function () {
                return this._bursts.length
            }, e.getBurstByIndex = function (t) {
                return this._bursts[t]
            }, e.addBurst = function (t) {
                var e = this._bursts.length;
                if (0 < e) for (var n = 0; n < e; n++) this._bursts[n].time > t.time && this._bursts.splice(n, 0, t);
                this._bursts.push(t)
            }, e.removeBurst = function (t) {
                var e = this._bursts.indexOf(t);
                -1 !== e && this._bursts.splice(e, 1)
            }, e.removeBurstByIndex = function (t) {
                this._bursts.splice(t, 1)
            }, e.clearBurst = function () {
                this._bursts.length = 0
            }, e.cloneTo = function (t) {
                var e = t, n = e._bursts;
                n.length = this._bursts.length;
                for (var i = 0, r = this._bursts.length; i < r; i++) {
                    var a = n[i];
                    a ? this._bursts[i].cloneTo(a) : n[i] = this._bursts[i].clone()
                }
                e._emissionRate = this._emissionRate, e.enbale = this.enbale
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, e, "destroyed", function () {
                return this._destroyed
            }), u(0, e, "emissionRate", function () {
                return this._emissionRate
            }, function (t) {
                if (t < 0) throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");
                this._emissionRate = t
            }), t
        }(), Et = function () {
            function u(t, e) {
                this.center = null, this.radius = NaN, this.center = t, this.radius = e
            }

            d(u, "laya.d3.math.BoundSphere");
            var t = u.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.toDefault = function () {
                this.center.toDefault(), this.radius = 0
            }, t.intersectsRayDistance = function (t) {
                return Fe.intersectsRayAndSphereRD(t, this)
            }, t.intersectsRayPoint = function (t, e) {
                return Fe.intersectsRayAndSphereRP(t, this, e)
            }, t.cloneTo = function (t) {
                var e = t;
                this.center.cloneTo(e.center), e.radius = this.radius
            }, t.clone = function () {
                var t = new this.constructor(new Lt, new Lt);
                return this.cloneTo(t), t
            }, u.createFromSubPoints = function (t, e, n, i) {
                if (null == t) throw new Error("points");
                if (e < 0 || e >= t.length) throw new Error("start" + e + "Must be in the range [0, " + (t.length - 1) + "]");
                if (n < 0 || e + n > t.length) throw new Error("count" + n + "Must be in the range <= " + t.length + "}");
                var r = e + n, a = u._tempVector3;
                a.x = 0, a.y = 0, a.z = 0;
                for (var o = e; o < r; ++o) Lt.add(t[o], a, a);
                var s = i.center;
                Lt.scale(a, 1 / n, s);
                var l = 0;
                for (o = e; o < r; ++o) {
                    var h = Lt.distanceSquared(s, t[o]);
                    l < h && (l = h)
                }
                i.radius = Math.sqrt(l)
            }, u.createfromPoints = function (t, e) {
                if (null == t) throw new Error("points");
                u.createFromSubPoints(t, 0, t.length, e)
            }, _(u, ["_tempVector3", function () {
                return this._tempVector3 = new Lt
            }]), u
        }(), vt = function () {
            function t() {
                this.renderType = 0
            }

            d(t, "laya.d3.core.render.RenderElement");
            var e = t.prototype;
            return e.setTransform = function (t) {
                this._transform = t
            }, e.setGeometry = function (t) {
                this._geometry = t
            }, e.addToOpaqueRenderQueue = function (t, e) {
                e.elements.push(this)
            }, e.addToTransparentRenderQueue = function (t, e) {
                e.elements.push(this), e.lastTransparentBatched = !1, e.lastTransparentRenderElement = this
            }, e._render = function (t, e, n, i) {
                var r, a, o, s = Mi._updateMark, l = t.scene, h = t.camera, u = this._transform, c = this._geometry,
                    _ = s !== (t.renderElement = this).render._updateMark || this.renderType !== this.render._updateRenderType;
                if (_ && (this.render._renderUpdate(t, u), this.render._renderUpdateWithCamera(t, u), this.render._updateMark = s, this.render._updateRenderType = this.renderType), c._prepareRender(t)) {
                    var d, f = this.material._shader.getSubShaderAt(0);
                    if (n) if (i) {
                        var m = f.getFlag(i);
                        if (!m) return;
                        for (var p = n._subShaders, T = 0, E = p.length; T < E; T++) {
                            var v = p[T];
                            if (m === v.getFlag(i)) {
                                d = v._passes;
                                break
                            }
                        }
                        if (!d) return
                    } else d = n.getSubShaderAt(0)._passes; else d = f._passes;
                    for (var g = 0, S = d.length; g < S; g++) {
                        var y = t.shader = d[g].withCompile(l._defineDatas.value & ~this.material._disablePublicDefineDatas.value, this.render._defineDatas.value, this.material._defineDatas.value),
                            x = y.bind(), D = s !== y._uploadMark, I = y._uploadScene !== l || D;
                        (I || x) && (y.uploadUniforms(y._sceneUniformParamsMap, l._shaderValues, I), y._uploadScene = l);
                        var R = y._uploadRender !== this.render || y._uploadRenderType !== this.renderType || D;
                        (R || x) && (y.uploadUniforms(y._spriteUniformParamsMap, this.render._shaderValues, R), y._uploadRender = this.render, y._uploadRenderType = this.renderType);
                        var M = y._uploadCamera !== h || D;
                        (M || x) && (y.uploadUniforms(y._cameraUniformParamsMap, h._shaderValues, M), y._uploadCamera = h);
                        var A = y._uploadMaterial !== this.material || D;
                        (A || x) && (y.uploadUniforms(y._materialUniformParamsMap, this.material._shaderValues, A), y._uploadMaterial = this.material);
                        var C = this.material._shaderValues;
                        r !== this.material || a !== y ? (y.uploadRenderStateBlendDepth(C), y.uploadRenderStateFrontFace(C, e, u), r = this.material, a = y, o = this.render) : o !== this.render && (y.uploadRenderStateFrontFace(C, e, u), o = this.render), c._render(t), y._uploadMark = s
                    }
                }
                _ && 0 !== this.renderType && this.render._revertBatchRenderUpdate(t), Mi._updateMark++
            }, e.destroy = function () {
                this._transform = null, this._geometry = null, this.material = null, this.render = null
            }, t.RENDERTYPE_NORMAL = 0, t.RENDERTYPE_STATICBATCH = 1, t.RENDERTYPE_INSTANCEBATCH = 2, t.RENDERTYPE_VERTEXBATCH = 3, t
        }(), gt = function () {
            function i() {
            }

            return d(i, "laya.d3.math.HalfFloatUtils"), i.__init__ = function () {
                for (var t = 0; t < 256; ++t) {
                    var e = t - 127;
                    i._shiftTable[256 | t] = e < -27 ? (i._baseTable[0 | t] = 0, i._baseTable[256 | t] = 32768, i._shiftTable[0 | t] = 24) : e < -14 ? (i._baseTable[0 | t] = 1024 >> -e - 14, i._baseTable[256 | t] = 1024 >> -e - 14 | 32768, i._shiftTable[0 | t] = -e - 1, -e - 1) : e <= 15 ? (i._baseTable[0 | t] = e + 15 << 10, i._baseTable[256 | t] = e + 15 << 10 | 32768, i._shiftTable[0 | t] = 13) : e < 128 ? (i._baseTable[0 | t] = 31744, i._baseTable[256 | t] = 64512, i._shiftTable[0 | t] = 24) : (i._baseTable[0 | t] = 31744, i._baseTable[256 | t] = 64512, i._shiftTable[0 | t] = 13)
                }
                for (i._mantissaTable[0] = 0, t = 1; t < 1024; ++t) {
                    var n = t << 13;
                    for (e = 0; 0 == (8388608 & n);) e -= 8388608, n <<= 1;
                    n &= -8388609, e += 947912704, i._mantissaTable[t] = n | e
                }
                for (t = 1024; t < 2048; ++t) i._mantissaTable[t] = 939524096 + (t - 1024 << 13);
                for (i._exponentTable[0] = 0, t = 1; t < 31; ++t) i._exponentTable[t] = t << 23;
                for (i._exponentTable[31] = 1199570944, i._exponentTable[32] = 2147483648, t = 33; t < 63; ++t) i._exponentTable[t] = 2147483648 + (t - 32 << 23);
                for (i._exponentTable[63] = 3347054592, i._offsetTable[0] = 0, t = 1; t < 64; ++t) i._offsetTable[t] = 32 === t ? 0 : 1024
            }, i.roundToFloat16Bits = function (t) {
                i._floatView[0] = t;
                var e = i._uint32View[0], n = e >> 23 & 511;
                return i._baseTable[n] + ((8388607 & e) >> i._shiftTable[n])
            }, i.convertToNumber = function (t) {
                var e = t >> 10;
                return i._uint32View[0] = i._mantissaTable[i._offsetTable[e] + (1023 & t)] + i._exponentTable[e], i._floatView[0]
            }, _(i, ["_buffer", function () {
                return this._buffer = new ArrayBuffer(4)
            }, "_floatView", function () {
                return this._floatView = new Float32Array(i._buffer)
            }, "_uint32View", function () {
                return this._uint32View = new Uint32Array(i._buffer)
            }, "_baseTable", function () {
                return this._baseTable = new Uint32Array(512)
            }, "_shiftTable", function () {
                return this._shiftTable = new Uint32Array(512)
            }, "_mantissaTable", function () {
                return this._mantissaTable = new Uint32Array(2048)
            }, "_exponentTable", function () {
                return this._exponentTable = new Uint32Array(64)
            }, "_offsetTable", function () {
                return this._offsetTable = new Uint32Array(64)
            }]), i
        }(), St = function () {
            function t() {
                this._vertexBuffer = null, this._indexBuffer = null, this._bufferState = null
            }

            return d(t, "laya.d3.resource.models.SkyMesh"), t.prototype._render = function (t) {
            }, t
        }(), Vt = function () {
            function t(t, e) {
                this._frame = null, this._startFrame = null, this.tiles = null, this.type = 0, this.randomRow = !1, this.rowIndex = 0, this.cycles = 0, this.enableUVChannels = 0, this.enable = !1, this.tiles = new Ot(1, 1), this.type = 0, this.randomRow = !0, this.rowIndex = 0, this.cycles = 1, this.enableUVChannels = 1, this._frame = t, this._startFrame = e
            }

            d(t, "laya.d3.core.particleShuriKen.module.TextureSheetAnimation");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.cloneTo = function (t) {
                var e = t;
                this.tiles.cloneTo(e.tiles), e.type = this.type, e.randomRow = this.randomRow, this._frame.cloneTo(e._frame), this._startFrame.cloneTo(e._startFrame), e.cycles = this.cycles, e.enableUVChannels = this.enableUVChannels, e.enable = this.enable
            }, e.clone = function () {
                var t, e;
                switch (this._frame.type) {
                    case 0:
                        t = Rt.createByConstant(this._frame.constant);
                        break;
                    case 1:
                        t = Rt.createByOverTime(this._frame.frameOverTimeData.clone());
                        break;
                    case 2:
                        t = Rt.createByRandomTwoConstant(this._frame.constantMin, this._frame.constantMax);
                        break;
                    case 3:
                        t = Rt.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(), this._frame.frameOverTimeDataMax.clone())
                }
                switch (this._startFrame.type) {
                    case 0:
                        e = De.createByConstant(this._startFrame.constant);
                        break;
                    case 1:
                        e = De.createByRandomTwoConstant(this._startFrame.constantMin, this._startFrame.constantMax)
                }
                var n = new this.constructor(t, e);
                return this.tiles.cloneTo(n.tiles), n.type = this.type, n.randomRow = this.randomRow, n.cycles = this.cycles, n.enableUVChannels = this.enableUVChannels, n.enable = this.enable, n
            }, u(0, e, "frame", function () {
                return this._frame
            }), u(0, e, "startFrame", function () {
                return this._startFrame
            }), t
        }(), yt = function () {
            function t() {
            }

            return d(t, "laya.d3.resource.TextureGenerator"), t.lightAttenTexture = function (t, e, n, i, r, a) {
                var o = t / n, s = 1 / (1 + 25 * o);
                .64 <= o && (1 < o ? s = 0 : s *= 1 - (o - .64) / .36), a[r] = Math.floor(255 * s + .5)
            }, t.haloTexture = function (t, e, n, i, r, a) {
                var o = (t - (n >>= 1)) / n, s = (e - (i >>= 1)) / i, l = o * o + s * s;
                1 < l && (l = 1), a[r] = Math.floor(255 * (1 - l) + .5)
            }, t._generateTexture2D = function (t, e, n, i) {
                var r = 0, a = 0;
                switch (t.format) {
                    case 0:
                        a = 3;
                        break;
                    case 1:
                        a = 4;
                        break;
                    case 2:
                        a = 1;
                        break;
                    default:
                        throw"GeneratedTexture._generateTexture: unkonw texture format."
                }
                for (var o = new Uint8Array(e * n * a), s = 0; s < n; s++) for (var l = 0; l < e; l++) i(l, s, e, n, r, o), r += a;
                t.setPixels(o)
            }, t
        }(), Pt = function () {
            function r(t, e, n, i) {
                this._attributeMap = null, this._uniformMap = null, this._enableInstancing = !1, this._subShaders = [], this._name = t, this._attributeMap = e, this._uniformMap = n, this._enableInstancing = i
            }

            d(r, "laya.d3.shader.Shader3D");
            var t = r.prototype;
            return t.addSubShader = function (t) {
                this._subShaders.push(t), t._owner = this
            }, t.getSubShaderAt = function (t) {
                return this._subShaders[t]
            }, r.propertyNameToID = function (t) {
                if (null != r._propertyNameMap[t]) return r._propertyNameMap[t];
                var e = r._propertyNameCounter++;
                return r._propertyNameMap[t] = e
            }, r.addInclude = function (t, e) {
                I.addInclude(t, e)
            }, r.registerPublicDefine = function (t) {
                var e = Math.pow(2, r._publicCounter++);
                return r._globleDefines[e] = t, e
            }, r.compileShader = function (t, e, n, i, r, a) {
                var o = laya.d3.shader.Shader3D.find(t);
                if (o) {
                    var s = o.getSubShaderAt(e);
                    if (s) {
                        var l = s._passes[n];
                        l && (N.shaderHighPrecision ? l.withCompile(i, r, a) : l.withCompile(i - laya.d3.shader.Shader3D.SHADERDEFINE_HIGHPRECISION, r, a))
                    }
                }
            }, r.add = function (t, e, n, i) {
                return void 0 === i && (i = !1), laya.d3.shader.Shader3D._preCompileShader[t] = new r(t, e, n, i)
            }, r.find = function (t) {
                return laya.d3.shader.Shader3D._preCompileShader[t]
            }, r.RENDER_STATE_CULL = 0, r.RENDER_STATE_BLEND = 1, r.RENDER_STATE_BLEND_SRC = 2, r.RENDER_STATE_BLEND_DST = 3, r.RENDER_STATE_BLEND_SRC_RGB = 4, r.RENDER_STATE_BLEND_DST_RGB = 5, r.RENDER_STATE_BLEND_SRC_ALPHA = 6, r.RENDER_STATE_BLEND_DST_ALPHA = 7, r.RENDER_STATE_BLEND_CONST_COLOR = 8, r.RENDER_STATE_BLEND_EQUATION = 9, r.RENDER_STATE_BLEND_EQUATION_RGB = 10, r.RENDER_STATE_BLEND_EQUATION_ALPHA = 11, r.RENDER_STATE_DEPTH_TEST = 12, r.RENDER_STATE_DEPTH_WRITE = 13, r.PERIOD_CUSTOM = 0, r.PERIOD_MATERIAL = 1, r.PERIOD_SPRITE = 2, r.PERIOD_CAMERA = 3, r.PERIOD_SCENE = 4, r.SHADERDEFINE_HIGHPRECISION = 0, r._propertyNameCounter = 0, r._propertyNameMap = {}, r._publicCounter = 0, r._globleDefines = [], r._preCompileShader = {}, r.debugMode = !1, r
        }(), xt = function () {
            function t(t) {
                this._temp = new Uint32Array(1), this.seeds = new Uint32Array(4), this.seeds[0] = t, this.seeds[1] = 1812433253 * this.seeds[0] + 1, this.seeds[2] = 1812433253 * this.seeds[1] + 1, this.seeds[3] = 1812433253 * this.seeds[2] + 1
            }

            d(t, "laya.d3.math.Rand");
            var e = t.prototype;
            return e.getUint = function () {
                return this._temp[0] = this.seeds[0] ^ this.seeds[0] << 11, this.seeds[0] = this.seeds[1], this.seeds[1] = this.seeds[2], this.seeds[2] = this.seeds[3], this.seeds[3] = this.seeds[3] ^ this.seeds[3] >>> 19 ^ this._temp[0] ^ this._temp[0] >>> 8, this.seeds[3]
            }, e.getFloat = function () {
                return this.getUint(), (8388607 & this.seeds[3]) * (1 / 8388607)
            }, e.getSignedFloat = function () {
                return 2 * this.getFloat() - 1
            }, u(0, e, "seed", function () {
                return this.seeds[0]
            }, function (t) {
                this.seeds[0] = t, this.seeds[1] = 1812433253 * this.seeds[0] + 1, this.seeds[2] = 1812433253 * this.seeds[1] + 1, this.seeds[3] = 1812433253 * this.seeds[2] + 1
            }), t.getFloatFromInt = function (t) {
                return 1 / 8388607 * (8388607 & t)
            }, t.getByteFromInt = function (t) {
                return (8388607 & t) >>> 15
            }, t
        }(), wt = function () {
            function E() {
                this._currentPSSM = -1, this._shadowMapCount = 3, this._maxDistance = 200, this._ratioOfDistance = 1 / this._shadowMapCount, this._statesDirty = !0, this._shadowMapTextureSize = 1024, this._scene = null, this._PCFType = 0, this._shaderValueLightVP = null, this._spiltDistance = new Array(4), this._globalParallelLightDir = new Lt(0, -1, 0), this._boundingSphere = new Array(4), this._boundingBox = new Array(4), this._frustumPos = new Array(16), this._uniformDistance = new Array(4), this._logDistance = new Array(4), this._dimension = new Array(4), this._tempLookAt3 = new Lt, this._tempLookAt4 = new Ct, this._tempValue = new Ct, this._tempPos = new Lt, this._tempLightUp = new Lt, this._tempMin = new Ct, this._tempMax = new Ct, this._tempMatrix44 = new He, this._splitFrustumCulling = new Ve(He.DEFAULT), this._tempScaleMatrix44 = new He, this._shadowPCFOffset = new Ot(1 / 1024, 1 / 1024), this._shaderValueDistance = new Ct, this.cameras = [], this._shaderValueVPs = [];
                var t = 0;
                for (t = 0; t < this._spiltDistance.length; t++) this._spiltDistance[t] = 0;
                for (t = 0; t < this._dimension.length; t++) this._dimension[t] = new Ot;
                for (t = 0; t < this._frustumPos.length; t++) this._frustumPos[t] = new Lt;
                for (t = 0; t < this._boundingBox.length; t++) this._boundingBox[t] = new ze(new Lt, new Lt);
                for (t = 0; t < this._boundingSphere.length; t++) this._boundingSphere[t] = new Et(new Lt, 0);
                He.createScaling(new Lt(.5, .5, 1), this._tempScaleMatrix44), this._tempScaleMatrix44.elements[12] = .5, this._tempScaleMatrix44.elements[13] = .5
            }

            d(E, "laya.d3.shadowMap.ParallelSplitShadowMap");
            var t = E.prototype;
            return t.setInfo = function (t, e, n, i, r, a) {
                3 < r && (this._shadowMapCount = 3), this._scene = t, this._maxDistance = e, this.shadowMapCount = r, this._globalParallelLightDir = n, this._ratioOfDistance = 1 / this._shadowMapCount;
                for (var o = 0; o < this._spiltDistance.length; o++) this._spiltDistance[o] = 0;
                this._shadowMapTextureSize = i, this._shadowPCFOffset.x = 1 / this._shadowMapTextureSize, this._shadowPCFOffset.y = 1 / this._shadowMapTextureSize, this.setPCFType(a), this._statesDirty = !0
            }, t.setPCFType = function (t) {
                this._PCFType = t;
                var e = this._scene._defineDatas;
                switch (this._PCFType) {
                    case 0:
                        e.add(Qn.SHADERDEFINE_SHADOW_PCF_NO), e.remove(Qn.SHADERDEFINE_SHADOW_PCF1), e.remove(Qn.SHADERDEFINE_SHADOW_PCF2), e.remove(Qn.SHADERDEFINE_SHADOW_PCF3);
                        break;
                    case 1:
                        e.add(Qn.SHADERDEFINE_SHADOW_PCF1), e.remove(Qn.SHADERDEFINE_SHADOW_PCF_NO), e.remove(Qn.SHADERDEFINE_SHADOW_PCF2), e.remove(Qn.SHADERDEFINE_SHADOW_PCF3);
                        break;
                    case 2:
                        e.add(Qn.SHADERDEFINE_SHADOW_PCF2), e.remove(Qn.SHADERDEFINE_SHADOW_PCF_NO), e.remove(Qn.SHADERDEFINE_SHADOW_PCF1), e.remove(Qn.SHADERDEFINE_SHADOW_PCF3);
                        break;
                    case 3:
                        e.add(Qn.SHADERDEFINE_SHADOW_PCF3), e.remove(Qn.SHADERDEFINE_SHADOW_PCF_NO), e.remove(Qn.SHADERDEFINE_SHADOW_PCF1), e.remove(Qn.SHADERDEFINE_SHADOW_PCF2)
                }
            }, t.getPCFType = function () {
                return this._PCFType
            }, t.setFarDistance = function (t) {
                this._maxDistance != t && (this._maxDistance = t, this._statesDirty = !0)
            }, t.getFarDistance = function () {
                return this._maxDistance
            }, t._beginSampler = function (t, e) {
                if (t < 0 || t > this._shadowMapCount) throw new Error("ParallelSplitShadowMap: beginSample invalid index");
                this._currentPSSM = t, this._update(e)
            }, t.endSampler = function (t) {
                this._currentPSSM = -1
            }, t._calcAllLightCameraInfo = function (t) {
                if (1 === this._shadowMapCount) this._beginSampler(0, t), this.endSampler(t); else for (var e = 0, n = this._shadowMapCount + 1; e < n; e++) this._beginSampler(e, t), this.endSampler(t)
            }, t._recalculate = function (t, e, n) {
                this._calcSplitDistance(t), this._calcBoundingBox(e, n), this._rebuildRenderInfo()
            }, t._update = function (t) {
                var e = t.nearPlane, n = t.fieldOfView, i = t.aspectRatio;
                (this._statesDirty || this.lastNearPlane !== e || this.lastFieldOfView !== n || this.lastAspectRatio !== i) && (this._recalculate(e, n, i), this._uploadShaderValue(), this._statesDirty = !1, this.lastNearPlane = e, this.lastFieldOfView = n, this.lastAspectRatio = i), this._calcLightViewProject(t)
            }, t._uploadShaderValue = function () {
                var t = this._scene._defineDatas;
                switch (this._shadowMapCount) {
                    case 1:
                        t.add(Qn.SHADERDEFINE_SHADOW_PSSM1), t.remove(Qn.SHADERDEFINE_SHADOW_PSSM2), t.remove(Qn.SHADERDEFINE_SHADOW_PSSM3);
                        break;
                    case 2:
                        t.add(Qn.SHADERDEFINE_SHADOW_PSSM2), t.remove(Qn.SHADERDEFINE_SHADOW_PSSM1), t.remove(Qn.SHADERDEFINE_SHADOW_PSSM3);
                        break;
                    case 3:
                        t.add(Qn.SHADERDEFINE_SHADOW_PSSM3), t.remove(Qn.SHADERDEFINE_SHADOW_PSSM1), t.remove(Qn.SHADERDEFINE_SHADOW_PSSM2)
                }
                var e = this._scene._shaderValues;
                switch (e.setVector(Qn.SHADOWDISTANCE, this._shaderValueDistance), e.setBuffer(Qn.SHADOWLIGHTVIEWPROJECT, this._shaderValueLightVP), e.setVector2(Qn.SHADOWMAPPCFOFFSET, this._shadowPCFOffset), this._shadowMapCount) {
                    case 3:
                        e.setTexture(Qn.SHADOWMAPTEXTURE1, this.cameras[1].renderTarget), e.setTexture(Qn.SHADOWMAPTEXTURE2, this.cameras[2].renderTarget), e.setTexture(Qn.SHADOWMAPTEXTURE3, this.cameras[3].renderTarget);
                        break;
                    case 2:
                        e.setTexture(Qn.SHADOWMAPTEXTURE1, this.cameras[1].renderTarget), e.setTexture(Qn.SHADOWMAPTEXTURE2, this.cameras[2].renderTarget);
                        break;
                    case 1:
                        e.setTexture(Qn.SHADOWMAPTEXTURE1, this.cameras[1].renderTarget)
                }
            }, t._calcSplitDistance = function (t) {
                var e = this._maxDistance, n = 1 / this._shadowMapCount, i = 0;
                for (i = 0; i <= this._shadowMapCount; i++) this._uniformDistance[i] = t + (e - t) * i * n;
                var r = e / t;
                for (i = 0; i <= this._shadowMapCount; i++) {
                    var a = Math.pow(r, i * n);
                    this._logDistance[i] = t * a
                }
                for (i = 0; i <= this._shadowMapCount; i++) this._spiltDistance[i] = this._uniformDistance[i] * this._ratioOfDistance + this._logDistance[i] * (1 - this._ratioOfDistance);
                this._shaderValueDistance.x = this._spiltDistance[1], this._shaderValueDistance.y = this._spiltDistance[2], this._shaderValueDistance.z = this._spiltDistance[3], this._shaderValueDistance.w = 0
            }, t._calcBoundingBox = function (t, e) {
                var n, i, r, a, o = 3.1415926 * t / 180, s = Math.tan(o / 2), l = NaN, h = NaN, u = NaN, c = 0;
                for (c = 0; c <= this._shadowMapCount; c++) {
                    h = (l = (u = this._spiltDistance[c]) * s) * e;
                    var _ = this._frustumPos[4 * c + 0];
                    _.x = -h, _.y = -l, _.z = -u, (_ = this._frustumPos[4 * c + 1]).x = h, _.y = -l, _.z = -u, (_ = this._frustumPos[4 * c + 2]).x = -h, _.y = l, _.z = -u, (_ = this._frustumPos[4 * c + 3]).x = h, _.y = l, _.z = -u, (_ = this._dimension[c]).x = h, _.y = l
                }
                for (c = 1; c <= this._shadowMapCount; c++) n = this._dimension[c], (i = this._boundingBox[c].min).x = -n.x, i.y = -n.y, i.z = -this._spiltDistance[c], (r = this._boundingBox[c].max).x = n.x, r.y = n.y, r.z = -this._spiltDistance[c - 1], (a = this._boundingSphere[c].center).x = .5 * (i.x + r.x), a.y = .5 * (i.y + r.y), a.z = .5 * (i.z + r.z), this._boundingSphere[c].radius = .5 * Math.sqrt(Math.pow(r.x - i.x, 2) + Math.pow(r.y - i.y, 2) + Math.pow(r.z - i.z, 2));
                i = this._boundingBox[0].min, n = this._dimension[this._shadowMapCount], i.x = -n.x, i.y = -n.y, i.z = -this._spiltDistance[this._shadowMapCount], (r = this._boundingBox[0].max).x = n.x, r.y = n.y, r.z = -this._spiltDistance[0], (a = this._boundingSphere[0].center).x = .5 * (i.x + r.x), a.y = .5 * (i.y + r.y), a.z = .5 * (i.z + r.z), this._boundingSphere[0].radius = .5 * Math.sqrt(Math.pow(r.x - i.x, 2) + Math.pow(r.y - i.y, 2) + Math.pow(r.z - i.z, 2))
            }, t.calcSplitFrustum = function (t) {
                0 < this._currentPSSM ? He.createPerspective(3.1416 * t.fieldOfView / 180, t.aspectRatio, this._spiltDistance[this._currentPSSM - 1], this._spiltDistance[this._currentPSSM], this._tempMatrix44) : He.createPerspective(3.1416 * t.fieldOfView / 180, t.aspectRatio, this._spiltDistance[0], this._spiltDistance[this._shadowMapCount], this._tempMatrix44), He.multiply(this._tempMatrix44, t.viewMatrix, this._tempMatrix44), this._splitFrustumCulling.matrix = this._tempMatrix44
            }, t._rebuildRenderInfo = function () {
                var t = this._shadowMapCount + 1, e = 0;
                for (this.cameras.length = t, e = 0; e < t; e++) {
                    if (!this.cameras[e]) {
                        var n = new Mi;
                        n.name = "lightCamera" + e, n.clearColor = new Ct(1, 1, 1, 1), this.cameras[e] = n
                    }
                    var i = this.cameras[e].renderTarget;
                    null != i && i.width == this._shadowMapTextureSize && i.height == this._shadowMapTextureSize || (i && i.destroy(), (i = new pi(this._shadowMapTextureSize, this._shadowMapTextureSize, 1, 0)).filterMode = 0, this.cameras[e].renderTarget = i)
                }
            }, t._calcLightViewProject = function (t) {
                var e = this._boundingSphere[this._currentPSSM], n = t.transform.worldMatrix;
                e.radius;
                e.center.cloneTo(this._tempLookAt3), Lt.transformV3ToV4(this._tempLookAt3, n, this._tempLookAt4);
                var i = this._tempLookAt3, r = this._tempLookAt4;
                i.x = r.x, i.y = r.y, i.z = r.z;
                var a = this._tempLightUp;
                t.transform.worldMatrix.getForward(E._tempVector30);
                var o = E._tempVector30;
                a.x = o.x, a.y = 1, a.z = o.z, Lt.normalize(this._tempLightUp, this._tempLightUp), Lt.scale(this._globalParallelLightDir, 4 * e.radius, this._tempPos), Lt.subtract(this._tempLookAt3, this._tempPos, this._tempPos);
                var s = this.cameras[this._currentPSSM];
                s.transform.position = this._tempPos, s.transform.lookAt(this._tempLookAt3, this._tempLightUp, !1);
                var l = this._tempMax, h = this._tempMin;
                l.x = l.y = l.z = -1e5, l.w = 1, h.x = h.y = h.z = 1e5, h.w = 1, He.multiply(s.viewMatrix, n, this._tempMatrix44);
                var u = this._tempValue, c = [];
                c.length = 8, this._boundingBox[this._currentPSSM].getCorners(c);
                for (var _ = 0; _ < 8; _++) {
                    var d = c[_];
                    u.x = d.x, u.y = d.y, u.z = d.z, u.w = 1, Ct.transformByM4x4(this._tempValue, this._tempMatrix44, this._tempValue), h.x = u.x < h.x ? u.x : h.x, h.y = u.y < h.y ? u.y : h.y, h.z = u.z < h.z ? u.z : h.z, l.x = u.x > l.x ? u.x : l.x, l.y = u.y > l.y ? u.y : l.y, l.z = u.z > l.z ? u.z : l.z
                }
                Ct.add(this._tempMax, this._tempMin, this._tempValue), u.x *= .5, u.y *= .5, u.z *= .5, u.w = 1, Ct.transformByM4x4(this._tempValue, s.transform.worldMatrix, this._tempValue);
                var f = Math.abs(-this._tempMax.z), m = f > this._maxDistance ? f : this._maxDistance;
                Lt.scale(this._globalParallelLightDir, m, this._tempPos);
                var p = this._tempPos;
                p.x = u.x - p.x, p.y = u.y - p.y, p.z = u.z - p.z, s.transform.position = this._tempPos, s.transform.lookAt(this._tempLookAt3, this._tempLightUp, !1), He.createOrthoOffCenter(h.x, l.x, h.y, l.y, 1, m + .5 * (l.z - h.z), s.projectionMatrix);
                var T = s.projectionViewMatrix;
                E.multiplyMatrixOutFloat32Array(this._tempScaleMatrix44, T, this._shaderValueVPs[this._currentPSSM]), this._scene._shaderValues.setBuffer(Qn.SHADOWLIGHTVIEWPROJECT, this._shaderValueLightVP)
            }, t.setShadowMapTextureSize = function (t) {
                t !== this._shadowMapTextureSize && (this._shadowMapTextureSize = t, this._shadowPCFOffset.x = 1 / this._shadowMapTextureSize, this._shadowPCFOffset.y = 1 / this._shadowMapTextureSize, this._statesDirty = !0)
            }, t.disposeAllRenderTarget = function () {
                for (var t = 0, e = this._shadowMapCount + 1; t < e; t++) this.cameras[t].renderTarget && (this.cameras[t].renderTarget.destroy(), this.cameras[t].renderTarget = null)
            }, u(0, t, "shadowMapCount", function () {
                return this._shadowMapCount
            }, function (t) {
                if (t = (t = 0 < t ? t : 1) <= 3 ? t : 3, this._shadowMapCount != t) {
                    this._shadowMapCount = t, this._ratioOfDistance = 1 / this._shadowMapCount, this._statesDirty = !0, this._shaderValueLightVP = new Float32Array(16 * t), this._shaderValueVPs.length = t;
                    for (var e = 0; e < t; e++) this._shaderValueVPs[e] = new Float32Array(this._shaderValueLightVP.buffer, 64 * e)
                }
            }), E.multiplyMatrixOutFloat32Array = function (t, e, n) {
                var i, r, a, o, s, l, h;
                for (r = t.elements, a = e.elements, i = 0; i < 4; i++) o = r[i], s = r[i + 4], l = r[i + 8], h = r[i + 12], n[i] = o * a[0] + s * a[1] + l * a[2] + h * a[3], n[i + 4] = o * a[4] + s * a[5] + l * a[6] + h * a[7], n[i + 8] = o * a[8] + s * a[9] + l * a[10] + h * a[11], n[i + 12] = o * a[12] + s * a[13] + l * a[14] + h * a[15]
            }, E.MAX_PSSM_COUNT = 3, _(E, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }]), E
        }(), bt = (function () {
            function L() {
            }

            d(L, "laya.d3.resource.models.PrimitiveMesh"), L._createMesh = function (t, e, n) {
                var i = new Gn, r = new on(i), a = new Ke(4 * e.length, 35044, !0);
                a.vertexDeclaration = t, a.setData(e), i._vertexBuffers.push(a), i._vertexCount += a.vertexCount;
                var o = new qe("ushort", n.length, 35044, !0);
                o.setData(n), i._indexBuffer = o;
                var s = w(1, null);
                s[0] = a, i._setBuffer(s, o), r._vertexBuffer = a, r._indexBuffer = o, r._indexStart = 0, r._indexCount = o.indexCount;
                var l = r._subIndexBufferStart, h = r._subIndexBufferCount, u = r._boneIndicesList;
                l.length = 1, h.length = 1, u.length = 1, h[l[0] = 0] = o.indexCount;
                var c = [];
                c.push(r), i._setSubMeshes(c);
                var _ = a._byteLength + o._byteLength;
                return i._setCPUMemory(_), i._setGPUMemory(_), i
            }, L.createBox = function (t, e, n) {
                void 0 === t && (t = 1), void 0 === e && (e = 1), void 0 === n && (n = 1);
                var i = pt.getVertexDeclaration("POSITION,NORMAL,UV"), r = t / 2, a = e / 2, o = n / 2,
                    s = new Float32Array([-r, a, -o, 0, 1, 0, 0, 0, r, a, -o, 0, 1, 0, 1, 0, r, a, o, 0, 1, 0, 1, 1, -r, a, o, 0, 1, 0, 0, 1, -r, -a, -o, 0, -1, 0, 0, 1, r, -a, -o, 0, -1, 0, 1, 1, r, -a, o, 0, -1, 0, 1, 0, -r, -a, o, 0, -1, 0, 0, 0, -r, a, -o, -1, 0, 0, 0, 0, -r, a, o, -1, 0, 0, 1, 0, -r, -a, o, -1, 0, 0, 1, 1, -r, -a, -o, -1, 0, 0, 0, 1, r, a, -o, 1, 0, 0, 1, 0, r, a, o, 1, 0, 0, 0, 0, r, -a, o, 1, 0, 0, 0, 1, r, -a, -o, 1, 0, 0, 1, 1, -r, a, o, 0, 0, 1, 0, 0, r, a, o, 0, 0, 1, 1, 0, r, -a, o, 0, 0, 1, 1, 1, -r, -a, o, 0, 0, 1, 0, 1, -r, a, -o, 0, 0, -1, 1, 0, r, a, -o, 0, 0, -1, 0, 0, r, -a, -o, 0, 0, -1, 0, 1, -r, -a, -o, 0, 0, -1, 1, 1]),
                    l = new Uint16Array([0, 1, 2, 2, 3, 0, 4, 7, 6, 6, 5, 4, 8, 9, 10, 10, 11, 8, 12, 15, 14, 14, 13, 12, 16, 17, 18, 18, 19, 16, 20, 23, 22, 22, 21, 20]);
                return L._createMesh(i, s, l)
            }, L.createCapsule = function (t, e, n, i) {
                void 0 === t && (t = .5), void 0 === e && (e = 2), void 0 === n && (n = 16), void 0 === i && (i = 32);
                var r = (n + 1) * (i + 1) * 2 + 2 * (i + 1), a = 3 * n * (i + 1) * 2 * 2 + 2 * i * 3,
                    o = pt.getVertexDeclaration("POSITION,NORMAL,UV"), s = o.vertexStride / 4,
                    l = new Float32Array(r * s), h = new Uint16Array(a), u = Math.PI / 2 / n, c = 2 * Math.PI / i,
                    _ = e / 2 - t, d = 0, f = 0, m = 0, p = 0, T = 0, E = 0, v = 0, g = 0;
                for (v = 0; v <= n; v++) for (g = 0; g <= i; g++) d = t * Math.cos(v * u) * Math.cos(g * c + Math.PI), f = t * Math.sin(v * u), m = t * Math.cos(v * u) * Math.sin(g * c + Math.PI), l[p++] = d, l[p++] = f + _, l[p++] = m, l[p++] = d, l[p++] = f, l[p++] = m, l[p++] = 1 - g / i, l[p++] = (1 - v / n) * (Math.PI * t / 2 / (e + Math.PI * t)), v < n && (h[T++] = v * (i + 1) + g + (i + 1), h[T++] = v * (i + 1) + g, h[T++] = v * (i + 1) + g + 1, h[T++] = v * (i + 1) + g + i, h[T++] = v * (i + 1) + g, h[T++] = v * (i + 1) + g + (i + 1));
                for (E += (n + 1) * (i + 1), v = 0; v <= n; v++) for (g = 0; g <= i; g++) d = t * Math.cos(v * u) * Math.cos(g * c + Math.PI), f = t * Math.sin(-v * u), m = t * Math.cos(v * u) * Math.sin(g * c + Math.PI), l[p++] = d, l[p++] = f - _, l[p++] = m, l[p++] = d, l[p++] = f, l[p++] = m, l[p++] = 1 - g / i, l[p++] = (v / n * (Math.PI * t / 2) + (e + Math.PI * t / 2)) / (e + Math.PI * t), v < n && (h[T++] = E + v * (i + 1) + g, h[T++] = E + v * (i + 1) + g + (i + 1), h[T++] = E + v * (i + 1) + g + 1, h[T++] = E + v * (i + 1) + g, h[T++] = E + v * (i + 1) + g + i, h[T++] = E + v * (i + 1) + g + (i + 1));
                for (E += (n + 1) * (i + 1), g = 0; g <= i; g++) d = t * Math.cos(g * c + Math.PI), f = _, m = t * Math.sin(g * c + Math.PI), l[p++] = d, l[p + 8 * (i + 1) - 1] = d, l[p++] = f, l[p + 8 * (i + 1) - 1] = -f, l[p++] = m, l[p + 8 * (i + 1) - 1] = m, l[p++] = d, l[p + 8 * (i + 1) - 1] = d, l[p++] = 0, l[p + 8 * (i + 1) - 1] = 0, l[p++] = m, l[p + 8 * (i + 1) - 1] = m, l[p++] = 1 - 1 * g / i, l[p + 8 * (i + 1) - 1] = 1 - 1 * g / i, l[p++] = Math.PI * t / 2 / (e + Math.PI * t), l[p + 8 * (i + 1) - 1] = (Math.PI * t / 2 + e) / (e + Math.PI * t);
                for (g = 0; g < i; g++) h[T++] = g + E + (i + 1), h[T++] = g + E + 1, h[T++] = g + E, h[T++] = g + E + (i + 1), h[T++] = g + E + (i + 1) + 1, h[T++] = g + E + 1;
                return E += 2 * (i + 1), L._createMesh(o, l, h)
            }, L.createCone = function (t, e, n) {
                void 0 === t && (t = .5), void 0 === e && (e = 1), void 0 === n && (n = 32);
                for (var i = n + 1 + 1 + 2 * (n + 1), r = 6 * n + 3 * n, a = pt.getVertexDeclaration("POSITION,NORMAL,UV"), o = a.vertexStride / 4, s = new Float32Array(i * o), l = new Uint16Array(r), h = 2 * Math.PI / n, u = e / 2, c = 0, _ = 0, d = 0, f = 0, m = 0, p = new Lt, T = new Lt(0, -1, 0), E = new Lt(0, u, 0), v = new Lt, g = new Lt, S = new at, y = new Lt, x = NaN, D = 0, I = 0, R = 0; R <= n; R++) c = R * h, d = Math.cos(c + Math.PI) * t, f = u, m = Math.sin(c + Math.PI) * t, s[D++] = 0, s[D + 8 * (n + 1) - 1] = d, s[D++] = f, s[D + 8 * (n + 1) - 1] = -f, s[D++] = 0, s[D + 8 * (n + 1) - 1] = m, p.x = d, p.y = 0, p.z = m, v.x = d, v.y = -f, v.z = m, Lt.subtract(v, E, g), Lt.normalize(g, g), x = Math.acos(Lt.dot(T, g)), Lt.cross(T, g, y), Lt.normalize(y, y), at.createFromAxisAngle(y, x, S), Lt.normalize(p, p), Lt.transformQuat(p, S, p), Lt.normalize(p, p), s[D++] = p.x, s[D + 8 * (n + 1) - 1] = p.x, s[D++] = p.y, s[D + 8 * (n + 1) - 1] = p.y, s[D++] = p.z, s[D + 8 * (n + 1) - 1] = p.z, s[D++] = 1 - 1 * R / n, s[D + 8 * (n + 1) - 1] = 1 - 1 * R / n, s[D++] = 0, s[D + 8 * (n + 1) - 1] = 1;
                D += 8 * (n + 1);
                for (var M = 0; M < n; M++) l[I++] = M + _ + (n + 1), l[I++] = M + _ + 1, l[I++] = M + _, l[I++] = M + _ + (n + 1), l[I++] = M + _ + (n + 1) + 1, l[I++] = M + _ + 1;
                _ += 2 * (n + 1);
                for (var A = 0; A <= n; A++) 0 === A && (s[D++] = 0, s[D++] = -u, s[D++] = 0, s[D++] = 0, s[D++] = -1, s[D++] = 0, s[D++] = .5, s[D++] = .5), c = A * h, d = Math.cos(c + Math.PI) * t, f = -u, m = Math.sin(c + Math.PI) * t, s[D++] = d, s[D++] = f, s[D++] = m, s[D++] = 0, s[D++] = -1, s[D++] = 0, s[D++] = .5 + .5 * Math.cos(c), s[D++] = .5 + .5 * Math.sin(c);
                for (var C = 0; C < n; C++) l[I++] = 0 + _, l[I++] = C + 2 + _, l[I++] = C + 1 + _;
                return _ += n + 1 + 1, L._createMesh(a, s, l)
            }, L.createCylinder = function (t, e, n) {
                void 0 === t && (t = .5), void 0 === e && (e = 2), void 0 === n && (n = 32);
                for (var i = n + 1 + 1 + 2 * (n + 1) + (n + 1 + 1), r = 3 * n + 6 * n + 3 * n, a = pt.getVertexDeclaration("POSITION,NORMAL,UV"), o = a.vertexStride / 4, s = new Float32Array(i * o), l = new Uint16Array(r), h = 2 * Math.PI / n, u = e / 2, c = 0, _ = 0, d = 0, f = 0, m = 0, p = 0, T = 0, E = 0; E <= n; E++) 0 === E && (s[p++] = 0, s[p++] = u, s[p++] = 0, s[p++] = 0, s[p++] = 1, s[p++] = 0, s[p++] = .5, s[p++] = .5), c = E * h, d = Math.cos(c) * t, f = u, m = Math.sin(c) * t, s[p++] = d, s[p++] = f, s[p++] = m, s[p++] = 0, s[p++] = 1, s[p++] = 0, s[p++] = .5 + .5 * Math.cos(c), s[p++] = .5 + .5 * Math.sin(c);
                for (var v = 0; v < n; v++) l[T++] = 0, l[T++] = v + 1, l[T++] = v + 2;
                _ += n + 1 + 1;
                for (var g = 0; g <= n; g++) c = g * h, d = Math.cos(c + Math.PI) * t, f = u, m = Math.sin(c + Math.PI) * t, s[p++] = d, s[p + 8 * (n + 1) - 1] = d, s[p++] = f, s[p + 8 * (n + 1) - 1] = -f, s[p++] = m, s[p + 8 * (n + 1) - 1] = m, s[p++] = d, s[p + 8 * (n + 1) - 1] = d, s[p++] = 0, s[p + 8 * (n + 1) - 1] = 0, s[p++] = m, s[p + 8 * (n + 1) - 1] = m, s[p++] = 1 - 1 * g / n, s[p + 8 * (n + 1) - 1] = 1 - 1 * g / n, s[p++] = 0, s[p + 8 * (n + 1) - 1] = 1;
                p += 8 * (n + 1);
                for (var S = 0; S < n; S++) l[T++] = S + _ + (n + 1), l[T++] = S + _ + 1, l[T++] = S + _, l[T++] = S + _ + (n + 1), l[T++] = S + _ + (n + 1) + 1, l[T++] = S + _ + 1;
                _ += 2 * (n + 1);
                for (var y = 0; y <= n; y++) 0 === y && (s[p++] = 0, s[p++] = -u, s[p++] = 0, s[p++] = 0, s[p++] = -1, s[p++] = 0, s[p++] = .5, s[p++] = .5), c = y * h, d = Math.cos(c + Math.PI) * t, f = -u, m = Math.sin(c + Math.PI) * t, s[p++] = d, s[p++] = f, s[p++] = m, s[p++] = 0, s[p++] = -1, s[p++] = 0, s[p++] = .5 + .5 * Math.cos(c), s[p++] = .5 + .5 * Math.sin(c);
                for (var x = 0; x < n; x++) l[T++] = 0 + _, l[T++] = x + 2 + _, l[T++] = x + 1 + _;
                return _ += n + 1 + 1, L._createMesh(a, s, l)
            }, L.createPlane = function (t, e, n, i) {
                void 0 === t && (t = 10), void 0 === e && (e = 10), void 0 === n && (n = 10), void 0 === i && (i = 10);
                for (var r = (n + 1) * (i + 1), a = new Uint16Array(n * i * 2 * 3), o = pt.getVertexDeclaration("POSITION,NORMAL,UV"), s = o.vertexStride / 4, l = new Float32Array(r * s), h = t / 2, u = e / 2, c = t / n, _ = e / i, d = 0, f = 0; f <= i; f++) for (var m = 0; m <= n; m++) l[d++] = m * c - h, l[d++] = 0, l[d++] = f * _ - u, l[d++] = 0, l[d++] = 1, l[d++] = 0, l[d++] = 1 * m / n, l[d++] = 1 * f / i;
                var p = 0;
                for (f = 0; f < i; f++) for (m = 0; m < n; m++) a[p++] = (f + 1) * (n + 1) + m, a[p++] = f * (n + 1) + m, a[p++] = (f + 1) * (n + 1) + m + 1, a[p++] = f * (n + 1) + m, a[p++] = f * (n + 1) + m + 1, a[p++] = (f + 1) * (n + 1) + m + 1;
                return L._createMesh(o, l, a)
            }, L.createQuad = function (t, e) {
                void 0 === t && (t = 1), void 0 === e && (e = 1);
                var n = pt.getVertexDeclaration("POSITION,NORMAL,UV"), i = (n.vertexStride, t / 2), r = e / 2,
                    a = new Float32Array([-i, r, 0, 0, 0, 1, 0, 0, i, r, 0, 0, 0, 1, 1, 0, -i, -r, 0, 0, 0, 1, 0, 1, i, -r, 0, 0, 0, 1, 1, 1]),
                    o = new Uint16Array([0, 1, 2, 3, 2, 1]);
                return L._createMesh(n, a, o)
            }, L.createSphere = function (t, e, n) {
                void 0 === t && (t = .5), void 0 === e && (e = 32), void 0 === n && (n = 32);
                for (var i = (e + 1) * (n + 1), r = 3 * e * (n + 1) * 2, a = new Uint16Array(r), o = pt.getVertexDeclaration("POSITION,NORMAL,UV"), s = o.vertexStride / 4, l = new Float32Array(i * s), h = Math.PI / e, u = 2 * Math.PI / n, c = 0, _ = r = i = 0; _ < e + 1; _++) for (var d = Math.sin(_ * h), f = Math.cos(_ * h), m = 0; m < n + 1; m++) {
                    var p = d * Math.sin(m * u + 1 * Math.PI / 2), T = d * Math.cos(m * u + 1 * Math.PI / 2);
                    l[i + 0] = p * t, l[i + 1] = f * t, l[i + 2] = T * t, l[i + 3] = p, l[i + 4] = f, l[i + 5] = T, l[i + 6] = m / n, l[i + 7] = _ / e, i += s, _ != e - 1 && (a[r++] = c + (n + 1), a[r++] = c, a[r++] = c + 1, a[r++] = c + n, a[r++] = c, a[r++] = c + (n + 1), c++)
                }
                return L._createMesh(o, l, a)
            }
        }(), function () {
            function t() {
            }

            return d(t, "laya.d3.core.render.PostProcessEffect"), t.prototype.render = function (t) {
            }, t
        }()), Ft = function () {
            function P() {
            }

            return d(P, "laya.d3.animation.AnimationClipParser04"), P.READ_DATA = function () {
                P._DATA.offset = P._reader.getUint32(), P._DATA.size = P._reader.getUint32()
            }, P.READ_BLOCK = function () {
                for (var t = P._BLOCK.count = P._reader.getUint16(), e = P._BLOCK.blockStarts = [], n = P._BLOCK.blockLengths = [], i = 0; i < t; i++) e.push(P._reader.getUint32()), n.push(P._reader.getUint32())
            }, P.READ_STRINGS = function () {
                var t = P._reader.getUint32(), e = P._reader.getUint16(), n = P._reader.pos;
                P._reader.pos = t + P._DATA.offset;
                for (var i = 0; i < e; i++) P._strings[i] = P._reader.readUTFString();
                P._reader.pos = n
            }, P.parse = function (t, e, n) {
                P._animationClip = t, P._reader = e, P._version = n, P.READ_DATA(), P.READ_BLOCK(), P.READ_STRINGS();
                for (var i = 0, r = P._BLOCK.count; i < r; i++) {
                    var a = e.getUint16(), o = P._strings[a], s = P["READ_" + o];
                    if (null == s) throw new Error("model file err,no this function:" + a + " " + o);
                    s.call(null)
                }
                P._version = null, P._reader = null, P._animationClip = null
            }, P.READ_ANIMATIONS = function () {
                var t, e = 0, n = 0, i = P._reader, r = (i.__getBuffer(), []), a = i.getUint16();
                for (r.length = a, e = 0; e < a; e++) r[e] = i.getFloat32();
                var o = P._animationClip;
                o.name = P._strings[i.getUint16()];
                var s = o._duration = i.getFloat32();
                o.islooping = !!i.getByte(), o._frameRate = i.getInt16();
                var l = i.getInt16(), h = o._nodes;
                h.count = l;
                var u = o._nodesMap = {}, c = o._nodesDic = {};
                for (e = 0; e < l; e++) {
                    t = new Se, h.setNodeByIndex(e, t), t._indexInList = e;
                    var _ = t.type = i.getUint8(), d = i.getUint16();
                    for (t._setOwnerPathCount(d), n = 0; n < d; n++) t._setOwnerPathByIndex(n, P._strings[i.getUint16()]);
                    var f = t._joinOwnerPath("/"), m = u[f];
                    m || (u[f] = m = []), m.push(t), t.propertyOwner = P._strings[i.getUint16()];
                    var p = i.getUint16();
                    for (t._setPropertyCount(p), n = 0; n < p; n++) t._setPropertyByIndex(n, P._strings[i.getUint16()]);
                    var T = f + "." + t.propertyOwner + "." + t._joinProperty(".");
                    (c[T] = t).fullPath = T;
                    var E = i.getUint16();
                    t._setKeyframeCount(E);
                    switch (_) {
                        case 0:
                            break;
                        case 1:
                        case 3:
                        case 4:
                            t.data = b.supportWebGLPlusAnimation ? new U : new Lt;
                            break;
                        case 2:
                            t.data = b.supportWebGLPlusAnimation ? new B : new at;
                            break;
                        default:
                            throw"AnimationClipParser04:unknown type."
                    }
                    switch (P._version) {
                        case"LAYAANIMATION:04":
                            for (n = 0; n < E; n++) switch (_) {
                                case 0:
                                    var v = new Tn;
                                    t._setKeyframeByIndex(n, v), v.time = r[i.getUint16()], v.inTangent = i.getFloat32(), v.outTangent = i.getFloat32(), v.value = i.getFloat32();
                                    break;
                                case 1:
                                case 3:
                                case 4:
                                    var g = new Cn;
                                    if (t._setKeyframeByIndex(n, g), g.time = r[i.getUint16()], b.supportWebGLPlusAnimation) {
                                        for (var S = g.data = new Float32Array(9), y = 0; y < 3; y++) S[y] = i.getFloat32();
                                        for (y = 0; y < 3; y++) S[3 + y] = i.getFloat32();
                                        for (y = 0; y < 3; y++) S[6 + y] = i.getFloat32()
                                    } else {
                                        var x = g.inTangent, D = g.outTangent, I = g.value;
                                        x.x = i.getFloat32(), x.y = i.getFloat32(), x.z = i.getFloat32(), D.x = i.getFloat32(), D.y = i.getFloat32(), D.z = i.getFloat32(), I.x = i.getFloat32(), I.y = i.getFloat32(), I.z = i.getFloat32()
                                    }
                                    break;
                                case 2:
                                    var R = new Vn;
                                    if (t._setKeyframeByIndex(n, R), R.time = r[i.getUint16()], b.supportWebGLPlusAnimation) {
                                        for (S = R.data = new Float32Array(12), y = 0; y < 4; y++) S[y] = i.getFloat32();
                                        for (y = 0; y < 4; y++) S[4 + y] = i.getFloat32();
                                        for (y = 0; y < 4; y++) S[8 + y] = i.getFloat32()
                                    } else {
                                        var M = R.inTangent, A = R.outTangent, C = R.value;
                                        M.x = i.getFloat32(), M.y = i.getFloat32(), M.z = i.getFloat32(), M.w = i.getFloat32(), A.x = i.getFloat32(), A.y = i.getFloat32(), A.z = i.getFloat32(), A.w = i.getFloat32(), C.x = i.getFloat32(), C.y = i.getFloat32(), C.z = i.getFloat32(), C.w = i.getFloat32()
                                    }
                                    break;
                                default:
                                    throw"AnimationClipParser04:unknown type."
                            }
                            break;
                        case"LAYAANIMATION:COMPRESSION_04":
                            for (n = 0; n < E; n++) switch (_) {
                                case 0:
                                    v = new Tn, t._setKeyframeByIndex(n, v), v.time = r[i.getUint16()], v.inTangent = gt.convertToNumber(i.getUint16()), v.outTangent = gt.convertToNumber(i.getUint16()), v.value = gt.convertToNumber(i.getUint16());
                                    break;
                                case 1:
                                case 3:
                                case 4:
                                    if (g = new Cn, t._setKeyframeByIndex(n, g), g.time = r[i.getUint16()], b.supportWebGLPlusAnimation) {
                                        for (S = g.data = new Float32Array(9), y = 0; y < 3; y++) S[y] = gt.convertToNumber(i.getUint16());
                                        for (y = 0; y < 3; y++) S[3 + y] = gt.convertToNumber(i.getUint16());
                                        for (y = 0; y < 3; y++) S[6 + y] = gt.convertToNumber(i.getUint16())
                                    } else x = g.inTangent, D = g.outTangent, I = g.value, x.x = gt.convertToNumber(i.getUint16()), x.y = gt.convertToNumber(i.getUint16()), x.z = gt.convertToNumber(i.getUint16()), D.x = gt.convertToNumber(i.getUint16()), D.y = gt.convertToNumber(i.getUint16()), D.z = gt.convertToNumber(i.getUint16()), I.x = gt.convertToNumber(i.getUint16()), I.y = gt.convertToNumber(i.getUint16()), I.z = gt.convertToNumber(i.getUint16());
                                    break;
                                case 2:
                                    if (R = new Vn, t._setKeyframeByIndex(n, R), R.time = r[i.getUint16()], b.supportWebGLPlusAnimation) {
                                        for (S = R.data = new Float32Array(12), y = 0; y < 4; y++) S[y] = gt.convertToNumber(i.getUint16());
                                        for (y = 0; y < 4; y++) S[4 + y] = gt.convertToNumber(i.getUint16());
                                        for (y = 0; y < 4; y++) S[8 + y] = gt.convertToNumber(i.getUint16())
                                    } else M = R.inTangent, A = R.outTangent, C = R.value, M.x = gt.convertToNumber(i.getUint16()), M.y = gt.convertToNumber(i.getUint16()), M.z = gt.convertToNumber(i.getUint16()), M.w = gt.convertToNumber(i.getUint16()), A.x = gt.convertToNumber(i.getUint16()), A.y = gt.convertToNumber(i.getUint16()), A.z = gt.convertToNumber(i.getUint16()), A.w = gt.convertToNumber(i.getUint16()), C.x = gt.convertToNumber(i.getUint16()), C.y = gt.convertToNumber(i.getUint16()), C.z = gt.convertToNumber(i.getUint16()), C.w = gt.convertToNumber(i.getUint16());
                                    break;
                                default:
                                    throw"AnimationClipParser04:unknown type."
                            }
                    }
                }
                var L = i.getUint16();
                for (e = 0; e < L; e++) {
                    var O, N = new ie;
                    N.time = Math.min(s, i.getFloat32()), N.eventName = P._strings[i.getUint16()];
                    var V = i.getUint16();
                    for (0 < V && (N.params = O = []), n = 0; n < V; n++) {
                        switch (i.getByte()) {
                            case 0:
                                O.push(!!i.getByte());
                                break;
                            case 1:
                                O.push(i.getInt32());
                                break;
                            case 2:
                                O.push(i.getFloat32());
                                break;
                            case 3:
                                O.push(P._strings[i.getUint16()]);
                                break;
                            default:
                                throw new Error("unknown type.")
                        }
                    }
                    o.addEvent(N)
                }
            }, P._animationClip = null, P._reader = null, P._strings = [], P._version = null, _(P, ["_BLOCK", function () {
                return this._BLOCK = {count: 0}
            }, "_DATA", function () {
                return this._DATA = {offset: 0, size: 0}
            }]), P
        }(), Bt = function () {
            function P() {
            }

            return d(P, "laya.d3.animation.AnimationClipParser03"), P.READ_DATA = function () {
                P._DATA.offset = P._reader.getUint32(), P._DATA.size = P._reader.getUint32()
            }, P.READ_BLOCK = function () {
                for (var t = P._BLOCK.count = P._reader.getUint16(), e = P._BLOCK.blockStarts = [], n = P._BLOCK.blockLengths = [], i = 0; i < t; i++) e.push(P._reader.getUint32()), n.push(P._reader.getUint32())
            }, P.READ_STRINGS = function () {
                var t = P._reader.getUint32(), e = P._reader.getUint16(), n = P._reader.pos;
                P._reader.pos = t + P._DATA.offset;
                for (var i = 0; i < e; i++) P._strings[i] = P._reader.readUTFString();
                P._reader.pos = n
            }, P.parse = function (t, e) {
                P._animationClip = t;
                (P._reader = e).__getBuffer();
                P.READ_DATA(), P.READ_BLOCK(), P.READ_STRINGS();
                for (var n = 0, i = P._BLOCK.count; n < i; n++) {
                    var r = e.getUint16(), a = P._strings[r], o = P["READ_" + a];
                    if (null == o) throw new Error("model file err,no this function:" + r + " " + a);
                    o.call(null)
                }
            }, P.READ_ANIMATIONS = function () {
                var t, e = 0, n = 0, i = P._reader, r = (i.__getBuffer(), []), a = i.getUint16();
                for (r.length = a, e = 0; e < a; e++) r[e] = i.getFloat32();
                var o = P._animationClip;
                o.name = P._strings[i.getUint16()];
                var s = o._duration = i.getFloat32();
                o.islooping = !!i.getByte(), o._frameRate = i.getInt16();
                var l = i.getInt16(), h = o._nodes;
                h.count = l;
                var u = o._nodesMap = {}, c = o._nodesDic = {};
                for (e = 0; e < l; e++) {
                    t = new Se, h.setNodeByIndex(e, t), t._indexInList = e;
                    var _ = t.type = i.getUint8(), d = i.getUint16();
                    for (t._setOwnerPathCount(d), n = 0; n < d; n++) t._setOwnerPathByIndex(n, P._strings[i.getUint16()]);
                    var f = t._joinOwnerPath("/"), m = u[f];
                    m || (u[f] = m = []), m.push(t), t.propertyOwner = P._strings[i.getUint16()];
                    var p = i.getUint16();
                    for (t._setPropertyCount(p), n = 0; n < p; n++) t._setPropertyByIndex(n, P._strings[i.getUint16()]);
                    var T = f + "." + t.propertyOwner + "." + t._joinProperty(".");
                    (c[T] = t).fullPath = T;
                    var E = i.getUint16();
                    t._setKeyframeCount(E);
                    switch (_) {
                        case 0:
                            break;
                        case 1:
                        case 3:
                        case 4:
                            t.data = b.supportWebGLPlusAnimation ? new U : new Lt;
                            break;
                        case 2:
                            t.data = b.supportWebGLPlusAnimation ? new B : new at;
                            break;
                        default:
                            throw"AnimationClipParser03:unknown type."
                    }
                    for (n = 0; n < E; n++) switch (_) {
                        case 0:
                            var v = new Tn;
                            t._setKeyframeByIndex(n, v), v.time = r[i.getUint16()], v.inTangent = i.getFloat32(), v.outTangent = i.getFloat32(), v.value = i.getFloat32();
                            break;
                        case 1:
                        case 3:
                        case 4:
                            var g = new Cn;
                            if (t._setKeyframeByIndex(n, g), g.time = r[i.getUint16()], b.supportWebGLPlusAnimation) {
                                for (var S = g.data = new Float32Array(9), y = 0; y < 3; y++) S[y] = i.getFloat32();
                                for (y = 0; y < 3; y++) S[3 + y] = i.getFloat32();
                                for (y = 0; y < 3; y++) S[6 + y] = i.getFloat32()
                            } else {
                                var x = g.inTangent, D = g.outTangent, I = g.value;
                                x.x = i.getFloat32(), x.y = i.getFloat32(), x.z = i.getFloat32(), D.x = i.getFloat32(), D.y = i.getFloat32(), D.z = i.getFloat32(), I.x = i.getFloat32(), I.y = i.getFloat32(), I.z = i.getFloat32()
                            }
                            break;
                        case 2:
                            var R = new Vn;
                            if (t._setKeyframeByIndex(n, R), R.time = r[i.getUint16()], b.supportWebGLPlusAnimation) {
                                for (S = R.data = new Float32Array(12), y = 0; y < 4; y++) S[y] = i.getFloat32();
                                for (y = 0; y < 4; y++) S[4 + y] = i.getFloat32();
                                for (y = 0; y < 4; y++) S[8 + y] = i.getFloat32()
                            } else {
                                var M = R.inTangent, A = R.outTangent, C = R.value;
                                M.x = i.getFloat32(), M.y = i.getFloat32(), M.z = i.getFloat32(), M.w = i.getFloat32(), A.x = i.getFloat32(), A.y = i.getFloat32(), A.z = i.getFloat32(), A.w = i.getFloat32(), C.x = i.getFloat32(), C.y = i.getFloat32(), C.z = i.getFloat32(), C.w = i.getFloat32()
                            }
                            break;
                        default:
                            throw"AnimationClipParser03:unknown type."
                    }
                }
                var L = i.getUint16();
                for (e = 0; e < L; e++) {
                    var O, N = new ie;
                    N.time = Math.min(s, i.getFloat32()), N.eventName = P._strings[i.getUint16()];
                    var V = i.getUint16();
                    for (0 < V && (N.params = O = []), n = 0; n < V; n++) {
                        switch (i.getByte()) {
                            case 0:
                                O.push(!!i.getByte());
                                break;
                            case 1:
                                O.push(i.getInt32());
                                break;
                            case 2:
                                O.push(i.getFloat32());
                                break;
                            case 3:
                                O.push(P._strings[i.getUint16()]);
                                break;
                            default:
                                throw new Error("unknown type.")
                        }
                    }
                    o.addEvent(N)
                }
            }, P._animationClip = null, P._reader = null, P._strings = [], _(P, ["_BLOCK", function () {
                return this._BLOCK = {count: 0}
            }, "_DATA", function () {
                return this._DATA = {offset: 0, size: 0}
            }]), P
        }(), Ut = function () {
            function t() {
                this.value = 0
            }

            d(t, "laya.d3.shader.DefineDatas");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.add = function (t) {
                this.value |= t
            }, e.remove = function (t) {
                this.value &= ~t
            }, e.has = function (t) {
                return 0 < (this.value & t)
            }, e.cloneTo = function (t) {
                t.value = this.value
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t
        }(), zt = function () {
            function t(t, e, n) {
                this.offset = 0, this.elementFormat = null, this.elementUsage = 0, this.offset = t, this.elementFormat = e, this.elementUsage = n
            }

            return d(t, "laya.d3.graphics.VertexElement"), t
        }(), Gt = function () {
            function b(t, e, n, i) {
                this._datas = null, this._w = 0, this._h = 0, this._minHeight = NaN, this._maxHeight = NaN, this._datas = [], this._w = t, this._h = e, this._minHeight = n, this._maxHeight = i
            }

            d(b, "laya.d3.core.HeightMap");
            var t = b.prototype;
            return t._inBounds = function (t, e) {
                return 0 <= t && t < this._h && 0 <= e && e < this._w
            }, t.getHeight = function (t, e) {
                return this._inBounds(t, e) ? this._datas[t][e] : NaN
            }, u(0, t, "width", function () {
                return this._w
            }), u(0, t, "height", function () {
                return this._h
            }), u(0, t, "maxHeight", function () {
                return this._maxHeight
            }), u(0, t, "minHeight", function () {
                return this._minHeight
            }), b.creatFromMesh = function (t, e, n, i) {
                for (var r = [], a = [], o = t.subMeshCount, s = 0; s < o; s++) {
                    for (var l = t._getSubMesh(s), h = l._vertexBuffer, u = h.getData(), c = [], _ = 0; _ < u.length; _ += h.vertexDeclaration.vertexStride / 4) {
                        var d = new Lt(u[_ + 0], u[_ + 1], u[_ + 2]);
                        c.push(d)
                    }
                    r.push(c);
                    var f = l._indexBuffer;
                    a.push(f.getData())
                }
                var m = t.bounds, p = m.getMin().x, T = m.getMin().z, E = m.getMax().x, v = m.getMax().z,
                    g = m.getMin().y, S = m.getMax().y, y = E - p, x = v - T, D = i.x = y / (e - 1),
                    I = i.y = x / (n - 1), R = new b(e, n, g, S), M = b._tempRay, A = M.direction;
                A.x = 0, A.y = -1, A.z = 0;
                var C = S + .1;
                M.origin.y = C;
                for (var L = 0; L < n; L++) {
                    var O = T + L * I;
                    R._datas[L] = [];
                    for (var N = 0; N < e; N++) {
                        var V = p + N * D, P = M.origin;
                        P.x = V, P.z = O;
                        var w = b._getPosition(M, r, a);
                        R._datas[L][N] = w === Number.MAX_VALUE ? NaN : C - w
                    }
                }
                return R
            }, b.createFromImage = function (t, e, n) {
                for (var i = t.width, r = t.height, a = new b(i, r, e, n), o = (n - e) / 254, s = t.getPixels(), l = 0, h = 0; h < r; h++) for (var u = a._datas[h] = [], c = 0; c < i; c++) {
                    var _ = s[l++], d = s[l++], f = s[l++], m = s[l++];
                    u[c] = 255 == _ && 255 == d && 255 == f && 255 == m ? NaN : (_ + d + f) / 3 * o + e
                }
                return a
            }, b._getPosition = function (t, e, n) {
                for (var i = Number.MAX_VALUE, r = 0; r < e.length; r++) for (var a = e[r], o = n[r], s = 0; s < o.length; s += 3) {
                    var l = a[o[s + 0]], h = a[o[s + 1]], u = a[o[s + 2]], c = ce.rayIntersectsTriangle(t, l, h, u);
                    !isNaN(c) && c < i && (i = c)
                }
                return i
            }, _(b, ["_tempRay", function () {
                return this._tempRay = new W(new Lt, new Lt)
            }]), b
        }(), Ht = function () {
            function h() {
            }

            return d(h, "laya.d3.shader.ShaderInit3D"), h.__init__ = function () {
                var t, e;
                (h._rangeAttenTex = kt._buildTexture2D(1024, 1, 2, yt.lightAttenTexture)).wrapModeU = 1, h._rangeAttenTex.wrapModeV = 1, h._rangeAttenTex.lock = !0, Pt.SHADERDEFINE_HIGHPRECISION = Pt.registerPublicDefine("HIGHPRECISION"), Qn.SHADERDEFINE_FOG = Pt.registerPublicDefine("FOG"), Qn.SHADERDEFINE_DIRECTIONLIGHT = Pt.registerPublicDefine("DIRECTIONLIGHT"), Qn.SHADERDEFINE_POINTLIGHT = Pt.registerPublicDefine("POINTLIGHT"), Qn.SHADERDEFINE_SPOTLIGHT = Pt.registerPublicDefine("SPOTLIGHT"), Qn.SHADERDEFINE_CAST_SHADOW = Pt.registerPublicDefine("CASTSHADOW"), Qn.SHADERDEFINE_SHADOW_PSSM1 = Pt.registerPublicDefine("SHADOWMAP_PSSM1"), Qn.SHADERDEFINE_SHADOW_PSSM2 = Pt.registerPublicDefine("SHADOWMAP_PSSM2"), Qn.SHADERDEFINE_SHADOW_PSSM3 = Pt.registerPublicDefine("SHADOWMAP_PSSM3"), Qn.SHADERDEFINE_SHADOW_PCF_NO = Pt.registerPublicDefine("SHADOWMAP_PCF_NO"), Qn.SHADERDEFINE_SHADOW_PCF1 = Pt.registerPublicDefine("SHADOWMAP_PCF1"), Qn.SHADERDEFINE_SHADOW_PCF2 = Pt.registerPublicDefine("SHADOWMAP_PCF2"), Qn.SHADERDEFINE_SHADOW_PCF3 = Pt.registerPublicDefine("SHADOWMAP_PCF3"), Qn.SHADERDEFINE_REFLECTMAP = Pt.registerPublicDefine("REFLECTMAP"), Pt.addInclude("Lighting.glsl", "\nstruct DirectionLight {\n\tvec3 Color;\n\tvec3 Direction;\n};\n\nstruct PointLight {\n\tvec3 Color;\n\tvec3 Position;\n\tfloat Range;\n};\n\nstruct SpotLight {\n\tvec3 Color;\n\tvec3 Position;\n\tvec3 Direction;\n\tfloat Spot;\n\tfloat Range;\n};\n\n// Laya中使用衰减纹理\nfloat LayaAttenuation(in vec3 L,in float invLightRadius) {\n\tfloat fRatio = clamp(length(L) * invLightRadius,0.0,1.0);\n\tfRatio *= fRatio;\n\treturn 1.0 / (1.0 + 25.0 * fRatio)* clamp(4.0*(1.0 - fRatio),0.0,1.0); //fade to black as if 4 pixel texture\n}\n\n// Same as Just Cause 2 and Crysis 2 (you can read GPU Pro 1 book for more information)\nfloat BasicAttenuation(in vec3 L,in float invLightRadius) {\n\tvec3 distance = L * invLightRadius;\n\tfloat attenuation = clamp(1.0 - dot(distance, distance),0.0,1.0); // Equals float attenuation = saturate(1.0f - dot(L, L) / (lightRadius *  lightRadius));\n\treturn attenuation * attenuation;\n}\n\n// Inspired on http://fools.slindev.com/viewtopic.php?f=11&t=21&view=unread#unread\nfloat NaturalAttenuation(in vec3 L,in float invLightRadius) {\n\tfloat attenuationFactor = 30.0;\n\tvec3 distance = L * invLightRadius;\n\tfloat attenuation = dot(distance, distance); // Equals float attenuation = dot(L, L) / (lightRadius *  lightRadius);\n\tattenuation = 1.0 / (attenuation * attenuationFactor + 1.0);\n\t// Second we move down the function therewith it reaches zero at abscissa 1:\n\tattenuationFactor = 1.0 / (attenuationFactor + 1.0); //attenuationFactor contains now the value we have to subtract\n\tattenuation = max(attenuation - attenuationFactor, 0.0); // The max fixes a bug.\n\t// Finally we expand the equation along the y-axis so that it starts with a function value of 1 again.\n\tattenuation /= 1.0 - attenuationFactor;\n\treturn attenuation;\n}\n\nvoid LayaAirBlinnPhongLight (in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir,in vec3 lightColor, in vec3 lightVec,out vec3 diffuseColor,out vec3 specularColor) {\n\tmediump vec3 h = normalize(viewDir-lightVec);\n\tlowp float ln = max (0.0, dot (-lightVec,normal));\n\tfloat nh = max (0.0, dot (h,normal));\n\tdiffuseColor=lightColor * ln;\n\tspecularColor=lightColor *specColor*pow (nh, specColorIntensity*128.0) * gloss;\n}\n\nvoid LayaAirBlinnPhongDiectionLight (in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in DirectionLight light,out vec3 diffuseColor,out vec3 specularColor) {\n\tvec3 lightVec=normalize(light.Direction);\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.Color,lightVec,diffuseColor,specularColor);\n}\n\nvoid LayaAirBlinnPhongPointLight (in vec3 pos,in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in PointLight light,out vec3 diffuseColor,out vec3 specularColor) {\n\tvec3 lightVec =  pos-light.Position;\n\t//if( length(lightVec) > light.Range )\n\t//\treturn;\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.Color,lightVec/length(lightVec),diffuseColor,specularColor);\n\tfloat attenuate = LayaAttenuation(lightVec, 1.0/light.Range);\n\tdiffuseColor *= attenuate;\n\tspecularColor*= attenuate;\n}\n\nvoid LayaAirBlinnPhongSpotLight (in vec3 pos,in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in SpotLight light,out vec3 diffuseColor,out vec3 specularColor) {\n\tvec3 lightVec =  pos-light.Position;\n\t//if( length(lightVec) > light.Range)\n\t//\treturn;\n\n\tvec3 normalLightVec=lightVec/length(lightVec);\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.Color,normalLightVec,diffuseColor,specularColor);\n\tvec2 cosAngles=cos(vec2(light.Spot,light.Spot*0.5)*0.5);//ConeAttenuation\n\tfloat dl=dot(normalize(light.Direction),normalLightVec);\n\tdl*=smoothstep(cosAngles[0],cosAngles[1],dl);\n\tfloat attenuate = LayaAttenuation(lightVec, 1.0/light.Range)*dl;\n\tdiffuseColor *=attenuate;\n\tspecularColor *=attenuate;\n}\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent,vec3 binormal) {\n\tvec3 normalT =vec3(2.0*normalMapSample.x - 1.0,1.0-2.0*normalMapSample.y,2.0*normalMapSample.z - 1.0);\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent);\n\tvec3 B = normalize(binormal);\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\nvec3 NormalSampleToWorldSpace1(vec4 normalMapSample, vec3 tangent, vec3 binormal, vec3 unitNormal) {\n\tvec3 normalT;\n\tnormalT.x = 2.0 * normalMapSample.x - 1.0;\n\tnormalT.y = 1.0 - 2.0 * normalMapSample.y;\n\tnormalT.z = sqrt(1.0 - clamp(dot(normalT.xy, normalT.xy), 0.0, 1.0));\n\n\tvec3 T = normalize(tangent);\n\tvec3 B = normalize(binormal);\n\tvec3 N = normalize(unitNormal);\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN * normalize(normalT);\n\n\treturn bumpedNormal;\n}\n\nvec3 DecodeLightmap(vec4 color) {\n\treturn color.rgb*color.a*5.0;\n}\n\nvec2 TransformUV(vec2 texcoord,vec4 tilingOffset) {\n\tvec2 transTexcoord=vec2(texcoord.x,texcoord.y-1.0)*tilingOffset.xy+vec2(tilingOffset.z,-tilingOffset.w);\n\ttransTexcoord.y+=1.0;\n\treturn transTexcoord;\n}\n\nvec4 remapGLPositionZ(vec4 position) {\n\tposition.z=position.z * 2.0 - position.w;\n\treturn position;\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\n"), Pt.addInclude("ShadowHelper.glsl", "uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"), Pt.addInclude("BRDF.glsl", "struct LayaGI\n{\n\tvec3 diffuse;\n\tvec3 specular;\n};\n\nvec4 LayaAirBRDF(in vec3 diffuseColor, in vec3 specularColor, in float oneMinusReflectivity, in float smoothness, in vec3 normal, in vec3 viewDir, in vec3 lightDir, in vec3 lightColor, in LayaGI gi)\n{\n\tfloat perceptualRoughness = SmoothnessToPerceptualRoughness(smoothness);\n\tvec3 halfDir = SafeNormalize(viewDir - lightDir);\n\t\n\tfloat nv = abs(dot(normal, viewDir));\n\t\n\tfloat nl = clamp(dot(normal,   -lightDir),  0.0, 1.0);\n\tfloat nh = clamp(dot(normal,     halfDir),  0.0, 1.0);\n\tfloat lv = clamp(dot(lightDir,   viewDir),  0.0, 1.0);\n\tfloat lh = clamp(dot(lightDir,  -halfDir),  0.0, 1.0);\n\t\n\tfloat diffuseTerm = DisneyDiffuse(nv, nl, lh, perceptualRoughness) * nl;\n\t\n\tfloat roughness = PerceptualRoughnessToRoughness(perceptualRoughness);\n\t\n\t//#if UNITY_BRDF_GGX\n\tfloat V = SmithJointGGXVisibilityTerm(nl, nv, roughness);\n\tfloat D = GGXTerm(nh, roughness);\n\t\n\tfloat specularTerm = V * D * PI;\n\t\n\tspecularTerm = sqrt(max(0.0001, specularTerm));\n\tspecularTerm = max(0.0, specularTerm * nl);\n\t\n\tfloat surfaceReduction = 1.0 - 0.28 * roughness * perceptualRoughness;\n\tfloat grazingTerm = clamp(smoothness + (1.0 - oneMinusReflectivity), 0.0, 1.0);\n\t\n\tvec4 color;\n\tcolor.rgb = diffuseColor * (gi.diffuse + lightColor * diffuseTerm) \n\t\t\t  + specularTerm * lightColor * FresnelTerm (specularColor, lh)\n\t\t\t  + surfaceReduction * gi.specular * FresnelLerp(specularColor, vec3(grazingTerm), nv);\n\t\n\treturn color;\n}"), Pt.addInclude("PBRUtils.glsl", "struct DirectionLight\n{\n\tvec3 Color;\n\tvec3 Direction;\n};\n\nstruct PointLight\n{\n\tvec3 Color;\n\tvec3 Position;\n\tfloat Range;\n};\n\nstruct SpotLight\n{\n\tvec3 Color;\n\tvec3 Position;\n\tvec3 Direction;\n\tfloat SpotAngle;\n\tfloat Range;\n};\n\nvec3 UnpackScaleNormal(in vec2 uv0)\n{\n\t#ifdef NORMALTEXTURE\n\t\tvec3 normalT;\n\t\tvec4 normalMapSample = texture2D(u_NormalTexture, uv0);\n\t\tnormalT.x = 2.0 * normalMapSample.x - 1.0;\n\t\tnormalT.y = 1.0 - 2.0 * normalMapSample.y;\n\t\tnormalT.xy *= u_normalScale;\n\t\tnormalT.z = sqrt(1.0 - clamp(dot(normalT.xy, normalT.xy), 0.0, 1.0));\n\t\t\n\t\tvec3 T = normalize(v_Tangent);\n\t\tvec3 B = normalize(v_Binormal);\n\t\tvec3 N = normalize(v_Normal);\n\t\tmat3 TBN = mat3(T, B, N);\n\t\t\n\t\tvec3 bumpedNormal = TBN * normalize(normalT);\n\t\treturn bumpedNormal;\n\t#else\n\t\treturn normalize(v_Normal);\n\t#endif\n}\n\nvec4 DielectricSpecularColor = vec4(0.220916301, 0.220916301, 0.220916301, 1.0 - 0.220916301);\n\nfloat PI = 3.14159265359;\n\nvec3 FresnelTerm (in vec3 F0, in float cosA)\n{\n\treturn F0 + (vec3(1.0) - F0) * pow(1.0 - cosA, 5.0);\n}\n\nvec3 FresnelLerp (in vec3 F0, in vec3 F90, float cosA)\n{\n    float t = pow(1.0 - cosA, 5.0);\n    return mix(F0, F90, t);\n}\n\nfloat PerceptualRoughnessToRoughness(in float perceptualRoughness)\n{\n\treturn perceptualRoughness * perceptualRoughness;\n}\n\nfloat PerceptualRoughnessToSpecularPower(in float perceptualRoughness)\n{\n\tfloat m = PerceptualRoughnessToRoughness(perceptualRoughness);\n\tfloat sq = max(0.0001, m * m);\n\tfloat n = (2.0 / sq) - 2.0;\n\tn = max(n, 0.0001);\n\treturn n;\n}\n\nfloat RoughnessToPerceptualRoughness(in float roughness)\n{\n\treturn sqrt(roughness);\n}\n\nfloat SmoothnessToRoughness(in float smoothness)\n{\n\treturn (1.0 - smoothness) * (1.0 - smoothness);\n}\n\nfloat SmoothnessToPerceptualRoughness(in float smoothness)\n{\n\treturn (1.0 - smoothness);\n}\n\nvec3 SafeNormalize(in vec3 inVec)\n{\n\tfloat dp3 = max(0.001,dot(inVec,inVec));\n\treturn inVec * (1.0 / sqrt(dp3));\n}\n\nfloat DisneyDiffuse(in float NdotV, in float NdotL, in float LdotH, in float perceptualRoughness)\n{\n\tfloat fd90 = 0.5 + 2.0 * LdotH * LdotH * perceptualRoughness;\n\tfloat lightScatter\t= (1.0 + (fd90 - 1.0) * pow(1.0 - NdotL,5.0));\n\tfloat viewScatter\t= (1.0 + (fd90 - 1.0) * pow(1.0 - NdotV,5.0));\n\n\treturn lightScatter * viewScatter;\n}\n\nfloat SmithJointGGXVisibilityTerm (float NdotL, float NdotV, float roughness)\n{\n\tfloat a = roughness;\n\tfloat lambdaV = NdotL * (NdotV * (1.0 - a) + a);\n\tfloat lambdaL = NdotV * (NdotL * (1.0 - a) + a);\n\n\treturn 0.5 / (lambdaV + lambdaL + 0.00001);\n}\n\nfloat GGXTerm (float NdotH, float roughness)\n{\n\tfloat a2 = roughness * roughness;\n\tfloat d = (NdotH * a2 - NdotH) * NdotH + 1.0;\n\treturn 0.31830988618 * a2 / (d * d + 0.0000001);\n}\n\nfloat OneMinusReflectivityFromMetallic(in float metallic)\n{\n\tfloat oneMinusDielectricSpec = DielectricSpecularColor.a;\n\treturn oneMinusDielectricSpec - metallic * oneMinusDielectricSpec;\n}\n\nfloat SpecularStrength(vec3 specular)\n{\n    //(SHADER_TARGET < 30)return specular.r; \n    return max (max (specular.r, specular.g), specular.b);\n}\n\nvec3 DiffuseAndSpecularFromMetallic(in vec3 diffuseColor, in float metallic, out vec3 specularColor, out float oneMinusReflectivity)\n{\n\tspecularColor = mix(DielectricSpecularColor.rgb, diffuseColor, metallic);\n\toneMinusReflectivity = OneMinusReflectivityFromMetallic(metallic);\n\treturn diffuseColor * oneMinusReflectivity;\n}\n\nvec3 EnergyConservationBetweenDiffuseAndSpecular(in vec3 diffuseColor, in vec3 specularColor, out float oneMinusReflectivity)\n{\n\toneMinusReflectivity = 1.0 - SpecularStrength(specularColor);\n\treturn diffuseColor * oneMinusReflectivity;\n}\n\nvec4 Occlusion(in vec2 uv0){\n\t#ifdef OCCLUSIONTEXTURE\n\t\tvec4 occlusionTextureColor = texture2D(u_OcclusionTexture, uv0);\n\t\tfloat occ = occlusionTextureColor.g;\n\t\tfloat oneMinusT = 1.0 - u_occlusionStrength;\n\t\tfloat lerpOneTo = oneMinusT + occ * u_occlusionStrength;\n\t\treturn occlusionTextureColor * lerpOneTo;\n\t#else\n\t\treturn vec4(1.0);\n\t#endif\n}\n\nvec2 ParallaxOffset(in vec3 viewDir){\n\t#ifdef PARALLAXTEXTURE\n\t\tfloat h = texture2D(u_ParallaxTexture, v_Texcoord0).g;\n\t\th = h * u_parallaxScale - u_parallaxScale / 2.0;\n\t\tvec3 v = viewDir;\n\t\tv.z += 0.42;\n\t\tvec2 offset = h * (v.xy / v.z);\n\t\treturn v_Texcoord0 + offset;\n\t#else\n\t\treturn v_Texcoord0;\n\t#endif\n}\n\nvec3 ReflectCubeMap(in vec3 viewDir, in vec3 normal){\n\t#ifdef REFLECTMAP\n\t\tvec3 incident = -viewDir;\n\t\tvec3 reflectionVector = reflect(incident, normal);\n\t\tvec3 reflectionColor = textureCube(u_ReflectTexture, vec3(-reflectionVector.x, reflectionVector.yz)).rgb;\n\t\treturn reflectionColor * u_ReflectIntensity;\n\t#else\n\t\treturn vec3(0.0);\n\t#endif\n}\n\nfloat LayaAttenuation(in vec3 L, in float invLightRadius)\n{\n\tfloat fRatio = clamp(length(L) * invLightRadius, 0.0, 1.0);\n\tfRatio *= fRatio;\n\treturn 1.0 / (1.0 + 25.0 * fRatio) * clamp(4.0*(1.0 - fRatio), 0.0, 1.0); //fade to black as if 4 pixel texture\n}\n\nvec3 LayaPreMultiplyAlpha(vec3 diffColor, float alpha, float oneMinusReflectivity, out float outModifiedAlpha)\n{\n\t#ifdef ALPHAPREMULTIPLY\n\t\tdiffColor *= alpha;\n\t\toutModifiedAlpha = 1.0 - oneMinusReflectivity + alpha * oneMinusReflectivity;\n\t#else\n\t\toutModifiedAlpha = alpha;\n\t#endif\n\treturn diffColor;\n}\n\n"), Pt.addInclude("PBRStandardLighting.glsl", '#include "PBRUtils.glsl"\n#include "BRDF.glsl"\n\nvec4 PBRStandardLight(in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in vec3 lightDir, in vec3 lightColor, in LayaGI gi)\n{\n\tfloat oneMinusReflectivity;\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat alpha;\n\t\n\tdiffuseColor = DiffuseAndSpecularFromMetallic (albedoColor.rgb, metallic, specularColor, oneMinusReflectivity);\n\t\n\tdiffuseColor = LayaPreMultiplyAlpha(diffuseColor, albedoColor.a, oneMinusReflectivity, alpha);\n\t\n\tvec4 color = LayaAirBRDF(diffuseColor, specularColor, oneMinusReflectivity, smoothness, normal, viewDir, lightDir, lightColor, gi);\n\tcolor.a = alpha;\n\treturn color;\n}\n\nvec4 PBRStandardDiectionLight (in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in DirectionLight light, in LayaGI gi)\n{\n\tvec3 lightVec = normalize(light.Direction);\n\treturn PBRStandardLight(albedoColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi);\n}\n\nvec4 PBRStandardPointLight (in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in PointLight light, in vec3 pos, in LayaGI gi)\n{\n\tvec3 lightCoord = (u_PointLightMatrix * vec4(pos, 1.0)).xyz;\n\tfloat distance = dot(lightCoord, lightCoord);\n\tfloat attenuate = texture2D(u_RangeTexture, vec2(distance)).w;\n\tvec3 lightVec = normalize(pos - light.Position);\n\treturn PBRStandardLight(albedoColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n}\n\nvec4 PBRStandardSpotLight (in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in SpotLight light, in vec3 pos, in LayaGI gi)\n{\n\tvec3 lightVec =  pos - light.Position;\n\tvec3 normalLightVec = normalize(lightVec);\n\tvec2 cosAngles = cos(vec2(light.SpotAngle, light.SpotAngle*0.5) * 0.5);//ConeAttenuation\n\tfloat dl = dot(normalize(light.Direction), normalLightVec);\n\tdl *= smoothstep(cosAngles[0], cosAngles[1], dl);\n\tfloat attenuate = LayaAttenuation(lightVec, 1.0/light.Range) * dl;\n\treturn PBRStandardLight(albedoColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n}\n\n//vec4 PBRStandardSpotLight1 (in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in SpotLight light, in vec3 pos, in LayaGI gi)\n//{\n//\tvec4 lightCoord = u_SpotLightMatrix * vec4(pos, 1.0);\n//\t\n//\tfloat distance = dot(lightCoord, lightCoord);\n//\tfloat attenuate = (lightCoord.z < 0.0) ? texture2D(u_RangeTexture, vec2(distance)).w : 0.0;\n//\t//float attenuate = (lightCoord.z < 0.0) ? texture2D(u_AngleTexture, vec2(lightCoord.x / lightCoord.w + 0.5, lightCoord.y / lightCoord.w + 0.5)).r * texture2D(u_RangeTexture, vec2(distance)).w : 0.0;\n//\t//vec2 _uv = vec2(pos.x * 180.0/(2.0 * pos.z) + 0.5, pos.y * 180.0/(2.0 * pos.z) + 0.5);\n//\tvec3 lightVec = normalize(pos - light.Position);\n//\treturn PBRStandardLight(albedoColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n//}\n\nvec2 MetallicGloss(in float albedoTextureAlpha, in vec2 uv0)\n{\n\tvec2 mg;\n\t\n\t#ifdef METALLICGLOSSTEXTURE\n\t\tvec4 metallicGlossTextureColor = texture2D(u_MetallicGlossTexture, uv0);\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\tmg.r = metallicGlossTextureColor.r;\n\t\t\tmg.g = albedoTextureAlpha;\n\t\t#else\n\t\t    mg = metallicGlossTextureColor.ra;\n\t\t#endif\n\t\tmg.g *= u_smoothnessScale;\n\t#else\n\t\tmg.r = u_metallic;\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\tmg.g = albedoTextureAlpha * u_smoothnessScale;\n\t\t#else\n\t\t\tmg.g = u_smoothness;\n\t\t#endif\n\t#endif\n\t\n\treturn mg;\n}\n\n'), Pt.addInclude("PBRSpecularLighting.glsl", '#include "PBRUtils.glsl"\n#include "BRDF.glsl"\n\nvec4 PBRSpecularLight(in vec4 albedoColor, in vec3 specularColor, in float smoothness, in vec3 normal, in vec3 viewDir, in vec3 lightDir, in vec3 lightColor, in LayaGI gi)\n{\n\tfloat oneMinusReflectivity;\n\tvec3 diffuseColor;\n\tfloat alpha;\n\t\n\tdiffuseColor = EnergyConservationBetweenDiffuseAndSpecular (albedoColor.rgb, specularColor, oneMinusReflectivity);\n\t\n\tdiffuseColor = LayaPreMultiplyAlpha(diffuseColor, albedoColor.a, oneMinusReflectivity, alpha);\n\t\n\tvec4 color = LayaAirBRDF(diffuseColor, specularColor, oneMinusReflectivity, smoothness, normal, viewDir, lightDir, lightColor, gi);\n\tcolor.a = alpha;\n\treturn color;\n}\n\nvec4 PBRSpecularDiectionLight (in vec4 albedoColor, in vec3 specularColor, in float smoothness, in vec3 normal, in vec3 viewDir, in DirectionLight light, in LayaGI gi)\n{\n\tvec3 lightVec = normalize(light.Direction);\n\treturn PBRSpecularLight(albedoColor, specularColor, smoothness, normal, viewDir, lightVec, light.Color, gi);\n}\n\nvec4 PBRSpecularPointLight (in vec4 albedoColor, in vec3 specularColor, in float smoothness, in vec3 normal, in vec3 viewDir, in PointLight light, in vec3 pos, in LayaGI gi)\n{\n\tvec3 lightCoord = (u_PointLightMatrix * vec4(pos, 1.0)).xyz;\n\tfloat distance = dot(lightCoord, lightCoord);\n\tfloat attenuate = texture2D(u_RangeTexture, vec2(distance)).w;\n\tvec3 lightVec = normalize(pos - light.Position);\n\treturn PBRSpecularLight(albedoColor, specularColor, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n}\n\nvec4 PBRSpecularSpotLight (in vec4 albedoColor, in vec3 specularColor, in float smoothness, in vec3 normal, in vec3 viewDir, in SpotLight light, in vec3 pos, in LayaGI gi)\n{\n\tvec3 lightVec =  pos - light.Position;\n\tvec3 normalLightVec = normalize(lightVec);\n\tvec2 cosAngles = cos(vec2(light.SpotAngle, light.SpotAngle*0.5) * 0.5);//ConeAttenuation\n\tfloat dl = dot(normalize(light.Direction), normalLightVec);\n\tdl *= smoothstep(cosAngles[0], cosAngles[1], dl);\n\tfloat attenuate = LayaAttenuation(lightVec, 1.0/light.Range) * dl;\n\treturn PBRSpecularLight(albedoColor, specularColor, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n}\n\n//vec4 PBRStandardSpotLight1 (in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in SpotLight light, in vec3 pos, in LayaGI gi)\n//{\n//\tvec4 lightCoord = u_SpotLightMatrix * vec4(pos, 1.0);\n//\t\n//\tfloat distance = dot(lightCoord, lightCoord);\n//\tfloat attenuate = (lightCoord.z < 0.0) ? texture2D(u_RangeTexture, vec2(distance)).w : 0.0;\n//\t//float attenuate = (lightCoord.z < 0.0) ? texture2D(u_AngleTexture, vec2(lightCoord.x / lightCoord.w + 0.5, lightCoord.y / lightCoord.w + 0.5)).r * texture2D(u_RangeTexture, vec2(distance)).w : 0.0;\n//\t//vec2 _uv = vec2(pos.x * 180.0/(2.0 * pos.z) + 0.5, pos.y * 180.0/(2.0 * pos.z) + 0.5);\n//\tvec3 lightVec = normalize(pos - light.Position);\n//\treturn PBRStandardLight(albedoColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n//}\n\nvec4 SpecularGloss(float albedoTextureAlpha, in vec2 uv0)\n{\n    vec4 sg;\n\t\n\t#ifdef SPECULARTEXTURE\n\t\tvec4 specularTextureColor = texture2D(u_SpecularTexture, uv0);\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\tsg.rgb = specularTextureColor.rgb;\n\t\t\tsg.a = albedoTextureAlpha;\n\t\t#else\n\t\t\tsg = specularTextureColor;\n\t\t#endif\n\t\tsg.a *= u_smoothnessScale;\n\t#else\n\t\tsg.rgb = u_SpecularColor.rgb;\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\tsg.a = albedoTextureAlpha * u_smoothnessScale;\n\t\t#else\n\t\t\tsg.a = u_smoothness;\n\t\t#endif\n\t#endif\n\t\n    return sg;\n}\n\n'), Pt.addInclude("Colors.glsl", '#include "StdLib.glsl";\n\n#define EPSILON 1.0e-4\n\n// Quadratic color thresholding\n// curve = (threshold - knee, knee * 2, 0.25 / knee)\nmediump vec4 quadraticThreshold(mediump vec4 color, mediump float threshold, mediump vec3 curve) {\n\t// Pixel brightness\n\tmediump float br = max3(color.r, color.g, color.b);\n\n\t// Under-threshold part: quadratic curve\n\tmediump float rq = clamp(br - curve.x, 0.0, curve.y);\n\trq = curve.z * rq * rq;\n\n\t// Combine and apply the brightness response curve.\n\tcolor *= max(rq, br - threshold) / max(br, EPSILON);\n\n\treturn color;\n}\n\n//\n// sRGB transfer functions\n// Fast path ref: http://chilliant.blogspot.com.au/2012/08/srgb-approximations-for-hlsl.html?m=1\n//\nmediump vec3 SRGBToLinear(mediump vec3 c) {\n\t#ifdef USE_VERY_FAST_SRGB\n\t\treturn c * c;\n\t#elif defined(USE_FAST_SRGB)\n\t\treturn c * (c * (c * 0.305306011 + 0.682171111) + 0.012522878);\n\t#else\n\t\tmediump vec3 linearRGBLo = c / 12.92;\n\t\tmediump vec3 power=vec3(2.4, 2.4, 2.4);\n\t\tmediump vec3 linearRGBHi = positivePow((c + 0.055) / 1.055, power);\n\t\tmediump vec3 linearRGB =vec3((c.r<=0.04045) ? linearRGBLo.r : linearRGBHi.r,(c.g<=0.04045) ? linearRGBLo.g : linearRGBHi.g,(c.b<=0.04045) ? linearRGBLo.b : linearRGBHi.b);\n\t\treturn linearRGB;\n\t#endif\n}\n\nmediump vec3 LinearToSRGB(mediump vec3 c) {\n\t#ifdef USE_VERY_FAST_SRGB\n\t\treturn sqrt(c);\n\t#elif defined(USE_FAST_SRGB)\n\t\treturn max(1.055 * PositivePow(c, 0.416666667) - 0.055, 0.0);\n\t#else\n\t\tmediump vec3 sRGBLo = c * 12.92;\n\t\tmediump vec3 power=vec3(1.0 / 2.4, 1.0 / 2.4, 1.0 / 2.4);\n\t\tmediump vec3 sRGBHi = (positivePow(c, power) * 1.055) - 0.055;\n\t\tmediump vec3 sRGB =vec3((c.r<=0.0031308) ? sRGBLo.r : sRGBHi.r,(c.g<=0.0031308) ? sRGBLo.g : sRGBHi.g,(c.b<=0.0031308) ? sRGBLo.b : sRGBHi.b);\n\t\treturn sRGB;\n\t#endif\n}'), Pt.addInclude("Sampling.glsl", "// Better, temporally stable box filtering\n// [Jimenez14] http://goo.gl/eomGso\n// . . . . . . .\n// . A . B . C .\n// . . D . E . .\n// . F . G . H .\n// . . I . J . .\n// . K . L . M .\n// . . . . . . .\nmediump vec4 downsampleBox13Tap(sampler2D tex, vec2 uv, vec2 texelSize)\n{\n    mediump vec4 A = texture2D(tex, uv + texelSize * vec2(-1.0, -1.0));\n    mediump vec4 B = texture2D(tex, uv + texelSize * vec2( 0.0, -1.0));\n    mediump vec4 C = texture2D(tex, uv + texelSize * vec2( 1.0, -1.0));\n    mediump vec4 D = texture2D(tex, uv + texelSize * vec2(-0.5, -0.5));\n    mediump vec4 E = texture2D(tex, uv + texelSize * vec2( 0.5, -0.5));\n    mediump vec4 F = texture2D(tex, uv + texelSize * vec2(-1.0,  0.0));\n    mediump vec4 G = texture2D(tex, uv);\n    mediump vec4 H = texture2D(tex, uv + texelSize * vec2( 1.0,  0.0));\n    mediump vec4 I = texture2D(tex, uv + texelSize * vec2(-0.5,  0.5));\n    mediump vec4 J = texture2D(tex, uv + texelSize * vec2( 0.5,  0.5));\n    mediump vec4 K = texture2D(tex, uv + texelSize * vec2(-1.0,  1.0));\n    mediump vec4 L = texture2D(tex, uv + texelSize * vec2( 0.0,  1.0));\n    mediump vec4 M = texture2D(tex, uv + texelSize * vec2( 1.0,  1.0));\n\n\tmediump vec2 scale= vec2(0.5, 0.125);\n    mediump vec2 div = (1.0 / 4.0) * scale;\n\n    mediump vec4 o = (D + E + I + J) * div.x;\n    o += (A + B + G + F) * div.y;\n    o += (B + C + H + G) * div.y;\n    o += (F + G + L + K) * div.y;\n    o += (G + H + M + L) * div.y;\n\n    return o;\n}\n\n// Standard box filtering\nmediump vec4 downsampleBox4Tap(sampler2D tex, vec2 uv, vec2 texelSize)\n{\n    vec4 d = texelSize.xyxy * vec4(-1.0, -1.0, 1.0, 1.0);\n\n    mediump vec4 s =  texture2D(tex, uv + d.xy);\n    s += texture2D(tex, uv + d.zy);\n    s += texture2D(tex, uv + d.xw);\n    s += texture2D(tex, uv + d.zw);\n\n    return s * (1.0 / 4.0);\n}\n\n// 9-tap bilinear upsampler (tent filter)\n// . . . . . . .\n// . 1 . 2 . 1 .\n// . . . . . . .\n// . 2 . 4 . 2 .\n// . . . . . . .\n// . 1 . 2 . 1 .\n// . . . . . . .\nmediump vec4 upsampleTent(sampler2D tex, vec2 uv, vec2 texelSize, vec4 sampleScale)\n{\n    vec4 d = texelSize.xyxy * vec4(1.0, 1.0, -1.0, 0.0) * sampleScale;\n\n    mediump vec4 s =  texture2D(tex, uv - d.xy);\n    s += texture2D(tex, uv - d.wy) * 2.0;\n    s += texture2D(tex, uv - d.zy);\n\n    s += texture2D(tex, uv + d.zw) * 2.0;\n    s += texture2D(tex, uv) * 4.0;\n    s += texture2D(tex,\tuv + d.xw) * 2.0;\n\n    s += texture2D(tex, uv + d.zy);\n    s += texture2D(tex, uv + d.wy) * 2.0;\n    s += texture2D(tex, uv + d.xy);\n\n    return s * (1.0 / 16.0);\n}\n\n// Standard box filtering\nmediump vec4 upsampleBox(sampler2D tex, vec2 uv, vec2 texelSize, vec4 sampleScale)\n{\n    vec4 d = texelSize.xyxy * vec4(-1.0, -1.0, 1.0, 1.0) * (sampleScale * 0.5);\n\n    mediump vec4 s =  texture2D(tex, uv + d.xy);\n    s += texture2D(tex, uv + d.zy);\n    s += texture2D(tex, uv + d.xw);\n    s += texture2D(tex, uv + d.zw);\n\n    return s * (1.0 / 4.0);\n}"), Pt.addInclude("StdLib.glsl", "#define HALF_MAX       65504.0 // (2 - 2^-10) * 2^15\n\n#define FLT_EPSILON    1.192092896e-07 // Smallest positive number, such that 1.0 + FLT_EPSILON != 1.0\n\nmediump vec4 safeHDR(mediump vec4 c)\n{\n    return min(c, HALF_MAX);\n}\n\nfloat max3(float a, float b, float c)\n{\n    return max(max(a, b), c);\n}\n\nvec3 positivePow(vec3 base, vec3 power)\n{\n    return pow(max(abs(base), vec3(FLT_EPSILON, FLT_EPSILON, FLT_EPSILON)), power);\n}");
                var n = {
                    a_Position: 0,
                    a_Color: 1,
                    a_Normal: 3,
                    a_Texcoord0: 2,
                    a_Texcoord1: 7,
                    a_BoneWeights: 6,
                    a_BoneIndices: 5,
                    a_Tangent0: 4,
                    a_MvpMatrix: 12,
                    a_WorldMat: 8
                }, i = {
                    u_Bones: 0,
                    u_DiffuseTexture: 1,
                    u_SpecularTexture: 1,
                    u_NormalTexture: 1,
                    u_AlphaTestValue: 1,
                    u_DiffuseColor: 1,
                    u_MaterialSpecular: 1,
                    u_Shininess: 1,
                    u_TilingOffset: 1,
                    u_WorldMat: 2,
                    u_MvpMatrix: 2,
                    u_LightmapScaleOffset: 2,
                    u_LightMap: 2,
                    u_CameraPos: 3,
                    u_ReflectTexture: 4,
                    u_ReflectIntensity: 4,
                    u_FogStart: 4,
                    u_FogRange: 4,
                    u_FogColor: 4,
                    "u_DirectionLight.Color": 4,
                    "u_DirectionLight.Direction": 4,
                    "u_PointLight.Position": 4,
                    "u_PointLight.Range": 4,
                    "u_PointLight.Color": 4,
                    "u_SpotLight.Position": 4,
                    "u_SpotLight.Direction": 4,
                    "u_SpotLight.Range": 4,
                    "u_SpotLight.Spot": 4,
                    "u_SpotLight.Color": 4,
                    u_AmbientColor: 4,
                    u_shadowMap1: 4,
                    u_shadowMap2: 4,
                    u_shadowMap3: 4,
                    u_shadowPSSMDistance: 4,
                    u_lightShadowVP: 4,
                    u_shadowPCFoffset: 4
                }, r = {s_Cull: 0, s_Blend: 1, s_BlendSrc: 2, s_BlendDst: 3, s_DepthTest: 12, s_DepthWrite: 13};
                t = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\n\tattribute vec2 a_Texcoord0;\n\tvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(LIGHTMAP)&&defined(UV1)\n\tattribute vec2 a_Texcoord1;\n#endif\n\n#ifdef LIGHTMAP\n\tuniform vec4 u_LightmapScaleOffset;\n\tvarying vec2 v_LightMapUV;\n#endif\n\n#ifdef COLOR\n\tattribute vec4 a_Color;\n\tvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tattribute vec3 a_Normal;\n\tvarying vec3 v_Normal; \n\tuniform vec3 u_CameraPos;\n\tvarying vec3 v_ViewDir; \n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\tattribute vec4 a_Tangent0;\n\tvarying vec3 v_Tangent;\n\tvarying vec3 v_Binormal;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t#ifdef GPU_INSTANCE\n\t\tattribute mat4 a_WorldMat;\n\t#else\n\t\tuniform mat4 u_WorldMat;\n\t#endif\n\tvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t//TODO没考虑UV动画呢\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tmat4 worldMat;\n\t\t#ifdef GPU_INSTANCE\n\t\t\tworldMat = a_WorldMat;\n\t\t#else\n\t\t\tworldMat = u_WorldMat;\n\t\t#endif\n\t#endif\n\t\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tmat3 worldInvMat;\n\t\t#ifdef BONE\n\t\t\tworldInvMat=inverse(mat3(worldMat*skinTransform));\n\t\t#else\n\t\t\tworldInvMat=inverse(mat3(worldMat));\n\t\t#endif  \n\t\tv_Normal=a_Normal*worldInvMat;\n\t\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\t\tv_Tangent=a_Tangent0.xyz*worldInvMat;\n\t\t\tv_Binormal=cross(v_Normal,v_Tangent)*a_Tangent0.w;\n\t\t#endif\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tv_PositionWorld=(worldMat*position).xyz;\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tv_ViewDir=u_CameraPos-v_PositionWorld;\n\t#endif\n\n\t#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))\n\t\t#ifdef TILINGOFFSET\n\t\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t\t#else\n\t\t\tv_Texcoord0=a_Texcoord0;\n\t\t#endif\n\t#endif\n\n\t#ifdef LIGHTMAP\n\t\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t\t#ifdef UV1\n\t\t\t\tv_LightMapUV=vec2(a_Texcoord1.x,1.0-a_Texcoord1.y)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t\t#else\n\t\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,1.0-a_Texcoord0.y)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t\t#endif \n\t\t\tv_LightMapUV.y=1.0-v_LightMapUV.y;\n\t\t#else\n\t\t\t#ifdef UV1\n\t\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t\t#else\n\t\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t\t#endif \n\t\t#endif \n\t#endif\n\n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tv_Color=a_Color;\n\t#endif\n\n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1 \n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif\n}', e = '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Lighting.glsl";\n\nuniform vec4 u_DiffuseColor;\n\n#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\tvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvarying vec3 v_ViewDir; \n#endif\n\n#ifdef ALPHATEST\n\tuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\n\tuniform sampler2D u_DiffuseTexture;\n#endif\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))\n\tvarying vec2 v_Texcoord0;\n#endif\n\n#ifdef LIGHTMAP\n\tvarying vec2 v_LightMapUV;\n\tuniform sampler2D u_LightMap;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tuniform vec3 u_MaterialSpecular;\n\tuniform float u_Shininess;\n\t#ifdef SPECULARMAP \n\t\tuniform sampler2D u_SpecularTexture;\n\t#endif\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\tuniform sampler2D u_NormalTexture;\n\tvarying vec3 v_Tangent;\n\tvarying vec3 v_Binormal;\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n\tvec3 globalDiffuse=u_AmbientColor;\n\t#ifdef LIGHTMAP\t\n\t\tglobalDiffuse += DecodeLightmap(texture2D(u_LightMap, v_LightMapUV));\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tvec3 normal;\n\t\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent,v_Binormal));\n\t\t#else\n\t\t\tnormal = normalize(v_Normal);\n\t\t#endif\n\t\tvec3 viewDir= normalize(v_ViewDir);\n\t#endif\n\t\n\tvec4 mainColor=u_DiffuseColor;\n\t#ifdef DIFFUSEMAP\n\t\tvec4 difTexColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\t\tmainColor=mainColor*difTexColor;\n\t#endif \n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tmainColor=mainColor*v_Color;\n\t#endif \n    \n\t#ifdef ALPHATEST\n\t\tif(mainColor.a<u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n  \n\t\n\tvec3 diffuse = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tvec3 dif,spe;\n\t\t#ifdef SPECULARMAP\n\t\t\tvec3 gloss=texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n\t\t#else\n\t\t\t#ifdef DIFFUSEMAP\n\t\t\t\tvec3 gloss=vec3(difTexColor.a);\n\t\t\t#else\n\t\t\t\tvec3 gloss=vec3(1.0);\n\t\t\t#endif\n\t\t#endif\n\t#endif\n\n\t\n\t#ifdef DIRECTIONLIGHT\n\t\tLayaAirBlinnPhongDiectionLight(u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_DirectionLight,dif,spe);\n\t\tdiffuse+=dif;\n\t\tspecular+=spe;\n\t#endif\n \n\t#ifdef POINTLIGHT\n\t\tLayaAirBlinnPhongPointLight(v_PositionWorld,u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_PointLight,dif,spe);\n\t\tdiffuse+=dif;\n\t\tspecular+=spe;\n\t#endif\n\n\t#ifdef SPOTLIGHT\n\t\tLayaAirBlinnPhongSpotLight(v_PositionWorld,u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_SpotLight,dif,spe);\n\t\tdiffuse+=dif;\n\t\tspecular+=spe;\n\t#endif\n\n\t#ifdef RECEIVESHADOW\n\t\tfloat shadowValue = 1.0;\n\t\t#ifdef SHADOWMAP_PSSM3\n\t\t\tshadowValue = getShadowPSSM3(u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif\n\t\t#ifdef SHADOWMAP_PSSM2\n\t\t\tshadowValue = getShadowPSSM2(u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif \n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tshadowValue = getShadowPSSM1(u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t\t#endif\n\t\tgl_FragColor =vec4(mainColor.rgb*(globalDiffuse + diffuse*shadowValue),mainColor.a);\n\t#else\n\t\tgl_FragColor =vec4(mainColor.rgb*(globalDiffuse + diffuse),mainColor.a);\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\t#ifdef RECEIVESHADOW\n\t\t\tgl_FragColor.rgb+=specular*shadowValue;\n\t\t#else\n\t\t\tgl_FragColor.rgb+=specular;\n\t\t#endif\n\t#endif\n\t  \n\t#ifdef FOG\n\t\tfloat lerpFact=clamp((1.0/gl_FragCoord.w-u_FogStart)/u_FogRange,0.0,1.0);\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\t\t\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif  \n}\n\n';
                var a = Pt.add("BLINNPHONG", !0), o = new oe(n, i, Di.shaderDefines, ci.shaderDefines);
                a.addSubShader(o), o.addShaderPass(t, e, r), n = {a_Position: 0, a_Color: 1}, i = {
                    u_MvpMatrix: 2,
                    u_Color: 1
                }, r = {
                    s_Cull: 0,
                    s_Blend: 1,
                    s_BlendSrc: 2,
                    s_BlendDst: 3,
                    s_DepthTest: 12,
                    s_DepthWrite: 13
                }, t = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\nuniform vec4 u_Color;\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n\n\nvoid main()\n{\n\tgl_Position = u_MvpMatrix * a_Position;\n\tv_Color=a_Color*u_Color;\n\tgl_Position=remapGLPositionZ(gl_Position);\n}', e = "#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_Color;\nuniform vec4 u_Color;\n\nvoid main()\n{\n  gl_FragColor = v_Color * u_Color; \n}\n\n", a = Pt.add("LineShader"), o = new oe(n, i), a.addSubShader(o), o.addShaderPass(t, e, r), n = {
                    a_Position: 0,
                    a_Normal: 3,
                    a_Tangent0: 4,
                    a_Texcoord0: 2,
                    a_BoneWeights: 6,
                    a_BoneIndices: 5,
                    a_MvpMatrix: 12,
                    a_WorldMat: 8
                }, i = {
                    u_Bones: 0,
                    u_MvpMatrix: 2,
                    u_WorldMat: 2,
                    u_CameraPos: 3,
                    u_AlphaTestValue: 1,
                    u_AlbedoColor: 1,
                    u_EmissionColor: 1,
                    u_AlbedoTexture: 1,
                    u_NormalTexture: 1,
                    u_ParallaxTexture: 1,
                    u_MetallicGlossTexture: 1,
                    u_OcclusionTexture: 1,
                    u_EmissionTexture: 1,
                    u_metallic: 1,
                    u_smoothness: 1,
                    u_smoothnessScale: 1,
                    u_occlusionStrength: 1,
                    u_normalScale: 1,
                    u_parallaxScale: 1,
                    u_TilingOffset: 1,
                    "u_DirectionLight.Direction": 4,
                    "u_DirectionLight.Color": 4,
                    u_PointLightMatrix: 4,
                    "u_PointLight.Position": 4,
                    "u_PointLight.Range": 4,
                    "u_PointLight.Color": 4,
                    "u_SpotLight.Position": 4,
                    "u_SpotLight.Direction": 4,
                    "u_SpotLight.Range": 4,
                    "u_SpotLight.SpotAngle": 4,
                    "u_SpotLight.Color": 4,
                    u_RangeTexture: 4,
                    u_ReflectTexture: 4,
                    u_ReflectIntensity: 4,
                    u_AmbientColor: 4,
                    u_shadowMap1: 4,
                    u_shadowMap2: 4,
                    u_shadowMap3: 4,
                    u_shadowPSSMDistance: 4,
                    u_lightShadowVP: 4,
                    u_shadowPCFoffset: 4,
                    u_FogStart: 4,
                    u_FogRange: 4,
                    u_FogColor: 4
                }, r = {
                    s_Cull: 0,
                    s_Blend: 1,
                    s_BlendSrc: 2,
                    s_BlendDst: 3,
                    s_DepthTest: 12,
                    s_DepthWrite: 13
                }, t = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nattribute vec3 a_Normal;\nattribute vec4 a_Tangent0;\nattribute vec2 a_Texcoord0;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_WorldMat;\n#else\n\tuniform mat4 u_WorldMat;\n#endif\n\nuniform vec3 u_CameraPos;\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec3 v_PositionWorld;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n\t  varying vec4 v_lightMVPPos;\n\t  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main_castShadow()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t \n\t//TODO没考虑UV动画呢\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tv_Texcoord0 = a_Texcoord0;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tmat4 worldMat;\n\t\t#ifdef GPU_INSTANCE\n\t\t\tworldMat = a_WorldMat;\n\t\t#else\n\t\t\tworldMat = u_WorldMat;\n\t\t#endif\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tmat3 worldInvMat;\n\t\t#ifdef BONE\n\t\t\tworldInvMat=inverse(mat3(worldMat*skinTransform));\n\t\t#else\n\t\t\tworldInvMat=inverse(mat3(worldMat));\n\t\t#endif  \n\t\tv_Normal=a_Normal*worldInvMat;\n\t\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))\n\t\t\tv_Tangent=a_Tangent0.xyz*worldInvMat;\n\t\t\tv_Binormal=cross(v_Normal,v_Tangent)*a_Tangent0.w;\n\t\t#endif\n\t#endif\n\t\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tv_PositionWorld=(worldMat*position).xyz;\n\t#endif\n\t\n  \n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tv_ViewDir=u_CameraPos-v_PositionWorld;\n\t#endif\n\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t#else\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n  \n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1 \n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif\n}', e = '#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec3 v_PositionWorld;\n\nuniform vec3 u_AmbientColor;\nuniform vec4 u_AlbedoColor;\n\n#ifdef ALBEDOTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n#endif\n#ifdef METALLICGLOSSTEXTURE\n\tuniform sampler2D u_MetallicGlossTexture;\n#endif\n#ifdef NORMALTEXTURE\n\tuniform sampler2D u_NormalTexture;\n\tuniform float u_normalScale;\n#endif\n#ifdef PARALLAXTEXTURE\n\tuniform sampler2D u_ParallaxTexture;\n\tuniform float u_parallaxScale;\n#endif\n#ifdef OCCLUSIONTEXTURE\n\tuniform sampler2D u_OcclusionTexture;\n\tuniform float u_occlusionStrength;\n#endif\n#ifdef EMISSION\n\t#ifdef EMISSIONTEXTURE\n\t\tuniform sampler2D u_EmissionTexture;\n\t#endif\n\tuniform vec4 u_EmissionColor;\n#endif\n#ifdef REFLECTMAP\n\tuniform samplerCube u_ReflectTexture;\n\tuniform float u_ReflectIntensity;\n#endif\n\nuniform float u_AlphaTestValue;\nuniform float u_metallic;\nuniform float u_smoothness;\nuniform float u_smoothnessScale;\n\nuniform sampler2D u_RangeTexture;\n//uniform sampler2D u_AngleTexture;\nuniform mat4 u_PointLightMatrix;\n//uniform mat4 u_SpotLightMatrix;\n\n#include "PBRStandardLighting.glsl"\n#include "ShadowHelper.glsl"\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\nvoid main_castShadow()\n{\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_AlbedoTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\n\nvoid main_normal()\n{\t\n\tvec3 viewDir = normalize(v_ViewDir);\n\t\n\tvec2 uv0 = ParallaxOffset(viewDir);\n\t\n\tvec2 mg;\n\tvec4 albedoColor;\n\t#ifdef ALBEDOTEXTURE\n\t\tvec4 abledoTextureColor = texture2D(u_AlbedoTexture, uv0);\n\t\talbedoColor = abledoTextureColor * u_AlbedoColor;\n\t\tmg = MetallicGloss(abledoTextureColor.a, uv0);\n\t#else\n\t\talbedoColor = u_AlbedoColor;\n\t\tmg = MetallicGloss(1.0, uv0);\n\t#endif\n\t\n\t#ifdef ALPHATEST\n\t\tif(albedoColor.a < u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n\t\n\tvec3 normal = UnpackScaleNormal(uv0);\n  \n\tLayaGI gi;\n\tgi.diffuse = u_AmbientColor * Occlusion(uv0).rgb;\n\tgi.specular = ReflectCubeMap(viewDir, normal);\n  \n\tvec4 color = vec4(0.0);\n\t\n\t#ifdef DIRECTIONLIGHT\n\t\tcolor += PBRStandardDiectionLight(albedoColor, mg.r, mg.g, normal, viewDir, u_DirectionLight, gi);\n\t#endif\n \n\t#ifdef POINTLIGHT\n\t\tcolor.a = 0.0;\n\t\tcolor += PBRStandardPointLight(albedoColor, mg.r, mg.g, normal, viewDir, u_PointLight, v_PositionWorld, gi);\n\t#endif\n\t\n\t#ifdef SPOTLIGHT\n\t\tcolor.a = 0.0;\n\t\tcolor += PBRStandardSpotLight(albedoColor, mg.r, mg.g, normal, viewDir, u_SpotLight, v_PositionWorld, gi);\n\t#endif\n\t\n\t#ifdef EMISSION\n\t\tvec4 emissionColor = u_EmissionColor;\n\t\t#ifdef EMISSIONTEXTURE\n\t\t\temissionColor *=  texture2D(u_EmissionTexture, uv0);\n\t\t#endif\n\t\tcolor.rgb += emissionColor.rgb;\n\t#endif\n\t\n\t#ifdef RECEIVESHADOW\n\t\tfloat shadowValue = 1.0;\n\t\t#ifdef SHADOWMAP_PSSM3\n\t\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif\n\t\t#ifdef SHADOWMAP_PSSM2\n\t\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif \n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t\t#endif\n\t\tgl_FragColor = vec4(color.rgb * shadowValue, color.a);\n\t#else\n\t\tgl_FragColor = color;\n\t#endif\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact = clamp((1.0 / gl_FragCoord.w - u_FogStart) / u_FogRange, 0.0, 1.0);\n\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, u_FogColor, lerpFact);\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\t\t\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif  \n}', a = Pt.add("PBRStandard", !0), o = new oe(n, i, Di.shaderDefines, oi.shaderDefines), a.addSubShader(o), o.addShaderPass(t, e, r), n = {
                    a_Position: 0,
                    a_Normal: 3,
                    a_Tangent0: 4,
                    a_Texcoord0: 2,
                    a_BoneWeights: 6,
                    a_BoneIndices: 5,
                    a_MvpMatrix: 12,
                    a_WorldMat: 8
                }, i = {
                    u_Bones: 0,
                    u_MvpMatrix: 2,
                    u_WorldMat: 2,
                    u_CameraPos: 3,
                    u_AlphaTestValue: 1,
                    u_AlbedoColor: 1,
                    u_SpecularColor: 1,
                    u_EmissionColor: 1,
                    u_AlbedoTexture: 1,
                    u_NormalTexture: 1,
                    u_ParallaxTexture: 1,
                    u_SpecularTexture: 1,
                    u_OcclusionTexture: 1,
                    u_EmissionTexture: 1,
                    u_smoothness: 1,
                    u_smoothnessScale: 1,
                    u_occlusionStrength: 1,
                    u_normalScale: 1,
                    u_parallaxScale: 1,
                    u_TilingOffset: 1,
                    "u_DirectionLight.Direction": 4,
                    "u_DirectionLight.Color": 4,
                    u_PointLightMatrix: 4,
                    "u_PointLight.Position": 4,
                    "u_PointLight.Range": 4,
                    "u_PointLight.Color": 4,
                    "u_SpotLight.Position": 4,
                    "u_SpotLight.Direction": 4,
                    "u_SpotLight.Range": 4,
                    "u_SpotLight.SpotAngle": 4,
                    "u_SpotLight.Color": 4,
                    u_RangeTexture: 4,
                    u_ReflectTexture: 4,
                    u_ReflectIntensity: 4,
                    u_AmbientColor: 4,
                    u_shadowMap1: 4,
                    u_shadowMap2: 4,
                    u_shadowMap3: 4,
                    u_shadowPSSMDistance: 4,
                    u_lightShadowVP: 4,
                    u_shadowPCFoffset: 4,
                    u_FogStart: 4,
                    u_FogRange: 4,
                    u_FogColor: 4
                }, r = {
                    s_Cull: 0,
                    s_Blend: 1,
                    s_BlendSrc: 2,
                    s_BlendDst: 3,
                    s_DepthTest: 12,
                    s_DepthWrite: 13
                }, t = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nattribute vec3 a_Normal;\nattribute vec4 a_Tangent0;\nattribute vec2 a_Texcoord0;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_WorldMat;\n#else\n\tuniform mat4 u_WorldMat;\n#endif\nuniform vec3 u_CameraPos;\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec3 v_PositionWorld;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n\t  varying vec4 v_lightMVPPos;\n\t  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main_castShadow()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t \n\t//TODO没考虑UV动画呢\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tv_Texcoord0 = a_Texcoord0;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tmat4 worldMat;\n\t\t#ifdef GPU_INSTANCE\n\t\t\tworldMat = a_WorldMat;\n\t\t#else\n\t\t\tworldMat = u_WorldMat;\n\t\t#endif\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tmat3 worldInvMat;\n\t\t#ifdef BONE\n\t\t\tworldInvMat=inverse(mat3(worldMat*skinTransform));\n\t\t#else\n\t\t\tworldInvMat=inverse(mat3(worldMat));\n\t\t#endif  \n\t\tv_Normal=a_Normal*worldInvMat;\n\t\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))\n\t\t\tv_Tangent=a_Tangent0.xyz*worldInvMat;\n\t\t\tv_Binormal=cross(v_Normal,v_Tangent)*a_Tangent0.w;\n\t\t#endif\n\t#endif\n\t\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tv_PositionWorld=(worldMat*position).xyz;\n\t#endif\n\t\n  \n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tv_ViewDir=u_CameraPos-v_PositionWorld;\n\t#endif\n\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t#else\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n  \n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1 \n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif\n}', e = '#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec3 v_PositionWorld;\n\nuniform vec3 u_AmbientColor;\nuniform vec4 u_AlbedoColor;\nuniform vec4 u_SpecularColor;\n\n#ifdef ALBEDOTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n#endif\n#ifdef SPECULARTEXTURE\n\tuniform sampler2D u_SpecularTexture;\n#endif\n#ifdef NORMALTEXTURE\n\tuniform sampler2D u_NormalTexture;\n\tuniform float u_normalScale;\n#endif\n#ifdef PARALLAXTEXTURE\n\tuniform sampler2D u_ParallaxTexture;\n\tuniform float u_parallaxScale;\n#endif\n#ifdef OCCLUSIONTEXTURE\n\tuniform sampler2D u_OcclusionTexture;\n\tuniform float u_occlusionStrength;\n#endif\n#ifdef EMISSION\n\t#ifdef EMISSIONTEXTURE\n\t\tuniform sampler2D u_EmissionTexture;\n\t#endif\n\tuniform vec4 u_EmissionColor;\n#endif\n#ifdef REFLECTMAP\n\tuniform samplerCube u_ReflectTexture;\n\tuniform float u_ReflectIntensity;\n#endif\n\nuniform float u_AlphaTestValue;\nuniform float u_metallic;\nuniform float u_smoothness;\nuniform float u_smoothnessScale;\n\nuniform sampler2D u_RangeTexture;\n//uniform sampler2D u_AngleTexture;\nuniform mat4 u_PointLightMatrix;\n//uniform mat4 u_SpotLightMatrix;\n\n#include "PBRSpecularLighting.glsl"\n#include "ShadowHelper.glsl"\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\nvoid main_castShadow()\n{\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_AlbedoTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\n\nvoid main_normal()\n{\t\n\tvec3 viewDir = normalize(v_ViewDir);\n\t\n\tvec2 uv0 = ParallaxOffset(viewDir);\n\t\n\tvec4 sg;\n\tvec4 albedoColor;\n\t#ifdef ALBEDOTEXTURE\n\t\tvec4 albedoTextureColor = texture2D(u_AlbedoTexture, uv0);\n\t\talbedoColor = albedoTextureColor * u_AlbedoColor;\n\t\tsg = SpecularGloss(albedoTextureColor.a, uv0);\n\t#else\n\t\talbedoColor = u_AlbedoColor;\n\t\tsg = SpecularGloss(1.0, uv0);\n\t#endif\n\t\n\t#ifdef ALPHATEST\n\t\tif(albedoColor.a < u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n  \n\tvec3 normal = UnpackScaleNormal(uv0);\n\t\n\tLayaGI gi;\n\tgi.diffuse = u_AmbientColor * Occlusion(uv0).rgb;\n\tgi.specular = ReflectCubeMap(viewDir, normal);\n\t\n\t//float a = (sg.r+sg.g+sg.b) / 3.0;\n  \n\tvec4 color = vec4(0.0);\n\t\n\t#ifdef DIRECTIONLIGHT\n\t\tcolor += PBRSpecularDiectionLight(albedoColor, sg.rgb, sg.a, normal, viewDir, u_DirectionLight, gi);\n\t#endif\n \n\t#ifdef POINTLIGHT\n\t\tcolor.a = 0.0;\n\t\tcolor += PBRSpecularPointLight(albedoColor, sg.rgb, sg.a, normal, viewDir, u_PointLight, v_PositionWorld, gi);\n\t#endif\n\t\n\t#ifdef SPOTLIGHT\n\t\tcolor.a = 0.0;\n\t\tcolor += PBRSpecularSpotLight(albedoColor, sg.rgb, sg.a, normal, viewDir, u_SpotLight, v_PositionWorld, gi);\n\t#endif\n\t\n\t#ifdef EMISSION\n\t\tvec4 emissionColor = u_EmissionColor;\n\t\t#ifdef EMISSIONTEXTURE\n\t\t\temissionColor *=  texture2D(u_EmissionTexture, uv0);\n\t\t#endif\n\t\tcolor.rgb += emissionColor.rgb;\n\t#endif\n\t\n\t#ifdef RECEIVESHADOW\n\t\tfloat shadowValue = 1.0;\n\t\t#ifdef SHADOWMAP_PSSM3\n\t\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif\n\t\t#ifdef SHADOWMAP_PSSM2\n\t\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif \n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t\t#endif\n\t\tgl_FragColor = vec4(color.rgb * shadowValue, color.a);\n\t#else\n\t\tgl_FragColor = color;\n\t#endif\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact = clamp((1.0 / gl_FragCoord.w - u_FogStart) / u_FogRange, 0.0, 1.0);\n\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, u_FogColor, lerpFact);\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\t\t\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif  \n}\n\n', a = Pt.add("PBRSpecular", !0), o = new oe(n, i, Di.shaderDefines, fi.shaderDefines), a.addSubShader(o), o.addShaderPass(t, e, r), n = {
                    a_Position: 0,
                    a_Color: 1,
                    a_Texcoord0: 2,
                    a_BoneWeights: 6,
                    a_BoneIndices: 5,
                    a_MvpMatrix: 12
                }, i = {
                    u_Bones: 0,
                    u_AlbedoTexture: 1,
                    u_AlbedoColor: 1,
                    u_TilingOffset: 1,
                    u_AlphaTestValue: 1,
                    u_MvpMatrix: 2,
                    u_FogStart: 4,
                    u_FogRange: 4,
                    u_FogColor: 4
                }, r = {
                    s_Cull: 0,
                    s_Blend: 1,
                    s_BlendSrc: 2,
                    s_BlendDst: 3,
                    s_DepthTest: 12,
                    s_DepthWrite: 13
                }, t = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\n\nattribute vec2 a_Texcoord0;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\nattribute vec4 a_Color;\nvarying vec4 v_Color;\nvarying vec2 v_Texcoord0;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main() {\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t#else\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n\n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tv_Color = a_Color;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}', e = "#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\tvarying vec4 v_Color;\n#endif\n\n#ifdef ALBEDOTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n\tvarying vec2 v_Texcoord0;\n#endif\n\nuniform vec4 u_AlbedoColor;\n\n#ifdef ALPHATEST\n\tuniform float u_AlphaTestValue;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\nvoid main()\n{\n\tvec4 color =  u_AlbedoColor;\n\t#ifdef ALBEDOTEXTURE\n\t\tcolor *= texture2D(u_AlbedoTexture, v_Texcoord0);\n\t#endif\n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tcolor *= v_Color;\n\t#endif\n\t\n\t#ifdef ALPHATEST\n\t\tif(color.a < u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n\t\n\tgl_FragColor = color;\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact = clamp((1.0 / gl_FragCoord.w - u_FogStart) / u_FogRange, 0.0, 1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.0), lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, u_FogColor, lerpFact);\n\t\t#endif\n\t#endif\n\t\n}\n\n", a = Pt.add("Unlit", !0), o = new oe(n, i, Di.shaderDefines, $n.shaderDefines), a.addSubShader(o), o.addShaderPass(t, e, r), n = {
                    a_Position: 0,
                    a_Texcoord0: 2,
                    a_BoneWeights: 6,
                    a_BoneIndices: 5,
                    a_MvpMatrix: 12
                }, i = {
                    u_Bones: 0,
                    u_AlbedoTexture: 1,
                    u_AlbedoColor: 1,
                    u_TilingOffset: 1,
                    u_AlphaTestValue: 1,
                    u_MvpMatrix: 2,
                    u_FogStart: 4,
                    u_FogRange: 4,
                    u_FogColor: 4
                }, r = {
                    s_Cull: 0,
                    s_Blend: 1,
                    s_BlendSrc: 2,
                    s_BlendDst: 3,
                    s_DepthTest: 12,
                    s_DepthWrite: 13
                }, t = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Texcoord0;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\nvarying vec4 v_Color;\nvarying vec2 v_Texcoord0;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t#else\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n\t\t\n\tv_Color = a_Color;\n\tgl_Position=remapGLPositionZ(gl_Position);\n}', e = "#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#ifdef COLOR\n\tvarying vec4 v_Color;\n#endif\nvarying vec2 v_Texcoord0;\n\n#ifdef MAINTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n#endif\n\nuniform vec4 u_AlbedoColor;\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\nvoid main()\n{\n\tvec4 color =  2.0 * u_AlbedoColor;\n\t#ifdef COLOR\n\t\tcolor *= v_Color;\n\t#endif\n\t#ifdef MAINTEXTURE\n\t\tcolor *= texture2D(u_AlbedoTexture, v_Texcoord0);\n\t#endif\n\t\n\tgl_FragColor = color;\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact = clamp((1.0 / gl_FragCoord.w - u_FogStart) / u_FogRange, 0.0, 1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.0), lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, u_FogColor, lerpFact);\n\t\t#endif\n\t#endif\n}\n\n", a = Pt.add("Effect", !0), o = new oe(n, i, Di.shaderDefines, li.shaderDefines), a.addSubShader(o), o.addShaderPass(t, e, r), n = {
                    a_CornerTextureCoordinate: 0,
                    a_MeshPosition: 1,
                    a_MeshColor: 2,
                    a_MeshTextureCoordinate: 3,
                    a_ShapePositionStartLifeTime: 4,
                    a_DirectionTime: 5,
                    a_StartColor: 6,
                    a_EndColor: 7,
                    a_StartSize: 8,
                    a_StartRotation0: 9,
                    a_StartSpeed: 10,
                    a_Random0: 11,
                    a_Random1: 12,
                    a_SimulationWorldPostion: 13,
                    a_SimulationWorldRotation: 14
                }, i = {
                    u_Tintcolor: 1,
                    u_TilingOffset: 1,
                    u_texture: 1,
                    u_WorldPosition: 2,
                    u_WorldRotation: 2,
                    u_PositionScale: 2,
                    u_SizeScale: 2,
                    u_ScalingMode: 2,
                    u_Gravity: 2,
                    u_ThreeDStartRotation: 2,
                    u_StretchedBillboardLengthScale: 2,
                    u_StretchedBillboardSpeedScale: 2,
                    u_SimulationSpace: 2,
                    u_CurrentTime: 2,
                    u_ColorOverLifeGradientAlphas: 2,
                    u_ColorOverLifeGradientColors: 2,
                    u_MaxColorOverLifeGradientAlphas: 2,
                    u_MaxColorOverLifeGradientColors: 2,
                    u_VOLVelocityConst: 2,
                    u_VOLVelocityGradientX: 2,
                    u_VOLVelocityGradientY: 2,
                    u_VOLVelocityGradientZ: 2,
                    u_VOLVelocityConstMax: 2,
                    u_VOLVelocityGradientMaxX: 2,
                    u_VOLVelocityGradientMaxY: 2,
                    u_VOLVelocityGradientMaxZ: 2,
                    u_VOLSpaceType: 2,
                    u_SOLSizeGradient: 2,
                    u_SOLSizeGradientX: 2,
                    u_SOLSizeGradientY: 2,
                    u_SOLSizeGradientZ: 2,
                    u_SOLSizeGradientMax: 2,
                    u_SOLSizeGradientMaxX: 2,
                    u_SOLSizeGradientMaxY: 2,
                    u_SOLSizeGradientMaxZ: 2,
                    u_ROLAngularVelocityConst: 2,
                    u_ROLAngularVelocityConstSeprarate: 2,
                    u_ROLAngularVelocityGradient: 2,
                    u_ROLAngularVelocityGradientX: 2,
                    u_ROLAngularVelocityGradientY: 2,
                    u_ROLAngularVelocityGradientZ: 2,
                    u_ROLAngularVelocityConstMax: 2,
                    u_ROLAngularVelocityConstMaxSeprarate: 2,
                    u_ROLAngularVelocityGradientMax: 2,
                    u_ROLAngularVelocityGradientMaxX: 2,
                    u_ROLAngularVelocityGradientMaxY: 2,
                    u_ROLAngularVelocityGradientMaxZ: 2,
                    u_ROLAngularVelocityGradientMaxW: 2,
                    u_TSACycles: 2,
                    u_TSASubUVLength: 2,
                    u_TSAGradientUVs: 2,
                    u_TSAMaxGradientUVs: 2,
                    u_CameraPos: 3,
                    u_CameraDirection: 3,
                    u_CameraUp: 3,
                    u_View: 3,
                    u_Projection: 3,
                    u_FogStart: 4,
                    u_FogRange: 4,
                    u_FogColor: 4
                }, r = {
                    s_Cull: 0,
                    s_Blend: 1,
                    s_BlendSrc: 2,
                    s_BlendDst: 3,
                    s_DepthTest: 12,
                    s_DepthWrite: 13
                }, t = '#include "Lighting.glsl";\n\n#ifdef HIGHPRECISION\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\n#if defined(SPHERHBILLBOARD)||defined(STRETCHEDBILLBOARD)||defined(HORIZONTALBILLBOARD)||defined(VERTICALBILLBOARD)\n\tattribute vec4 a_CornerTextureCoordinate;\n#endif\n#ifdef RENDERMODE_MESH\n\tattribute vec3 a_MeshPosition;\n\tattribute vec4 a_MeshColor;\n\tattribute vec2 a_MeshTextureCoordinate;\n\tvarying vec4 v_MeshColor;\n#endif\n\nattribute vec4 a_ShapePositionStartLifeTime;\nattribute vec4 a_DirectionTime;\nattribute vec4 a_StartColor;\nattribute vec3 a_StartSize;\nattribute vec3 a_StartRotation0;\nattribute float a_StartSpeed;\n#if defined(COLOROVERLIFETIME)||defined(RANDOMCOLOROVERLIFETIME)||defined(SIZEOVERLIFETIMERANDOMCURVES)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n  attribute vec4 a_Random0;\n#endif\n#if defined(TEXTURESHEETANIMATIONRANDOMCURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  attribute vec4 a_Random1;\n#endif\nattribute vec3 a_SimulationWorldPostion;\nattribute vec4 a_SimulationWorldRotation;\n\nvarying float v_Discard;\nvarying vec4 v_Color;\n#ifdef DIFFUSEMAP\n\tvarying vec2 v_TextureCoordinate;\n#endif\n\nuniform float u_CurrentTime;\nuniform vec3 u_Gravity;\n\nuniform vec3 u_WorldPosition;\nuniform vec4 u_WorldRotation;\nuniform bool u_ThreeDStartRotation;\nuniform int u_ScalingMode;\nuniform vec3 u_PositionScale;\nuniform vec3 u_SizeScale;\nuniform mat4 u_View;\nuniform mat4 u_Projection;\n\n#ifdef STRETCHEDBILLBOARD\n\tuniform vec3 u_CameraPosition;\n#endif\nuniform vec3 u_CameraDirection;//TODO:只有几种广告牌模式需要用\nuniform vec3 u_CameraUp;\n\nuniform  float u_StretchedBillboardLengthScale;\nuniform  float u_StretchedBillboardSpeedScale;\nuniform int u_SimulationSpace;\n\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  uniform  int  u_VOLSpaceType;\n#endif\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)\n  uniform  vec3 u_VOLVelocityConst;\n#endif\n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  uniform  vec2 u_VOLVelocityGradientX[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientY[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientZ[4];//x为key,y为速度\n#endif\n#ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n  uniform  vec3 u_VOLVelocityConstMax;\n#endif\n#ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n  uniform  vec2 u_VOLVelocityGradientMaxX[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientMaxY[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientMaxZ[4];//x为key,y为速度\n#endif\n\n#ifdef COLOROVERLIFETIME\n  uniform  vec4 u_ColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_ColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n#endif\n#ifdef RANDOMCOLOROVERLIFETIME\n  uniform  vec4 u_ColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_ColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n  uniform  vec4 u_MaxColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_MaxColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n#endif\n\n\n#if defined(SIZEOVERLIFETIMECURVE)||defined(SIZEOVERLIFETIMERANDOMCURVES)\n  uniform  vec2 u_SOLSizeGradient[4];//x为key,y为尺寸\n#endif\n#ifdef SIZEOVERLIFETIMERANDOMCURVES\n  uniform  vec2 u_SOLSizeGradientMax[4];//x为key,y为尺寸\n#endif\n#if defined(SIZEOVERLIFETIMECURVESEPERATE)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)\n  uniform  vec2 u_SOLSizeGradientX[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientY[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientZ[4];//x为key,y为尺寸\n#endif\n#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n  uniform  vec2 u_SOLSizeGradientMaxX[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientMaxY[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientMaxZ[4];//x为key,y为尺寸\n#endif\n\n\n#ifdef ROTATIONOVERLIFETIME\n  #if defined(ROTATIONOVERLIFETIMECONSTANT)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)\n    uniform  float u_ROLAngularVelocityConst;\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n    uniform  float u_ROLAngularVelocityConstMax;\n  #endif\n  #if defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n    uniform  vec2 u_ROLAngularVelocityGradient[4];//x为key,y为旋转\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n    uniform  vec2 u_ROLAngularVelocityGradientMax[4];//x为key,y为旋转\n  #endif\n#endif\n#ifdef ROTATIONOVERLIFETIMESEPERATE\n  #if defined(ROTATIONOVERLIFETIMECONSTANT)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)\n    uniform  vec3 u_ROLAngularVelocityConstSeprarate;\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n    uniform  vec3 u_ROLAngularVelocityConstMaxSeprarate;\n  #endif\n  #if defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n    uniform  vec2 u_ROLAngularVelocityGradientX[4];\n    uniform  vec2 u_ROLAngularVelocityGradientY[4];\n    uniform  vec2 u_ROLAngularVelocityGradientZ[4];\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n    uniform  vec2 u_ROLAngularVelocityGradientMaxX[4];\n    uniform  vec2 u_ROLAngularVelocityGradientMaxY[4];\n    uniform  vec2 u_ROLAngularVelocityGradientMaxZ[4];\n\tuniform  vec2 u_ROLAngularVelocityGradientMaxW[4];\n  #endif\n#endif\n\n#if defined(TEXTURESHEETANIMATIONCURVE)||defined(TEXTURESHEETANIMATIONRANDOMCURVE)\n  uniform  float u_TSACycles;\n  uniform  vec2 u_TSASubUVLength;\n  uniform  vec2 u_TSAGradientUVs[4];//x为key,y为frame\n#endif\n#ifdef TEXTURESHEETANIMATIONRANDOMCURVE\n  uniform  vec2 u_TSAMaxGradientUVs[4];//x为key,y为frame\n#endif\n\n#ifdef FOG\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvec3 rotationByEuler(in vec3 vector,in vec3 rot)\n{\n\tfloat halfRoll = rot.z * 0.5;\n    float halfPitch = rot.x * 0.5;\n\tfloat halfYaw = rot.y * 0.5;\n\n\tfloat sinRoll = sin(halfRoll);\n\tfloat cosRoll = cos(halfRoll);\n\tfloat sinPitch = sin(halfPitch);\n\tfloat cosPitch = cos(halfPitch);\n\tfloat sinYaw = sin(halfYaw);\n\tfloat cosYaw = cos(halfYaw);\n\n\tfloat quaX = (cosYaw * sinPitch * cosRoll) + (sinYaw * cosPitch * sinRoll);\n\tfloat quaY = (sinYaw * cosPitch * cosRoll) - (cosYaw * sinPitch * sinRoll);\n\tfloat quaZ = (cosYaw * cosPitch * sinRoll) - (sinYaw * sinPitch * cosRoll);\n\tfloat quaW = (cosYaw * cosPitch * cosRoll) + (sinYaw * sinPitch * sinRoll);\n\t\n\t//vec4 q=vec4(quaX,quaY,quaZ,quaW);\n\t//vec3 temp = cross(q.xyz, vector) + q.w * vector;\n\t//return (cross(temp, -q.xyz) + dot(q.xyz,vector) * q.xyz + q.w * temp);\n\t\n\tfloat x = quaX + quaX;\n    float y = quaY + quaY;\n    float z = quaZ + quaZ;\n    float wx = quaW * x;\n    float wy = quaW * y;\n    float wz = quaW * z;\n\tfloat xx = quaX * x;\n    float xy = quaX * y;\n\tfloat xz = quaX * z;\n    float yy = quaY * y;\n    float yz = quaY * z;\n    float zz = quaZ * z;\n\n    return vec3(((vector.x * ((1.0 - yy) - zz)) + (vector.y * (xy - wz))) + (vector.z * (xz + wy)),\n                ((vector.x * (xy + wz)) + (vector.y * ((1.0 - xx) - zz))) + (vector.z * (yz - wx)),\n                ((vector.x * (xz - wy)) + (vector.y * (yz + wx))) + (vector.z * ((1.0 - xx) - yy)));\n\t\n}\n\n//假定axis已经归一化\nvec3 rotationByAxis(in vec3 vector,in vec3 axis, in float angle)\n{\n\tfloat halfAngle = angle * 0.5;\n\tfloat sin = sin(halfAngle);\n\t\n\tfloat quaX = axis.x * sin;\n\tfloat quaY = axis.y * sin;\n\tfloat quaZ = axis.z * sin;\n\tfloat quaW = cos(halfAngle);\n\t\n\t//vec4 q=vec4(quaX,quaY,quaZ,quaW);\n\t//vec3 temp = cross(q.xyz, vector) + q.w * vector;\n\t//return (cross(temp, -q.xyz) + dot(q.xyz,vector) * q.xyz + q.w * temp);\n\t\n\tfloat x = quaX + quaX;\n    float y = quaY + quaY;\n    float z = quaZ + quaZ;\n    float wx = quaW * x;\n    float wy = quaW * y;\n    float wz = quaW * z;\n\tfloat xx = quaX * x;\n    float xy = quaX * y;\n\tfloat xz = quaX * z;\n    float yy = quaY * y;\n    float yz = quaY * z;\n    float zz = quaZ * z;\n\n    return vec3(((vector.x * ((1.0 - yy) - zz)) + (vector.y * (xy - wz))) + (vector.z * (xz + wy)),\n                ((vector.x * (xy + wz)) + (vector.y * ((1.0 - xx) - zz))) + (vector.z * (yz - wx)),\n                ((vector.x * (xz - wy)) + (vector.y * (yz + wx))) + (vector.z * ((1.0 - xx) - yy)));\n\t\n}\n\nvec3 rotationByQuaternions(in vec3 v,in vec4 q) \n{\n\treturn v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\n \n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)||defined(SIZEOVERLIFETIMECURVE)||defined(SIZEOVERLIFETIMECURVESEPERATE)||defined(SIZEOVERLIFETIMERANDOMCURVES)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)\nfloat getCurValueFromGradientFloat(in vec2 gradientNumbers[4],in float normalizedAge)\n{\n\tfloat curValue;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientNumber=gradientNumbers[i];\n\t\tfloat key=gradientNumber.x;\n\t\tif(key>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientNumber=gradientNumbers[i-1];\n\t\t\tfloat lastKey=lastGradientNumber.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\tcurValue=mix(lastGradientNumber.y,gradientNumber.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn curValue;\n}\n#endif\n\n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)||defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\nfloat getTotalValueFromGradientFloat(in vec2 gradientNumbers[4],in float normalizedAge)\n{\n\tfloat totalValue=0.0;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientNumber=gradientNumbers[i];\n\t\tfloat key=gradientNumber.x;\n\t\tvec2 lastGradientNumber=gradientNumbers[i-1];\n\t\tfloat lastValue=lastGradientNumber.y;\n\t\t\n\t\tif(key>=normalizedAge){\n\t\t\tfloat lastKey=lastGradientNumber.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\ttotalValue+=(lastValue+mix(lastValue,gradientNumber.y,age))/2.0*a_ShapePositionStartLifeTime.w*(normalizedAge-lastKey);\n\t\t\tbreak;\n\t\t}\n\t\telse{\n\t\t\ttotalValue+=(lastValue+gradientNumber.y)/2.0*a_ShapePositionStartLifeTime.w*(key-lastGradientNumber.x);\n\t\t}\n\t}\n\treturn totalValue;\n}\n#endif\n\n#if defined(COLOROVERLIFETIME)||defined(RANDOMCOLOROVERLIFETIME)\nvec4 getColorFromGradient(in vec2 gradientAlphas[4],in vec4 gradientColors[4],in float normalizedAge)\n{\n\tvec4 overTimeColor;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientAlpha=gradientAlphas[i];\n\t\tfloat alphaKey=gradientAlpha.x;\n\t\tif(alphaKey>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientAlpha=gradientAlphas[i-1];\n\t\t\tfloat lastAlphaKey=lastGradientAlpha.x;\n\t\t\tfloat age=(normalizedAge-lastAlphaKey)/(alphaKey-lastAlphaKey);\n\t\t\toverTimeColor.a=mix(lastGradientAlpha.y,gradientAlpha.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec4 gradientColor=gradientColors[i];\n\t\tfloat colorKey=gradientColor.x;\n\t\tif(colorKey>=normalizedAge)\n\t\t{\n\t\t\tvec4 lastGradientColor=gradientColors[i-1];\n\t\t\tfloat lastColorKey=lastGradientColor.x;\n\t\t\tfloat age=(normalizedAge-lastColorKey)/(colorKey-lastColorKey);\n\t\t\toverTimeColor.rgb=mix(gradientColors[i-1].yzw,gradientColor.yzw,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn overTimeColor;\n}\n#endif\n\n\n#if defined(TEXTURESHEETANIMATIONCURVE)||defined(TEXTURESHEETANIMATIONRANDOMCURVE)\nfloat getFrameFromGradient(in vec2 gradientFrames[4],in float normalizedAge)\n{\n\tfloat overTimeFrame;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientFrame=gradientFrames[i];\n\t\tfloat key=gradientFrame.x;\n\t\tif(key>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientFrame=gradientFrames[i-1];\n\t\t\tfloat lastKey=lastGradientFrame.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\toverTimeFrame=mix(lastGradientFrame.y,gradientFrame.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn floor(overTimeFrame);\n}\n#endif\n\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\nvec3 computeParticleLifeVelocity(in float normalizedAge)\n{\n  vec3 outLifeVelocity;\n  #ifdef VELOCITYOVERLIFETIMECONSTANT\n\t outLifeVelocity=u_VOLVelocityConst; \n  #endif\n  #ifdef VELOCITYOVERLIFETIMECURVE\n     outLifeVelocity= vec3(getCurValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge));\n  #endif\n  #ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n\t outLifeVelocity=mix(u_VOLVelocityConst,u_VOLVelocityConstMax,vec3(a_Random1.y,a_Random1.z,a_Random1.w)); \n  #endif\n  #ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n     outLifeVelocity=vec3(mix(getCurValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxX,normalizedAge),a_Random1.y),\n\t                 mix(getCurValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxY,normalizedAge),a_Random1.z),\n\t\t\t\t\t mix(getCurValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxZ,normalizedAge),a_Random1.w));\n  #endif\n\t\t\t\t\t\n  return outLifeVelocity;\n} \n#endif\n\nvec3 computeParticlePosition(in vec3 startVelocity, in vec3 lifeVelocity,in float age,in float normalizedAge,vec3 gravityVelocity,vec4 worldRotation)\n{\n   vec3 startPosition;\n   vec3 lifePosition;\n   #if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t#ifdef VELOCITYOVERLIFETIMECONSTANT\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=lifeVelocity*age;\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMECURVE\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=vec3(getTotalValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge));\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=lifeVelocity*age;\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=vec3(mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxX,normalizedAge),a_Random1.y)\n\t      ,mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxY,normalizedAge),a_Random1.z)\n\t      ,mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxZ,normalizedAge),a_Random1.w));\n\t#endif\n\t\n\tvec3 finalPosition;\n\tif(u_VOLSpaceType==0){\n\t  if(u_ScalingMode!=2)\n\t   finalPosition =rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition+lifePosition),worldRotation);\n\t  else\n\t   finalPosition =rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition+lifePosition,worldRotation);\n\t}\n\telse{\n\t  if(u_ScalingMode!=2)\n\t    finalPosition = rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition),worldRotation)+lifePosition;\n\t  else\n\t    finalPosition = rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition,worldRotation)+lifePosition;\n\t}\n  #else\n\t startPosition=startVelocity*age;\n\t vec3 finalPosition;\n\t if(u_ScalingMode!=2)\n\t   finalPosition = rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition),worldRotation);\n\t else\n\t   finalPosition = rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition,worldRotation);\n  #endif\n  \n  if(u_SimulationSpace==0)\n    finalPosition=finalPosition+a_SimulationWorldPostion;\n  else if(u_SimulationSpace==1) \n    finalPosition=finalPosition+u_WorldPosition;\n  \n  finalPosition+=0.5*gravityVelocity*age;\n \n  return  finalPosition;\n}\n\n\nvec4 computeParticleColor(in vec4 color,in float normalizedAge)\n{\n\t#ifdef COLOROVERLIFETIME\n\t  color*=getColorFromGradient(u_ColorOverLifeGradientAlphas,u_ColorOverLifeGradientColors,normalizedAge);\n\t#endif\n\t\n\t#ifdef RANDOMCOLOROVERLIFETIME\n\t  color*=mix(getColorFromGradient(u_ColorOverLifeGradientAlphas,u_ColorOverLifeGradientColors,normalizedAge),getColorFromGradient(u_MaxColorOverLifeGradientAlphas,u_MaxColorOverLifeGradientColors,normalizedAge),a_Random0.y);\n\t#endif\n\n    return color;\n}\n\nvec2 computeParticleSizeBillbard(in vec2 size,in float normalizedAge)\n{\n\t#ifdef SIZEOVERLIFETIMECURVE\n\t\tsize*=getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge);\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVES\n\t    size*=mix(getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMax,normalizedAge),a_Random0.z); \n\t#endif\n\t#ifdef SIZEOVERLIFETIMECURVESEPERATE\n\t\tsize*=vec2(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge));\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n\t    size*=vec2(mix(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxX,normalizedAge),a_Random0.z)\n\t    ,mix(getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxY,normalizedAge),a_Random0.z));\n\t#endif\n\treturn size;\n}\n\n#ifdef RENDERMODE_MESH\nvec3 computeParticleSizeMesh(in vec3 size,in float normalizedAge)\n{\n\t#ifdef SIZEOVERLIFETIMECURVE\n\t\tsize*=getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge);\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVES\n\t    size*=mix(getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMax,normalizedAge),a_Random0.z); \n\t#endif\n\t#ifdef SIZEOVERLIFETIMECURVESEPERATE\n\t\tsize*=vec3(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientZ,normalizedAge));\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n\t    size*=vec3(mix(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxX,normalizedAge),a_Random0.z)\n\t    ,mix(getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxY,normalizedAge),a_Random0.z)\n\t\t,mix(getCurValueFromGradientFloat(u_SOLSizeGradientZ,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxZ,normalizedAge),a_Random0.z));\n\t#endif\n\treturn size;\n}\n#endif\n\nfloat computeParticleRotationFloat(in float rotation,in float age,in float normalizedAge)\n{ \n\t#ifdef ROTATIONOVERLIFETIME\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConst*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConst,u_ROLAngularVelocityConstMax,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMax,normalizedAge),a_Random0.w);\n\t\t#endif\n\t#endif\n\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConstSeprarate.z*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConstSeprarate.z,u_ROLAngularVelocityConstMaxSeprarate.z,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxZ,normalizedAge),a_Random0.w));\n\t\t#endif\n\t#endif\n\treturn rotation;\n}\n\n#if defined(RENDERMODE_MESH)&&(defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE))\nvec3 computeParticleRotationVec3(in vec3 rotation,in float age,in float normalizedAge)\n{ \n\t#ifdef ROTATIONOVERLIFETIME\n\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConst*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConst,u_ROLAngularVelocityConstMax,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMax,normalizedAge),a_Random0.w);\n\t\t#endif\n\t#endif\n\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tvec3 ageRot=u_ROLAngularVelocityConstSeprarate*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=vec3(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge));\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tvec3 ageRot=mix(u_ROLAngularVelocityConstSeprarate,u_ROLAngularVelocityConstMaxSeprarate,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=vec3(mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxX,normalizedAge),a_Random0.w)\n\t        ,mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxY,normalizedAge),a_Random0.w)\n\t        ,mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxZ,normalizedAge),a_Random0.w));\n\t\t#endif\n\t#endif\n\treturn rotation;\n}\n#endif\n\nvec2 computeParticleUV(in vec2 uv,in float normalizedAge)\n{ \n\t#ifdef TEXTURESHEETANIMATIONCURVE\n\t\tfloat cycleNormalizedAge=normalizedAge*u_TSACycles;\n\t\tfloat frame=getFrameFromGradient(u_TSAGradientUVs,cycleNormalizedAge-floor(cycleNormalizedAge));\n\t\tfloat totalULength=frame*u_TSASubUVLength.x;\n\t\tfloat floorTotalULength=floor(totalULength);\n\t    uv.x+=totalULength-floorTotalULength;\n\t\tuv.y+=floorTotalULength*u_TSASubUVLength.y;\n    #endif\n\t#ifdef TEXTURESHEETANIMATIONRANDOMCURVE\n\t\tfloat cycleNormalizedAge=normalizedAge*u_TSACycles;\n\t\tfloat uvNormalizedAge=cycleNormalizedAge-floor(cycleNormalizedAge);\n\t    float frame=floor(mix(getFrameFromGradient(u_TSAGradientUVs,uvNormalizedAge),getFrameFromGradient(u_TSAMaxGradientUVs,uvNormalizedAge),a_Random1.x));\n\t\tfloat totalULength=frame*u_TSASubUVLength.x;\n\t\tfloat floorTotalULength=floor(totalULength);\n\t    uv.x+=totalULength-floorTotalULength;\n\t\tuv.y+=floorTotalULength*u_TSASubUVLength.y;\n    #endif\n\treturn uv;\n}\n\nvoid main()\n{\n\tfloat age = u_CurrentTime - a_DirectionTime.w;\n\tfloat normalizedAge = age/a_ShapePositionStartLifeTime.w;\n\tvec3 lifeVelocity;\n\tif(normalizedAge<1.0){ \n\tvec3 startVelocity=a_DirectionTime.xyz*a_StartSpeed;\n\t#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t\tlifeVelocity= computeParticleLifeVelocity(normalizedAge);//计算粒子生命周期速度\n\t#endif \n\tvec3 gravityVelocity=u_Gravity*age;\n\t\n\tvec4 worldRotation;\n\tif(u_SimulationSpace==0)\n\t\tworldRotation=a_SimulationWorldRotation;\n\telse\n\t\tworldRotation=u_WorldRotation;\n\t\n\tvec3 center=computeParticlePosition(startVelocity, lifeVelocity, age, normalizedAge,gravityVelocity,worldRotation);//计算粒子位置\n   \n   \n   #ifdef SPHERHBILLBOARD\n\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n        vec3 cameraUpVector =normalize(u_CameraUp);//TODO:是否外面归一化\n        vec3 sideVector = normalize(cross(u_CameraDirection,cameraUpVector));\n        vec3 upVector = normalize(cross(sideVector,u_CameraDirection));\n\t    corner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n\t\t#if defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE)\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tvec3 rotation=vec3(a_StartRotation0.xy,computeParticleRotationFloat(a_StartRotation0.z,age,normalizedAge));\n\t\t\t\tcenter += u_SizeScale.xzy*rotationByEuler(corner.x*sideVector+corner.y*upVector,rotation);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n\t\t\t\tfloat c = cos(rot);\n\t\t\t\tfloat s = sin(rot);\n\t\t\t\tmat2 rotation= mat2(c, -s, s, c);\n\t\t\t\tcorner=rotation*corner;\n\t\t\t\tcenter += u_SizeScale.xzy*(corner.x*sideVector+corner.y*upVector);\n\t\t\t}\n\t\t#else\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tcenter += u_SizeScale.xzy*rotationByEuler(corner.x*sideVector+corner.y*upVector,a_StartRotation0);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfloat c = cos(a_StartRotation0.x);\n\t\t\t\tfloat s = sin(a_StartRotation0.x);\n\t\t\t\tmat2 rotation= mat2(c, -s, s, c);\n\t\t\t\tcorner=rotation*corner;\n\t\t\t\tcenter += u_SizeScale.xzy*(corner.x*sideVector+corner.y*upVector);\n\t\t\t}\n\t\t#endif\n   #endif\n   \n   #ifdef STRETCHEDBILLBOARD\n\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n\tvec3 velocity;\n\t#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t    if(u_VOLSpaceType==0)\n\t\t  velocity=rotationByQuaternions(u_SizeScale*(startVelocity+lifeVelocity),worldRotation)+gravityVelocity;\n\t    else\n\t\t  velocity=rotationByQuaternions(u_SizeScale*startVelocity,worldRotation)+lifeVelocity+gravityVelocity;\n    #else\n\t    velocity= rotationByQuaternions(u_SizeScale*startVelocity,worldRotation)+gravityVelocity;\n    #endif\t\n\t\tvec3 cameraUpVector = normalize(velocity);\n\t\tvec3 direction = normalize(center-u_CameraPosition);\n        vec3 sideVector = normalize(cross(direction,normalize(velocity)));\n\t\t\n\t\tsideVector=u_SizeScale.xzy*sideVector;\n\t\tcameraUpVector=length(vec3(u_SizeScale.x,0.0,0.0))*cameraUpVector;\n\t\t\n\t    vec2 size=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n\t\t\n\t    const mat2 rotaionZHalfPI=mat2(0.0, -1.0, 1.0, 0.0);\n\t    corner=rotaionZHalfPI*corner;\n\t    corner.y=corner.y-abs(corner.y);\n\t\t\n\t    float speed=length(velocity);//TODO:\n\t    center +=sign(u_SizeScale.x)*(sign(u_StretchedBillboardLengthScale)*size.x*corner.x*sideVector+(speed*u_StretchedBillboardSpeedScale+size.y*u_StretchedBillboardLengthScale)*corner.y*cameraUpVector);\n   #endif\n   \n   #ifdef HORIZONTALBILLBOARD\n\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n        const vec3 cameraUpVector=vec3(0.0,0.0,1.0);\n\t    const vec3 sideVector = vec3(-1.0,0.0,0.0);\n\t\t\n\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n        float c = cos(rot);\n        float s = sin(rot);\n        mat2 rotation= mat2(c, -s, s, c);\n\t    corner=rotation*corner*cos(0.78539816339744830961566084581988);//TODO:临时缩小cos45,不确定U3D原因\n\t\tcorner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n        center +=u_SizeScale.xzy*(corner.x*sideVector+ corner.y*cameraUpVector);\n   #endif\n   \n   #ifdef VERTICALBILLBOARD\n\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n        const vec3 cameraUpVector =vec3(0.0,1.0,0.0);\n        vec3 sideVector = normalize(cross(u_CameraDirection,cameraUpVector));\n\t\t\n\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n        float c = cos(rot);\n        float s = sin(rot);\n        mat2 rotation= mat2(c, -s, s, c);\n\t    corner=rotation*corner*cos(0.78539816339744830961566084581988);//TODO:临时缩小cos45,不确定U3D原因\n\t\tcorner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n        center +=u_SizeScale.xzy*(corner.x*sideVector+ corner.y*cameraUpVector);\n   #endif\n   \n   #ifdef RENDERMODE_MESH\n\t    vec3 size=computeParticleSizeMesh(a_StartSize,normalizedAge);\n\t\t#if defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE)\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tvec3 rotation=vec3(a_StartRotation0.xy,computeParticleRotationFloat(a_StartRotation0.z, age,normalizedAge));\n\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByEuler(a_MeshPosition*size,rotation),worldRotation);\n\t\t\t}\n\t\t\telse{\n\t\t\t\t#ifdef ROTATIONOVERLIFETIME\n\t\t\t\t\tfloat angle=computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n\t\t\t\t\tif(a_ShapePositionStartLifeTime.x!=0.0||a_ShapePositionStartLifeTime.y!=0.0){\n\t\t\t\t\t\tcenter+= (rotationByQuaternions(rotationByAxis(u_SizeScale*a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),angle),worldRotation));//已验证\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t#ifdef SHAPE\n\t\t\t\t\t\t\tcenter+= u_SizeScale.xzy*(rotationByQuaternions(rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),angle),worldRotation));\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\t\tcenter+=rotationByAxis(u_SizeScale*a_MeshPosition*size,vec3(0.0,0.0,-1.0),angle);//已验证\n\t\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\t\tcenter+=rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,0.0,-1.0),angle),worldRotation);//已验证\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}\n\t\t\t\t#endif\n\t\t\t\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t\t\t\t//TODO:是否应合并if(u_ThreeDStartRotation)分支代码,待测试\n\t\t\t\t\tvec3 angle=computeParticleRotationVec3(vec3(0.0,0.0,-a_StartRotation0.x), age,normalizedAge);\n\t\t\t\t\tcenter+= (rotationByQuaternions(rotationByEuler(u_SizeScale*a_MeshPosition*size,vec3(angle.x,angle.y,angle.z)),worldRotation));//已验证\n\t\t\t\t#endif\t\t\n\t\t\t}\n\t\t#else\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByEuler(a_MeshPosition*size,a_StartRotation0),worldRotation);//已验证\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(a_ShapePositionStartLifeTime.x!=0.0||a_ShapePositionStartLifeTime.y!=0.0){\n\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\tcenter+= rotationByAxis(u_SizeScale*a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),a_StartRotation0.x);\n\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\tcenter+= (rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),a_StartRotation0.x),worldRotation));//已验证\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t#ifdef SHAPE\n\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\tcenter+= u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),a_StartRotation0.x);\n\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),a_StartRotation0.x),worldRotation);\t\n\t\t\t\t\t#else\n\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\tcenter+= rotationByAxis(u_SizeScale*a_MeshPosition*size,vec3(0.0,0.0,-1.0),a_StartRotation0.x);\n\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,0.0,-1.0),a_StartRotation0.x),worldRotation);//已验证\n\t\t\t\t\t#endif\n\t\t\t\t}\n\t\t\t}\n\t\t#endif\n\t\tv_MeshColor=a_MeshColor;\n   #endif\n   \n    gl_Position=u_Projection*u_View*vec4(center,1.0);\n    v_Color = computeParticleColor(a_StartColor, normalizedAge);\n\t#ifdef DIFFUSEMAP\n\t\t#if defined(SPHERHBILLBOARD)||defined(STRETCHEDBILLBOARD)||defined(HORIZONTALBILLBOARD)||defined(VERTICALBILLBOARD)\n\t\t\tv_TextureCoordinate =computeParticleUV(a_CornerTextureCoordinate.zw, normalizedAge);\n\t\t#endif\n\t\t#ifdef RENDERMODE_MESH\n\t\t\tv_TextureCoordinate =computeParticleUV(a_MeshTextureCoordinate, normalizedAge);\n\t\t#endif\n\t\t\n\t\t#ifdef TILINGOFFSET\n\t\t\tv_TextureCoordinate=vec2(v_TextureCoordinate.x,1.0-v_TextureCoordinate.y)*u_TilingOffset.xy+vec2(u_TilingOffset.z,-u_TilingOffset.w);//需要特殊处理\n\t\t\tv_TextureCoordinate=vec2(v_TextureCoordinate.x,1.0-v_TextureCoordinate.y);//需要特殊处理\n\t\t#endif\n\t#endif\n    v_Discard=0.0;\n\t  \n\t#ifdef FOG\n\t\tv_PositionWorld=center;\n\t#endif\n   }\n   else\n\t{\n\t\tv_Discard=1.0;\n\t}\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n\n', e = "#ifdef HIGHPRECISION\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nvarying float v_Discard;\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\nuniform sampler2D u_texture;\nuniform vec4 u_Tintcolor;\n\n#ifdef RENDERMODE_MESH\n\tvarying vec4 v_MeshColor;\n#endif\n\n#ifdef FOG\n\tvarying vec3 v_PositionWorld;\n\tuniform vec3 u_CameraPosition;\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\nvoid main()\n{\t\n\t#ifdef RENDERMODE_MESH\n\t\tgl_FragColor=v_MeshColor;\n\t#else\n\t\tgl_FragColor=vec4(1.0);\t\n\t#endif\n\t\t\n\t#ifdef DIFFUSEMAP\n\t\tif(v_Discard!=0.0)\n\t\t\tdiscard;\n\t\t#ifdef TINTCOLOR\n\t\t\tgl_FragColor*=texture2D(u_texture,v_TextureCoordinate)*u_Tintcolor*2.0*v_Color;\n\t\t#else\n\t\t\tgl_FragColor*=texture2D(u_texture,v_TextureCoordinate)*v_Color;\n\t\t#endif\n\t#else\n\t\t#ifdef TINTCOLOR\n\t\t\tgl_FragColor*=u_Tintcolor*2.0*v_Color;\n\t\t#else\n\t\t\tgl_FragColor*=v_Color;\n\t\t#endif\n\t#endif\n\t\n\t#ifdef FOG\n\t\tvec3 toEye=u_CameraPosition-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t\t\n\t\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t\t#endif\n\t#endif\n}", a = Pt.add("PARTICLESHURIKEN"), o = new oe(n, i, yi.shaderDefines, si.shaderDefines), a.addSubShader(o), o.addShaderPass(t, e, r), n = {a_Position: 0}, i = {
                    u_TintColor: 1,
                    u_Exposure: 1,
                    u_Rotation: 1,
                    u_CubeTexture: 1,
                    u_MvpMatrix: 3
                }, t = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\nuniform float u_Rotation;\nvarying vec3 v_Texcoord;\n\n\nvec4 rotateAroundYInDegrees (vec4 vertex, float degrees)\n{\n\tfloat angle = degrees * 3.141593 / 180.0;\n\tfloat sina=sin(angle);\n\tfloat cosa=cos(angle);\n\tmat2 m = mat2(cosa, -sina, sina, cosa);\n\treturn vec4(m*vertex.xz, vertex.yw).xzyw;\n}\n\t\t\nvoid main()\n{\n\tvec4 position=rotateAroundYInDegrees(a_Position,u_Rotation);\n\tgl_Position = (u_MvpMatrix*position).xyww;\n\tv_Texcoord=vec3(-a_Position.x,a_Position.yz);//转换坐标系\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n', e = "#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec3 v_Texcoord;\n\nuniform samplerCube u_CubeTexture;\nuniform float u_Exposure;\nuniform vec4 u_TintColor;\n\n\nvoid main()\n{\t\n\tvec3 color=textureCube(u_CubeTexture, v_Texcoord).rgb*u_TintColor.rgb*u_Exposure*2.0;\n\tgl_FragColor=vec4(color,1.0);\n}\n\n", a = Pt.add("SkyBox"), o = new oe(n, i), a.addSubShader(o), o.addShaderPass(t, e), n = {a_Position: 0}, i = {
                    u_SunSize: 1,
                    u_SunSizeConvergence: 1,
                    u_AtmosphereThickness: 1,
                    u_SkyTint: 1,
                    u_GroundTint: 1,
                    u_Exposure: 1,
                    u_MvpMatrix: 3,
                    "u_DirectionLight.Direction": 4,
                    "u_DirectionLight.Color": 4
                }, t = "#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Lighting.glsl\";\n\n#define OUTER_RADIUS 1.025\n#define RAYLEIGH (mix(0.0, 0.0025, pow(u_AtmosphereThickness,2.5)))// Rayleigh constant Rayleigh为夜空光和极光亮度单位\n#define MIE 0.0010             // Mie constant 米氏散射\n#define SUN_BRIGHTNESS 20.0    // Sun brightness\n#define MAX_SCATTER 50.0 // Maximum scattering value, to prevent math overflows on Adrenos\n\nconst float SKY_GROUND_THRESHOLD = 0.02;\nconst float outerRadius = OUTER_RADIUS;\nconst float outerRadius2 = OUTER_RADIUS*OUTER_RADIUS;\nconst float innerRadius = 1.0;\nconst float innerRadius2 = 1.0;\nconst float cameraHeight = 0.0001;\n\nconst float HDSundiskIntensityFactor = 15.0;\nconst float simpleSundiskIntensityFactor = 27.0;\n\nconst float sunScale = 400.0 * SUN_BRIGHTNESS;\nconst float kmESun = MIE * SUN_BRIGHTNESS;\nconst float km4PI = MIE * 4.0 * 3.14159265;\nconst float scale = 1.0 / (OUTER_RADIUS - 1.0);\nconst float scaleDepth = 0.25;\nconst float scaleOverScaleDepth = (1.0 / (OUTER_RADIUS - 1.0)) / 0.25;\nconst float samples = 2.0; // THIS IS UNROLLED MANUALLY, DON'T TOUCH\n\n// RGB wavelengths        .35 (.62=158), .43 (.68=174), .525 (.75=190)\nconst vec3 c_DefaultScatteringWavelength = vec3(0.65, 0.57, 0.475);//默认散射波长\nconst vec3 c_VariableRangeForScatteringWavelength = vec3(0.15, 0.15, 0.15);//散射播放的可变范围\n\nattribute vec4 a_Position;\n\nuniform mat4 u_MvpMatrix;\nuniform vec3 u_SkyTint;\nuniform vec3 u_GroundTint;\nuniform float u_Exposure;\nuniform float u_AtmosphereThickness;\nuniform DirectionLight u_DirectionLight;\n\nvarying vec3 v_GroundColor;\nvarying vec3 v_SkyColor;\n\n#ifdef SUN_HIGH_QUALITY\n\tvarying vec3 v_Vertex;\n#elif defined(SUN_SIMPLE)\n\tvarying vec3 v_RayDir;\n#else\n\tvarying float v_SkyGroundFactor;\n#endif\n\n#if defined(SUN_HIGH_QUALITY)||defined(SUN_SIMPLE)\n\tvarying vec3 v_SunColor;\n#endif\n\n// Calculates the Rayleigh phase function\nfloat getRayleighPhase(vec3 light, vec3 ray) \n{\n\tfloat eyeCos = dot(light, ray);\n\treturn 0.75 + 0.75*eyeCos*eyeCos;\n}\n\nfloat scaleAngle(float inCos)\n{\n\tfloat x = 1.0 - inCos;\n\treturn 0.25 * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\n\n\nvoid main () {\n\tgl_Position = (u_MvpMatrix*a_Position).xyww;\n\n\tvec3 skyTintInGammaSpace = u_SkyTint;//支持非GAMMA空间后要调整\n\tvec3 scatteringWavelength = mix(c_DefaultScatteringWavelength-c_VariableRangeForScatteringWavelength,c_DefaultScatteringWavelength+c_VariableRangeForScatteringWavelength,vec3(1.0) - skyTintInGammaSpace); // using Tint in sRGB+ gamma allows for more visually linear interpolation and to keep (0.5) at (128, gray in sRGB) point\n\tvec3 invWavelength = 1.0 / pow(scatteringWavelength, vec3(4.0));\n\n\tfloat krESun = RAYLEIGH * SUN_BRIGHTNESS;\n\tfloat kr4PI = RAYLEIGH * 4.0 * 3.14159265;\n\n\tvec3 cameraPos = vec3(0.0,innerRadius + cameraHeight,0.0); // The camera's current position\n\n\t// Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n\tvec3 eyeRay = normalize(a_Position.xyz);\n\n\tfloat far = 0.0;\n\tvec3 cIn, cOut;\n\tif (eyeRay.y >= 0.0) {// Sky\n\t\t// Calculate the length of the \"atmosphere\"\n\t\tfar = sqrt(outerRadius2 + innerRadius2 * eyeRay.y * eyeRay.y - innerRadius2) - innerRadius * eyeRay.y;\n\n\t\t// Calculate the ray's starting position, then calculate its scattering offset\n\t\tfloat height = innerRadius + cameraHeight;\n\t\tfloat depth = exp(scaleOverScaleDepth * -cameraHeight);\n\t\tfloat startAngle = dot(eyeRay, cameraPos) / height;\n\t\tfloat startOffset = depth*scaleAngle(startAngle);\n\n\t\t// Initialize the scattering loop variables\n\t\tfloat sampleLength = far / samples;\n\t\tfloat scaledLength = sampleLength * scale;\n\t\tvec3 sampleRay = eyeRay * sampleLength;\n\t\tvec3 samplePoint = cameraPos + sampleRay * 0.5;\n\n\t\tvec3 frontColor = vec3(0.0);\n\t\t//unrolling this manually to avoid some platform for loop slow\n\t\t{\n\t\t\tfloat height = length(samplePoint);\n\t\t\tfloat depth = exp(scaleOverScaleDepth * (innerRadius - height));\n\t\t\tfloat lightAngle = dot(-u_DirectionLight.Direction, samplePoint) / height;\n\t\t\tfloat cameraAngle = dot(eyeRay, samplePoint) / height;\n\t\t\tfloat scatter = (startOffset + depth*(scaleAngle(lightAngle) - scaleAngle(cameraAngle)));\n\t\t\tvec3 attenuate = exp(-clamp(scatter, 0.0, MAX_SCATTER) * (invWavelength * kr4PI + km4PI));\n\n\t\t\tfrontColor += attenuate * (depth * scaledLength);\n\t\t\tsamplePoint += sampleRay;\n\t\t}\n\t\t{\n\t\t\tfloat height = length(samplePoint);\n\t\t\tfloat depth = exp(scaleOverScaleDepth * (innerRadius - height));\n\t\t\tfloat lightAngle = dot(-u_DirectionLight.Direction, samplePoint) / height;\n\t\t\tfloat cameraAngle = dot(eyeRay, samplePoint) / height;\n\t\t\tfloat scatter = (startOffset + depth*(scaleAngle(lightAngle) - scaleAngle(cameraAngle)));\n\t\t\tvec3 attenuate = exp(-clamp(scatter, 0.0, MAX_SCATTER) * (invWavelength * kr4PI + km4PI));\n\n\t\t\tfrontColor += attenuate * (depth * scaledLength);\n\t\t\tsamplePoint += sampleRay;\n\t\t}\n\n\t\t// Finally, scale the Mie and Rayleigh colors and set up the varying variables for the pixel shader\n\t\tcIn = frontColor * (invWavelength * krESun);\n\t\tcOut = frontColor * kmESun;\n\t} else {// Ground\n\t\tfar = (-cameraHeight) / (min(-0.001, eyeRay.y));\n\t\tvec3 pos = cameraPos + far * eyeRay;\n\n\t\t// Calculate the ray's starting position, then calculate its scattering offset\n\t\tfloat depth = exp((-cameraHeight) * (1.0/scaleDepth));\n\t\tfloat cameraAngle = dot(-eyeRay, pos);\n\t\tfloat lightAngle = dot(-u_DirectionLight.Direction, pos);\n\t\tfloat cameraScale = scaleAngle(cameraAngle);\n\t\tfloat lightScale = scaleAngle(lightAngle);\n\t\tfloat cameraOffset = depth*cameraScale;\n\t\tfloat temp = lightScale + cameraScale;\n\n\t\t// Initialize the scattering loop variables\n\t\tfloat sampleLength = far / samples;\n\t\tfloat scaledLength = sampleLength * scale;\n\t\tvec3 sampleRay = eyeRay * sampleLength;\n\t\tvec3 samplePoint = cameraPos + sampleRay * 0.5;\n\n\t\t// Now loop through the sample rays\n\t\tvec3 frontColor = vec3(0.0, 0.0, 0.0);\n\t\tvec3 attenuate;\n\n\t\t// Loop removed because we kept hitting SM2.0 temp variable limits. Doesn't affect the image too much.\n\t\t{\n\t\t\tfloat height = length(samplePoint);\n\t\t\tfloat depth = exp(scaleOverScaleDepth * (innerRadius - height));\n\t\t\tfloat scatter = depth*temp - cameraOffset;\n\t\t\tattenuate = exp(-clamp(scatter, 0.0, MAX_SCATTER) * (invWavelength * kr4PI + km4PI));\n\t\t\tfrontColor += attenuate * (depth * scaledLength);\n\t\t\tsamplePoint += sampleRay;\n\t\t}\n\n\t\tcIn = frontColor * (invWavelength * krESun + kmESun);\n\t\tcOut = clamp(attenuate, 0.0, 1.0);\n\t}\n\n\t#ifdef SUN_HIGH_QUALITY\n\t\tv_Vertex = -a_Position.xyz;\n\t#elif defined(SUN_SIMPLE) \n\t\tv_RayDir = -eyeRay;\n\t#else\n\t\tv_SkyGroundFactor = -eyeRay.y / SKY_GROUND_THRESHOLD;\n\t#endif\n\n\t// if we want to calculate color in vprog:\n\t// in case of linear: multiply by _Exposure in here (even in case of lerp it will be common multiplier, so we can skip mul in fshader)\n\tv_GroundColor = u_Exposure * (cIn + u_GroundTint*u_GroundTint * cOut);//u_GroundColor*u_GroundColor is gamma space convert to linear space\n\tv_SkyColor    = u_Exposure * (cIn * getRayleighPhase(-u_DirectionLight.Direction, -eyeRay));\n\n\t\n\t// The sun should have a stable intensity in its course in the sky. Moreover it should match the highlight of a purely specular material.\n\t// This matching was done using the Unity3D standard shader BRDF1 on the 5/31/2017\n\t// Finally we want the sun to be always bright even in LDR thus the normalization of the lightColor for low intensity.\n\tfloat lightColorIntensity = clamp(length(u_DirectionLight.Color), 0.25, 1.0);\n\n\t#ifdef SUN_HIGH_QUALITY \n\t\tv_SunColor = HDSundiskIntensityFactor * clamp(cOut,0.0,1.0) * u_DirectionLight.Color / lightColorIntensity;\n\t#elif defined(SUN_SIMPLE) \n\t\tv_SunColor = simpleSundiskIntensityFactor * clamp(cOut * sunScale,0.0,1.0) * u_DirectionLight.Color / lightColorIntensity;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n", e = '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Lighting.glsl";\n\nconst float MIE_G = -0.990;\nconst float MIE_G2 = 0.9801;\nconst float SKY_GROUND_THRESHOLD = 0.02;\n\nuniform float u_SunSize;\nuniform float u_SunSizeConvergence;\nuniform DirectionLight u_DirectionLight;\n\n\nvarying vec3 v_GroundColor;\nvarying vec3 v_SkyColor;\n\n\n#ifdef SUN_HIGH_QUALITY\n\tvarying vec3 v_Vertex;\n#elif defined(SUN_SIMPLE)\n\tvarying vec3 v_RayDir;\n#else\n\tvarying float v_SkyGroundFactor;\n#endif\n\n#if defined(SUN_HIGH_QUALITY)||defined(SUN_SIMPLE)\n\tvarying vec3 v_SunColor;\n#endif\n\n// Calculates the Mie phase function\nfloat getMiePhase(float eyeCos, float eyeCos2) {\n\tfloat temp = 1.0 + MIE_G2 - 2.0 * MIE_G * eyeCos;\n\ttemp = pow(temp, pow(u_SunSize,0.65) * 10.0);\n\ttemp = max(temp,1.0e-4); // prevent division by zero, esp. in half precision\n\ttemp = 1.5 * ((1.0 - MIE_G2) / (2.0 + MIE_G2)) * (1.0 + eyeCos2) / temp;\n\treturn temp;\n}\n\n// Calculates the sun shape\nfloat calcSunAttenuation(vec3 lightPos, vec3 ray) {\n\t#ifdef SUN_HIGH_QUALITY\n\t\tfloat focusedEyeCos = pow(clamp(dot(lightPos, ray),0.0,1.0), u_SunSizeConvergence);\n\t\treturn getMiePhase(-focusedEyeCos, focusedEyeCos * focusedEyeCos);\n\t#else //SUN_SIMPLE\n\t\tvec3 delta = lightPos - ray;\n\t\tfloat dist = length(delta);\n\t\tfloat spot = 1.0 - smoothstep(0.0, u_SunSize, dist);\n\t\treturn spot * spot;\n\t#endif\n}\n\nvoid main() {\n\t// if y > 1 [eyeRay.y < -SKY_GROUND_THRESHOLD] - ground\n\t// if y >= 0 and < 1 [eyeRay.y <= 0 and > -SKY_GROUND_THRESHOLD] - horizon\n\t// if y < 0 [eyeRay.y > 0] - sky\n\tvec3 col = vec3(0.0, 0.0, 0.0);\n\n\t#ifdef SUN_HIGH_QUALITY\n\t\tvec3 ray = normalize(v_Vertex);\n\t\tfloat y = ray.y / SKY_GROUND_THRESHOLD;\n\t#elif defined(SUN_SIMPLE) \n\t\tvec3 ray = v_RayDir;\n\t\tfloat y = ray.y / SKY_GROUND_THRESHOLD;\t\n\t#else\n\t\tfloat y = v_SkyGroundFactor;\n\t#endif\n\n\t// if we did precalculate color in vprog: just do lerp between them\n\tcol = mix(v_SkyColor, v_GroundColor, clamp(y,0.0,1.0));\n\n\t#if defined(SUN_HIGH_QUALITY)||defined(SUN_SIMPLE)\n\t\tif (y < 0.0)\n\t\t\tcol += v_SunColor * calcSunAttenuation(-u_DirectionLight.Direction, -ray);\n\t#endif\n\n\tcol = sqrt(col);//linear space convert to gamma space\n\tgl_FragColor=vec4(col,1.0);\n}\n\n', a = Pt.add("SkyBoxProcedural"), o = new oe(n, i, null, ii.shaderDefines), a.addSubShader(o), o.addShaderPass(t, e), n = {
                    a_Position: 0,
                    a_Normal: 3,
                    a_Texcoord0: 2
                }, i = {
                    u_MvpMatrix: 2,
                    u_WorldMat: 2,
                    u_CameraPos: 3,
                    u_LightmapScaleOffset: 2,
                    u_LightMap: 2,
                    u_SplatAlphaTexture: 1,
                    u_DiffuseTexture1: 1,
                    u_DiffuseTexture2: 1,
                    u_DiffuseTexture3: 1,
                    u_DiffuseTexture4: 1,
                    u_DiffuseTexture5: 1,
                    u_DiffuseScaleOffset1: 1,
                    u_DiffuseScaleOffset2: 1,
                    u_DiffuseScaleOffset3: 1,
                    u_DiffuseScaleOffset4: 1,
                    u_DiffuseScaleOffset5: 1,
                    u_FogStart: 4,
                    u_FogRange: 4,
                    u_FogColor: 4,
                    "u_DirectionLight.Direction": 4,
                    "u_DirectionLight.Color": 4,
                    "u_PointLight.Position": 4,
                    "u_PointLight.Range": 4,
                    "u_PointLight.Attenuation": 4,
                    "u_PointLight.Color": 4,
                    "u_SpotLight.Position": 4,
                    "u_SpotLight.Direction": 4,
                    "u_SpotLight.Range": 4,
                    "u_SpotLight.Spot": 4,
                    "u_SpotLight.Color": 4,
                    u_AmbientColor: 4,
                    u_shadowMap1: 4,
                    u_shadowMap2: 4,
                    u_shadowMap3: 4,
                    u_shadowPSSMDistance: 4,
                    u_lightShadowVP: 4,
                    u_shadowPCFoffset: 4
                }, r = {
                    s_Cull: 0,
                    s_Blend: 1,
                    s_BlendSrc: 2,
                    s_BlendDst: 3,
                    s_DepthTest: 12,
                    s_DepthWrite: 13
                }, t = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nattribute vec2 a_Texcoord0;\n\nuniform mat4 u_MvpMatrix;\n\nvarying vec2 v_Texcoord0;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(LIGHTMAP)\n\tattribute vec3 a_Normal;\n\tvarying vec3 v_Normal;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||(defined(RECEIVESHADOW)&&defined(SHADOWMAP_PSSM1))\n\tuniform mat4 u_WorldMat;\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef LIGHTMAP\n\tvarying vec2 v_LightMapUV;\n\tuniform vec4 u_LightmapScaleOffset;\n#endif\n\n#ifdef RECEIVESHADOW\n\tvarying float v_posViewZ;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n#endif\n\nvoid main()\n{\n\tgl_Position = u_MvpMatrix * a_Position;\n  \n\tv_Texcoord0 = a_Texcoord0;\n  \n\t#ifdef LIGHTMAP\n\t\tv_LightMapUV = vec2(a_Texcoord0.x, 1.0 - a_Texcoord0.y) * u_LightmapScaleOffset.xy + u_LightmapScaleOffset.zw;\n\t\tv_LightMapUV.y = 1.0 - v_LightMapUV.y;\n\t#endif\n  \n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tv_Normal = a_Normal;\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||(defined(RECEIVESHADOW)&&defined(SHADOWMAP_PSSM1))\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n\n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}', e = '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Lighting.glsl";\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)\n\tuniform vec3 u_CameraPos;\n\tvarying vec3 v_Normal;\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\nuniform vec3 u_AmbientColor;\n\nuniform sampler2D u_SplatAlphaTexture;\n\nuniform sampler2D u_DiffuseTexture1;\nuniform sampler2D u_DiffuseTexture2;\nuniform sampler2D u_DiffuseTexture3;\nuniform sampler2D u_DiffuseTexture4;\nuniform sampler2D u_DiffuseTexture5;\n\nuniform vec4 u_DiffuseScaleOffset1;\nuniform vec4 u_DiffuseScaleOffset2;\nuniform vec4 u_DiffuseScaleOffset3;\nuniform vec4 u_DiffuseScaleOffset4;\nuniform vec4 u_DiffuseScaleOffset5;\n\nvarying vec2 v_Texcoord0;\n\n#ifdef LIGHTMAP\n\tuniform sampler2D u_LightMap;\n\tvarying vec2 v_LightMapUV;\n#endif\n\nvoid main()\n{\n\tvec4 splatAlpha = vec4(1.0);\n\t#ifdef ExtendTerrain_DETAIL_NUM1\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r;\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM2\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r + color2.xyz * (1.0 - splatAlpha.r);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM3\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * (1.0 - splatAlpha.r - splatAlpha.g);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM4\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tvec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord0 * u_DiffuseScaleOffset4.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * splatAlpha.b + color4.xyz * (1.0 - splatAlpha.r - splatAlpha.g - splatAlpha.b);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM5\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tvec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord0 * u_DiffuseScaleOffset4.xy);\n\t\tvec4 color5 = texture2D(u_DiffuseTexture5, v_Texcoord0 * u_DiffuseScaleOffset5.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * splatAlpha.b + color4.xyz * splatAlpha.a + color5.xyz * (1.0 - splatAlpha.r - splatAlpha.g - splatAlpha.b - splatAlpha.a);\n\t#endif\n\t\tgl_FragColor.w = splatAlpha.a;\n\t\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n    vec3 normal = v_Normal;\n\tvec3 dif, spe;\n#endif\n\nvec3 diffuse = vec3(0.0);\nvec3 specular= vec3(0.0);\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tLayaAirBlinnPhongDiectionLight(vec3(0.0), 1.0, normal, vec3(1.0), toEye,u_DirectionLight, dif, spe);\n\tdiffuse+=dif;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tLayaAirBlinnPhongPointLight(v_PositionWorld, vec3(0.0), 1.0, normal, vec3(1.0), toEye, u_PointLight, dif, spe);\n\tdiffuse+=dif;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tLayaAirBlinnPhongSpotLight(v_PositionWorld, vec3(0.0), 1.0, normal, vec3(1.0), toEye, u_SpotLight, dif, spe);\n\tdiffuse+=dif;\n\tspecular+=spe;\n#endif\n\nvec3 globalDiffuse = u_AmbientColor;\n#ifdef LIGHTMAP\n\tglobalDiffuse += DecodeLightmap(texture2D(u_LightMap, v_LightMapUV));\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n\tgl_FragColor = vec4(gl_FragColor.rgb * (globalDiffuse + diffuse) * shadowValue, gl_FragColor.a);\n#else\n\tgl_FragColor = vec4(gl_FragColor.rgb * (globalDiffuse + diffuse), gl_FragColor.a);\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor.rgb += specular * shadowValue;\n\t#else\n\t\tgl_FragColor.rgb += specular;\n\t#endif\n#endif\n\n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\n\n\n\n\n', a = Pt.add("ExtendTerrain"), o = new oe(n, i, Jn.shaderDefines, ui.shaderDefines), a.addSubShader(o), o.addShaderPass(t, e, r), n = {
                    a_Position: 0,
                    a_OffsetVector: 1,
                    a_Texcoord0X: 4,
                    a_Texcoord0Y: 3,
                    a_BirthTime: 2
                }, i = {
                    u_MvpMatrix: 2,
                    u_View: 3,
                    u_Projection: 3,
                    u_TilingOffset: 1,
                    u_MainTexture: 1,
                    u_MainColor: 1,
                    u_CurTime: 2,
                    u_LifeTime: 2,
                    u_WidthCurve: 2,
                    u_WidthCurveKeyLength: 2,
                    u_GradientColorkey: 2,
                    u_GradientAlphakey: 2
                }, r = {
                    s_Cull: 0,
                    s_Blend: 1,
                    s_BlendSrc: 2,
                    s_BlendDst: 3,
                    s_DepthTest: 12,
                    s_DepthWrite: 13
                }, t = '#include "Lighting.glsl";\n\nattribute vec3 a_Position;\nattribute vec3 a_OffsetVector;\nattribute vec4 a_Color;\nattribute float a_Texcoord0X;\nattribute float a_Texcoord0Y;\nattribute float a_BirthTime;\n\nuniform mat4 u_View;\nuniform mat4 u_Projection;\n\nuniform vec4 u_TilingOffset;\n\nuniform float u_CurTime;\nuniform float u_LifeTime;\nuniform vec4 u_WidthCurve[10];\nuniform int u_WidthCurveKeyLength;\n\nuniform vec4 u_GradientColorkey[10];\nuniform vec2 u_GradientAlphakey[10];\n\nvarying vec2 v_Texcoord0;\nvarying vec4 v_Color;\n\nfloat hermiteInterpolate(float t, float outTangent, float inTangent, float duration, float value1, float value2)\n{\n\tfloat t2 = t * t;\n\tfloat t3 = t2 * t;\n\tfloat a = 2.0 * t3 - 3.0 * t2 + 1.0;\n\tfloat b = t3 - 2.0 * t2 + t;\n\tfloat c = t3 - t2;\n\tfloat d = -2.0 * t3 + 3.0 * t2;\n\treturn a * value1 + b * outTangent * duration + c * inTangent * duration + d * value2;\n}\n\nfloat getCurWidth(in float normalizeTime)\n{\n\tfloat width;\n\tif(normalizeTime == 0.0){\n\t\twidth=u_WidthCurve[0].w;\n\t}\n\telse if(normalizeTime >= 1.0){\n\t\twidth=u_WidthCurve[u_WidthCurveKeyLength - 1].w;\n\t}\n\telse{\n\t\tfor(int i = 0; i < 10; i ++ )\n\t\t{\n\t\t\tif(normalizeTime == u_WidthCurve[i].x){\n\t\t\t\twidth=u_WidthCurve[i].w;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tvec4 lastFrame = u_WidthCurve[i];\n\t\t\tvec4 nextFrame = u_WidthCurve[i + 1];\n\t\t\tif(normalizeTime > lastFrame.x && normalizeTime < nextFrame.x)\n\t\t\t{\n\t\t\t\tfloat duration = nextFrame.x - lastFrame.x;\n\t\t\t\tfloat t = (normalizeTime - lastFrame.x) / duration;\n\t\t\t\tfloat outTangent = lastFrame.z;\n\t\t\t\tfloat inTangent = nextFrame.y;\n\t\t\t\tfloat value1 = lastFrame.w;\n\t\t\t\tfloat value2 = nextFrame.w;\n\t\t\t\twidth=hermiteInterpolate(t, outTangent, inTangent, duration, value1, value2);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn width;\n}\t\n\nvec4 getColorFromGradientByBlend(in vec4 gradientColors[10], in vec2 gradientAlphas[10], in float normalizeTime)\n{\n\tvec4 color;\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec4 gradientColor = gradientColors[i];\n\t\tfloat colorKey = gradientColor.x;\n\t\tif(colorKey >= normalizeTime)\n\t\t{\n\t\t\tvec4 lastGradientColor = gradientColors[i-1];\n\t\t\tfloat lastColorKey = lastGradientColor.x;\n\t\t\tfloat age = (normalizeTime - lastColorKey) / (colorKey - lastColorKey);\n\t\t\tcolor.rgb = mix(gradientColors[i-1].yzw, gradientColor.yzw, age);\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec2 gradientAlpha = gradientAlphas[i];\n\t\tfloat alphaKey = gradientAlpha.x;\n\t\tif(alphaKey >= normalizeTime)\n\t\t{\n\t\t\tvec2 lastGradientAlpha = gradientAlphas[i-1];\n\t\t\tfloat lastAlphaKey = lastGradientAlpha.x;\n\t\t\tfloat age = (normalizeTime - lastAlphaKey) / (alphaKey - lastAlphaKey);\n\t\t\tcolor.a = mix(lastGradientAlpha.y, gradientAlpha.y, age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn color;\n}\n\nvec4 getColorFromGradientByFixed(in vec4 gradientColors[10], in vec2 gradientAlphas[10], in float normalizeTime)\n{\n\tvec4 color;\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec4 gradientColor = gradientColors[i];\n\t\tif(gradientColor.w >= normalizeTime)\n\t\t{\n\t\t\tcolor.rgb = gradientColor.xyz;\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec2 gradientAlpha = gradientAlphas[i];\n\t\tif(gradientAlpha.y >= normalizeTime)\n\t\t{\n\t\t\tcolor.a = gradientAlpha.x;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn color;\n}\n\nvoid main()\n{\n\tfloat normalizeTime = (u_CurTime - a_BirthTime) / u_LifeTime;\n\t\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0 = vec2(a_Texcoord0X, 1.0 - a_Texcoord0Y) * u_TilingOffset.xy + u_TilingOffset.zw;\n\t#else\n\t\tv_Texcoord0 = vec2(a_Texcoord0X, a_Texcoord0Y);\n\t#endif\n\t\n\t#ifdef GRADIENTMODE_BLEND\n\t\tv_Color = getColorFromGradientByBlend(u_GradientColorkey, u_GradientAlphakey, normalizeTime);\n\t#else\n\t\tv_Color = getColorFromGradientByFixed(u_GradientColorkey, u_GradientAlphakey, normalizeTime);\n\t#endif\n\t\n\tgl_Position = u_Projection * u_View * vec4(a_Position + a_OffsetVector * getCurWidth(normalizeTime),1.0);\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n', e = "#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nuniform sampler2D u_MainTexture;\nuniform vec4 u_MainColor;\n\nvarying vec2 v_Texcoord0;\nvarying vec4 v_Color;\n\nvoid main()\n{\t\n\tvec4 color = 2.0 * u_MainColor * v_Color;\n\t#ifdef MAINTEXTURE\n\t\tvec4 mainTextureColor = texture2D(u_MainTexture, v_Texcoord0);\n\t\tcolor *= mainTextureColor;\n\t#endif\n\tgl_FragColor = color;\n}\n\n", a = Pt.add("Trail"), o = new oe(n, i, Si.shaderDefines, ni.shaderDefines), a.addSubShader(o), o.addShaderPass(t, e, r), n = {
                    a_Position: 0,
                    a_Normal: 3,
                    a_Tangent0: 4
                }, i = {
                    u_MvpMatrix: 2,
                    u_WorldMat: 2,
                    u_CameraPos: 3,
                    u_Time: 4,
                    u_MainTexture: 1,
                    u_NormalTexture: 1,
                    u_HorizonColor: 1,
                    u_WaveScale: 1,
                    u_WaveSpeed: 1
                }, t = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nattribute vec3 a_Normal;\nattribute vec4 a_Tangent0;\n\nuniform mat4 u_MvpMatrix;\nuniform mat4 u_WorldMat;\nuniform vec3 u_CameraPos;\nuniform float u_WaveScale;\nuniform vec4 u_WaveSpeed;\nuniform float u_Time;\n\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec2 v_Texcoord0;\nvarying vec2 v_Texcoord1;\n\nvoid main()\n{\n\tvec4 positionWorld = u_WorldMat * a_Position;\n\tvec4 position = u_MvpMatrix * a_Position;\n\t\n\tvec4 temp = vec4(positionWorld.x, positionWorld.z, positionWorld.x, positionWorld.z) * u_WaveScale + u_WaveSpeed * u_WaveScale * u_Time;\n\t\n\tv_Texcoord0 = temp.xy * vec2(0.4, 0.45);\n\tv_Texcoord1 = temp.wz;\n\t\n\tmat3 worldMat = mat3(u_WorldMat);\n\tv_Normal = worldMat * a_Normal;\n\tv_Tangent = worldMat * a_Tangent0.xyz;\n\tv_Binormal = cross(v_Normal, v_Tangent) * a_Tangent0.w;\n\t\n\tv_ViewDir = u_CameraPos - positionWorld.xyz;\n\tgl_Position = position;\n\tgl_Position=remapGLPositionZ(gl_Position);\n}', e = '#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#ifdef MAINTEXTURE\n\tuniform sampler2D u_MainTexture;\n#endif\n\n#ifdef NORMALTEXTURE\n\tuniform sampler2D u_NormalTexture;\n#endif\n\nuniform vec4 u_HorizonColor;\n\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec2 v_Texcoord0;\nvarying vec2 v_Texcoord1;\n\n#include "Lighting.glsl"\n\nvoid main()\n{\n\tvec4 bumpColor1 = texture2D(u_NormalTexture, v_Texcoord0);\n\tvec4 bumpColor2 = texture2D(u_NormalTexture, v_Texcoord1);\n\t\n\tvec3 normal1 = NormalSampleToWorldSpace1(bumpColor1, v_Tangent, v_Binormal, v_Normal);\n\tvec3 normal2 = NormalSampleToWorldSpace1(bumpColor2, v_Tangent, v_Binormal, v_Normal);\n\t\n\tvec3 normal = normalize((normal1 + normal2) * 0.5);\n\tvec3 viewDir = normalize(v_ViewDir);\n\tfloat fresnel = dot(viewDir, normal);\n\t\n\tvec4 waterColor = texture2D(u_MainTexture, vec2(fresnel, fresnel));\n\t\n\tvec4 color;\n\tcolor.rgb = mix(waterColor.rgb, u_HorizonColor.rgb, vec3(waterColor.a));\n\tcolor.a = u_HorizonColor.a;\n\t\n\tgl_FragColor = color;\n}\n\n', a = Pt.add("WaterPrimary"), o = new oe(n, i, null, hi.shaderDefines), a.addSubShader(o), o.addShaderPass(t, e), n = {a_PositionTexcoord: 0}, i = {u_ScreenTexture: 1}, t = '#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}',e = "#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nuniform sampler2D u_ScreenTexture;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_FragColor = texture2D(u_ScreenTexture, v_Texcoord0);\n}\n\n",a = Pt.add("ScreenQuad"),o = new oe(n, i, null, null),a.addSubShader(o);
                var s = o.addShaderPass(t, e), l = s.renderState;
                l.depthTest = 519, l.depthWrite = !1, l.cull = 0, n = {a_PositionTexcoord: l.blend = 0}, i = {
                    u_MainTex: 1,
                    u_BloomTex: 1,
                    u_AutoExposureTex: 1,
                    u_MainTex_TexelSize: 1,
                    u_SampleScale: 1,
                    u_Threshold: 1,
                    u_Params: 1
                }, a = Pt.add("PostProcessBloom", n, i), o = new oe(null, null, null, null), a.addSubShader(o), (l = (s = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_AutoExposureTex;\nuniform vec4 u_MainTex_TexelSize;\nuniform vec4 u_Threshold; // x: threshold value (linear), y: threshold - knee, z: knee * 2, w: 0.25 / knee\nuniform vec4 u_Params; // x: clamp, yzw: unused\n\nmediump vec4 prefilter(mediump vec4 color, vec2 uv) {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, uv).r;\n\tcolor *= autoExposure;\n\tcolor = min(vec4(u_Params.x), color); // clamp to max\n\tcolor = quadraticThreshold(color, u_Threshold.x, u_Threshold.yzw);\n\treturn color;\n}\n\nvoid fragPrefilter13() {\n\tmediump vec4 color = downsampleBox13Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = prefilter(safeHDR(color), v_Texcoord0);\n}\n\nvoid main() {\n\tfragPrefilter13();\n}')).renderState).depthTest = 519, l.depthWrite = !1, l.cull = 0, l.blend = 0, o = new oe(null, null, null, null), a.addSubShader(o), (l = (s = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_AutoExposureTex;\nuniform vec4 u_MainTex_TexelSize;\nuniform vec4 u_Threshold; // x: threshold value (linear), y: threshold - knee, z: knee * 2, w: 0.25 / knee\nuniform vec4 u_Params; // x: clamp, yzw: unused\n\nmediump vec4 prefilter(mediump vec4 color, vec2 uv) {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, uv).r;\n\tcolor *= autoExposure;\n\tcolor = min(vec4(u_Params.x), color); // clamp to max\n\tcolor = quadraticThreshold(color, u_Threshold.x, u_Threshold.yzw);\n\treturn color;\n}\n\nvoid fragPrefilter4() {\n\tmediump vec4 color = downsampleBox4Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = prefilter(safeHDR(color), v_Texcoord0);\n}\n\nvoid main() {\n\tfragPrefilter4();\n}')).renderState).depthTest = 519, l.depthWrite = !1, l.cull = 0, l.blend = 0, o = new oe(null, null, null, null), a.addSubShader(o), (l = (s = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform vec4 u_MainTex_TexelSize;\n\nvoid fragDownsample13() {\n\tmediump vec4 color = downsampleBox13Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = color;\n}\n\nvoid main() {\n\tfragDownsample13();\n}')).renderState).depthTest = 519, l.depthWrite = !1, l.cull = 0, l.blend = 0, o = new oe(null, null, null, null), a.addSubShader(o), (l = (s = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_BloomTex;\n\nuniform vec4 u_MainTex_TexelSize;\nuniform float u_SampleScale;\n\nmediump vec4 combine(mediump vec4 bloom, vec2 uv) {\n\tmediump vec4 color = texture2D(u_BloomTex, uv);\n\treturn bloom + color;\n}\n\nvoid fragUpsampleTent() {\n\tmediump vec4 bloom = UpsampleTent(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy, u_SampleScale);\n\tgl_FragColor = combine(bloom, v_Texcoord0);\n}\n\nvoid main() {\n\tfragUpsampleTent();\n}')).renderState).depthTest = 519, l.depthWrite = !1, l.cull = 0, l.blend = 0, o = new oe(null, null, null, null), a.addSubShader(o), (l = (s = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_BloomTex;\n\nuniform vec4 u_MainTex_TexelSize;\nuniform float u_SampleScale;\n\nmediump vec4 combine(mediump vec4 bloom, vec2 uv) {\n\tmediump vec4 color = texture2D(u_BloomTex, uv);\n\treturn bloom + color;\n}\n\nvoid fragUpsampleBox() {\n\tmediump vec4 bloom = upsampleBox(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy, vec4(u_SampleScale));\n\tgl_FragColor = combine(bloom, v_Texcoord0);\n}\n\nvoid main() {\n\tfragUpsampleBox();\n}')).renderState).depthTest = 519, l.depthWrite = !1, l.cull = 0, l.blend = 0, o = new oe(null, null, null, null), a.addSubShader(o), (l = (s = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_AutoExposureTex;\nuniform vec4 u_MainTex_TexelSize;\nuniform vec4 u_Threshold; // x: threshold value (linear), y: threshold - knee, z: knee * 2, w: 0.25 / knee\nuniform vec4 u_Params; // x: clamp, yzw: unused\n\nmediump vec4 prefilter(mediump vec4 color, vec2 uv) {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, uv).r;\n\tcolor *= autoExposure;\n\tcolor = min(vec4(u_Params.x), color); // clamp to max\n\tcolor = quadraticThreshold(color, u_Threshold.x, u_Threshold.yzw);\n\treturn color;\n}\n\nvoid fragPrefilter13() {\n\tmediump vec4 color = downsampleBox13Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = prefilter(safeHDR(color), v_Texcoord0);\n}\n\nvoid main() {\n\tfragPrefilter13();\n}')).renderState).depthTest = 519, l.depthWrite = !1, l.cull = 0, n = {a_PositionTexcoord: l.blend = 0}, i = {
                    u_MainTex: 1,
                    u_BloomTex: 1,
                    u_AutoExposureTex: 1,
                    u_Bloom_DirtTex: 1,
                    u_BloomTex_TexelSize: 1,
                    u_Bloom_Settings: 1,
                    u_Bloom_Color: 1
                }, a = Pt.add("PostProcessComposite", n, i), o = new oe(null, null, null, Re.shaderDefines), a.addSubShader(o), (l = (s = o.addShaderPass("attribute vec4 a_Position;\nvarying vec2 v_Texcoord0;\n\nvec2 TransformTriangleVertexToUV(vec2 vertex)\n{\n    vec2 uv = (vertex + 1.0) * 0.5;\n    return uv;\n}\n\nvoid main() {\n\tgl_Position =vec4(a_Position.xy, 0.0, 1.0);\n\tv_Texcoord0=TransformTriangleVertexToUV(a_Position.xy);\n\tgl_Position=remapGLPositionZ(gl_Position);\n}", '#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_BloomTex;\n\nuniform sampler2D u_AutoExposureTex;\nuniform sampler2D u_Bloom_DirtTex;\nuniform vec4 u_BloomTex_TexelSize;\nuniform vec4 u_Bloom_DirtTileOffset; // xy: tiling, zw: offset\nuniform mediump vec3 u_Bloom_Settings;// x: sampleScale, y: intensity, z: dirt intensity\nuniform mediump vec3 u_Bloom_Color;\n\nvoid main() {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, v_Texcoord0).r;\n\tmediump vec4 color=vec4(0.0)\n\tcolor = texture2D(u_MainTex, v_Texcoord0);\n\t\n\tcolor = SRGBToLinear(color);\n\tcolor.rgb *= autoExposure;\n\t\n\t#if BLOOM || BLOOM_LOW\n\t{\n\t\t#if BLOOM\n\t\t\tmediump vec4 bloom = UpsampleTent(_BloomTex, uvDistorted, _BloomTex_TexelSize.xy, _Bloom_Settings.x);\n\t\t#else\n\t\t\tmediump vec4 bloom = UpsampleBox(_BloomTex, uvDistorted, _BloomTex_TexelSize.xy, _Bloom_Settings.x);\n\t\t#endif\n\n\t\t// UVs should be Distort(uv * _Bloom_DirtTileOffset.xy + _Bloom_DirtTileOffset.zw)\n\t\t// but considering we use a cover-style scale on the dirt texture the difference\n\t\t// isn\'t massive so we chose to save a few ALUs here instead in case lens distortion\n\t\t// is active\n\t\tmediump vec4 dirt = mediump vec4(SAMPLE_TEXTURE2D(_Bloom_DirtTex, sampler_Bloom_DirtTex, uvDistorted * _Bloom_DirtTileOffset.xy + _Bloom_DirtTileOffset.zw).rgb, 0.0);\n\n\t\t// Additive bloom (artist friendly)\n\t\tbloom *= _Bloom_Settings.y;\n\t\tdirt *= _Bloom_Settings.z;\n\t\tcolor += bloom * half4(_Bloom_Color, 1.0);\n\t\tcolor += dirt * bloom;\n\t}\n\t#endif\n\t\n\thalf4 output = color;\n\toutput = LinearToSRGB(output);\n\t//output.rgb = Dither(output.rgb, v_Texcoord0);//TODO:\n}')).renderState).depthTest = 519, l.depthWrite = !1, l.cull = 0, l.blend = 0
            }, h._rangeAttenTex = null, h
        }(), kt = function () {
            function N() {
            }

            return d(N, "laya.d3.utils.Utils3D"), N._convertToLayaVec3 = function (t, e, n) {
                e.x = n ? -t.x() : t.x(), e.y = t.y(), e.z = t.z()
            }, N._convertToBulletVec3 = function (t, e, n) {
                e.setValue(n ? -t.x : t.x, t.y, t.z)
            }, N._rotationTransformScaleSkinAnimation = function (t, e, n, i, r, a, o, s, l, h, u, c) {
                var _, d, f, m, p, T = N._tempArray16_0, E = N._tempArray16_1, v = N._tempArray16_2, g = i + i,
                    S = r + r, y = a + a, x = i * g, D = r * g, I = r * S, R = a * g, M = a * S, A = a * y, C = o * g,
                    L = o * S, O = o * y;
                for (T[15] = 1, T[0] = 1 - I - A, T[1] = D + O, T[2] = R - L, T[4] = D - O, T[5] = 1 - x - A, T[6] = M + C, T[8] = R + L, T[9] = M - C, T[10] = 1 - x - I, E[15] = 1, E[0] = s, E[5] = l, E[10] = h, _ = 0; _ < 4; _++) d = T[_], f = T[_ + 4], m = T[_ + 8], p = T[_ + 12], v[_] = d, v[_ + 4] = f, v[_ + 8] = m, v[_ + 12] = d * t + f * e + m * n + p;
                for (_ = 0; _ < 4; _++) d = v[_], f = v[_ + 4], m = v[_ + 8], p = v[_ + 12], u[_ + c] = d * E[0] + f * E[1] + m * E[2] + p * E[3], u[_ + c + 4] = d * E[4] + f * E[5] + m * E[6] + p * E[7], u[_ + c + 8] = d * E[8] + f * E[9] + m * E[10] + p * E[11], u[_ + c + 12] = d * E[12] + f * E[13] + m * E[14] + p * E[15]
            }, N._createSceneByJsonForMaker = function (t, e, n) {
                var i = N._createNodeByJsonForMaker(t, e, n);
                return N._addComponentByJsonForMaker(t, e, n), i
            }, N._createNodeByJsonForMaker = function (t, e, n) {
                var i;
                switch (t.type) {
                    case"Scene3D":
                        i = new Qn;
                        break;
                    case"Sprite3D":
                        i = new Fn;
                        break;
                    case"MeshSprite3D":
                        i = new Ei, e && e.push(i);
                        break;
                    case"SkinnedMeshSprite3D":
                        i = new Di;
                        break;
                    case"ShuriKenParticle3D":
                        i = new yi;
                        break;
                    case"Terrain":
                        i = new ei;
                        break;
                    case"Camera":
                        i = new Mi;
                        break;
                    case"DirectionLight":
                        i = new gi;
                        break;
                    case"PointLight":
                        i = new Ii;
                        break;
                    case"SpotLight":
                        i = new vi;
                        break;
                    case"TrailSprite3D":
                        i = new Si;
                        break;
                    default:
                        var r = p.getClass(t.props.runtime);
                        i = new r
                }
                var a = t.child;
                if (a) for (var o = 0, s = a.length; o < s; o++) {
                    var l = N._createNodeByJsonForMaker(a[o], e, n);
                    i.addChild(l)
                }
                var h = t.compId;
                i.compId = h, i._parse(t.props, null), n && (n._idMap[h] = i), N._compIdToNode[h] = i;
                var u = t.components;
                if (u) for (var c = 0, _ = u.length; c < _; c++) {
                    var d = u[c];
                    if (!(r = S.window.Laya[d.type])) r = S.window, d.type.split(".").forEach(function (t) {
                        r = r[t]
                    });
                    if ("function" == typeof r) {
                        var f = new r;
                        n && (n._idMap[d.compId] = f)
                    }
                }
                return i
            }, N._addComponentByJsonForMaker = function (t, e, n) {
                var i = t.compId, r = N._compIdToNode[i], a = t.child;
                if (a) for (var o = 0, s = a.length; o < s; o++) N._addComponentByJsonForMaker(a[o], e, n);
                var l = t.components;
                if (l) for (var h = 0, u = l.length; h < u; h++) {
                    var c = l[h];
                    if (!(d = S.window.Laya[c.type])) {
                        var _ = c.type.split("."), d = S.window;
                        _.forEach(function (t) {
                            d = d[t]
                        })
                    }
                    if ("function" == typeof d) {
                        var f = n._idMap[c.compId];
                        r.addComponentIntance(f), f._parse(c)
                    }
                }
            }, N._createSprite3DInstance = function (t, e, n) {
                var i;
                switch (t.type) {
                    case"Scene3D":
                        i = new Qn;
                        break;
                    case"Sprite3D":
                        i = new Fn;
                        break;
                    case"MeshSprite3D":
                        i = new Ei, n && n.push(i);
                        break;
                    case"SkinnedMeshSprite3D":
                        i = new Di;
                        break;
                    case"ShuriKenParticle3D":
                        i = new yi;
                        break;
                    case"Terrain":
                        i = new ei;
                        break;
                    case"Camera":
                        i = new Mi;
                        break;
                    case"DirectionLight":
                        i = new gi;
                        break;
                    case"PointLight":
                        i = new Ii;
                        break;
                    case"SpotLight":
                        i = new vi;
                        break;
                    case"TrailSprite3D":
                        i = new Si;
                        break;
                    default:
                        throw new Error("Utils3D:unidentified class type in (.lh) file.")
                }
                var r = t.child;
                if (r) for (var a = 0, o = r.length; a < o; a++) {
                    var s = N._createSprite3DInstance(r[a], e, n);
                    i.addChild(s)
                }
                return e[t.instanceID] = i
            }, N._createComponentInstance = function (t, e) {
                var n = e[t.instanceID];
                n._parse(t.props, e);
                var i = t.child;
                if (i) for (var r = 0, a = i.length; r < a; r++) N._createComponentInstance(i[r], e);
                var o = t.components;
                if (o) for (var s = 0, l = o.length; s < l; s++) {
                    var h = o[s], u = S.window.Laya[h.type];
                    if (!u) {
                        var c = h.type.split(".");
                        u = S.window, c.forEach(function (t) {
                            u = u[t]
                        })
                    }
                    if ("function" == typeof u) n.addComponent(u)._parse(h)
                }
            }, N._createNodeByJson02 = function (t, e) {
                var n = {}, i = N._createSprite3DInstance(t, n, e);
                return N._createComponentInstance(t, n), i
            }, N._computeBoneAndAnimationDatasByBindPoseMatrxix = function (t, e, n, i, r, a) {
                var o, s, l = 0, h = 0, u = t.length;
                for (o = 0; o < u; l += t[o].keyframeWidth, h += 16, o++) laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(e[l + 0], e[l + 1], e[l + 2], e[l + 3], e[l + 4], e[l + 5], e[l + 6], e[l + 7], e[l + 8], e[l + 9], i, h), 0 != o && (s = 16 * t[o].parentIndex, laya.d3.utils.Utils3D.mulMatrixByArray(i, s, i, h, i, h));
                var c = n.length;
                for (o = 0; o < c; o++) laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(i, 16 * a[o], n[o], r, 16 * o)
            }, N._computeAnimationDatasByArrayAndMatrixFast = function (t, e, n, i) {
                for (var r = 0, a = t.length; r < a; r++) laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(e, 16 * i[r], t[r], n, 16 * r)
            }, N._computeBoneAndAnimationDatasByBindPoseMatrxixOld = function (t, e, n, i, r) {
                var a, o, s = 0, l = 0, h = t.length;
                for (a = 0; a < h; s += t[a].keyframeWidth, l += 16, a++) laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(e[s + 7], e[s + 8], e[s + 9], e[s + 3], e[s + 4], e[s + 5], e[s + 6], e[s + 0], e[s + 1], e[s + 2], i, l), 0 != a && (o = 16 * t[a].parentIndex, laya.d3.utils.Utils3D.mulMatrixByArray(i, o, i, l, i, l));
                var u = n.length;
                for (a = 0; a < u; a++) {
                    var c = 16 * a;
                    laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(i, c, n[a], r, c)
                }
            }, N._computeAnimationDatasByArrayAndMatrixFastOld = function (t, e, n) {
                for (var i = t.length, r = 0; r < i; r++) {
                    var a = 16 * r;
                    laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(e, a, t[r], n, a)
                }
            }, N._computeRootAnimationData = function (t, e, n) {
                for (var i = 0, r = 0, a = 0, o = t.length; i < o; r += t[i].keyframeWidth, a += 16, i++) laya.d3.utils.Utils3D.createAffineTransformationArray(e[r + 0], e[r + 1], e[r + 2], e[r + 3], e[r + 4], e[r + 5], e[r + 6], e[r + 7], e[r + 8], e[r + 9], n, a)
            }, N.transformVector3ArrayByQuat = function (t, e, n, i, r) {
                var a = t[e], o = t[e + 1], s = t[e + 2], l = n.x, h = n.y, u = n.z, c = n.w, _ = c * a + h * s - u * o,
                    d = c * o + u * a - l * s, f = c * s + l * o - h * a, m = -l * a - h * o - u * s;
                i[r] = _ * c + m * -l + d * -u - f * -h, i[r + 1] = d * c + m * -h + f * -l - _ * -u, i[r + 2] = f * c + m * -u + _ * -h - d * -l
            }, N.mulMatrixByArray = function (t, e, n, i, r, a) {
                var o, s, l, h, u;
                if (r === n) {
                    for (n = N._tempArray16_3, o = 0; o < 16; ++o) n[o] = r[a + o];
                    i = 0
                }
                for (o = 0; o < 4; o++) s = t[e + o], l = t[e + o + 4], h = t[e + o + 8], u = t[e + o + 12], r[a + o] = s * n[i + 0] + l * n[i + 1] + h * n[i + 2] + u * n[i + 3], r[a + o + 4] = s * n[i + 4] + l * n[i + 5] + h * n[i + 6] + u * n[i + 7], r[a + o + 8] = s * n[i + 8] + l * n[i + 9] + h * n[i + 10] + u * n[i + 11], r[a + o + 12] = s * n[i + 12] + l * n[i + 13] + h * n[i + 14] + u * n[i + 15]
            }, N.mulMatrixByArrayFast = function (t, e, n, i, r, a) {
                var o, s, l, h, u;
                for (o = 0; o < 4; o++) s = t[e + o], l = t[e + o + 4], h = t[e + o + 8], u = t[e + o + 12], r[a + o] = s * n[i + 0] + l * n[i + 1] + h * n[i + 2] + u * n[i + 3], r[a + o + 4] = s * n[i + 4] + l * n[i + 5] + h * n[i + 6] + u * n[i + 7], r[a + o + 8] = s * n[i + 8] + l * n[i + 9] + h * n[i + 10] + u * n[i + 11], r[a + o + 12] = s * n[i + 12] + l * n[i + 13] + h * n[i + 14] + u * n[i + 15]
            }, N.mulMatrixByArrayAndMatrixFast = function (t, e, n, i, r) {
                var a, o, s, l, h, u = n.elements, c = u[0], _ = u[1], d = u[2], f = u[3], m = u[4], p = u[5], T = u[6],
                    E = u[7], v = u[8], g = u[9], S = u[10], y = u[11], x = u[12], D = u[13], I = u[14], R = u[15],
                    M = e, A = e + 4, C = e + 8, L = e + 12, O = r, N = r + 4, V = r + 8, P = r + 12;
                for (a = 0; a < 4; a++) o = t[M + a], s = t[A + a], l = t[C + a], h = t[L + a], i[O + a] = o * c + s * _ + l * d + h * f, i[N + a] = o * m + s * p + l * T + h * E, i[V + a] = o * v + s * g + l * S + h * y, i[P + a] = o * x + s * D + l * I + h * R
            }, N.createAffineTransformationArray = function (t, e, n, i, r, a, o, s, l, h, u, c) {
                var _ = i + i, d = r + r, f = a + a, m = i * _, p = i * d, T = i * f, E = r * d, v = r * f, g = a * f,
                    S = o * _, y = o * d, x = o * f;
                u[c + 0] = (1 - (E + g)) * s, u[c + 1] = (p + x) * s, u[c + 2] = (T - y) * s, u[c + 3] = 0, u[c + 4] = (p - x) * l, u[c + 5] = (1 - (m + g)) * l, u[c + 6] = (v + S) * l, u[c + 7] = 0, u[c + 8] = (T + y) * h, u[c + 9] = (v - S) * h, u[c + 10] = (1 - (m + E)) * h, u[c + 11] = 0, u[c + 12] = t, u[c + 13] = e, u[c + 14] = n, u[c + 15] = 1
            }, N.transformVector3ArrayToVector3ArrayCoordinate = function (t, e, n, i, r) {
                var a = t[e + 0], o = t[e + 1], s = t[e + 2], l = n.elements,
                    h = a * l[3] + o * l[7] + s * l[11] + l[15];
                i[r] = a * l[0] + o * l[4] + s * l[8] + l[12] / h, i[r + 1] = a * l[1] + o * l[5] + s * l[9] + l[13] / h, i[r + 2] = a * l[2] + o * l[6] + s * l[10] + l[14] / h
            }, N.transformLightingMapTexcoordArray = function (t, e, n, i, r) {
                i[r + 0] = t[e + 0] * n.x + n.z, i[r + 1] = 1 - ((1 - t[e + 1]) * n.y + n.w)
            }, N.getURLVerion = function (t) {
                var e = t.indexOf("?");
                return 0 <= e ? t.substr(e) : null
            }, N._createAffineTransformationArray = function (t, e, n, i) {
                var r = e.x, a = e.y, o = e.z, s = e.w, l = r + r, h = a + a, u = o + o, c = r * l, _ = r * h,
                    d = r * u, f = a * h, m = a * u, p = o * u, T = s * l, E = s * h, v = s * u, g = n.x, S = n.y,
                    y = n.z;
                i[0] = (1 - (f + p)) * g, i[1] = (_ + v) * g, i[2] = (d - E) * g, i[3] = 0, i[4] = (_ - v) * S, i[5] = (1 - (c + p)) * S, i[6] = (m + T) * S, i[7] = 0, i[8] = (d + E) * y, i[9] = (m - T) * y, i[10] = (1 - (c + f)) * y, i[11] = 0, i[12] = t.x, i[13] = t.y, i[14] = t.z, i[15] = 1
            }, N._mulMatrixArray = function (t, e, n, i) {
                var r, a, o, s, l, h = e.elements, u = h[0], c = h[1], _ = h[2], d = h[3], f = h[4], m = h[5], p = h[6],
                    T = h[7], E = h[8], v = h[9], g = h[10], S = h[11], y = h[12], x = h[13], D = h[14], I = h[15],
                    R = i, M = i + 4, A = i + 8, C = i + 12;
                for (r = 0; r < 4; r++) a = t[r], o = t[r + 4], s = t[r + 8], l = t[r + 12], n[R + r] = a * u + o * c + s * _ + l * d, n[M + r] = a * f + o * m + s * p + l * T, n[A + r] = a * E + o * v + s * g + l * S, n[C + r] = a * y + o * x + s * D + l * I
            }, N.arcTanAngle = function (t, e) {
                return 0 == t ? 1 == e ? Math.PI / 2 : -Math.PI / 2 : 0 < t ? Math.atan(e / t) : t < 0 ? 0 < e ? Math.atan(e / t) + Math.PI : Math.atan(e / t) - Math.PI : 0
            }, N.angleTo = function (t, e, n) {
                Lt.subtract(e, t, at.TEMPVector30), Lt.normalize(at.TEMPVector30, at.TEMPVector30), n.x = Math.asin(at.TEMPVector30.y), n.y = N.arcTanAngle(-at.TEMPVector30.z, -at.TEMPVector30.x)
            }, N.transformQuat = function (t, e, n) {
                var i = e, r = t.x, a = t.y, o = t.z, s = i[0], l = i[1], h = i[2], u = i[3], c = u * r + l * o - h * a,
                    _ = u * a + h * r - s * o, d = u * o + s * a - l * r, f = -s * r - l * a - h * o;
                n.x = c * u + f * -s + _ * -h - d * -l, n.y = _ * u + f * -l + d * -s - c * -h, n.z = d * u + f * -h + c * -l - _ * -s
            }, N.quaternionWeight = function (t, e, n) {
                n.x = t.x * e, n.y = t.y * e, n.z = t.z * e, n.w = t.w
            }, N.quaternionConjugate = function (t, e) {
                e.x = -t.x, e.y = -t.y, e.z = -t.z, e.w = t.w
            }, N.scaleWeight = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z;
                n.x = 0 < i ? Math.pow(Math.abs(i), e) : -Math.pow(Math.abs(i), e), n.y = 0 < r ? Math.pow(Math.abs(r), e) : -Math.pow(Math.abs(r), e), n.z = 0 < a ? Math.pow(Math.abs(a), e) : -Math.pow(Math.abs(a), e)
            }, N.scaleBlend = function (t, e, n, i) {
                var r = N._tempVector3_0, a = N._tempVector3_1;
                N.scaleWeight(t, 1 - n, r), N.scaleWeight(e, n, a);
                var o = .5 < n ? e : t;
                i.x = 0 < o.x ? Math.abs(r.x * a.x) : -Math.abs(r.x * a.x), i.y = 0 < o.y ? Math.abs(r.y * a.y) : -Math.abs(r.y * a.y), i.z = 0 < o.z ? Math.abs(r.z * a.z) : -Math.abs(r.z * a.z)
            }, N.gammaToLinearSpace = function (t) {
                return t <= .04045 ? t / 12.92 : t < 1 ? Math.pow((t + .055) / 1.055, 2.4) : Math.pow(t, 2.4)
            }, N.linearToGammaSpace = function (t) {
                return t <= 0 ? 0 : t <= .0031308 ? 12.92 * t : t <= 1 ? 1.055 * Math.pow(t, .41666) - .055 : Math.pow(t, .41666)
            }, N.matrix4x4MultiplyFFF = function (t, e, n) {
                var i, r, a, o, s;
                if (n === e) for (e = new Float32Array(16), i = 0; i < 16; ++i) e[i] = n[i];
                var l = e[0], h = e[1], u = e[2], c = e[3], _ = e[4], d = e[5], f = e[6], m = e[7], p = e[8], T = e[9],
                    E = e[10], v = e[11], g = e[12], S = e[13], y = e[14], x = e[15];
                for (i = 0; i < 4; i++) r = t[i], a = t[i + 4], o = t[i + 8], s = t[i + 12], n[i] = r * l + a * h + o * u + s * c, n[i + 4] = r * _ + a * d + o * f + s * m, n[i + 8] = r * p + a * T + o * E + s * v, n[i + 12] = r * g + a * S + o * y + s * x
            }, N.matrix4x4MultiplyFFFForNative = function (t, e, n) {
                E.instance.matrix4x4Multiply(t, e, n)
            }, N.matrix4x4MultiplyMFM = function (t, e, n) {
                N.matrix4x4MultiplyFFF(t.elements, e, n.elements)
            }, N._buildTexture2D = function (t, e, n, i, r) {
                void 0 === r && (r = !1);
                var a = new F(t, e, n, r, !0);
                return a.anisoLevel = 1, a.filterMode = 0, yt._generateTexture2D(a, t, e, i), a
            }, N._drawBound = function (t, e, n) {
                t.lineCount + 12 > t.maxLineCount && (t.maxLineCount += 12);
                var i = N._tempVector3_0, r = N._tempVector3_1, a = e.min, o = e.max;
                i.setValue(a.x, a.y, a.z), r.setValue(o.x, a.y, a.z), t.addLine(i, r, n, n), i.setValue(a.x, a.y, a.z), r.setValue(a.x, a.y, o.z), t.addLine(i, r, n, n), i.setValue(o.x, a.y, a.z), r.setValue(o.x, a.y, o.z), t.addLine(i, r, n, n), i.setValue(a.x, a.y, o.z), r.setValue(o.x, a.y, o.z), t.addLine(i, r, n, n), i.setValue(a.x, a.y, a.z), r.setValue(a.x, o.y, a.z), t.addLine(i, r, n, n), i.setValue(a.x, a.y, o.z), r.setValue(a.x, o.y, o.z), t.addLine(i, r, n, n), i.setValue(o.x, a.y, a.z), r.setValue(o.x, o.y, a.z), t.addLine(i, r, n, n), i.setValue(o.x, a.y, o.z), r.setValue(o.x, o.y, o.z), t.addLine(i, r, n, n), i.setValue(a.x, o.y, a.z), r.setValue(o.x, o.y, a.z), t.addLine(i, r, n, n), i.setValue(a.x, o.y, a.z), r.setValue(a.x, o.y, o.z), t.addLine(i, r, n, n), i.setValue(o.x, o.y, a.z), r.setValue(o.x, o.y, o.z), t.addLine(i, r, n, n), i.setValue(a.x, o.y, o.z), r.setValue(o.x, o.y, o.z), t.addLine(i, r, n, n)
            }, N._getHierarchyPath = function (t, e, n) {
                n.length = 0;
                for (var i = e; i !== t;) {
                    var r = i._parent;
                    if (!r) return null;
                    n.push(r.getChildIndex(i)), i = r
                }
                return n
            }, N._getNodeByHierarchyPath = function (t, e) {
                for (var n = t, i = e.length - 1; 0 <= i; i--) n = n.getChildAt(e[i]);
                return n
            }, N._createNodeByJson = function (t, e) {
                var n;
                switch (t.type) {
                    case"Scene3D":
                        n = new Qn;
                        break;
                    case"Sprite3D":
                        n = new Fn;
                        break;
                    case"MeshSprite3D":
                        n = new Ei, e && e.push(n);
                        break;
                    case"SkinnedMeshSprite3D":
                        n = new Di;
                        break;
                    case"ShuriKenParticle3D":
                        n = new yi;
                        break;
                    case"Terrain":
                        n = new ei;
                        break;
                    case"Camera":
                        n = new Mi;
                        break;
                    case"DirectionLight":
                        n = new gi;
                        break;
                    case"PointLight":
                        n = new Ii;
                        break;
                    case"SpotLight":
                        n = new vi;
                        break;
                    case"TrailSprite3D":
                        n = new Si;
                        break;
                    default:
                        throw new Error("Utils3D:unidentified class type in (.lh) file.")
                }
                var i = t.child;
                if (i) for (var r = 0, a = i.length; r < a; r++) {
                    var o = N._createNodeByJson(i[r], e);
                    n.addChild(o)
                }
                var s = t.components;
                if (s) for (var l = 0, h = s.length; l < h; l++) {
                    var u = s[l];
                    if (!(_ = S.window.Laya[u.type])) {
                        var c = u.type.split("."), _ = S.window;
                        c.forEach(function (t) {
                            _ = _[t]
                        })
                    }
                    if ("function" == typeof _) n.addComponent(_)._parse(u)
                }
                return n._parse(t.props, null), n
            }, N._tempArray16_0 = new Float32Array(16), N._tempArray16_1 = new Float32Array(16), N._tempArray16_2 = new Float32Array(16), N._tempArray16_3 = new Float32Array(16), _(N, ["_tempVector3_0", function () {
                return this._tempVector3_0 = new Lt
            }, "_tempVector3_1", function () {
                return this._tempVector3_1 = new Lt
            }, "_tempVector3_2", function () {
                return this._tempVector3_2 = new Lt
            }, "_tempColor0", function () {
                return this._tempColor0 = new ft
            }, "_compIdToNode", function () {
                return this._compIdToNode = new Object
            }]), N
        }(), Xt = function () {
            function t() {
                this._currentLength = 0, this._elements = null, this._elements = new Float32Array(8)
            }

            d(t, "laya.d3.core.particleShuriKen.module.GradientDataNumber");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.add = function (t, e) {
                this._currentLength < 8 && (6 === this._currentLength && 1 !== t && (t = 1), this._elements[this._currentLength++] = t, this._elements[this._currentLength++] = e)
            }, e.getKeyByIndex = function (t) {
                return this._elements[2 * t]
            }, e.getValueByIndex = function (t) {
                return this._elements[2 * t + 1]
            }, e.getAverageValue = function () {
                for (var t = 0, e = this._currentLength - 2; t < e; t += 2) {
                    this._elements[t + 1];
                    this._elements[t + 3], this._elements[t + 2] - this._elements[t]
                }
                return 0
            }, e.cloneTo = function (t) {
                var e = t;
                e._currentLength = this._currentLength;
                var n = e._elements;
                n.length = this._elements.length;
                for (var i = 0, r = this._elements.length; i < r; i++) n[i] = this._elements[i]
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, e, "gradientCount", function () {
                return this._currentLength / 2
            }), t
        }(), Wt = function () {
            function t() {
            }

            return d(t, "laya.d3.core.pixelLine.PixelLineVertex"), u(0, t.prototype, "vertexDeclaration", function () {
                return t._vertexDeclaration
            }), u(1, t, "vertexDeclaration", function () {
                return t._vertexDeclaration
            }), _(t, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(28, [new zt(0, "vector3", 0), new zt(12, "vector4", 1)])
            }]), t
        }(), Yt = function () {
            function t() {
                this._hitResultsPoolIndex = 0, this._contactPonintsPoolIndex = 0, this._collisions = {}, this._hitResultsPool = [], this._contactPointsPool = [], this._collisionsPool = []
            }

            d(t, "laya.d3.physics.CollisionTool");
            var e = t.prototype;
            return e.getHitResult = function () {
                var t = this._hitResultsPool[this._hitResultsPoolIndex++];
                return t || (t = new Te, this._hitResultsPool.push(t)), t
            }, e.recoverAllHitResultsPool = function () {
                this._hitResultsPoolIndex = 0
            }, e.getContactPoints = function () {
                var t = this._contactPointsPool[this._contactPonintsPoolIndex++];
                return t || (t = new Y, this._contactPointsPool.push(t)), t
            }, e.recoverAllContactPointsPool = function () {
                this._contactPonintsPoolIndex = 0
            }, e.getCollision = function (t, e) {
                var n, i = t.id, r = e.id, a = this._collisions[i];
                return a && (n = a[r]), n || (a || (a = {}, this._collisions[i] = a), (n = 0 === this._collisionsPool.length ? new de : this._collisionsPool.pop())._colliderA = t, n._colliderB = e, a[r] = n), n
            }, e.recoverCollision = function (t) {
                var e = t._colliderA.id, n = t._colliderB.id;
                this._collisions[e][n] = null, this._collisionsPool.push(t)
            }, e.garbageCollection = function () {
                for (var t in this._hitResultsPoolIndex = 0, this._hitResultsPool.length = 0, this._contactPonintsPoolIndex = 0, this._contactPointsPool.length = 0, this._collisionsPool.length = 0, this._collisionsPool) {
                    var e = this._collisionsPool[t], n = !0;
                    for (var i in e) e[i] ? n = !1 : delete e[i];
                    n && delete this._collisionsPool[t]
                }
            }, t
        }(), Zt = function () {
            function p() {
                this._scene = null, this._eventList = [], this._multiTouchEnabled = !0, this._mouseTouch = new re, this._touchPool = [], this._touches = new un
            }

            d(p, "laya.d3.Input3D");
            var t = p.prototype;
            return t.__init__ = function (t, e) {
                this._scene = e;
                var n = this._eventList;
                t.oncontextmenu = function (t) {
                    return !1
                }, t.addEventListener("mousedown", function (t) {
                    t.preventDefault(), n.push(t)
                }), t.addEventListener("mouseup", function (t) {
                    t.preventDefault(), n.push(t)
                }, !0), t.addEventListener("mousemove", function (t) {
                    t.preventDefault(), n.push(t)
                }, !0), t.addEventListener("touchstart", function (t) {
                    t.preventDefault(), n.push(t)
                }), t.addEventListener("touchend", function (t) {
                    t.preventDefault(), n.push(t)
                }, !0), t.addEventListener("touchmove", function (t) {
                    t.preventDefault(), n.push(t)
                }, !0), t.addEventListener("touchcancel", function (t) {
                    n.push(t)
                }, !0)
            }, t.touchCount = function () {
                return this._touches.length
            }, t._getTouch = function (t) {
                var e = this._touchPool[t];
                return e || (e = new _e, (this._touchPool[t] = e)._identifier = t), e
            }, t._mouseTouchDown = function () {
                var t = this._mouseTouch, e = t.sprite;
                if (t._pressedSprite = e, t._pressedLoopCount = C.loopCount, e) {
                    var n = e._scripts;
                    if (n) for (var i = 0, r = n.length; i < r; i++) n[i].onMouseDown()
                }
            }, t._mouseTouchUp = function () {
                var t = 0, e = 0, n = this._mouseTouch, i = n._pressedSprite;
                n._pressedSprite = null, n._pressedLoopCount = -1;
                var r = n.sprite;
                if (r && r === i) {
                    var a = r._scripts;
                    if (a) for (t = 0, e = a.length; t < e; t++) a[t].onMouseClick()
                }
                if (i) {
                    var o = i._scripts;
                    if (o) for (t = 0, e = o.length; t < e; t++) o[t].onMouseUp()
                }
            }, t._mouseTouchRayCast = function (t) {
                var e = p._tempHitResult0, n = p._tempVector20, i = p._tempRay0;
                e.succeeded = !1;
                var r = this._mouseTouch.mousePositionX, a = this._mouseTouch.mousePositionY;
                n.x = r, n.y = a;
                for (var o = t.length - 1; 0 <= o; o--) {
                    var s = t[o], l = s.viewport;
                    if (n.x >= l.x && n.y >= l.y && n.x <= l.width && n.y <= l.height) if (s.viewportPointToRay(n, i), this._scene._physicsSimulation.rayCast(i, e) || 0 === s.clearFlag || 1 === s.clearFlag) break
                }
                var h = this._mouseTouch, u = h.sprite;
                if (e.succeeded) {
                    var c = e.collider.owner, _ = (h.sprite = c)._scripts;
                    if (u !== c && _) for (var d = 0, f = _.length; d < f; d++) _[d].onMouseEnter()
                } else h.sprite = null;
                if (u && u !== c) {
                    var m = u._scripts;
                    if (m) for (d = 0, f = m.length; d < f; d++) m[d].onMouseOut()
                }
            }, t._changeTouches = function (t, e) {
                for (var n = 0, i = 0, r = this._touches.length, a = 0, o = t.length; a < o; a++) {
                    var s = t[a], l = s.identifier;
                    if (this._multiTouchEnabled || 0 === l) {
                        var h = this._getTouch(l), u = h._position, c = p._tempPoint;
                        c.setTo(s.pageX, s.pageY), m.stage._canvasTransform.invertTransformPoint(c);
                        var _ = c.x, d = c.y;
                        switch (e) {
                            case 0:
                                this._touches.add(h), n += _, i += d;
                                break;
                            case 1:
                                this._touches.remove(h), n -= _, i -= d;
                                break;
                            case 2:
                                n = _ - u.x, i = d - u.y
                        }
                        u.x = _, u.y = d
                    }
                }
                var f = this._touches.length;
                this._mouseTouch.mousePositionY = 0 === f ? this._mouseTouch.mousePositionX = 0 : (this._mouseTouch.mousePositionX = (this._mouseTouch.mousePositionX * r + n) / f, (this._mouseTouch.mousePositionY * r + i) / f)
            }, t._update = function () {
                var t, e = 0, n = 0, i = 0;
                t = this._eventList.length;
                var r = this._scene._cameraPool;
                if (0 < t) {
                    for (e = 0; e < t; e++) {
                        var a = this._eventList[e];
                        switch (a.type) {
                            case"mousedown":
                                this._mouseTouchDown();
                                break;
                            case"mouseup":
                                this._mouseTouchUp();
                                break;
                            case"mousemove":
                                var o = p._tempPoint;
                                o.setTo(a.pageX, a.pageY), m.stage._canvasTransform.invertTransformPoint(o), this._mouseTouch.mousePositionX = o.x, this._mouseTouch.mousePositionY = o.y, this._mouseTouchRayCast(r);
                                break;
                            case"touchstart":
                                var s = this._touches.length;
                                this._changeTouches(a.changedTouches, 0), this._mouseTouchRayCast(r), 0 === s && this._mouseTouchDown();
                                break;
                            case"touchend":
                            case"touchcancel":
                                this._changeTouches(a.changedTouches, 1), 0 === this._touches.length && this._mouseTouchUp();
                                break;
                            case"touchmove":
                                this._changeTouches(a.changedTouches, 2), this._mouseTouchRayCast(r);
                                break;
                            default:
                                throw"Input3D:unkonwn event type."
                        }
                    }
                    this._eventList.length = 0
                }
                var l = this._mouseTouch, h = l._pressedSprite;
                if (h && C.loopCount > l._pressedLoopCount) {
                    var u = h._scripts;
                    if (u) for (n = 0, i = u.length; n < i; n++) u[n].onMouseDrag()
                }
                var c = l.sprite;
                if (c) {
                    var _ = c._scripts;
                    if (_) for (n = 0, i = _.length; n < i; n++) _[n].onMouseOver()
                }
            }, t.getTouch = function (t) {
                return t < this._touches.length ? this._touches.elements[t] : null
            }, u(0, t, "multiTouchEnabled", function () {
                return this._multiTouchEnabled
            }, function (t) {
                this._multiTouchEnabled = t
            }), _(p, ["_tempPoint", function () {
                return this._tempPoint = new y
            }, "_tempVector20", function () {
                return this._tempVector20 = new Ot
            }, "_tempRay0", function () {
                return this._tempRay0 = new W(new Lt, new Lt)
            }, "_tempHitResult0", function () {
                return this._tempHitResult0 = new Te
            }]), p
        }(), jt = function () {
            function U() {
            }

            return d(U, "laya.d3.core.particleShuriKen.ShurikenParticleData"), U._getStartLifetimeFromGradient = function (t, e) {
                for (var n = 1, i = t.gradientCount; n < i; n++) {
                    var r = t.getKeyByIndex(n);
                    if (e <= r) {
                        var a = t.getKeyByIndex(n - 1), o = (e - a) / (r - a);
                        return z.lerp(t.getValueByIndex(n - 1), t.getValueByIndex(n), o)
                    }
                }
                throw new Error("ShurikenParticleData: can't get value foam startLifeTimeGradient.")
            }, U._randomInvertRoationArray = function (t, e, n, i, r) {
                var a = NaN;
                i ? (i.seed = r[6], a = i.getFloat(), r[6] = i.seed) : a = Math.random(), e.z = a < n ? (e.x = -t.x, e.y = -t.y, -t.z) : (e.x = t.x, e.y = t.y, t.z)
            }, U._randomInvertRoation = function (t, e, n, i) {
                var r = NaN;
                return n ? (n.seed = i[6], r = n.getFloat(), i[6] = n.seed) : r = Math.random(), r < e && (t = -t), t
            }, U.create = function (t, e, n) {
                var i = t.autoRandomSeed, r = t._rand, a = t._randomSeeds;
                switch (t.startColorType) {
                    case 0:
                        var o = t.startColorConstant;
                        U.startColor.x = o.x, U.startColor.y = o.y, U.startColor.z = o.z, U.startColor.w = o.w;
                        break;
                    case 2:
                        i ? Ct.lerp(t.startColorConstantMin, t.startColorConstantMax, Math.random(), U.startColor) : (r.seed = a[3], Ct.lerp(t.startColorConstantMin, t.startColorConstantMax, r.getFloat(), U.startColor), a[3] = r.seed)
                }
                var s = t.colorOverLifetime;
                if (s && s.enbale) {
                    var l = s.color;
                    switch (l.type) {
                        case 0:
                            U.startColor.x = U.startColor.x * l.constant.x, U.startColor.y = U.startColor.y * l.constant.y, U.startColor.z = U.startColor.z * l.constant.z, U.startColor.w = U.startColor.w * l.constant.w;
                            break;
                        case 2:
                            var h = NaN;
                            i ? h = Math.random() : (r.seed = a[10], h = r.getFloat(), a[10] = r.seed);
                            var u = l.constantMin, c = l.constantMax;
                            U.startColor.x = U.startColor.x * z.lerp(u.x, c.x, h), U.startColor.y = U.startColor.y * z.lerp(u.y, c.y, h), U.startColor.z = U.startColor.z * z.lerp(u.z, c.z, h), U.startColor.w = U.startColor.w * z.lerp(u.w, c.w, h)
                    }
                }
                var _ = U.startSize;
                switch (t.startSizeType) {
                    case 0:
                        if (t.threeDStartSize) {
                            var d = t.startSizeConstantSeparate;
                            _[0] = d.x, _[1] = d.y, _[2] = d.z
                        } else _[0] = _[1] = _[2] = t.startSizeConstant;
                        break;
                    case 2:
                        if (t.threeDStartSize) {
                            var f = t.startSizeConstantMinSeparate, m = t.startSizeConstantMaxSeparate;
                            i ? (_[0] = z.lerp(f.x, m.x, Math.random()), _[1] = z.lerp(f.y, m.y, Math.random()), _[2] = z.lerp(f.z, m.z, Math.random())) : (r.seed = a[4], _[0] = z.lerp(f.x, m.x, r.getFloat()), _[1] = z.lerp(f.y, m.y, r.getFloat()), _[2] = z.lerp(f.z, m.z, r.getFloat()), a[4] = r.seed)
                        } else i ? _[0] = _[1] = _[2] = z.lerp(t.startSizeConstantMin, t.startSizeConstantMax, Math.random()) : (r.seed = a[4], _[0] = _[1] = _[2] = z.lerp(t.startSizeConstantMin, t.startSizeConstantMax, r.getFloat()), a[4] = r.seed)
                }
                var p = t.sizeOverLifetime;
                if (p && p.enbale && 1 === p.size.type) {
                    var T = p.size;
                    if (T.separateAxes) i ? (_[0] = _[0] * z.lerp(T.constantMinSeparate.x, T.constantMaxSeparate.x, Math.random()), _[1] = _[1] * z.lerp(T.constantMinSeparate.y, T.constantMaxSeparate.y, Math.random()), _[2] = _[2] * z.lerp(T.constantMinSeparate.z, T.constantMaxSeparate.z, Math.random())) : (r.seed = a[11], _[0] = _[0] * z.lerp(T.constantMinSeparate.x, T.constantMaxSeparate.x, r.getFloat()), _[1] = _[1] * z.lerp(T.constantMinSeparate.y, T.constantMaxSeparate.y, r.getFloat()), _[2] = _[2] * z.lerp(T.constantMinSeparate.z, T.constantMaxSeparate.z, r.getFloat()), a[11] = r.seed); else {
                        var E = NaN;
                        i ? E = z.lerp(T.constantMin, T.constantMax, Math.random()) : (r.seed = a[11], E = z.lerp(T.constantMin, T.constantMax, r.getFloat()), a[11] = r.seed), _[0] = _[0] * E, _[1] = _[1] * E, _[2] = _[2] * E
                    }
                }
                var v = e.renderMode;
                if (1 !== v) switch (t.startRotationType) {
                    case 0:
                        if (t.threeDStartRotation) {
                            var g = t.startRotationConstantSeparate, S = U._tempVector30;
                            U._randomInvertRoationArray(g, S, t.randomizeRotationDirection, i ? null : r, a), U.startRotation[0] = S.x, U.startRotation[1] = S.y, U.startRotation[2] = 4 !== v ? -S.z : S.z
                        } else U.startRotation[0] = U._randomInvertRoation(t.startRotationConstant, t.randomizeRotationDirection, i ? null : r, a), U.startRotation[1] = 0, U.startRotation[2] = 0;
                        break;
                    case 2:
                        if (t.threeDStartRotation) {
                            var y = t.startRotationConstantMinSeparate, x = t.startRotationConstantMaxSeparate,
                                D = U._tempVector30;
                            i ? (D.x = z.lerp(y.x, x.x, Math.random()), D.y = z.lerp(y.y, x.y, Math.random()), D.z = z.lerp(y.z, x.z, Math.random())) : (r.seed = a[5], D.x = z.lerp(y.x, x.x, r.getFloat()), D.y = z.lerp(y.y, x.y, r.getFloat()), D.z = z.lerp(y.z, x.z, r.getFloat()), a[5] = r.seed), U._randomInvertRoationArray(D, D, t.randomizeRotationDirection, i ? null : r, a), U.startRotation[0] = D.x, U.startRotation[1] = D.y, U.startRotation[2] = 4 !== v ? -D.z : D.z
                        } else i ? U.startRotation[0] = U._randomInvertRoation(z.lerp(t.startRotationConstantMin, t.startRotationConstantMax, Math.random()), t.randomizeRotationDirection, i ? null : r, a) : (r.seed = a[5], U.startRotation[0] = U._randomInvertRoation(z.lerp(t.startRotationConstantMin, t.startRotationConstantMax, r.getFloat()), t.randomizeRotationDirection, i ? null : r, a), a[5] = r.seed)
                }
                switch (t.startLifetimeType) {
                    case 0:
                        U.startLifeTime = t.startLifetimeConstant;
                        break;
                    case 1:
                        U.startLifeTime = U._getStartLifetimeFromGradient(t.startLifeTimeGradient, t.emissionTime);
                        break;
                    case 2:
                        i ? U.startLifeTime = z.lerp(t.startLifetimeConstantMin, t.startLifetimeConstantMax, Math.random()) : (r.seed = a[7], U.startLifeTime = z.lerp(t.startLifetimeConstantMin, t.startLifetimeConstantMax, r.getFloat()), a[7] = r.seed);
                        break;
                    case 3:
                        var I = t.emissionTime;
                        i ? U.startLifeTime = z.lerp(U._getStartLifetimeFromGradient(t.startLifeTimeGradientMin, I), U._getStartLifetimeFromGradient(t.startLifeTimeGradientMax, I), Math.random()) : (r.seed = a[7], U.startLifeTime = z.lerp(U._getStartLifetimeFromGradient(t.startLifeTimeGradientMin, I), U._getStartLifetimeFromGradient(t.startLifeTimeGradientMax, I), r.getFloat()), a[7] = r.seed)
                }
                switch (t.startSpeedType) {
                    case 0:
                        U.startSpeed = t.startSpeedConstant;
                        break;
                    case 2:
                        i ? U.startSpeed = z.lerp(t.startSpeedConstantMin, t.startSpeedConstantMax, Math.random()) : (r.seed = a[8], U.startSpeed = z.lerp(t.startSpeedConstantMin, t.startSpeedConstantMax, r.getFloat()), a[8] = r.seed)
                }
                var R = t.textureSheetAnimation;
                if (R && R.enable) {
                    var M = R.tiles, A = M.x, C = M.y, L = 1 / A, O = 1 / C, N = 0, V = R.startFrame;
                    switch (V.type) {
                        case 0:
                            N = V.constant;
                            break;
                        case 1:
                            i ? N = z.lerp(V.constantMin, V.constantMax, Math.random()) : (r.seed = a[14], N = z.lerp(V.constantMin, V.constantMax, r.getFloat()), a[14] = r.seed)
                    }
                    var P = R.frame;
                    switch (P.type) {
                        case 0:
                            N += P.constant;
                            break;
                        case 2:
                            i ? N += z.lerp(P.constantMin, P.constantMax, Math.random()) : (r.seed = a[15], N += z.lerp(P.constantMin, P.constantMax, r.getFloat()), a[15] = r.seed)
                    }
                    var w = 0;
                    switch (R.type) {
                        case 0:
                            w = Math.floor(N / A);
                            break;
                        case 1:
                            R.randomRow ? i ? w = Math.floor(Math.random() * C) : (r.seed = a[13], w = Math.floor(r.getFloat() * C), a[13] = r.seed) : w = R.rowIndex
                    }
                    var b = Math.floor(N % A);
                    (U.startUVInfo = U.startUVInfo)[0] = L, U.startUVInfo[1] = O, U.startUVInfo[2] = b * L, U.startUVInfo[3] = w * O
                } else (U.startUVInfo = U.startUVInfo)[0] = 1, U.startUVInfo[1] = 1, U.startUVInfo[2] = 0, U.startUVInfo[3] = 0;
                switch (t.simulationSpace) {
                    case 0:
                        var F = n.position;
                        U.simulationWorldPostion[0] = F.x, U.simulationWorldPostion[1] = F.y, U.simulationWorldPostion[2] = F.z;
                        var B = n.rotation;
                        U.simulationWorldRotation[0] = B.x, U.simulationWorldRotation[1] = B.y, U.simulationWorldRotation[2] = B.z, U.simulationWorldRotation[3] = B.w;
                        break;
                    case 1:
                        break;
                    default:
                        throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.")
                }
            }, U.startLifeTime = NaN, U.startSpeed = NaN, _(U, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempQuaternion", function () {
                return this._tempQuaternion = new at
            }, "startColor", function () {
                return this.startColor = new Ct
            }, "startSize", function () {
                return this.startSize = new Float32Array(3)
            }, "startRotation", function () {
                return this.startRotation = new Float32Array(3)
            }, "startUVInfo", function () {
                return this.startUVInfo = new Float32Array(4)
            }, "simulationWorldPostion", function () {
                return this.simulationWorldPostion = new Float32Array(3)
            }, "simulationWorldRotation", function () {
                return this.simulationWorldRotation = new Float32Array(4)
            }]), U
        }(), Kt = function () {
            function c(t, e, n, i) {
                this._octree = null, this._parent = null, this._children = null, this._isContaion = !1, this.baseLength = 0, this._bounds = new ze(new Lt, new Lt), this._objects = [], this.center = new Lt, this._setValues(t, e, n, i)
            }

            d(c, "laya.d3.core.scene.BoundsOctreeNode");
            var t = c.prototype;
            return t._setValues = function (t, e, n, i) {
                this._octree = t, this._parent = e, this.baseLength = n, i.cloneTo(this.center);
                var r = this._bounds.min, a = this._bounds.max, o = t._looseness * n / 2;
                r.setValue(i.x - o, i.y - o, i.z - o), a.setValue(i.x + o, i.y + o, i.z + o)
            }, t._getChildBound = function (t) {
                if (null != this._children && this._children[t]) return this._children[t]._bounds;
                var e = this.baseLength / 4, n = this.baseLength / 2 * this._octree._looseness / 2, i = c._tempBoundBox,
                    r = i.min, a = i.max;
                switch (t) {
                    case 0:
                        r.x = this.center.x - e - n, r.y = this.center.y + e - n, r.z = this.center.z - e - n, a.x = this.center.x - e + n, a.y = this.center.y + e + n, a.z = this.center.z - e + n;
                        break;
                    case 1:
                        r.x = this.center.x + e - n, r.y = this.center.y + e - n, r.z = this.center.z - e - n, a.x = this.center.x + e + n, a.y = this.center.y + e + n, a.z = this.center.z - e + n;
                        break;
                    case 2:
                        r.x = this.center.x - e - n, r.y = this.center.y + e - n, r.z = this.center.z + e - n, a.x = this.center.x - e + n, a.y = this.center.y + e + n, a.z = this.center.z + e + n;
                        break;
                    case 3:
                        r.x = this.center.x + e - n, r.y = this.center.y + e - n, r.z = this.center.z + e - n, a.x = this.center.x + e + n, a.y = this.center.y + e + n, a.z = this.center.z + e + n;
                        break;
                    case 4:
                        r.x = this.center.x - e - n, r.y = this.center.y - e - n, r.z = this.center.z - e - n, a.x = this.center.x - e + n, a.y = this.center.y - e + n, a.z = this.center.z - e + n;
                        break;
                    case 5:
                        r.x = this.center.x + e - n, r.y = this.center.y - e - n, r.z = this.center.z - e - n, a.x = this.center.x + e + n, a.y = this.center.y - e + n, a.z = this.center.z - e + n;
                        break;
                    case 6:
                        r.x = this.center.x - e - n, r.y = this.center.y - e - n, r.z = this.center.z + e - n, a.x = this.center.x - e + n, a.y = this.center.y - e + n, a.z = this.center.z + e + n;
                        break;
                    case 7:
                        r.x = this.center.x + e - n, r.y = this.center.y - e - n, r.z = this.center.z + e - n, a.x = this.center.x + e + n, a.y = this.center.y - e + n, a.z = this.center.z + e + n
                }
                return i
            }, t._getChildCenter = function (t) {
                if (null != this._children) return this._children[t].center;
                var e = this.baseLength / 4, n = c._tempVector30;
                switch (t) {
                    case 0:
                        n.x = this.center.x - e, n.y = this.center.y + e, n.z = this.center.z - e;
                        break;
                    case 1:
                        n.x = this.center.x + e, n.y = this.center.y + e, n.z = this.center.z - e;
                        break;
                    case 2:
                        n.x = this.center.x - e, n.y = this.center.y + e, n.z = this.center.z + e;
                        break;
                    case 3:
                        n.x = this.center.x + e, n.y = this.center.y + e, n.z = this.center.z + e;
                        break;
                    case 4:
                        n.x = this.center.x - e, n.y = this.center.y - e, n.z = this.center.z - e;
                        break;
                    case 5:
                        n.x = this.center.x + e, n.y = this.center.y - e, n.z = this.center.z - e;
                        break;
                    case 6:
                        n.x = this.center.x - e, n.y = this.center.y - e, n.z = this.center.z + e;
                        break;
                    case 7:
                        n.x = this.center.x + e, n.y = this.center.y - e, n.z = this.center.z + e
                }
                return n
            }, t._getChild = function (t) {
                var e = this.baseLength / 4;
                switch (this._children || (this._children = w(8, null)), t) {
                    case 0:
                        return this._children[0] || (this._children[0] = new c(this._octree, this, this.baseLength / 2, new Lt(this.center.x + -e, this.center.y + e, this.center.z - e)));
                    case 1:
                        return this._children[1] || (this._children[1] = new c(this._octree, this, this.baseLength / 2, new Lt(this.center.x + e, this.center.y + e, this.center.z - e)));
                    case 2:
                        return this._children[2] || (this._children[2] = new c(this._octree, this, this.baseLength / 2, new Lt(this.center.x - e, this.center.y + e, this.center.z + e)));
                    case 3:
                        return this._children[3] || (this._children[3] = new c(this._octree, this, this.baseLength / 2, new Lt(this.center.x + e, this.center.y + e, this.center.z + e)));
                    case 4:
                        return this._children[4] || (this._children[4] = new c(this._octree, this, this.baseLength / 2, new Lt(this.center.x - e, this.center.y - e, this.center.z - e)));
                    case 5:
                        return this._children[5] || (this._children[5] = new c(this._octree, this, this.baseLength / 2, new Lt(this.center.x + e, this.center.y - e, this.center.z - e)));
                    case 6:
                        return this._children[6] || (this._children[6] = new c(this._octree, this, this.baseLength / 2, new Lt(this.center.x - e, this.center.y - e, this.center.z + e)));
                    case 7:
                        return this._children[7] || (this._children[7] = new c(this._octree, this, this.baseLength / 2, new Lt(this.center.x + e, this.center.y - e, this.center.z + e)));
                    default:
                        throw"BoundsOctreeNode: unknown index."
                }
            }, t._shouldMerge = function () {
                for (var t = this._objects.length, e = 0; e < 8; e++) {
                    var n = this._children[e];
                    if (n) {
                        if (null != n._children) return !1;
                        t += n._objects.length
                    }
                }
                return t <= 8
            }, t._mergeChildren = function () {
                for (var t = 0; t < 8; t++) {
                    var e = this._children[t];
                    if (e) {
                        e._parent = null;
                        for (var n = e._objects, i = n.length - 1; 0 <= i; i--) {
                            var r = n[i];
                            this._objects.push(r), r._setOctreeNode(this)
                        }
                    }
                }
                this._children = null
            }, t._merge = function () {
                if (null === this._children) {
                    var t = this._parent;
                    t && t._shouldMerge() && (t._mergeChildren(), t._merge())
                }
            }, t._checkAddNode = function (t) {
                if (null == this._children) {
                    if (this._objects.length < 8 || this.baseLength / 2 < this._octree._minSize) return this;
                    for (var e = this._objects.length - 1; 0 <= e; e--) {
                        var n = this._objects[e], i = this._bestFitChild(n.bounds.getCenter());
                        c._encapsulates(this._getChildBound(i), n.bounds._getBoundBox()) && (this._objects.splice(this._objects.indexOf(n), 1), this._getChild(i)._add(n))
                    }
                }
                var r = this._bestFitChild(t.bounds.getCenter());
                return c._encapsulates(this._getChildBound(r), t.bounds._getBoundBox()) ? this._getChild(r)._checkAddNode(t) : this
            }, t._add = function (t) {
                var e = this._checkAddNode(t);
                e._objects.push(t), t._setOctreeNode(e)
            }, t._remove = function (t) {
                var e = this._objects.indexOf(t);
                this._objects.splice(e, 1), t._setOctreeNode(null), this._merge()
            }, t._addUp = function (t) {
                return 1 === Fe.boxContainsBox(this._bounds, t.bounds._getBoundBox()) ? (this._add(t), !0) : !!this._parent && this._parent._addUp(t)
            }, t._getCollidingWithFrustum = function (t, e, n, i) {
                if (n) {
                    var r = e.containsBoundBox(this._bounds);
                    if (C.octreeNodeCulling++, 0 === r) return;
                    n = 2 === r
                }
                this._isContaion = !n;
                for (var a = t.camera, o = t.scene, s = 0, l = this._objects.length; s < l; s++) {
                    var h = this._objects[s];
                    if (a._isLayerVisible(h._owner.layer) && h._enable) {
                        if (n && (C.frustumCulling++, !h._needRender(e))) continue;
                        h._distanceForSort = Lt.distance(h.bounds.getCenter(), i);
                        for (var u = h._renderElements, c = 0, _ = u.length; c < _; c++) {
                            var d = u[c], f = o._getRenderQueue(d.material.renderQueue);
                            f.isTransparent ? d.addToTransparentRenderQueue(t, f) : d.addToOpaqueRenderQueue(t, f)
                        }
                    }
                }
                if (null != this._children) for (s = 0; s < 8; s++) {
                    var m = this._children[s];
                    m && m._getCollidingWithFrustum(t, e, n, i)
                }
            }, t._getCollidingWithBoundBox = function (t, e, n) {
                if (e) {
                    var i = Fe.boxContainsBox(this._bounds, t);
                    if (0 === i) return;
                    e = 2 === i
                }
                if (e) for (var r = 0, a = this._objects.length; r < a; r++) {
                    var o = this._objects[r];
                    Fe.intersectsBoxAndBox(o.bounds._getBoundBox(), t) && n.push(o)
                }
                if (null != this._children) for (r = 0; r < 8; r++) {
                    this._children[r]._getCollidingWithBoundBox(t, e, n)
                }
            }, t._bestFitChild = function (t) {
                return (t.x <= this.center.x ? 0 : 1) + (t.y >= this.center.y ? 0 : 4) + (t.z <= this.center.z ? 0 : 2)
            }, t._update = function (t) {
                if (1 === Fe.boxContainsBox(this._bounds, t.bounds._getBoundBox())) {
                    var e = this._checkAddNode(t);
                    if (e !== t._getOctreeNode()) {
                        e._objects.push(t), t._setOctreeNode(e);
                        var n = this._objects.indexOf(t);
                        this._objects.splice(n, 1), this._merge()
                    }
                    return !0
                }
                if (this._parent) {
                    var i = this._parent._addUp(t);
                    return i && (n = this._objects.indexOf(t), this._objects.splice(n, 1), this._merge()), i
                }
                return !1
            }, t.add = function (t) {
                return !!c._encapsulates(this._bounds, t.bounds._getBoundBox()) && (this._add(t), !0)
            }, t.remove = function (t) {
                return t._getOctreeNode() === this && (this._remove(t), !0)
            }, t.update = function (t) {
                return t._getOctreeNode() === this && this._update(t)
            }, t.shrinkIfPossible = function (t) {
                if (this.baseLength < 2 * t) return this;
                for (var e = -1, n = 0, i = this._objects.length; n < i; n++) {
                    var r = this._objects[n], a = this._bestFitChild(r.bounds.getCenter());
                    if (0 != n && a != e) return this;
                    var o = this._getChildBound(a);
                    if (!c._encapsulates(o, r.bounds._getBoundBox())) return this;
                    0 == n && (e = a)
                }
                if (null == this._children) {
                    if (-1 != e) {
                        var s = this._getChildCenter(e);
                        this._setValues(this._octree, null, this.baseLength / 2, s)
                    }
                    return this
                }
                var l = !1;
                for (n = 0, i = this._children.length; n < i; n++) {
                    var h = this._children[n];
                    if (h && h.hasAnyObjects()) {
                        if (l) return this;
                        if (0 <= e && e != n) return this;
                        l = !0, e = n
                    }
                }
                if (-1 == e) return this;
                var u = this._children[e];
                return u._parent = null, u
            }, t.hasAnyObjects = function () {
                if (0 < this._objects.length) return !0;
                if (null != this._children) for (var t = 0; t < 8; t++) {
                    var e = this._children[t];
                    if (e && e.hasAnyObjects()) return !0
                }
                return !1
            }, t.getCollidingWithBoundBox = function (t, e) {
                this._getCollidingWithBoundBox(t, !0, e)
            }, t.getCollidingWithRay = function (t, e, n) {
                void 0 === n && (n = Number.MAX_VALUE);
                var i = Fe.intersectsRayAndBoxRD(t, this._bounds);
                if (!(-1 == i || n < i)) {
                    for (var r = 0, a = this._objects.length; r < a; r++) {
                        var o = this._objects[r];
                        -1 !== (i = Fe.intersectsRayAndBoxRD(t, o.bounds._getBoundBox())) && i <= n && e.push(o)
                    }
                    if (null != this._children) for (r = 0; r < 8; r++) {
                        this._children[r].getCollidingWithRay(t, e, n)
                    }
                }
            }, t.getCollidingWithFrustum = function (t) {
                var e = t.camera.transform.position, n = t.camera.boundFrustum;
                this._getCollidingWithFrustum(t, n, !0, e)
            }, t.isCollidingWithBoundBox = function (t) {
                if (!Fe.intersectsBoxAndBox(this._bounds, t)) return !1;
                for (var e = 0, n = this._objects.length; e < n; e++) {
                    var i = this._objects[e];
                    if (Fe.intersectsBoxAndBox(i.bounds._getBoundBox(), t)) return !0
                }
                if (null != this._children) for (e = 0; e < 8; e++) {
                    if (this._children[e].isCollidingWithBoundBox(t)) return !0
                }
                return !1
            }, t.isCollidingWithRay = function (t, e) {
                void 0 === e && (e = Number.MAX_VALUE);
                var n = Fe.intersectsRayAndBoxRD(t, this._bounds);
                if (-1 == n || e < n) return !1;
                for (var i = 0, r = this._objects.length; i < r; i++) {
                    var a = this._objects[i];
                    if (-1 !== (n = Fe.intersectsRayAndBoxRD(t, a.bounds._getBoundBox())) && n <= e) return !0
                }
                if (null != this._children) for (i = 0; i < 8; i++) {
                    if (this._children[i].isCollidingWithRay(t, e)) return !0
                }
                return !1
            }, t.getBound = function () {
                return this._bounds
            }, t.drawAllBounds = function (t, e, n) {
                if (null !== this._children || 0 != this._objects.length) {
                    e++;
                    var i = c._tempColor0;
                    if (this._isContaion) i.r = 0, i.g = 0, i.b = 1; else {
                        var r = n ? e / n : 0;
                        i.r = 1 - r, i.g = r, i.b = 0
                    }
                    if (i.a = .3, kt._drawBound(t, this._bounds, i), null != this._children) for (var a = 0; a < 8; a++) {
                        var o = this._children[a];
                        o && o.drawAllBounds(t, e, n)
                    }
                }
            }, t.drawAllObjects = function (t, e, n) {
                e++;
                var i = c._tempColor0;
                if (this._isContaion) i.r = 0, i.g = 0, i.b = 1; else {
                    var r = n ? e / n : 0;
                    i.r = 1 - r, i.g = r, i.b = 0
                }
                i.a = 1;
                for (var a = 0, o = this._objects.length; a < o; a++) kt._drawBound(t, this._objects[a].bounds._getBoundBox(), i);
                if (null != this._children) for (a = 0; a < 8; a++) {
                    var s = this._children[a];
                    s && s.drawAllObjects(t, e, n)
                }
            }, c._encapsulates = function (t, e) {
                return 1 == Fe.boxContainsBox(t, e)
            }, c._NUM_OBJECTS_ALLOWED = 8, _(c, ["_tempVector3", function () {
                return this._tempVector3 = new Lt
            }, "_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempVector31", function () {
                return this._tempVector31 = new Lt
            }, "_tempColor0", function () {
                return this._tempColor0 = new ft
            }, "_tempBoundBox", function () {
                return this._tempBoundBox = new ze(new Lt, new Lt)
            }]), c
        }(), qt = (function () {
            function t() {
                this._currentLength = 0, this._elements = null, this._elements = new Float32Array(12)
            }

            d(t, "laya.d3.core.particleShuriKen.module.GradientDataVector2");
            var e = t.prototype;
            m.imps(e, {"laya.d3.core.IClone": !0}), e.add = function (t, e) {
                this._currentLength < 8 && (6 === this._currentLength && 1 !== t && (t = 1), this._elements[this._currentLength++] = t, this._elements[this._currentLength++] = e.x, this._elements[this._currentLength++] = e.y)
            }, e.cloneTo = function (t) {
                var e = t;
                e._currentLength = this._currentLength;
                var n = e._elements;
                n.length = this._elements.length;
                for (var i = 0, r = this._elements.length; i < r; i++) n[i] = this._elements[i]
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, e, "gradientCount", function () {
                return this._currentLength / 3
            })
        }(), function () {
            function t(t, e, n, i) {
                this._position = null, this._normal = null, this._textureCoord0 = null, this._textureCoord1 = null, this._position = t, this._normal = e, this._textureCoord0 = n, this._textureCoord1 = i
            }

            d(t, "laya.d3.graphics.Vertex.VertexPositionTerrain");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.graphics.IVertex": !0}), u(0, e, "normal", function () {
                return this._normal
            }), u(0, e, "position", function () {
                return this._position
            }), u(0, e, "textureCoord0", function () {
                return this._textureCoord0
            }), u(0, e, "textureCoord1", function () {
                return this._textureCoord1
            }), u(0, e, "vertexDeclaration", function () {
                return t._vertexDeclaration
            }), u(1, t, "vertexDeclaration", function () {
                return t._vertexDeclaration
            }), t.TERRAIN_POSITION0 = 0, t.TERRAIN_NORMAL0 = 1, t.TERRAIN_TEXTURECOORDINATE0 = 2, t.TERRAIN_TEXTURECOORDINATE1 = 3, _(t, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(40, [new zt(0, "vector3", 0), new zt(12, "vector3", 1), new zt(24, "vector2", 2), new zt(32, "vector2", 3)])
            }]), t
        }()), Qt = function () {
            function t() {
                this._nodes = []
            }

            d(t, "laya.d3.animation.KeyframeNodeList");
            var e = t.prototype;
            return e.getNodeByIndex = function (t) {
                return this._nodes[t]
            }, e.setNodeByIndex = function (t, e) {
                this._nodes[t] = e
            }, u(0, e, "count", function () {
                return this._nodes.length
            }, function (t) {
                this._nodes.length = t
            }), t
        }(), Jt = function () {
            function i(t, e, n, i) {
                this._initialSize = NaN, this._rootNode = null, this._looseness = NaN, this._minSize = NaN, this.count = 0, this._motionObjects = new vn, t < n && (n = t), this._initialSize = t, this._minSize = n, this._looseness = Math.min(Math.max(i, 1), 2), this._rootNode = new Kt(this, null, t, e)
            }

            d(i, "laya.d3.core.scene.BoundsOctree");
            var t = i.prototype;
            return t._getMaxDepth = function (t, e) {
                e++;
                var n = t._children;
                if (null != n) for (var i = e, r = 0, a = n.length; r < a; r++) {
                    var o = n[r];
                    o && (e = Math.max(this._getMaxDepth(o, i), e))
                }
                return e
            }, t._grow = function (t) {
                var e = 0 <= t.x ? 1 : -1, n = 0 <= t.y ? 1 : -1, i = 0 <= t.z ? 1 : -1, r = this._rootNode,
                    a = this._rootNode.baseLength / 2, o = 2 * this._rootNode.baseLength, s = this._rootNode.center,
                    l = new Lt(s.x + e * a, s.y + n * a, s.z + i * a);
                if (this._rootNode = new Kt(this, null, o, l), r.hasAnyObjects()) {
                    for (var h = this._rootNode._bestFitChild(r.center), u = w(8, null), c = 0; c < 8; c++) c == h && (r._parent = this._rootNode, u[c] = r);
                    this._rootNode._children = u
                }
            }, t.add = function (t) {
                for (var e = 0; !this._rootNode.add(t);) {
                    var n = i._tempVector30;
                    if (Lt.subtract(t.bounds.getCenter(), this._rootNode.center, n), this._grow(n), 20 < ++e) throw"Aborted Add operation as it seemed to be going on forever (" + (e - 1) + ") attempts at growing the octree."
                }
                this.count++
            }, t.remove = function (t) {
                var e = t._getOctreeNode().remove(t);
                return e && this.count--, e
            }, t.update = function (t) {
                var e = 0, n = t._getOctreeNode();
                if (n) {
                    for (; !n._update(t);) if (this._grow(t.bounds.getCenter()), 20 < ++e) throw"Aborted Add operation as it seemed to be going on forever (" + (e - 1) + ") attempts at growing the octree.";
                    return !0
                }
                return !1
            }, t.shrinkRootIfPossible = function () {
                this._rootNode = this._rootNode.shrinkIfPossible(this._initialSize)
            }, t.addMotionObject = function (t) {
                this._motionObjects.add(t)
            }, t.removeMotionObject = function (t) {
                this._motionObjects.remove(t)
            }, t.updateMotionObjects = function () {
                for (var t = this._motionObjects.elements, e = 0, n = this._motionObjects.length; e < n; e++) {
                    var i = t[e];
                    this.update(i), i._setIndexInMotionList(-1)
                }
                this._motionObjects.length = 0
            }, t.isCollidingWithBoundBox = function (t) {
                return this._rootNode.isCollidingWithBoundBox(t)
            }, t.isCollidingWithRay = function (t, e) {
                return void 0 === e && (e = Number.MAX_VALUE), this._rootNode.isCollidingWithRay(t, e)
            }, t.getCollidingWithBoundBox = function (t, e) {
                this._rootNode.getCollidingWithBoundBox(t, e)
            }, t.getCollidingWithRay = function (t, e, n) {
                void 0 === n && (n = Number.MAX_VALUE), this._rootNode.getCollidingWithRay(t, e, n)
            }, t.getCollidingWithFrustum = function (t) {
                this._rootNode.getCollidingWithFrustum(t)
            }, t.getMaxBounds = function () {
                return this._rootNode.getBound()
            }, t.drawAllBounds = function (t) {
                var e = this._getMaxDepth(this._rootNode, -1);
                this._rootNode.drawAllBounds(t, -1, e)
            }, t.drawAllObjects = function (t) {
                var e = this._getMaxDepth(this._rootNode, -1);
                this._rootNode.drawAllObjects(t, -1, e)
            }, _(i, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }]), i
        }(), $t = function () {
            function t(t) {
                this._owner = null, this._sharedMesh = null, this._owner = t
            }

            d(t, "laya.d3.core.MeshFilter");
            var e = t.prototype;
            return e._getMeshDefine = function (t) {
                for (var e = 0, n = 0, i = t._subMeshCount; n < i; n++) for (var r = t._getSubMesh(n)._vertexBuffer._vertexDeclaration.vertexElements, a = 0, o = r.length; a < o; a++) {
                    switch (r[a].elementUsage) {
                        case 1:
                            e |= Ei.SHADERDEFINE_COLOR;
                            break;
                        case 2:
                            e |= Ei.SHADERDEFINE_UV0;
                            break;
                        case 7:
                            e |= Ei.SHADERDEFINE_UV1
                    }
                }
                return e
            }, e.destroy = function () {
                this._owner = null, this._sharedMesh && (this._sharedMesh._removeReference(), this._sharedMesh = null)
            }, u(0, e, "sharedMesh", function () {
                return this._sharedMesh
            }, function (t) {
                if (this._sharedMesh !== t) {
                    var e = this._owner._render._defineDatas, n = this._sharedMesh;
                    n && (n._removeReference(), e.remove(this._getMeshDefine(n))), t._addReference(), this._sharedMesh = t, e.add(this._getMeshDefine(t)), this._owner._render._changeRenderObjectsByMesh(t)
                }
                this._owner._render._onMeshChange(t)
            }), t
        }(), te = function () {
            function t(t) {
                this._minVertexDistance = NaN, this._widthMultiplier = NaN, this._time = NaN, this._widthCurve = null, this._colorGradient = null, this._textureMode = 0, this._trialGeometry = null, this._totalLength = 0, this._owner = null, this._curtime = 0, this._trailRenderElementIndex = 0, this._lastPosition = new Lt, this.alignment = 0, this._owner = t, this._initDefaultData(), this.addRenderElement()
            }

            d(t, "laya.d3.core.trail.TrailFilter");
            var e = t.prototype;
            return e.addRenderElement = function () {
                var t = this._owner._render, e = t._renderElements, n = t.sharedMaterials[0];
                n || (n = ni.defaultMaterial);
                var i = new vt;
                i.setTransform(this._owner._transform), i.render = t, i.material = n, this._trialGeometry = new dn(this), i.setGeometry(this._trialGeometry), e.push(i)
            }, e._update = function (t) {
                var e = this._owner._render;
                this._curtime += t.scene.timer._delta / 1e3, e._shaderValues.setNumber(Si.CURTIME, this._curtime);
                var n = this._owner.transform.position, i = e._renderElements[0]._geometry;
                i._updateDisappear(), i._updateTrail(t.camera, this._lastPosition, n), i._updateVertexBufferUV(), n.cloneTo(this._lastPosition)
            }, e._initDefaultData = function () {
                this.time = 5, this.minVertexDistance = .1, this.widthMultiplier = 1, this.textureMode = 0;
                var t = [], e = new Tn;
                e.time = 0, e.inTangent = 0, e.outTangent = 0, e.value = 1, t.push(e);
                var n = new Tn;
                n.time = 1, n.inTangent = 0, n.outTangent = 0, n.value = 1, t.push(n), this.widthCurve = t;
                var i = new rt(2, 2);
                i.mode = 0, i.addColorRGB(0, ft.WHITE), i.addColorRGB(1, ft.WHITE), i.addColorAlpha(0, 1), i.addColorAlpha(1, 1), this.colorGradient = i
            }, e.destroy = function () {
                this._trialGeometry.destroy(), this._trialGeometry = null, this._widthCurve = null, this._colorGradient = null
            }, u(0, e, "widthMultiplier", function () {
                return this._widthMultiplier
            }, function (t) {
                this._widthMultiplier = t
            }), u(0, e, "time", function () {
                return this._time
            }, function (t) {
                this._time = t, this._owner._render._shaderValues.setNumber(Si.LIFETIME, t)
            }), u(0, e, "widthCurve", function () {
                return this._widthCurve
            }, function (t) {
                this._widthCurve = t;
                var e, n = new Float32Array(4 * t.length), i = 0, r = 0;
                for (i = 0, e = t.length; i < e; i++) n[r++] = t[i].time, n[r++] = t[i].inTangent, n[r++] = t[i].outTangent, n[r++] = t[i].value;
                this._owner._render._shaderValues.setBuffer(Si.WIDTHCURVE, n), this._owner._render._shaderValues.setInt(Si.WIDTHCURVEKEYLENGTH, t.length)
            }), u(0, e, "minVertexDistance", function () {
                return this._minVertexDistance
            }, function (t) {
                this._minVertexDistance = t
            }), u(0, e, "colorGradient", function () {
                return this._colorGradient
            }, function (t) {
                this._colorGradient = t, this._owner._render._shaderValues.setBuffer(Si.GRADIENTCOLORKEY, t._rgbElements), this._owner._render._shaderValues.setBuffer(Si.GRADIENTALPHAKEY, t._alphaElements), 0 == t.mode ? this._owner._render._defineDatas.add(Si.SHADERDEFINE_GRADIENTMODE_BLEND) : this._owner._render._defineDatas.remove(Si.SHADERDEFINE_GRADIENTMODE_BLEND)
            }), u(0, e, "textureMode", function () {
                return this._textureMode
            }, function (t) {
                this._textureMode = t
            }), t.ALIGNMENT_VIEW = 0, t.ALIGNMENT_TRANSFORM_Z = 1, t
        }(), ee = function () {
            function t() {
            }

            d(t, "laya.d3.core.trail.VertexTrail");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.graphics.IVertex": !0}), u(0, e, "vertexDeclaration", function () {
                return t._vertexDeclaration1
            }), u(1, t, "vertexDeclaration1", function () {
                return t._vertexDeclaration1
            }), u(1, t, "vertexDeclaration2", function () {
                return t._vertexDeclaration2
            }), t.TRAIL_POSITION0 = 0, t.TRAIL_OFFSETVECTOR = 1, t.TRAIL_TIME0 = 2, t.TRAIL_TEXTURECOORDINATE0Y = 3, t.TRAIL_TEXTURECOORDINATE0X = 4, _(t, ["_vertexDeclaration1", function () {
                return this._vertexDeclaration1 = new fe(32, [new zt(0, "vector3", 0), new zt(12, "vector3", 1), new zt(24, "single", 2), new zt(28, "single", 3)])
            }, "_vertexDeclaration2", function () {
                return this._vertexDeclaration2 = new fe(4, [new zt(0, "single", 4)])
            }]), t
        }(), ne = function () {
            function t(t, e, n) {
                this._time = NaN, this._minCount = 0, this._maxCount = 0, this._time = t, this._minCount = e, this._maxCount = n
            }

            d(t, "laya.d3.core.particleShuriKen.module.Burst");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.cloneTo = function (t) {
                var e = t;
                e._time = this._time, e._minCount = this._minCount, e._maxCount = this._maxCount
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, e, "time", function () {
                return this._time
            }), u(0, e, "minCount", function () {
                return this._minCount
            }), u(0, e, "maxCount", function () {
                return this._maxCount
            }), t
        }(), ie = function () {
            function t() {
                this.time = NaN, this.eventName = null, this.params = null
            }

            return d(t, "laya.d3.animation.AnimationEvent"), t
        }(), re = (function () {
            function t() {
                this._nativeConstraint = null, this._simulation = null, this.rigidbodyA = null, this.rigidbodyB = null
            }

            d(t, "laya.d3.physics.Constraint3D")
        }(), function () {
            function t() {
                this._pressedSprite = null, this._pressedLoopCount = -1, this.sprite = null, this.mousePositionX = 0, this.mousePositionY = 0
            }

            return d(t, "laya.d3.MouseTouch"), t
        }()), ae = function () {
            function t() {
                this._currentLength = 0, this._elements = null, this._elements = new Float32Array(8)
            }

            d(t, "laya.d3.core.particleShuriKen.module.GradientDataInt");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.add = function (t, e) {
                this._currentLength < 8 && (6 === this._currentLength && 1 !== t && (t = 1), this._elements[this._currentLength++] = t, this._elements[this._currentLength++] = e)
            }, e.cloneTo = function (t) {
                var e = t;
                e._currentLength = this._currentLength;
                var n = e._elements;
                n.length = this._elements.length;
                for (var i = 0, r = this._elements.length; i < r; i++) n[i] = this._elements[i]
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, e, "gradientCount", function () {
                return this._currentLength / 2
            }), t
        }(), oe = function () {
            function t(t, e, n, i) {
                this._attributeMap = null, this._uniformMap = null, this._publicDefines = null, this._publicDefinesMap = null, this._spriteDefines = null, this._spriteDefinesMap = null, this._materialDefines = null, this._materialDefinesMap = null, this._owner = null, this._flags = {}, this._passes = [], this._publicDefines = [], this._publicDefinesMap = {}, this._spriteDefines = [], this._spriteDefinesMap = {}, this._materialDefines = [], this._materialDefinesMap = {}, this._addDefines(this._publicDefines, this._publicDefinesMap, Pt._globleDefines), n && this._addDefines(this._spriteDefines, this._spriteDefinesMap, n.defines), i && this._addDefines(this._materialDefines, this._materialDefinesMap, i.defines), this._attributeMap = t, this._uniformMap = e
            }

            d(t, "laya.d3.shader.SubShader");
            var e = t.prototype;
            return e._addDefines = function (t, e, n) {
                for (var i in n) {
                    var r = n[i], a = parseInt(i);
                    e[t[a] = r] = a
                }
            }, e.getMaterialDefineByName = function (t) {
                return this._materialDefinesMap[t]
            }, e.setFlag = function (t, e) {
                e ? this._flags[t] = e : delete this._flags[t]
            }, e.getFlag = function (t) {
                return this._flags[t]
            }, e.addShaderPass = function (t, e, n) {
                var i = new Qe(this, t, e, n);
                return this._passes.push(i), i
            }, t
        }(), se = function () {
            function t() {
                this.source = null, this.destination = null, this.camera = null, this.compositeShaderData = null, this.compositeDefineData = null, this.command = null, this.tempRenderTextures = []
            }

            return d(t, "laya.d3.core.render.PostProcessRenderContext"), t
        }(), le = function () {
            function t() {
                this._commands = []
            }

            d(t, "laya.d3.core.render.command.CommandBuffer");
            var e = t.prototype;
            return e._apply = function () {
                for (var t = 0, e = this._commands.length; t < e; t++) this._commands[t].run()
            }, e.setShaderDataTexture = function (t, e, n) {
                this._commands.push(Mn.create(t, e, n))
            }, e.blit = function (t, e, n, i, r) {
                void 0 === r && (r = 0), this._commands.push(nn.create(t, e, n, i, r))
            }, e.setRenderTarget = function (t) {
                this._commands.push(gn.create(t))
            }, e.clear = function () {
                for (var t = 0, e = this._commands.length; t < e; t++) this._commands[t].recover();
                this._commands.length = 0
            }, t.SCREENTEXTURE_NAME = "u_ScreenTexture", _(t, ["screenShader", function () {
                return this.screenShader = Pt.find("ScreenQuad")
            }, "SCREENTEXTURE_ID", function () {
                return this.SCREENTEXTURE_ID = Pt.propertyNameToID("u_ScreenTexture")
            }]), t
        }(), he = function () {
            function h() {
                this._type = 0, this._separateAxes = !1, this._constant = NaN, this._constantSeparate = null, this._gradient = null, this._gradientX = null, this._gradientY = null, this._gradientZ = null, this._gradientW = null, this._constantMin = NaN, this._constantMax = NaN, this._constantMinSeparate = null, this._constantMaxSeparate = null, this._gradientMin = null, this._gradientMax = null, this._gradientXMin = null, this._gradientXMax = null, this._gradientYMin = null, this._gradientYMax = null, this._gradientZMin = null, this._gradientZMax = null, this._gradientWMin = null, this._gradientWMax = null
            }

            d(h, "laya.d3.core.particleShuriKen.module.GradientAngularVelocity");
            var t = h.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.cloneTo = function (t) {
                var e = t;
                e._type = this._type, e._separateAxes = this._separateAxes, e._constant = this._constant, this._constantSeparate.cloneTo(e._constantSeparate), this._gradient.cloneTo(e._gradient), this._gradientX.cloneTo(e._gradientX), this._gradientY.cloneTo(e._gradientY), this._gradientZ.cloneTo(e._gradientZ), e._constantMin = this._constantMin, e._constantMax = this._constantMax, this._constantMinSeparate.cloneTo(e._constantMinSeparate), this._constantMaxSeparate.cloneTo(e._constantMaxSeparate), this._gradientMin.cloneTo(e._gradientMin), this._gradientMax.cloneTo(e._gradientMax), this._gradientXMin.cloneTo(e._gradientXMin), this._gradientXMax.cloneTo(e._gradientXMax), this._gradientYMin.cloneTo(e._gradientYMin), this._gradientYMax.cloneTo(e._gradientYMax), this._gradientZMin.cloneTo(e._gradientZMin), this._gradientZMax.cloneTo(e._gradientZMax)
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, t, "gradientZ", function () {
                return this._gradientZ
            }), u(0, t, "constant", function () {
                return this._constant
            }), u(0, t, "gradient", function () {
                return this._gradient
            }), u(0, t, "separateAxes", function () {
                return this._separateAxes
            }), u(0, t, "type", function () {
                return this._type
            }), u(0, t, "constantSeparate", function () {
                return this._constantSeparate
            }), u(0, t, "gradientX", function () {
                return this._gradientX
            }), u(0, t, "gradientY", function () {
                return this._gradientY
            }), u(0, t, "gradientW", function () {
                return this._gradientW
            }), u(0, t, "gradientMin", function () {
                return this._gradientMin
            }), u(0, t, "constantMin", function () {
                return this._constantMin
            }), u(0, t, "gradientMax", function () {
                return this._gradientMax
            }), u(0, t, "constantMax", function () {
                return this._constantMax
            }), u(0, t, "gradientWMin", function () {
                return this._gradientWMin
            }), u(0, t, "constantMinSeparate", function () {
                return this._constantMinSeparate
            }), u(0, t, "constantMaxSeparate", function () {
                return this._constantMaxSeparate
            }), u(0, t, "gradientXMin", function () {
                return this._gradientXMin
            }), u(0, t, "gradientXMax", function () {
                return this._gradientXMax
            }), u(0, t, "gradientWMax", function () {
                return this._gradientWMax
            }), u(0, t, "gradientYMin", function () {
                return this._gradientYMin
            }), u(0, t, "gradientYMax", function () {
                return this._gradientYMax
            }), u(0, t, "gradientZMin", function () {
                return this._gradientZMin
            }), u(0, t, "gradientZMax", function () {
                return this._gradientZMax
            }), h.createByConstant = function (t) {
                var e = new h;
                return e._type = 0, e._separateAxes = !1, e._constant = t, e
            }, h.createByConstantSeparate = function (t) {
                var e = new h;
                return e._type = 0, e._separateAxes = !0, e._constantSeparate = t, e
            }, h.createByGradient = function (t) {
                var e = new h;
                return e._type = 1, e._separateAxes = !1, e._gradient = t, e
            }, h.createByGradientSeparate = function (t, e, n) {
                var i = new h;
                return i._type = 1, i._separateAxes = !0, i._gradientX = t, i._gradientY = e, i._gradientZ = n, i
            }, h.createByRandomTwoConstant = function (t, e) {
                var n = new h;
                return n._type = 2, n._separateAxes = !1, n._constantMin = t, n._constantMax = e, n
            }, h.createByRandomTwoConstantSeparate = function (t, e) {
                var n = new h;
                return n._type = 2, n._separateAxes = !0, n._constantMinSeparate = t, n._constantMaxSeparate = e, n
            }, h.createByRandomTwoGradient = function (t, e) {
                var n = new h;
                return n._type = 3, n._separateAxes = !1, n._gradientMin = t, n._gradientMax = e, n
            }, h.createByRandomTwoGradientSeparate = function (t, e, n, i, r, a, o, s) {
                var l = new h;
                return l._type = 3, l._separateAxes = !0, l._gradientXMin = t, l._gradientXMax = e, l._gradientYMin = n, l._gradientYMax = i, l._gradientZMin = r, l._gradientZMax = a, l._gradientWMin = o, l._gradientWMax = s, l
            }, h
        }(), ue = function () {
            function e() {
                this._defaultPhysicsMemory = 16, this._editerEnvironment = !1, this.isAntialias = !0, this.isAlpha = !1, this.premultipliedAlpha = !0, this.isStencil = !0, this.octreeCulling = !1, this.octreeInitialSize = 64, this.octreeMinNodeSize = 2, this.octreeLooseness = 1.25, this.debugFrustumCulling = !1, this.octreeInitialCenter = new Lt(0, 0, 0)
            }

            d(e, "Config3D");
            var t = e.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.cloneTo = function (t) {
                var e = t;
                e._defaultPhysicsMemory = this._defaultPhysicsMemory, e._editerEnvironment = this._editerEnvironment, e.isAntialias = this.isAntialias, e.isAlpha = this.isAlpha, e.premultipliedAlpha = this.premultipliedAlpha, e.isStencil = this.isStencil, e.octreeCulling = this.octreeCulling, this.octreeInitialCenter.cloneTo(e.octreeInitialCenter), e.octreeMinNodeSize = this.octreeMinNodeSize, e.octreeLooseness = this.octreeLooseness, e.debugFrustumCulling = this.debugFrustumCulling
            }, t.clone = function () {
                var t = new e;
                return this.cloneTo(t), t
            }, u(0, t, "defaultPhysicsMemory", function () {
                return this._defaultPhysicsMemory
            }, function (t) {
                if (t < 16) throw"defaultPhysicsMemory must large than 16M";
                this._defaultPhysicsMemory = t
            }), _(e, ["_default", function () {
                return this._default = new e
            }]), e
        }(), ce = (function () {
            function r(t) {
                if (this._state0U = NaN, this._state0L = NaN, this._state1U = NaN, this._state1L = NaN, !(t instanceof Array) || 4 !== t.length) throw new Error("Rand:Seed must be an array with 4 numbers");
                this._state0U = 0 | t[0], this._state0L = 0 | t[1], this._state1U = 0 | t[2], this._state1L = 0 | t[3]
            }

            d(r, "laya.d3.math.RandX");
            var t = r.prototype;
            t.randomint = function () {
                var t = this._state0U, e = this._state0L, n = this._state1U, i = this._state1L,
                    r = (i >>> 0) + (e >>> 0), a = n + t + (r / 2 >>> 31) >>> 0, o = r >>> 0, s = 0, l = 0;
                s = (t ^= s = t << 23 | (-512 & e) >>> 9) ^ (this._state0U = n), l = (e ^= l = e << 23) ^ (this._state0L = i);
                s ^= t >>> 18, l ^= e >>> 18 | (262143 & t) << 14;
                return s ^= n >>> 5, l ^= i >>> 5 | (31 & n) << 27, this._state1U = s, this._state1L = l, [a, o]
            }, t.random = function () {
                var t = this.randomint(), e = t[0], n = 1023 << 20 | e >>> 12, i = 0 | (t[1] >>> 12 | (4095 & e) << 20);
                return r._CONVERTION_BUFFER.setUint32(0, n, !1), r._CONVERTION_BUFFER.setUint32(4, i, !1), xt._CONVERTION_BUFFER.getFloat64(0, !1) - 1
            }, _(r, ["_CONVERTION_BUFFER", function () {
                return this._CONVERTION_BUFFER = new DataView(new ArrayBuffer(8))
            }, "defaultRand", function () {
                return this.defaultRand = new xt([0, Date.now() / 65536, 0, Date.now() % 65536])
            }])
        }(), function () {
            function m() {
            }

            return d(m, "laya.d3.utils.Picker"), m.calculateCursorRay = function (t, e, n, i, r, a) {
                var o = t.x, s = t.y, l = m._tempVector30, h = l;
                h.x = o, h.y = s, h.z = e.minDepth;
                var u = m._tempVector31, c = u;
                c.x = o, c.y = s, c.z = e.maxDepth;
                var _ = a.origin, d = m._tempVector32;
                e.unprojectFromWVP(l, n, i, r, _), e.unprojectFromWVP(u, n, i, r, d);
                var f = a.direction;
                f.x = d.x - _.x, f.y = d.y - _.y, f.z = d.z - _.z, Lt.normalize(a.direction, a.direction)
            }, m.rayIntersectsTriangle = function (t, e, n, i) {
                var r = m._tempVector30, a = m._tempVector31;
                Lt.subtract(n, e, r), Lt.subtract(i, e, a);
                var o, s = m._tempVector32;
                if (Lt.cross(t.direction, a, s), (o = Lt.dot(r, s)) > -Number.MIN_VALUE && o < Number.MIN_VALUE) return Number.NaN;
                var l, h = 1 / o, u = m._tempVector33;
                if (Lt.subtract(t.origin, e, u), l = Lt.dot(u, s), (l *= h) < 0 || 1 < l) return Number.NaN;
                var c, _, d = m._tempVector34;
                return Lt.cross(u, r, d), c = Lt.dot(t.direction, d), (c *= h) < 0 || 1 < l + c ? Number.NaN : (_ = Lt.dot(a, d), (_ *= h) < 0 ? Number.NaN : _)
            }, _(m, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempVector31", function () {
                return this._tempVector31 = new Lt
            }, "_tempVector32", function () {
                return this._tempVector32 = new Lt
            }, "_tempVector33", function () {
                return this._tempVector33 = new Lt
            }, "_tempVector34", function () {
                return this._tempVector34 = new Lt
            }]), m
        }()), _e = function () {
            function t() {
                this._indexInList = -1, this._identifier = -1, this._position = new Ot
            }

            d(t, "laya.d3.Touch");
            var e = t.prototype;
            return m.imps(e, {"laya.resource.ISingletonElement": !0}), e._getIndexInList = function () {
                return this._indexInList
            }, e._setIndexInList = function (t) {
                this._indexInList = t
            }, u(0, e, "identifier", function () {
                return this._identifier
            }), u(0, e, "position", function () {
                return this._position
            }), t
        }(), de = (function () {
            function t() {
                this.startPosition = new Lt, this.endPosition = new Lt, this.startColor = new ft, this.endColor = new ft
            }

            d(t, "laya.d3.core.pixelLine.PixelLineData"), t.prototype.cloneTo = function (t) {
                this.startPosition.cloneTo(t.startPosition), this.endPosition.cloneTo(t.endPosition), this.startColor.cloneTo(t.startColor), this.endColor.cloneTo(t.endColor)
            }
        }(), function () {
            function t() {
                this._lastUpdateFrame = -2147483648, this._updateFrame = -2147483648, this._isTrigger = !1, this.contacts = []
            }

            return d(t, "laya.d3.physics.Collision"), t.prototype._setUpdateFrame = function (t) {
                this._lastUpdateFrame = this._updateFrame, this._updateFrame = t
            }, t
        }()), fe = function () {
            function l(t, e) {
                this._id = 0, this._vertexStride = 0, this._vertexElementsDic = null, this._shaderValues = null, this._defineDatas = null, this.vertexElements = null, this._id = ++l._uniqueIDCounter, this._defineDatas = new Ut, this._vertexElementsDic = {}, this._vertexStride = t;
                var n = (this.vertexElements = e).length;
                this._shaderValues = new ot(null);
                for (var i = 0; i < n; i++) {
                    var r = e[i], a = r.elementUsage;
                    this._vertexElementsDic[a] = r;
                    var o = new Int32Array(5), s = Oe.getElementInfos(r.elementFormat);
                    o[0] = s[0], o[1] = s[1], o[2] = s[2], o[3] = this._vertexStride, o[4] = r.offset, this._shaderValues.setAttribute(a, o)
                }
            }

            d(l, "laya.d3.graphics.VertexDeclaration");
            var t = l.prototype;
            return t.getVertexElementByUsage = function (t) {
                return this._vertexElementsDic[t]
            }, t.unBinding = function () {
            }, u(0, t, "id", function () {
                return this._id
            }), u(0, t, "vertexStride", function () {
                return this._vertexStride
            }), l._uniqueIDCounter = 1, l
        }(), me = function () {
            function t() {
                this._material = null, this._mesh = xn.instance
            }

            d(t, "laya.d3.resource.models.SkyRenderer");
            var e = t.prototype;
            return e._isAvailable = function () {
                return this._material && this._mesh
            }, e._render = function (t) {
                if (this._material && this._mesh) {
                    var e = E.instance, n = t.scene, i = t.camera;
                    V.setCullFace(e, !1), V.setDepthFunc(e, 515), V.setDepthMask(e, !1);
                    var r = t.shader = this._material._shader.getSubShaderAt(0)._passes[0].withCompile(0, 0, this._material._defineDatas.value),
                        a = r.bind(), o = C.loopCount !== r._uploadMark, s = r._uploadScene !== n || o;
                    (s || a) && (r.uploadUniforms(r._sceneUniformParamsMap, n._shaderValues, s), r._uploadScene = n);
                    var l = r._uploadCamera !== i || o;
                    (l || a) && (r.uploadUniforms(r._cameraUniformParamsMap, i._shaderValues, l), r._uploadCamera = i);
                    var h = r._uploadMaterial !== this._material || o;
                    (h || a) && (r.uploadUniforms(r._materialUniformParamsMap, this._material._shaderValues, h), r._uploadMaterial = this._material), this._mesh._bufferState.bind(), this._mesh._render(t), V.setDepthFunc(e, 513), V.setDepthMask(e, !0)
                }
            }, e.destroy = function () {
                this._material && (this._material._removeReference(), this._material = null)
            }, u(0, e, "material", function () {
                return this._material
            }, function (t) {
                this._material !== t && (this._material && this._material._removeReference(), t && t._addReference(), this._material = t)
            }), u(0, e, "mesh", function () {
                return this._mesh
            }, function (t) {
                this._mesh !== t && (this._mesh = t)
            }), t
        }(), pe = (function () {
            function t() {
            }

            d(t, "laya.d3.animation.AnimatorStateScript");
            var e = t.prototype;
            e.onStateEnter = function () {
            }, e.onStateUpdate = function () {
            }, e.onStateExit = function () {
            }
        }(), function () {
            function t() {
                this.updateMark = -1, this.indexInList = -1, this.batched = !1
            }

            return d(t, "laya.d3.core.render.BatchMark"), t
        }()), Te = function () {
            function t() {
                this.succeeded = !1, this.collider = null, this.hitFraction = 0, this.point = new Lt, this.normal = new Lt
            }

            return d(t, "laya.d3.physics.HitResult"), t
        }(), Ee = function () {
            function s() {
                this._type = 0, this._separateAxes = !1, this._gradient = null, this._gradientX = null, this._gradientY = null, this._gradientZ = null, this._constantMin = NaN, this._constantMax = NaN, this._constantMinSeparate = null, this._constantMaxSeparate = null, this._gradientMin = null, this._gradientMax = null, this._gradientXMin = null, this._gradientXMax = null, this._gradientYMin = null, this._gradientYMax = null, this._gradientZMin = null, this._gradientZMax = null
            }

            d(s, "laya.d3.core.particleShuriKen.module.GradientSize");
            var t = s.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.getMaxSizeInGradient = function () {
                var t = 0, e = 0, n = -Number.MAX_VALUE;
                switch (this._type) {
                    case 0:
                        if (this._separateAxes) {
                            for (t = 0, e = this._gradientX.gradientCount; t < e; t++) n = Math.max(n, this._gradientX.getValueByIndex(t));
                            for (t = 0, e = this._gradientY.gradientCount; t < e; t++) n = Math.max(n, this._gradientY.getValueByIndex(t))
                        } else for (t = 0, e = this._gradient.gradientCount; t < e; t++) n = Math.max(n, this._gradient.getValueByIndex(t));
                        break;
                    case 1:
                        n = this._separateAxes ? (n = Math.max(this._constantMinSeparate.x, this._constantMaxSeparate.x), n = Math.max(n, this._constantMinSeparate.y), Math.max(n, this._constantMaxSeparate.y)) : Math.max(this._constantMin, this._constantMax);
                        break;
                    case 2:
                        if (this._separateAxes) {
                            for (t = 0, e = this._gradientXMin.gradientCount; t < e; t++) n = Math.max(n, this._gradientXMin.getValueByIndex(t));
                            for (t = 0, e = this._gradientXMax.gradientCount; t < e; t++) n = Math.max(n, this._gradientXMax.getValueByIndex(t));
                            for (t = 0, e = this._gradientYMin.gradientCount; t < e; t++) n = Math.max(n, this._gradientYMin.getValueByIndex(t));
                            for (t = 0, e = this._gradientZMax.gradientCount; t < e; t++) n = Math.max(n, this._gradientZMax.getValueByIndex(t))
                        } else {
                            for (t = 0, e = this._gradientMin.gradientCount; t < e; t++) n = Math.max(n, this._gradientMin.getValueByIndex(t));
                            for (t = 0, e = this._gradientMax.gradientCount; t < e; t++) n = Math.max(n, this._gradientMax.getValueByIndex(t))
                        }
                }
                return n
            }, t.cloneTo = function (t) {
                var e = t;
                e._type = this._type, e._separateAxes = this._separateAxes, this._gradient.cloneTo(e._gradient), this._gradientX.cloneTo(e._gradientX), this._gradientY.cloneTo(e._gradientY), this._gradientZ.cloneTo(e._gradientZ), e._constantMin = this._constantMin, e._constantMax = this._constantMax, this._constantMinSeparate.cloneTo(e._constantMinSeparate), this._constantMaxSeparate.cloneTo(e._constantMaxSeparate), this._gradientMin.cloneTo(e._gradientMin), this._gradientMax.cloneTo(e._gradientMax), this._gradientXMin.cloneTo(e._gradientXMin), this._gradientXMax.cloneTo(e._gradientXMax), this._gradientYMin.cloneTo(e._gradientYMin), this._gradientYMax.cloneTo(e._gradientYMax), this._gradientZMin.cloneTo(e._gradientZMin), this._gradientZMax.cloneTo(e._gradientZMax)
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, t, "gradientZ", function () {
                return this._gradientZ
            }), u(0, t, "gradient", function () {
                return this._gradient
            }), u(0, t, "separateAxes", function () {
                return this._separateAxes
            }), u(0, t, "type", function () {
                return this._type
            }), u(0, t, "gradientMin", function () {
                return this._gradientMin
            }), u(0, t, "constantMin", function () {
                return this._constantMin
            }), u(0, t, "gradientX", function () {
                return this._gradientX
            }), u(0, t, "gradientY", function () {
                return this._gradientY
            }), u(0, t, "gradientMax", function () {
                return this._gradientMax
            }), u(0, t, "constantMax", function () {
                return this._constantMax
            }), u(0, t, "constantMinSeparate", function () {
                return this._constantMinSeparate
            }), u(0, t, "constantMaxSeparate", function () {
                return this._constantMaxSeparate
            }), u(0, t, "gradientXMin", function () {
                return this._gradientXMin
            }), u(0, t, "gradientXMax", function () {
                return this._gradientXMax
            }), u(0, t, "gradientYMin", function () {
                return this._gradientYMin
            }), u(0, t, "gradientYMax", function () {
                return this._gradientYMax
            }), u(0, t, "gradientZMin", function () {
                return this._gradientZMin
            }), u(0, t, "gradientZMax", function () {
                return this._gradientZMax
            }), s.createByGradient = function (t) {
                var e = new s;
                return e._type = 0, e._separateAxes = !1, e._gradient = t, e
            }, s.createByGradientSeparate = function (t, e, n) {
                var i = new s;
                return i._type = 0, i._separateAxes = !0, i._gradientX = t, i._gradientY = e, i._gradientZ = n, i
            }, s.createByRandomTwoConstant = function (t, e) {
                var n = new s;
                return n._type = 1, n._separateAxes = !1, n._constantMin = t, n._constantMax = e, n
            }, s.createByRandomTwoConstantSeparate = function (t, e) {
                var n = new s;
                return n._type = 1, n._separateAxes = !0, n._constantMinSeparate = t, n._constantMaxSeparate = e, n
            }, s.createByRandomTwoGradient = function (t, e) {
                var n = new s;
                return n._type = 2, n._separateAxes = !1, n._gradientMin = t, n._gradientMax = e, n
            }, s.createByRandomTwoGradientSeparate = function (t, e, n, i, r, a) {
                var o = new s;
                return o._type = 2, o._separateAxes = !0, o._gradientXMin = t, o._gradientXMax = e, o._gradientYMin = n, o._gradientYMax = i, o._gradientZMin = r, o._gradientZMax = a, o
            }, s
        }(), ve = function () {
            function t() {
                this.alphaMap = null, this.detailID = null, this.normalMap = null
            }

            return d(t, "laya.d3.terrain.unit.ChunkInfo"), t
        }(), ge = function () {
            function t() {
                this.textureID = -1
            }

            return d(t, "laya.d3.shader.ShaderVariable"), t
        }(), Se = function () {
            function t() {
                this._indexInList = 0, this.type = 0, this.fullPath = null, this.propertyOwner = null, this.data = null, this._ownerPath = [], this._propertys = [], this._keyFrames = []
            }

            d(t, "laya.d3.animation.KeyframeNode");
            var e = t.prototype;
            return e._setOwnerPathCount = function (t) {
                this._ownerPath.length = t
            }, e._setOwnerPathByIndex = function (t, e) {
                this._ownerPath[t] = e
            }, e._joinOwnerPath = function (t) {
                return this._ownerPath.join(t)
            }, e._setPropertyCount = function (t) {
                this._propertys.length = t
            }, e._setPropertyByIndex = function (t, e) {
                this._propertys[t] = e
            }, e._joinProperty = function (t) {
                return this._propertys.join(t)
            }, e._setKeyframeCount = function (t) {
                this._keyFrames.length = t
            }, e._setKeyframeByIndex = function (t, e) {
                this._keyFrames[t] = e
            }, e.getOwnerPathByIndex = function (t) {
                return this._ownerPath[t]
            }, e.getPropertyByIndex = function (t) {
                return this._propertys[t]
            }, e.getKeyframeByIndex = function (t) {
                return this._keyFrames[t]
            }, u(0, e, "ownerPathCount", function () {
                return this._ownerPath.length
            }), u(0, e, "propertyCount", function () {
                return this._propertys.length
            }), u(0, e, "keyFramesCount", function () {
                return this._keyFrames.length
            }), t
        }(), ye = function () {
            function s() {
                this._type = 0, this._constant = null, this._gradientX = null, this._gradientY = null, this._gradientZ = null, this._constantMin = null, this._constantMax = null, this._gradientXMin = null, this._gradientXMax = null, this._gradientYMin = null, this._gradientYMax = null, this._gradientZMin = null, this._gradientZMax = null
            }

            d(s, "laya.d3.core.particleShuriKen.module.GradientVelocity");
            var t = s.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.cloneTo = function (t) {
                var e = t;
                e._type = this._type, this._constant.cloneTo(e._constant), this._gradientX.cloneTo(e._gradientX), this._gradientY.cloneTo(e._gradientY), this._gradientZ.cloneTo(e._gradientZ), this._constantMin.cloneTo(e._constantMin), this._constantMax.cloneTo(e._constantMax), this._gradientXMin.cloneTo(e._gradientXMin), this._gradientXMax.cloneTo(e._gradientXMax), this._gradientYMin.cloneTo(e._gradientYMin), this._gradientYMax.cloneTo(e._gradientYMax), this._gradientZMin.cloneTo(e._gradientZMin), this._gradientZMax.cloneTo(e._gradientZMax)
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, t, "gradientZ", function () {
                return this._gradientZ
            }), u(0, t, "constant", function () {
                return this._constant
            }), u(0, t, "type", function () {
                return this._type
            }), u(0, t, "gradientXMax", function () {
                return this._gradientXMax
            }), u(0, t, "constantMin", function () {
                return this._constantMin
            }), u(0, t, "gradientX", function () {
                return this._gradientX
            }), u(0, t, "gradientY", function () {
                return this._gradientY
            }), u(0, t, "gradientXMin", function () {
                return this._gradientXMin
            }), u(0, t, "constantMax", function () {
                return this._constantMax
            }), u(0, t, "gradientYMin", function () {
                return this._gradientYMin
            }), u(0, t, "gradientYMax", function () {
                return this._gradientYMax
            }), u(0, t, "gradientZMin", function () {
                return this._gradientZMin
            }), u(0, t, "gradientZMax", function () {
                return this._gradientZMax
            }), s.createByConstant = function (t) {
                var e = new s;
                return e._type = 0, e._constant = t, e
            }, s.createByGradient = function (t, e, n) {
                var i = new s;
                return i._type = 1, i._gradientX = t, i._gradientY = e, i._gradientZ = n, i
            }, s.createByRandomTwoConstant = function (t, e) {
                var n = new s;
                return n._type = 2, n._constantMin = t, n._constantMax = e, n
            }, s.createByRandomTwoGradient = function (t, e, n, i, r, a) {
                var o = new s;
                return o._type = 3, o._gradientXMin = t, o._gradientXMax = e, o._gradientYMin = n, o._gradientYMax = i, o._gradientZMin = r, o._gradientZMax = a, o
            }, s
        }(), xe = function () {
            function t(t, e) {
                this._updateFlag = 0, this._center = new Lt, this._extent = new Lt, this._boundBox = new ze(new Lt, new Lt), t.cloneTo(this._boundBox.min), e.cloneTo(this._boundBox.max), this._setUpdateFlag(12, !0)
            }

            d(t, "laya.d3.core.Bounds");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.setMin = function (t) {
                var e = this._boundBox.min;
                t !== e && t.cloneTo(e), this._setUpdateFlag(12, !0), this._setUpdateFlag(1, !1)
            }, e.getMin = function () {
                var t = this._boundBox.min;
                return this._getUpdateFlag(1) && (this._getMin(this.getCenter(), this.getExtent(), t), this._setUpdateFlag(1, !1)), t
            }, e.setMax = function (t) {
                var e = this._boundBox.max;
                t !== e && t.cloneTo(e), this._setUpdateFlag(12, !0), this._setUpdateFlag(2, !1)
            }, e.getMax = function () {
                var t = this._boundBox.max;
                return this._getUpdateFlag(2) && (this._getMax(this.getCenter(), this.getExtent(), t), this._setUpdateFlag(2, !1)), t
            }, e.setCenter = function (t) {
                t !== this._center && t.cloneTo(this._center), this._setUpdateFlag(3, !0), this._setUpdateFlag(4, !1)
            }, e.getCenter = function () {
                return this._getUpdateFlag(4) && (this._getCenter(this.getMin(), this.getMax(), this._center), this._setUpdateFlag(4, !1)), this._center
            }, e.setExtent = function (t) {
                t !== this._extent && t.cloneTo(this._extent), this._setUpdateFlag(3, !0), this._setUpdateFlag(8, !1)
            }, e.getExtent = function () {
                return this._getUpdateFlag(8) && (this._getExtent(this.getMin(), this.getMax(), this._extent), this._setUpdateFlag(8, !1)), this._extent
            }, e._getUpdateFlag = function (t) {
                return 0 != (this._updateFlag & t)
            }, e._setUpdateFlag = function (t, e) {
                e ? this._updateFlag |= t : this._updateFlag &= ~t
            }, e._getCenter = function (t, e, n) {
                Lt.add(t, e, n), Lt.scale(n, .5, n)
            }, e._getExtent = function (t, e, n) {
                Lt.subtract(e, t, n), Lt.scale(n, .5, n)
            }, e._getMin = function (t, e, n) {
                Lt.subtract(t, e, n)
            }, e._getMax = function (t, e, n) {
                Lt.add(t, e, n)
            }, e._rotateExtents = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z, o = e.elements;
                n.x = Math.abs(o[0] * i) + Math.abs(o[4] * r) + Math.abs(o[8] * a), n.y = Math.abs(o[1] * i) + Math.abs(o[5] * r) + Math.abs(o[9] * a), n.z = Math.abs(o[2] * i) + Math.abs(o[6] * r) + Math.abs(o[10] * a)
            }, e._tranform = function (t, e) {
                var n = e._center, i = e._extent;
                Lt.transformCoordinate(this.getCenter(), t, n), this._rotateExtents(this.getExtent(), t, i), e._boundBox.setCenterAndExtent(n, i), e._updateFlag = 0
            }, e._getBoundBox = function () {
                var t = this._boundBox.min;
                this._getUpdateFlag(1) && (this._getMin(this.getCenter(), this.getExtent(), t), this._setUpdateFlag(1, !1));
                var e = this._boundBox.max;
                return this._getUpdateFlag(2) && (this._getMax(this.getCenter(), this.getExtent(), e), this._setUpdateFlag(2, !1)), this._boundBox
            }, e.cloneTo = function (t) {
                var e = t;
                this.getMin().cloneTo(e._boundBox.min), this.getMax().cloneTo(e._boundBox.max), this.getCenter().cloneTo(e._center), this.getExtent().cloneTo(e._extent), e._updateFlag = 0
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t._UPDATE_MIN = 1, t._UPDATE_MAX = 2, t._UPDATE_CENTER = 4, t._UPDATE_EXTENT = 8, t
        }(), De = function () {
            function i() {
                this._type = 0, this._constant = NaN, this._constantMin = NaN, this._constantMax = NaN
            }

            d(i, "laya.d3.core.particleShuriKen.module.StartFrame");
            var t = i.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.cloneTo = function (t) {
                var e = t;
                e._type = this._type, e._constant = this._constant, e._constantMin = this._constantMin, e._constantMax = this._constantMax
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, t, "constant", function () {
                return this._constant
            }), u(0, t, "type", function () {
                return this._type
            }), u(0, t, "constantMin", function () {
                return this._constantMin
            }), u(0, t, "constantMax", function () {
                return this._constantMax
            }), i.createByConstant = function (t) {
                var e = new i;
                return e._type = 0, e._constant = t, e
            }, i.createByRandomTwoConstant = function (t, e) {
                var n = new i;
                return n._type = 1, n._constantMin = t, n._constantMax = e, n
            }, i
        }(), Ie = function () {
            function h(t, e, n, i) {
                this._children = [], this.transform = new je(this, t, e, n, i)
            }

            d(h, "laya.d3.animation.AnimationNode");
            var t = h.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.addChild = function (t) {
                t._parent = this, t.transform.setParent(this.transform), this._children.push(t)
            }, t.removeChild = function (t) {
                var e = this._children.indexOf(t);
                -1 !== e && this._children.splice(e, 1)
            }, t.getChildByName = function (t) {
                for (var e = 0, n = this._children.length; e < n; e++) {
                    var i = this._children[e];
                    if (i.name === t) return i
                }
                return null
            }, t.getChildByIndex = function (t) {
                return this._children[t]
            }, t.getChildCount = function () {
                return this._children.length
            }, t.cloneTo = function (t) {
                var e = t;
                e.name = this.name;
                for (var n = 0, i = this._children.length; n < i; n++) {
                    var r = this._children[n], a = r.clone();
                    e.addChild(a);
                    var o = r.transform, s = a.transform, l = s.localPosition, h = s.localRotation, u = s.localScale;
                    o.localPosition.cloneTo(l), o.localRotation.cloneTo(h), o.localScale.cloneTo(u), s.localPosition = l, s.localRotation = h, s.localScale = u
                }
            }, t.clone = function () {
                var t = new h;
                return this.cloneTo(t), t
            }, t._cloneNative = function (t, e, n, i, r, a, o) {
                var s = o._nativeCurCloneCount;
                r[s] = a;
                var l = new h(new Float32Array(t.buffer, 3 * s * 4, 3), new Float32Array(e.buffer, 4 * s * 4, 4), new Float32Array(n.buffer, 3 * s * 4, 3), new Float32Array(i.buffer, 16 * s * 4, 16));
                return l._worldMatrixIndex = s, this._cloneToNative(l, t, e, n, i, r, s, o), l
            }, t._cloneToNative = function (t, e, n, i, r, a, o, s) {
                var l = t;
                l.name = this.name;
                for (var h = 0, u = this._children.length; h < u; h++) {
                    var c = this._children[h];
                    s._nativeCurCloneCount++;
                    var _ = c._cloneNative(e, n, i, r, a, o, s);
                    l.addChild(_);
                    var d = c.transform, f = _.transform, m = f.localPosition, p = f.localRotation, T = f.localScale;
                    d.localPosition.cloneTo(m), d.localRotation.cloneTo(p), d.localScale.cloneTo(T), f.localPosition = m, f.localRotation = p, f.localScale = T
                }
            }, h
        }(), Re = function () {
            function t() {
                this._context = null, this._compositeShader = Pt.find("PostProcessComposite"), this._compositeShaderData = new ot, this._compositeDefineData = new Ut, this._effects = [], this._context = new se, this._context.compositeShaderData = this._compositeShaderData, this._context.compositeDefineData = this._compositeDefineData
            }

            d(t, "laya.d3.component.PostProcess");
            var e = t.prototype;
            return e._init = function (t, e) {
                this._context.camera = t, this._context.command = e
            }, e._render = function () {
                var t = pi.getTemporary(K.clientWidth, K.clientHeight, 0, 3),
                    e = this._context.camera.getRenderTexture();
                this._context.command.clear(), this._context.source = t, this._context.destination = e;
                for (var n = 0, i = this._effects.length; n < i; n++) this._effects[n].render(this._context);
                pi.setReleaseTemporary(t);
                var r = this._context.tempRenderTextures;
                for (n = 0, i = r.length; n < i; n++) pi.setReleaseTemporary(r[n])
            }, e.addEffect = function (t) {
                this._effects.push(t)
            }, e.removeEffect = function (t) {
                var e = this._effects.indexOf(t);
                -1 !== e && this._effects.splice(e, 1)
            }, t.__init__ = function () {
                t.SHADERDEFINE_BLOOM_LOW = t.shaderDefines.registerDefine("BLOOM_LOW"), t.SHADERDEFINE_BLOOM = t.shaderDefines.registerDefine("BLOOM")
            }, t.SHADERDEFINE_BLOOM_LOW = 0, t.SHADERDEFINE_BLOOM = 0, _(t, ["SHADERVALUE_MAINTEX", function () {
                return this.SHADERVALUE_MAINTEX = Pt.propertyNameToID("u_MainTex")
            }, "SHADERVALUE_BLOOMTEX", function () {
                return this.SHADERVALUE_BLOOMTEX = Pt.propertyNameToID("u_BloomTex")
            }, "SHADERVALUE_AUTOEXPOSURETEX", function () {
                return this.SHADERVALUE_AUTOEXPOSURETEX = Pt.propertyNameToID("u_AutoExposureTex")
            }, "SHADERVALUE_BLOOM_DIRTTEX", function () {
                return this.SHADERVALUE_BLOOM_DIRTTEX = Pt.propertyNameToID("u_Bloom_DirtTex")
            }, "SHADERVALUE_BLOOMTEX_TEXELSIZE", function () {
                return this.SHADERVALUE_BLOOMTEX_TEXELSIZE = Pt.propertyNameToID("u_BloomTex_TexelSize")
            }, "SHADERVALUE_BLOOM_DIRTTILEOFFSET", function () {
                return this.SHADERVALUE_BLOOM_DIRTTILEOFFSET = Pt.propertyNameToID("u_Bloom_DirtTileOffset")
            }, "SHADERVALUE_BLOOM_SETTINGS", function () {
                return this.SHADERVALUE_BLOOM_SETTINGS = Pt.propertyNameToID("u_Bloom_Settings")
            }, "SHADERVALUE_BLOOM_COLOR", function () {
                return this.SHADERVALUE_BLOOM_COLOR = Pt.propertyNameToID("u_Bloom_Color")
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut
            }]), t
        }(), Me = function () {
            function a(t, e, n, i) {
                this.minDepth = 0, this.maxDepth = 1, this.x = t, this.y = e, this.width = n, this.height = i
            }

            d(a, "laya.d3.math.Viewport");
            var t = a.prototype;
            return t.project = function (t, e, n) {
                Lt.transformV3ToV3(t, e, n);
                var i = e.elements, r = t.x * i[3] + t.y * i[7] + t.z * i[11] + i[15];
                1 !== r && (n.x = n.x / r, n.y = n.y / r, n.z = n.z / r), n.x = .5 * (n.x + 1) * this.width + this.x, n.y = .5 * (1 - n.y) * this.height + this.y, n.z = n.z * (this.maxDepth - this.minDepth) + this.minDepth
            }, t.project1 = function (t, e, n) {
                var i = Lt._tempVector4;
                Lt.transformV3ToV4(t, e, i);
                var r = i.w;
                r < .1 && -1e-6 < r && (r = 1e-6), i.x /= r, i.y /= r, i.z /= r, n.x = (i.x + 1) * this.width / 2 + this.x, n.y = (1 - i.y) * this.height / 2 + this.y, n.z = i.w
            }, t.unprojectFromMat = function (t, e, n) {
                var i = e.elements;
                n.x = (t.x - this.x) / this.width * 2 - 1, n.y = -((t.y - this.y) / this.height * 2 - 1);
                var r = (this.maxDepth - this.minDepth) / 2;
                n.z = (t.z - this.minDepth - r) / r;
                var a = n.x * i[3] + n.y * i[7] + n.z * i[11] + i[15];
                Lt.transformV3ToV3(n, e, n), 1 !== a && (n.x = n.x / a, n.y = n.y / a, n.z = n.z / a)
            }, t.unprojectFromWVP = function (t, e, n, i, r) {
                He.multiply(e, n, a._tempMatrix4x4), i && He.multiply(a._tempMatrix4x4, i, a._tempMatrix4x4), a._tempMatrix4x4.invert(a._tempMatrix4x4), this.unprojectFromMat(t, a._tempMatrix4x4, r)
            }, t.cloneTo = function (t) {
                t.x = this.x, t.y = this.y, t.width = this.width, t.height = this.height, t.minDepth = this.minDepth, t.maxDepth = this.maxDepth
            }, _(a, ["_tempMatrix4x4", function () {
                return this._tempMatrix4x4 = new He
            }]), a
        }(), Ae = function () {
            function t() {
                this.diffuseTexture = null, this.normalTexture = null, this.scale = null, this.offset = null
            }

            return d(t, "laya.d3.terrain.unit.DetailTextureInfo"), t
        }(), Ce = (function () {
            function m(t, e) {
                this.extents = null, this.transformation = null, this.extents = t, this.transformation = e
            }

            d(m, "laya.d3.math.OrientedBoundBox");
            var t = m.prototype;
            t.getCorners = function (t) {
                m._tempV30.x = this.extents.x, m._tempV30.y = m._tempV30.z = 0, m._tempV31.y = this.extents.y, m._tempV31.x = m._tempV31.z = 0, m._tempV32.z = this.extents.z, m._tempV32.x = m._tempV32.y = 0, Lt.TransformNormal(m._tempV30, this.transformation, m._tempV30), Lt.TransformNormal(m._tempV31, this.transformation, m._tempV31), Lt.TransformNormal(m._tempV32, this.transformation, m._tempV32);
                var e = m._tempV33;
                this.transformation.getTranslationVector(e), t.length = 8, Lt.add(e, m._tempV30, m._tempV34), Lt.add(m._tempV34, m._tempV31, m._tempV34), Lt.add(m._tempV34, m._tempV32, t[0]), Lt.add(e, m._tempV30, m._tempV34), Lt.add(m._tempV34, m._tempV31, m._tempV34), Lt.subtract(m._tempV34, m._tempV32, t[1]), Lt.subtract(e, m._tempV30, m._tempV34), Lt.add(m._tempV34, m._tempV31, m._tempV34), Lt.subtract(m._tempV34, m._tempV32, t[2]), Lt.subtract(e, m._tempV30, m._tempV34), Lt.add(m._tempV34, m._tempV31, m._tempV34), Lt.add(m._tempV34, m._tempV32, t[3]), Lt.add(e, m._tempV30, m._tempV34), Lt.subtract(m._tempV34, m._tempV31, m._tempV34), Lt.add(m._tempV34, m._tempV32, t[4]), Lt.add(e, m._tempV30, m._tempV34), Lt.subtract(m._tempV34, m._tempV31, m._tempV34), Lt.subtract(m._tempV34, m._tempV32, t[5]), Lt.subtract(e, m._tempV30, m._tempV34), Lt.subtract(m._tempV34, m._tempV31, m._tempV34), Lt.subtract(m._tempV34, m._tempV32, t[6]), Lt.subtract(e, m._tempV30, m._tempV34), Lt.subtract(m._tempV34, m._tempV31, m._tempV34), Lt.add(m._tempV34, m._tempV32, t[7])
            }, t.transform = function (t) {
                He.multiply(this.transformation, t, this.transformation)
            }, t.scale = function (t) {
                Lt.multiply(this.extents, t, this.extents)
            }, t.translate = function (t) {
                this.transformation.getTranslationVector(m._tempV30), Lt.add(m._tempV30, t, m._tempV31), this.transformation.setTranslationVector(m._tempV31)
            }, t.Size = function (t) {
                Lt.scale(this.extents, 2, t)
            }, t.getSize = function (t) {
                m._tempV30.x = this.extents.x, m._tempV31.y = this.extents.y, m._tempV32.z = this.extents.z, Lt.TransformNormal(m._tempV30, this.transformation, m._tempV30), Lt.TransformNormal(m._tempV31, this.transformation, m._tempV31), Lt.TransformNormal(m._tempV31, this.transformation, m._tempV32), t.x = Lt.scalarLength(m._tempV30), t.y = Lt.scalarLength(m._tempV31), t.z = Lt.scalarLength(m._tempV32)
            }, t.getSizeSquared = function (t) {
                m._tempV30.x = this.extents.x, m._tempV31.y = this.extents.y, m._tempV32.z = this.extents.z, Lt.TransformNormal(m._tempV30, this.transformation, m._tempV30), Lt.TransformNormal(m._tempV31, this.transformation, m._tempV31), Lt.TransformNormal(m._tempV31, this.transformation, m._tempV32), t.x = Lt.scalarLengthSquared(m._tempV30), t.y = Lt.scalarLengthSquared(m._tempV31), t.z = Lt.scalarLengthSquared(m._tempV32)
            }, t.getCenter = function (t) {
                this.transformation.getTranslationVector(t)
            }, t.containsPoint = function (t) {
                var e = this.extents.x, n = this.extents.y, i = this.extents.z;
                this.transformation.invert(m._tempM0), Lt.transformCoordinate(t, m._tempM0, m._tempV30);
                var r = Math.abs(m._tempV30.x), a = Math.abs(m._tempV30.y), o = Math.abs(m._tempV30.z);
                return tt.nearEqual(r, e) && tt.nearEqual(a, n) && tt.nearEqual(o, i) ? 2 : r < e && a < n && o < i ? 1 : 0
            }, t.containsPoints = function (t) {
                var e = this.extents.x, n = this.extents.y, i = this.extents.z;
                this.transformation.invert(m._tempM0);
                for (var r = !0, a = !1, o = 0; o < t.length; o++) {
                    Lt.transformCoordinate(t[o], m._tempM0, m._tempV30);
                    var s = Math.abs(m._tempV30.x), l = Math.abs(m._tempV30.y), h = Math.abs(m._tempV30.z);
                    tt.nearEqual(s, e) && tt.nearEqual(l, n) && tt.nearEqual(h, i) && (a = !0), s < e && l < n && h < i ? a = !0 : r = !1
                }
                return r ? 1 : a ? 2 : 0
            }, t.containsSphere = function (t, e) {
                void 0 === e && (e = !1);
                var n = this.extents.x, i = this.extents.y, r = this.extents.z, a = t.radius;
                this.transformation.invert(m._tempM0), Lt.transformCoordinate(t.center, m._tempM0, m._tempV30);
                var o = NaN;
                if (o = e ? a : (Lt.scale(Lt._UnitX, a, m._tempV31), Lt.TransformNormal(m._tempV31, m._tempM0, m._tempV31), Lt.scalarLength(m._tempV31)), Lt.scale(this.extents, -1, m._tempV32), Lt.Clamp(m._tempV30, m._tempV32, this.extents, m._tempV33), o * o < Lt.distanceSquared(m._tempV30, m._tempV33)) return 0;
                var s = m._tempV30.x, l = m._tempV30.y, h = m._tempV30.z, u = m._tempV32.x, c = m._tempV32.y,
                    _ = m._tempV32.z;
                return u + o <= s && s <= n - o && o < n - u && c + o <= l && l <= i - o && o < i - c && _ + o <= h && h <= r - o && o < r - _ ? 1 : 2
            }, t.containsOrientedBoundBox = function (t) {
                var e = 0, n = 0;
                t.getCorners(m._corners);
                var i = this.containsPoints(m._corners);
                if (0 != i) return i;
                m._sizeAe[0] = this.extents.x, m._sizeAe[1] = this.extents.y, m._sizeAe[2] = this.extents.z, t.extents.cloneTo(m._tempV35), m._sizeBe[0] = m._tempV35.x, m._sizeBe[1] = m._tempV35.y, m._sizeBe[2] = m._tempV35.z, m._getRows(this.transformation, m._rows1), m._getRows(t.transformation, m._rows2);
                var r = NaN;
                for (e = 0; e < 4; e++) for (n = 0; n < 4; n++) 3 == e || 3 == n ? (m._tempM0.setElementByRowColumn(e, n, 0), m._tempM1.setElementByRowColumn(e, n, 0)) : (r = Lt.dot(m._rows1[e], m._rows2[n]), m._tempM0.setElementByRowColumn(e, n, r), m._tempM1.setElementByRowColumn(e, n, Math.abs(r)));
                for (t.getCenter(m._tempV34), this.getCenter(m._tempV36), Lt.subtract(m._tempV34, m._tempV36, m._tempV30), m._tempV31.x = Lt.dot(m._tempV30, m._rows1[0]), m._tempV31.y = Lt.dot(m._tempV30, m._rows1[1]), m._tempV31.z = Lt.dot(m._tempV30, m._rows1[2]), m._vsepAe[0] = m._tempV31.x, m._vsepAe[1] = m._tempV31.y, m._vsepAe[2] = m._tempV31.z, e = 0; e < 3; e++) if (m._tempV32.x = m._tempM1.getElementByRowColumn(e, 0), m._tempV32.y = m._tempM1.getElementByRowColumn(e, 1), m._tempV32.z = m._tempM1.getElementByRowColumn(e, 2), m._sizeAe[e] + Lt.dot(m._tempV35, m._tempV32) < Math.abs(m._vsepAe[e])) return 0;
                for (n = 0; n < 3; n++) if (m._tempV32.x = m._tempM1.getElementByRowColumn(0, n), m._tempV32.y = m._tempM1.getElementByRowColumn(1, n), m._tempV32.z = m._tempM1.getElementByRowColumn(2, n), m._tempV33.x = m._tempM0.getElementByRowColumn(0, n), m._tempV33.y = m._tempM0.getElementByRowColumn(1, n), m._tempV33.z = m._tempM0.getElementByRowColumn(2, n), Lt.dot(this.extents, m._tempV32) + m._sizeBe[n] < Math.abs(Lt.dot(m._tempV31, m._tempV33))) return 0;
                for (e = 0; e < 3; e++) for (n = 0; n < 3; n++) {
                    var a = (e + 1) % 3, o = (e + 2) % 3, s = (n + 1) % 3, l = (n + 2) % 3;
                    if (m._sizeAe[a] * m._tempM1.getElementByRowColumn(o, n) + m._sizeAe[o] * m._tempM1.getElementByRowColumn(a, n) + (m._sizeBe[s] * m._tempM1.getElementByRowColumn(e, l) + m._sizeBe[l] * m._tempM1.getElementByRowColumn(e, s)) < Math.abs(m._vsepAe[o] * m._tempM0.getElementByRowColumn(a, n) - m._vsepAe[a] * m._tempM0.getElementByRowColumn(o, n))) return 0
                }
                return 2
            }, t.containsLine = function (t, e) {
                m._corners[0] = t, m._corners[1] = e;
                var n = this.containsPoints(m._corners);
                if (0 != n) return n;
                var i = this.extents.x, r = this.extents.y, a = this.extents.z;
                this.transformation.invert(m._tempM0), Lt.transformCoordinate(t, m._tempM0, m._tempV30), Lt.transformCoordinate(e, m._tempM0, m._tempV31), Lt.add(m._tempV30, m._tempV31, m._tempV32), Lt.scale(m._tempV32, .5, m._tempV32), Lt.subtract(m._tempV30, m._tempV32, m._tempV33);
                var o = m._tempV33.x, s = m._tempV33.y, l = m._tempV33.z, h = m._tempV34.x = Math.abs(m._tempV33.x),
                    u = m._tempV34.y = Math.abs(m._tempV33.y), c = m._tempV34.z = Math.abs(m._tempV33.z),
                    _ = m._tempV32.x, d = m._tempV32.y, f = m._tempV32.z;
                return Math.abs(_) > i + h ? 0 : Math.abs(d) > r + u ? 0 : Math.abs(f) > a + c ? 0 : Math.abs(d * l - f * s) > r * c + a * u ? 0 : Math.abs(_ * l - f * o) > i * c + a * h ? 0 : Math.abs(_ * s - d * o) > i * u + r * h ? 0 : 2
            }, t.containsBoundBox = function (t) {
                var e = 0, n = 0, i = t.min, r = t.max;
                t.getCorners(m._corners);
                var a = this.containsPoints(m._corners);
                if (0 != a) return a;
                Lt.subtract(r, i, m._tempV30), Lt.scale(m._tempV30, .5, m._tempV30), Lt.add(i, m._tempV30, m._tempV30), Lt.subtract(r, m._tempV30, m._tempV31), m._sizeAe[0] = this.extents.x, m._sizeAe[1] = this.extents.y, m._sizeAe[2] = this.extents.z, m._sizeBe[0] = m._tempV31.x, m._sizeBe[1] = m._tempV31.y, m._sizeBe[2] = m._tempV31.z, m._getRows(this.transformation, m._rows1), this.transformation.invert(m._tempM0);
                for (e = 0; e < 3; e++) for (n = 0; n < 3; n++) m._tempM1.setElementByRowColumn(e, n, Math.abs(m._tempM0.getElementByRowColumn(e, n)));
                for (this.getCenter(m._tempV35), Lt.subtract(m._tempV30, m._tempV35, m._tempV32), m._tempV31.x = Lt.dot(m._tempV32, m._rows1[0]), m._tempV31.y = Lt.dot(m._tempV32, m._rows1[1]), m._tempV31.z = Lt.dot(m._tempV32, m._rows1[2]), m._vsepAe[0] = m._tempV31.x, m._vsepAe[1] = m._tempV31.y, m._vsepAe[2] = m._tempV31.z, e = 0; e < 3; e++) if (m._tempV33.x = m._tempM1.getElementByRowColumn(e, 0), m._tempV33.y = m._tempM1.getElementByRowColumn(e, 1), m._tempV33.z = m._tempM1.getElementByRowColumn(e, 2), m._sizeAe[e] + Lt.dot(m._tempV31, m._tempV33) < Math.abs(m._vsepAe[e])) return 0;
                for (n = 0; n < 3; n++) if (m._tempV33.x = m._tempM1.getElementByRowColumn(0, n), m._tempV33.y = m._tempM1.getElementByRowColumn(1, n), m._tempV33.z = m._tempM1.getElementByRowColumn(2, n), m._tempV34.x = m._tempM0.getElementByRowColumn(0, n), m._tempV34.y = m._tempM0.getElementByRowColumn(1, n), m._tempV34.z = m._tempM0.getElementByRowColumn(2, n), Lt.dot(this.extents, m._tempV33) + m._sizeBe[n] < Math.abs(Lt.dot(m._tempV31, m._tempV34))) return 0;
                for (e = 0; e < 3; e++) for (n = 0; n < 3; n++) {
                    var o = (e + 1) % 3, s = (e + 2) % 3, l = (n + 1) % 3, h = (n + 2) % 3;
                    if (m._sizeAe[o] * m._tempM1.getElementByRowColumn(s, n) + m._sizeAe[s] * m._tempM1.getElementByRowColumn(o, n) + (m._sizeBe[l] * m._tempM1.getElementByRowColumn(e, h) + m._sizeBe[h] * m._tempM1.getElementByRowColumn(e, l)) < Math.abs(m._vsepAe[s] * m._tempM0.getElementByRowColumn(o, n) - m._vsepAe[o] * m._tempM0.getElementByRowColumn(s, n))) return 0
                }
                return 2
            }, t.intersectsRay = function (t, e) {
                Lt.scale(this.extents, -1, m._tempV30), this.transformation.invert(m._tempM0), Lt.TransformNormal(t.direction, m._tempM0, m._ray.direction), Lt.transformCoordinate(t.origin, m._tempM0, m._ray.origin), m._boxBound1.min = m._tempV30, m._boxBound1.max = this.extents;
                var n = Fe.intersectsRayAndBoxRP(m._ray, m._boxBound1, e);
                return -1 !== n && Lt.transformCoordinate(e, this.transformation, e), n
            }, t._getLocalCorners = function (t) {
                t.length = 8, m._tempV30.x = this.extents.x, m._tempV31.y = this.extents.y, m._tempV32.z = this.extents.z, Lt.add(m._tempV30, m._tempV31, m._tempV33), Lt.add(m._tempV33, m._tempV32, t[0]), Lt.add(m._tempV30, m._tempV31, m._tempV33), Lt.subtract(m._tempV33, m._tempV32, t[1]), Lt.subtract(m._tempV31, m._tempV30, m._tempV33), Lt.subtract(m._tempV33, m._tempV30, t[2]), Lt.subtract(m._tempV31, m._tempV30, m._tempV33), Lt.add(m._tempV33, m._tempV32, t[3]), Lt.subtract(m._tempV30, m._tempV31, m._tempV33), Lt.add(m._tempV33, m._tempV32, t[4]), Lt.subtract(m._tempV30, m._tempV31, m._tempV33), Lt.subtract(m._tempV33, m._tempV32, t[5]), Lt.scale(t[0], -1, t[6]), Lt.subtract(m._tempV32, m._tempV30, m._tempV33), Lt.subtract(m._tempV33, m._tempV31, t[7])
            }, t.equals = function (t) {
                return this.extents == t.extents && this.transformation == t.transformation
            }, t.cloneTo = function (t) {
                var e = t;
                this.extents.cloneTo(e.extents), this.transformation.cloneTo(e.transformation)
            }, m.createByBoundBox = function (t, e) {
                var n = t.min, i = t.max;
                Lt.subtract(i, n, m._tempV30), Lt.scale(m._tempV30, .5, m._tempV30), Lt.add(n, m._tempV30, m._tempV31), Lt.subtract(i, m._tempV31, m._tempV32), He.translation(m._tempV31, m._tempM0);
                var r = m._tempV32.clone(), a = m._tempM0.clone();
                e.extents = r, e.transformation = a
            }, m.createByMinAndMaxVertex = function (t, e) {
                return Lt.subtract(e, t, m._tempV30), Lt.scale(m._tempV30, .5, m._tempV30), Lt.add(t, m._tempV30, m._tempV31), Lt.subtract(e, m._tempV31, m._tempV32), He.translation(m._tempV31, m._tempM0), new m(m._tempV32, m._tempM0)
            }, m._getRows = function (t, e) {
                e.length = 3;
                var n = t.elements;
                e[0].x = n[0], e[0].y = n[1], e[0].z = n[2], e[1].x = n[4], e[1].y = n[5], e[1].z = n[6], e[2].x = n[8], e[2].y = n[9], e[2].z = n[10]
            }, m.getObbtoObbMatrix4x4 = function (t, e, n, i) {
                var r = t.transformation, a = e.transformation;
                if (n) {
                    m._getRows(r, m._rows1), m._getRows(a, m._rows2);
                    for (var o = 0; o < 3; o++) for (var s = 0; s < 3; s++) i.setElementByRowColumn(o, s, Lt.dot(m._rows2[o], m._rows1[s]));
                    e.getCenter(m._tempV30), t.getCenter(m._tempV31), Lt.subtract(m._tempV30, m._tempV31, m._tempV32);
                    var l = i.elements;
                    l[12] = Lt.dot(m._tempV32, m._rows1[0]), l[13] = Lt.dot(m._tempV32, m._rows1[1]), l[14] = Lt.dot(m._tempV32, m._rows1[2]), l[15] = 1
                } else r.invert(m._tempM0), He.multiply(a, m._tempM0, i)
            }, m.merge = function (t, e, n) {
                var i = t.extents, r = t.transformation;
                m.getObbtoObbMatrix4x4(t, e, n, m._tempM0), e._getLocalCorners(m._corners), Lt.transformCoordinate(m._corners[0], m._tempM0, m._corners[0]), Lt.transformCoordinate(m._corners[1], m._tempM0, m._corners[1]), Lt.transformCoordinate(m._corners[2], m._tempM0, m._corners[2]), Lt.transformCoordinate(m._corners[3], m._tempM0, m._corners[3]), Lt.transformCoordinate(m._corners[4], m._tempM0, m._corners[4]), Lt.transformCoordinate(m._corners[5], m._tempM0, m._corners[5]), Lt.transformCoordinate(m._corners[6], m._tempM0, m._corners[6]), Lt.transformCoordinate(m._corners[7], m._tempM0, m._corners[7]), Lt.scale(i, -1, m._boxBound1.min), i.cloneTo(m._boxBound1.max), ze.createfromPoints(m._corners, m._boxBound2), ze.merge(m._boxBound2, m._boxBound1, m._boxBound3);
                var a = m._boxBound3.min, o = m._boxBound3.max;
                Lt.subtract(o, a, m._tempV30), Lt.scale(m._tempV30, .5, m._tempV30), Lt.add(a, m._tempV30, m._tempV32), Lt.subtract(o, m._tempV32, i), Lt.transformCoordinate(m._tempV32, r, m._tempV33)
            }, _(m, ["_tempV30", function () {
                return this._tempV30 = new Lt
            }, "_tempV31", function () {
                return this._tempV31 = new Lt
            }, "_tempV32", function () {
                return this._tempV32 = new Lt
            }, "_tempV33", function () {
                return this._tempV33 = new Lt
            }, "_tempV34", function () {
                return this._tempV34 = new Lt
            }, "_tempV35", function () {
                return this._tempV35 = new Lt
            }, "_tempV36", function () {
                return this._tempV36 = new Lt
            }, "_tempM0", function () {
                return this._tempM0 = new He
            }, "_tempM1", function () {
                return this._tempM1 = new He
            }, "_corners", function () {
                return this._corners = [new Lt, new Lt, new Lt, new Lt, new Lt, new Lt, new Lt, new Lt]
            }, "_rows1", function () {
                return this._rows1 = [new Lt, new Lt, new Lt]
            }, "_rows2", function () {
                return this._rows2 = [new Lt, new Lt, new Lt]
            }, "_ray", function () {
                return this._ray = new W(new Lt, new Lt)
            }, "_boxBound1", function () {
                return this._boxBound1 = new ze(new Lt, new Lt)
            }, "_boxBound2", function () {
                return this._boxBound2 = new ze(new Lt, new Lt)
            }, "_boxBound3", function () {
                return this._boxBound3 = new ze(new Lt, new Lt)
            }, "_vsepAe", function () {
                return this._vsepAe = new Float32Array
            }, "_sizeBe", function () {
                return this._sizeBe = new Float32Array
            }, "_sizeAe", function () {
                return this._sizeAe = new Float32Array
            }])
        }(), function () {
            function t(t) {
                void 0 === t && (t = !1), this.isTransparent = t, this.elements = []
            }

            d(t, "laya.d3.core.render.RenderQueue");
            var e = t.prototype;
            return e._compare = function (t, e) {
                var n = t.material.renderQueue - e.material.renderQueue;
                return 0 !== n ? n : (this.isTransparent ? e.render._distanceForSort - t.render._distanceForSort : t.render._distanceForSort - e.render._distanceForSort) + e.render.sortingFudge - t.render.sortingFudge
            }, e._partitionRenderObject = function (t, e) {
                for (var n = this.elements[Math.floor((e + t) / 2)]; t <= e;) {
                    for (; this._compare(this.elements[t], n) < 0;) t++;
                    for (; 0 < this._compare(this.elements[e], n);) e--;
                    if (t < e) {
                        var i = this.elements[t];
                        this.elements[t] = this.elements[e], this.elements[e] = i, t++, e--
                    } else if (t === e) {
                        t++;
                        break
                    }
                }
                return t
            }, e._quickSort = function (t, e) {
                if (1 < this.elements.length) {
                    var n = this._partitionRenderObject(t, e), i = n - 1;
                    t < i && this._quickSort(t, i), n < e && this._quickSort(n, e)
                }
            }, e._render = function (t, e, n, i) {
                for (var r = 0, a = this.elements.length; r < a; r++) this.elements[r]._render(t, e, n, i)
            }, e.clear = function () {
                this.elements.length = 0, this.lastTransparentRenderElement = null, this.lastTransparentBatched = !1
            }, t
        }()), Le = (function () {
            function t() {
            }

            d(t, "laya.d3.core.TextureMode"), t.Stretch = 0, t.Tile = 1
        }(), function () {
            function t() {
            }

            d(t, "laya.d3.physics.shape.HeightfieldColliderShape")
        }(), function () {
            function r() {
            }

            return d(r, "laya.d3.core.particleShuriKen.module.shape.ShapeUtils"), r._randomPointUnitArcCircle = function (t, e, n) {
                var i = NaN;
                i = n ? n.getFloat() * t : Math.random() * t, e.x = Math.cos(i), e.y = Math.sin(i)
            }, r._randomPointInsideUnitArcCircle = function (t, e, n) {
                r._randomPointUnitArcCircle(t, e, n);
                var i = NaN;
                i = n ? Math.pow(n.getFloat(), .5) : Math.pow(Math.random(), .5), e.x = e.x * i, e.y = e.y * i
            }, r._randomPointUnitCircle = function (t, e) {
                var n = NaN;
                n = e ? e.getFloat() * Math.PI * 2 : Math.random() * Math.PI * 2, t.x = Math.cos(n), t.y = Math.sin(n)
            }, r._randomPointInsideUnitCircle = function (t, e) {
                r._randomPointUnitCircle(t);
                var n = NaN;
                n = e ? Math.pow(e.getFloat(), .5) : Math.pow(Math.random(), .5), t.x = t.x * n, t.y = t.y * n
            }, r._randomPointUnitSphere = function (t, e) {
                var n = NaN, i = NaN;
                i = e ? (n = t.z = 2 * e.getFloat() - 1, e.getFloat() * Math.PI * 2) : (n = t.z = 2 * Math.random() - 1, Math.random() * Math.PI * 2);
                var r = Math.sqrt(1 - n * n);
                t.x = r * Math.cos(i), t.y = r * Math.sin(i)
            }, r._randomPointInsideUnitSphere = function (t, e) {
                r._randomPointUnitSphere(t);
                var n = NaN;
                n = e ? Math.pow(e.getFloat(), 1 / 3) : Math.pow(Math.random(), 1 / 3), t.x = t.x * n, t.y = t.y * n, t.z = t.z * n
            }, r._randomPointInsideHalfUnitBox = function (t, e) {
                t.z = e ? (t.x = e.getFloat() - .5, t.y = e.getFloat() - .5, e.getFloat() - .5) : (t.x = Math.random() - .5, t.y = Math.random() - .5, Math.random() - .5)
            }, r
        }()), Oe = function () {
            function n() {
            }

            return d(n, "laya.d3.graphics.VertexElementFormat"), n.getElementInfos = function (t) {
                var e = n._elementInfos[t];
                if (e) return e;
                throw"VertexElementFormat: this vertexElementFormat is not implement."
            }, n.Single = "single", n.Vector2 = "vector2", n.Vector3 = "vector3", n.Vector4 = "vector4", n.Color = "color", n.Byte4 = "byte4", n.Short2 = "short2", n.Short4 = "short4", n.NormalizedShort2 = "normalizedshort2", n.NormalizedShort4 = "normalizedshort4", n.HalfVector2 = "halfvector2", n.HalfVector4 = "halfvector4", _(n, ["_elementInfos", function () {
                return this._elementInfos = {
                    single: [1, 5126, 0],
                    vector2: [2, 5126, 0],
                    vector3: [3, 5126, 0],
                    vector4: [4, 5126, 0],
                    color: [4, 5126, 0],
                    byte4: [4, 5121, 0],
                    short2: [2, 5126, 0],
                    short4: [4, 5126, 0],
                    normalizedshort2: [2, 5126, 0],
                    normalizedshort4: [4, 5126, 0],
                    halfvector2: [2, 5126, 0],
                    halfvector4: [4, 5126, 0]
                }
            }]), n
        }(), Ne = function () {
            function t(t) {
                this._angularVelocity = null, this.enbale = !1, this._angularVelocity = t
            }

            d(t, "laya.d3.core.particleShuriKen.module.RotationOverLifetime");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.cloneTo = function (t) {
                var e = t;
                this._angularVelocity.cloneTo(e._angularVelocity), e.enbale = this.enbale
            }, e.clone = function () {
                var t;
                switch (this._angularVelocity.type) {
                    case 0:
                        t = this._angularVelocity.separateAxes ? he.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()) : he.createByConstant(this._angularVelocity.constant);
                        break;
                    case 1:
                        t = this._angularVelocity.separateAxes ? he.createByGradientSeparate(this._angularVelocity.gradientX.clone(), this._angularVelocity.gradientY.clone(), this._angularVelocity.gradientZ.clone()) : he.createByGradient(this._angularVelocity.gradient.clone());
                        break;
                    case 2:
                        t = this._angularVelocity.separateAxes ? he.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(), this._angularVelocity.constantMaxSeparate.clone()) : he.createByRandomTwoConstant(this._angularVelocity.constantMin, this._angularVelocity.constantMax);
                        break;
                    case 3:
                        t = this._angularVelocity.separateAxes ? he.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(), this._angularVelocity.gradientYMin.clone(), this._angularVelocity.gradientZMin.clone(), this._angularVelocity.gradientWMin.clone(), this._angularVelocity.gradientXMax.clone(), this._angularVelocity.gradientYMax.clone(), this._angularVelocity.gradientZMax.clone(), this._angularVelocity.gradientWMax.clone()) : he.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(), this._angularVelocity.gradientMax.clone())
                }
                var e = new this.constructor(t);
                return e.enbale = this.enbale, e
            }, u(0, e, "angularVelocity", function () {
                return this._angularVelocity
            }), t
        }(), Ve = function () {
            function h(t) {
                this._matrix = null, this._near = null, this._far = null, this._left = null, this._right = null, this._top = null, this._bottom = null, this._matrix = t, this._near = new nt(new Lt), this._far = new nt(new Lt), this._left = new nt(new Lt), this._right = new nt(new Lt), this._top = new nt(new Lt), this._bottom = new nt(new Lt), h._getPlanesFromMatrix(this._matrix, this._near, this._far, this._left, this._right, this._top, this._bottom)
            }

            d(h, "laya.d3.math.BoundFrustum");
            var t = h.prototype;
            return t.equalsBoundFrustum = function (t) {
                return this._matrix.equalsOtherMatrix(t.matrix)
            }, t.equalsObj = function (t) {
                if (t instanceof laya.d3.math.BoundFrustum) {
                    var e = t;
                    return this.equalsBoundFrustum(e)
                }
                return !1
            }, t.getPlane = function (t) {
                switch (t) {
                    case 0:
                        return this._near;
                    case 1:
                        return this._far;
                    case 2:
                        return this._left;
                    case 3:
                        return this._right;
                    case 4:
                        return this._top;
                    case 5:
                        return this._bottom;
                    default:
                        return null
                }
            }, t.getCorners = function (t) {
                h._get3PlaneInterPoint(this._near, this._bottom, this._right).cloneTo(t[0]), h._get3PlaneInterPoint(this._near, this._top, this._right).cloneTo(t[1]), h._get3PlaneInterPoint(this._near, this._top, this._left).cloneTo(t[2]), h._get3PlaneInterPoint(this._near, this._bottom, this._left).cloneTo(t[3]), h._get3PlaneInterPoint(this._far, this._bottom, this._right).cloneTo(t[4]), h._get3PlaneInterPoint(this._far, this._top, this._right).cloneTo(t[5]), h._get3PlaneInterPoint(this._far, this._top, this._left).cloneTo(t[6]), h._get3PlaneInterPoint(this._far, this._bottom, this._left).cloneTo(t[7])
            }, t.containsPoint = function (t) {
                for (var e = nt.PlaneIntersectionType_Front, n = nt.PlaneIntersectionType_Front, i = 0; i < 6; i++) {
                    switch (i) {
                        case 0:
                            n = Fe.intersectsPlaneAndPoint(this._near, t);
                            break;
                        case 1:
                            n = Fe.intersectsPlaneAndPoint(this._far, t);
                            break;
                        case 2:
                            n = Fe.intersectsPlaneAndPoint(this._left, t);
                            break;
                        case 3:
                            n = Fe.intersectsPlaneAndPoint(this._right, t);
                            break;
                        case 4:
                            n = Fe.intersectsPlaneAndPoint(this._top, t);
                            break;
                        case 5:
                            n = Fe.intersectsPlaneAndPoint(this._bottom, t)
                    }
                    switch (n) {
                        case nt.PlaneIntersectionType_Back:
                            return 0;
                        case nt.PlaneIntersectionType_Intersecting:
                            e = nt.PlaneIntersectionType_Intersecting
                    }
                }
                switch (e) {
                    case nt.PlaneIntersectionType_Intersecting:
                        return 2;
                    default:
                        return 1
                }
            }, t.containsBoundBox = function (t) {
                for (var e = h._tempV30, n = h._tempV31, i = t.min, r = t.max, a = 1, o = 0; o < 6; o++) {
                    var s = this.getPlane(o), l = s.normal;
                    if (0 <= l.x ? (e.x = r.x, n.x = i.x) : (e.x = i.x, n.x = r.x), 0 <= l.y ? (e.y = r.y, n.y = i.y) : (e.y = i.y, n.y = r.y), 0 <= l.z ? (e.z = r.z, n.z = i.z) : (e.z = i.z, n.z = r.z), Fe.intersectsPlaneAndPoint(s, e) === nt.PlaneIntersectionType_Back) return 0;
                    Fe.intersectsPlaneAndPoint(s, n) === nt.PlaneIntersectionType_Back && (a = 2)
                }
                return a
            }, t.containsBoundSphere = function (t) {
                for (var e = nt.PlaneIntersectionType_Front, n = nt.PlaneIntersectionType_Front, i = 0; i < 6; i++) {
                    switch (i) {
                        case 0:
                            n = Fe.intersectsPlaneAndSphere(this._near, t);
                            break;
                        case 1:
                            n = Fe.intersectsPlaneAndSphere(this._far, t);
                            break;
                        case 2:
                            n = Fe.intersectsPlaneAndSphere(this._left, t);
                            break;
                        case 3:
                            n = Fe.intersectsPlaneAndSphere(this._right, t);
                            break;
                        case 4:
                            n = Fe.intersectsPlaneAndSphere(this._top, t);
                            break;
                        case 5:
                            n = Fe.intersectsPlaneAndSphere(this._bottom, t)
                    }
                    switch (n) {
                        case nt.PlaneIntersectionType_Back:
                            return 0;
                        case nt.PlaneIntersectionType_Intersecting:
                            e = nt.PlaneIntersectionType_Intersecting
                    }
                }
                switch (e) {
                    case nt.PlaneIntersectionType_Intersecting:
                        return 2;
                    default:
                        return 1
                }
            }, u(0, t, "top", function () {
                return this._top
            }), u(0, t, "matrix", function () {
                return this._matrix
            }, function (t) {
                this._matrix = t, h._getPlanesFromMatrix(this._matrix, this._near, this._far, this._left, this._right, this._top, this._bottom)
            }), u(0, t, "near", function () {
                return this._near
            }), u(0, t, "far", function () {
                return this._far
            }), u(0, t, "left", function () {
                return this._left
            }), u(0, t, "right", function () {
                return this._right
            }), u(0, t, "bottom", function () {
                return this._bottom
            }), h._getPlanesFromMatrix = function (t, e, n, i, r, a, o) {
                var s = t.elements, l = s[0], h = s[1], u = s[2], c = s[3], _ = s[4], d = s[5], f = s[6], m = s[7],
                    p = s[8], T = s[9], E = s[10], v = s[11], g = s[12], S = s[13], y = s[14], x = s[15], D = e.normal;
                D.x = c + u, D.y = m + f, D.z = v + E, e.distance = x + y, e.normalize();
                var I = n.normal;
                I.x = c - u, I.y = m - f, I.z = v - E, n.distance = x - y, n.normalize();
                var R = i.normal;
                R.x = c + l, R.y = m + _, R.z = v + p, i.distance = x + g, i.normalize();
                var M = r.normal;
                M.x = c - l, M.y = m - _, M.z = v - p, r.distance = x - g, r.normalize();
                var A = a.normal;
                A.x = c - h, A.y = m - d, A.z = v - T, a.distance = x - S, a.normalize();
                var C = o.normal;
                C.x = c + h, C.y = m + d, C.z = v + T, o.distance = x + S, o.normalize()
            }, h._get3PlaneInterPoint = function (t, e, n) {
                var i = t.normal, r = e.normal, a = n.normal;
                Lt.cross(r, a, h._tempV30), Lt.cross(a, i, h._tempV31), Lt.cross(i, r, h._tempV32);
                var o = Lt.dot(i, h._tempV30), s = Lt.dot(r, h._tempV31), l = Lt.dot(a, h._tempV32);
                return Lt.scale(h._tempV30, -t.distance / o, h._tempV33), Lt.scale(h._tempV31, -e.distance / s, h._tempV34), Lt.scale(h._tempV32, -n.distance / l, h._tempV35), Lt.add(h._tempV33, h._tempV34, h._tempV36), Lt.add(h._tempV35, h._tempV36, h._tempV37), h._tempV37
            }, _(h, ["_tempV30", function () {
                return this._tempV30 = new Lt
            }, "_tempV31", function () {
                return this._tempV31 = new Lt
            }, "_tempV32", function () {
                return this._tempV32 = new Lt
            }, "_tempV33", function () {
                return this._tempV33 = new Lt
            }, "_tempV34", function () {
                return this._tempV34 = new Lt
            }, "_tempV35", function () {
                return this._tempV35 = new Lt
            }, "_tempV36", function () {
                return this._tempV36 = new Lt
            }, "_tempV37", function () {
                return this._tempV37 = new Lt
            }]), h
        }(), Pe = function () {
            function t() {
                this.indexInList = -1, this.referenceCount = 0, this.updateMark = -1, this.type = -1, this.fullPath = null, this.propertyOwner = null, this.property = null, this.defaultValue = null, this.crossFixedValue = null
            }

            return d(t, "laya.d3.component.KeyframeNodeOwner"), t.prototype.saveCrossFixedValue = function () {
                var t = this.propertyOwner;
                if (t) switch (this.type) {
                    case 0:
                        for (var e = this.property, n = e.length - 1, i = 0; i < n && (t = t[e[i]]); i++) ;
                        this.crossFixedValue = t[e[n]];
                        break;
                    case 1:
                        var r = t.localPosition;
                        this.crossFixedValue || (this.crossFixedValue = new Lt), this.crossFixedValue.x = r.x, this.crossFixedValue.y = r.y, this.crossFixedValue.z = r.z;
                        break;
                    case 2:
                        var a = t.localRotation;
                        this.crossFixedValue || (this.crossFixedValue = new at), this.crossFixedValue.x = a.x, this.crossFixedValue.y = a.y, this.crossFixedValue.z = a.z, this.crossFixedValue.w = a.w;
                        break;
                    case 3:
                        var o = t.localScale;
                        this.crossFixedValue || (this.crossFixedValue = new Lt), this.crossFixedValue.x = o.x, this.crossFixedValue.y = o.y, this.crossFixedValue.z = o.z;
                        break;
                    case 4:
                        var s = t.localRotationEuler;
                        this.crossFixedValue || (this.crossFixedValue = new Lt), this.crossFixedValue.x = s.x, this.crossFixedValue.y = s.y, this.crossFixedValue.z = s.z;
                        break;
                    default:
                        throw"Animator:unknown type."
                }
            }, t
        }(), we = function () {
            function g() {
            }

            return d(g, "laya.d3.graphics.FrustumCulling"), g.__init__ = function () {
                b.supportWebGLPlusCulling && (g._cullingBufferLength = 0, g._cullingBuffer = new Float32Array(4096))
            }, g._drawTraversalCullingBound = function (t, e) {
                t.length;
                for (var n = t.elements, i = 0, r = t.length; i < r; i++) {
                    var a = g._tempColor0;
                    a.r = 0, a.g = 1, a.b = 0, a.a = 1, kt._drawBound(e, n[i].bounds._getBoundBox(), a)
                }
            }, g._traversalCulling = function (t, e, n, i) {
                for (var r = i.length, a = i.elements, o = t.boundFrustum, s = t._transform.position, l = 0; l < r; l++) {
                    var h = a[l];
                    if (t._isLayerVisible(h._owner._layer) && h._enable) if (C.frustumCulling++, !t.useOcclusionCulling || h._needRender(o)) {
                        h._visible = !0;
                        var u = h.bounds;
                        h._distanceForSort = Lt.distance(u.getCenter(), s);
                        for (var c = h._renderElements, _ = 0, d = c.length; _ < d; _++) {
                            var f = c[_], m = e._getRenderQueue(f.material.renderQueue);
                            m.isTransparent ? f.addToTransparentRenderQueue(n, m) : f.addToOpaqueRenderQueue(n, m)
                        }
                    } else h._visible = !1; else h._visible = !1
                }
            }, g.renderObjectCulling = function (t, e, n, i) {
                var r = 0, a = 0, o = e._opaqueQueue, s = e._transparentQueue;
                o.clear(), s.clear();
                var l = Z._managers;
                for (r = 0, a = l.length; r < a; r++) l[r]._clear();
                var h = Q._managers;
                for (r = 0, a = h.length; r < a; r++) h[r]._clear();
                var u = e._octree;
                if (u ? (u.updateMotionObjects(), u.shrinkRootIfPossible(), u.getCollidingWithFrustum(n)) : g._traversalCulling(t, e, n, i), k._config.debugFrustumCulling) {
                    var c = e._debugTool;
                    c.clear(), u ? (u.drawAllBounds(c), u.drawAllObjects(c)) : g._drawTraversalCullingBound(i, c)
                }
                var _ = o.elements.length;
                0 < _ && o._quickSort(0, _ - 1), 0 < (_ = s.elements.length) && s._quickSort(0, _ - 1)
            }, g.renderObjectCullingNative = function (t, e, n, i) {
                var r = 0, a = 0, o = 0, s = 0, l = e._opaqueQueue, h = e._transparentQueue;
                l.clear(), h.clear();
                var u = Z._managers;
                for (r = 0, a = u.length; r < a; r++) u[r]._clear();
                var c = Q._managers;
                for (r = 0, a = c.length; r < a; r++) c[r]._clear();
                var _ = i.length, d = i.elements;
                for (r = 0; r < _; r++) d[r].bounds;
                t.boundFrustum;
                g.cullingNative(t._boundFrustumBuffer, g._cullingBuffer, e._cullingBufferIndices, _, e._cullingBufferResult);
                var f = n.camera._transform.position;
                for (r = 0; r < _; r++) {
                    var m = d[r];
                    if (t._isLayerVisible(m._owner._layer) && m._enable && e._cullingBufferResult[r]) {
                        m._visible = !0, m._distanceForSort = Lt.distance(m.bounds.getCenter(), f);
                        var p = m._renderElements;
                        for (o = 0, s = p.length; o < s; o++) {
                            var T = p[o], E = e._getRenderQueue(T.material.renderQueue);
                            E.isTransparent ? T.addToTransparentRenderQueue(n, E) : T.addToOpaqueRenderQueue(n, E)
                        }
                    } else m._visible = !1
                }
                var v = l.elements.length;
                0 < v && l._quickSort(0, v - 1), 0 < (v = h.elements.length) && h._quickSort(0, v - 1)
            }, g.cullingNative = function (t, e, n, i, r) {
                return E.instance.culling(t, e, n, i, r)
            }, g._cullingBufferLength = 0, g._cullingBuffer = null, _(g, ["_tempVector3", function () {
                return this._tempVector3 = new Lt
            }, "_tempColor0", function () {
                return this._tempColor0 = new ft
            }]), g
        }(), be = function () {
            function t(t) {
                this._defaultState = null, this._statesMap = {}, this.playOnWake = !0, this._playType = -1, this._crossMark = 0, this._crossDuration = -1, this._crossNodesOwnersIndicesMap = {}, this._crossNodesOwnersCount = 0, this._crossNodesOwners = [], this._currentPlayState = null, this._states = [], this._playStateInfo = new ct, this._crossPlayStateInfo = new ct, this._srcCrossClipNodeIndices = [], this._destCrossClipNodeIndices = [], this.name = t, this.defaultWeight = 1, this.blendingMode = laya.d3.component.AnimatorControllerLayer.BLENDINGMODE_OVERRIDE
            }

            d(t, "laya.d3.component.AnimatorControllerLayer");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e.getAnimatorState = function (t) {
                var e = this._statesMap[t];
                return e || null
            }, e.destroy = function () {
                this._statesMap = null, this._states = null, this._playStateInfo = null, this._crossPlayStateInfo = null, this._defaultState = null
            }, e.cloneTo = function (t) {
                var e = t;
                e.name = this.name, e.blendingMode = this.blendingMode, e.defaultWeight = this.defaultWeight, e.playOnWake = this.playOnWake
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, e, "defaultState", function () {
                return this._defaultState
            }, function (t) {
                this._defaultState = t, this._statesMap[t.name] = t
            }), t.BLENDINGMODE_OVERRIDE = 0, t.BLENDINGMODE_ADDTIVE = 1, t
        }(), Fe = function () {
            function H() {
            }

            return d(H, "laya.d3.math.CollisionUtils"), H.distancePlaneToPoint = function (t, e) {
                return Lt.dot(t.normal, e) - t.distance
            }, H.distanceBoxToPoint = function (t, e) {
                var n = t.min, i = n.x, r = n.y, a = n.z, o = t.max, s = o.x, l = o.y, h = o.z, u = e.x, c = e.y,
                    _ = e.z, d = 0;
                return u < i && (d += (i - u) * (i - u)), s < u && (d += (s - u) * (s - u)), c < r && (d += (r - c) * (r - c)), l < c && (d += (l - c) * (l - c)), _ < a && (d += (a - _) * (a - _)), h < _ && (d += (h - _) * (h - _)), Math.sqrt(d)
            }, H.distanceBoxToBox = function (t, e) {
                var n = t.min, i = n.x, r = n.y, a = n.z, o = t.max, s = o.x, l = o.y, h = o.z, u = e.min, c = u.x,
                    _ = u.y, d = u.z, f = e.max, m = f.x, p = f.y, T = f.z, E = 0, v = NaN;
                return m < i ? E += (v = i - m) * v : s < c && (E += (v = c - s) * v), p < r ? E += (v = r - p) * v : l < _ && (E += (v = _ - l) * v), T < a ? E += (v = a - T) * v : h < d && (E += (v = d - h) * v), Math.sqrt(E)
            }, H.distanceSphereToPoint = function (t, e) {
                var n = Math.sqrt(Lt.distanceSquared(t.center, e));
                return n -= t.radius, Math.max(n, 0)
            }, H.distanceSphereToSphere = function (t, e) {
                var n = Math.sqrt(Lt.distanceSquared(t.center, e.center));
                return n -= t.radius + e.radius, Math.max(n, 0)
            }, H.intersectsRayAndTriangleRD = function (t, e, n, i, r) {
                var a = t.origin, o = a.x, s = a.y, l = a.z, h = t.direction, u = h.x, c = h.y, _ = h.z, d = e.x,
                    f = e.y, m = e.z, p = n.x, T = n.y, E = n.z, v = i.x, g = i.y, S = i.z, y = H._tempV30.x,
                    x = H._tempV30.y, D = H._tempV30.z;
                y = p - d, x = T - f, D = E - m;
                var I = H._tempV31.x, R = H._tempV31.y, M = H._tempV31.z;
                I = v - d, R = g - f, M = S - m;
                var A = H._tempV32.x, C = H._tempV32.y, L = H._tempV32.z,
                    O = y * (A = c * M - _ * R) + x * (C = _ * I - u * M) + D * (L = u * R - c * I);
                if (tt.isZero(O)) return 0, !1;
                var N = 1 / O, V = H._tempV33.x, P = H._tempV33.y, w = H._tempV33.z,
                    b = (V = o - d) * A + (P = s - f) * C + (w = l - m) * L;
                if ((b *= N) < 0 || 1 < b) return 0, !1;
                var F = H._tempV34.x, B = H._tempV34.y, U = H._tempV34.z,
                    z = u * (F = P * D - w * x) + c * (B = w * y - V * D) + _ * (U = V * x - P * y);
                if ((z *= N) < 0 || 1 < b + z) return 0, !1;
                var G = I * F + R * B + M * U;
                return (G *= N) < 0 ? (0, !1) : (G, !0)
            }, H.intersectsRayAndTriangleRP = function (t, e, n, i, r) {
                return H.intersectsRayAndTriangleRD(t, e, n, i, NaN) ? (Lt.scale(t.direction, NaN, H._tempV30), Lt.add(t.origin, H._tempV30, r), !0) : (r = Lt._ZERO, !1)
            }, H.intersectsRayAndPoint = function (t, e) {
                Lt.subtract(t.origin, e, H._tempV30);
                var n = Lt.dot(H._tempV30, t.direction), i = Lt.dot(H._tempV30, H._tempV30) - tt.zeroTolerance;
                return !(0 < i && 0 < n) && !(n * n - i < 0)
            }, H.intersectsRayAndRay = function (t, e, n) {
                var i = t.origin, r = i.x, a = i.y, o = i.z, s = t.direction, l = s.x, h = s.y, u = s.z, c = e.origin,
                    _ = c.x, d = c.y, f = c.z, m = e.direction, p = m.x, T = m.y, E = m.z;
                Lt.cross(s, m, H._tempV30);
                var v = H._tempV30, g = Lt.scalarLength(H._tempV30);
                if (tt.isZero(g) && tt.nearEqual(_, r) && tt.nearEqual(d, a) && tt.nearEqual(f, o)) return Lt._ZERO, !0;
                g *= g;
                var S = _ - r, y = d - a, x = f - o, D = p, I = T, R = E, M = v.x, A = v.y, C = v.z,
                    L = (S * I * C + y * R * M + x * D * A - S * R * A - y * D * C - x * I * M) / g;
                I = h, R = u, D = l;
                Lt.scale(s, L, H._tempV30), Lt.scale(m, L, H._tempV31), Lt.add(i, H._tempV30, H._tempV32), Lt.add(c, H._tempV31, H._tempV33);
                var O = H._tempV32, N = H._tempV33;
                return tt.nearEqual(N.x, O.x) && tt.nearEqual(N.y, O.y) && tt.nearEqual(N.z, O.z) ? (H._tempV32, !0) : (Lt._ZERO, !1)
            }, H.intersectsPlaneAndTriangle = function (t, e, n, i) {
                var r = H.intersectsPlaneAndPoint(t, e), a = H.intersectsPlaneAndPoint(t, n),
                    o = H.intersectsPlaneAndPoint(t, i);
                return r == nt.PlaneIntersectionType_Front && a == nt.PlaneIntersectionType_Front && o == nt.PlaneIntersectionType_Front ? nt.PlaneIntersectionType_Front : r == nt.PlaneIntersectionType_Back && a == nt.PlaneIntersectionType_Back && o == nt.PlaneIntersectionType_Back ? nt.PlaneIntersectionType_Back : nt.PlaneIntersectionType_Intersecting
            }, H.intersectsRayAndPlaneRD = function (t, e, n) {
                var i = e.normal, r = Lt.dot(i, t.direction);
                if (tt.isZero(r)) return 0, !1;
                var a = Lt.dot(i, t.origin);
                return !((-e.distance - a) / r < 0) || (0, !1)
            }, H.intersectsRayAndPlaneRP = function (t, e, n) {
                return H.intersectsRayAndPlaneRD(t, e, NaN) ? (Lt.scale(t.direction, NaN, H._tempV30), Lt.add(t.origin, H._tempV30, H._tempV31), H._tempV31, !0) : (Lt._ZERO, !1)
            }, H.intersectsRayAndBoxRD = function (t, e) {
                var n = t.origin, i = n.x, r = n.y, a = n.z, o = t.direction, s = o.x, l = o.y, h = o.z, u = e.min,
                    c = u.x, _ = u.y, d = u.z, f = e.max, m = f.x, p = f.y, T = f.z, E = 0, v = tt.MaxValue;
                if (tt.isZero(s)) {
                    if (i < c || m < i) return -1
                } else {
                    var g = 1 / s, S = (c - i) * g, y = (m - i) * g;
                    if (y < S) {
                        var x = S;
                        S = y, y = x
                    }
                    if (E = Math.max(S, E), (v = Math.min(y, v)) < E) return -1
                }
                if (tt.isZero(l)) {
                    if (r < _ || p < r) return -1
                } else {
                    var D = 1 / l, I = (_ - r) * D, R = (p - r) * D;
                    if (R < I) {
                        var M = I;
                        I = R, R = M
                    }
                    if (E = Math.max(I, E), (v = Math.min(R, v)) < E) return -1
                }
                if (tt.isZero(h)) {
                    if (a < d || T < a) return -1
                } else {
                    var A = 1 / h, C = (d - a) * A, L = (T - a) * A;
                    if (L < C) {
                        var O = C;
                        C = L, L = O
                    }
                    if (E = Math.max(C, E), (v = Math.min(L, v)) < E) return -1
                }
                return E
            }, H.intersectsRayAndBoxRP = function (t, e, n) {
                var i = H.intersectsRayAndBoxRD(t, e);
                return -1 === i ? Lt._ZERO.cloneTo(n) : (Lt.scale(t.direction, i, H._tempV30), Lt.add(t.origin, H._tempV30, H._tempV31), H._tempV31.cloneTo(n)), i
            }, H.intersectsRayAndSphereRD = function (t, e) {
                var n = e.radius;
                Lt.subtract(t.origin, e.center, H._tempV30);
                var i = Lt.dot(H._tempV30, t.direction), r = Lt.dot(H._tempV30, H._tempV30) - n * n;
                if (0 < r && 0 < i) return -1;
                var a = i * i - r;
                if (a < 0) return -1;
                var o = -i - Math.sqrt(a);
                return o < 0 && (o = 0), o
            }, H.intersectsRayAndSphereRP = function (t, e, n) {
                var i = H.intersectsRayAndSphereRD(t, e);
                return -1 === i ? Lt._ZERO.cloneTo(n) : (Lt.scale(t.direction, i, H._tempV30), Lt.add(t.origin, H._tempV30, H._tempV31), H._tempV31.cloneTo(n)), i
            }, H.intersectsSphereAndTriangle = function (t, e, n, i) {
                var r = t.center, a = t.radius;
                return H.closestPointPointTriangle(r, e, n, i, H._tempV30), Lt.subtract(H._tempV30, r, H._tempV31), Lt.dot(H._tempV31, H._tempV31) <= a * a
            }, H.intersectsPlaneAndPoint = function (t, e) {
                var n = Lt.dot(t.normal, e) + t.distance;
                return 0 < n ? nt.PlaneIntersectionType_Front : n < 0 ? nt.PlaneIntersectionType_Back : nt.PlaneIntersectionType_Intersecting
            }, H.intersectsPlaneAndPlane = function (t, e) {
                Lt.cross(t.normal, e.normal, H._tempV30);
                var n = Lt.dot(H._tempV30, H._tempV30);
                return !tt.isZero(n)
            }, H.intersectsPlaneAndPlaneRL = function (t, e, n) {
                var i = t.normal, r = e.normal;
                Lt.cross(i, r, H._tempV34);
                var a = Lt.dot(H._tempV34, H._tempV34);
                return !tt.isZero(a) && (Lt.scale(r, t.distance, H._tempV30), Lt.scale(i, e.distance, H._tempV31), Lt.subtract(H._tempV30, H._tempV31, H._tempV32), Lt.cross(H._tempV32, H._tempV34, H._tempV33), Lt.normalize(H._tempV34, H._tempV34), new W(H._tempV33, H._tempV34), !0)
            }, H.intersectsPlaneAndBox = function (t, e) {
                var n = t.distance, i = t.normal, r = i.x, a = i.y, o = i.z, s = e.min, l = s.x, h = s.y, u = s.z,
                    c = e.max, _ = c.x, d = c.y, f = c.z;
                H._tempV30.x = 0 < r ? l : _, H._tempV30.y = 0 < a ? h : d, H._tempV30.z = 0 < o ? u : f, H._tempV31.x = 0 < r ? _ : l, H._tempV31.y = 0 < a ? d : h, H._tempV31.z = 0 < o ? f : u;
                var m = Lt.dot(i, H._tempV30);
                return 0 < m + n ? nt.PlaneIntersectionType_Front : (m = Lt.dot(i, H._tempV31)) + n < 0 ? nt.PlaneIntersectionType_Back : nt.PlaneIntersectionType_Intersecting
            }, H.intersectsPlaneAndSphere = function (t, e) {
                var n = e.radius, i = Lt.dot(t.normal, e.center) + t.distance;
                return n < i ? nt.PlaneIntersectionType_Front : i < -n ? nt.PlaneIntersectionType_Back : nt.PlaneIntersectionType_Intersecting
            }, H.intersectsBoxAndBox = function (t, e) {
                var n = t.min, i = t.max, r = e.min, a = e.max;
                return !(n.x > a.x || r.x > i.x) && (!(n.y > a.y || r.y > i.y) && !(n.z > a.z || r.z > i.z))
            }, H.intersectsBoxAndSphere = function (t, e) {
                var n = e.center, i = e.radius;
                return Lt.Clamp(n, t.min, t.max, H._tempV30), Lt.distanceSquared(n, H._tempV30) <= i * i
            }, H.intersectsSphereAndSphere = function (t, e) {
                var n = t.radius + e.radius;
                return Lt.distanceSquared(t.center, e.center) <= n * n
            }, H.boxContainsPoint = function (t, e) {
                var n = t.min, i = t.max;
                return n.x <= e.x && i.x >= e.x && n.y <= e.y && i.y >= e.y && n.z <= e.z && i.z >= e.z ? 1 : 0
            }, H.boxContainsBox = function (t, e) {
                var n = t.min, i = n.x, r = n.y, a = n.z, o = t.max, s = o.x, l = o.y, h = o.z, u = e.min, c = u.x,
                    _ = u.y, d = u.z, f = e.max, m = f.x, p = f.y, T = f.z;
                return s < c || m < i ? 0 : l < _ || p < r ? 0 : h < d || T < a ? 0 : i <= c && m <= s && r <= _ && p <= l && a <= d && T <= h ? 1 : 2
            }, H.boxContainsSphere = function (t, e) {
                var n = t.min, i = n.x, r = n.y, a = n.z, o = t.max, s = o.x, l = o.y, h = o.z, u = e.center, c = u.x,
                    _ = u.y, d = u.z, f = e.radius;
                return Lt.Clamp(u, n, o, H._tempV30), f * f < Lt.distanceSquared(u, H._tempV30) ? 0 : i + f <= c && c <= s - f && f < s - i && r + f <= _ && _ <= l - f && f < l - r && a + f <= d && d <= h - f && f < h - a ? 1 : 2
            }, H.sphereContainsPoint = function (t, e) {
                return Lt.distanceSquared(e, t.center) <= t.radius * t.radius ? 1 : 0
            }, H.sphereContainsTriangle = function (t, e, n, i) {
                var r = H.sphereContainsPoint(t, e), a = H.sphereContainsPoint(t, n), o = H.sphereContainsPoint(t, i);
                return 1 == r && 1 == a && 1 == o ? 1 : H.intersectsSphereAndTriangle(t, e, n, i) ? 2 : 0
            }, H.sphereContainsBox = function (t, e) {
                var n = t.center, i = n.x, r = n.y, a = n.z, o = t.radius, s = e.min, l = s.x, h = s.y, u = s.z,
                    c = e.max, _ = c.x, d = c.y, f = c.z, m = H._tempV30;
                m.x, m.y, m.z;
                if (!H.intersectsBoxAndSphere(e, t)) return 0;
                var p = o * o;
                return i - l, r - d, a - f, Lt.scalarLengthSquared(H._tempV30) > p ? 2 : (i - _, r - d, a - f, Lt.scalarLengthSquared(H._tempV30) > p ? 2 : (i - _, r - h, a - f, Lt.scalarLengthSquared(H._tempV30) > p ? 2 : (i - l, r - h, a - f, Lt.scalarLengthSquared(H._tempV30) > p ? 2 : (i - l, r - d, a - u, Lt.scalarLengthSquared(H._tempV30) > p ? 2 : (i - _, r - d, a - u, Lt.scalarLengthSquared(H._tempV30) > p ? 2 : (i - _, r - h, a - u, Lt.scalarLengthSquared(H._tempV30) > p ? 2 : (i - l, r - h, a - u, Lt.scalarLengthSquared(H._tempV30) > p ? 2 : 1)))))))
            }, H.sphereContainsSphere = function (t, e) {
                var n = t.radius, i = e.radius, r = Lt.distance(t.center, e.center);
                return n + i < r ? 0 : n - i < r ? 2 : 1
            }, H.closestPointPointTriangle = function (t, e, n, i, r) {
                Lt.subtract(n, e, H._tempV30), Lt.subtract(i, e, H._tempV31), Lt.subtract(t, e, H._tempV32), Lt.subtract(t, n, H._tempV33), Lt.subtract(t, i, H._tempV34);
                var a = Lt.dot(H._tempV30, H._tempV32), o = Lt.dot(H._tempV31, H._tempV32),
                    s = Lt.dot(H._tempV30, H._tempV33), l = Lt.dot(H._tempV31, H._tempV33),
                    h = Lt.dot(H._tempV30, H._tempV34), u = Lt.dot(H._tempV31, H._tempV34);
                if (a <= 0 && o <= 0) e.cloneTo(r); else if (0 <= s && l <= s) n.cloneTo(r); else {
                    var c = a * l - s * o;
                    if (c <= 0 && 0 <= a && s <= 0) {
                        var _ = a / (a - s);
                        return Lt.scale(H._tempV30, _, r), void Lt.add(e, r, r)
                    }
                    if (0 <= u && h <= u) i.cloneTo(r); else {
                        var d = h * o - a * u;
                        if (d <= 0 && 0 <= o && u <= 0) {
                            var f = o / (o - u);
                            return Lt.scale(H._tempV31, f, r), void Lt.add(e, r, r)
                        }
                        var m = s * u - h * l;
                        if (m <= 0 && 0 <= l - s && 0 <= h - u) {
                            var p = (l - s) / (l - s + (h - u));
                            return Lt.subtract(i, n, r), Lt.scale(r, p, r), void Lt.add(n, r, r)
                        }
                        var T = 1 / (m + d + c), E = d * T, v = c * T;
                        Lt.scale(H._tempV30, E, H._tempV35), Lt.scale(H._tempV31, v, H._tempV36), Lt.add(H._tempV35, H._tempV36, r), Lt.add(e, r, r)
                    }
                }
            }, H.closestPointPlanePoint = function (t, e, n) {
                var i = t.normal, r = Lt.dot(i, e) - t.distance;
                Lt.scale(i, r, H._tempV30), Lt.subtract(e, H._tempV30, n)
            }, H.closestPointBoxPoint = function (t, e, n) {
                Lt.max(e, t.min, H._tempV30), Lt.min(H._tempV30, t.max, n)
            }, H.closestPointSpherePoint = function (t, e, n) {
                var i = t.center;
                Lt.subtract(e, i, n), Lt.normalize(n, n), Lt.scale(n, t.radius, n), Lt.add(n, i, n)
            }, H.closestPointSphereSphere = function (t, e, n) {
                var i = t.center;
                Lt.subtract(e.center, i, n), Lt.normalize(n, n), Lt.scale(n, t.radius, n), Lt.add(n, i, n)
            }, _(H, ["_tempV30", function () {
                return this._tempV30 = new Lt
            }, "_tempV31", function () {
                return this._tempV31 = new Lt
            }, "_tempV32", function () {
                return this._tempV32 = new Lt
            }, "_tempV33", function () {
                return this._tempV33 = new Lt
            }, "_tempV34", function () {
                return this._tempV34 = new Lt
            }, "_tempV35", function () {
                return this._tempV35 = new Lt
            }, "_tempV36", function () {
                return this._tempV36 = new Lt
            }]), H
        }(), Be = function () {
            function l() {
                var t = this.elements = new Float32Array(9);
                t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 1, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1
            }

            d(l, "laya.d3.math.Matrix3x3");
            var t = l.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.determinant = function () {
                var t = this.elements, e = t[0], n = t[1], i = t[2], r = t[3], a = t[4], o = t[5], s = t[6], l = t[7],
                    h = t[8];
                return e * (h * a - o * l) + n * (-h * r + o * s) + i * (l * r - a * s)
            }, t.translate = function (t, e) {
                var n = e.elements, i = this.elements, r = i[0], a = i[1], o = i[2], s = i[3], l = i[4], h = i[5],
                    u = i[6], c = i[7], _ = i[8], d = t.x, f = t.y;
                n[0] = r, n[1] = a, n[2] = o, n[3] = s, n[4] = l, n[5] = h, n[6] = d * r + f * s + u, n[7] = d * a + f * l + c, n[8] = d * o + f * h + _
            }, t.rotate = function (t, e) {
                var n = e.elements, i = this.elements, r = i[0], a = i[1], o = i[2], s = i[3], l = i[4], h = i[5],
                    u = i[6], c = i[7], _ = i[8], d = Math.sin(t), f = Math.cos(t);
                n[0] = f * r + d * s, n[1] = f * a + d * l, n[2] = f * o + d * h, n[3] = f * s - d * r, n[4] = f * l - d * a, n[5] = f * h - d * o, n[6] = u, n[7] = c, n[8] = _
            }, t.scale = function (t, e) {
                var n = e.elements, i = this.elements, r = t.x, a = t.y;
                n[0] = r * i[0], n[1] = r * i[1], n[2] = r * i[2], n[3] = a * i[3], n[4] = a * i[4], n[5] = a * i[5], n[6] = i[6], n[7] = i[7], n[8] = i[8]
            }, t.invert = function (t) {
                var e = t.elements, n = this.elements, i = n[0], r = n[1], a = n[2], o = n[3], s = n[4], l = n[5],
                    h = n[6], u = n[7], c = n[8], _ = c * s - l * u, d = -c * o + l * h, f = u * o - s * h,
                    m = i * _ + r * d + a * f;
                m || (t = null), m = 1 / m, e[0] = _ * m, e[1] = (-c * r + a * u) * m, e[2] = (l * r - a * s) * m, e[3] = d * m, e[4] = (c * i - a * h) * m, e[5] = (-l * i + a * o) * m, e[6] = f * m, e[7] = (-u * i + r * h) * m, e[8] = (s * i - r * o) * m
            }, t.transpose = function (t) {
                var e = t.elements, n = this.elements;
                if (t === this) {
                    var i = n[1], r = n[2], a = n[5];
                    e[1] = n[3], e[2] = n[6], e[3] = i, e[5] = n[7], e[6] = r, e[7] = a
                } else e[0] = n[0], e[1] = n[3], e[2] = n[6], e[3] = n[1], e[4] = n[4], e[5] = n[7], e[6] = n[2], e[7] = n[5], e[8] = n[8]
            }, t.identity = function () {
                var t = this.elements;
                t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 1, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1
            }, t.cloneTo = function (t) {
                var e, n, i;
                if ((n = this.elements) !== (i = t.elements)) for (e = 0; e < 9; ++e) i[e] = n[e]
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, l.createFromTranslation = function (t, e) {
                e.elements;
                e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 1, e[5] = 0, e[6] = t.x, e[7] = t.y, e[8] = 1
            }, l.createFromRotation = function (t, e) {
                var n = e.elements, i = Math.sin(t), r = Math.cos(t);
                n[0] = r, n[1] = i, n[2] = 0, n[3] = -i, n[4] = r, n[5] = 0, n[6] = 0, n[7] = 0, n[8] = 1
            }, l.createFromScaling = function (t, e) {
                var n = e.elements;
                n[0] = t.x, n[1] = 0, n[2] = 0, n[3] = 0, n[4] = t.y, n[5] = 0, n[6] = 0, n[7] = 0, n[8] = 1
            }, l.createFromMatrix4x4 = function (t, e) {
                e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[4], e[4] = t[5], e[5] = t[6], e[6] = t[8], e[7] = t[9], e[8] = t[10]
            }, l.multiply = function (t, e, n) {
                var i = n.elements, r = t.elements, a = e.elements, o = r[0], s = r[1], l = r[2], h = r[3], u = r[4],
                    c = r[5], _ = r[6], d = r[7], f = r[8], m = a[0], p = a[1], T = a[2], E = a[3], v = a[4], g = a[5],
                    S = a[6], y = a[7], x = a[8];
                i[0] = m * o + p * h + T * _, i[1] = m * s + p * u + T * d, i[2] = m * l + p * c + T * f, i[3] = E * o + v * h + g * _, i[4] = E * s + v * u + g * d, i[5] = E * l + v * c + g * f, i[6] = S * o + y * h + x * _, i[7] = S * s + y * u + x * d, i[8] = S * l + y * c + x * f
            }, l.lookAt = function (t, e, n, i) {
                Lt.subtract(t, e, l._tempV30), Lt.normalize(l._tempV30, l._tempV30), Lt.cross(n, l._tempV30, l._tempV31), Lt.normalize(l._tempV31, l._tempV31), Lt.cross(l._tempV30, l._tempV31, l._tempV32);
                var r = l._tempV30, a = l._tempV31, o = l._tempV32, s = i.elements;
                s[0] = a.x, s[3] = a.y, s[6] = a.z, s[1] = o.x, s[4] = o.y, s[7] = o.z, s[2] = r.x, s[5] = r.y, s[8] = r.z
            }, l.DEFAULT = new l, _(l, ["_tempV30", function () {
                return this._tempV30 = new Lt
            }, "_tempV31", function () {
                return this._tempV31 = new Lt
            }, "_tempV32", function () {
                return this._tempV32 = new Lt
            }]), l
        }(), Ue = function () {
            function t() {
            }

            return d(t, "laya.d3.utils.Physics3DUtils"), t.setColliderCollision = function (t, e, n) {
            }, t.getIColliderCollision = function (t, e) {
                return !1
            }, t.COLLISIONFILTERGROUP_DEFAULTFILTER = 1, t.COLLISIONFILTERGROUP_STATICFILTER = 2, t.COLLISIONFILTERGROUP_KINEMATICFILTER = 4, t.COLLISIONFILTERGROUP_DEBRISFILTER = 8, t.COLLISIONFILTERGROUP_SENSORTRIGGER = 16, t.COLLISIONFILTERGROUP_CHARACTERFILTER = 32, t.COLLISIONFILTERGROUP_CUSTOMFILTER1 = 64, t.COLLISIONFILTERGROUP_CUSTOMFILTER2 = 128, t.COLLISIONFILTERGROUP_CUSTOMFILTER3 = 256, t.COLLISIONFILTERGROUP_CUSTOMFILTER4 = 512, t.COLLISIONFILTERGROUP_CUSTOMFILTER5 = 1024, t.COLLISIONFILTERGROUP_CUSTOMFILTER6 = 2048, t.COLLISIONFILTERGROUP_CUSTOMFILTER7 = 4096, t.COLLISIONFILTERGROUP_CUSTOMFILTER8 = 8192, t.COLLISIONFILTERGROUP_CUSTOMFILTER9 = 16384, t.COLLISIONFILTERGROUP_CUSTOMFILTER10 = 32768, t.COLLISIONFILTERGROUP_ALLFILTER = -1, _(t, ["gravity", function () {
                return this.gravity = new Lt(0, -9.81, 0)
            }]), t
        }(), ze = function () {
            function r(t, e) {
                this.min = null, this.max = null, this.min = t, this.max = e
            }

            d(r, "laya.d3.math.BoundBox");
            var t = r.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t._rotateExtents = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z, o = e.elements;
                n.x = Math.abs(o[0] * i) + Math.abs(o[4] * r) + Math.abs(o[8] * a), n.y = Math.abs(o[1] * i) + Math.abs(o[5] * r) + Math.abs(o[9] * a), n.z = Math.abs(o[2] * i) + Math.abs(o[6] * r) + Math.abs(o[10] * a)
            }, t.getCorners = function (t) {
                t.length = 8;
                var e = this.min.x, n = this.min.y, i = this.min.z, r = this.max.x, a = this.max.y, o = this.max.z;
                t[0] = new Lt(e, a, o), t[1] = new Lt(r, a, o), t[2] = new Lt(r, n, o), t[3] = new Lt(e, n, o), t[4] = new Lt(e, a, i), t[5] = new Lt(r, a, i), t[6] = new Lt(r, n, i), t[7] = new Lt(e, n, i)
            }, t.getCenter = function (t) {
                Lt.add(this.min, this.max, t), Lt.scale(t, .5, t)
            }, t.getExtent = function (t) {
                Lt.subtract(this.max, this.min, t), Lt.scale(t, .5, t)
            }, t.setCenterAndExtent = function (t, e) {
                Lt.subtract(t, e, this.min), Lt.add(t, e, this.max)
            }, t.tranform = function (t, e) {
                var n = r._tempVector30, i = r._tempVector31;
                this.getCenter(n), this.getExtent(i), Lt.transformCoordinate(n, t, n), this._rotateExtents(i, t, i), e.setCenterAndExtent(n, i)
            }, t.toDefault = function () {
                this.min.toDefault(), this.max.toDefault()
            }, t.cloneTo = function (t) {
                var e = t;
                this.min.cloneTo(e.min), this.max.cloneTo(e.max)
            }, t.clone = function () {
                var t = new this.constructor(new Lt, new Lt);
                return this.cloneTo(t), t
            }, r.createfromPoints = function (t, e) {
                if (null == t) throw new Error("points");
                var n = e.min, i = e.max;
                n.x = Number.MAX_VALUE, n.y = Number.MAX_VALUE, n.z = Number.MAX_VALUE, i.x = -Number.MAX_VALUE, i.y = -Number.MAX_VALUE, i.z = -Number.MAX_VALUE;
                for (var r = 0, a = t.length; r < a; ++r) Lt.min(n, t[r], n), Lt.max(i, t[r], i)
            }, r.merge = function (t, e, n) {
                Lt.min(t.min, e.min, n.min), Lt.max(t.max, e.max, n.max)
            }, _(r, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempVector31", function () {
                return this._tempVector31 = new Lt
            }]), r
        }(), Ge = function () {
            function t() {
                this.speed = 1, this.clipStart = 0, this.clipEnd = 1, this._nodeOwners = []
            }

            d(t, "laya.d3.component.AnimatorState");
            var e = t.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e._resetFrameIndices = function () {
                for (var t = 0, e = this._currentFrameIndices.length; t < e; t++) this._currentFrameIndices[t] = -1
            }, e.addScript = function (t) {
                var e = new t;
                return this._scripts = this._scripts || [], this._scripts.push(e), e
            }, e.getScript = function (t) {
                if (this._scripts) for (var e = 0, n = this._scripts.length; e < n; e++) {
                    var i = this._scripts[e];
                    if (m.__typeof(i, t)) return i
                }
                return null
            }, e.getScripts = function (t) {
                var e;
                if (this._scripts) for (var n = 0, i = this._scripts.length; n < i; n++) {
                    var r = this._scripts[n];
                    m.__typeof(r, t) && (e = e || []).push(r)
                }
                return e
            }, e.cloneTo = function (t) {
                var e = t;
                e.name = this.name, e.speed = this.speed, e.clipStart = this.clipStart, e.clipEnd = this.clipEnd, e.clip = this._clip
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, e, "clip", function () {
                return this._clip
            }, function (t) {
                this._clip = t, this._currentFrameIndices = new Int16Array(t._nodes.count), this._resetFrameIndices()
            }), t
        }(), He = (function () {
            function t() {
                this._vertices = null, this._vertexBuffer = null, this._text = null, this._fontSize = 0, this._color = null
            }

            d(t, "laya.d3.text.TextMesh");
            var e = t.prototype;
            e._createVertexBuffer = function (t) {
            }, e._resizeVertexBuffer = function (t) {
            }, e._addChar = function () {
            }, u(0, e, "text", function () {
                return this._text
            }, function (t) {
                this._text = t
            }), u(0, e, "fontSize", function () {
                return this._fontSize
            }, function (t) {
                this._fontSize = t
            }), u(0, e, "color", function () {
                return this._color
            }, function (t) {
                this._color = t
            }), t._indexBuffer = null
        }(), function () {
            function x(t, e, n, i, r, a, o, s, l, h, u, c, _, d, f, m, p) {
                void 0 === t && (t = 1), void 0 === e && (e = 0), void 0 === n && (n = 0), void 0 === i && (i = 0), void 0 === r && (r = 0), void 0 === a && (a = 1), void 0 === o && (o = 0), void 0 === s && (s = 0), void 0 === l && (l = 0), void 0 === h && (h = 0), void 0 === u && (u = 1), void 0 === c && (c = 0), void 0 === _ && (_ = 0), void 0 === d && (d = 0), void 0 === f && (f = 0), void 0 === m && (m = 1);
                var T = this.elements = p || new Float32Array(16);
                T[0] = t, T[1] = e, T[2] = n, T[3] = i, T[4] = r, T[5] = a, T[6] = o, T[7] = s, T[8] = l, T[9] = h, T[10] = u, T[11] = c, T[12] = _, T[13] = d, T[14] = f, T[15] = m
            }

            d(x, "laya.d3.math.Matrix4x4");
            var t = x.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t.setRotation = function (t) {
                var e = t.x, n = t.y, i = t.z, r = t.w, a = e * e, o = n * n, s = i * i, l = e * n, h = i * r,
                    u = i * e, c = n * r, _ = n * i, d = e * r, f = this.elements;
                f[0] = 1 - 2 * (o + s), f[1] = 2 * (l + h), f[2] = 2 * (u - c), f[4] = 2 * (l - h), f[5] = 1 - 2 * (s + a), f[6] = 2 * (_ + d), f[8] = 2 * (u + c), f[9] = 2 * (_ - d), f[10] = 1 - 2 * (o + a)
            }, t.setPosition = function (t) {
                var e = this.elements;
                e[12] = t.x, e[13] = t.y, e[14] = t.z
            }, t.getElementByRowColumn = function (t, e) {
                if (t < 0 || 3 < t) throw new Error("row", "Rows and columns for matrices run from 0 to 3, inclusive.");
                if (e < 0 || 3 < e) throw new Error("column", "Rows and columns for matrices run from 0 to 3, inclusive.");
                return this.elements[4 * t + e]
            }, t.setElementByRowColumn = function (t, e, n) {
                if (t < 0 || 3 < t) throw new Error("row", "Rows and columns for matrices run from 0 to 3, inclusive.");
                if (e < 0 || 3 < e) throw new Error("column", "Rows and columns for matrices run from 0 to 3, inclusive.");
                this.elements[4 * t + e] = n
            }, t.equalsOtherMatrix = function (t) {
                var e = this.elements, n = t.elements;
                return tt.nearEqual(e[0], n[0]) && tt.nearEqual(e[1], n[1]) && tt.nearEqual(e[2], n[2]) && tt.nearEqual(e[3], n[3]) && tt.nearEqual(e[4], n[4]) && tt.nearEqual(e[5], n[5]) && tt.nearEqual(e[6], n[6]) && tt.nearEqual(e[7], n[7]) && tt.nearEqual(e[8], n[8]) && tt.nearEqual(e[9], n[9]) && tt.nearEqual(e[10], n[10]) && tt.nearEqual(e[11], n[11]) && tt.nearEqual(e[12], n[12]) && tt.nearEqual(e[13], n[13]) && tt.nearEqual(e[14], n[14]) && tt.nearEqual(e[15], n[15])
            }, t.decomposeTransRotScale = function (t, e, n) {
                var i = x._tempMatrix4x4;
                return this.decomposeTransRotMatScale(t, i, n) ? (at.createFromMatrix4x4(i, e), !0) : (e.identity(), !1)
            }, t.decomposeTransRotMatScale = function (t, e, n) {
                var i = this.elements, r = t, a = e.elements, o = n;
                r.x = i[12], r.y = i[13], r.z = i[14];
                var s = i[0], l = i[1], h = i[2], u = i[4], c = i[5], _ = i[6], d = i[8], f = i[9], m = i[10],
                    p = o.x = Math.sqrt(s * s + l * l + h * h), T = o.y = Math.sqrt(u * u + c * c + _ * _),
                    E = o.z = Math.sqrt(d * d + f * f + m * m);
                if (tt.isZero(p) || tt.isZero(T) || tt.isZero(E)) return a[1] = a[2] = a[3] = a[4] = a[6] = a[7] = a[8] = a[9] = a[11] = a[12] = a[13] = a[14] = 0, a[0] = a[5] = a[10] = a[15] = 1, !1;
                var v = x._tempVector0;
                v.x = d / E, v.y = f / E, v.z = m / E;
                var g = x._tempVector1;
                g.x = s / p, g.y = l / p, g.z = h / p;
                var S = x._tempVector2;
                Lt.cross(v, g, S);
                var y = x._tempVector1;
                return Lt.cross(S, v, y), a[3] = a[7] = a[11] = a[12] = a[13] = a[14] = 0, a[15] = 1, a[0] = y.x, a[1] = y.y, a[2] = y.z, a[4] = S.x, a[5] = S.y, a[6] = S.z, a[8] = v.x, a[9] = v.y, a[10] = v.z, a[0] * s + a[1] * l + a[2] * h < 0 && (o[0] = -p), a[4] * u + a[5] * c + a[6] * _ < 0 && (o[1] = -T), a[8] * d + a[9] * f + a[10] * m < 0 && (o[2] = -E), !0
            }, t.decomposeYawPitchRoll = function (t) {
                var e = Math.asin(-this.elements[9]);
                t.y = e, Math.cos(e) > tt.zeroTolerance ? (t.z = Math.atan2(this.elements[1], this.elements[5]), t.x = Math.atan2(this.elements[8], this.elements[10])) : (t.z = Math.atan2(-this.elements[4], this.elements[0]), t.x = 0)
            }, t.normalize = function () {
                var t = this.elements, e = t[0], n = t[1], i = t[2], r = Math.sqrt(e * e + n * n + i * i);
                if (!r) return t[0] = 0, t[1] = 0, void (t[2] = 0);
                1 != r && (r = 1 / r, t[0] = e * r, t[1] = n * r, t[2] = i * r)
            }, t.transpose = function () {
                var t, e;
                return e = (t = this.elements)[1], t[1] = t[4], t[4] = e, e = t[2], t[2] = t[8], t[8] = e, e = t[3], t[3] = t[12], t[12] = e, e = t[6], t[6] = t[9], t[9] = e, e = t[7], t[7] = t[13], t[13] = e, e = t[11], t[11] = t[14], t[14] = e, this
            }, t.invert = function (t) {
                var e = this.elements, n = t.elements, i = e[0], r = e[1], a = e[2], o = e[3], s = e[4], l = e[5],
                    h = e[6], u = e[7], c = e[8], _ = e[9], d = e[10], f = e[11], m = e[12], p = e[13], T = e[14],
                    E = e[15], v = i * l - r * s, g = i * h - a * s, S = i * u - o * s, y = r * h - a * l,
                    x = r * u - o * l, D = a * u - o * h, I = c * p - _ * m, R = c * T - d * m, M = c * E - f * m,
                    A = _ * T - d * p, C = _ * E - f * p, L = d * E - f * T,
                    O = v * L - g * C + S * A + y * M - x * R + D * I;
                0 !== Math.abs(O) && (O = 1 / O, n[0] = (l * L - h * C + u * A) * O, n[1] = (a * C - r * L - o * A) * O, n[2] = (p * D - T * x + E * y) * O, n[3] = (d * x - _ * D - f * y) * O, n[4] = (h * M - s * L - u * R) * O, n[5] = (i * L - a * M + o * R) * O, n[6] = (T * S - m * D - E * g) * O, n[7] = (c * D - d * S + f * g) * O, n[8] = (s * C - l * M + u * I) * O, n[9] = (r * M - i * C - o * I) * O, n[10] = (m * x - p * S + E * v) * O, n[11] = (_ * S - c * x - f * v) * O, n[12] = (l * R - s * A - h * I) * O, n[13] = (i * A - r * R + a * I) * O, n[14] = (p * g - m * y - T * v) * O, n[15] = (c * y - _ * g + d * v) * O)
            }, t.identity = function () {
                var t = this.elements;
                t[1] = t[2] = t[3] = t[4] = t[6] = t[7] = t[8] = t[9] = t[11] = t[12] = t[13] = t[14] = 0, t[0] = t[5] = t[10] = t[15] = 1
            }, t.cloneTo = function (t) {
                var e, n, i;
                if ((n = this.elements) !== (i = t.elements)) for (e = 0; e < 16; ++e) i[e] = n[e]
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, t.getTranslationVector = function (t) {
                var e = this.elements;
                t.x = e[12], t.y = e[13], t.z = e[14]
            }, t.setTranslationVector = function (t) {
                var e = this.elements, n = t;
                e[12] = n.x, e[13] = n.y, e[14] = n.z
            }, t.getForward = function (t) {
                var e = this.elements;
                t.x = -e[8], t.y = -e[9], t.z = -e[10]
            }, t.setForward = function (t) {
                var e = this.elements;
                e[8] = -t.x, e[9] = -t.y, e[10] = -t.z
            }, x.createRotationX = function (t, e) {
                var n = e.elements, i = Math.sin(t), r = Math.cos(t);
                n[1] = n[2] = n[3] = n[4] = n[7] = n[8] = n[11] = n[12] = n[13] = n[14] = 0, n[0] = n[15] = 1, n[5] = n[10] = r, n[6] = i, n[9] = -i
            }, x.createRotationY = function (t, e) {
                var n = e.elements, i = Math.sin(t), r = Math.cos(t);
                n[1] = n[3] = n[4] = n[6] = n[7] = n[9] = n[11] = n[12] = n[13] = n[14] = 0, n[5] = n[15] = 1, n[0] = n[10] = r, n[2] = -i, n[8] = i
            }, x.createRotationZ = function (t, e) {
                var n = e.elements, i = Math.sin(t), r = Math.cos(t);
                n[2] = n[3] = n[6] = n[7] = n[8] = n[9] = n[11] = n[12] = n[13] = n[14] = 0, n[10] = n[15] = 1, n[0] = n[5] = r, n[1] = i, n[4] = -i
            }, x.createRotationYawPitchRoll = function (t, e, n, i) {
                at.createFromYawPitchRoll(t, e, n, x._tempQuaternion), x.createRotationQuaternion(x._tempQuaternion, i)
            }, x.createRotationAxis = function (t, e, n) {
                var i = t.x, r = t.y, a = t.z, o = Math.cos(e), s = Math.sin(e), l = i * i, h = r * r, u = a * a,
                    c = i * r, _ = i * a, d = r * a, f = n.elements;
                f[3] = f[7] = f[11] = f[12] = f[13] = f[14] = 0, f[15] = 1, f[0] = l + o * (1 - l), f[1] = c - o * c + s * a, f[2] = _ - o * _ - s * r, f[4] = c - o * c - s * a, f[5] = h + o * (1 - h), f[6] = d - o * d + s * i, f[8] = _ - o * _ + s * r, f[9] = d - o * d - s * i, f[10] = u + o * (1 - u)
            }, x.createRotationQuaternion = function (t, e) {
                var n = e.elements, i = t.x, r = t.y, a = t.z, o = t.w, s = i * i, l = r * r, h = a * a, u = i * r,
                    c = a * o, _ = a * i, d = r * o, f = r * a, m = i * o;
                n[3] = n[7] = n[11] = n[12] = n[13] = n[14] = 0, n[15] = 1, n[0] = 1 - 2 * (l + h), n[1] = 2 * (u + c), n[2] = 2 * (_ - d), n[4] = 2 * (u - c), n[5] = 1 - 2 * (h + s), n[6] = 2 * (f + m), n[8] = 2 * (_ + d), n[9] = 2 * (f - m), n[10] = 1 - 2 * (l + s)
            }, x.createTranslate = function (t, e) {
                var n = e.elements;
                n[4] = n[8] = n[1] = n[9] = n[2] = n[6] = n[3] = n[7] = n[11] = 0, n[0] = n[5] = n[10] = n[15] = 1, n[12] = t.x, n[13] = t.y, n[14] = t.z
            }, x.createScaling = function (t, e) {
                var n = e.elements;
                n[0] = t.x, n[5] = t.y, n[10] = t.z, n[1] = n[4] = n[8] = n[12] = n[9] = n[13] = n[2] = n[6] = n[14] = n[3] = n[7] = n[11] = 0, n[15] = 1
            }, x.multiply = function (t, e, n) {
                var i, r, a, o, s, l, h, u;
                if (r = n.elements, a = t.elements, r === (o = e.elements)) for (o = new Float32Array(16), i = 0; i < 16; ++i) o[i] = r[i];
                var c = o[0], _ = o[1], d = o[2], f = o[3], m = o[4], p = o[5], T = o[6], E = o[7], v = o[8], g = o[9],
                    S = o[10], y = o[11], x = o[12], D = o[13], I = o[14], R = o[15];
                for (i = 0; i < 4; i++) s = a[i], l = a[i + 4], h = a[i + 8], u = a[i + 12], r[i] = s * c + l * _ + h * d + u * f, r[i + 4] = s * m + l * p + h * T + u * E, r[i + 8] = s * v + l * g + h * S + u * y, r[i + 12] = s * x + l * D + h * I + u * R
            }, x.multiplyForNative = function (t, e, n) {
                E.instance.matrix4x4Multiply(t.elements, e.elements, n.elements)
            }, x.createFromQuaternion = function (t, e) {
                var n = e.elements, i = t.x, r = t.y, a = t.z, o = t.w, s = i + i, l = r + r, h = a + a, u = i * s,
                    c = r * s, _ = r * l, d = a * s, f = a * l, m = a * h, p = o * s, T = o * l, E = o * h;
                n[0] = 1 - _ - m, n[1] = c + E, n[2] = d - T, n[3] = 0, n[4] = c - E, n[5] = 1 - u - m, n[6] = f + p, n[7] = 0, n[8] = d + T, n[9] = f - p, n[10] = 1 - u - _, n[11] = 0, n[12] = 0, n[13] = 0, n[14] = 0, n[15] = 1
            }, x.createAffineTransformation = function (t, e, n, i) {
                var r = i.elements, a = e.x, o = e.y, s = e.z, l = e.w, h = a + a, u = o + o, c = s + s, _ = a * h,
                    d = a * u, f = a * c, m = o * u, p = o * c, T = s * c, E = l * h, v = l * u, g = l * c, S = n.x,
                    y = n.y, x = n.z;
                r[0] = (1 - (m + T)) * S, r[1] = (d + g) * S, r[2] = (f - v) * S, r[3] = 0, r[4] = (d - g) * y, r[5] = (1 - (_ + T)) * y, r[6] = (p + E) * y, r[7] = 0, r[8] = (f + v) * x, r[9] = (p - E) * x, r[10] = (1 - (_ + m)) * x, r[11] = 0, r[12] = t.x, r[13] = t.y, r[14] = t.z, r[15] = 1
            }, x.createLookAt = function (t, e, n, i) {
                var r = i.elements, a = x._tempVector0, o = x._tempVector1, s = x._tempVector2;
                Lt.subtract(t, e, s), Lt.normalize(s, s), Lt.cross(n, s, a), Lt.normalize(a, a), Lt.cross(s, a, o), i.identity(), r[0] = a.x, r[4] = a.y, r[8] = a.z, r[1] = o.x, r[5] = o.y, r[9] = o.z, r[2] = s.x, r[6] = s.y, r[10] = s.z, r[12] = -Lt.dot(a, t), r[13] = -Lt.dot(o, t), r[14] = -Lt.dot(s, t)
            }, x.createPerspective = function (t, e, n, i, r) {
                var a = 1 / Math.tan(.5 * t), o = n / (a / e), s = n / a;
                x.createPerspectiveOffCenter(-o, o, -s, s, n, i, r)
            }, x.createPerspectiveOffCenter = function (t, e, n, i, r, a, o) {
                var s = o.elements, l = a / (a - r);
                s[1] = s[2] = s[3] = s[4] = s[6] = s[7] = s[12] = s[13] = s[15] = 0, s[0] = 2 * r / (e - t), s[5] = 2 * r / (i - n), s[8] = (t + e) / (e - t), s[9] = (i + n) / (i - n), s[10] = -l, s[11] = -1, s[14] = -r * l
            }, x.createOrthoOffCenter = function (t, e, n, i, r, a, o) {
                var s = o.elements, l = 1 / (a - r);
                s[1] = s[2] = s[3] = s[4] = s[6] = s[8] = s[7] = s[9] = s[11] = 0, s[15] = 1, s[0] = 2 / (e - t), s[5] = 2 / (i - n), s[10] = -l, s[12] = (t + e) / (t - e), s[13] = (i + n) / (n - i), s[14] = -r * l
            }, x.billboard = function (t, e, n, i, r, a) {
                Lt.subtract(t, e, x._tempVector0);
                var o = Lt.scalarLengthSquared(x._tempVector0);
                tt.isZero(o) ? (Lt.scale(r, -1, x._tempVector1), x._tempVector1.cloneTo(x._tempVector0)) : Lt.scale(x._tempVector0, 1 / Math.sqrt(o), x._tempVector0), Lt.cross(i, x._tempVector0, x._tempVector2), Lt.normalize(x._tempVector2, x._tempVector2), Lt.cross(x._tempVector0, x._tempVector2, x._tempVector3);
                var s = x._tempVector2, l = x._tempVector3, h = x._tempVector0, u = t, c = a.elements;
                c[0] = s.x, c[1] = s.y, c[2] = s.z, c[3] = 0, c[4] = l.x, c[5] = l.y, c[6] = l.z, c[7] = 0, c[8] = h.x, c[9] = h.y, c[10] = h.z, c[11] = 0, c[12] = u.x, c[13] = u.y, c[14] = u.z, c[15] = 1
            }, x.translation = function (t, e) {
                var n = e.elements;
                n[0] = n[5] = n[10] = n[15] = 1, n[12] = t.x, n[13] = t.y, n[14] = t.z
            }, _(x, ["_tempMatrix4x4", function () {
                return this._tempMatrix4x4 = new x
            }, "_tempVector0", function () {
                return this._tempVector0 = new Lt
            }, "_tempVector1", function () {
                return this._tempVector1 = new Lt
            }, "_tempVector2", function () {
                return this._tempVector2 = new Lt
            }, "_tempVector3", function () {
                return this._tempVector3 = new Lt
            }, "_tempQuaternion", function () {
                return this._tempQuaternion = new at
            }, "DEFAULT", function () {
                return this.DEFAULT = new x
            }, "ZERO", function () {
                return this.ZERO = new x(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
            }]), x
        }()), ke = function () {
            function A(t, e) {
                this._nativeDiscreteDynamicsWorld = null, this._nativeCollisionWorld = null, this._nativeDispatcher = null, this._nativeCollisionConfiguration = null, this._nativeBroadphase = null, this._nativeSolverInfo = null, this._nativeDispatchInfo = null, this._nativeClosestRayResultCallback = null, this._nativeAllHitsRayResultCallback = null, this._nativeClosestConvexResultCallback = null, this._nativeAllConvexResultCallback = null, this._updatedRigidbodies = 0, this.maxSubSteps = 1, this.fixedTimeStep = 1 / 60, this._gravity = new Lt(0, -10, 0), this._nativeVector3Zero = new k._physics3D.btVector3(0, 0, 0), this._nativeDefaultQuaternion = new k._physics3D.btQuaternion(0, 0, 0, -1), this._collisionsUtils = new Yt, this._previousFrameCollisions = [], this._currentFrameCollisions = [], this._physicsUpdateList = new cn, this._characters = [], void 0 === e && (e = 0), this.maxSubSteps = t.maxSubSteps, this.fixedTimeStep = t.fixedTimeStep;
                var n = k._physics3D;
                this._nativeCollisionConfiguration = new n.btDefaultCollisionConfiguration, this._nativeDispatcher = new n.btCollisionDispatcher(this._nativeCollisionConfiguration), this._nativeBroadphase = new n.btDbvtBroadphase, this._nativeBroadphase.getOverlappingPairCache().setInternalGhostPairCallback(new n.btGhostPairCallback);
                var i = t.flags;
                if (1 & i) this._nativeCollisionWorld = new n.btCollisionWorld(this._nativeDispatcher, this._nativeBroadphase, this._nativeCollisionConfiguration); else {
                    if (2 & i) throw"PhysicsSimulation:SoftBody processing is not yet available";
                    var r = new n.btSequentialImpulseConstraintSolver;
                    this._nativeDiscreteDynamicsWorld = new n.btDiscreteDynamicsWorld(this._nativeDispatcher, this._nativeBroadphase, r, this._nativeCollisionConfiguration), this._nativeCollisionWorld = this._nativeDiscreteDynamicsWorld
                }
                this._nativeDiscreteDynamicsWorld && (this._nativeSolverInfo = this._nativeDiscreteDynamicsWorld.getSolverInfo(), this._nativeDispatchInfo = this._nativeDiscreteDynamicsWorld.getDispatchInfo()), this._nativeClosestRayResultCallback = new n.ClosestRayResultCallback(this._nativeVector3Zero, this._nativeVector3Zero), this._nativeAllHitsRayResultCallback = new n.AllHitsRayResultCallback(this._nativeVector3Zero, this._nativeVector3Zero), this._nativeClosestConvexResultCallback = new n.ClosestConvexResultCallback(this._nativeVector3Zero, this._nativeVector3Zero), this._nativeAllConvexResultCallback = new n.AllConvexResultCallback(this._nativeVector3Zero, this._nativeVector3Zero), n._btGImpactCollisionAlgorithm_RegisterAlgorithm(this._nativeDispatcher.a)
            }

            d(A, "laya.d3.physics.PhysicsSimulation");
            var t = A.prototype;
            return t._simulate = function (t) {
                this._updatedRigidbodies = 0, this._nativeDiscreteDynamicsWorld ? this._nativeDiscreteDynamicsWorld.stepSimulation(t, this.maxSubSteps, this.fixedTimeStep) : this._nativeCollisionWorld.PerformDiscreteCollisionDetection()
            }, t._destroy = function () {
                var t = k._physics3D;
                this._nativeDiscreteDynamicsWorld ? (t.destroy(this._nativeDiscreteDynamicsWorld), this._nativeDiscreteDynamicsWorld = null) : (t.destroy(this._nativeCollisionWorld), this._nativeCollisionWorld = null), t.destroy(this._nativeBroadphase), this._nativeBroadphase = null, t.destroy(this._nativeDispatcher), this._nativeDispatcher = null, t.destroy(this._nativeCollisionConfiguration), this._nativeCollisionConfiguration = null
            }, t._addPhysicsCollider = function (t, e, n) {
                this._nativeCollisionWorld.addCollisionObject(t._nativeColliderObject, e, n)
            }, t._removePhysicsCollider = function (t) {
                this._nativeCollisionWorld.removeCollisionObject(t._nativeColliderObject)
            }, t._addRigidBody = function (t, e, n) {
                if (!this._nativeDiscreteDynamicsWorld) throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeCollisionWorld.addRigidBody(t._nativeColliderObject, e, n)
            }, t._removeRigidBody = function (t) {
                if (!this._nativeDiscreteDynamicsWorld) throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeCollisionWorld.removeRigidBody(t._nativeColliderObject)
            }, t._addCharacter = function (t, e, n) {
                if (!this._nativeDiscreteDynamicsWorld) throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeCollisionWorld.addCollisionObject(t._nativeColliderObject, e, n), this._nativeCollisionWorld.addAction(t._nativeKinematicCharacter)
            }, t._removeCharacter = function (t) {
                if (!this._nativeDiscreteDynamicsWorld) throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeCollisionWorld.removeCollisionObject(t._nativeColliderObject), this._nativeCollisionWorld.removeAction(t._nativeKinematicCharacter)
            }, t.raycastFromTo = function (t, e, n, i, r) {
                void 0 === i && (i = Ue.COLLISIONFILTERGROUP_ALLFILTER), void 0 === r && (r = Ue.COLLISIONFILTERGROUP_ALLFILTER);
                var a = this._nativeClosestRayResultCallback, o = A._nativeTempVector30, s = A._nativeTempVector31;
                if (o.setValue(-t.x, t.y, t.z), s.setValue(-e.x, e.y, e.z), a.set_m_rayFromWorld(o), a.set_m_rayToWorld(s), a.set_m_collisionFilterGroup(i), a.set_m_collisionFilterMask(r), a.set_m_collisionObject(null), a.set_m_closestHitFraction(1), this._nativeCollisionWorld.rayTest(o, s, a), a.hasHit()) {
                    if (n) {
                        n.succeeded = !0, n.collider = Xe._physicObjectsMap[a.get_m_collisionObject().getUserIndex()], n.hitFraction = a.get_m_closestHitFraction();
                        var l = a.get_m_hitPointWorld(), h = n.point;
                        h.x = -l.x(), h.y = l.y(), h.z = l.z();
                        var u = a.get_m_hitNormalWorld(), c = n.normal;
                        c.x = -u.x(), c.y = u.y(), c.z = u.z()
                    }
                    return !0
                }
                return n && (n.succeeded = !1), !1
            }, t.raycastAllFromTo = function (t, e, n, i, r) {
                void 0 === i && (i = Ue.COLLISIONFILTERGROUP_ALLFILTER), void 0 === r && (r = Ue.COLLISIONFILTERGROUP_ALLFILTER);
                var a = this._nativeAllHitsRayResultCallback, o = A._nativeTempVector30, s = A._nativeTempVector31;
                n.length = 0, o.setValue(-t.x, t.y, t.z), s.setValue(-e.x, e.y, e.z), a.set_m_rayFromWorld(o), a.set_m_rayToWorld(s), a.set_m_collisionFilterGroup(i), a.set_m_collisionFilterMask(r);
                var l = a.get_m_collisionObjects(), h = a.get_m_hitPointWorld(), u = a.get_m_hitNormalWorld(),
                    c = a.get_m_hitFractions();
                l.clear(), h.clear(), u.clear(), c.clear(), this._nativeCollisionWorld.rayTest(o, s, a);
                var _ = l.size();
                if (0 < _) {
                    this._collisionsUtils.recoverAllHitResultsPool();
                    for (var d = 0; d < _; d++) {
                        var f = this._collisionsUtils.getHitResult();
                        n.push(f), f.succeeded = !0, f.collider = Xe._physicObjectsMap[l.at(d).getUserIndex()], f.hitFraction = c.at(d);
                        var m = h.at(d), p = f.point;
                        p.x = -m.x(), p.y = m.y(), p.z = m.z();
                        var T = u.at(d), E = f.normal;
                        E.x = -T.x(), E.y = T.y(), E.z = T.z()
                    }
                    return !0
                }
                return !1
            }, t.rayCast = function (t, e, n, i, r) {
                void 0 === n && (n = 2147483647), void 0 === i && (i = Ue.COLLISIONFILTERGROUP_ALLFILTER), void 0 === r && (r = Ue.COLLISIONFILTERGROUP_ALLFILTER);
                var a = t.origin, o = A._tempVector30;
                return Lt.normalize(t.direction, o), Lt.scale(o, n, o), Lt.add(a, o, o), this.raycastFromTo(a, o, e, i, r)
            }, t.rayCastAll = function (t, e, n, i, r) {
                void 0 === n && (n = 2147483647), void 0 === i && (i = Ue.COLLISIONFILTERGROUP_ALLFILTER), void 0 === r && (r = Ue.COLLISIONFILTERGROUP_ALLFILTER);
                var a = t.origin, o = A._tempVector30;
                return Lt.normalize(t.direction, o), Lt.scale(o, n, o), Lt.add(a, o, o), this.raycastAllFromTo(a, o, e, i, r)
            }, t.shapeCast = function (t, e, n, i, r, a, o, s, l) {
                void 0 === o && (o = Ue.COLLISIONFILTERGROUP_ALLFILTER), void 0 === s && (s = Ue.COLLISIONFILTERGROUP_ALLFILTER), void 0 === l && (l = 0);
                var h = this._nativeClosestConvexResultCallback, u = A._nativeTempVector30, c = A._nativeTempVector31,
                    _ = A._nativeTempQuaternion0, d = A._nativeTempQuaternion1, f = A._nativeTempTransform0,
                    m = A._nativeTempTransform1, p = t._nativeShape;
                if (u.setValue(-e.x, e.y, e.z), c.setValue(-n.x, n.y, n.z), h.set_m_collisionFilterGroup(o), h.set_m_collisionFilterMask(s), f.setOrigin(u), m.setOrigin(c), r ? (_.setValue(-r.x, r.y, r.z, -r.w), f.setRotation(_)) : f.setRotation(this._nativeDefaultQuaternion), a ? (d.setValue(-a.x, a.y, a.z, -a.w), m.setRotation(d)) : m.setRotation(this._nativeDefaultQuaternion), h.set_m_hitCollisionObject(null), h.set_m_closestHitFraction(1), this._nativeCollisionWorld.convexSweepTest(p, f, m, h, l), h.hasHit()) {
                    if (i) {
                        i.succeeded = !0, i.collider = Xe._physicObjectsMap[h.get_m_hitCollisionObject().getUserIndex()], i.hitFraction = h.get_m_closestHitFraction();
                        var T = h.get_m_hitPointWorld(), E = h.get_m_hitNormalWorld(), v = i.point, g = i.normal;
                        v.x = -T.x(), v.y = T.y(), v.z = T.z(), g.x = -E.x(), g.y = E.y(), g.z = E.z()
                    }
                    return !0
                }
                return i && (i.succeeded = !1), !1
            }, t.shapeCastAll = function (t, e, n, i, r, a, o, s, l) {
                void 0 === o && (o = Ue.COLLISIONFILTERGROUP_ALLFILTER), void 0 === s && (s = Ue.COLLISIONFILTERGROUP_ALLFILTER), void 0 === l && (l = 0);
                var h = this._nativeAllConvexResultCallback, u = A._nativeTempVector30, c = A._nativeTempVector31,
                    _ = A._nativeTempQuaternion0, d = A._nativeTempQuaternion1, f = A._nativeTempTransform0,
                    m = A._nativeTempTransform1, p = t._nativeShape;
                i.length = 0, u.setValue(-e.x, e.y, e.z), c.setValue(-n.x, n.y, n.z), h.set_m_collisionFilterGroup(o), h.set_m_collisionFilterMask(s), f.setOrigin(u), m.setOrigin(c), r ? (_.setValue(-r.x, r.y, r.z, -r.w), f.setRotation(_)) : f.setRotation(this._nativeDefaultQuaternion), a ? (d.setValue(-a.x, a.y, a.z, -a.w), m.setRotation(d)) : m.setRotation(this._nativeDefaultQuaternion);
                var T = h.get_m_collisionObjects();
                T.clear(), this._nativeCollisionWorld.convexSweepTest(p, f, m, h, l);
                var E = T.size();
                if (0 < E) {
                    for (var v = h.get_m_hitPointWorld(), g = h.get_m_hitNormalWorld(), S = h.get_m_hitFractions(), y = 0; y < E; y++) {
                        var x = this._collisionsUtils.getHitResult();
                        i.push(x), x.succeeded = !0, x.collider = Xe._physicObjectsMap[T.at(y).getUserIndex()], x.hitFraction = S.at(y);
                        var D = v.at(y), I = x.point;
                        I.x = -D.x(), I.y = D.y(), I.z = D.z();
                        var R = g.at(y), M = x.normal;
                        M.x = -R.x(), M.y = R.y(), M.z = R.z()
                    }
                    return !0
                }
                return !1
            }, t.addConstraint = function (t, e) {
                if (void 0 === e && (e = !1), !this._nativeDiscreteDynamicsWorld) throw"Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeDiscreteDynamicsWorld.addConstraint(t._nativeConstraint, e), t._simulation = this
            }, t.removeConstraint = function (t) {
                if (!this._nativeDiscreteDynamicsWorld) throw"Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeDiscreteDynamicsWorld.removeConstraint(t._nativeConstraint)
            }, t._updatePhysicsTransformFromRender = function () {
                for (var t = this._physicsUpdateList.elements, e = 0, n = this._physicsUpdateList.length; e < n; e++) {
                    var i = t[e];
                    i._derivePhysicsTransformation(!1), i._inPhysicUpdateListIndex = -1
                }
                this._physicsUpdateList.length = 0
            }, t._updateCharacters = function () {
                for (var t = 0, e = this._characters.length; t < e; t++) {
                    var n = this._characters[t];
                    n._updateTransformComponent(n._nativeColliderObject.getWorldTransform())
                }
            }, t._updateCollisions = function () {
                this._collisionsUtils.recoverAllContactPointsPool();
                var t = this._currentFrameCollisions;
                this._currentFrameCollisions = this._previousFrameCollisions, this._currentFrameCollisions.length = 0, this._previousFrameCollisions = t;
                for (var e = C.loopCount, n = this._nativeDispatcher.getNumManifolds(), i = 0; i < n; i++) {
                    var r = this._nativeDispatcher.getManifoldByIndexInternal(i),
                        a = Xe._physicObjectsMap[r.getBody0().getUserIndex()],
                        o = Xe._physicObjectsMap[r.getBody1().getUserIndex()], s = null, l = !1, h = null;
                    if ((a.isTrigger || o.isTrigger) && (a.owner._needProcessTriggers || o.owner._needProcessTriggers)) for (var u = r.getNumContacts(), c = 0; c < u; c++) {
                        var _ = r.getContactPoint(c), d = _.getDistance();
                        if (d <= 0) {
                            h = (s = this._collisionsUtils.getCollision(a, o)).contacts, (l = s._updateFrame !== e) && (s._isTrigger = !0, h.length = 0);
                            break
                        }
                    } else if ((a.owner._needProcessCollisions || o.owner._needProcessCollisions) && (a._enableProcessCollisions || o._enableProcessCollisions)) for (u = r.getNumContacts(), c = 0; c < u; c++) if ((d = (_ = r.getContactPoint(c)).getDistance()) <= 0) {
                        var f = this._collisionsUtils.getContactPoints();
                        f.colliderA = a, f.colliderB = o, f.distance = d;
                        var m = _.get_m_normalWorldOnB(), p = f.normal;
                        p.x = -m.x(), p.y = m.y(), p.z = m.z();
                        var T = _.get_m_positionWorldOnA(), E = f.positionOnA;
                        E.x = -T.x(), E.y = T.y(), E.z = T.z();
                        var v = _.get_m_positionWorldOnB(), g = f.positionOnB;
                        g.x = -v.x(), g.y = v.y(), g.z = v.z(), s || (h = (s = this._collisionsUtils.getCollision(a, o)).contacts, (l = s._updateFrame !== e) && (s._isTrigger = !1, h.length = 0)), h.push(f)
                    }
                    s && l && (this._currentFrameCollisions.push(s), s._setUpdateFrame(e))
                }
            }, t._eventScripts = function () {
                for (var t = C.loopCount, e = 0, n = this._currentFrameCollisions.length; e < n; e++) {
                    var i = this._currentFrameCollisions[e], r = i._colliderA, a = i._colliderB;
                    if (!r.destroyed && !a.destroyed) if (t - i._lastUpdateFrame == 1) {
                        var o = r.owner, s = o._scripts;
                        if (s) if (i._isTrigger) {
                            if (o._needProcessTriggers) for (var l = 0, h = s.length; l < h; l++) s[l].onTriggerStay(a)
                        } else if (o._needProcessCollisions) for (l = 0, h = s.length; l < h; l++) i.other = a, s[l].onCollisionStay(i);
                        var u = a.owner, c = u._scripts;
                        if (c) if (i._isTrigger) {
                            if (u._needProcessTriggers) for (l = 0, h = c.length; l < h; l++) c[l].onTriggerStay(r)
                        } else if (u._needProcessCollisions) for (l = 0, h = c.length; l < h; l++) i.other = r, c[l].onCollisionStay(i)
                    } else {
                        if (s = (o = r.owner)._scripts) if (i._isTrigger) {
                            if (o._needProcessTriggers) for (l = 0, h = s.length; l < h; l++) s[l].onTriggerEnter(a)
                        } else if (o._needProcessCollisions) for (l = 0, h = s.length; l < h; l++) i.other = a, s[l].onCollisionEnter(i);
                        if (c = (u = a.owner)._scripts) if (i._isTrigger) {
                            if (u._needProcessTriggers) for (l = 0, h = c.length; l < h; l++) c[l].onTriggerEnter(r)
                        } else if (u._needProcessCollisions) for (l = 0, h = c.length; l < h; l++) i.other = r, c[l].onCollisionEnter(i)
                    }
                }
                for (e = 0, n = this._previousFrameCollisions.length; e < n; e++) {
                    var _ = this._previousFrameCollisions[e], d = _._colliderA, f = _._colliderB;
                    if (!d.destroyed && !f.destroyed && t - _._updateFrame == 1) {
                        if (this._collisionsUtils.recoverCollision(_), s = (o = d.owner)._scripts) if (_._isTrigger) {
                            if (o._needProcessTriggers) for (l = 0, h = s.length; l < h; l++) s[l].onTriggerExit(f)
                        } else if (o._needProcessCollisions) for (l = 0, h = s.length; l < h; l++) _.other = f, s[l].onCollisionExit(_);
                        if (c = (u = f.owner)._scripts) if (_._isTrigger) {
                            if (u._needProcessTriggers) for (l = 0, h = c.length; l < h; l++) c[l].onTriggerExit(d)
                        } else if (u._needProcessCollisions) for (l = 0, h = c.length; l < h; l++) _.other = d, c[l].onCollisionExit(_)
                    }
                }
            }, t.clearForces = function () {
                if (!this._nativeDiscreteDynamicsWorld) throw"Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeDiscreteDynamicsWorld.clearForces()
            }, u(0, t, "gravity", function () {
                if (!this._nativeDiscreteDynamicsWorld) throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                return this._gravity
            }, function (t) {
                if (!this._nativeDiscreteDynamicsWorld) throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._gravity = t;
                var e = A._nativeTempVector30;
                e.setValue(-t.x, t.y, t.z), this._nativeDiscreteDynamicsWorld.setGravity(e)
            }), u(0, t, "continuousCollisionDetection", function () {
                return this._nativeDispatchInfo.get_m_useContinuous()
            }, function (t) {
                this._nativeDispatchInfo.set_m_useContinuous(t)
            }), u(0, t, "speculativeContactRestitution", function () {
                if (!this._nativeDiscreteDynamicsWorld) throw"Simulation:Cannot Cannot perform this action when the physics engine is set to CollisionsOnly";
                return this._nativeDiscreteDynamicsWorld.getApplySpeculativeContactRestitution()
            }, function (t) {
                if (!this._nativeDiscreteDynamicsWorld) throw"Simulation:Cannot Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeDiscreteDynamicsWorld.setApplySpeculativeContactRestitution(t)
            }), A.createConstraint = function () {
            }, A.PHYSICSENGINEFLAGS_NONE = 0, A.PHYSICSENGINEFLAGS_COLLISIONSONLY = 1, A.PHYSICSENGINEFLAGS_SOFTBODYSUPPORT = 2, A.PHYSICSENGINEFLAGS_MULTITHREADED = 4, A.PHYSICSENGINEFLAGS_USEHARDWAREWHENPOSSIBLE = 8, A.SOLVERMODE_RANDMIZE_ORDER = 1, A.SOLVERMODE_FRICTION_SEPARATE = 2, A.SOLVERMODE_USE_WARMSTARTING = 4, A.SOLVERMODE_USE_2_FRICTION_DIRECTIONS = 16, A.SOLVERMODE_ENABLE_FRICTION_DIRECTION_CACHING = 32, A.SOLVERMODE_DISABLE_VELOCITY_DEPENDENT_FRICTION_DIRECTION = 64, A.SOLVERMODE_CACHE_FRIENDLY = 128, A.SOLVERMODE_SIMD = 256, A.SOLVERMODE_INTERLEAVE_CONTACT_AND_FRICTION_CONSTRAINTS = 512, A.SOLVERMODE_ALLOW_ZERO_LENGTH_FRICTION_DIRECTIONS = 1024, A.disableSimulation = !1, _(A, ["_nativeTempVector30", function () {
                return this._nativeTempVector30 = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeTempVector31", function () {
                return this._nativeTempVector31 = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeTempQuaternion0", function () {
                return this._nativeTempQuaternion0 = new k._physics3D.btQuaternion(0, 0, 0, 1)
            }, "_nativeTempQuaternion1", function () {
                return this._nativeTempQuaternion1 = new k._physics3D.btQuaternion(0, 0, 0, 1)
            }, "_nativeTempTransform0", function () {
                return this._nativeTempTransform0 = new k._physics3D.btTransform
            }, "_nativeTempTransform1", function () {
                return this._nativeTempTransform1 = new k._physics3D.btTransform
            }, "_tempVector30", function () {
                return this._tempVector30 = new Lt
            }]), A
        }(), Xe = function (e) {
            function f(t, e) {
                this._restitution = 0, this._friction = .5, this._rollingFriction = 0, this._ccdMotionThreshold = 0, this._ccdSweptSphereRadius = 0, this._colliderShape = null, this._transformFlag = 2147483647, this._enableProcessCollisions = !0, this._inPhysicUpdateListIndex = -1, this.canScaleShape = !0, f.__super.call(this), this._collisionGroup = 1, this._canCollideWith = Ue.COLLISIONFILTERGROUP_ALLFILTER, this._collisionGroup = t, this._canCollideWith = e, f._physicObjectsMap[this.id] = this
            }

            d(f, "laya.d3.physics.PhysicsComponent", e);
            var t = f.prototype;
            return t._isValid = function () {
                return this._simulation && this._colliderShape && this._enabled
            }, t._parse = function (t) {
                null != t.collisionGroup && (this.collisionGroup = t.collisionGroup), null != t.canCollideWith && (this.canCollideWith = t.canCollideWith), null != t.ccdMotionThreshold && (this.ccdMotionThreshold = t.ccdMotionThreshold), null != t.ccdSweptSphereRadius && (this.ccdSweptSphereRadius = t.ccdSweptSphereRadius)
            }, t._parseShape = function (t) {
                var e = t.length;
                if (1 === e) {
                    var n = H._creatShape(t[0]);
                    this.colliderShape = n
                } else {
                    for (var i = new fn, r = 0; r < e; r++) n = H._creatShape(t[r]), i.addChildShape(n);
                    this.colliderShape = i
                }
            }, t._onScaleChange = function (t) {
                this._colliderShape._setScale(t)
            }, t._setTransformFlag = function (t, e) {
                e ? this._transformFlag |= t : this._transformFlag &= ~t
            }, t._getTransformFlag = function (t) {
                return 0 != (this._transformFlag & t)
            }, t._addToSimulation = function () {
            }, t._removeFromSimulation = function () {
            }, t._derivePhysicsTransformation = function (t) {
                this._innerDerivePhysicsTransformation(this._nativeColliderObject.getWorldTransform(), t)
            }, t._innerDerivePhysicsTransformation = function (t, e) {
                var n = this.owner._transform, i = n.rotation;
                if (e || this._getTransformFlag(8)) {
                    var r = this._colliderShape.localOffset, a = n.position, o = f._nativeVector30;
                    if (0 !== r.x || 0 !== r.y || 0 !== r.z) {
                        var s = f._tempVector30;
                        f.physicVector3TransformQuat(r, i.x, i.y, i.z, i.w, s), Lt.add(a, s, s), o.setValue(-s.x, s.y, s.z)
                    } else o.setValue(-a.x, a.y, a.z);
                    t.setOrigin(o), this._setTransformFlag(8, !1)
                }
                if (e || this._getTransformFlag(16)) {
                    var l = this._colliderShape.localRotation, h = f._nativeQuaternion0;
                    if (0 !== l.x || 0 !== l.y || 0 !== l.z || 1 !== l.w) {
                        var u = f._tempQuaternion0;
                        f.physicQuaternionMultiply(i.x, i.y, i.z, i.w, l, u), h.setValue(-u.x, u.y, u.z, -u.w)
                    } else h.setValue(-i.x, i.y, i.z, -i.w);
                    t.setRotation(h), this._setTransformFlag(16, !1)
                }
                (e || this._getTransformFlag(32)) && (this._onScaleChange(n.scale), this._setTransformFlag(32, !1))
            }, t._updateTransformComponent = function (t) {
                var e = this._colliderShape.localOffset, n = this._colliderShape.localRotation,
                    i = this.owner._transform, r = i.position, a = i.rotation, o = t.getOrigin(), s = t.getRotation(),
                    l = -s.x(), h = s.y(), u = s.z(), c = -s.w();
                if (0 !== e.x || 0 !== e.y || 0 !== e.z) {
                    var _ = f._tempVector30;
                    f.physicVector3TransformQuat(e, l, h, u, c, _), r.x = -o.x() - _.x, r.y = o.y() - _.y, r.z = o.z() - _.z
                } else r.x = -o.x(), r.y = o.y(), r.z = o.z();
                if (i.position = r, 0 !== n.x || 0 !== n.y || 0 !== n.z || 1 !== n.w) {
                    var d = f._tempQuaternion0;
                    n.invert(d), f.physicQuaternionMultiply(l, h, u, c, d, a)
                } else a.x = l, a.y = h, a.z = u, a.w = c;
                i.rotation = a
            }, t._onEnable = function () {
                this._simulation = this.owner._scene.physicsSimulation, this._nativeColliderObject.setContactProcessingThreshold(1e30), this._colliderShape && this._enabled && (this._derivePhysicsTransformation(!0), this._addToSimulation())
            }, t._onDisable = function () {
                this._colliderShape && this._enabled && (this._removeFromSimulation(), -1 !== this._inPhysicUpdateListIndex && this._simulation._physicsUpdateList.remove(this)), this._simulation = null
            }, t._onShapeChange = function (t) {
                var e = this._nativeColliderObject, n = e.getCollisionFlags();
                t.needsCustomCollisionCallback ? 0 == (8 & n) && e.setCollisionFlags(8 | n) : 0 < (8 & n) && e.setCollisionFlags(8 ^ n)
            }, t._onAdded = function () {
                this.enabled = this._enabled, this.restitution = this._restitution, this.friction = this._friction, this.rollingFriction = this._rollingFriction, this.ccdMotionThreshold = this._ccdMotionThreshold, this.ccdSweptSphereRadius = this._ccdSweptSphereRadius, this.owner.transform.on("transformchanged", this, this._onTransformChanged)
            }, t._onDestroy = function () {
                var t = k._physics3D;
                delete f._physicObjectsMap[this.id], t.destroy(this._nativeColliderObject), this._colliderShape.destroy(), e.prototype._onDestroy.call(this), this._nativeColliderObject = null, this._colliderShape = null, this._simulation = null, this.owner.transform.off("transformchanged", this, this._onTransformChanged)
            }, t._onTransformChanged = function (t) {
                f._addUpdateList && (t &= 56) && (this._transformFlag |= t, this._isValid() && -1 === this._inPhysicUpdateListIndex && this._simulation._physicsUpdateList.add(this))
            }, t._cloneTo = function (t) {
                var e = t;
                e.restitution = this._restitution, e.friction = this._friction, e.rollingFriction = this._rollingFriction, e.ccdMotionThreshold = this._ccdMotionThreshold, e.ccdSweptSphereRadius = this._ccdSweptSphereRadius, e.collisionGroup = this._collisionGroup, e.canCollideWith = this._canCollideWith, e.canScaleShape = this.canScaleShape, this._colliderShape && (e.colliderShape = this._colliderShape.clone())
            }, u(0, t, "isActive", function () {
                return !!this._nativeColliderObject && this._nativeColliderObject.isActive()
            }), u(0, t, "restitution", function () {
                return this._restitution
            }, function (t) {
                this._restitution = t, this._nativeColliderObject && this._nativeColliderObject.setRestitution(t)
            }), u(0, t, "friction", function () {
                return this._friction
            }, function (t) {
                this._friction = t, this._nativeColliderObject && this._nativeColliderObject.setFriction(t)
            }), u(0, t, "rollingFriction", function () {
                return this._nativeColliderObject.getRollingFriction()
            }, function (t) {
                this._rollingFriction = t, this._nativeColliderObject && this._nativeColliderObject.setRollingFriction(t)
            }), u(0, t, "ccdMotionThreshold", function () {
                return this._ccdMotionThreshold
            }, function (t) {
                this._ccdMotionThreshold = t, this._nativeColliderObject && this._nativeColliderObject.setCcdMotionThreshold(t)
            }), u(0, t, "ccdSweptSphereRadius", function () {
                return this._ccdSweptSphereRadius
            }, function (t) {
                this._ccdSweptSphereRadius = t, this._nativeColliderObject && this._nativeColliderObject.setCcdSweptSphereRadius(t)
            }), u(0, t, "collisionGroup", function () {
                return this._collisionGroup
            }, function (t) {
                this._collisionGroup !== t && (this._collisionGroup = t, this._simulation && this._colliderShape && this._enabled && (this._removeFromSimulation(), this._addToSimulation()))
            }), u(0, t, "simulation", function () {
                return this._simulation
            }), u(0, t, "colliderShape", function () {
                return this._colliderShape
            }, function (t) {
                var e = this._colliderShape;
                if (e && (e._attatched = !1, e._attatchedCollisionObject = null), this._colliderShape = t) {
                    if (t._attatched) throw"PhysicsComponent: this shape has attatched to other entity.";
                    if (t._attatched = !0, (t._attatchedCollisionObject = this)._nativeColliderObject) {
                        this._nativeColliderObject.setCollisionShape(t._nativeShape);
                        var n = this._simulation && this._enabled;
                        n && e && this._removeFromSimulation(), this._onShapeChange(t), n && (this._derivePhysicsTransformation(!0), this._addToSimulation())
                    }
                } else this._simulation && this._enabled && e && this._removeFromSimulation()
            }), u(0, t, "enabled", e.prototype._$get_enabled, function (t) {
                this._simulation && this._colliderShape && (t ? (this._derivePhysicsTransformation(!0), this._addToSimulation()) : this._removeFromSimulation()), m.superSet(r, this, "enabled", t)
            }), u(0, t, "canCollideWith", function () {
                return this._canCollideWith
            }, function (t) {
                this._canCollideWith !== t && (this._canCollideWith = t, this._simulation && this._colliderShape && this._enabled && (this._removeFromSimulation(), this._addToSimulation()))
            }), f._createAffineTransformationArray = function (t, e, n, i, r, a, o, s, l) {
                var h = i + i, u = r + r, c = a + a, _ = i * h, d = i * u, f = i * c, m = r * u, p = r * c, T = a * c,
                    E = o * h, v = o * u, g = o * c, S = s[0], y = s[1], x = s[2];
                l[0] = (1 - (m + T)) * S, l[1] = (d + g) * S, l[2] = (f - v) * S, l[3] = 0, l[4] = (d - g) * y, l[5] = (1 - (_ + T)) * y, l[6] = (p + E) * y, l[7] = 0, l[8] = (f + v) * x, l[9] = (p - E) * x, l[10] = (1 - (_ + m)) * x, l[11] = 0, l[12] = t, l[13] = e, l[14] = n, l[15] = 1
            }, f.physicVector3TransformQuat = function (t, e, n, i, r, a) {
                var o = t.x, s = t.y, l = t.z, h = r * o + n * l - i * s, u = r * s + i * o - e * l,
                    c = r * l + e * s - n * o, _ = -e * o - n * s - i * l;
                a.x = h * r + _ * -e + u * -i - c * -n, a.y = u * r + _ * -n + c * -e - h * -i, a.z = c * r + _ * -i + h * -n - u * -e
            }, f.physicQuaternionMultiply = function (t, e, n, i, r, a) {
                var o = r.x, s = r.y, l = r.z, h = r.w, u = e * l - n * s, c = n * o - t * l, _ = t * s - e * o,
                    d = t * o + e * s + n * l;
                a.x = t * h + o * i + u, a.y = e * h + s * i + c, a.z = n * h + l * i + _, a.w = i * h - d
            }, f.ACTIVATIONSTATE_ACTIVE_TAG = 1, f.ACTIVATIONSTATE_ISLAND_SLEEPING = 2, f.ACTIVATIONSTATE_WANTS_DEACTIVATION = 3, f.ACTIVATIONSTATE_DISABLE_DEACTIVATION = 4, f.ACTIVATIONSTATE_DISABLE_SIMULATION = 5, f.COLLISIONFLAGS_STATIC_OBJECT = 1, f.COLLISIONFLAGS_KINEMATIC_OBJECT = 2, f.COLLISIONFLAGS_NO_CONTACT_RESPONSE = 4, f.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK = 8, f.COLLISIONFLAGS_CHARACTER_OBJECT = 16, f.COLLISIONFLAGS_DISABLE_VISUALIZE_OBJECT = 32, f.COLLISIONFLAGS_DISABLE_SPU_COLLISION_PROCESSING = 64, f._physicObjectsMap = {}, f._addUpdateList = !0, _(f, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempQuaternion0", function () {
                return this._tempQuaternion0 = new at
            }, "_tempQuaternion1", function () {
                return this._tempQuaternion1 = new at
            }, "_tempMatrix4x40", function () {
                return this._tempMatrix4x40 = new He
            }, "_nativeVector30", function () {
                return this._nativeVector30 = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeQuaternion0", function () {
                return this._nativeQuaternion0 = new k._physics3D.btQuaternion(0, 0, 0, 1)
            }]), f
        }(r), We = function (t) {
            function a(t) {
                if (this._indexInList = -1, this._indexInCastShadowList = -1, this._boundsChange = !0, this._visible = !0, this._indexInOctreeMotionList = -1, this._updateMark = -1, this._updateRenderType = -1, this._isPartOfStaticBatch = !1, this._staticBatch = null, a.__super.call(this), this._sharedMaterials = [], this._id = ++a._uniqueIDCounter, this._indexInCastShadowList = -1, this._bounds = new xe(Lt._ZERO, Lt._ZERO), b.supportWebGLPlusCulling) {
                    var e = we._cullingBufferLength;
                    this._cullingBufferIndex = e;
                    var n = we._cullingBuffer, i = e + 7;
                    if (i >= n.length) {
                        var r = n;
                        (n = we._cullingBuffer = new Float32Array(n.length + 4096)).set(r, 0)
                    }
                    n[e] = 2, we._cullingBufferLength = i
                }
                this._renderElements = [], this._owner = t, this._enable = !0, this._materialsInstance = [], this._shaderValues = new ot(null), this._defineDatas = new Ut, this.lightmapIndex = -1, this._castShadow = !1, this.receiveShadow = !1, this.sortingFudge = 0, t && this._owner.transform.on("transformchanged", this, this._onWorldMatNeedChange)
            }

            d(a, "laya.d3.core.render.BaseRender", f);
            var e = a.prototype;
            return m.imps(e, {
                "laya.resource.ISingletonElement": !0,
                "laya.d3.core.scene.IOctreeObject": !0
            }), e._getOctreeNode = function () {
                return this._octreeNode
            }, e._setOctreeNode = function (t) {
                this._octreeNode = t
            }, e._getIndexInMotionList = function () {
                return this._indexInOctreeMotionList
            }, e._setIndexInMotionList = function (t) {
                this._indexInOctreeMotionList = t
            }, e._changeMaterialReference = function (t, e) {
                t && t._removeReference(), e._addReference()
            }, e._getInstanceMaterial = function (t, e) {
                var n = new t.constructor;
                return t.cloneTo(n), n.name = n.name + "(Instance)", this._materialsInstance[e] = !0, this._changeMaterialReference(this._sharedMaterials[e], n), this._sharedMaterials[e] = n
            }, e._applyLightMapParams = function () {
                if (this._scene && 0 <= this._lightmapIndex) {
                    var t = this._scene.getlightmaps();
                    this._lightmapIndex < t.length ? (this._defineDatas.add(Jn.SAHDERDEFINE_LIGHTMAP), this._shaderValues.setTexture(Jn.LIGHTMAP, t[this._lightmapIndex])) : this._defineDatas.remove(Jn.SAHDERDEFINE_LIGHTMAP)
                } else this._defineDatas.remove(Jn.SAHDERDEFINE_LIGHTMAP)
            }, e._onWorldMatNeedChange = function (t) {
                this._boundsChange = !0, this._octreeNode && (t &= 56) && -1 === this._indexInOctreeMotionList && this._octreeNode._octree.addMotionObject(this)
            }, e._calculateBoundingBox = function () {
                throw"BaseRender: must override it."
            }, e._getIndexInList = function () {
                return this._indexInList
            }, e._setIndexInList = function (t) {
                this._indexInList = t
            }, e._setBelongScene = function (t) {
                this._scene !== t && (this._scene = t, this._applyLightMapParams())
            }, e._needRender = function (t) {
                return !0
            }, e._renderUpdate = function (t, e) {
            }, e._renderUpdateWithCamera = function (t, e) {
            }, e._revertBatchRenderUpdate = function (t) {
            }, e._destroy = function () {
                -1 !== this._indexInOctreeMotionList && this._octreeNode._octree.removeMotionObject(this), this.offAll();
                var t = 0, e = 0;
                for (t = 0, e = this._renderElements.length; t < e; t++) this._renderElements[t].destroy();
                for (t = 0, e = this._sharedMaterials.length; t < e; t++) this._sharedMaterials[t].destroyed || this._sharedMaterials[t]._removeReference();
                this._renderElements = null, this._owner = null, this._sharedMaterials = null, this._bounds = null, this._lightmapScaleOffset = null
            }, u(0, e, "bounds", function () {
                return this._boundsChange && (this._calculateBoundingBox(), this._boundsChange = !1), this._bounds
            }), u(0, e, "id", function () {
                return this._id
            }), u(0, e, "material", function () {
                var t = this._sharedMaterials[0];
                if (t && !this._materialsInstance[0]) {
                    var e = this._getInstanceMaterial(t, 0), n = this._renderElements[0];
                    n && (n.material = e)
                }
                return this._sharedMaterials[0]
            }, function (t) {
                this.sharedMaterial = t
            }), u(0, e, "isPartOfStaticBatch", function () {
                return this._isPartOfStaticBatch
            }), u(0, e, "sharedMaterial", function () {
                return this._sharedMaterials[0]
            }, function (t) {
                var e = this._sharedMaterials[0];
                if (e !== t) {
                    this._sharedMaterials[0] = t, this._materialsInstance[0] = !1, this._changeMaterialReference(e, t);
                    var n = this._renderElements[0];
                    n && (n.material = t)
                }
            }), u(0, e, "lightmapIndex", function () {
                return this._lightmapIndex
            }, function (t) {
                this._lightmapIndex !== t && (this._lightmapIndex = t, this._applyLightMapParams())
            }), u(0, e, "lightmapScaleOffset", function () {
                return this._lightmapScaleOffset
            }, function (t) {
                this._lightmapScaleOffset = t, this._shaderValues.setVector(Jn.LIGHTMAPSCALEOFFSET, t), this._defineDatas.add(Jn.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)
            }), u(0, e, "castShadow", function () {
                return this._castShadow
            }, function (t) {
                this._castShadow !== t && (this._owner.activeInHierarchy && (t ? this._scene._addShadowCastRenderObject(this) : this._scene._removeShadowCastRenderObject(this)), this._castShadow = t)
            }), u(0, e, "enable", function () {
                return this._enable
            }, function (t) {
                this._enable = !!t
            }), u(0, e, "materials", function () {
                for (var t = 0, e = this._sharedMaterials.length; t < e; t++) if (!this._materialsInstance[t]) {
                    var n = this._getInstanceMaterial(this._sharedMaterials[t], t), i = this._renderElements[t];
                    i && (i.material = n)
                }
                return this._sharedMaterials.slice()
            }, function (t) {
                this.sharedMaterials = t
            }), u(0, e, "sharedMaterials", function () {
                return this._sharedMaterials.slice()
            }, function (t) {
                for (var e = this._sharedMaterials, n = 0, i = e.length; n < i; n++) e[n]._removeReference();
                if (!t) throw new Error("BaseRender: shadredMaterials value can't be null.");
                var r = t.length;
                for (this._materialsInstance.length = r, e.length = r, n = 0; n < r; n++) {
                    var a = e[n], o = t[n];
                    if (a !== o) {
                        this._materialsInstance[n] = !1;
                        var s = this._renderElements[n];
                        s && (s.material = o)
                    }
                    o._addReference(), e[n] = o
                }
            }), u(0, e, "receiveShadow", function () {
                return this._receiveShadow
            }, function (t) {
                this._receiveShadow !== t && ((this._receiveShadow = t) ? this._defineDatas.add(Jn.SHADERDEFINE_RECEIVE_SHADOW) : this._defineDatas.remove(Jn.SHADERDEFINE_RECEIVE_SHADOW))
            }), a._uniqueIDCounter = 0, _(a, ["_tempBoundBoxCorners", function () {
                return this._tempBoundBoxCorners = [new Lt, new Lt, new Lt, new Lt, new Lt, new Lt, new Lt, new Lt]
            }]), a
        }(), Ye = (function (t) {
            function e() {
                e.__super.call(this)
            }

            d(e, "laya.d3.component.Script3D", r);
            var n = e.prototype;
            n._checkProcessTriggers = function () {
                var t = laya.d3.component.Script3D.prototype;
                return this.onTriggerEnter !== t.onTriggerEnter || (this.onTriggerStay !== t.onTriggerStay || this.onTriggerExit !== t.onTriggerExit)
            }, n._checkProcessCollisions = function () {
                var t = laya.d3.component.Script3D.prototype;
                return this.onCollisionEnter !== t.onCollisionEnter || (this.onCollisionStay !== t.onCollisionStay || this.onCollisionExit !== t.onCollisionExit)
            }, n._onAwake = function () {
                this.onAwake(), this.onStart !== laya.d3.component.Script3D.prototype.onStart && m.startTimer.callLater(this, this.onStart)
            }, n._onEnable = function () {
                this.owner._scene._scriptPool.add(this);
                var t = laya.d3.component.Script3D.prototype;
                this.onKeyDown !== t.onKeyDown && m.stage.on("keydown", this, this.onKeyDown), this.onKeyPress !== t.onKeyPress && m.stage.on("keypress", this, this.onKeyUp), this.onKeyUp !== t.onKeyUp && m.stage.on("keyup", this, this.onKeyUp)
            }, n._onDisable = function () {
                this.owner._scene._scriptPool.remove(this), this.owner.offAllCaller(this), m.stage.offAllCaller(this)
            }, n._isScript = function () {
                return !0
            }, n._onAdded = function () {
                var t = this.owner, e = t._scripts;
                e || (t._scripts = e = []), e.push(this), t._needProcessCollisions || (t._needProcessCollisions = this._checkProcessCollisions()), t._needProcessTriggers || (t._needProcessTriggers = this._checkProcessTriggers())
            }, n._onDestroy = function () {
                var t = this.owner._scripts;
                t.splice(t.indexOf(this), 1);
                var e = this.owner;
                e._needProcessTriggers = !1;
                for (var n = 0, i = t.length; n < i; n++) if (t[n]._checkProcessTriggers()) {
                    e._needProcessTriggers = !0;
                    break
                }
                for (e._needProcessCollisions = !1, n = 0, i = t.length; n < i; n++) if (t[n]._checkProcessCollisions()) {
                    e._needProcessCollisions = !0;
                    break
                }
                this.onDestroy()
            }, n.onAwake = function () {
            }, n.onEnable = function () {
            }, n.onStart = function () {
            }, n.onTriggerEnter = function (t) {
            }, n.onTriggerStay = function (t) {
            }, n.onTriggerExit = function (t) {
            }, n.onCollisionEnter = function (t) {
            }, n.onCollisionStay = function (t) {
            }, n.onCollisionExit = function (t) {
            }, n.onMouseDown = function () {
            }, n.onMouseDrag = function () {
            }, n.onMouseClick = function () {
            }, n.onMouseUp = function () {
            }, n.onMouseEnter = function () {
            }, n.onMouseOver = function () {
            }, n.onMouseOut = function () {
            }, n.onKeyDown = function (t) {
            }, n.onKeyPress = function (t) {
            }, n.onKeyUp = function (t) {
            }, n.onUpdate = function () {
            }, n.onLateUpdate = function () {
            }, n.onPreRender = function () {
            }, n.onPostRender = function () {
            }, n.onDisable = function () {
            }, n.onDestroy = function () {
            }, u(0, n, "isSingleton", function () {
                return !1
            })
        }(), function (t) {
            function o(t) {
                this._owner = null, this._children = null, this._parent = null, this._dummy = null, this._transformFlag = 0, o.__super.call(this), this._localPosition = new Lt(0, 0, 0), this._localRotation = new at(0, 0, 0, 1), this._localScale = new Lt(1, 1, 1), this._localRotationEuler = new Lt(0, 0, 0), this._localMatrix = new He, this._position = new Lt(0, 0, 0), this._rotation = new at(0, 0, 0, 1), this._scale = new Lt(1, 1, 1), this._rotationEuler = new Lt(0, 0, 0), this._worldMatrix = new He, this._owner = t, this._children = [], this._setTransformFlag(7, !1), this._setTransformFlag(248, !0)
            }

            d(o, "laya.d3.core.Transform3D", f);
            var e = o.prototype;
            return e._setTransformFlag = function (t, e) {
                e ? this._transformFlag |= t : this._transformFlag &= ~t
            }, e._getTransformFlag = function (t) {
                return 0 != (this._transformFlag & t)
            }, e._setParent = function (t) {
                if (this._parent !== t) {
                    if (this._parent) {
                        var e = this._parent._children, n = e.indexOf(this);
                        e.splice(n, 1)
                    }
                    t && (t._children.push(this), t && this._onWorldTransform()), this._parent = t
                }
            }, e._updateLocalMatrix = function () {
                He.createAffineTransformation(this._localPosition, this.localRotation, this._localScale, this._localMatrix)
            }, e._onWorldPositionRotationTransform = function () {
                if (!(this._getTransformFlag(64) && this._getTransformFlag(8) && this._getTransformFlag(16) && this._getTransformFlag(128))) {
                    this._setTransformFlag(216, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldPositionRotationTransform()
                }
            }, e._onWorldPositionScaleTransform = function () {
                if (!this._getTransformFlag(64) || !this._getTransformFlag(8) || !this._getTransformFlag(32)) {
                    this._setTransformFlag(104, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldPositionScaleTransform()
                }
            }, e._onWorldPositionTransform = function () {
                if (!this._getTransformFlag(64) || !this._getTransformFlag(8)) {
                    this._setTransformFlag(72, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldPositionTransform()
                }
            }, e._onWorldRotationTransform = function () {
                if (!this._getTransformFlag(64) || !this._getTransformFlag(16) || !this._getTransformFlag(128)) {
                    this._setTransformFlag(208, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldPositionRotationTransform()
                }
            }, e._onWorldScaleTransform = function () {
                if (!this._getTransformFlag(64) || !this._getTransformFlag(32)) {
                    this._setTransformFlag(96, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldPositionScaleTransform()
                }
            }, e._onWorldTransform = function () {
                if (!(this._getTransformFlag(64) && this._getTransformFlag(8) && this._getTransformFlag(16) && this._getTransformFlag(128) && this._getTransformFlag(32))) {
                    this._setTransformFlag(248, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldTransform()
                }
            }, e.translate = function (t, e) {
                void 0 === e && (e = !0), e ? (He.createFromQuaternion(this.localRotation, o._tempMatrix0), Lt.transformCoordinate(t, o._tempMatrix0, o._tempVector30), Lt.add(this.localPosition, o._tempVector30, this._localPosition), this.localPosition = this._localPosition) : (Lt.add(this.position, t, this._position), this.position = this._position)
            }, e.rotate = function (t, e, n) {
                var i;
                void 0 === e && (e = !0), void 0 === n && (n = !0), i = n ? t : (Lt.scale(t, Math.PI / 180, o._tempVector30), o._tempVector30), at.createFromYawPitchRoll(i.y, i.x, i.z, o._tempQuaternion0), e ? (at.multiply(this._localRotation, o._tempQuaternion0, this._localRotation), this.localRotation = this._localRotation) : (at.multiply(o._tempQuaternion0, this.rotation, this._rotation), this.rotation = this._rotation)
            }, e.getForward = function (t) {
                var e = this.worldMatrix.elements;
                t.x = -e[8], t.y = -e[9], t.z = -e[10]
            }, e.getUp = function (t) {
                var e = this.worldMatrix.elements;
                t.x = e[4], t.y = e[5], t.z = e[6]
            }, e.getRight = function (t) {
                var e = this.worldMatrix.elements;
                t.x = e[0], t.y = e[1], t.z = e[2]
            }, e.lookAt = function (t, e, n) {
                var i;
                if (void 0 === n && (n = !1), n) {
                    if (i = this._localPosition, Math.abs(i.x - t.x) < tt.zeroTolerance && Math.abs(i.y - t.y) < tt.zeroTolerance && Math.abs(i.z - t.z) < tt.zeroTolerance) return;
                    at.lookAt(this._localPosition, t, e, this._localRotation), this._localRotation.invert(this._localRotation), this.localRotation = this._localRotation
                } else {
                    var r = this.position;
                    if (i = r, Math.abs(i.x - t.x) < tt.zeroTolerance && Math.abs(i.y - t.y) < tt.zeroTolerance && Math.abs(i.z - t.z) < tt.zeroTolerance) return;
                    at.lookAt(r, t, e, this._rotation), this._rotation.invert(this._rotation), this.rotation = this._rotation
                }
            }, u(0, e, "_isFrontFaceInvert", function () {
                var t = this.scale, e = t.x < 0;
                return t.y < 0 && (e = !e), t.z < 0 && (e = !e), e
            }), u(0, e, "owner", function () {
                return this._owner
            }), u(0, e, "localPositionY", function () {
                return this._localPosition.y
            }, function (t) {
                this._localPosition.y = t, this.localPosition = this._localPosition
            }), u(0, e, "localScaleX", function () {
                return this._localScale.x
            }, function (t) {
                this._localScale.x = t, this.localScale = this._localScale
            }), u(0, e, "worldNeedUpdate", function () {
                return this._getTransformFlag(64)
            }), u(0, e, "localPositionX", function () {
                return this._localPosition.x
            }, function (t) {
                this._localPosition.x = t, this.localPosition = this._localPosition
            }), u(0, e, "localPosition", function () {
                return this._localPosition
            }, function (t) {
                this._localPosition !== t && t.cloneTo(this._localPosition), this._setTransformFlag(4, !0), this._onWorldPositionTransform()
            }), u(0, e, "localPositionZ", function () {
                return this._localPosition.z
            }, function (t) {
                this._localPosition.z = t, this.localPosition = this._localPosition
            }), u(0, e, "localRotationX", function () {
                return this.localRotation.x
            }, function (t) {
                this._localRotation.x = t, this.localRotation = this._localRotation
            }), u(0, e, "localRotationY", function () {
                return this.localRotation.y
            }, function (t) {
                this._localRotation.y = t, this.localRotation = this._localRotation
            }), u(0, e, "localRotationZ", function () {
                return this.localRotation.z
            }, function (t) {
                this._localRotation.z = t, this.localRotation = this._localRotation
            }), u(0, e, "localRotationW", function () {
                return this.localRotation.w
            }, function (t) {
                this._localRotation.w = t, this.localRotation = this._localRotation
            }), u(0, e, "localRotation", function () {
                if (this._getTransformFlag(1)) {
                    var t = this._localRotationEuler;
                    at.createFromYawPitchRoll(t.y / o._angleToRandin, t.x / o._angleToRandin, t.z / o._angleToRandin, this._localRotation), this._setTransformFlag(1, !1)
                }
                return this._localRotation
            }, function (t) {
                this._localRotation !== t && t.cloneTo(this._localRotation), this._localRotation.normalize(this._localRotation), this._setTransformFlag(6, !0), this._setTransformFlag(1, !1), this._onWorldRotationTransform()
            }), u(0, e, "localScaleY", function () {
                return this._localScale.y
            }, function (t) {
                this._localScale.y = t, this.localScale = this._localScale
            }), u(0, e, "localScaleZ", function () {
                return this._localScale.z
            }, function (t) {
                this._localScale.z = t, this.localScale = this._localScale
            }), u(0, e, "position", function () {
                if (this._getTransformFlag(8)) {
                    if (null != this._parent) {
                        var t = this._parent.position;
                        Lt.multiply(this._localPosition, this._parent.scale, o._tempVector30), Lt.transformQuat(o._tempVector30, this._parent.rotation, o._tempVector30), Lt.add(t, o._tempVector30, this._position)
                    } else this._localPosition.cloneTo(this._position);
                    this._setTransformFlag(8, !1)
                }
                return this._position
            }, function (t) {
                if (null != this._parent) {
                    Lt.subtract(t, this._parent.position, this._localPosition);
                    var e = this._parent.scale, n = e.x, i = e.y, r = e.z;
                    if (1 !== n || 1 !== i || 1 !== r) {
                        var a = o._tempVector30;
                        a.x = 1 / n, a.y = 1 / i, a.z = 1 / r, Lt.multiply(this._localPosition, a, this._localPosition)
                    }
                    this._parent.rotation.invert(o._tempQuaternion0), Lt.transformQuat(this._localPosition, o._tempQuaternion0, this._localPosition)
                } else t.cloneTo(this._localPosition);
                this.localPosition = this._localPosition, this._position !== t && t.cloneTo(this._position), this._setTransformFlag(8, !1)
            }), u(0, e, "localRotationEulerY", function () {
                return this.localRotationEuler.y
            }, function (t) {
                this._localRotationEuler.y = t, this.localRotationEuler = this._localRotationEuler
            }), u(0, e, "localScale", function () {
                return this._localScale
            }, function (t) {
                this._localScale !== t && t.cloneTo(this._localScale), this._setTransformFlag(4, !0), this._onWorldScaleTransform()
            }), u(0, e, "localRotationEulerX", function () {
                return this.localRotationEuler.x
            }, function (t) {
                this._localRotationEuler.x = t, this.localRotationEuler = this._localRotationEuler
            }), u(0, e, "localRotationEulerZ", function () {
                return this.localRotationEuler.z
            }, function (t) {
                this._localRotationEuler.z = t, this.localRotationEuler = this._localRotationEuler
            }), u(0, e, "localRotationEuler", function () {
                if (this._getTransformFlag(2)) {
                    this._localRotation.getYawPitchRoll(o._tempVector30);
                    var t = o._tempVector30, e = this._localRotationEuler;
                    e.x = t.y * o._angleToRandin, e.y = t.x * o._angleToRandin, e.z = t.z * o._angleToRandin, this._setTransformFlag(2, !1)
                }
                return this._localRotationEuler
            }, function (t) {
                this._localRotationEuler !== t && t.cloneTo(this._localRotationEuler), this._setTransformFlag(2, !1), this._setTransformFlag(5, !0), this._onWorldRotationTransform()
            }), u(0, e, "localMatrix", function () {
                return this._getTransformFlag(4) && (this._updateLocalMatrix(), this._setTransformFlag(4, !1)), this._localMatrix
            }, function (t) {
                this._localMatrix !== t && t.cloneTo(this._localMatrix), this._localMatrix.decomposeTransRotScale(this._localPosition, this._localRotation, this._localScale), this._setTransformFlag(4, !1), this._onWorldTransform()
            }), u(0, e, "rotation", function () {
                return this._getTransformFlag(16) && (null != this._parent ? at.multiply(this._parent.rotation, this.localRotation, this._rotation) : this.localRotation.cloneTo(this._rotation), this._setTransformFlag(16, !1)), this._rotation
            }, function (t) {
                null != this._parent ? (this._parent.rotation.invert(o._tempQuaternion0), at.multiply(o._tempQuaternion0, t, this._localRotation)) : t.cloneTo(this._localRotation), this.localRotation = this._localRotation, t !== this._rotation && t.cloneTo(this._rotation), this._setTransformFlag(16, !1)
            }), u(0, e, "scale", function () {
                return this._getTransformFlag(32) && (null !== this._parent ? Lt.multiply(this._parent.scale, this._localScale, this._scale) : this._localScale.cloneTo(this._scale), this._setTransformFlag(32, !1)), this._scale
            }, function (t) {
                if (null !== this._parent) {
                    var e = this._parent.scale, n = o._tempVector30;
                    n.x = 1 / e.x, n.y = 1 / e.y, n.z = 1 / e.z, Lt.multiply(t, o._tempVector30, this._localScale)
                } else t.cloneTo(this._localScale);
                this.localScale = this._localScale, this._scale !== t && t.cloneTo(this._scale), this._setTransformFlag(32, !1)
            }), u(0, e, "rotationEuler", function () {
                if (this._getTransformFlag(128)) {
                    this.rotation.getYawPitchRoll(o._tempVector30);
                    var t = o._tempVector30, e = this._rotationEuler;
                    e.x = t.y * o._angleToRandin, e.y = t.x * o._angleToRandin, e.z = t.z * o._angleToRandin, this._setTransformFlag(128, !1)
                }
                return this._rotationEuler
            }, function (t) {
                at.createFromYawPitchRoll(t.y / o._angleToRandin, t.x / o._angleToRandin, t.z / o._angleToRandin, this._rotation), this.rotation = this._rotation, this._rotationEuler !== t && t.cloneTo(this._rotationEuler), this._setTransformFlag(128, !1)
            }), u(0, e, "worldMatrix", function () {
                return this._getTransformFlag(64) && (null != this._parent ? He.multiply(this._parent.worldMatrix, this.localMatrix, this._worldMatrix) : this.localMatrix.cloneTo(this._worldMatrix), this._setTransformFlag(64, !1)), this._worldMatrix
            }, function (t) {
                null === this._parent ? t.cloneTo(this._localMatrix) : (this._parent.worldMatrix.invert(this._localMatrix), He.multiply(this._localMatrix, t, this._localMatrix)), this.localMatrix = this._localMatrix, this._worldMatrix !== t && t.cloneTo(this._worldMatrix), this._setTransformFlag(64, !1)
            }), o.TRANSFORM_LOCALQUATERNION = 1, o.TRANSFORM_LOCALEULER = 2, o.TRANSFORM_LOCALMATRIX = 4, o.TRANSFORM_WORLDPOSITION = 8, o.TRANSFORM_WORLDQUATERNION = 16, o.TRANSFORM_WORLDSCALE = 32, o.TRANSFORM_WORLDMATRIX = 64, o.TRANSFORM_WORLDEULER = 128, _(o, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempVector31", function () {
                return this._tempVector31 = new Lt
            }, "_tempVector32", function () {
                return this._tempVector32 = new Lt
            }, "_tempVector33", function () {
                return this._tempVector33 = new Lt
            }, "_tempQuaternion0", function () {
                return this._tempQuaternion0 = new at
            }, "_tempMatrix0", function () {
                return this._tempMatrix0 = new He
            }, "_angleToRandin", function () {
                return this._angleToRandin = 180 / Math.PI
            }]), o
        }()), Ze = function (t) {
            function x() {
                this._linkAvatarSpritesData = {}, this._keyframeNodeOwners = [], this._linkAvatarSprites = [], this._renderableSprites = [], this.cullingMode = 2, x.__super.call(this), this._controllerLayers = [], this._linkSprites = {}, this._speed = 1, this._keyframeNodeOwnerMap = {}, this._updateMark = 0
            }

            d(x, "laya.d3.component.Animator", r);
            var e = x.prototype;
            return e._linkToSprites = function (t) {
                for (var e in t) {
                    for (var n = this.owner, i = t[e], r = 0, a = i.length; r < a; r++) {
                        var o = i[r];
                        if ("" === o) break;
                        if (!(n = n.getChildByName(o))) break
                    }
                    n && this.linkSprite3DToAvatarNode(e, n)
                }
            }, e._addKeyframeNodeOwner = function (t, e, n) {
                var i = e._indexInList, r = e.fullPath, a = this._keyframeNodeOwnerMap[r];
                if (a) a.referenceCount++, t[i] = a; else {
                    for (var o = n, s = 0, l = e.propertyCount; s < l && (o = o[e.getPropertyByIndex(s)]); s++) ;
                    (a = this._keyframeNodeOwnerMap[r] = new Pe).fullPath = r, a.indexInList = this._keyframeNodeOwners.length, a.referenceCount = 1, a.propertyOwner = n;
                    var h = e.propertyCount, u = w(h);
                    for (s = 0; s < h; s++) u[s] = e.getPropertyByIndex(s);
                    if (a.property = u, a.type = e.type, o) if (0 === e.type) a.defaultValue = o; else {
                        var c = new o.constructor;
                        o.cloneTo(c), a.defaultValue = c
                    }
                    this._keyframeNodeOwners.push(a), t[i] = a
                }
            }, e._removeKeyframeNodeOwner = function (t, e) {
                var n = e.fullPath, i = this._keyframeNodeOwnerMap[n];
                i && (i.referenceCount--, 0 === i.referenceCount && (delete this._keyframeNodeOwnerMap[n], this._keyframeNodeOwners.splice(this._keyframeNodeOwners.indexOf(i), 1)), t[e._indexInList] = null)
            }, e._getOwnersByClip = function (t) {
                var e = t._clip._nodes, n = e.count, i = t._nodeOwners;
                i.length = n;
                for (var r = 0; r < n; r++) {
                    for (var a = e.getNodeByIndex(r), o = this._avatar ? this._avatarNodeMap[this._avatar._rootNode.name] : this.owner, s = 0, l = a.ownerPathCount; s < l; s++) {
                        var h = a.getOwnerPathByIndex(s);
                        if ("" === h) break;
                        if (!(o = o.getChildByName(h))) break
                    }
                    if (o) {
                        var u = a.propertyOwner;
                        u && (o = o[u]), o && this._addKeyframeNodeOwner(i, a, o)
                    }
                }
            }, e._updatePlayer = function (t, e, n, i) {
                var r = t._clip._duration * (t.clipEnd - t.clipStart), a = e._elapsedTime, o = a + n;
                e._lastElapsedTime = a;
                var s = (e._elapsedTime = o) / r, l = (e._normalizedTime = s) % 1;
                e._normalizedPlayTime = l < 0 ? l + 1 : l, e._duration = r;
                var h = t._scripts;
                if (!i && r <= o) {
                    if (e._finish = !0, e._elapsedTime = r, e._normalizedPlayTime = 1, h) for (var u = 0, c = h.length; u < c; u++) h[u].onStateExit()
                } else if (h) for (u = 0, c = h.length; u < c; u++) h[u].onStateUpdate()
            }, e._eventScript = function (t, e, n, i, r) {
                if (r) for (var a = e.length; n < a; n++) {
                    var o = e[n];
                    if (!(o.time <= i)) break;
                    for (var s = 0, l = t.length; s < l; s++) {
                        var h = t[s], u = h[o.eventName];
                        u && u.apply(h, o.params)
                    }
                } else for (; 0 <= n && (o = e[n]).time >= i; n--) for (s = 0, l = t.length; s < l; s++) (u = (h = t[s])[o.eventName]) && u.apply(h, o.params);
                return n
            }, e._updateEventScript = function (t, e) {
                var n = this.owner._scripts;
                if (n) {
                    var i = t._clip, r = i._events, a = i._duration, o = e._elapsedTime, s = o % a,
                        l = Math.abs(Math.floor(o / a) - Math.floor(e._lastElapsedTime / a)),
                        h = e._elapsedTime >= e._lastElapsedTime;
                    if (e._lastIsFront !== h && (h ? e._playEventIndex++ : e._playEventIndex--, e._lastIsFront = h), 0 == l) e._playEventIndex = this._eventScript(n, r, e._playEventIndex, s, h); else if (h) {
                        this._eventScript(n, r, e._playEventIndex, a, !0);
                        for (var u = 0, c = l - 1; u < c; u++) this._eventScript(n, r, 0, a, !0);
                        e._playEventIndex = this._eventScript(n, r, 0, s, !0)
                    } else {
                        this._eventScript(n, r, e._playEventIndex, 0, !1);
                        var _ = r.length - 1;
                        for (u = 0, c = l - 1; u < c; u++) this._eventScript(n, r, _, 0, !1);
                        e._playEventIndex = this._eventScript(n, r, _, s, !1)
                    }
                }
            }, e._updateClipDatas = function (t, e, n, i) {
                var r = t._clip, a = r._duration, o = t.clipStart * a + n._normalizedPlayTime * n._duration,
                    s = t._currentFrameIndices, l = n._elapsedTime > n._lastElapsedTime;
                r._evaluateClipDatasRealTime(r._nodes, o, s, e, l)
            }, e._applyFloat = function (t, e, n, i, r, a, o) {
                if (n.updateMark === this._updateMark) if (i) t[e] += r * o; else {
                    var s = t[e];
                    t[e] = s + r * (o - s)
                } else if (a) t[e] = i ? n.defaultValue + o : o; else if (i) t[e] = n.defaultValue + r * o; else {
                    var l = n.defaultValue;
                    t[e] = l + r * (o - l)
                }
            }, e._applyPositionAndRotationEuler = function (t, e, n, i, r, a) {
                if (t.updateMark === this._updateMark) if (e) a.x += n * r.x, a.y += n * r.y, a.z += n * r.z; else {
                    var o = a.x, s = a.y, l = a.z;
                    a.x = o + n * (r.x - o), a.y = s + n * (r.y - s), a.z = l + n * (r.z - l)
                } else if (i) if (e) {
                    var h = t.defaultValue;
                    a.x = h.x + r.x, a.y = h.y + r.y, a.z = h.z + r.z
                } else a.x = r.x, a.y = r.y, a.z = r.z; else if (h = t.defaultValue, e) a.x = h.x + n * r.x, a.y = h.y + n * r.y, a.z = h.z + n * r.z; else {
                    var u = h.x, c = h.y, _ = h.z;
                    a.x = u + n * (r.x - u), a.y = c + n * (r.y - c), a.z = _ + n * (r.z - _)
                }
            }, e._applyRotation = function (t, e, n, i, r, a) {
                if (t.updateMark === this._updateMark) if (e) {
                    var o = x._tempQuaternion1;
                    kt.quaternionWeight(r, n, o), o.normalize(o), at.multiply(a, o, a)
                } else at.lerp(a, r, n, a); else if (i) if (e) {
                    var s = t.defaultValue;
                    at.multiply(s, r, a)
                } else a.x = r.x, a.y = r.y, a.z = r.z, a.w = r.w; else s = t.defaultValue, e ? (o = x._tempQuaternion1, kt.quaternionWeight(r, n, o), o.normalize(o), at.multiply(s, o, a)) : at.lerp(s, r, n, a)
            }, e._applyScale = function (t, e, n, i, r, a) {
                if (t.updateMark === this._updateMark) if (e) {
                    var o = x._tempVector31;
                    kt.scaleWeight(r, n, o), a.x = a.x * o.x, a.y = a.y * o.y, a.z = a.z * o.z
                } else kt.scaleBlend(a, r, n, a); else if (i) if (e) {
                    var s = t.defaultValue;
                    a.x = s.x * r.x, a.y = s.y * r.y, a.z = s.z * r.z
                } else a.x = r.x, a.y = r.y, a.z = r.z; else s = t.defaultValue, e ? (o = x._tempVector31, kt.scaleWeight(r, n, o), a.x = s.x * o.x, a.y = s.y * o.y, a.z = s.z * o.z) : kt.scaleBlend(s, r, n, a)
            }, e._applyCrossData = function (t, e, n, i, r, a, o) {
                var s = t.propertyOwner;
                if (s) {
                    switch (t.type) {
                        case 0:
                            for (var l = t.property, h = l.length - 1, u = 0; u < h && (s = s[l[u]]); u++) ;
                            var c = r + o * (a - r);
                            this._applyFloat(s, l[h], t, e, n, i, c);
                            break;
                        case 1:
                            var _ = s.localPosition, d = x._tempVector30, f = r.x, m = r.y, p = r.z;
                            d.x = f + o * (a.x - f), d.y = m + o * (a.y - m), d.z = p + o * (a.z - p), this._applyPositionAndRotationEuler(t, e, n, i, d, _), s.localPosition = _;
                            break;
                        case 2:
                            var T = s.localRotation, E = x._tempQuaternion0;
                            at.lerp(r, a, o, E), this._applyRotation(t, e, n, i, E, T), s.localRotation = T;
                            break;
                        case 3:
                            var v = s.localScale, g = x._tempVector30;
                            kt.scaleBlend(r, a, o, g), this._applyScale(t, e, n, i, g, v), s.localScale = v;
                            break;
                        case 4:
                            var S = s.localRotationEuler, y = x._tempVector30;
                            f = r.x, m = r.y, p = r.z, y.x = f + o * (a.x - f), y.y = m + o * (a.y - m), y.z = p + o * (a.z - p), this._applyPositionAndRotationEuler(t, e, n, i, y, S), s.localRotationEuler = S
                    }
                    t.updateMark = this._updateMark
                }
            }, e._setClipDatasToNode = function (t, e, n, i) {
                for (var r = t._clip._nodes, a = t._nodeOwners, o = 0, s = r.count; o < s; o++) {
                    var l = a[o];
                    if (l) {
                        var h = l.propertyOwner;
                        if (h) {
                            switch (l.type) {
                                case 0:
                                    for (var u = l.property, c = u.length - 1, _ = 0; _ < c && (h = h[u[_]]); _++) ;
                                    this._applyFloat(h, u[c], l, e, n, i, r.getNodeByIndex(o).data);
                                    break;
                                case 1:
                                    var d = h.localPosition;
                                    this._applyPositionAndRotationEuler(l, e, n, i, r.getNodeByIndex(o).data, d), h.localPosition = d;
                                    break;
                                case 2:
                                    var f = h.localRotation;
                                    this._applyRotation(l, e, n, i, r.getNodeByIndex(o).data, f), h.localRotation = f;
                                    break;
                                case 3:
                                    var m = h.localScale;
                                    this._applyScale(l, e, n, i, r.getNodeByIndex(o).data, m), h.localScale = m;
                                    break;
                                case 4:
                                    var p = h.localRotationEuler;
                                    this._applyPositionAndRotationEuler(l, e, n, i, r.getNodeByIndex(o).data, p), h.localRotationEuler = p
                            }
                            l.updateMark = this._updateMark
                        }
                    }
                }
            }, e._setCrossClipDatasToNode = function (t, e, n, i, r) {
                for (var a = t._crossNodesOwners, o = t._crossNodesOwnersCount, s = t.blendingMode !== be.BLENDINGMODE_OVERRIDE, l = t.defaultWeight, h = t._destCrossClipNodeIndices, u = n._clip._nodes, c = n._nodeOwners, _ = t._srcCrossClipNodeIndices, d = e._nodeOwners, f = e._clip._nodes, m = 0; m < o; m++) {
                    var p = a[m];
                    if (p) {
                        var T = _[m], E = h[m], v = -1 !== T ? f.getNodeByIndex(T).data : c[E].defaultValue,
                            g = -1 !== E ? u.getNodeByIndex(E).data : d[T].defaultValue;
                        this._applyCrossData(p, s, l, r, v, g, i)
                    }
                }
            }, e._setFixedCrossClipDatasToNode = function (t, e, n, i) {
                for (var r = t._crossNodesOwners, a = t._crossNodesOwnersCount, o = t.blendingMode !== be.BLENDINGMODE_OVERRIDE, s = t.defaultWeight, l = t._destCrossClipNodeIndices, h = e._clip._nodes, u = 0; u < a; u++) {
                    var c = r[u];
                    if (c) {
                        var _ = l[u], d = c.crossFixedValue, f = -1 !== _ ? h.getNodeByIndex(_).data : c.defaultValue;
                        this._applyCrossData(c, o, s, i, d, f, n)
                    }
                }
            }, e._revertDefaultKeyframeNodes = function (t) {
                for (var e = t._nodeOwners, n = 0, i = e.length; n < i; n++) {
                    var r = e[n];
                    if (r) {
                        var a = r.propertyOwner;
                        if (a) switch (r.type) {
                            case 0:
                                for (var o = r.property, s = o.length - 1, l = 0; l < s && (a = a[o[l]]); l++) ;
                                a[o[s]] = r.defaultValue;
                                break;
                            case 1:
                                var h = a.localPosition, u = r.defaultValue;
                                h.x = u.x, h.y = u.y, h.z = u.z, a.localPosition = h;
                                break;
                            case 2:
                                var c = a.localRotation, _ = r.defaultValue;
                                c.x = _.x, c.y = _.y, c.z = _.z, c.w = _.w, a.localRotation = c;
                                break;
                            case 3:
                                var d = a.localScale;
                                u = r.defaultValue, d.x = u.x, d.y = u.y, d.z = u.z, a.localScale = d;
                                break;
                            case 4:
                                var f = a.localRotationEuler;
                                u = r.defaultValue, f.x = u.x, f.y = u.y, f.z = u.z, a.localRotationEuler = f;
                                break;
                            default:
                                throw"Animator:unknown type."
                        }
                    }
                }
            }, e._removeClip = function (t, e, n, i) {
                var r = i._clip;
                r._removeReference(), t.splice(n, 1), delete e[i.name];
                for (var a = t[n], o = r._nodes, s = a._nodeOwners, l = 0, h = o.count; l < h; l++) this._removeKeyframeNodeOwner(s, o.getNodeByIndex(l))
            }, e._onAdded = function () {
                var t = this.owner._parent;
                this.owner._setHierarchyAnimator(this, t ? t._hierarchyAnimator : null), this.owner._changeAnimatorToLinkSprite3DNoAvatar(this, !0, [])
            }, e._onDestroy = function () {
                for (var t = 0, e = this._controllerLayers.length; t < e; t++) for (var n = this._controllerLayers[t]._states, i = 0, r = n.length; i < r; i++) n[i]._clip._removeReference();
                var a = this.owner._parent;
                this.owner._clearHierarchyAnimator(this, a ? a._hierarchyAnimator : null)
            }, e._onEnableInScene = function () {
                this.owner._scene._animatorPool.add(this)
            }, e._onDisableInScene = function () {
                this.owner._scene._animatorPool.remove(this)
            }, e._onEnable = function () {
                for (var t = 0, e = this._controllerLayers.length; t < e; t++) {
                    if (this._controllerLayers[t].playOnWake) this.getDefaultState(t) && this.play(null, t, 0)
                }
            }, e._handleSpriteOwnersBySprite = function (t, e, n) {
                for (var i = 0, r = this._controllerLayers.length; i < r; i++) for (var a = this._controllerLayers[i]._states, o = 0, s = a.length; o < s; o++) {
                    var l = a[o], h = l._clip, u = e.join("/"), c = h._nodesMap[u];
                    if (c) for (var _ = l._nodeOwners, d = 0, f = c.length; d < f; d++) t ? this._addKeyframeNodeOwner(_, c[d], n) : this._removeKeyframeNodeOwner(_, c[d])
                }
            }, e._parse = function (t) {
                var e = t.avatar;
                if (e) {
                    this.avatar = Dt.getRes(e.path);
                    var n = e.linkSprites;
                    this._linkSprites = n, this._linkToSprites(n)
                }
                t.clipPaths;
                for (var i = t.playOnWake, r = t.layers, a = 0; a < r.length; a++) {
                    var o = r[a], s = new be(o.name);
                    s.defaultWeight = 0 === a ? 1 : o.weight;
                    var l = o.blendingMode;
                    l && (s.blendingMode = l), this.addControllerLayer(s);
                    for (var h = o.states, u = 0, c = h.length; u < c; u++) {
                        var _ = h[u], d = _.clipPath;
                        if (d) {
                            var f, m = _.name;
                            if (f = Dt.getRes(d)) {
                                var p = new Ge;
                                p.name = m, p.clip = f, this.addState(p, a), 0 === u && (this.getControllerLayer(a).defaultState = p)
                            }
                        }
                    }
                    void 0 !== i && (s.playOnWake = i)
                }
                var T = t.cullingMode;
                void 0 !== T && (this.cullingMode = T)
            }, e._update = function () {
                if (0 !== this._speed) {
                    var t = !1;
                    if (2 === this.cullingMode) {
                        t = !1;
                        for (var e = 0, n = this._renderableSprites.length; e < n; e++) if (this._renderableSprites[e]._render._visible) {
                            t = !0;
                            break
                        }
                    } else t = !0;
                    this._updateMark++;
                    var i = this.owner._scene.timer, r = i._delta / 1e3, a = i.scale;
                    for (e = 0, n = this._controllerLayers.length; e < n; e++) {
                        var o = this._controllerLayers[e], s = o._playStateInfo, l = o._crossPlayStateInfo;
                        switch (d = o.blendingMode !== be.BLENDINGMODE_OVERRIDE, o._playType) {
                            case 0:
                                var h = o._currentPlayState, u = h._clip, c = this._speed * h.speed, _ = s._finish;
                                if (_ || this._updatePlayer(h, s, r * c, u.islooping), t) {
                                    var d = o.blendingMode !== be.BLENDINGMODE_OVERRIDE;
                                    this._updateClipDatas(h, d, s, a * c), this._setClipDatasToNode(h, d, o.defaultWeight, 0 === e), _ || this._updateEventScript(h, s)
                                }
                                break;
                            case 1:
                                u = (h = o._currentPlayState)._clip;
                                var f = o._crossPlayState, m = f._clip, p = o._crossDuration, T = l._startPlayTime,
                                    E = m._duration - T, v = E < p ? E / p : 1, g = this._speed * f.speed;
                                this._updatePlayer(f, l, r * v * g, m.islooping);
                                var S = (l._elapsedTime - T) / v / p;
                                1 <= S ? t && (this._updateClipDatas(f, d, l, a * g), this._setClipDatasToNode(f, d, o.defaultWeight, 0 === e), o._playType = 0, o._currentPlayState = f, l._cloneTo(s)) : (s._finish || (c = this._speed * h.speed, this._updatePlayer(h, s, r * c, u.islooping), t && this._updateClipDatas(h, d, s, a * c)), t && (this._updateClipDatas(f, d, l, a * v * g), this._setCrossClipDatasToNode(o, h, f, S, 0 === e))), t && (this._updateEventScript(h, s), this._updateEventScript(f, l));
                                break;
                            case 2:
                                m = (f = o._crossPlayState)._clip, p = o._crossDuration, T = l._startPlayTime, v = (E = m._duration - T) < p ? E / p : 1, g = this._speed * f.speed, this._updatePlayer(f, l, r * v * g, m.islooping), t && (1 <= (S = (l._elapsedTime - T) / v / p) ? (this._updateClipDatas(f, d, l, a * g), this._setClipDatasToNode(f, d, 1, 0 === e), o._playType = 0, o._currentPlayState = f, l._cloneTo(s)) : (this._updateClipDatas(f, d, l, a * v * g), this._setFixedCrossClipDatasToNode(o, f, S, 0 === e)), this._updateEventScript(f, l))
                        }
                    }
                    t && this._avatar && (b.supportWebGLPlusAnimation && this._updateAnimationNodeWorldMatix(this._animationNodeLocalPositions, this._animationNodeLocalRotations, this._animationNodeLocalScales, this._animationNodeWorldMatrixs, this._animationNodeParentIndices), this._updateAvatarNodesToSprite())
                }
            }, e._cloneTo = function (t) {
                var e = t;
                e.avatar = this.avatar;
                for (var n = 0, i = this._controllerLayers.length; n < i; n++) {
                    var r = this._controllerLayers[n];
                    e.addControllerLayer(r.clone());
                    for (var a = r._states, o = 0, s = a.length; o < s; o++) {
                        var l = a[o].clone();
                        e.addState(l, n), 0 == o && (e.getControllerLayer(n).defaultState = l)
                    }
                }
                e._linkSprites = this._linkSprites, e._linkToSprites(this._linkSprites)
            }, e.getDefaultState = function (t) {
                return void 0 === t && (t = 0), this._controllerLayers[t].defaultState
            }, e.addState = function (t, e) {
                void 0 === e && (e = 0);
                var n = t.name, i = this._controllerLayers[e], r = i._statesMap, a = i._states;
                if (r[n]) throw"Animator:this stat's name has exist.";
                r[n] = t, a.push(t), t._clip._addReference(), this._getOwnersByClip(t)
            }, e.removeState = function (t, e) {
                void 0 === e && (e = 0);
                for (var n = this._controllerLayers[e], i = n._states, r = n._statesMap, a = -1, o = 0, s = i.length; o < s; o++) if (i[o] === t) {
                    a = o;
                    break
                }
                -1 !== a && this._removeClip(i, r, a, t)
            }, e.addControllerLayer = function (t) {
                this._controllerLayers.push(t)
            }, e.getControllerLayer = function (t) {
                return void 0 === t && (t = 0), this._controllerLayers[t]
            }, e.getCurrentAnimatorPlayState = function (t) {
                return void 0 === t && (t = 0), this._controllerLayers[t]._playStateInfo
            }, e.play = function (t, e, n) {
                void 0 === e && (e = 0), void 0 === n && (n = Number.NEGATIVE_INFINITY);
                var i = this._controllerLayers[e], r = i.defaultState;
                if (!t && !r) throw new Error("Animator:must have  default clip value,please set clip property.");
                var a = i._currentPlayState, o = i._playStateInfo, s = t ? i._statesMap[t] : r, l = s._clip._duration;
                a !== s ? (n !== Number.NEGATIVE_INFINITY ? o._resetPlayState(l * n) : o._resetPlayState(0), null !== a && a !== s && this._revertDefaultKeyframeNodes(a), i._playType = 0, i._currentPlayState = s) : n !== Number.NEGATIVE_INFINITY && (o._resetPlayState(l * n), i._playType = 0);
                var h = s._scripts;
                if (h) for (var u = 0, c = h.length; u < c; u++) h[u].onStateEnter()
            }, e.crossFade = function (t, e, n, i) {
                void 0 === n && (n = 0), void 0 === i && (i = Number.NEGATIVE_INFINITY);
                var r = this._controllerLayers[n], a = r._statesMap[t];
                if (a) {
                    var o = r._playType;
                    if (-1 === o) return void this.play(t, n, i);
                    var s = r._crossPlayStateInfo, l = r._crossNodesOwners, h = r._crossNodesOwnersIndicesMap,
                        u = r._currentPlayState, c = a._nodeOwners, _ = r._destCrossClipNodeIndices, d = a._clip,
                        f = d._nodes, m = d._nodesDic;
                    switch (o) {
                        case 0:
                            var p = u._nodeOwners, T = r._srcCrossClipNodeIndices, E = u._clip, v = E._nodes,
                                g = E._nodesDic;
                            r._playType = 1;
                            for (var S = ++r._crossMark, y = r._crossNodesOwnersCount = 0, x = 0, D = v.count; x < D; x++) {
                                var I = v.getNodeByIndex(x), R = I._indexInList, M = p[R];
                                if (M) {
                                    var A = I.fullPath;
                                    T[y] = R;
                                    var C = m[A];
                                    _[y] = C ? C._indexInList : -1, h[A] = S, l[y] = M, y++
                                }
                            }
                            for (x = 0, D = f.count; x < D; x++) {
                                var L = (C = f.getNodeByIndex(x))._indexInList, O = c[L];
                                if (O) {
                                    var N = C.fullPath;
                                    g[N] || (T[y] = -1, _[y] = L, h[N] = S, l[y] = O, y++)
                                }
                            }
                            break;
                        case 1:
                        case 2:
                            for (r._playType = 2, x = 0, D = l.length; x < D; x++) {
                                var V = l[x];
                                V.saveCrossFixedValue(), C = m[V.fullPath], _[x] = C ? C._indexInList : -1
                            }
                            for (y = r._crossNodesOwnersCount, S = r._crossMark, x = 0, D = f.count; x < D; x++) (O = c[L = (C = f.getNodeByIndex(x))._indexInList]) && h[N = C.fullPath] !== S && (_[y] = L, h[N] = S, V = c[L], (l[y] = V).saveCrossFixedValue(), y++)
                    }
                    r._crossNodesOwnersCount = y, r._crossPlayState = a, r._crossDuration = u._clip._duration * e, i !== Number.NEGATIVE_INFINITY ? s._resetPlayState(d._duration * i) : s._resetPlayState(0)
                }
                var P = a._scripts;
                if (P) for (x = 0, D = P.length; x < D; x++) P[x].onStateEnter()
            }, e._getAvatarOwnersAndInitDatasAsync = function () {
                for (var t = 0, e = this._controllerLayers.length; t < e; t++) for (var n = this._controllerLayers[t]._states, i = 0, r = n.length; i < r; i++) this._getOwnersByClip(n[i]);
                for (var a in this._avatar._cloneDatasToAnimator(this), this._linkAvatarSpritesData) {
                    var o = this._linkAvatarSpritesData[a];
                    if (o) for (var s = 0, l = o.length; s < l; s++) this._isLinkSpriteToAnimationNode(o[s], a, !0)
                }
            }, e._isLinkSpriteToAnimationNode = function (t, e, n) {
                if (this._avatar) {
                    var i = this._avatarNodeMap[e];
                    if (i) if (n) {
                        t._transform._dummy = i.transform, this._linkAvatarSprites.push(t);
                        var r = i.transform, a = t.transform;
                        if (!a.owner.isStatic && r) {
                            var o = a.worldMatrix, s = this.owner._transform._parent;
                            if (s) kt.matrix4x4MultiplyMFM(s.worldMatrix, r.getWorldMatrix(), o); else for (var l = o.elements, h = r.getWorldMatrix(), u = 0; u < 16; u++) l[u] = h[u];
                            a.worldMatrix = o
                        }
                    } else t._transform._dummy = null, this._linkAvatarSprites.splice(this._linkAvatarSprites.indexOf(t), 1)
                }
            }, e._isLinkSpriteToAnimationNodeData = function (t, e, n) {
                var i = this._linkAvatarSpritesData[e];
                n ? (i || (this._linkAvatarSpritesData[e] = i = []), i.push(t)) : i.splice(t, 1)
            }, e._updateAvatarNodesToSprite = function () {
                for (var t = 0, e = this._linkAvatarSprites.length; t < e; t++) {
                    var n = this._linkAvatarSprites[t], i = n.transform._dummy, r = n.transform;
                    if (!r.owner.isStatic && i) {
                        var a = r.worldMatrix, o = this.owner._transform;
                        kt.matrix4x4MultiplyMFM(o.worldMatrix, i.getWorldMatrix(), a), r.worldMatrix = a
                    }
                }
            }, e.linkSprite3DToAvatarNode = function (t, e) {
                return this._isLinkSpriteToAnimationNodeData(e, t, !0), this._isLinkSpriteToAnimationNode(e, t, !0), !0
            }, e.unLinkSprite3DToAvatarNode = function (t) {
                if (t._hierarchyAnimator !== this) throw"Animator:sprite3D must belong to this Animator";
                var e = t.transform._dummy;
                if (e) {
                    var n = e._owner.name;
                    return this._isLinkSpriteToAnimationNodeData(t, n, !1), this._isLinkSpriteToAnimationNode(t, n, !1), !0
                }
                return !1
            }, e._updateAnimationNodeWorldMatix = function (t, e, n, i, r) {
                E.instance.updateAnimationNodeWorldMatix(t, e, n, r, i)
            }, u(0, e, "speed", function () {
                return this._speed
            }, function (t) {
                this._speed = t
            }), u(0, e, "avatar", function () {
                return this._avatar
            }, function (t) {
                if (this._avatar !== t) if (this._avatar = t) this._getAvatarOwnersAndInitDatasAsync(), this.owner._changeHierarchyAnimatorAvatar(this, t); else {
                    var e = this.owner._parent;
                    this.owner._changeHierarchyAnimatorAvatar(this, e ? e._hierarchyAnimator._avatar : null)
                }
            }), x._update = function (t) {
                for (var e = t._animatorPool, n = e.elements, i = 0, r = e.length; i < r; i++) {
                    var a = n[i];
                    a && a.enabled && a._update()
                }
            }, x._tempVector3Array0 = new Float32Array(3), x._tempVector3Array1 = new Float32Array(3), x._tempQuaternionArray0 = new Float32Array(4), x._tempQuaternionArray1 = new Float32Array(4), x.CULLINGMODE_ALWAYSANIMATE = 0, x.CULLINGMODE_CULLCOMPLETELY = 2, _(x, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempVector31", function () {
                return this._tempVector31 = new Lt
            }, "_tempQuaternion0", function () {
                return this._tempQuaternion0 = new at
            }, "_tempQuaternion1", function () {
                return this._tempQuaternion1 = new at
            }]), x
        }(), je = function (t) {
            function a(t, e, n, i, r) {
                a.__super.call(this), this._owner = t, this._children = [], this._localMatrix = new Float32Array(16), b.supportWebGLPlusAnimation ? (this._localPosition = new U(0, 0, 0, e), this._localRotation = new B(0, 0, 0, 1, n), this._localScale = new U(0, 0, 0, i), this._worldMatrix = r) : (this._localPosition = new Lt, this._localRotation = new at, this._localScale = new Lt, this._worldMatrix = new Float32Array(16)), this._localQuaternionUpdate = !1, this._locaEulerlUpdate = !1, this._localUpdate = !1, this._worldUpdate = !0
            }

            d(a, "laya.d3.animation.AnimationTransform3D", f);
            var e = a.prototype;
            return e._getlocalMatrix = function () {
                return this._localUpdate && (kt._createAffineTransformationArray(this._localPosition, this._localRotation, this._localScale, this._localMatrix), this._localUpdate = !1), this._localMatrix
            }, e._onWorldTransform = function () {
                if (!this._worldUpdate) {
                    this._worldUpdate = !0, this.event("transformchanged");
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldTransform()
                }
            }, e.getWorldMatrix = function () {
                if (!b.supportWebGLPlusAnimation && this._worldUpdate) {
                    if (null != this._parent) kt.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(), this._getlocalMatrix(), this._worldMatrix); else {
                        var t = this._worldMatrix;
                        t[1] = t[2] = t[3] = t[4] = t[6] = t[7] = t[8] = t[9] = t[11] = t[12] = t[13] = t[14] = 0, t[0] = t[5] = t[10] = t[15] = 1
                    }
                    this._worldUpdate = !1
                }
                return b.supportWebGLPlusAnimation && this._worldUpdate && (this._worldUpdate = !1), this._worldMatrix
            }, e.setParent = function (t) {
                if (this._parent !== t) {
                    if (this._parent) {
                        var e = this._parent._children, n = e.indexOf(this);
                        e.splice(n, 1)
                    }
                    t && (t._children.push(this), t && this._onWorldTransform()), this._parent = t
                }
            }, u(0, e, "localPosition", function () {
                return this._localPosition
            }, function (t) {
                this._localPosition = t, this._localUpdate = !0, this._onWorldTransform()
            }), u(0, e, "localRotation", function () {
                if (this._localQuaternionUpdate) {
                    var t = this._localRotationEuler;
                    at.createFromYawPitchRoll(t.y / a._angleToRandin, t.x / a._angleToRandin, t.z / a._angleToRandin, this._localRotation), this._localQuaternionUpdate = !1
                }
                return this._localRotation
            }, function (t) {
                this._localRotation = t, this._locaEulerlUpdate = !0, this._localQuaternionUpdate = !1, this._localUpdate = !0, this._onWorldTransform()
            }), u(0, e, "localScale", function () {
                return this._localScale
            }, function (t) {
                this._localScale = t, this._localUpdate = !0, this._onWorldTransform()
            }), u(0, e, "localRotationEuler", function () {
                if (this._locaEulerlUpdate) {
                    this._localRotation.getYawPitchRoll(a._tempVector3);
                    var t = a._tempVector3, e = this._localRotationEuler;
                    e.x = t.y * a._angleToRandin, e.y = t.x * a._angleToRandin, e.z = t.z * a._angleToRandin, this._locaEulerlUpdate = !1
                }
                return this._localRotationEuler
            }, function (t) {
                this._localRotationEuler = t, this._locaEulerlUpdate = !1, this._localQuaternionUpdate = !0, this._localUpdate = !0, this._onWorldTransform()
            }), _(a, ["_tempVector3", function () {
                return this._tempVector3 = new Lt
            }, "_angleToRandin", function () {
                return this._angleToRandin = 180 / Math.PI
            }]), a
        }(), Ke = function (t) {
            function r(t, e, n, i) {
                if (this._vertexCount = 0, this._canRead = !1, this._dataType = 0, this._vertexDeclaration = null, void 0 === n && (n = !1), void 0 === i && (i = 0), r.__super.call(this), this._vertexCount = -1, this._bufferUsage = e, this._bufferType = 34962, this._canRead = n, this._dataType = i, this._byteLength = t, this.bind(), E.instance.bufferData(this._bufferType, this._byteLength, this._bufferUsage), n) switch (i) {
                    case 0:
                        this._buffer = new Float32Array(t / 4);
                        break;
                    case 1:
                        this._buffer = new Uint8Array(t)
                }
            }

            d(r, "laya.d3.graphics.VertexBuffer3D", t);
            var e = r.prototype;
            return e.bind = function () {
                return i._bindedVertexBuffer !== this._glBuffer && (E.instance.bindBuffer(34962, this._glBuffer), i._bindedVertexBuffer = this._glBuffer, !0)
            }, e.setData = function (t, e, n, i) {
                if (void 0 === e && (e = 0), void 0 === n && (n = 0), void 0 === i && (i = 4294967295), this.bind(), 0 !== n || 4294967295 !== i) switch (this._dataType) {
                    case 0:
                        t = new Float32Array(t.buffer, 4 * n, i);
                        break;
                    case 1:
                        t = new Uint8Array(t.buffer, n, i)
                }
                switch (this._dataType) {
                    case 0:
                        E.instance.bufferSubData(this._bufferType, 4 * e, t);
                        break;
                    case 1:
                        E.instance.bufferSubData(this._bufferType, e, t)
                }
                this._canRead && this._buffer.set(t, e)
            }, e.getData = function () {
                if (this._canRead) return this._buffer;
                throw new Error("Can't read data from VertexBuffer with only write flag!")
            }, e.destroy = function () {
                t.prototype.destroy.call(this), this._buffer = null, this._vertexDeclaration = null
            }, u(0, e, "vertexDeclaration", function () {
                return this._vertexDeclaration
            }, function (t) {
                this._vertexDeclaration !== t && (this._vertexDeclaration = t, this._vertexCount = t ? this._byteLength / t.vertexStride : -1)
            }), u(0, e, "vertexCount", function () {
                return this._vertexCount
            }), u(0, e, "canRead", function () {
                return this._canRead
            }), r.DATATYPE_FLOAT32ARRAY = 0, r.DATATYPE_UINT8ARRAY = 1, r
        }(i), qe = (function (t) {
            function e() {
                this._nativeConstraint = null, this._breakingImpulseThreshold = NaN, this._connectedBody = null, this._feedbackEnabled = !1, e.__super.call(this)
            }

            d(e, "laya.d3.physics.constraints.ConstraintComponent", r);
            var n = e.prototype;
            n._onDestroy = function () {
                k._physics3D.destroy(this._nativeConstraint), this._nativeConstraint = null
            }, u(0, n, "breakingImpulseThreshold", function () {
                return this._breakingImpulseThreshold
            }, function (t) {
                this._nativeConstraint.BreakingImpulseThreshold = t, this._breakingImpulseThreshold = t
            }), u(0, n, "enabled", function () {
                return m.superGet(r, this, "enabled")
            }, function (t) {
                this._nativeConstraint.IsEnabled = t, m.superSet(r, this, "enabled", t)
            }), u(0, n, "appliedImpulse", function () {
                return this._feedbackEnabled || (this._nativeConstraint.EnableFeedback(!0), this._feedbackEnabled = !0), this._nativeConstraint.AppliedImpulse
            }), u(0, n, "connectedBody", function () {
                return this._connectedBody
            }, function (t) {
                this._connectedBody = t
            })
        }(), function (t) {
            function o(t, e, n, i) {
                this._indexType = null, this._indexTypeByteCount = 0, this._indexCount = 0, this._canRead = !1, void 0 === n && (n = 35044), void 0 === i && (i = !1), o.__super.call(this), this._indexType = t, this._indexCount = e, this._bufferUsage = n, this._bufferType = 34963, this._canRead = i;
                var r;
                if ("ushort" == t) this._indexTypeByteCount = 2; else {
                    if ("ubyte" != t) throw new Error("unidentification index type.");
                    this._indexTypeByteCount = 1
                }
                r = this._indexTypeByteCount * e, this._byteLength = r;
                var a = c._curBindedBufferState;
                a ? a._bindedIndexBuffer === this ? E.instance.bufferData(this._bufferType, r, this._bufferUsage) : (a.unBind(), this.bind(), E.instance.bufferData(this._bufferType, r, this._bufferUsage), a.bind()) : (this.bind(), E.instance.bufferData(this._bufferType, r, this._bufferUsage)), i && ("ushort" == t ? this._buffer = new Uint16Array(e) : "ubyte" == t && (this._buffer = new Uint8Array(e)))
            }

            d(o, "laya.d3.graphics.IndexBuffer3D", t);
            var e = o.prototype;
            return e._bindForVAO = function () {
                if (!c._curBindedBufferState) throw"IndexBuffer3D: must bind current BufferState.";
                E.instance.bindBuffer(34963, this._glBuffer)
            }, e.bind = function () {
                if (c._curBindedBufferState) throw"IndexBuffer3D: must unbind current BufferState.";
                return i._bindedIndexBuffer !== this._glBuffer && (E.instance.bindBuffer(34963, this._glBuffer), i._bindedIndexBuffer = this._glBuffer, !0)
            }, e.setData = function (t, e, n, i) {
                void 0 === e && (e = 0), void 0 === n && (n = 0), void 0 === i && (i = 4294967295);
                var r = 0;
                "ushort" == this._indexType ? (r = 2, 0 === n && 4294967295 === i || (t = new Uint16Array(t.buffer, n * r, i))) : "ubyte" == this._indexType && (r = 1, 0 === n && 4294967295 === i || (t = new Uint8Array(t.buffer, n * r, i)));
                var a = c._curBindedBufferState;
                if (a ? a._bindedIndexBuffer === this ? E.instance.bufferSubData(this._bufferType, e * r, t) : (a.unBind(), this.bind(), E.instance.bufferSubData(this._bufferType, e * r, t), a.bind()) : (this.bind(), E.instance.bufferSubData(this._bufferType, e * r, t)), this._canRead) if (0 !== e || 0 !== n || 4294967295 !== i) {
                    var o = this._buffer.length - e;
                    o < i && (i = o);
                    for (var s = 0; s < i; s++) this._buffer[e + s] = t[s]
                } else this._buffer = t
            }, e.getData = function () {
                if (this._canRead) return this._buffer;
                throw new Error("Can't read data from VertexBuffer with only write flag!")
            }, e.destroy = function () {
                t.prototype.destroy.call(this), this._buffer = null
            }, u(0, e, "indexType", function () {
                return this._indexType
            }), u(0, e, "indexTypeByteCount", function () {
                return this._indexTypeByteCount
            }), u(0, e, "indexCount", function () {
                return this._indexCount
            }), u(0, e, "canRead", function () {
                return this._canRead
            }), o.INDEXTYPE_UBYTE = "ubyte", o.INDEXTYPE_USHORT = "ushort", o
        }(i)), Qe = function (t) {
            function l(t, e, n, i) {
                this._renderState = new X, this._owner = t, this._cacheSharders = [], this._publicValidDefine = 0, this._spriteValidDefine = 0, this._materialValidDefine = 0, this._validDefineMap = {}, l.__super.call(this, e, n, null, this._validDefineMap);
                var r = this._owner._publicDefinesMap, a = this._owner._spriteDefinesMap,
                    o = this._owner._materialDefinesMap;
                for (var s in this._validDefineMap) null != r[s] ? this._publicValidDefine |= r[s] : null != a[s] ? this._spriteValidDefine |= a[s] : null != o[s] && (this._materialValidDefine |= o[s]);
                this._stateMap = i
            }

            d(l, "laya.d3.shader.ShaderPass", I);
            var e = l.prototype;
            return e._definesToNameDic = function (t, e) {
                for (var n = {}, i = 1, r = 0; r < 32 && !(t < (i = 1 << r)); r++) {
                    t & i && (n[e[i]] = "")
                }
                return n
            }, e._compileToTree = function (t, e, n, i, r) {
                var a, o, s, l, h, u, c, _ = 0, d = 0, f = 0, m = 0;
                for (d = n; d < e.length; d++) if (!((s = e[d]).length < 1) && 0 !== (_ = s.indexOf("//"))) {
                    if (0 <= _ && (s = s.substr(0, _)), a = c || new R(i), c = null, 0 <= (_ = (a.text = s).indexOf("#"))) {
                        for (l = "#", m = _ + 1, f = s.length; m < f; m++) {
                            var p = s.charAt(m);
                            if (" " === p || "\t" === p || "?" === p) break;
                            l += p
                        }
                        switch (a.name = l) {
                            case"#ifdef":
                            case"#ifndef":
                                if (a.setParent(t), t = a, r) for (u = s.substr(m).split(I._splitToWordExps3), m = 0; m < u.length; m++) (s = u[m]).length && (r[s] = !0);
                                continue;
                            case"#if":
                            case"#elif":
                                if (a.setParent(t), t = a, r) for (u = s.substr(m).split(I._splitToWordExps3), m = 0; m < u.length; m++) (s = u[m]).length && "defined" != s && (r[s] = !0);
                                continue;
                            case"#else":
                                o = (t = t.parent).childs[t.childs.length - 1], a.setParent(t), t = a;
                                continue;
                            case"#endif":
                                o = (t = t.parent).childs[t.childs.length - 1], a.setParent(t);
                                continue;
                            case"#include":
                                u = I.splitToWords(s, null);
                                var T = I.includes[u[1]];
                                if (!T) throw"ShaderCompile error no this include file:" + u[1];
                                if ((_ = u[0].indexOf("?")) < 0) {
                                    a.setParent(t), s = T.getWith("with" == u[2] ? u[3] : null), this._compileToTree(a, s.split("\n"), 0, i, r), a.text = "";
                                    continue
                                }
                                a.setCondition(u[0].substr(_ + 1), 1), a.text = T.getWith("with" == u[2] ? u[3] : null);
                                break;
                            case"#import":
                                h = (u = I.splitToWords(s, null))[1], i.push({
                                    node: a,
                                    file: I.includes[h],
                                    ofs: a.text.length
                                });
                                continue
                        }
                    } else {
                        if ((o = t.childs[t.childs.length - 1]) && !o.name) {
                            0 < i.length && I.splitToWords(s, o), c = a, o.text += "\n" + s;
                            continue
                        }
                        0 < i.length && I.splitToWords(s, a)
                    }
                    a.setParent(t)
                }
            }, e.withCompile = function (t, e, n) {
                var i, r, a;
                if (t &= this._publicValidDefine, e &= this._spriteValidDefine, n &= this._materialValidDefine, r = this._cacheSharders[t]) if (a = r[e]) {
                    if (i = a[n]) return i
                } else a = r[e] = []; else a = (r = this._cacheSharders[t] = [])[e] = [];
                var o, s = this._definesToNameDic(t, this._owner._publicDefines),
                    l = this._definesToNameDic(e, this._owner._spriteDefines),
                    h = this._definesToNameDic(n, this._owner._materialDefines);
                if (Pt.debugMode) {
                    for (o in s) o + " ";
                    for (o in l) o + " ";
                    for (o in h) o + " ";
                    N.shaderHighPrecision || (t += Pt.SHADERDEFINE_HIGHPRECISION)
                }
                var u = {}, c = "";
                if (s) for (o in s) c += "#define " + o + "\n", u[o] = !0;
                if (l) for (o in l) c += "#define " + o + "\n", u[o] = !0;
                if (h) for (o in h) c += "#define " + o + "\n", u[o] = !0;
                var _ = this._VS.toscript(u, []), d = "";
                0 == _[0].indexOf("#version") && (d = _[0] + "\n", _.shift());
                var f = this._PS.toscript(u, []), m = "";
                return 0 == f[0].indexOf("#version") && (m = f[0] + "\n", f.shift()), i = new Xn(d + c + _.join("\n"), m + c + f.join("\n"), this._owner._attributeMap || this._owner._owner._attributeMap, this._owner._uniformMap || this._owner._owner._uniformMap, this), a[n] = i
            }, u(0, e, "renderState", function () {
                return this._renderState
            }), l
        }(), Je = function (t) {
            function e() {
                e.__super.call(this)
            }

            d(e, "laya.d3.core.BufferState", c);
            var n = e.prototype;
            return n.applyVertexBuffer = function (t) {
                if (c._curBindedBufferState !== this) throw"BufferState: must call bind() function first.";
                var e = E.instance, n = t.vertexDeclaration, i = null;
                for (var r in i = b.supportWebGLPlusRendering ? n._shaderValues._nativeArray : n._shaderValues.getData(), t.bind(), i) {
                    var a = parseInt(r), o = i[r];
                    e.enableVertexAttribArray(a), e.vertexAttribPointer(a, o[0], o[1], !!o[2], o[3], o[4])
                }
            }, n.applyVertexBuffers = function (t) {
                if (c._curBindedBufferState !== this) throw"BufferState: must call bind() function first.";
                for (var e = E.instance, n = 0, i = t.length; n < i; n++) {
                    var r = t[n], a = r.vertexDeclaration, o = null;
                    for (var s in o = b.supportWebGLPlusRendering ? a._shaderValues._nativeArray : a._shaderValues.getData(), r.bind(), o) {
                        var l = parseInt(s), h = o[s];
                        e.enableVertexAttribArray(l), e.vertexAttribPointer(l, h[0], h[1], !!h[2], h[3], h[4])
                    }
                }
            }, n.applyInstanceVertexBuffer = function (t) {
                if (V._angleInstancedArrays) {
                    if (c._curBindedBufferState !== this) throw"BufferState: must call bind() function first.";
                    var e = E.instance, n = t.vertexDeclaration, i = null;
                    for (var r in i = b.supportWebGLPlusRendering ? n._shaderValues._nativeArray : n._shaderValues.getData(), t.bind(), i) {
                        var a = parseInt(r), o = i[r];
                        e.enableVertexAttribArray(a), e.vertexAttribPointer(a, o[0], o[1], !!o[2], o[3], o[4]), V._angleInstancedArrays.vertexAttribDivisorANGLE(a, 1)
                    }
                }
            }, n.applyIndexBuffer = function (t) {
                if (c._curBindedBufferState !== this) throw"BufferState: must call bind() function first.";
                this._bindedIndexBuffer !== t && (t._bindForVAO(), this._bindedIndexBuffer = t)
            }, e
        }(), $e = function (n) {
            function u() {
                this.angle = NaN, this.radius = NaN, this.length = NaN, this.emitType = 0, u.__super.call(this), this.angle = 25 / 180 * Math.PI, this.radius = 1, this.length = 5, this.emitType = 0, this.randomDirection = !1
            }

            d(u, "laya.d3.core.particleShuriKen.module.shape.ConeShape", n);
            var t = u.prototype;
            return t._getShapeBoundBox = function (t) {
                var e = this.radius + this.length * Math.sin(this.angle), n = this.length * Math.cos(this.angle),
                    i = t.min;
                i.x = i.y = -e, i.z = 0;
                var r = t.max;
                r.x = r.y = e, r.z = n
            }, t._getSpeedBoundBox = function (t) {
                var e = Math.sin(this.angle), n = t.min;
                n.x = n.y = -e, n.z = 0;
                var i = t.max;
                i.x = i.y = e, i.z = 1
            }, t.generatePositionAndDirection = function (t, e, n, i) {
                var r, a = u._tempPositionPoint, o = NaN, s = NaN, l = Math.cos(this.angle), h = Math.sin(this.angle);
                switch (this.emitType) {
                    case 0:
                        n ? (n.seed = i[16], Le._randomPointInsideUnitCircle(u._tempPositionPoint, n), i[16] = n.seed) : Le._randomPointInsideUnitCircle(u._tempPositionPoint), o = a.x, s = a.y, t.x = o * this.radius, t.y = s * this.radius, t.z = 0, this.randomDirection ? (n ? (n.seed = i[17], Le._randomPointInsideUnitCircle(u._tempDirectionPoint, n), i[17] = n.seed) : Le._randomPointInsideUnitCircle(u._tempDirectionPoint), r = u._tempDirectionPoint, e.x = r.x * h, e.y = r.y * h) : (e.x = o * h, e.y = s * h), e.z = l;
                        break;
                    case 1:
                        n ? (n.seed = i[16], Le._randomPointUnitCircle(u._tempPositionPoint, n), i[16] = n.seed) : Le._randomPointUnitCircle(u._tempPositionPoint), o = a.x, s = a.y, t.x = o * this.radius, t.y = s * this.radius, t.z = 0, this.randomDirection ? (n ? (n.seed = i[17], Le._randomPointInsideUnitCircle(u._tempDirectionPoint, n), i[17] = n.seed) : Le._randomPointInsideUnitCircle(u._tempDirectionPoint), r = u._tempDirectionPoint, e.x = r.x * h, e.y = r.y * h) : (e.x = o * h, e.y = s * h), e.z = l;
                        break;
                    case 2:
                        n ? (n.seed = i[16], Le._randomPointInsideUnitCircle(u._tempPositionPoint, n)) : Le._randomPointInsideUnitCircle(u._tempPositionPoint), o = a.x, s = a.y, t.x = o * this.radius, t.y = s * this.radius, t.z = 0, e.x = o * h, e.y = s * h, e.z = l, Lt.normalize(e, e), n ? (Lt.scale(e, this.length * n.getFloat(), e), i[16] = n.seed) : Lt.scale(e, this.length * Math.random(), e), Lt.add(t, e, t), this.randomDirection && (n ? (n.seed = i[17], Le._randomPointUnitSphere(e, n), i[17] = n.seed) : Le._randomPointUnitSphere(e));
                        break;
                    case 3:
                        n ? (n.seed = i[16], Le._randomPointUnitCircle(u._tempPositionPoint, n)) : Le._randomPointUnitCircle(u._tempPositionPoint), o = a.x, s = a.y, t.x = o * this.radius, t.y = s * this.radius, t.z = 0, e.x = o * h, e.y = s * h, e.z = l, Lt.normalize(e, e), n ? (Lt.scale(e, this.length * n.getFloat(), e), i[16] = n.seed) : Lt.scale(e, this.length * Math.random(), e), Lt.add(t, e, t), this.randomDirection && (n ? (n.seed = i[17], Le._randomPointUnitSphere(e, n), i[17] = n.seed) : Le._randomPointUnitSphere(e));
                        break;
                    default:
                        throw new Error("ConeShape:emitType is invalid.")
                }
            }, t.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                e.angle = this.angle, e.radius = this.radius, e.length = this.length, e.emitType = this.emitType, e.randomDirection = this.randomDirection
            }, _(u, ["_tempPositionPoint", function () {
                return this._tempPositionPoint = new Ot
            }, "_tempDirectionPoint", function () {
                return this._tempDirectionPoint = new Ot
            }]), u
        }(G), tn = function (t) {
            function e(t) {
                e.__super.call(this), void 0 === t && (t = .5), this._radius = t, this._type = 1, this._nativeShape = new k._physics3D.btSphereShape(t)
            }

            d(e, "laya.d3.physics.shape.SphereColliderShape", H);
            var n = e.prototype;
            return n.clone = function () {
                var t = new e(this._radius);
                return this.cloneTo(t), t
            }, u(0, n, "radius", function () {
                return this._radius
            }), e
        }(), en = function (n) {
            function a() {
                this.radius = NaN, this.arc = NaN, this.emitFromEdge = !1, a.__super.call(this), this.radius = 1, this.arc = 2 * Math.PI, this.emitFromEdge = !1, this.randomDirection = !1
            }

            d(a, "laya.d3.core.particleShuriKen.module.shape.CircleShape", n);
            var t = a.prototype;
            return t._getShapeBoundBox = function (t) {
                var e = t.min;
                e.x = e.z = -this.radius, e.y = 0;
                var n = t.max;
                n.x = n.z = this.radius, n.y = 0
            }, t._getSpeedBoundBox = function (t) {
                var e = t.min;
                e.x = e.y = -1, e.z = 0;
                var n = t.max;
                n.x = n.y = 1, n.z = 0
            }, t.generatePositionAndDirection = function (t, e, n, i) {
                var r = a._tempPositionPoint;
                n ? (n.seed = i[16], this.emitFromEdge ? Le._randomPointUnitArcCircle(this.arc, a._tempPositionPoint, n) : Le._randomPointInsideUnitArcCircle(this.arc, a._tempPositionPoint, n), i[16] = n.seed) : this.emitFromEdge ? Le._randomPointUnitArcCircle(this.arc, a._tempPositionPoint) : Le._randomPointInsideUnitArcCircle(this.arc, a._tempPositionPoint), t.x = -r.x, t.y = r.y, t.z = 0, Lt.scale(t, this.radius, t), this.randomDirection ? n ? (n.seed = i[17], Le._randomPointUnitSphere(e, n), i[17] = n.seed) : Le._randomPointUnitSphere(e) : t.cloneTo(e)
            }, t.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                e.radius = this.radius, e.arc = this.arc, e.emitFromEdge = this.emitFromEdge, e.randomDirection = this.randomDirection
            }, _(a, ["_tempPositionPoint", function () {
                return this._tempPositionPoint = new Ot
            }]), a
        }(G), nn = function (t) {
            function o() {
                this._source = null, this._dest = null, this._shader = null, this._shaderData = null, this._subShader = 0, o.__super.call(this)
            }

            d(o, "laya.d3.core.render.command.BlitCMD", j);
            var e = o.prototype;
            return e.run = function () {
                this._shaderData.setTexture(le.SCREENTEXTURE_ID, this._source);
                var t = this._dest;
                t && t._start();
                for (var e = this._shader.getSubShaderAt(this._subShader)._passes, n = 0, i = e.length; n < i; n++) {
                    var r = e[n].withCompile(0, 0, 0);
                    r.bind(), this._shaderData && r.uploadUniforms(r._materialUniformParamsMap, this._shaderData, !0), r.uploadRenderStateBlendDepth(this._shaderData), r.uploadRenderStateFrontFace(this._shaderData, !0, null), Un.instance.render()
                }
                t && t._end()
            }, e.recover = function () {
                o._pool.push(this), this._dest = null, this._shader = null, this._shaderData = null
            }, o.create = function (t, e, n, i, r) {
                var a;
                return void 0 === r && (r = 0), (a = 0 < o._pool.length ? o._pool.pop() : new o)._source = t, a._dest = e, a._shader = n, a._shaderData = i, a._subShader = r, a
            }, o._pool = [], o
        }(), rn = function (t) {
            function e() {
                e.__super.call(this)
            }

            d(e, "laya.d3.CastShadowList", q);
            var n = e.prototype;
            return n.add = function (t) {
                if (-1 !== t._indexInCastShadowList) throw"CastShadowList:element has  in  CastShadowList.";
                this._add(t), t._indexInCastShadowList = this.length++
            }, n.remove = function (t) {
                var e = t._indexInCastShadowList;
                if (this.length--, e !== this.length) {
                    var n = this.elements[this.length];
                    (this.elements[e] = n)._indexInCastShadowList = e
                }
                t._indexInCastShadowList = -1
            }, e
        }(), an = function (n) {
            function i(t, e, n) {
                switch (i.__super.call(this), void 0 === t && (t = .5), void 0 === e && (e = 1.25), void 0 === n && (n = 1), this._radius = t, this._length = e, this._orientation = n, this._type = 3, n) {
                    case 0:
                        this._nativeShape = new k._physics3D.btCapsuleShapeX(t, e - 2 * t);
                        break;
                    case 1:
                        this._nativeShape = new k._physics3D.btCapsuleShape(t, e - 2 * t);
                        break;
                    case 2:
                        this._nativeShape = new k._physics3D.btCapsuleShapeZ(t, e - 2 * t);
                        break;
                    default:
                        throw"CapsuleColliderShape:unknown orientation."
                }
            }

            d(i, "laya.d3.physics.shape.CapsuleColliderShape", n);
            var t = i.prototype;
            return t._setScale = function (t) {
                var e = i._tempVector30;
                switch (this.orientation) {
                    case 0:
                        e.x = t.x, e.y = e.z = Math.max(t.y, t.z);
                        break;
                    case 1:
                        e.y = t.y, e.x = e.z = Math.max(t.x, t.z);
                        break;
                    case 2:
                        e.z = t.z, e.x = e.y = Math.max(t.x, t.y);
                        break;
                    default:
                        throw"CapsuleColliderShape:unknown orientation."
                }
                n.prototype._setScale.call(this, e)
            }, t.clone = function () {
                var t = new i(this._radius, this._length, this._orientation);
                return this.cloneTo(t), t
            }, u(0, t, "radius", function () {
                return this._radius
            }), u(0, t, "length", function () {
                return this._length
            }), u(0, t, "orientation", function () {
                return this._orientation
            }), _(i, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }]), i
        }(H), on = function (t) {
            function e(t) {
                this._mesh = null, this._boneIndicesList = null, this._subIndexBufferStart = null, this._subIndexBufferCount = null, this._skinAnimationDatas = null, this._indexInMesh = 0, this._vertexStart = 0, this._indexStart = 0, this._indexCount = 0, this._indices = null, this._vertexBuffer = null, this._indexBuffer = null, this._id = 0, e.__super.call(this), this._id = ++e._uniqueIDCounter, this._mesh = t, this._boneIndicesList = [], this._subIndexBufferStart = [], this._subIndexBufferCount = []
            }

            d(e, "laya.d3.resource.models.SubMesh", t);
            var n = e.prototype;
            return n._getType = function () {
                return e._type
            }, n._render = function (t) {
                this._mesh._bufferState.bind();
                var e = t.renderElement.render._skinnedData;
                if (e) for (var n = e[this._indexInMesh], i = this._boneIndicesList.length, r = 0; r < i; r++) t.shader.uploadCustomUniform(Di.BONES, n[r]), E.instance.drawElements(4, this._subIndexBufferCount[r], 5123, 2 * this._subIndexBufferStart[r]); else E.instance.drawElements(4, this._indexCount, 5123, 2 * this._indexStart);
                C.trianglesFaces += this._indexCount / 3, C.renderBatches++
            }, n.getIndices = function () {
                return this._indices
            }, n.destroy = function () {
                this._destroyed || (t.prototype.destroy.call(this), this._indexBuffer.destroy(), this._indexBuffer = null, this._mesh = null, this._boneIndicesList = null, this._subIndexBufferStart = null, this._subIndexBufferCount = null, this._skinAnimationDatas = null)
            }, e._uniqueIDCounter = 0, _(e, ["_type", function () {
                return this._type = J._typeCounter++
            }]), e
        }(J), sn = function (e) {
            function Y(t) {
                Y.__super.call(this), this._tempRotationMatrix = new He, this._uvLength = new Ot, this._bufferState = new Je, this._firstActiveElement = 0, this._firstNewElement = 0, this._firstFreeElement = 0, this._firstRetiredElement = 0, this._owner = t, this._ownerRender = t.particleRenderer, this._boundingBoxCorners = w(8, null), this._boundingSphere = new Et(new Lt, Number.MAX_VALUE), this._boundingBox = new ze(new Lt(-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE), new Lt(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE)), this._currentTime = 0, this._isEmitting = !1, this._isPlaying = !1, this._isPaused = !1, this._burstsIndex = 0, this._frameRateTime = 0, this._emissionTime = 0, this._totalDelayTime = 0, this._simulateUpdate = !1, this._bufferMaxParticles = 1, this.duration = 5, this.looping = !0, this.prewarm = !1, this.startDelayType = 0, this.startDelay = 0, this.startDelayMin = 0, this.startDelayMax = 0, this._startLifetimeType = 0, this._startLifetimeConstant = 5, this._startLifeTimeGradient = new Xt, this._startLifetimeConstantMin = 0, this._startLifetimeConstantMax = 5, this._startLifeTimeGradientMin = new Xt, this._startLifeTimeGradientMax = new Xt, this._maxStartLifetime = 5, this.startSpeedType = 0, this.startSpeedConstant = 5, this.startSpeedConstantMin = 0, this.startSpeedConstantMax = 5, this.threeDStartSize = !1, this.startSizeType = 0, this.startSizeConstant = 1, this.startSizeConstantSeparate = new Lt(1, 1, 1), this.startSizeConstantMin = 0, this.startSizeConstantMax = 1, this.startSizeConstantMinSeparate = new Lt(0, 0, 0), this.startSizeConstantMaxSeparate = new Lt(1, 1, 1), this.threeDStartRotation = !1, this.startRotationType = 0, this.startRotationConstant = 0, this.startRotationConstantSeparate = new Lt(0, 0, 0), this.startRotationConstantMin = 0, this.startRotationConstantMax = 0, this.startRotationConstantMinSeparate = new Lt(0, 0, 0), this.startRotationConstantMaxSeparate = new Lt(0, 0, 0), this.randomizeRotationDirection = 0, this.startColorType = 0, this.startColorConstant = new Ct(1, 1, 1, 1), this.startColorConstantMin = new Ct(1, 1, 1, 1), this.startColorConstantMax = new Ct(1, 1, 1, 1), this.gravityModifier = 0, this.simulationSpace = 1, this.scaleMode = 0, this.playOnAwake = !0, this._rand = new xt(0), this.autoRandomSeed = !0, this.randomSeed = new Uint32Array(1), this._randomSeeds = new Uint32Array(Y._RANDOMOFFSET.length), this.isPerformanceMode = !0, this._emission = new Tt, this._emission.enbale = !0
            }

            d(Y, "laya.d3.core.particleShuriKen.ShurikenParticleSystem", e);
            var t = Y.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t._getVertexBuffer = function (t) {
                return void 0 === t && (t = 0), 0 === t ? this._vertexBuffer : null
            }, t._getIndexBuffer = function () {
                return this._indexBuffer
            }, t._generateBoundingSphere = function () {
                var t = this._boundingSphere.center;
                t.x = 0, t.y = 0, t.z = 0, this._boundingSphere.radius = Number.MAX_VALUE
            }, t._generateBoundingBox = function () {
                var t = this._owner.particleRenderer, e = this._boundingBox.min, n = this._boundingBox.max, i = 0,
                    r = 0, a = NaN;
                switch (this.startLifetimeType) {
                    case 0:
                        a = this.startLifetimeConstant;
                        break;
                    case 1:
                        a = -Number.MAX_VALUE;
                        var o = o;
                        for (i = 0, r = o.gradientCount; i < r; i++) a = Math.max(a, o.getValueByIndex(i));
                        break;
                    case 2:
                        a = Math.max(this.startLifetimeConstantMin, this.startLifetimeConstantMax);
                        break;
                    case 3:
                        a = -Number.MAX_VALUE;
                        var s = s;
                        for (i = 0, r = s.gradientCount; i < r; i++) a = Math.max(a, s.getValueByIndex(i));
                        var l = l;
                        for (i = 0, r = l.gradientCount; i < r; i++) a = Math.max(a, l.getValueByIndex(i))
                }
                var h, u, c, _, d = NaN, f = NaN;
                switch (this.startSpeedType) {
                    case 0:
                        d = f = this.startSpeedConstant;
                        break;
                    case 1:
                        break;
                    case 2:
                        d = this.startLifetimeConstantMin, f = this.startLifetimeConstantMax
                }
                this._shape && this._shape.enable || (h = u = Lt._ZERO, c = Lt._ZERO, _ = Lt._UnitZ);
                var m, p, T = new Lt(c.x * d, c.y * d, c.z * d), E = new Lt(_.x * f, _.y * f, _.z * f);
                if (this._velocityOverLifetime && this._velocityOverLifetime.enbale) {
                    var v = this._velocityOverLifetime.velocity;
                    switch (v.type) {
                        case 0:
                            v.constant;
                            break;
                        case 1:
                            new Lt(v.gradientX.getAverageValue(), v.gradientY.getAverageValue(), v.gradientZ.getAverageValue());
                            break;
                        case 2:
                            v.constantMin, v.constantMax;
                            break;
                        case 3:
                            new Lt(v.gradientXMin.getAverageValue(), v.gradientYMin.getAverageValue(), v.gradientZMin.getAverageValue()), new Lt(v.gradientXMax.getAverageValue(), v.gradientYMax.getAverageValue(), v.gradientZMax.getAverageValue())
                    }
                }
                var g, S, y = this._owner.transform, x = y.position, D = Y._tempVector39, I = t.renderMode;
                switch (this.scaleMode) {
                    case 0:
                        var R = y.scale;
                        m = R, D.x = R.x, D.y = R.z, D.z = R.y, 1 === I && (p = R);
                        break;
                    case 1:
                        var M = y.localScale;
                        m = M, D.x = M.x, D.y = M.z, D.z = M.y, 1 === I && (p = M);
                        break;
                    case 2:
                        m = y.scale, D.x = D.y = D.z = 1, 1 === I && (p = Lt._ONE)
                }
                switch (this._velocityOverLifetime && this._velocityOverLifetime.enbale || (g = new Lt(T.x * a, T.y * a, T.z * a), S = new Lt(E.x * a, E.y * a, E.z * a), 2 != this.scaleMode ? (Lt.add(h, g, e), Lt.multiply(m, e, e), Lt.add(u, S, n), Lt.multiply(m, n, n)) : (Lt.multiply(m, h, e), Lt.add(e, g, e), Lt.multiply(m, u, n), Lt.add(n, S, n))), this.simulationSpace) {
                    case 0:
                        break;
                    case 1:
                        Lt.add(e, x, e), Lt.add(n, x, n)
                }
                var A = NaN, C = NaN;
                switch (this.startSizeType) {
                    case 0:
                        if (this.threeDStartSize) {
                            var L = L;
                            A = Math.max(L.x, L.y), 1 === I && (C = L.y)
                        } else A = this.startSizeConstant, 1 === I && (C = this.startSizeConstant);
                        break;
                    case 1:
                        break;
                    case 2:
                        if (this.threeDStartSize) {
                            var O = O;
                            A = Math.max(O.x, O.y), 1 === I && (C = O.y)
                        } else A = this.startSizeConstantMax, 1 === I && (C = this.startSizeConstantMax)
                }
                if (this._sizeOverLifetime && this._sizeOverLifetime.enbale) {
                    this._sizeOverLifetime.size;
                    A *= this._sizeOverLifetime.size.getMaxSizeInGradient()
                }
                var N = Y._tempVector30, V = NaN, P = NaN;
                switch (I) {
                    case 0:
                        V = A * Y.halfKSqrtOf2, Lt.scale(D, A, N), Lt.subtract(e, N, e), Lt.add(n, N, n);
                        break;
                    case 1:
                        var w = Y._tempVector31, b = Y._tempVector32, F = Y._tempVector33, B = Y._tempVector34;
                        this._velocityOverLifetime && this._velocityOverLifetime.enbale || (Lt.multiply(p, E, b), Lt.multiply(p, T, F));
                        var U = C * t.stretchedBillboardLengthScale,
                            z = Lt.scalarLength(b) * t.stretchedBillboardSpeedScale + U,
                            G = Lt.scalarLength(F) * t.stretchedBillboardSpeedScale + U, H = Y._tempVector35,
                            k = Y._tempVector36;
                        Lt.normalize(b, H), Lt.scale(H, z, B), Lt.subtract(S, B, B), Lt.normalize(F, k), Lt.scale(k, G, w), Lt.add(g, w, w), V = A * Y.halfKSqrtOf2, Lt.scale(D, V, N);
                        var X = Y._tempVector37, W = Y._tempVector38;
                        Lt.scale(H, .5, X), Lt.scale(k, .5, W), Lt.multiply(X, D, X), Lt.multiply(W, D, W), Lt.add(e, W, e), Lt.min(e, B, e), Lt.subtract(e, N, e), Lt.subtract(n, X, n), Lt.max(n, w, n), Lt.add(n, N, n);
                        break;
                    case 2:
                        P = .5 * (A *= Math.cos(.7853981633974483)), N.x = D.x * P, N.y = D.z * P, Lt.subtract(e, N, e), Lt.add(n, N, n);
                        break;
                    case 3:
                        P = .5 * (A *= Math.cos(.7853981633974483)), Lt.scale(D, P, N), Lt.subtract(e, N, e), Lt.add(n, N, n)
                }
                this._boundingBox.getCorners(this._boundingBoxCorners)
            }, t._updateEmission = function () {
                if (this.isAlive) if (this._simulateUpdate) this._simulateUpdate = !1; else {
                    var t = this._startUpdateLoopCount === C.loopCount || this._isPaused ? 0 : this._owner._scene.timer._delta / 1e3;
                    t = Math.min(Y._maxElapsedTime, t), this._updateParticles(t)
                }
            }, t._updateParticles = function (t) {
                (4 !== this._ownerRender.renderMode || this._ownerRender.mesh) && (this._currentTime += t, this._retireActiveParticles(), this._freeRetiredParticles(), this._totalDelayTime += t, this._totalDelayTime < this._playStartDelay || this._emission.enbale && this._isEmitting && !this._isPaused && this._advanceTime(t, this._currentTime))
            }, t._updateParticlesSimulationRestart = function (t) {
                this._firstActiveElement = 0, this._firstNewElement = 0, this._firstFreeElement = 0, this._firstRetiredElement = 0, this._burstsIndex = 0, this._frameRateTime = t, this._emissionTime = 0, this._totalDelayTime = 0;
                var e = this._currentTime = t;
                e < this._playStartDelay ? this._totalDelayTime = e : this._emission.enbale && this._advanceTime(t, t)
            }, t._retireActiveParticles = function () {
                for (; this._firstActiveElement != this._firstNewElement;) {
                    var t = this._firstActiveElement * this._floatCountPerVertex * this._vertexStride,
                        e = t + this._timeIndex;
                    if (this._currentTime - this._vertices[e] + 1e-4 < this._vertices[t + this._startLifeTimeIndex]) break;
                    this._vertices[e] = this._drawCounter, this._firstActiveElement++, this._firstActiveElement >= this._bufferMaxParticles && (this._firstActiveElement = 0)
                }
            }, t._freeRetiredParticles = function () {
                for (; this._firstRetiredElement != this._firstActiveElement;) {
                    var t = this._drawCounter - this._vertices[this._firstRetiredElement * this._floatCountPerVertex * this._vertexStride + this._timeIndex];
                    if (this.isPerformanceMode && t < 3) break;
                    this._firstRetiredElement++, this._firstRetiredElement >= this._bufferMaxParticles && (this._firstRetiredElement = 0)
                }
            }, t._burst = function (t, e) {
                for (var n = 0, i = this._emission._bursts, r = i.length; this._burstsIndex < r; this._burstsIndex++) {
                    var a = i[this._burstsIndex], o = a.time;
                    if (!(t <= o && o < e)) break;
                    var s = 0;
                    this.autoRandomSeed ? s = z.lerp(a.minCount, a.maxCount, Math.random()) : (this._rand.seed = this._randomSeeds[0], s = z.lerp(a.minCount, a.maxCount, this._rand.getFloat()), this._randomSeeds[0] = this._rand.seed), n += s
                }
                return n
            }, t._advanceTime = function (t, e) {
                var n = 0, i = this._emissionTime;
                this._emissionTime += t;
                var r = 0;
                if (this._emissionTime > this.duration) {
                    if (!this.looping) {
                        for (r = Math.min(this.maxParticles - this.aliveParticleCount, r), n = 0; n < r; n++) this.emit(e);
                        return this._isPlaying = !1, void this.stop()
                    }
                    r += this._burst(i, this._emissionTime), this._emissionTime -= this.duration, this._burstsIndex = 0, r += this._burst(0, this._emissionTime)
                } else r += this._burst(i, this._emissionTime);
                for (r = Math.min(this.maxParticles - this.aliveParticleCount, r), n = 0; n < r; n++) this.emit(e);
                var a = this.emission.emissionRate;
                if (0 < a) {
                    var o = 1 / a;
                    for (this._frameRateTime += o, this._frameRateTime = this._currentTime - (this._currentTime - this._frameRateTime) % this._maxStartLifetime; this._frameRateTime <= e && this.emit(this._frameRateTime);) this._frameRateTime += o;
                    this._frameRateTime = Math.floor(e / o) * o
                }
            }, t._initBufferDatas = function () {
                this._vertexBuffer && (this._vertexBuffer.destroy(), this._indexBuffer.destroy());
                var t = this._ownerRender, e = t.renderMode;
                if (-1 !== e && 0 < this.maxParticles) {
                    var n, i, r = 0, a = 0, o = 0, s = 0, l = 0, h = 0, u = 0, c = t.mesh;
                    if (4 === e) {
                        if (c) {
                            if (1 < c._vertexBuffers.length) throw new Error("ShurikenParticleSystem: submesh Count mesh be One or all subMeshes have the same vertexDeclaration.");
                            i = bn.vertexDeclaration, this._floatCountPerVertex = i.vertexStride / 4, this._startLifeTimeIndex = 12, this._timeIndex = 16, this._vertexStride = c._vertexBuffers[0].vertexCount;
                            var _ = this._bufferMaxParticles * this._vertexStride, d = _ % 65535;
                            if (1 < Math.floor(_ / 65535) + 1) throw new Error("ShurikenParticleSystem:the maxParticleCount multiply mesh vertexCount is large than 65535.");
                            h = i.vertexStride * d, this._vertexBuffer = new Ke(h, 35048), this._vertexBuffer.vertexDeclaration = i, this._vertices = new Float32Array(this._floatCountPerVertex * d), this._indexStride = c._indexBuffer.indexCount;
                            var f = c._indexBuffer.getData(), m = this._bufferMaxParticles * this._indexStride;
                            for (this._indexBuffer = new qe("ushort", m, 35044), n = new Uint16Array(m), u = h + 2 * m, r = s = 0; r < this._bufferMaxParticles; r++) {
                                var p = r * this._vertexStride;
                                for (a = 0, o = f.length; a < o; a++) n[s++] = p + f[a]
                            }
                            this._indexBuffer.setData(n), this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer), this._bufferState.applyIndexBuffer(this._indexBuffer), this._bufferState.unBind()
                        }
                    } else {
                        for (i = wn.vertexDeclaration, this._floatCountPerVertex = i.vertexStride / 4, this._startLifeTimeIndex = 7, this._timeIndex = 11, this._vertexStride = 4, h = i.vertexStride * this._bufferMaxParticles * this._vertexStride, this._vertexBuffer = new Ke(h, 35048), this._vertexBuffer.vertexDeclaration = i, this._vertices = new Float32Array(this._floatCountPerVertex * this._bufferMaxParticles * this._vertexStride), r = 0; r < this._bufferMaxParticles; r++) l = r * this._floatCountPerVertex * this._vertexStride, this._vertices[l] = -.5, this._vertices[l + 1] = -.5, this._vertices[l + 2] = 0, this._vertices[l + 3] = 1, l += this._floatCountPerVertex, this._vertices[l] = .5, this._vertices[l + 1] = -.5, this._vertices[l + 2] = 1, this._vertices[l + 3] = 1, l += this._floatCountPerVertex, this._vertices[l] = .5, this._vertices[l + 1] = .5, this._vertices[l + 2] = 1, this._vertices[l + 3] = 0, l += this._floatCountPerVertex, this._vertices[l] = -.5, this._vertices[l + 1] = .5, this._vertices[l + 2] = 0, this._vertices[l + 3] = 0;
                        for (this._indexStride = 6, this._indexBuffer = new qe("ushort", 6 * this._bufferMaxParticles, 35044), n = new Uint16Array(6 * this._bufferMaxParticles), r = 0; r < this._bufferMaxParticles; r++) {
                            s = 6 * r;
                            var T = r * this._vertexStride, E = T + 2;
                            n[s++] = T, n[s++] = E, n[s++] = T + 1, n[s++] = T, n[s++] = T + 3, n[s++] = E
                        }
                        this._indexBuffer.setData(n), u = h + 6 * this._bufferMaxParticles * 2, this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer), this._bufferState.applyIndexBuffer(this._indexBuffer), this._bufferState.unBind()
                    }
                    D._addMemory(u, u)
                }
            }, t.destroy = function () {
                e.prototype.destroy.call(this);
                var t = this._vertexBuffer._byteLength + 2 * this._indexBuffer.indexCount;
                D._addMemory(-t, -t), this._bufferState.destroy(), this._vertexBuffer.destroy(), this._indexBuffer.destroy(), this._emission.destroy(), this._bufferState = null, this._vertexBuffer = null, this._indexBuffer = null, this._owner = null, this._vertices = null, this._indexBuffer = null, this._emission = null, this._shape = null, this.startLifeTimeGradient = null, this.startLifeTimeGradientMin = null, this.startLifeTimeGradientMax = null, this.startSizeConstantSeparate = null, this.startSizeConstantMinSeparate = null, this.startSizeConstantMaxSeparate = null, this.startRotationConstantSeparate = null, this.startRotationConstantMinSeparate = null, this.startRotationConstantMaxSeparate = null, this.startColorConstant = null, this.startColorConstantMin = null, this.startColorConstantMax = null, this._velocityOverLifetime = null, this._colorOverLifetime = null, this._sizeOverLifetime = null, this._rotationOverLifetime = null, this._textureSheetAnimation = null
            }, t.emit = function (t) {
                var e = Y._tempPosition, n = Y._tempDirection;
                return this._shape && this._shape.enable ? this.autoRandomSeed ? this._shape.generatePositionAndDirection(e, n) : this._shape.generatePositionAndDirection(e, n, this._rand, this._randomSeeds) : (e.x = e.y = e.z = 0, n.x = n.y = 0, n.z = 1), this.addParticle(e, n, t)
            }, t.addParticle = function (t, e, n) {
                Lt.normalize(e, e);
                var i = this._firstFreeElement + 1;
                if (i >= this._bufferMaxParticles && (i = 0), i === this._firstRetiredElement) return !1;
                if (jt.create(this, this._ownerRender, this._owner.transform), this._currentTime - n >= jt.startLifeTime) return !0;
                var r = NaN, a = NaN, o = NaN, s = NaN, l = NaN, h = NaN, u = NaN,
                    c = this._velocityOverLifetime && this._velocityOverLifetime.enbale;
                if (c) {
                    var _ = this._velocityOverLifetime.velocity.type;
                    2 === _ || 3 === _ ? this.autoRandomSeed ? (r = Math.random(), a = Math.random(), o = Math.random()) : (this._rand.seed = this._randomSeeds[9], r = this._rand.getFloat(), a = this._rand.getFloat(), o = this._rand.getFloat(), this._randomSeeds[9] = this._rand.seed) : c = !1
                } else c = !1;
                var d = this._colorOverLifetime && this._colorOverLifetime.enbale;
                d ? 3 === this._colorOverLifetime.color.type ? this.autoRandomSeed ? s = Math.random() : (this._rand.seed = this._randomSeeds[10], s = this._rand.getFloat(), this._randomSeeds[10] = this._rand.seed) : d = !1 : d = !1;
                var f = this._sizeOverLifetime && this._sizeOverLifetime.enbale;
                f ? 3 === this._sizeOverLifetime.size.type ? this.autoRandomSeed ? l = Math.random() : (this._rand.seed = this._randomSeeds[11], l = this._rand.getFloat(), this._randomSeeds[11] = this._rand.seed) : f = !1 : f = !1;
                var m = this._rotationOverLifetime && this._rotationOverLifetime.enbale;
                if (m) {
                    var p = this._rotationOverLifetime.angularVelocity.type;
                    2 === p || 3 === p ? this.autoRandomSeed ? h = Math.random() : (this._rand.seed = this._randomSeeds[12], h = this._rand.getFloat(), this._randomSeeds[12] = this._rand.seed) : m = !1
                } else m = !1;
                var T = this._textureSheetAnimation && this._textureSheetAnimation.enable;
                T ? 3 === this._textureSheetAnimation.frame.type ? this.autoRandomSeed ? u = Math.random() : (this._rand.seed = this._randomSeeds[15], u = this._rand.getFloat(), this._randomSeeds[15] = this._rand.seed) : T = !1 : T = !1;
                var E, v = this._firstFreeElement * this._floatCountPerVertex * this._vertexStride,
                    g = jt.startUVInfo[0], S = jt.startUVInfo[1], y = jt.startUVInfo[2], x = jt.startUVInfo[3], D = 0,
                    I = 0, R = 0, M = 0, A = 0, C = this._ownerRender;
                if (4 === C.renderMode) {
                    var L = C.mesh._vertexBuffers[0];
                    E = L.getData();
                    var O = L.vertexDeclaration;
                    I = O.getVertexElementByUsage(0).offset / 4;
                    var N = O.getVertexElementByUsage(1);
                    R = N ? N.offset / 4 : -1;
                    var V = O.getVertexElementByUsage(2);
                    M = V ? V.offset / 4 : -1, D = O.vertexStride / 4, A = 0
                } else {
                    this._vertices[v + 2] = y, this._vertices[v + 3] = x + S;
                    var P = v + this._floatCountPerVertex;
                    this._vertices[P + 2] = y + g, this._vertices[P + 3] = x + S;
                    var w = P + this._floatCountPerVertex;
                    this._vertices[w + 2] = y + g, this._vertices[w + 3] = x;
                    var b = w + this._floatCountPerVertex;
                    this._vertices[b + 2] = y, this._vertices[b + 3] = x
                }
                for (var F = v, B = v + this._floatCountPerVertex * this._vertexStride; F < B; F += this._floatCountPerVertex) {
                    var U = 0;
                    if (4 === C.renderMode) {
                        U = F;
                        var z = D * A++, G = z + I;
                        this._vertices[U++] = E[G++], this._vertices[U++] = E[G++], this._vertices[U++] = E[G], this._vertices[U++] = -1 === R ? (this._vertices[U++] = 1, this._vertices[U++] = 1, this._vertices[U++] = 1) : (G = z + R, this._vertices[U++] = E[G++], this._vertices[U++] = E[G++], this._vertices[U++] = E[G++], E[G]), this._vertices[U++] = -1 === M ? this._vertices[U++] = 0 : (G = z + M, this._vertices[U++] = y + E[G++] * g, x + E[G] * S)
                    } else U = F + 4;
                    switch (this._vertices[U++] = t.x, this._vertices[U++] = t.y, this._vertices[U++] = t.z, this._vertices[U++] = jt.startLifeTime, this._vertices[U++] = e.x, this._vertices[U++] = e.y, this._vertices[U++] = e.z, this._vertices[U++] = n, this._vertices[U++] = jt.startColor.x, this._vertices[U++] = jt.startColor.y, this._vertices[U++] = jt.startColor.z, this._vertices[U++] = jt.startColor.w, this._vertices[U++] = jt.startSize[0], this._vertices[U++] = jt.startSize[1], this._vertices[U++] = jt.startSize[2], this._vertices[U++] = jt.startRotation[0], this._vertices[U++] = jt.startRotation[1], this._vertices[U++] = jt.startRotation[2], this._vertices[U++] = jt.startSpeed, d && (this._vertices[U + 1] = s), f && (this._vertices[U + 2] = l), m && (this._vertices[U + 3] = h), T && (this._vertices[U + 4] = u), c && (this._vertices[U + 5] = r, this._vertices[U + 6] = a, this._vertices[U + 7] = o), this.simulationSpace) {
                        case 0:
                            U += 8, this._vertices[U++] = jt.simulationWorldPostion[0], this._vertices[U++] = jt.simulationWorldPostion[1], this._vertices[U++] = jt.simulationWorldPostion[2], this._vertices[U++] = jt.simulationWorldRotation[0], this._vertices[U++] = jt.simulationWorldRotation[1], this._vertices[U++] = jt.simulationWorldRotation[2], this._vertices[U++] = jt.simulationWorldRotation[3];
                            break;
                        case 1:
                            break;
                        default:
                            throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.")
                    }
                }
                return this._firstFreeElement = i, !0
            }, t.addNewParticlesToVertexBuffer = function () {
                var t = 0;
                this._firstNewElement < this._firstFreeElement ? (t = this._firstNewElement * this._vertexStride * this._floatCountPerVertex, this._vertexBuffer.setData(this._vertices, t, t, (this._firstFreeElement - this._firstNewElement) * this._vertexStride * this._floatCountPerVertex)) : (t = this._firstNewElement * this._vertexStride * this._floatCountPerVertex, this._vertexBuffer.setData(this._vertices, t, t, (this._bufferMaxParticles - this._firstNewElement) * this._vertexStride * this._floatCountPerVertex), 0 < this._firstFreeElement && this._vertexBuffer.setData(this._vertices, 0, 0, this._firstFreeElement * this._vertexStride * this._floatCountPerVertex)), this._firstNewElement = this._firstFreeElement
            }, t._getType = function () {
                return Y._type
            }, t._prepareRender = function (t) {
                return this._updateEmission(), this._firstNewElement != this._firstFreeElement && this.addNewParticlesToVertexBuffer(), this._drawCounter++, this._firstActiveElement != this._firstFreeElement
            }, t._render = function (t) {
                this._bufferState.bind();
                var e = 0, n = E.instance;
                this._firstActiveElement < this._firstFreeElement ? (e = (this._firstFreeElement - this._firstActiveElement) * this._indexStride, n.drawElements(4, e, 5123, 2 * this._firstActiveElement * this._indexStride), C.trianglesFaces += e / 3, C.renderBatches++) : (e = (this._bufferMaxParticles - this._firstActiveElement) * this._indexStride, n.drawElements(4, e, 5123, 2 * this._firstActiveElement * this._indexStride), C.trianglesFaces += e / 3, C.renderBatches++, 0 < this._firstFreeElement && (e = this._firstFreeElement * this._indexStride, n.drawElements(4, e, 5123, 0), C.trianglesFaces += e / 3, C.renderBatches++))
            }, t.play = function () {
                if (this._burstsIndex = 0, this._isEmitting = !0, this._isPlaying = !0, this._isPaused = !1, this._emissionTime = 0, this._totalDelayTime = 0, !this.autoRandomSeed) for (var t = 0, e = this._randomSeeds.length; t < e; t++) this._randomSeeds[t] = this.randomSeed[0] + Y._RANDOMOFFSET[t];
                switch (this.startDelayType) {
                    case 0:
                        this._playStartDelay = this.startDelay;
                        break;
                    case 1:
                        this.autoRandomSeed ? this._playStartDelay = z.lerp(this.startDelayMin, this.startDelayMax, Math.random()) : (this._rand.seed = this._randomSeeds[2], this._playStartDelay = z.lerp(this.startDelayMin, this.startDelayMax, this._rand.getFloat()), this._randomSeeds[2] = this._rand.seed);
                        break;
                    default:
                        throw new Error("Utils3D: startDelayType is invalid.")
                }
                this._frameRateTime = this._currentTime + this._playStartDelay, this._startUpdateLoopCount = C.loopCount
            }, t.pause = function () {
                this._isPaused = !0
            }, t.simulate = function (t, e) {
                void 0 === e && (e = !0), this._simulateUpdate = !0, e ? this._updateParticlesSimulationRestart(t) : (this._isPaused = !1, this._updateParticles(t)), this.pause()
            }, t.stop = function () {
                this._burstsIndex = 0, this._isEmitting = !1, this._emissionTime = 0
            }, t.cloneTo = function (t) {
                var e = t;
                e.duration = this.duration, e.looping = this.looping, e.prewarm = this.prewarm, e.startDelayType = this.startDelayType, e.startDelay = this.startDelay, e.startDelayMin = this.startDelayMin, e.startDelayMax = this.startDelayMax, e._maxStartLifetime = this._maxStartLifetime, e.startLifetimeType = this.startLifetimeType, e.startLifetimeConstant = this.startLifetimeConstant, this.startLifeTimeGradient.cloneTo(e.startLifeTimeGradient), e.startLifetimeConstantMin = this.startLifetimeConstantMin, e.startLifetimeConstantMax = this.startLifetimeConstantMax, this.startLifeTimeGradientMin.cloneTo(e.startLifeTimeGradientMin), this.startLifeTimeGradientMax.cloneTo(e.startLifeTimeGradientMax), e.startSpeedType = this.startSpeedType, e.startSpeedConstant = this.startSpeedConstant, e.startSpeedConstantMin = this.startSpeedConstantMin, e.startSpeedConstantMax = this.startSpeedConstantMax, e.threeDStartSize = this.threeDStartSize, e.startSizeType = this.startSizeType, e.startSizeConstant = this.startSizeConstant, this.startSizeConstantSeparate.cloneTo(e.startSizeConstantSeparate), e.startSizeConstantMin = this.startSizeConstantMin, e.startSizeConstantMax = this.startSizeConstantMax, this.startSizeConstantMinSeparate.cloneTo(e.startSizeConstantMinSeparate), this.startSizeConstantMaxSeparate.cloneTo(e.startSizeConstantMaxSeparate), e.threeDStartRotation = this.threeDStartRotation, e.startRotationType = this.startRotationType, e.startRotationConstant = this.startRotationConstant, this.startRotationConstantSeparate.cloneTo(e.startRotationConstantSeparate), e.startRotationConstantMin = this.startRotationConstantMin, e.startRotationConstantMax = this.startRotationConstantMax, this.startRotationConstantMinSeparate.cloneTo(e.startRotationConstantMinSeparate), this.startRotationConstantMaxSeparate.cloneTo(e.startRotationConstantMaxSeparate), e.randomizeRotationDirection = this.randomizeRotationDirection, e.startColorType = this.startColorType, this.startColorConstant.cloneTo(e.startColorConstant), this.startColorConstantMin.cloneTo(e.startColorConstantMin), this.startColorConstantMax.cloneTo(e.startColorConstantMax), e.gravityModifier = this.gravityModifier, e.simulationSpace = this.simulationSpace, e.scaleMode = this.scaleMode, e.playOnAwake = this.playOnAwake, e.maxParticles = this.maxParticles, this._emission && (e._emission = this._emission.clone()), this.shape && (e.shape = this.shape.clone()), this.velocityOverLifetime && (e.velocityOverLifetime = this.velocityOverLifetime.clone()), this.colorOverLifetime && (e.colorOverLifetime = this.colorOverLifetime.clone()), this.sizeOverLifetime && (e.sizeOverLifetime = this.sizeOverLifetime.clone()), this.rotationOverLifetime && (e.rotationOverLifetime = this.rotationOverLifetime.clone()), this.textureSheetAnimation && (e.textureSheetAnimation = this.textureSheetAnimation.clone()), e.isPerformanceMode = this.isPerformanceMode, e._isEmitting = this._isEmitting, e._isPlaying = this._isPlaying, e._isPaused = this._isPaused, e._playStartDelay = this._playStartDelay, e._frameRateTime = this._frameRateTime, e._emissionTime = this._emissionTime, e._totalDelayTime = this._totalDelayTime, e._burstsIndex = this._burstsIndex
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, t, "maxParticles", function () {
                return this._bufferMaxParticles - 1
            }, function (t) {
                var e = t + 1;
                e !== this._bufferMaxParticles && (this._bufferMaxParticles = e, this._initBufferDatas())
            }), u(0, t, "isEmitting", function () {
                return this._isEmitting
            }), u(0, t, "isAlive", function () {
                return !!(this._isPlaying || 0 < this.aliveParticleCount)
            }), u(0, t, "shape", function () {
                return this._shape
            }, function (t) {
                this._shape !== t && (t && t.enable ? this._owner._render._defineDatas.add(yi.SHADERDEFINE_SHAPE) : this._owner._render._defineDatas.remove(yi.SHADERDEFINE_SHAPE), this._shape = t)
            }), u(0, t, "rotationOverLifetime", function () {
                return this._rotationOverLifetime
            }, function (t) {
                var e = this._owner._render._defineDatas, n = this._owner._render._shaderValues;
                if (t) {
                    var i = t.angularVelocity;
                    if (!i) return;
                    var r = i.separateAxes, a = i.type;
                    if (t.enbale) switch (r ? e.add(yi.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE) : e.add(yi.SHADERDEFINE_ROTATIONOVERLIFETIME), a) {
                        case 0:
                            e.add(yi.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT);
                            break;
                        case 1:
                            e.add(yi.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE);
                            break;
                        case 2:
                            e.add(yi.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS);
                            break;
                        case 3:
                            e.add(yi.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES)
                    } else e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIME), e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE), e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT), e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE), e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS), e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES);
                    switch (a) {
                        case 0:
                            r ? n.setVector3(yi.ROLANGULARVELOCITYCONSTSEPRARATE, i.constantSeparate) : n.setNumber(yi.ROLANGULARVELOCITYCONST, i.constant);
                            break;
                        case 1:
                            r ? (n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTX, i.gradientX._elements), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTY, i.gradientY._elements), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTZ, i.gradientZ._elements)) : n.setBuffer(yi.ROLANGULARVELOCITYGRADIENT, i.gradient._elements);
                            break;
                        case 2:
                            r ? (n.setVector3(yi.ROLANGULARVELOCITYCONSTSEPRARATE, i.constantMinSeparate), n.setVector3(yi.ROLANGULARVELOCITYCONSTMAXSEPRARATE, i.constantMaxSeparate)) : (n.setNumber(yi.ROLANGULARVELOCITYCONST, i.constantMin), n.setNumber(yi.ROLANGULARVELOCITYCONSTMAX, i.constantMax));
                            break;
                        case 3:
                            r ? (n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTX, i.gradientXMin._elements), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTXMAX, i.gradientXMax._elements), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTY, i.gradientYMin._elements), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTYMAX, i.gradientYMax._elements), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTZ, i.gradientZMin._elements), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTZMAX, i.gradientZMax._elements)) : (n.setBuffer(yi.ROLANGULARVELOCITYGRADIENT, i.gradientMin._elements), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTMAX, i.gradientMax._elements))
                    }
                } else e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIME), e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE), e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT), e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE), e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS), e.remove(yi.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES), n.setVector(yi.ROLANGULARVELOCITYCONSTSEPRARATE, null), n.setVector(yi.ROLANGULARVELOCITYCONSTMAXSEPRARATE, null), n.setNumber(yi.ROLANGULARVELOCITYCONST, void 0), n.setNumber(yi.ROLANGULARVELOCITYCONSTMAX, void 0), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTX, null), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTXMAX, null), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTY, null), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTYMAX, null), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTZ, null), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTZMAX, null), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTWMAX, null), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENT, null), n.setBuffer(yi.ROLANGULARVELOCITYGRADIENTMAX, null);
                this._rotationOverLifetime = t
            }), u(0, t, "emission", function () {
                return this._emission
            }), u(0, t, "emissionTime", function () {
                return this._emissionTime > this.duration ? this.duration : this._emissionTime
            }), u(0, t, "aliveParticleCount", function () {
                return this._firstNewElement >= this._firstRetiredElement ? this._firstNewElement - this._firstRetiredElement : this._bufferMaxParticles - this._firstRetiredElement + this._firstNewElement
            }), u(0, t, "isPlaying", function () {
                return this._isPlaying
            }), u(0, t, "isPaused", function () {
                return this._isPaused
            }), u(0, t, "startLifetimeType", function () {
                return this._startLifetimeType
            }, function (t) {
                var e = 0, n = 0;
                switch (this.startLifetimeType) {
                    case 0:
                        this._maxStartLifetime = this.startLifetimeConstant;
                        break;
                    case 1:
                        this._maxStartLifetime = -Number.MAX_VALUE;
                        var i = i;
                        for (e = 0, n = i.gradientCount; e < n; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, i.getValueByIndex(e));
                        break;
                    case 2:
                        this._maxStartLifetime = Math.max(this.startLifetimeConstantMin, this.startLifetimeConstantMax);
                        break;
                    case 3:
                        this._maxStartLifetime = -Number.MAX_VALUE;
                        var r = r;
                        for (e = 0, n = r.gradientCount; e < n; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, r.getValueByIndex(e));
                        var a = a;
                        for (e = 0, n = a.gradientCount; e < n; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, a.getValueByIndex(e))
                }
                this._startLifetimeType = t
            }), u(0, t, "startLifetimeConstant", function () {
                return this._startLifetimeConstant
            }, function (t) {
                0 === this._startLifetimeType && (this._maxStartLifetime = t), this._startLifetimeConstant = t
            }), u(0, t, "startLifetimeConstantMin", function () {
                return this._startLifetimeConstantMin
            }, function (t) {
                2 === this._startLifetimeType && (this._maxStartLifetime = Math.max(t, this._startLifetimeConstantMax)), this._startLifetimeConstantMin = t
            }), u(0, t, "startLifeTimeGradient", function () {
                return this._startLifeTimeGradient
            }, function (t) {
                if (1 === this._startLifetimeType) {
                    this._maxStartLifetime = -Number.MAX_VALUE;
                    for (var e = 0, n = t.gradientCount; e < n; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, t.getValueByIndex(e))
                }
                this._startLifeTimeGradient = t
            }), u(0, t, "startLifetimeConstantMax", function () {
                return this._startLifetimeConstantMax
            }, function (t) {
                2 === this._startLifetimeType && (this._maxStartLifetime = Math.max(this._startLifetimeConstantMin, t)), this._startLifetimeConstantMax = t
            }), u(0, t, "startLifeTimeGradientMin", function () {
                return this._startLifeTimeGradientMin
            }, function (t) {
                if (3 === this._startLifetimeType) {
                    var e = 0, n = 0;
                    for (this._maxStartLifetime = -Number.MAX_VALUE, e = 0, n = t.gradientCount; e < n; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, t.getValueByIndex(e));
                    for (e = 0, n = this._startLifeTimeGradientMax.gradientCount; e < n; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, this._startLifeTimeGradientMax.getValueByIndex(e))
                }
                this._startLifeTimeGradientMin = t
            }), u(0, t, "startLifeTimeGradientMax", function () {
                return this._startLifeTimeGradientMax
            }, function (t) {
                if (3 === this._startLifetimeType) {
                    var e = 0, n = 0;
                    for (this._maxStartLifetime = -Number.MAX_VALUE, e = 0, n = this._startLifeTimeGradientMin.gradientCount; e < n; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, this._startLifeTimeGradientMin.getValueByIndex(e));
                    for (e = 0, n = t.gradientCount; e < n; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, t.getValueByIndex(e))
                }
                this._startLifeTimeGradientMax = t
            }), u(0, t, "velocityOverLifetime", function () {
                return this._velocityOverLifetime
            }, function (t) {
                var e = this._owner._render._defineDatas, n = this._owner._render._shaderValues;
                if (t) {
                    var i = t.velocity, r = i.type;
                    if (t.enbale) switch (r) {
                        case 0:
                            e.add(yi.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT);
                            break;
                        case 1:
                            e.add(yi.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE);
                            break;
                        case 2:
                            e.add(yi.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT);
                            break;
                        case 3:
                            e.add(yi.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE)
                    } else e.remove(yi.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT), e.remove(yi.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE), e.remove(yi.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT), e.remove(yi.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE);
                    switch (r) {
                        case 0:
                            n.setVector3(yi.VOLVELOCITYCONST, i.constant);
                            break;
                        case 1:
                            n.setBuffer(yi.VOLVELOCITYGRADIENTX, i.gradientX._elements), n.setBuffer(yi.VOLVELOCITYGRADIENTY, i.gradientY._elements), n.setBuffer(yi.VOLVELOCITYGRADIENTZ, i.gradientZ._elements);
                            break;
                        case 2:
                            n.setVector3(yi.VOLVELOCITYCONST, i.constantMin), n.setVector3(yi.VOLVELOCITYCONSTMAX, i.constantMax);
                            break;
                        case 3:
                            n.setBuffer(yi.VOLVELOCITYGRADIENTX, i.gradientXMin._elements), n.setBuffer(yi.VOLVELOCITYGRADIENTXMAX, i.gradientXMax._elements), n.setBuffer(yi.VOLVELOCITYGRADIENTY, i.gradientYMin._elements), n.setBuffer(yi.VOLVELOCITYGRADIENTYMAX, i.gradientYMax._elements), n.setBuffer(yi.VOLVELOCITYGRADIENTZ, i.gradientZMin._elements), n.setBuffer(yi.VOLVELOCITYGRADIENTZMAX, i.gradientZMax._elements)
                    }
                    n.setInt(yi.VOLSPACETYPE, t.space)
                } else e.remove(yi.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT), e.remove(yi.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE), e.remove(yi.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT), e.remove(yi.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE), n.setVector(yi.VOLVELOCITYCONST, null), n.setBuffer(yi.VOLVELOCITYGRADIENTX, null), n.setBuffer(yi.VOLVELOCITYGRADIENTY, null), n.setBuffer(yi.VOLVELOCITYGRADIENTZ, null), n.setVector(yi.VOLVELOCITYCONST, null), n.setVector(yi.VOLVELOCITYCONSTMAX, null), n.setBuffer(yi.VOLVELOCITYGRADIENTX, null), n.setBuffer(yi.VOLVELOCITYGRADIENTXMAX, null), n.setBuffer(yi.VOLVELOCITYGRADIENTY, null), n.setBuffer(yi.VOLVELOCITYGRADIENTYMAX, null), n.setBuffer(yi.VOLVELOCITYGRADIENTZ, null), n.setBuffer(yi.VOLVELOCITYGRADIENTZMAX, null), n.setInt(yi.VOLSPACETYPE, void 0);
                this._velocityOverLifetime = t
            }), u(0, t, "colorOverLifetime", function () {
                return this._colorOverLifetime
            }, function (t) {
                var e = this._owner._render._defineDatas, n = this._owner._render._shaderValues;
                if (t) {
                    var i = t.color;
                    if (t.enbale) switch (i.type) {
                        case 1:
                            e.add(yi.SHADERDEFINE_COLOROVERLIFETIME);
                            break;
                        case 3:
                            e.add(yi.SHADERDEFINE_RANDOMCOLOROVERLIFETIME)
                    } else e.remove(yi.SHADERDEFINE_COLOROVERLIFETIME), e.remove(yi.SHADERDEFINE_RANDOMCOLOROVERLIFETIME);
                    switch (i.type) {
                        case 1:
                            var r = i.gradient;
                            n.setBuffer(yi.COLOROVERLIFEGRADIENTALPHAS, r._alphaElements), n.setBuffer(yi.COLOROVERLIFEGRADIENTCOLORS, r._rgbElements);
                            break;
                        case 3:
                            var a = i.gradientMin, o = i.gradientMax;
                            n.setBuffer(yi.COLOROVERLIFEGRADIENTALPHAS, a._alphaElements), n.setBuffer(yi.COLOROVERLIFEGRADIENTCOLORS, a._rgbElements), n.setBuffer(yi.MAXCOLOROVERLIFEGRADIENTALPHAS, o._alphaElements), n.setBuffer(yi.MAXCOLOROVERLIFEGRADIENTCOLORS, o._rgbElements)
                    }
                } else e.remove(yi.SHADERDEFINE_COLOROVERLIFETIME), e.remove(yi.SHADERDEFINE_RANDOMCOLOROVERLIFETIME), n.setBuffer(yi.COLOROVERLIFEGRADIENTALPHAS, r._alphaElements), n.setBuffer(yi.COLOROVERLIFEGRADIENTCOLORS, r._rgbElements), n.setBuffer(yi.COLOROVERLIFEGRADIENTALPHAS, a._alphaElements), n.setBuffer(yi.COLOROVERLIFEGRADIENTCOLORS, a._rgbElements), n.setBuffer(yi.MAXCOLOROVERLIFEGRADIENTALPHAS, o._alphaElements), n.setBuffer(yi.MAXCOLOROVERLIFEGRADIENTCOLORS, o._rgbElements);
                this._colorOverLifetime = t
            }), u(0, t, "sizeOverLifetime", function () {
                return this._sizeOverLifetime
            }, function (t) {
                var e = this._owner._render._defineDatas, n = this._owner._render._shaderValues;
                if (t) {
                    var i = t.size, r = i.separateAxes, a = i.type;
                    if (t.enbale) switch (a) {
                        case 0:
                            r ? e.add(yi.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE) : e.add(yi.SHADERDEFINE_SIZEOVERLIFETIMECURVE);
                            break;
                        case 2:
                            r ? e.add(yi.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE) : e.add(yi.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES)
                    } else e.remove(yi.SHADERDEFINE_SIZEOVERLIFETIMECURVE), e.remove(yi.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE), e.remove(yi.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES), e.remove(yi.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE);
                    switch (a) {
                        case 0:
                            r ? (n.setBuffer(yi.SOLSIZEGRADIENTX, i.gradientX._elements), n.setBuffer(yi.SOLSIZEGRADIENTY, i.gradientY._elements), n.setBuffer(yi.SOLSizeGradientZ, i.gradientZ._elements)) : n.setBuffer(yi.SOLSIZEGRADIENT, i.gradient._elements);
                            break;
                        case 2:
                            r ? (n.setBuffer(yi.SOLSIZEGRADIENTX, i.gradientXMin._elements), n.setBuffer(yi.SOLSIZEGRADIENTXMAX, i.gradientXMax._elements), n.setBuffer(yi.SOLSIZEGRADIENTY, i.gradientYMin._elements), n.setBuffer(yi.SOLSIZEGRADIENTYMAX, i.gradientYMax._elements), n.setBuffer(yi.SOLSizeGradientZ, i.gradientZMin._elements), n.setBuffer(yi.SOLSizeGradientZMAX, i.gradientZMax._elements)) : (n.setBuffer(yi.SOLSIZEGRADIENT, i.gradientMin._elements), n.setBuffer(yi.SOLSizeGradientMax, i.gradientMax._elements))
                    }
                } else e.remove(yi.SHADERDEFINE_SIZEOVERLIFETIMECURVE), e.remove(yi.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE), e.remove(yi.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES), e.remove(yi.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE), n.setBuffer(yi.SOLSIZEGRADIENTX, null), n.setBuffer(yi.SOLSIZEGRADIENTXMAX, null), n.setBuffer(yi.SOLSIZEGRADIENTY, null), n.setBuffer(yi.SOLSIZEGRADIENTYMAX, null), n.setBuffer(yi.SOLSizeGradientZ, null), n.setBuffer(yi.SOLSizeGradientZMAX, null), n.setBuffer(yi.SOLSIZEGRADIENT, null), n.setBuffer(yi.SOLSizeGradientMax, null);
                this._sizeOverLifetime = t
            }), u(0, t, "textureSheetAnimation", function () {
                return this._textureSheetAnimation
            }, function (t) {
                var e = this._owner._render._defineDatas, n = this._owner._render._shaderValues;
                if (t) {
                    var i = t.frame, r = i.type;
                    if (t.enable) switch (r) {
                        case 1:
                            e.add(yi.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE);
                            break;
                        case 3:
                            e.add(yi.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE)
                    } else e.remove(yi.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE), e.remove(yi.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE);
                    if (1 === r || 3 === r) {
                        n.setNumber(yi.TEXTURESHEETANIMATIONCYCLES, t.cycles);
                        var a = t.tiles, o = this._uvLength;
                        o.x = 1 / a.x, o.y = 1 / a.y, n.setVector2(yi.TEXTURESHEETANIMATIONSUBUVLENGTH, this._uvLength)
                    }
                    switch (r) {
                        case 1:
                            n.setBuffer(yi.TEXTURESHEETANIMATIONGRADIENTUVS, i.frameOverTimeData._elements);
                            break;
                        case 3:
                            n.setBuffer(yi.TEXTURESHEETANIMATIONGRADIENTUVS, i.frameOverTimeDataMin._elements), n.setBuffer(yi.TEXTURESHEETANIMATIONGRADIENTMAXUVS, i.frameOverTimeDataMax._elements)
                    }
                } else e.remove(yi.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE), e.remove(yi.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE), n.setNumber(yi.TEXTURESHEETANIMATIONCYCLES, void 0), n.setVector(yi.TEXTURESHEETANIMATIONSUBUVLENGTH, null), n.setBuffer(yi.TEXTURESHEETANIMATIONGRADIENTUVS, null), n.setBuffer(yi.TEXTURESHEETANIMATIONGRADIENTMAXUVS, null);
                this._textureSheetAnimation = t
            }), Y.halfKSqrtOf2 = .71, _(Y, ["_RANDOMOFFSET", function () {
                return this._RANDOMOFFSET = new Uint32Array([592910910, 3276756734, 322376503, 306581307, 1793934638, 3737431713, 2527743459, 2368504881, 4085612399, 3774601268, 326370691, 1494990940, 1089181156, 3159510623, 2941263940, 2786374529, 271901988, 4233252447])
            }, "_maxElapsedTime", function () {
                return this._maxElapsedTime = 1 / 3
            }, "_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempVector31", function () {
                return this._tempVector31 = new Lt
            }, "_tempVector32", function () {
                return this._tempVector32 = new Lt
            }, "_tempVector33", function () {
                return this._tempVector33 = new Lt
            }, "_tempVector34", function () {
                return this._tempVector34 = new Lt
            }, "_tempVector35", function () {
                return this._tempVector35 = new Lt
            }, "_tempVector36", function () {
                return this._tempVector36 = new Lt
            }, "_tempVector37", function () {
                return this._tempVector37 = new Lt
            }, "_tempVector38", function () {
                return this._tempVector38 = new Lt
            }, "_tempVector39", function () {
                return this._tempVector39 = new Lt
            }, "_tempPosition", function () {
                return this._tempPosition = new Lt
            }, "_tempDirection", function () {
                return this._tempDirection = new Lt
            }, "_type", function () {
                return this._type = J._typeCounter++
            }]), Y
        }(J), ln = (function (t) {
            function n(t, e) {
                n.__super.call(this), this._normal = t, this._offset = e, this._type = 6, n._nativeNormal.setValue(-t.x, t.y, t.z), this._nativeShape = new k._physics3D.btStaticPlaneShape(n._nativeNormal, e)
            }

            d(n, "laya.d3.physics.shape.StaticPlaneColliderShape", H), n.prototype.clone = function () {
                var t = new n(this._normal, this._offset);
                return this.cloneTo(t), t
            }, _(n, ["_nativeNormal", function () {
                return this._nativeNormal = new k._physics3D.btVector3(0, 0, 0)
            }])
        }(), function (t) {
            function e() {
                this._instanceBatchOpaqueMarks = [], this._vertexBatchOpaqueMarks = [], this._cacheBufferStates = [], e.__super.call(this), yn.instance = new yn, this._updateCountMark = 0
            }

            d(e, "laya.d3.graphics.MeshRenderDynamicBatchManager", t);
            var n = e.prototype;
            return n.getInstanceBatchOpaquaMark = function (t, e, n, i) {
                var r = this._instanceBatchOpaqueMarks[t] || (this._instanceBatchOpaqueMarks[t] = []),
                    a = r[e ? 0 : 1] || (r[e ? 0 : 1] = []), o = a[n] || (a[n] = []);
                return o[i] || (o[i] = new pe)
            }, n.getVertexBatchOpaquaMark = function (t, e, n, i) {
                var r = this._vertexBatchOpaqueMarks[t] || (this._vertexBatchOpaqueMarks[t] = []),
                    a = r[e ? 0 : 1] || (r[e ? 0 : 1] = []), o = a[n] || (a[n] = []);
                return o[i] || (o[i] = new pe)
            }, n._getBufferState = function (t) {
                var e = this._cacheBufferStates[t.id];
                if (!e) {
                    var n = yn.instance;
                    (e = new Je).bind();
                    var i = n._vertexBuffer;
                    i.vertexDeclaration = t, e.applyVertexBuffer(i), e.applyIndexBuffer(n._indexBuffer), e.unBind(), this._cacheBufferStates[t.id] = e
                }
                return e
            }, n._getBatchRenderElementFromPool = function () {
                var t = this._batchRenderElementPool[this._batchRenderElementPoolIndex++];
                return t || (t = new Pn, (this._batchRenderElementPool[this._batchRenderElementPoolIndex - 1] = t).vertexBatchElementList = [], t.instanceBatchElementList = []), t
            }, n._clear = function () {
                t.prototype._clear.call(this), this._updateCountMark++
            }, _(e, ["instance", function () {
                return this.instance = new e
            }]), e
        }(Q)), hn = function (t) {
            function i(t, e, n) {
                i.__super.call(this), void 0 === t && (t = 1), void 0 === e && (e = 1), void 0 === n && (n = 1), this._sizeX = t, this._sizeY = e, this._sizeZ = n, this._type = 0, i._nativeSize.setValue(t / 2, e / 2, n / 2), this._nativeShape = new k._physics3D.btBoxShape(i._nativeSize)
            }

            d(i, "laya.d3.physics.shape.BoxColliderShape", H);
            var e = i.prototype;
            return e.clone = function () {
                var t = new i(this._sizeX, this._sizeY, this._sizeZ);
                return this.cloneTo(t), t
            }, u(0, e, "sizeX", function () {
                return this._sizeX
            }), u(0, e, "sizeY", function () {
                return this._sizeY
            }), u(0, e, "sizeZ", function () {
                return this._sizeZ
            }), _(i, ["_nativeSize", function () {
                return this._nativeSize = new k._physics3D.btVector3(0, 0, 0)
            }]), i
        }(), un = function (t) {
            function e() {
                e.__super.call(this)
            }

            d(e, "laya.d3.component.SimpleSingletonList", q);
            var n = e.prototype;
            return n.add = function (t) {
                if (-1 !== t._getIndexInList()) throw"SimpleSingletonList:" + t + " has  in  SingletonList.";
                this._add(t), t._setIndexInList(this.length++)
            }, n.remove = function (t) {
                var e = t._getIndexInList();
                if (this.length--, e !== this.length) {
                    var n = this.elements[this.length];
                    (this.elements[e] = n)._setIndexInList(e)
                }
                t._setIndexInList(-1)
            }, e
        }(), cn = function (t) {
            function e() {
                e.__super.call(this)
            }

            d(e, "laya.d3.physics.PhysicsUpdateList", q);
            var n = e.prototype;
            return n.add = function (t) {
                if (-1 !== t._inPhysicUpdateListIndex) throw"PhysicsUpdateList:element has  in  PhysicsUpdateList.";
                this._add(t), t._inPhysicUpdateListIndex = this.length++
            }, n.remove = function (t) {
                var e = t._inPhysicUpdateListIndex;
                if (this.length--, e !== this.length) {
                    var n = this.elements[this.length];
                    (this.elements[e] = n)._inPhysicUpdateListIndex = e
                }
                t._inPhysicUpdateListIndex = -1
            }, e
        }(), _n = function (t) {
            function P(t, e, n) {
                P.__super.call(this), this._bufferState = new Je, this._batchID = P._batchIDCounter++, this._batchElements = [], this._currentBatchVertexCount = 0, this._currentBatchIndexCount = 0, this._vertexDeclaration = n, this.batchOwner = t, this.number = e
            }

            d(P, "laya.d3.graphics.SubMeshStaticBatch", J);
            var e = P.prototype;
            return m.imps(e, {"laya.resource.IDispose": !0}), e._getStaticBatchBakedVertexs = function (t, e, n, i, r, a) {
                var o, s = a._vertexBuffers[0], l = s.vertexDeclaration, h = l.getVertexElementByUsage(0).offset / 4,
                    u = l.getVertexElementByUsage(3), c = u ? u.offset / 4 : -1, _ = l.getVertexElementByUsage(1),
                    d = _ ? _.offset / 4 : -1, f = l.getVertexElementByUsage(2), m = f ? f.offset / 4 : -1,
                    p = l.getVertexElementByUsage(7), T = p ? p.offset / 4 : -1, E = l.getVertexElementByUsage(4),
                    v = E ? E.offset / 4 : -1, g = l.vertexStride / 4, S = s.getData();
                n ? (n.worldMatrix.invert(P._tempMatrix4x40), o = P._tempMatrix4x41, He.multiply(P._tempMatrix4x40, i.worldMatrix, o)) : o = i.worldMatrix;
                var y = P._tempQuaternion0;
                o.decomposeTransRotScale(P._tempVector30, y, P._tempVector31);
                for (var x = r.lightmapScaleOffset, D = a.vertexCount, I = 0; I < D; I++) {
                    var R = I * g, M = 18 * (I + e);
                    kt.transformVector3ArrayToVector3ArrayCoordinate(S, R + h, o, t, M + 0), -1 !== c && kt.transformVector3ArrayByQuat(S, R + c, y, t, M + 3);
                    var A = 0, C = 0, L = M + 6;
                    if (-1 !== d) {
                        var O = R + d;
                        for (A = 0, C = 4; A < C; A++) t[L + A] = S[O + A]
                    } else for (A = 0, C = 4; A < C; A++) t[L + A] = 1;
                    if (-1 !== m) {
                        var N = R + m;
                        t[M + 10] = S[N], t[M + 11] = S[N + 1]
                    }
                    if (x && (-1 !== T ? kt.transformLightingMapTexcoordArray(S, R + T, x, t, M + 12) : kt.transformLightingMapTexcoordArray(S, R + m, x, t, M + 12)), -1 !== v) {
                        var V = R + v;
                        t[M + 14] = S[V], t[M + 15] = S[V + 1], t[M + 16] = S[V + 2], t[M + 17] = S[V + 3]
                    }
                }
                return D
            }, e.addTest = function (t) {
                var e = t.meshFilter.sharedMesh.vertexCount;
                return !(65535 < this._currentBatchVertexCount + e)
            }, e.add = function (t) {
                var e = t._render._staticBatch;
                e && e.remove(t);
                var n = t.meshFilter.sharedMesh, i = n.vertexCount;
                this._batchElements.push(t);
                var r = t._render;
                r._isPartOfStaticBatch = !0, r._staticBatch = this;
                for (var a = r._renderElements, o = 0, s = a.length; o < s; o++) a[o].staticBatch = this;
                this._currentBatchIndexCount += n._indexBuffer.indexCount, this._currentBatchVertexCount += i
            }, e.remove = function (t) {
                var e = t.meshFilter.sharedMesh, n = this._batchElements.indexOf(t);
                if (-1 !== n) {
                    this._batchElements.splice(n, 1);
                    t._render;
                    for (var i = t._render._renderElements, r = 0, a = i.length; r < a; r++) i[r].staticBatch = null;
                    var o = e.vertexCount;
                    this._currentBatchIndexCount = this._currentBatchIndexCount - e._indexBuffer.indexCount, this._currentBatchVertexCount = this._currentBatchVertexCount - o, t._render._isPartOfStaticBatch = !1
                }
            }, e.finishInit = function () {
                this._vertexBuffer && (this._vertexBuffer.destroy(), this._indexBuffer.destroy(), D._addGPUMemory(-(this._vertexBuffer._byteLength + this._indexBuffer._byteLength)));
                var t = 0, e = 0, n = this.batchOwner, i = this._vertexDeclaration.vertexStride / 4,
                    r = new Float32Array(i * this._currentBatchVertexCount),
                    a = new Uint16Array(this._currentBatchIndexCount);
                this._vertexBuffer = new Ke(this._vertexDeclaration.vertexStride * this._currentBatchVertexCount, 35044), this._vertexBuffer.vertexDeclaration = this._vertexDeclaration, this._indexBuffer = new qe("ushort", this._currentBatchIndexCount, 35044);
                for (var o = 0, s = this._batchElements.length; o < s; o++) {
                    for (var l = this._batchElements[o], h = l.meshFilter.sharedMesh, u = this._getStaticBatchBakedVertexs(r, t, n ? n._transform : null, l._transform, l._render, h), c = h._indexBuffer.getData(), _ = t, d = e + c.length, f = l._render._renderElements, m = 0, p = h.subMeshCount; m < p; m++) {
                        var T = h._subMeshes[m], E = e + T._indexStart, v = f[m];
                        v.staticBatchIndexStart = E, v.staticBatchIndexEnd = E + T._indexCount
                    }
                    a.set(c, e);
                    var g = 0;
                    if (n ? l._transform._isFrontFaceInvert !== n.transform._isFrontFaceInvert : l._transform._isFrontFaceInvert) for (g = e; g < d; g += 3) {
                        a[g] = _ + a[g];
                        var S = a[g + 1], y = a[g + 2];
                        a[g + 1] = _ + y, a[g + 2] = _ + S
                    } else for (g = e; g < d; g += 3) a[g] = _ + a[g], a[g + 1] = _ + a[g + 1], a[g + 2] = _ + a[g + 2];
                    e += c.length, t += u
                }
                this._vertexBuffer.setData(r), this._indexBuffer.setData(a);
                var x = this._vertexBuffer._byteLength + this._indexBuffer._byteLength;
                D._addGPUMemory(x), this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer), this._bufferState.applyIndexBuffer(this._indexBuffer), this._bufferState.unBind()
            }, e._render = function (t) {
                this._bufferState.bind();
                for (var e = t.renderElement.staticBatchElementList, n = 0, i = 0, r = e.length, a = 1; a < r; a++) {
                    if (e[a - 1].staticBatchIndexEnd !== e[a].staticBatchIndexStart) {
                        var o = e[n].staticBatchIndexStart, s = e[i].staticBatchIndexEnd - o;
                        E.instance.drawElements(4, s, 5123, 2 * o), n = ++i, C.trianglesFaces += s / 3
                    } else i++
                }
                o = e[n].staticBatchIndexStart, s = e[i].staticBatchIndexEnd - o, E.instance.drawElements(4, s, 5123, 2 * o), C.renderBatches++, C.savedRenderBatches += r - 1, C.trianglesFaces += s / 3
            }, e.dispose = function () {
                var t = this._vertexBuffer._byteLength + this._indexBuffer._byteLength;
                D._addGPUMemory(-t), this._batchElements = null, this.batchOwner = null, this._vertexDeclaration = null, this._bufferState.destroy(), this._vertexBuffer.destroy(), this._indexBuffer.destroy(), this._vertexBuffer = null, this._indexBuffer = null, this._bufferState = null
            }, P.maxBatchVertexCount = 65535, P._batchIDCounter = 0, _(P, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempVector31", function () {
                return this._tempVector31 = new Lt
            }, "_tempQuaternion0", function () {
                return this._tempQuaternion0 = new at
            }, "_tempMatrix4x40", function () {
                return this._tempMatrix4x40 = new He
            }, "_tempMatrix4x41", function () {
                return this._tempMatrix4x41 = new He
            }]), P
        }(), dn = function (e) {
            function l(t) {
                this._floatCountPerVertices1 = 8, this._floatCountPerVertices2 = 1, this._increaseSegementCount = 128, this._activeIndex = 0, this._endIndex = 0, this._needAddFirstVertex = !1, this._isTempEndVertex = !1, this._subBirthTime = null, this._subDistance = null, this._segementCount = 0, this._vertices1 = null, this._vertices2 = null, this._vertexBuffer1 = null, this._vertexBuffer2 = null, this._owner = null, l.__super.call(this), this._lastFixedVertexPosition = new Lt, this._bufferState = new Je, this._owner = t, this._resizeData(this._increaseSegementCount, this._bufferState)
            }

            d(l, "laya.d3.core.trail.TrailGeometry", e);
            var t = l.prototype;
            return t._resizeData = function (t, e) {
                this._segementCount = this._increaseSegementCount, this._subBirthTime = new Float32Array(t), this._subDistance = new Float32Array(t);
                var n = 2 * t, i = ee.vertexDeclaration1, r = ee.vertexDeclaration2, a = [], o = n * i.vertexStride,
                    s = n * r.vertexStride, l = o + s;
                this._vertices1 = new Float32Array(n * this._floatCountPerVertices1), this._vertexBuffer1 = new Ke(o, 35044, !1), this._vertexBuffer1.vertexDeclaration = i, this._vertices2 = new Float32Array(n * this._floatCountPerVertices2), this._vertexBuffer2 = new Ke(s, 35048, !1), this._vertexBuffer2.vertexDeclaration = r, a.push(this._vertexBuffer1), a.push(this._vertexBuffer2), e.bind(), e.applyVertexBuffers(a), e.unBind(), D._addMemory(l, l)
            }, t._resetData = function () {
                var t = this._endIndex - this._activeIndex;
                t == this._segementCount && (this._vertexBuffer1.destroy(), this._vertexBuffer2.destroy(), this._segementCount += this._increaseSegementCount, this._resizeData(this._segementCount, this._bufferState)), this._vertexBuffer1.setData(this._vertices1, 0, 2 * this._floatCountPerVertices1 * this._activeIndex, 2 * this._floatCountPerVertices1 * t), this._vertexBuffer2.setData(this._vertices2, 0, 2 * this._floatCountPerVertices2 * this._activeIndex, 2 * this._floatCountPerVertices2 * t);
                var e = 4 * this._activeIndex, n = new Float32Array(this._subDistance.buffer, e, t),
                    i = new Float32Array(this._subBirthTime.buffer, e, t);
                this._subDistance.set(n, 0), this._subBirthTime.set(i, 0), this._endIndex = t, this._activeIndex = 0
            }, t._updateTrail = function (t, e, n) {
                Lt.equals(e, n) || (this._endIndex - this._activeIndex == 0 ? this._addTrailByFirstPosition(t, n) : this._addTrailByNextPosition(t, n))
            }, t._addTrailByFirstPosition = function (t, e) {
                this._endIndex === this._segementCount && this._resetData(), this._subDistance[this._endIndex] = 0, this._subBirthTime[this._endIndex] = this._owner._curtime, this._endIndex++, e.cloneTo(this._lastFixedVertexPosition), this._needAddFirstVertex = !0
            }, t._addTrailByNextPosition = function (t, e) {
                var n = l._tempVector30, i = l._tempVector31;
                Lt.subtract(e, this._lastFixedVertexPosition, n);
                var r = l._tempVector32;
                switch (this._owner.alignment) {
                    case 0:
                        t.transform.getForward(r), Lt.cross(n, r, i);
                        break;
                    case 1:
                        this._owner._owner.transform.getForward(r), Lt.cross(n, r, i)
                }
                Lt.normalize(i, i), Lt.scale(i, this._owner.widthMultiplier / 2, i);
                var a = Lt.scalarLength(n), o = 0, s = NaN;
                this._needAddFirstVertex && (this._updateVerticesByPositionData(e, i, this._endIndex - 1), this._needAddFirstVertex = !1), a - this._owner.minVertexDistance >= tt.zeroTolerance ? (this._isTempEndVertex ? (o = this._endIndex - 1, s = a - this._subDistance[o], this._updateVerticesByPosition(e, i, a, o), this._owner._totalLength += s) : (this._endIndex === this._segementCount && this._resetData(), this._updateVerticesByPosition(e, i, a, this._endIndex), this._owner._totalLength += a, this._endIndex++), e.cloneTo(this._lastFixedVertexPosition), this._isTempEndVertex = !1) : (this._isTempEndVertex ? (o = this._endIndex - 1, s = a - this._subDistance[o], this._updateVerticesByPosition(e, i, a, o), this._owner._totalLength += s) : (this._endIndex === this._segementCount && this._resetData(), this._updateVerticesByPosition(e, i, a, this._endIndex), this._owner._totalLength += a, this._endIndex++), this._isTempEndVertex = !0)
            }, t._updateVerticesByPositionData = function (t, e, n) {
                var i = 2 * this._floatCountPerVertices1 * n, r = this._owner._curtime;
                this._vertices1[i] = t.x, this._vertices1[i + 1] = t.y, this._vertices1[i + 2] = t.z, this._vertices1[i + 3] = -e.x, this._vertices1[i + 4] = -e.y, this._vertices1[i + 5] = -e.z, this._vertices1[i + 6] = r, this._vertices1[i + 7] = 1, this._vertices1[i + 8] = t.x, this._vertices1[i + 9] = t.y, this._vertices1[i + 10] = t.z, this._vertices1[i + 11] = e.x, this._vertices1[i + 12] = e.y, this._vertices1[i + 13] = e.z, this._vertices1[i + 14] = r, this._vertices1[i + 15] = 0;
                var a = 2 * this._floatCountPerVertices1;
                this._vertexBuffer1.setData(this._vertices1, i, i, a)
            }, t._updateVerticesByPosition = function (t, e, n, i) {
                this._updateVerticesByPositionData(t, e, i), this._subDistance[i] = n, this._subBirthTime[i] = this._owner._curtime
            }, t._updateVertexBufferUV = function () {
                for (var t = this._endIndex, e = 0, n = this._activeIndex, i = t; n < i; n++) {
                    n !== this._activeIndex && (e += this._subDistance[n]);
                    var r = NaN;
                    r = 0 == this._owner.textureMode ? 1 - e / this._owner._totalLength : 1 - (this._owner._totalLength - e), this._vertices2[2 * n] = r, this._vertices2[2 * n + 1] = r
                }
                var a = 2 * this._activeIndex;
                this._vertexBuffer2.setData(this._vertices2, a, a, 2 * t - a)
            }, t._updateDisappear = function () {
                for (var t = this._endIndex, e = this._activeIndex; e < t && this._owner._curtime - this._subBirthTime[e] >= this._owner.time + tt.zeroTolerance; e++) {
                    var n = e + 1;
                    if (n !== t && (this._owner._totalLength -= this._subDistance[n]), this._isTempEndVertex && n === t - 1) {
                        this._floatCountPerVertices1;
                        var i = this._lastFixedVertexPosition;
                        i.x = this._vertices1[0], i.y = this._vertices1[1], i.z = this._vertices1[2], this._isTempEndVertex = !1
                    }
                    this._activeIndex++
                }
            }, t._getType = function () {
                return l._type
            }, t._prepareRender = function (t) {
                return 1 < this._endIndex - this._activeIndex
            }, t._render = function (t) {
                this._bufferState.bind();
                var e = 2 * this._activeIndex, n = 2 * this._endIndex - e;
                E.instance.drawArrays(5, e, n), C.renderBatches++, C.trianglesFaces += n - 2
            }, t.destroy = function () {
                e.prototype.destroy.call(this);
                var t = this._vertexBuffer1._byteLength + this._vertexBuffer2._byteLength;
                D._addMemory(-t, -t), this._bufferState.destroy(), this._vertexBuffer1.destroy(), this._vertexBuffer2.destroy(), this._bufferState = null, this._vertices1 = null, this._vertexBuffer1 = null, this._vertices2 = null, this._vertexBuffer2 = null, this._subBirthTime = null, this._subDistance = null, this._lastFixedVertexPosition = null
            }, _(l, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempVector31", function () {
                return this._tempVector31 = new Lt
            }, "_tempVector32", function () {
                return this._tempVector32 = new Lt
            }, "_type", function () {
                return this._type = J._typeCounter++
            }]), l
        }(J), fn = function (i) {
            function r() {
                r.__super.call(this), this._childColliderShapes = [], this._type = 5, this._nativeShape = new k._physics3D.btCompoundShape
            }

            d(r, "laya.d3.physics.shape.CompoundColliderShape", i);
            var t = r.prototype;
            return t._clearChildShape = function (t) {
                t._attatched = !1, t._compoundParent = null, t._indexInCompound = -1
            }, t._addReference = function () {
            }, t._removeReference = function () {
            }, t._updateChildTransform = function (t) {
                var e = t.localOffset, n = t.localRotation, i = H._nativeVector30, r = H._nativQuaternion0,
                    a = H._nativeTransform0;
                i.setValue(-e.x, e.y, e.z), r.setValue(-n.x, n.y, n.z, -n.w), a.setOrigin(i), a.setRotation(r), this._nativeShape.updateChildTransform(t._indexInCompound, a, !0)
            }, t.addChildShape = function (t) {
                if (t._attatched) throw"CompoundColliderShape: this shape has attatched to other entity.";
                t._attatched = !0, t._compoundParent = this, t._indexInCompound = this._childColliderShapes.length, this._childColliderShapes.push(t);
                var e = t.localOffset, n = t.localRotation;
                r._nativeOffset.setValue(-e.x, e.y, e.z), r._nativRotation.setValue(-n.x, n.y, n.z, -n.w), r._nativeTransform.setOrigin(r._nativeOffset), r._nativeTransform.setRotation(r._nativRotation);
                var i = this._nativeShape.getLocalScaling();
                this._nativeShape.setLocalScaling(r._nativeVector3One), this._nativeShape.addChildShape(r._nativeTransform, t._nativeShape), this._nativeShape.setLocalScaling(i), this._attatchedCollisionObject && (this._attatchedCollisionObject.colliderShape = this)
            }, t.removeChildShape = function (t) {
                if (t._compoundParent === this) {
                    var e = t._indexInCompound;
                    this._clearChildShape(t);
                    var n = this._childColliderShapes[this._childColliderShapes.length - 1];
                    n._indexInCompound = e, this._childColliderShapes[e] = n, this._childColliderShapes.pop(), this._nativeShape.removeChildShapeByIndex(e)
                }
            }, t.clearChildShape = function () {
                for (var t = 0, e = this._childColliderShapes.length; t < e; t++) this._clearChildShape(this._childColliderShapes[t]), this._nativeShape.removeChildShapeByIndex(0);
                this._childColliderShapes.length = 0
            }, t.getChildShapeCount = function () {
                return this._childColliderShapes.length
            }, t.cloneTo = function (t) {
                var e = t;
                e.clearChildShape();
                for (var n = 0, i = this._childColliderShapes.length; n < i; n++) e.addChildShape(this._childColliderShapes[n].clone())
            }, t.clone = function () {
                var t = new r;
                return this.cloneTo(t), t
            }, t.destroy = function () {
                i.prototype.destroy.call(this);
                for (var t = 0, e = this._childColliderShapes.length; t < e; t++) {
                    var n = this._childColliderShapes[t];
                    0 === n._referenceCount && n.destroy()
                }
            }, _(r, ["_nativeVector3One", function () {
                return this._nativeVector3One = new k._physics3D.btVector3(1, 1, 1)
            }, "_nativeTransform", function () {
                return this._nativeTransform = new k._physics3D.btTransform
            }, "_nativeOffset", function () {
                return this._nativeOffset = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativRotation", function () {
                return this._nativRotation = new k._physics3D.btQuaternion(0, 0, 0, 1)
            }]), r
        }(H), mn = function (t) {
            function i(t, e) {
                this._floatCountPerVertices = 7, this._owner = null, this._vertexBuffer = null, this._vertices = null, this._maxLineCount = 0, this._lineCount = 0, i.__super.call(this), this._minUpdate = Number.MAX_VALUE, this._maxUpdate = Number.MIN_VALUE, this._bufferState = new Je;
                var n = 2 * e;
                this._owner = t, this._maxLineCount = e, this._vertices = new Float32Array(n * this._floatCountPerVertices), this._vertexBuffer = new Ke(Wt.vertexDeclaration.vertexStride * n, 35044, !1), this._vertexBuffer.vertexDeclaration = Wt.vertexDeclaration, this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer), this._bufferState.unBind()
            }

            d(i, "laya.d3.core.pixelLine.PixelLineFilter", t);
            var e = i.prototype;
            return e._getType = function () {
                return i._type
            }, e._resizeLineData = function (t) {
                var e = 2 * t, n = this._vertices;
                this._vertexBuffer.destroy(), this._maxLineCount = t;
                var i = e * this._floatCountPerVertices;
                this._vertices = new Float32Array(i), this._vertexBuffer = new Ke(Wt.vertexDeclaration.vertexStride * e, 35044, !1), this._vertexBuffer.vertexDeclaration = Wt.vertexDeclaration, i < n.length ? (this._vertices.set(new Float32Array(n.buffer, 0, i)), this._vertexBuffer.setData(this._vertices, 0, 0, i)) : (this._vertices.set(n), this._vertexBuffer.setData(this._vertices, 0, 0, n.length)), this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer), this._bufferState.unBind()
            }, e._updateLineVertices = function (t, e, n, i, r) {
                e && (this._vertices[t + 0] = e.x, this._vertices[t + 1] = e.y, this._vertices[t + 2] = e.z), i && (this._vertices[t + 3] = i.r, this._vertices[t + 4] = i.g, this._vertices[t + 5] = i.b, this._vertices[t + 6] = i.a), n && (this._vertices[t + 7] = n.x, this._vertices[t + 8] = n.y, this._vertices[t + 9] = n.z), r && (this._vertices[t + 10] = r.r, this._vertices[t + 11] = r.g, this._vertices[t + 12] = r.b, this._vertices[t + 13] = r.a), this._minUpdate = Math.min(this._minUpdate, t), this._maxUpdate = Math.max(this._maxUpdate, t + 2 * this._floatCountPerVertices)
            }, e._removeLineData = function (t) {
                var e = 2 * this._floatCountPerVertices, n = t + 1, i = t * e,
                    r = new Float32Array(this._vertices.buffer, n * e * 4, (this._lineCount - n) * e);
                this._vertices.set(r, i), this._minUpdate = i, this._maxUpdate = i + 2 * this._floatCountPerVertices, this._lineCount--
            }, e._updateLineData = function (t, e, n, i, r) {
                var a = t * (2 * this._floatCountPerVertices);
                this._updateLineVertices(a, e, n, i, r)
            }, e._updateLineDatas = function (t, e) {
                for (var n = 2 * this._floatCountPerVertices, i = e.length, r = 0; r < i; r++) {
                    var a = e[r];
                    this._updateLineVertices((t + r) * n, a.startPosition, a.endPosition, a.startColor, a.endColor)
                }
            }, e._getLineData = function (t, e) {
                var n = e.startPosition, i = e.startColor, r = e.endPosition, a = e.endColor, o = this._vertices,
                    s = t * this._floatCountPerVertices * 2;
                n.x = o[s + 0], n.y = o[s + 1], n.z = o[s + 2], i.r = o[s + 3], i.g = o[s + 4], i.b = o[s + 5], i.a = o[s + 6], r.x = o[s + 7], r.y = o[s + 8], r.z = o[s + 9], a.r = o[s + 10], a.g = o[s + 11], a.b = o[s + 12], a.a = o[s + 13]
            }, e._prepareRender = function (t) {
                return !0
            }, e._render = function (t) {
                this._minUpdate !== Number.MAX_VALUE && this._maxUpdate !== Number.MIN_VALUE && (this._vertexBuffer.setData(this._vertices, this._minUpdate, this._minUpdate, this._maxUpdate - this._minUpdate), this._minUpdate = Number.MAX_VALUE, this._maxUpdate = Number.MIN_VALUE), 0 < this._lineCount && (this._bufferState.bind(), E.instance.drawArrays(1, 0, 2 * this._lineCount), C.renderBatches++)
            }, e.destroy = function () {
                this._destroyed || (t.prototype.destroy.call(this), this._bufferState.destroy(), this._vertexBuffer.destroy(), this._bufferState = null, this._vertexBuffer = null, this._vertices = null)
            }, _(i, ["_type", function () {
                return this._type = J._typeCounter++
            }]), i
        }(J), pn = function (t) {
            function i(t, e, n) {
                switch (this._radius = 1, this._height = .5, i.__super.call(this), void 0 === t && (t = .5), void 0 === e && (e = 1), void 0 === n && (n = 1), this._radius = t, this._height = e, this._orientation = n, this._type = 2, n) {
                    case 0:
                        i._nativeSize.setValue(e / 2, t, t), this._nativeShape = new k._physics3D.btCylinderShapeX(i._nativeSize);
                        break;
                    case 1:
                        i._nativeSize.setValue(t, e / 2, t), this._nativeShape = new k._physics3D.btCylinderShape(i._nativeSize);
                        break;
                    case 2:
                        i._nativeSize.setValue(t, t, e / 2), this._nativeShape = new k._physics3D.btCylinderShapeZ(i._nativeSize);
                        break;
                    default:
                        throw"CapsuleColliderShape:unknown orientation."
                }
            }

            d(i, "laya.d3.physics.shape.CylinderColliderShape", H);
            var e = i.prototype;
            return e.clone = function () {
                var t = new i(this._radius, this._height, this._orientation);
                return this.cloneTo(t), t
            }, u(0, e, "radius", function () {
                return this._radius
            }), u(0, e, "height", function () {
                return this._height
            }), u(0, e, "orientation", function () {
                return this._orientation
            }), _(i, ["_nativeSize", function () {
                return this._nativeSize = new k._physics3D.btVector3(0, 0, 0)
            }]), i
        }(), Tn = function (n) {
            function t() {
                t.__super.call(this)
            }

            return d(t, "laya.d3.core.FloatKeyframe", n), t.prototype.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                e.inTangent = this.inTangent, e.outTangent = this.outTangent, e.value = this.value
            }, t
        }(ht), En = function (t) {
            function e() {
                this.maxInstanceCount = 1024, e.__super.call(this), this.instanceWorldMatrixData = new Float32Array(16 * this.maxInstanceCount), this.instanceMVPMatrixData = new Float32Array(16 * this.maxInstanceCount), this.instanceWorldMatrixBuffer = new Ke(4 * this.instanceWorldMatrixData.length, 35048), this.instanceMVPMatrixBuffer = new Ke(4 * this.instanceMVPMatrixData.length, 35048), this.instanceWorldMatrixBuffer.vertexDeclaration = pt.instanceWorldMatrixDeclaration, this.instanceMVPMatrixBuffer.vertexDeclaration = pt.instanceMVPMatrixDeclaration
            }

            return d(e, "laya.d3.graphics.SubMeshInstanceBatch", J), e.prototype._render = function (t) {
                var e = t.renderElement, n = e.instanceSubMesh, i = e.instanceBatchElementList.length,
                    r = n._indexCount;
                n._mesh._instanceBufferState.bind(), V._angleInstancedArrays.drawElementsInstancedANGLE(4, r, 5123, 2 * n._indexStart, i), C.renderBatches++, C.savedRenderBatches += i - 1, C.trianglesFaces += r * i / 3
            }, _(e, ["instance", function () {
                return this.instance = new e
            }]), e
        }(), vn = function (t) {
            function e() {
                e.__super.call(this)
            }

            d(e, "laya.d3.core.scene.OctreeMotionList", q);
            var n = e.prototype;
            return n.add = function (t) {
                if (-1 !== t._getIndexInMotionList()) throw"OctreeMotionList:element has  in  PhysicsUpdateList.";
                this._add(t), t._setIndexInMotionList(this.length++)
            }, n.remove = function (t) {
                var e = t._getIndexInMotionList();
                if (this.length--, e !== this.length) {
                    var n = this.elements[this.length];
                    (this.elements[e] = n)._inPhysicUpdateListIndex = e
                }
                t._setIndexInMotionList(-1)
            }, e
        }(), gn = function (t) {
            function n() {
                this._renderTexture = null, n.__super.call(this)
            }

            d(n, "laya.d3.core.render.command.SetRenderTargetCMD", j);
            var e = n.prototype;
            return e.run = function () {
                this._renderTexture._start()
            }, e.recover = function () {
                n._pool.push(this), this._renderTexture = null
            }, n.create = function (t) {
                var e;
                return (e = 0 < n._pool.length ? n._pool.pop() : new n)._renderTexture = t, e
            }, n._pool = [], n
        }(), Sn = function (t) {
            function r() {
                this._opaqueBatchMarks = [], r.__super.call(this), this._updateCountMark = 0
            }

            d(r, "laya.d3.graphics.MeshRenderStaticBatchManager", t);
            var e = r.prototype;
            return e._compare = function (t, e) {
                var n = t._render, i = e._render, r = t.meshFilter.sharedMesh, a = e.meshFilter.sharedMesh,
                    o = n.lightmapIndex - i.lightmapIndex;
                if (0 !== o) return o;
                var s = (n.receiveShadow ? 1 : 0) - (i.receiveShadow ? 1 : 0);
                if (0 !== s) return s;
                var l = n.sharedMaterial.id - i.sharedMaterial.id;
                if (0 !== l) return l;
                var h = r._vertexBuffers[0].vertexDeclaration.id - a._vertexBuffers[0].vertexDeclaration.id;
                return 0 === h ? a._indexBuffer.indexCount - r._indexBuffer.indexCount : h
            }, e._getBatchRenderElementFromPool = function () {
                var t = this._batchRenderElementPool[this._batchRenderElementPoolIndex++];
                return t || (t = new Pn, (this._batchRenderElementPool[this._batchRenderElementPoolIndex - 1] = t).staticBatchElementList = []), t
            }, e._getStaticBatch = function (t, e) {
                var n = t ? t.id : 0, i = this._staticBatches[n];
                return i || (i = this._staticBatches[n] = []), i[e] || (i[e] = new _n(t, e, r._verDec))
            }, e._initStaticBatchs = function (t) {
                this._quickSort(this._initBatchSprites, 0, this._initBatchSprites.length - 1);
                for (var e, n = !1, i = 0, r = 0, a = this._initBatchSprites.length; r < a; r++) {
                    var o = this._initBatchSprites[r];
                    if (n) e.addTest(o) ? e.add(o) : (n = !1, i++); else r !== a - 1 && ((e = this._getStaticBatch(t, i)).add(o), n = !0)
                }
                for (var s in this._staticBatches) {
                    var l = this._staticBatches[s];
                    for (r = 0, a = l.length; r < a; r++) l[r].finishInit()
                }
                this._initBatchSprites.length = 0
            }, e._destroyRenderSprite = function (t) {
                var e = t._render._staticBatch;
                if (e.remove(t), 0 === e._batchElements.length) {
                    var n = e.batchOwner, i = n ? n.id : 0, r = this._staticBatches[i];
                    r[e.number] = null, e.dispose();
                    for (var a = !0, o = 0; o < r.length; o++) r[o] && (a = !1);
                    a && delete this._staticBatches[i]
                }
            }, e._clear = function () {
                t.prototype._clear.call(this), this._updateCountMark++
            }, e._garbageCollection = function () {
                for (var t in this._staticBatches) for (var e = this._staticBatches[t], n = 0, i = e.length; n < i; n++) {
                    var r = e[n];
                    0 === r._batchElements.length && (r.dispose(), e.splice(n, 1), n--, 0 === --i && delete this._staticBatches[t])
                }
            }, e.getBatchOpaquaMark = function (t, e, n, i) {
                var r = this._opaqueBatchMarks[t] || (this._opaqueBatchMarks[t] = []), a = r[e] || (r[e] = []),
                    o = a[n] || (a[n] = []);
                return o[i] || (o[i] = new pe)
            }, _(r, ["_verDec", function () {
                return this._verDec = pt.getVertexDeclaration("POSITION,NORMAL,COLOR,UV,UV1,TANGENT")
            }, "instance", function () {
                return this.instance = new r
            }]), r
        }(Z), yn = function (t) {
            function n() {
                this._vertices = null, this._indices = null, this._positionOffset = 0, this._normalOffset = 0, this._colorOffset = 0, this._uv0Offset = 0, this._uv1Offset = 0, this._sTangentOffset = 0, this._vertexBuffer = null, this._indexBuffer = null, n.__super.call(this), this._bufferState = new Je;
                var t = 32e3 * pt.getVertexDeclaration("POSITION,NORMAL,COLOR,UV,UV1,TANGENT").vertexStride;
                this._vertices = new Float32Array(t / 4), this._vertexBuffer = new Ke(t, 35048), this._indices = new Int16Array(32e3), this._indexBuffer = new qe("ushort", this._indices.length, 35048);
                var e = this._vertexBuffer._byteLength + this._indexBuffer._byteLength;
                D._addMemory(e, e)
            }

            d(n, "laya.d3.graphics.SubMeshDynamicBatch", J);
            var e = n.prototype;
            return e._getBatchVertices = function (t, e, n, i, r, a) {
                var o = t.vertexStride / 4, s = a._vertexBuffer.getData(),
                    l = (r.render.lightmapScaleOffset, r._dynamicMultiSubMesh), h = r._dynamicVertexCount;
                r._computeWorldPositionsAndNormals(this._positionOffset, this._normalOffset, l, h);
                for (var u = r._dynamicWorldPositions, c = r._dynamicWorldNormals, _ = a._indices, d = 0; d < h; d++) {
                    var f = (l ? _[d] : d) * o, m = (d + n) * o, p = 3 * d, T = m + this._positionOffset;
                    e[T] = u[p], e[T + 1] = u[p + 1], e[T + 2] = u[p + 2], -1 !== this._normalOffset && (e[T = m + this._normalOffset] = c[p], e[T + 1] = c[p + 1], e[T + 2] = c[p + 2]), -1 !== this._colorOffset && (T = m + this._colorOffset, p = f + this._colorOffset, e[T] = s[p], e[T + 1] = s[p + 1], e[T + 2] = s[p + 2], e[T + 3] = s[p + 3]), -1 !== this._uv0Offset && (T = m + this._uv0Offset, p = f + this._uv0Offset, e[T] = s[p], e[T + 1] = s[p + 1]), -1 !== this._sTangentOffset && (T = m + this._sTangentOffset, p = f + this._sTangentOffset, e[T] = s[p], e[T + 1] = s[p + 1], e[T + 2] = s[p + 2], e[T + 3] = s[p + 3], T = m + this._sTangentOffset, p = f + this._sTangentOffset, e[T] = s[p], e[T + 1] = s[p + 1], e[T + 2] = s[p + 2], e[T + 3] = s[p + 3])
                }
            }, e._getBatchIndices = function (t, e, n, i, r, a) {
                var o = r._indices, s = 0, l = 0, h = 0, u = i._isFrontFaceInvert;
                if (a) if (u) for (s = 0, l = o.length; s < l; s += 3) {
                    var c = n + s;
                    t[h = e + s] = c, t[h + 1] = c + 2, t[h + 2] = c + 1
                } else for (s = l, l = o.length; s < l; s += 3) c = n + s, t[h = e + s] = c, t[h + 1] = c + 1, t[h + 2] = c + 2; else if (u) for (s = 0, l = o.length; s < l; s += 3) t[h = e + s] = n + o[s], t[h + 1] = n + o[s + 2], t[h + 2] = n + o[s + 1]; else for (s = l, l = o.length; s < l; s += 3) t[h = e + s] = n + o[s], t[h + 1] = n + o[s + 1], t[h + 2] = n + o[s + 2]
            }, e._flush = function (t, e) {
                this._vertexBuffer.setData(this._vertices, 0, 0, t * (this._vertexBuffer.vertexDeclaration.vertexStride / 4)), this._indexBuffer.setData(this._indices, 0, 0, e), E.instance.drawElements(4, e, 5123, 0)
            }, e._prepareRender = function (t) {
                var e = t.renderElement.vertexBatchVertexDeclaration;
                this._bufferState = ln.instance._getBufferState(e), this._positionOffset = e.getVertexElementByUsage(0).offset / 4;
                var n = e.getVertexElementByUsage(3);
                this._normalOffset = n ? n.offset / 4 : -1;
                var i = e.getVertexElementByUsage(1);
                this._colorOffset = i ? i.offset / 4 : -1;
                var r = e.getVertexElementByUsage(2);
                this._uv0Offset = r ? r.offset / 4 : -1;
                var a = e.getVertexElementByUsage(7);
                this._uv1Offset = a ? a.offset / 4 : -1;
                var o = e.getVertexElementByUsage(4);
                return this._sTangentOffset = o ? o.offset / 4 : -1, !0
            }, e._render = function (t) {
                this._bufferState.bind();
                for (var e = t.renderElement, n = e.vertexBatchVertexDeclaration, i = e.vertexBatchElementList, r = 0, a = 0, o = (n.vertexStride, 0), s = i.length, l = 0; l < s; l++) {
                    var h = i[l], u = h._geometry, c = u._indexCount;
                    32e3 < a + c && (this._flush(r, a), o++, C.trianglesFaces += a / 3, r = a = 0);
                    var _ = h._transform;
                    this._getBatchVertices(n, this._vertices, r, _, h, u), this._getBatchIndices(this._indices, a, r, _, u, h._dynamicMultiSubMesh), r += h._dynamicVertexCount, a += c
                }
                this._flush(r, a), o++, C.renderBatches += o, C.savedRenderBatches += s - o, C.trianglesFaces += a / 3
            }, n.maxAllowVertexCount = 10, n.maxAllowAttribueCount = 900, n.maxIndicesCount = 32e3, n.instance = null, n
        }(), xn = function (t) {
            function r() {
                r.__super.call(this);
                var t = new Float32Array([-.5, .5, -.5, .5, .5, -.5, .5, .5, .5, -.5, .5, .5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, .5, -.5, -.5, .5]),
                    e = new Uint8Array([0, 1, 2, 2, 3, 0, 4, 7, 6, 6, 5, 4, 0, 3, 7, 7, 4, 0, 1, 5, 6, 6, 2, 1, 3, 2, 6, 6, 7, 3, 0, 4, 5, 5, 1, 0]),
                    n = pt.getVertexDeclaration("POSITION");
                this._vertexBuffer = new Ke(8 * n.vertexStride, 35044, !1), this._vertexBuffer.vertexDeclaration = n, this._indexBuffer = new qe("ubyte", 36, 35044, !1), this._vertexBuffer.setData(t), this._indexBuffer.setData(e);
                var i = new Je;
                i.bind(), i.applyVertexBuffer(this._vertexBuffer), i.applyIndexBuffer(this._indexBuffer), i.unBind(), this._bufferState = i
            }

            return d(r, "laya.d3.resource.models.SkyBox", St), r.prototype._render = function (t) {
                E.instance.drawElements(4, 36, 5121, 0), C.trianglesFaces += 12, C.renderBatches++
            }, r.__init__ = function () {
                r.instance = new r
            }, r.instance = null, r
        }(), Dn = function (n) {
            function e() {
                this._mesh = null, this._convex = !1, e.__super.call(this)
            }

            d(e, "laya.d3.physics.shape.MeshColliderShape", n);
            var t = e.prototype;
            return t._setScale = function (t) {
                this._compoundParent ? this.updateLocalTransformations() : (H._nativeScale.setValue(t.x, t.y, t.z), this._nativeShape.setLocalScaling(H._nativeScale), this._nativeShape.updateBound())
            }, t.cloneTo = function (t) {
                var e = t;
                e.convex = this._convex, e.mesh = this._mesh, n.prototype.cloneTo.call(this, t)
            }, t.clone = function () {
                var t = new e;
                return this.cloneTo(t), t
            }, t.destroy = function () {
                this._nativeShape && (k._physics3D.destroy(this._nativeShape), this._nativeShape = null)
            }, u(0, t, "mesh", function () {
                return this._mesh
            }, function (t) {
                if (this._mesh !== t) {
                    var e = k._physics3D;
                    this._mesh && e.destroy(this._nativeShape), t && (this._nativeShape = new e.btGImpactMeshShape(t._getPhysicMesh()), this._nativeShape.updateBound()), this._mesh = t
                }
            }), u(0, t, "convex", function () {
                return this._convex
            }, function (t) {
                this._convex = t
            }), e
        }(H), In = function (n) {
            function t() {
                this.radius = NaN, this.emitFromShell = !1, t.__super.call(this), this.radius = 1, this.emitFromShell = !1, this.randomDirection = !1
            }

            d(t, "laya.d3.core.particleShuriKen.module.shape.HemisphereShape", n);
            var e = t.prototype;
            return e._getShapeBoundBox = function (t) {
                var e = t.min;
                e.x = e.y = e.z = -this.radius;
                var n = t.max;
                n.x = n.y = this.radius, n.z = 0
            }, e._getSpeedBoundBox = function (t) {
                var e = t.min;
                e.x = e.y = -1, e.z = 0;
                var n = t.max;
                n.x = n.y = n.z = 1
            }, e.generatePositionAndDirection = function (t, e, n, i) {
                n ? (n.seed = i[16], this.emitFromShell ? Le._randomPointUnitSphere(t, n) : Le._randomPointInsideUnitSphere(t, n), i[16] = n.seed) : this.emitFromShell ? Le._randomPointUnitSphere(t) : Le._randomPointInsideUnitSphere(t), Lt.scale(t, this.radius, t);
                var r = t.z;
                r < 0 && (t.z = -1 * r), this.randomDirection ? n ? (n.seed = i[17], Le._randomPointUnitSphere(e, n), i[17] = n.seed) : Le._randomPointUnitSphere(e) : t.cloneTo(e)
            }, e.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                e.radius = this.radius, e.emitFromShell = this.emitFromShell, e.randomDirection = this.randomDirection
            }, t
        }(G), Rn = function (t) {
            function h(t, e, n, i, r, a, o, s) {
                this._owner = null, this._gridSize = NaN, this.memorySize = 0, this._numberVertices = 0, this._maxNumberIndices = 0, this._currentNumberIndices = 0, this._numberTriangle = 0, this._vertexBuffer = null, this._indexBuffer = null, this._indexArrayBuffer = null, this._boundingBoxCorners = null, this._leafs = null, this._leafNum = 0, this._terrainHeightData = null, this._terrainHeightDataWidth = 0, this._terrainHeightDataHeight = 0, this._chunkOffsetX = 0, this._chunkOffsetZ = 0, this._cameraCoordinateInverse = !1, this._cameraPos = null, this._currentLOD = 0, this._perspectiveFactor = NaN, this._LODTolerance = 0, this._boundingSphere = null, this._boundingBox = null, h.__super.call(this), this._bufferState = new Je, this._owner = t, this._cameraPos = new Lt, this._chunkOffsetX = e, this._chunkOffsetZ = n, this._gridSize = i, this._terrainHeightData = r, this._terrainHeightDataWidth = a, this._terrainHeightDataHeight = o, this._leafNum = st.CHUNK_GRID_NUM / st.LEAF_GRID_NUM * (st.CHUNK_GRID_NUM / st.LEAF_GRID_NUM), this._leafs = w(this._leafNum), this._cameraCoordinateInverse = s;
                for (var l = 0; l < this._leafNum; l++) this._leafs[l] = new st;
                this.recreateResource()
            }

            d(h, "laya.d3.terrain.TerrainFilter", J);
            var e = h.prototype;
            return e.recreateResource = function () {
                this._currentNumberIndices = 0, this._numberTriangle = 0;
                var t = st.LEAF_VERTEXT_COUNT, e = st.LEAF_MAX_INDEX_COUNT;
                this._numberVertices = t * this._leafNum, this._maxNumberIndices = e * this._leafNum, this._indexArrayBuffer = new Uint16Array(this._maxNumberIndices);
                var n = qt.vertexDeclaration, i = n.vertexStride / 4, r = new Float32Array(this._numberVertices * i),
                    a = st.CHUNK_GRID_NUM / st.LEAF_GRID_NUM, o = 0, s = 0, l = 0;
                for (o = 0; o < this._leafNum; o++) s = o % a, l = Math.floor(o / a), this._leafs[o].calcVertextBuffer(this._chunkOffsetX, this._chunkOffsetZ, s * st.LEAF_GRID_NUM, l * st.LEAF_GRID_NUM, this._gridSize, r, o * st.LEAF_PLANE_VERTEXT_COUNT, i, this._terrainHeightData, this._terrainHeightDataWidth, this._terrainHeightDataHeight, this._cameraCoordinateInverse);
                for (o = 0; o < this._leafNum; o++) s = o % a, l = Math.floor(o / a), this._leafs[o].calcSkirtVertextBuffer(this._chunkOffsetX, this._chunkOffsetZ, s * st.LEAF_GRID_NUM, l * st.LEAF_GRID_NUM, this._gridSize, r, this._leafNum * st.LEAF_PLANE_VERTEXT_COUNT + o * st.LEAF_SKIRT_VERTEXT_COUNT, i, this._terrainHeightData, this._terrainHeightDataWidth, this._terrainHeightDataHeight);
                this.assembleIndexInit(), this._vertexBuffer = new Ke(n.vertexStride * this._numberVertices, 35044, !1), this._vertexBuffer.vertexDeclaration = n, this._indexBuffer = new qe("ushort", this._maxNumberIndices, 35044, !1), this._vertexBuffer.setData(r), this._indexBuffer.setData(this._indexArrayBuffer), this.memorySize = 2 * (this._vertexBuffer._byteLength + this._indexBuffer._byteLength), this.calcOriginalBoudingBoxAndSphere(), this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer), this._bufferState.applyIndexBuffer(this._indexBuffer), this._bufferState.unBind()
            }, e.setLODLevel = function (t) {
                if (4 != t.length) return !0;
                var e = (t[0] + 1 << 24) + (t[1] + 1 << 16) + (t[2] + 1 << 8) + (t[3] + 1);
                return this._currentLOD != e && (this._currentLOD = e, !0)
            }, e.assembleIndexInit = function () {
                this._currentNumberIndices = 0;
                for (var t = this._numberTriangle = 0, e = 0; e < this._leafNum; e++) {
                    var n = st.getPlaneLODIndex(e, 0);
                    this._indexArrayBuffer.set(n, t), t += n.length;
                    var i = st.getSkirtLODIndex(e, 0);
                    this._indexArrayBuffer.set(i, t), t += i.length, this._currentNumberIndices += n.length + i.length
                }
                this._numberTriangle = this._currentNumberIndices / 3
            }, e.isNeedAssemble = function (t, e) {
                var n = Math.min(t.viewport.width, t.viewport.height) / (2 * Math.tan(Math.PI * t.fieldOfView / 180));
                return this._perspectiveFactor != n ? (this._perspectiveFactor = n, 1) : this._LODTolerance != ei.LOD_TOLERANCE_VALUE ? (this._LODTolerance = ei.LOD_TOLERANCE_VALUE, 1) : 0 == Lt.equals(e, this._cameraPos) ? (this._cameraPos.x = e.x, this._cameraPos.y = e.y, this._cameraPos.z = e.z, 2) : 0
            }, e.assembleIndex = function (t, e) {
                var n = this.isNeedAssemble(t, e);
                if (0 < n) {
                    for (var i = 0; i < this._leafNum; i++) h._TEMP_ARRAY_BUFFER[i] = this._leafs[i].determineLod(e, this._perspectiveFactor, ei.LOD_TOLERANCE_VALUE, 1 == n);
                    if (this.setLODLevel(h._TEMP_ARRAY_BUFFER)) {
                        this._currentNumberIndices = 0;
                        var r = this._numberTriangle = 0;
                        for (i = 0; i < this._leafNum; i++) {
                            var a = h._TEMP_ARRAY_BUFFER[i], o = st.getPlaneLODIndex(i, a);
                            this._indexArrayBuffer.set(o, r), r += o.length;
                            var s = st.getSkirtLODIndex(i, a);
                            this._indexArrayBuffer.set(s, r), r += s.length, this._currentNumberIndices += o.length + s.length
                        }
                        return this._numberTriangle = this._currentNumberIndices / 3, !0
                    }
                }
                return !1
            }, e.calcOriginalBoudingBoxAndSphere = function () {
                for (var t = new Ot(2147483647, -2147483647), e = 0; e < this._leafNum; e++) t.x = this._leafs[e]._sizeOfY.x < t.x ? this._leafs[e]._sizeOfY.x : t.x, t.y = this._leafs[e]._sizeOfY.y > t.y ? this._leafs[e]._sizeOfY.y : t.y;
                var n = new Lt(this._chunkOffsetX * st.CHUNK_GRID_NUM * this._gridSize, t.x, this._chunkOffsetZ * st.CHUNK_GRID_NUM * this._gridSize),
                    i = new Lt((this._chunkOffsetX + 1) * st.CHUNK_GRID_NUM * this._gridSize, t.y, (this._chunkOffsetZ + 1) * st.CHUNK_GRID_NUM * this._gridSize);
                st.__ADAPT_MATRIX__ && (Lt.transformV3ToV3(n, st.__ADAPT_MATRIX__, n), Lt.transformV3ToV3(i, st.__ADAPT_MATRIX__, i)), this._boundingBox = new ze(n, i);
                var r = new Lt;
                Lt.subtract(i, n, r), Lt.scale(r, .5, r);
                var a = new Lt;
                Lt.add(n, r, a), this._boundingSphere = new Et(a, Lt.scalarLength(r)), this._boundingBoxCorners = w(8, null), this._boundingBox.getCorners(this._boundingBoxCorners)
            }, e.calcLeafBoudingBox = function (t) {
                for (var e = 0; e < this._leafNum; e++) this._leafs[e].calcLeafBoudingBox(t)
            }, e.calcLeafBoudingSphere = function (t, e) {
                for (var n = 0; n < this._leafNum; n++) this._leafs[n].calcLeafBoudingSphere(t, e)
            }, e._getVertexBuffer = function (t) {
                return void 0 === t && (t = 0), 0 == t ? this._vertexBuffer : null
            }, e._getIndexBuffer = function () {
                return this._indexBuffer
            }, e._getType = function () {
                return h._type
            }, e._prepareRender = function (t) {
                return !0
            }, e._render = function (t) {
                this._bufferState.bind(), E.instance.drawElements(ei.RENDER_LINE_MODEL ? 1 : 4, this._currentNumberIndices, 5123, 0), C.trianglesFaces += this._numberTriangle, C.renderBatches++
            }, e.destroy = function () {
                this._owner = null, this._bufferState.destroy(), this._vertexBuffer && this._vertexBuffer.destroy(), this._indexBuffer && this._indexBuffer.destroy()
            }, _(h, ["_TEMP_ARRAY_BUFFER", function () {
                return this._TEMP_ARRAY_BUFFER = new Uint32Array(st.CHUNK_GRID_NUM / st.LEAF_GRID_NUM * st.CHUNK_GRID_NUM / st.LEAF_GRID_NUM)
            }, "_type", function () {
                return this._type = J._typeCounter++
            }]), h
        }(), Mn = (function (t) {
            function P() {
                this._shader = null, this._pyramid = null, this._intensity = 0, this._threshold = 1, this._softKnee = .5, this._diffusion = 7, this._anamorphicRatio = 0, this._dirtIntensity = 0, this.clamp = 65472, this.fastMode = !1, this.dirtTexture = null, P.__super.call(this), this._shaderData = new ot, this._linearColor = new ft, this._shaderThreshold = new Ct, this._shaderParams = new Ct, this._shaderSetting = new Ct, this._dirtTileOffset = new Ct, this.color = new ft(1, 1, 1, 1), this._shader = Pt.find("PostProcessBloom"), this._pyramid = new Array(32)
            }

            d(P, "laya.d3.core.render.BloomEffect", bt);
            var e = P.prototype;
            e.render = function (t) {
                var e = t.command, n = t.camera.viewport;
                this._shaderData.setTexture(P.SHADERVALUE_AUTOEXPOSURETEX, F.whiteTexture);
                var i, r = this._anamorphicRatio, a = r < 0 ? -r : 0, o = 0 < r ? r : 0,
                    s = Math.floor(n.width / (2 - a)), l = Math.floor(n.height / (2 - o)), h = Math.max(s, l);
                i = Math.log2(h) + this._diffusion - 10;
                var u = Math.floor(i), c = Math.min(Math.max(u, 1), 16), _ = .5 + i - u;
                this._shaderData.setNumber(P.SHADERVALUE_SAMPLESCALE, _);
                var d = kt.gammaToLinearSpace(this.threshold), f = d * this._softKnee + 1e-5;
                this._shaderThreshold.setValue(d, d - f, 2 * f, .25 / f), this._shaderData.setVector(P.SHADERVALUE_THRESHOLD, this._shaderThreshold);
                var m = kt.gammaToLinearSpace(this.clamp);
                this._shaderParams.setValue(m, 0, 0, 0), this._shaderData.setVector(P.SHADERVALUE_PARAMS, this._shaderParams);
                for (var p = this.fastMode ? 1 : 0, T = t.source, E = 0; E < c; E++) {
                    var v = 2 * E, g = v + 1, S = 0 == E ? 0 + p : 2 + p, y = pi.getTemporary(s, l, 0, 3, 1),
                        x = pi.getTemporary(s, l, 0, 3, 1);
                    this._pyramid[v] = y, this._pyramid[g] = x, e.blit(T, y, this._shader, this._shaderData, S), T = y, s = Math.max(s / 2, 1), l = Math.max(l / 2, 1)
                }
                var D = this._pyramid[2 * c - 3];
                for (E = c - 2; 0 <= E; E--) g = (v = 2 * E) + 1, y = this._pyramid[v], x = this._pyramid[g], e.setShaderDataTexture(this._shaderData, P.SHADERVALUE_BLOOMTEX, y), e.blit(D, x, this._shader, this._shaderData, 4 + p), D = x;
                var I = this._linearColor;
                this.color.toLinear(I);
                var R = Math.pow(2, this._intensity / 10) - 1, M = this._shaderSetting;
                this._shaderSetting.setValue(_, R, this._dirtIntensity, c);
                var A = A || F.blackTexture, C = A.width / A.height, L = n.width / n.height, O = this._dirtTileOffset;
                O.setValue(1, 1, 0, 0), L < C ? O.setValue(L / C, 1, .5 * (1 - O.x), 0) : C < L && O.setValue(1, C / L, 0, .5 * (1 - O.y));
                var N = t.compositeShaderData, V = t.compositeDefineData;
                for (this.fastMode ? V.add(Re.SHADERDEFINE_BLOOM_LOW) : V.add(Re.SHADERDEFINE_BLOOM), N.setVector(Re.SHADERVALUE_BLOOM_DIRTTILEOFFSET, O), N.setVector(Re.SHADERVALUE_BLOOM_SETTINGS, M), N.setVector(Re.SHADERVALUE_BLOOM_COLOR, new Ct(I.r, I.g, I.b, I.a)), N.setTexture(Re.SHADERVALUE_BLOOM_DIRTTEX, A), N.setTexture(Re.SHADERVALUE_BLOOMTEX, D), E = 0; E < c; E++) g = (v = 2 * E) + 1, this._pyramid[v] != D && pi.setReleaseTemporary(this._pyramid[v]), this._pyramid[g] != D && pi.setReleaseTemporary(this._pyramid[g]);
                t.tempRenderTextures.push(D)
            }, u(0, e, "softKnee", function () {
                return this._softKnee
            }, function (t) {
                this._softKnee = Math.min(Math.max(t, 0), 1)
            }), u(0, e, "intensity", function () {
                return this._intensity
            }, function (t) {
                this._intensity = Math.max(t, 0)
            }), u(0, e, "threshold", function () {
                return this._threshold
            }, function (t) {
                this._threshold = Math.max(t, 0)
            }), u(0, e, "anamorphicRatio", function () {
                return this._anamorphicRatio
            }, function (t) {
                this._anamorphicRatio = Math.min(Math.max(t, -1), 1)
            }), u(0, e, "diffusion", function () {
                return this._diffusion
            }, function (t) {
                this._diffusion = Math.min(Math.max(t, 1), 10)
            }), u(0, e, "dirtIntensity", function () {
                return this._dirtIntensity
            }, function (t) {
                this._dirtIntensity = Math.max(t, 0)
            }), P.SUBSHADER_PREFILTER13 = 0, P.SUBSHADER_PREFILTER4 = 1, P.SUBSHADER_DOWNSAMPLE13 = 2, P.SUBSHADER_DOWNSAMPLE4 = 3, P.SUBSHADER_UPSAMPLETENT = 4, P.SUBSHADER_UPSAMPLEBOX = 5, P.MAXPYRAMIDSIZE = 16, _(P, ["SHADERVALUE_MAINTEX", function () {
                return this.SHADERVALUE_MAINTEX = Pt.propertyNameToID("u_MainTex")
            }, "SHADERVALUE_AUTOEXPOSURETEX", function () {
                return this.SHADERVALUE_AUTOEXPOSURETEX = Pt.propertyNameToID("u_AutoExposureTex")
            }, "SHADERVALUE_SAMPLESCALE", function () {
                return this.SHADERVALUE_SAMPLESCALE = Pt.propertyNameToID("u_SampleScale")
            }, "SHADERVALUE_THRESHOLD", function () {
                return this.SHADERVALUE_THRESHOLD = Pt.propertyNameToID("u_Threshold")
            }, "SHADERVALUE_PARAMS", function () {
                return this.SHADERVALUE_PARAMS = Pt.propertyNameToID("u_Params")
            }, "SHADERVALUE_BLOOMTEX", function () {
                return this.SHADERVALUE_BLOOMTEX = Pt.propertyNameToID("u_BloomTex")
            }])
        }(), function (t) {
            function r() {
                this._shaderData = null, this._nameID = 0, this._texture = null, r.__super.call(this)
            }

            d(r, "laya.d3.core.render.command.SetShaderDataTextureCMD", j);
            var e = r.prototype;
            return e.run = function () {
                this._shaderData.setTexture(this._nameID, this._texture)
            }, e.recover = function () {
                r._pool.push(this), this._shaderData = null, this._nameID = 0, this._texture = null
            }, r.create = function (t, e, n) {
                var i;
                return (i = 0 < r._pool.length ? r._pool.pop() : new r)._shaderData = t, i._nameID = e, i._texture = n, i
            }, r._pool = [], r
        }()), An = function (n) {
            function t() {
                this.radius = NaN, this.emitFromShell = !1, t.__super.call(this), this.radius = 1, this.emitFromShell = !1, this.randomDirection = !1
            }

            d(t, "laya.d3.core.particleShuriKen.module.shape.SphereShape", n);
            var e = t.prototype;
            return e._getShapeBoundBox = function (t) {
                var e = t.min;
                e.x = e.y = e.z = -this.radius;
                var n = t.max;
                n.x = n.y = n.z = this.radius
            }, e._getSpeedBoundBox = function (t) {
                var e = t.min;
                e.x = e.y = e.z = -1;
                var n = t.max;
                n.x = n.y = n.z = 1
            }, e.generatePositionAndDirection = function (t, e, n, i) {
                n ? (n.seed = i[16], this.emitFromShell ? Le._randomPointUnitSphere(t, n) : Le._randomPointInsideUnitSphere(t, n), i[16] = n.seed) : this.emitFromShell ? Le._randomPointUnitSphere(t) : Le._randomPointInsideUnitSphere(t), Lt.scale(t, this.radius, t), this.randomDirection ? n ? (n.seed = i[17], Le._randomPointUnitSphere(e, n), i[17] = n.seed) : Le._randomPointUnitSphere(e) : t.cloneTo(e)
            }, e.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                e.radius = this.radius, e.emitFromShell = this.emitFromShell, e.randomDirection = this.randomDirection
            }, t
        }(G), Cn = function (n) {
            function t() {
                t.__super.call(this), this.inTangent = new Lt, this.outTangent = new Lt, this.value = new Lt
            }

            return d(t, "laya.d3.core.Vector3Keyframe", n), t.prototype.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                this.inTangent.cloneTo(e.inTangent), this.outTangent.cloneTo(e.outTangent), this.value.cloneTo(e.value)
            }, t
        }(ht), Ln = function (t) {
            function g(t, e) {
                this._stacks = 0, this._slices = 0, g.__super.call(this), void 0 === t && (t = 48), void 0 === e && (e = 48), this._stacks = t, this._slices = e;
                for (var n = $.vertexDeclaration, i = n.vertexStride / 4, r = (this._stacks + 1) * (this._slices + 1), a = 3 * this._stacks * (this._slices + 1) * 2, o = new Float32Array(r * i), s = new Uint16Array(a), l = Math.PI / this._stacks, h = 2 * Math.PI / this._slices, u = 0, c = 0, _ = 0, d = 0; d < this._stacks + 1; d++) for (var f = Math.sin(d * l), m = Math.cos(d * l), p = 0; p < this._slices + 1; p++) {
                    var T = f * Math.sin(p * h), E = f * Math.cos(p * h);
                    o[c + 0] = T * g._radius, o[c + 1] = m * g._radius, o[c + 2] = E * g._radius, o[c + 3] = -p / this._slices + .75, o[c + 4] = d / this._stacks, c += i, d != this._stacks - 1 && (s[_++] = u + 1, s[_++] = u, s[_++] = u + (this._slices + 1), s[_++] = u + (this._slices + 1), s[_++] = u, s[_++] = u + this._slices, u++)
                }
                this._vertexBuffer = new Ke(4 * o.length, 35044, !1), this._vertexBuffer.vertexDeclaration = n, this._indexBuffer = new qe("ushort", s.length, 35044, !1), this._vertexBuffer.setData(o), this._indexBuffer.setData(s);
                var v = new Je;
                v.bind(), v.applyVertexBuffer(this._vertexBuffer), v.applyIndexBuffer(this._indexBuffer), v.unBind(), this._bufferState = v
            }

            d(g, "laya.d3.resource.models.SkyDome", St);
            var e = g.prototype;
            return e._render = function (t) {
                var e = this._indexBuffer.indexCount;
                E.instance.drawElements(4, e, 5123, 0), C.trianglesFaces += e / 3, C.renderBatches++
            }, u(0, e, "stacks", function () {
                return this._stacks
            }), u(0, e, "slices", function () {
                return this._slices
            }), g.__init__ = function () {
                g.instance = new g
            }, g._radius = 1, g.instance = null, g
        }(), On = function (t) {
            function i(t, e, n) {
                switch (this._radius = 1, this._height = .5, i.__super.call(this), void 0 === t && (t = .5), void 0 === e && (e = 1), void 0 === n && (n = 1), this._radius = t, this._height = e, this._orientation = n, this._type = 2, n) {
                    case 0:
                        this._nativeShape = new k._physics3D.btConeShapeX(t, e);
                        break;
                    case 1:
                        this._nativeShape = new k._physics3D.btConeShape(t, e);
                        break;
                    case 2:
                        this._nativeShape = new k._physics3D.btConeShapeZ(t, e);
                        break;
                    default:
                        throw"ConeColliderShape:unknown orientation."
                }
            }

            d(i, "laya.d3.physics.shape.ConeColliderShape", H);
            var e = i.prototype;
            return e.clone = function () {
                var t = new i(this._radius, this._height, this._orientation);
                return this.cloneTo(t), t
            }, u(0, e, "radius", function () {
                return this._radius
            }), u(0, e, "height", function () {
                return this._height
            }), u(0, e, "orientation", function () {
                return this._orientation
            }), i
        }(), Nn = function (n) {
            function t() {
                this.x = NaN, this.y = NaN, this.z = NaN, t.__super.call(this), this.x = 1, this.y = 1, this.z = 1, this.randomDirection = !1
            }

            d(t, "laya.d3.core.particleShuriKen.module.shape.BoxShape", n);
            var e = t.prototype;
            return e._getShapeBoundBox = function (t) {
                var e = t.min;
                e.x = .5 * -this.x, e.y = .5 * -this.y, e.z = .5 * -this.z;
                var n = t.max;
                n.x = .5 * this.x, n.y = .5 * this.y, n.z = .5 * this.z
            }, e._getSpeedBoundBox = function (t) {
                var e = t.min;
                e.x = 0, e.y = 0, e.z = 0;
                var n = t.max;
                n.x = 0, n.y = 1, n.z = 0
            }, e.generatePositionAndDirection = function (t, e, n, i) {
                n ? (n.seed = i[16], Le._randomPointInsideHalfUnitBox(t, n), i[16] = n.seed) : Le._randomPointInsideHalfUnitBox(t), t.x = this.x * t.x, t.y = this.y * t.y, t.z = this.z * t.z, this.randomDirection ? n ? (n.seed = i[17], Le._randomPointUnitSphere(e, n), i[17] = n.seed) : Le._randomPointUnitSphere(e) : (e.x = 0, e.y = 0, e.z = 1)
            }, e.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                e.x = this.x, e.y = this.y, e.z = this.z, e.randomDirection = this.randomDirection
            }, t
        }(G), Vn = function (n) {
            function t() {
                t.__super.call(this), this.inTangent = new Ct, this.outTangent = new Ct, this.value = new at
            }

            return d(t, "laya.d3.core.QuaternionKeyframe", n), t.prototype.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                this.inTangent.cloneTo(e.inTangent), this.outTangent.cloneTo(e.outTangent), this.value.cloneTo(e.value)
            }, t
        }(ht), Pn = function (t) {
            function e() {
                e.__super.call(this), this._dynamicWorldPositionNormalNeedUpdate = !0
            }

            d(e, "laya.d3.core.render.SubMeshRenderElement", t);
            var n = e.prototype;
            return n._onWorldMatrixChanged = function () {
                this._dynamicWorldPositionNormalNeedUpdate = !0
            }, n._computeWorldPositionsAndNormals = function (t, e, n, i) {
                if (this._dynamicWorldPositionNormalNeedUpdate) {
                    for (var r = this._geometry, a = r._vertexBuffer, o = a.vertexDeclaration.vertexStride / 4, s = a.getData(), l = this._transform.worldMatrix, h = this._transform.rotation, u = r._indices, c = 0; c < i; c++) {
                        var _ = (n ? u[c] : c) * o, d = 3 * c;
                        kt.transformVector3ArrayToVector3ArrayCoordinate(s, _ + t, l, this._dynamicWorldPositions, d), -1 !== e && kt.transformVector3ArrayByQuat(s, _ + e, h, this._dynamicWorldNormals, d)
                    }
                    this._dynamicWorldPositionNormalNeedUpdate = !1
                }
            }, n.setTransform = function (t) {
                this._transform !== t && (this._transform && this._transform.off("transformchanged", this, this._onWorldMatrixChanged), t && t.on("transformchanged", this, this._onWorldMatrixChanged), this._dynamicWorldPositionNormalNeedUpdate = !0, this._transform = t)
            }, n.setGeometry = function (t) {
                if (this._geometry !== t) {
                    var e = t, n = e._mesh;
                    if (n) {
                        var i = 1 < n._subMeshCount, r = i ? e._indexCount : n._vertexCount;
                        if (r <= 10) {
                            var a = 3 * r;
                            this._dynamicVertexBatch = !0, this._dynamicWorldPositions = new Float32Array(a), this._dynamicWorldNormals = new Float32Array(a), this._dynamicVertexCount = r, this._dynamicMultiSubMesh = i
                        } else this._dynamicVertexBatch = !1
                    }
                    this._geometry = t
                }
            }, n.addToOpaqueRenderQueue = function (t, e) {
                var n = this.staticBatch, i = e.elements;
                if (n) {
                    var r = Sn.instance,
                        a = r.getBatchOpaquaMark(this.render.lightmapIndex + 1, this.render.receiveShadow, this.material.id, n._batchID);
                    if (r._updateCountMark === a.updateMark) {
                        var o = a.indexInList;
                        if (a.batched) i[o].staticBatchElementList.push(this); else {
                            var s = i[o], l = s.render, h = r._getBatchRenderElementFromPool();
                            h.renderType = 1, h.setGeometry(n), h.material = s.material;
                            var u = n.batchOwner, c = u ? u._transform : null;
                            h.setTransform(c), h.render = l;
                            var _ = h.staticBatchElementList;
                            _.length = 0, _.push(s), _.push(this), i[o] = h, a.batched = !0
                        }
                    } else a.updateMark = r._updateCountMark, a.indexInList = i.length, a.batched = !1, i.push(this)
                } else if (this.material._shader._enableInstancing && V._angleInstancedArrays) {
                    var d = this._geometry, f = ln.instance,
                        m = f.getInstanceBatchOpaquaMark(this.render.lightmapIndex + 1, this.render.receiveShadow, this.material.id, d._id);
                    if (f._updateCountMark === m.updateMark) {
                        var p = m.indexInList;
                        if (m.batched) {
                            var T = i[p].instanceBatchElementList;
                            T.length === En.instance.maxInstanceCount ? (m.updateMark = f._updateCountMark, m.indexInList = i.length, m.batched = !1, i.push(this)) : T.push(this)
                        } else {
                            var E = i[p], v = E.render, g = f._getBatchRenderElementFromPool();
                            g.renderType = 2, g.setGeometry(En.instance), g.material = E.material, g.setTransform(null), g.render = v, g.instanceSubMesh = d;
                            var S = g.instanceBatchElementList;
                            S.length = 0, S.push(E), S.push(this), i[p] = g, m.batched = !0
                        }
                    } else m.updateMark = f._updateCountMark, m.indexInList = i.length, m.batched = !1, i.push(this)
                } else if (this._dynamicVertexBatch) {
                    var y = this._geometry._vertexBuffer.vertexDeclaration, x = ln.instance,
                        D = x.getVertexBatchOpaquaMark(this.render.lightmapIndex + 1, this.render.receiveShadow, this.material.id, y.id);
                    if (x._updateCountMark === D.updateMark) {
                        var I = D.indexInList;
                        if (D.batched) i[I].vertexBatchElementList.push(this); else {
                            var R = i[I], M = R.render, A = x._getBatchRenderElementFromPool();
                            A.renderType = 3, A.setGeometry(yn.instance), A.material = R.material, A.setTransform(null), A.render = M, A.vertexBatchVertexDeclaration = y;
                            var C = A.vertexBatchElementList;
                            C.length = 0, C.push(R), C.push(this), i[I] = A, D.batched = !0
                        }
                    } else D.updateMark = x._updateCountMark, D.indexInList = i.length, D.batched = !1, i.push(this)
                } else i.push(this)
            }, n.addToTransparentRenderQueue = function (t, e) {
                var n = this.staticBatch, i = e.elements;
                if (n) {
                    var r = Sn.instance, a = e.lastTransparentRenderElement;
                    if (a) {
                        var o = a.render;
                        if (a._geometry._getType() !== this._geometry._getType() || a.staticBatch !== n || a.material !== this.material || o.receiveShadow !== this.render.receiveShadow || o.lightmapIndex !== this.render.lightmapIndex) i.push(this), e.lastTransparentBatched = !1; else {
                            if (e.lastTransparentBatched) i[i.length - 1].staticBatchElementList.push(this); else {
                                var s = r._getBatchRenderElementFromPool();
                                s.renderType = 1, s.setGeometry(n), s.material = a.material;
                                var l = n.batchOwner, h = l ? l._transform : null;
                                s.setTransform(h), s.render = this.render;
                                var u = s.staticBatchElementList;
                                u.length = 0, u.push(a), u.push(this), i[i.length - 1] = s
                            }
                            e.lastTransparentBatched = !0
                        }
                    } else i.push(this), e.lastTransparentBatched = !1
                } else if (this.material._shader._enableInstancing && V._angleInstancedArrays) {
                    var c = this._geometry, _ = ln.instance, d = e.lastTransparentRenderElement;
                    if (d) {
                        var f = d.render;
                        if (d._geometry._getType() !== this._geometry._getType() || d._geometry !== c || d.material !== this.material || f.receiveShadow !== this.render.receiveShadow || f.lightmapIndex !== this.render.lightmapIndex) i.push(this), e.lastTransparentBatched = !1; else {
                            if (e.lastTransparentBatched) i[i.length - 1].instanceBatchElementList.push(this); else {
                                var m = _._getBatchRenderElementFromPool();
                                m.renderType = 2, m.setGeometry(En.instance), m.material = d.material, m.setTransform(null), m.render = this.render, m.instanceSubMesh = c;
                                var p = m.instanceBatchElementList;
                                p.length = 0, p.push(d), p.push(this), i[i.length - 1] = m
                            }
                            e.lastTransparentBatched = !0
                        }
                    } else i.push(this), e.lastTransparentBatched = !1
                } else if (this._dynamicVertexBatch) {
                    var T = this._geometry._vertexBuffer.vertexDeclaration, E = ln.instance,
                        v = e.lastTransparentRenderElement;
                    if (v) {
                        var g = v.render;
                        if (v._geometry._getType() !== this._geometry._getType() || v._geometry._vertexBuffer._vertexDeclaration !== T || v.material !== this.material || g.receiveShadow !== this.render.receiveShadow || g.lightmapIndex !== this.render.lightmapIndex) i.push(this), e.lastTransparentBatched = !1; else {
                            if (e.lastTransparentBatched) i[i.length - 1].vertexBatchElementList.push(this); else {
                                var S = E._getBatchRenderElementFromPool();
                                S.renderType = 3, S.setGeometry(yn.instance), S.material = v.material, S.setTransform(null), S.render = this.render, S.vertexBatchVertexDeclaration = T;
                                var y = S.vertexBatchElementList;
                                y.length = 0, y.push(v), y.push(this), i[i.length - 1] = S
                            }
                            e.lastTransparentBatched = !0
                        }
                    } else i.push(this), e.lastTransparentBatched = !1
                } else i.push(this);
                e.lastTransparentRenderElement = this
            }, n.destroy = function () {
                t.prototype.destroy.call(this), this._dynamicWorldPositions = null, this._dynamicWorldNormals = null, this.staticBatch = null, this.staticBatchElementList = null, this.vertexBatchElementList = null, this.vertexBatchVertexDeclaration = null
            }, e._maxInstanceCount = 1024, _(e, ["_instanceMatrixData", function () {
                return this._instanceMatrixData = new Float32Array(16 * e._maxInstanceCount)
            }, "_instanceMatrixBuffer", function () {
                return this._instanceMatrixBuffer = new Ke(4 * e._instanceMatrixData.length, 35048)
            }]), e
        }(vt), wn = function (t) {
            function f(t, e, n, i, r, a, o, s, l, h, u, c, _, d) {
                this._cornerTextureCoordinate = null, this._positionStartLifeTime = null, this._velocity = null, this._startColor = null, this._startSize = null, this._startRotation0 = null, this._startRotation1 = null, this._startRotation2 = null, this._startLifeTime = NaN, this._time = NaN, this._startSpeed = NaN, this._randoms0 = null, this._randoms1 = null, this._simulationWorldPostion = null, f.__super.call(this), this._cornerTextureCoordinate = t, this._positionStartLifeTime = e, this._velocity = n, this._startColor = i, this._startSize = r, this._startRotation0 = a, this._startRotation1 = o, this._startRotation2 = s, this._startLifeTime = l, this._time = h, this._startSpeed = u, this._randoms0 = this.random0, this._randoms1 = this.random1, this._simulationWorldPostion = d
            }

            d(f, "laya.d3.graphics.Vertex.VertexShurikenParticleBillboard", lt);
            var e = f.prototype;
            return u(0, e, "cornerTextureCoordinate", function () {
                return this._cornerTextureCoordinate
            }), u(0, e, "random1", function () {
                return this._randoms1
            }), u(0, e, "startRotation2", function () {
                return this._startRotation2
            }), u(0, e, "positionStartLifeTime", function () {
                return this._positionStartLifeTime
            }), u(0, e, "velocity", function () {
                return this._velocity
            }), u(0, e, "random0", function () {
                return this._randoms0
            }), u(0, e, "startSize", function () {
                return this._startSize
            }), u(0, e, "startColor", function () {
                return this._startColor
            }), u(0, e, "startRotation0", function () {
                return this._startRotation0
            }), u(0, e, "startRotation1", function () {
                return this._startRotation1
            }), u(0, e, "startLifeTime", function () {
                return this._startLifeTime
            }), u(0, e, "time", function () {
                return this._time
            }), u(0, e, "startSpeed", function () {
                return this._startSpeed
            }), u(0, e, "simulationWorldPostion", function () {
                return this._simulationWorldPostion
            }), u(1, f, "vertexDeclaration", function () {
                return f._vertexDeclaration
            }, laya.d3.graphics.Vertex.VertexShuriKenParticle._$SET_vertexDeclaration), _(f, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(152, [new zt(0, "vector4", 0), new zt(16, "vector4", 4), new zt(32, "vector4", 5), new zt(48, "vector4", 6), new zt(64, "vector3", 8), new zt(76, "vector3", 9), new zt(88, "single", 10), new zt(92, "vector4", 11), new zt(108, "vector4", 12), new zt(124, "vector3", 13), new zt(136, "vector4", 14)])
            }]), f
        }(), bn = function (t) {
            function f(t, e, n, i, r, a, o, s, l, h, u, c, _, d) {
                this._cornerTextureCoordinate = null, this._positionStartLifeTime = null, this._velocity = null, this._startColor = null, this._startSize = null, this._startRotation0 = null, this._startRotation1 = null, this._startRotation2 = null, this._startLifeTime = NaN, this._time = NaN, this._startSpeed = NaN, this._randoms0 = null, this._randoms1 = null, this._simulationWorldPostion = null, f.__super.call(this), this._cornerTextureCoordinate = t, this._positionStartLifeTime = e, this._velocity = n, this._startColor = i, this._startSize = r, this._startRotation0 = a, this._startRotation1 = o, this._startRotation2 = s, this._startLifeTime = l, this._time = h, this._startSpeed = u, this._randoms0 = this.random0, this._randoms1 = this.random1, this._simulationWorldPostion = d
            }

            d(f, "laya.d3.graphics.Vertex.VertexShurikenParticleMesh", lt);
            var e = f.prototype;
            return u(0, e, "cornerTextureCoordinate", function () {
                return this._cornerTextureCoordinate
            }), u(0, e, "velocity", function () {
                return this._velocity
            }), u(0, e, "position", function () {
                return this._positionStartLifeTime
            }), u(0, e, "random0", function () {
                return this._randoms0
            }), u(0, e, "startSize", function () {
                return this._startSize
            }), u(0, e, "startColor", function () {
                return this._startColor
            }), u(0, e, "startRotation0", function () {
                return this._startRotation0
            }), u(0, e, "startRotation1", function () {
                return this._startRotation1
            }), u(0, e, "random1", function () {
                return this._randoms1
            }), u(0, e, "startRotation2", function () {
                return this._startRotation2
            }), u(0, e, "startLifeTime", function () {
                return this._startLifeTime
            }), u(0, e, "time", function () {
                return this._time
            }), u(0, e, "startSpeed", function () {
                return this._startSpeed
            }), u(0, e, "simulationWorldPostion", function () {
                return this._simulationWorldPostion
            }), u(1, f, "vertexDeclaration", function () {
                return f._vertexDeclaration
            }, laya.d3.graphics.Vertex.VertexShuriKenParticle._$SET_vertexDeclaration), _(f, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(172, [new zt(0, "vector3", 1), new zt(12, "vector4", 2), new zt(28, "vector2", 3), new zt(36, "vector4", 4), new zt(52, "vector4", 5), new zt(68, "vector4", 6), new zt(84, "vector3", 8), new zt(96, "vector3", 9), new zt(108, "single", 10), new zt(112, "vector4", 11), new zt(128, "vector4", 12), new zt(144, "vector3", 13), new zt(156, "vector4", 14)])
            }]), f
        }(), Fn = function (s) {
            function l(t, e) {
                this._needProcessCollisions = !1, this._needProcessTriggers = !1, l.__super.call(this), void 0 === e && (e = !1), this._id = ++l._uniqueIDCounter, this._transform = new Ye(this), this._isStatic = e, this.layer = 0, this.name = t || "New Sprite3D"
            }

            d(l, "laya.d3.core.Sprite3D", s);
            var t = l.prototype;
            return m.imps(t, {"laya.resource.ICreateResource": !0}), t._setCreateURL = function (t) {
                this._url = O.formatURL(t)
            }, t._changeAnimatorsToLinkSprite3D = function (t, e, n) {
                var i = this.getComponent(Ze);
                if (i && (i.avatar || t._changeAnimatorToLinkSprite3DNoAvatar(i, e, n)), this._parent && this._parent instanceof laya.d3.core.Sprite3D) {
                    n.unshift(this._parent.name);
                    var r = this._parent;
                    r._hierarchyAnimator && r._changeAnimatorsToLinkSprite3D(t, e, n)
                }
            }, t._setHierarchyAnimator = function (t, e) {
                this._changeHierarchyAnimator(t), this._changeAnimatorAvatar(t.avatar);
                for (var n = 0, i = this._children.length; n < i; n++) {
                    var r = this._children[n];
                    r._hierarchyAnimator == e && r._setHierarchyAnimator(t, e)
                }
            }, t._clearHierarchyAnimator = function (t, e) {
                this._changeHierarchyAnimator(e), this._changeAnimatorAvatar(e ? e.avatar : null);
                for (var n = 0, i = this._children.length; n < i; n++) {
                    var r = this._children[n];
                    r._hierarchyAnimator == t && r._clearHierarchyAnimator(t, e)
                }
            }, t._changeHierarchyAnimatorAvatar = function (t, e) {
                this._changeAnimatorAvatar(e);
                for (var n = 0, i = this._children.length; n < i; n++) {
                    var r = this._children[n];
                    r._hierarchyAnimator == t && r._changeHierarchyAnimatorAvatar(t, e)
                }
            }, t._changeAnimatorToLinkSprite3DNoAvatar = function (t, e, n) {
                t._handleSpriteOwnersBySprite(e, n, this);
                for (var i = 0, r = this._children.length; i < r; i++) {
                    var a = this._children[i], o = n.length;
                    n.push(a.name), a._changeAnimatorToLinkSprite3DNoAvatar(t, e, n), n.splice(o, 1)
                }
            }, t._changeHierarchyAnimator = function (t) {
                this._hierarchyAnimator = t
            }, t._changeAnimatorAvatar = function (t) {
            }, t._onAdded = function () {
                if (this._parent instanceof laya.d3.core.Sprite3D) {
                    var t = this._parent;
                    this.transform._setParent(t.transform), t._hierarchyAnimator && (!this._hierarchyAnimator && this._setHierarchyAnimator(t._hierarchyAnimator, null), t._changeAnimatorsToLinkSprite3D(this, !0, [this.name]))
                }
                s.prototype._onAdded.call(this)
            }, t._onRemoved = function () {
                if (s.prototype._onRemoved.call(this), this._parent instanceof laya.d3.core.Sprite3D) {
                    var t = this._parent;
                    this.transform._setParent(null), t._hierarchyAnimator && (this._hierarchyAnimator == t._hierarchyAnimator && this._clearHierarchyAnimator(t._hierarchyAnimator, null), t._changeAnimatorsToLinkSprite3D(this, !1, [this.name]))
                }
            }, t._parse = function (t, e) {
                if (void 0 !== t.isStatic && (this._isStatic = t.isStatic), void 0 !== t.active && (this.active = t.active), null != t.name && (this.name = t.name), void 0 !== t.position) {
                    var n = this.transform.localPosition;
                    n.fromArray(t.position), this.transform.localPosition = n
                }
                if (void 0 !== t.rotationEuler) {
                    var i = this.transform.localRotationEuler;
                    i.fromArray(t.rotationEuler), this.transform.localRotationEuler = i
                }
                if (void 0 !== t.rotation) {
                    var r = this.transform.localRotation;
                    r.fromArray(t.rotation), this.transform.localRotation = r
                }
                if (void 0 !== t.scale) {
                    var a = this.transform.localScale;
                    a.fromArray(t.scale), this.transform.localScale = a
                }
                null != t.layer && (this.layer = t.layer)
            }, t._cloneTo = function (t, e, n) {
                if (this.destroyed) throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");
                var i = t;
                i.name = this.name, i.destroyed = this.destroyed, i.active = this.active;
                var r = i.transform.localPosition;
                this.transform.localPosition.cloneTo(r), i.transform.localPosition = r;
                var a = i.transform.localRotation;
                this.transform.localRotation.cloneTo(a), i.transform.localRotation = a;
                var o = i.transform.localScale;
                this.transform.localScale.cloneTo(o), i.transform.localScale = o, i._isStatic = this._isStatic, i.layer = this.layer, s.prototype._cloneTo.call(this, i, e, n)
            }, t.clone = function () {
                var t = l._createSprite3DInstance(this);
                return l._parseSprite3DInstance(this, t, this, t), t
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this.destroyed || (s.prototype.destroy.call(this, t), this._transform = null, this._scripts = null, this._url && Dt.clearRes(this._url))
            }, u(0, t, "id", function () {
                return this._id
            }), u(0, t, "url", function () {
                return this._url
            }), u(0, t, "layer", function () {
                return this._layer
            }, function (t) {
                if (this._layer !== t) {
                    if (!(0 <= t && t <= 30)) throw new Error("Layer value must be 0-30.");
                    this._layer = t
                }
            }), u(0, t, "transform", function () {
                return this._transform
            }), u(0, t, "isStatic", function () {
                return this._isStatic
            }), l._parse = function (t, e, n) {
                var i, r = t.data, a = [];
                switch (t.version) {
                    case"LAYAHIERARCHY:02":
                        i = kt._createNodeByJson02(r, a);
                        break;
                    default:
                        i = kt._createNodeByJson(r, a)
                }
                return Z.combine(i, a), i
            }, l.__init__ = function () {
            }, l.instantiate = function (t, e, n, i, r) {
                void 0 === n && (n = !0);
                var a = t.clone();
                e && e.addChild(a);
                var o = a.transform;
                if (n) {
                    var s = o.worldMatrix;
                    t.transform.worldMatrix.cloneTo(s), o.worldMatrix = s
                } else i && (o.position = i), r && (o.rotation = r);
                return a
            }, l.load = function (t, e) {
                m.loader.create(t, e, null, "HIERARCHY")
            }, l._createSprite3DInstance = function (t) {
                for (var e = new t.constructor, n = t._children, i = 0, r = n.length; i < r; i++) {
                    var a = l._createSprite3DInstance(n[i]);
                    e.addChild(a)
                }
                return e
            }, l._parseSprite3DInstance = function (t, e, n, i) {
                for (var r = n._children, a = i._children, o = 0, s = r.length; o < s; o++) l._parseSprite3DInstance(t, e, r[o], a[o]);
                n._cloneTo(i, t, e)
            }, l._uniqueIDCounter = 0, _(l, ["WORLDMATRIX", function () {
                return this.WORLDMATRIX = Pt.propertyNameToID("u_WorldMat")
            }, "MVPMATRIX", function () {
                return this.MVPMATRIX = Pt.propertyNameToID("u_MvpMatrix")
            }]), l
        }(e), Bn = function (r) {
            function e() {
                this._shaderValues = null, e.__super.call(this), this._defineDatas = new Ut, this._disablePublicDefineDatas = new Ut, this._shaderValues = new ot(this), this.renderQueue = 2e3, this._alphaTest = !1
            }

            d(e, "laya.d3.core.material.BaseMaterial", r);
            var t = e.prototype;
            return m.imps(t, {"laya.d3.core.IClone": !0}), t._removeTetxureReference = function () {
                var t = this._shaderValues.getData();
                for (var e in t) {
                    var n = t[e];
                    n && n instanceof laya.resource.BaseTexture && n._removeReference()
                }
            }, t._addReference = function (t) {
                void 0 === t && (t = 1), r.prototype._addReference.call(this, t);
                var e = this._shaderValues.getData();
                for (var n in e) {
                    var i = e[n];
                    i && i instanceof laya.resource.BaseTexture && i._addReference()
                }
            }, t._removeReference = function (t) {
                void 0 === t && (t = 1), r.prototype._removeReference.call(this, t), this._removeTetxureReference()
            }, t._disposeResource = function () {
                0 < this._referenceCount && this._removeTetxureReference(), this._shaderValues = null
            }, t.setShaderName = function (t) {
                if (this._shader = Pt.find(t), !this._shader) throw new Error("BaseMaterial: unknown shader name.")
            }, t.cloneTo = function (t) {
                var e = t;
                e.name = this.name, e.renderQueue = this.renderQueue, this._disablePublicDefineDatas.cloneTo(e._disablePublicDefineDatas), this._defineDatas.cloneTo(e._defineDatas), this._shaderValues.cloneTo(e._shaderValues)
            }, t.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, t, "alphaTestValue", function () {
                return this._shaderValues.getNumber(e.ALPHATESTVALUE)
            }, function (t) {
                this._shaderValues.setNumber(e.ALPHATESTVALUE, t)
            }), u(0, t, "alphaTest", function () {
                return this._alphaTest
            }, function (t) {
                (this._alphaTest = t) ? this._defineDatas.add(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST) : this._defineDatas.remove(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)
            }), e.load = function (t, e) {
                m.loader.create(t, e, null, "MATERIAL")
            }, e.__init__ = function () {
                e.SHADERDEFINE_ALPHATEST = e.shaderDefines.registerDefine("ALPHATEST")
            }, e._parse = function (t, e, n) {
                var i, r = t, a = r.props, o = a.type.split("."), s = S.window;
                if (o.forEach(function (t) {
                    s = s[t]
                }), "function" != typeof s) throw"_getSprite3DHierarchyInnerUrls 错误: " + t.type + " 不是类";
                switch (i = new s, r.version) {
                    case"LAYAMATERIAL:01":
                    case"LAYAMATERIAL:02":
                        var l = 0, h = 0;
                        for (var u in a) switch (u) {
                            case"vectors":
                                var c = a[u];
                                for (l = 0, h = c.length; l < h; l++) {
                                    var _ = c[l], d = _.value;
                                    switch (d.length) {
                                        case 2:
                                            i[_.name] = new Ot(d[0], d[1]);
                                            break;
                                        case 3:
                                            i[_.name] = new Lt(d[0], d[1], d[2]);
                                            break;
                                        case 4:
                                            i[_.name] = new Ct(d[0], d[1], d[2], d[3]);
                                            break;
                                        default:
                                            throw new Error("BaseMaterial:unkonwn color length.")
                                    }
                                }
                                break;
                            case"textures":
                                var f = a[u];
                                for (l = 0, h = f.length; l < h; l++) {
                                    var m = f[l], p = m.path;
                                    p && (i[m.name] = Dt.getRes(p))
                                }
                                break;
                            case"defines":
                                var T = a[u];
                                for (l = 0, h = T.length; l < h; l++) {
                                    var E = i._shader.getSubShaderAt(0).getMaterialDefineByName(T[l]);
                                    i._defineDatas.add(E)
                                }
                                break;
                            case"renderStates":
                                var v = a[u][0], g = i;
                                g.blend = v.blend, g.cull = v.cull, g.depthTest = v.depthTest, g.depthWrite = v.depthWrite, g.blendSrc = v.srcBlend, g.blendDst = v.dstBlend;
                                break;
                            case"cull":
                                i.cull = a[u];
                                break;
                            case"blend":
                                i.blend = a[u];
                                break;
                            case"depthWrite":
                                i.depthWrite = a[u];
                                break;
                            case"srcBlend":
                                i.blendSrc = a[u];
                                break;
                            case"dstBlend":
                                i.blendDst = a[u];
                                break;
                            default:
                                i[u] = a[u]
                        }
                        break;
                    default:
                        throw new Error("BaseMaterial:unkonwn version.")
                }
                return i
            }, e.RENDERQUEUE_OPAQUE = 2e3, e.RENDERQUEUE_ALPHATEST = 2450, e.RENDERQUEUE_TRANSPARENT = 3e3, e.SHADERDEFINE_ALPHATEST = 0, _(e, ["ALPHATESTVALUE", function () {
                return this.ALPHATESTVALUE = Pt.propertyNameToID("u_AlphaTestValue")
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut
            }]), e
        }(D), Un = function (t) {
            function e() {
                this._vertexBuffer = null, e.__super.call(this), this._bufferState = new Je, this._vertexBuffer = new Ke(64, 35044, !1), this._vertexBuffer.vertexDeclaration = laya.d3.core.render.ScreenQuad._vertexDeclaration, this._vertexBuffer.setData(e._vertices), this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer), this._bufferState.unBind(), this._setGPUMemory(this._vertexBuffer._byteLength)
            }

            d(e, "laya.d3.core.render.ScreenQuad", t);
            var n = e.prototype;
            return n.render = function () {
                this._bufferState.bind(), E.instance.drawArrays(5, 0, 4), C.renderBatches++
            }, n.destroy = function () {
                t.prototype.destroy.call(this), this._bufferState.destroy(), this._vertexBuffer.destroy(), this._setGPUMemory(0)
            }, e.__init__ = function () {
                (e.instance = new e).lock = !0
            }, e.SCREENQUAD_POSITION_UV = 0, e.instance = null, _(e, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(16, [new zt(0, "vector4", 0)])
            }, "_vertices", function () {
                return this._vertices = new Float32Array([1, 1, 1, 0, 1, -1, 1, 1, -1, 1, 0, 0, -1, -1, 0, 1])
            }]), e
        }(D), zn = function (t) {
            function a() {
                this._rootNode = null, this._nativeNodeCount = 0, this._nativeCurCloneCount = 0, a.__super.call(this)
            }

            d(a, "laya.d3.core.Avatar", D);
            var e = a.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e._initCloneToAnimator = function (t, e) {
                for (var n = 0, i = (e._avatarNodeMap[t.name] = t).getChildCount(); n < i; n++) this._initCloneToAnimator(t.getChildByIndex(n), e)
            }, e._parseNode = function (t, e) {
                var n = t.props.name;
                e.name = n;
                var i = t.props, r = e.transform, a = r.localPosition, o = r.localRotation, s = r.localScale;
                a.fromArray(i.translate), o.fromArray(i.rotation), s.fromArray(i.scale), r.localPosition = a, r.localRotation = o, r.localScale = s;
                for (var l = t.child, h = 0, u = l.length; h < u; h++) {
                    var c = l[h],
                        _ = new Ie(new Float32Array(3), new Float32Array(4), new Float32Array(3), new Float32Array(16));
                    e.addChild(_), b.supportWebGLPlusAnimation && this._nativeNodeCount++, this._parseNode(c, _)
                }
            }, e._cloneDatasToAnimator = function (t) {
                var e;
                e = this._rootNode.clone();
                var n = this._rootNode.transform, i = e.transform, r = i.localPosition, a = i.localRotation,
                    o = i.localScale;
                n.localPosition.cloneTo(r), n.localRotation.cloneTo(a), n.localScale.cloneTo(o), i.localPosition = r, i.localRotation = a, i.localScale = o, t._avatarNodeMap = {}, this._initCloneToAnimator(e, t)
            }, e.cloneTo = function (t) {
                var e = t, n = this._rootNode.clone();
                e._rootNode = n
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, e._cloneDatasToAnimatorNative = function (t) {
                var e = new Float32Array(3 * this._nativeNodeCount), n = new Float32Array(4 * this._nativeNodeCount),
                    i = new Float32Array(3 * this._nativeNodeCount), r = new Float32Array(16 * this._nativeNodeCount),
                    a = new Int16Array(this._nativeNodeCount);
                t._animationNodeLocalPositions = e, t._animationNodeLocalRotations = n, t._animationNodeLocalScales = i, t._animationNodeWorldMatrixs = r, t._animationNodeParentIndices = a, this._nativeCurCloneCount = 0;
                var o = this._rootNode._cloneNative(e, n, i, r, a, -1, this), s = this._rootNode.transform,
                    l = o.transform, h = l.localPosition, u = l.localRotation, c = l.localScale;
                s.localPosition.cloneTo(h), s.localRotation.cloneTo(u), s.localScale.cloneTo(c), l.localPosition = h, l.localRotation = u, l.localScale = c, t._avatarNodeMap = {}, this._initCloneToAnimator(o, t)
            }, a._parse = function (t, e, n) {
                var i = new a;
                if (i._rootNode = new Ie(new Float32Array(3), new Float32Array(4), new Float32Array(3), new Float32Array(16)), b.supportWebGLPlusAnimation && i._nativeNodeCount++, t.version) {
                    var r = t.rootNode;
                    r && i._parseNode(r, i._rootNode)
                }
                return i
            }, a.load = function (t, e) {
                m.loader.create(t, e, null, "AVATAR")
            }, a
        }(), Gn = function (t) {
            function E() {
                this._nativeTriangleMesh = null, this._bounds = null, this._subMeshCount = 0, this._subMeshes = null, this._vertexBuffers = null, this._indexBuffer = null, this._boneNames = null, this._inverseBindPoses = null, this._inverseBindPosesBuffer = null, this._bindPoseIndices = null, this._skinDataPathMarks = null, this._vertexCount = 0, this._tempVector30 = new Lt, this._tempVector31 = new Lt, this._tempVector32 = new Lt, this._bufferState = new Je, this._instanceBufferState = new Je, E.__super.call(this), this._subMeshes = [], this._vertexBuffers = [], this._skinDataPathMarks = []
            }

            d(E, "laya.d3.resource.models.Mesh", D);
            var e = E.prototype;
            return m.imps(e, {"laya.d3.core.IClone": !0}), e._getPositionElement = function (t) {
                for (var e = t.vertexDeclaration.vertexElements, n = 0, i = e.length; n < i; n++) {
                    var r = e[n];
                    if ("vector3" === r.elementFormat && 0 === r.elementUsage) return r
                }
                return null
            }, e._generateBoundingObject = function () {
                var t = this._tempVector30, e = this._tempVector31;
                t.x = t.y = t.z = Number.MAX_VALUE, e.x = e.y = e.z = -Number.MAX_VALUE;
                for (var n = this._vertexBuffers.length, i = 0; i < n; i++) for (var r = this._vertexBuffers[i], a = this._getPositionElement(r), o = r.getData(), s = r.vertexDeclaration.vertexStride / 4, l = a.offset / 4, h = 0, u = o.length; h < u; h += s) {
                    var c = h + l, _ = o[c], d = o[c + 1], f = o[c + 2];
                    t.x = Math.min(t.x, _), t.y = Math.min(t.y, d), t.z = Math.min(t.z, f), e.x = Math.max(e.x, _), e.y = Math.max(e.y, d), e.z = Math.max(e.z, f)
                }
                this._bounds = new xe(t, e)
            }, e._setSubMeshes = function (t) {
                this._subMeshes = t, this._subMeshCount = t.length;
                for (var e = 0; e < this._subMeshCount; e++) t[e]._indexInMesh = e;
                this._generateBoundingObject()
            }, e._getSubMesh = function (t) {
                return this._subMeshes[t]
            }, e._setBuffer = function (t, e) {
                var n = this._bufferState;
                n.bind(), n.applyVertexBuffers(t), n.applyIndexBuffer(e), n.unBind();
                var i = this._instanceBufferState;
                i.bind(), i.applyVertexBuffers(t), i.applyInstanceVertexBuffer(En.instance.instanceWorldMatrixBuffer), i.applyInstanceVertexBuffer(En.instance.instanceMVPMatrixBuffer), i.applyIndexBuffer(e), i.unBind()
            }, e._disposeResource = function () {
                for (var t = 0, e = this._subMeshes.length; t < e; t++) this._subMeshes[t].destroy();
                for (this._nativeTriangleMesh && k._physics3D.destroy(this._nativeTriangleMesh), t = 0, e = this._vertexBuffers.length; t < e; t++) this._vertexBuffers[t].destroy();
                this._indexBuffer.destroy(), this._setCPUMemory(0), this._setGPUMemory(0), this._bufferState.destroy(), this._instanceBufferState.destroy(), this._bufferState = null, this._instanceBufferState = null, this._vertexBuffers = null, this._indexBuffer = null, this._subMeshes = null, this._nativeTriangleMesh = null, this._vertexBuffers = null, this._indexBuffer = null, this._boneNames = null, this._inverseBindPoses = null
            }, e._getPhysicMesh = function () {
                if (!this._nativeTriangleMesh) {
                    for (var t = new k._physics3D.btTriangleMesh, e = E._nativeTempVector30, n = E._nativeTempVector31, i = E._nativeTempVector32, r = this._tempVector30, a = this._tempVector31, o = this._tempVector32, s = this._vertexBuffers[0], l = this._getPositionElement(s), h = s.getData(), u = s.vertexDeclaration.vertexStride / 4, c = l.offset / 4, _ = this._indexBuffer.getData(), d = 0, f = _.length; d < f; d += 3) {
                        var m = _[d] * u + c, p = _[d + 1] * u + c, T = _[d + 2] * u + c;
                        r.setValue(h[m], h[m + 1], h[m + 2]), a.setValue(h[p], h[p + 1], h[p + 2]), o.setValue(h[T], h[T + 1], h[T + 2]), kt._convertToBulletVec3(r, e, !0), kt._convertToBulletVec3(a, n, !0), kt._convertToBulletVec3(o, i, !0), t.addTriangle(e, n, i, !0)
                    }
                    this._nativeTriangleMesh = t
                }
                return this._nativeTriangleMesh
            }, e.cloneTo = function (t) {
                for (var e = t, n = 0; n < this._vertexBuffers.length; n++) {
                    var i = this._vertexBuffers[n], r = new Ke(i._byteLength, i.bufferUsage, i.canRead);
                    r.vertexDeclaration = i.vertexDeclaration, r.setData(i.getData().slice()), e._vertexBuffers.push(r), e._vertexCount += r.vertexCount
                }
                var a = this._indexBuffer, o = new qe("ushort", a.indexCount, a.bufferUsage, a.canRead);
                o.setData(a.getData().slice()), e._indexBuffer = o, e._setBuffer(e._vertexBuffers, o), e._setCPUMemory(this.cpuMemory), e._setGPUMemory(this.gpuMemory);
                var s = this._boneNames, l = e._boneNames = w(s.length);
                for (n = 0; n < s.length; n++) l[n] = s[n];
                var h = this._inverseBindPoses, u = e._inverseBindPoses = w(h.length);
                for (n = 0; n < h.length; n++) u[n] = h[n];
                for (e._bindPoseIndices = new Uint16Array(this._bindPoseIndices), n = 0; n < this._skinDataPathMarks.length; n++) e._skinDataPathMarks[n] = this._skinDataPathMarks[n].slice();
                for (n = 0; n < this.subMeshCount; n++) {
                    var c = this._subMeshes[n], _ = c._subIndexBufferStart, d = c._subIndexBufferCount,
                        f = c._boneIndicesList, m = new on(e);
                    m._subIndexBufferStart.length = _.length, m._subIndexBufferCount.length = d.length, m._boneIndicesList.length = f.length;
                    for (var p = 0; p < _.length; p++) m._subIndexBufferStart[p] = _[p];
                    for (p = 0; p < d.length; p++) m._subIndexBufferCount[p] = d[p];
                    for (p = 0; p < f.length; p++) m._boneIndicesList[p] = new Uint16Array(f[p]);
                    m._indexBuffer = o, m._indexStart = c._indexStart, m._indexCount = c._indexCount, m._indices = new Uint16Array(o.getData().buffer, 2 * c._indexStart, c._indexCount);
                    var T = e._vertexBuffers[0];
                    m._vertexBuffer = T, e._subMeshes.push(m)
                }
                e._setSubMeshes(e._subMeshes)
            }, e.clone = function () {
                var t = new this.constructor;
                return this.cloneTo(t), t
            }, u(0, e, "inverseAbsoluteBindPoses", function () {
                return this._inverseBindPoses
            }), u(0, e, "vertexCount", function () {
                return this._vertexCount
            }), u(0, e, "subMeshCount", function () {
                return this._subMeshCount
            }), u(0, e, "bounds", function () {
                return this._bounds
            }), E._parse = function (t, e, n) {
                var i = new E;
                return _t.read(t, i, i._subMeshes), i
            }, E.load = function (t, e) {
                m.loader.create(t, e, null, "MESH")
            }, _(E, ["_nativeTempVector30", function () {
                return this._nativeTempVector30 = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeTempVector31", function () {
                return this._nativeTempVector31 = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeTempVector32", function () {
                return this._nativeTempVector32 = new k._physics3D.btVector3(0, 0, 0)
            }]), E
        }(), Hn = function (t) {
            function l(t, e, n, i) {
                this._terrainHeightData = null, this._width = 0, this._height = 0, this._bitType = 0, this._value = NaN, l.__super.call(this), this._width = t, this._height = e, this._bitType = n, this._value = i
            }

            return d(l, "laya.d3.terrain.TerrainHeightData", D), l._pharse = function (t, e, n) {
                var i, r = new l(n[0], n[1], n[2], n[3]), a = NaN;
                8 == r._bitType ? (i = new Uint8Array(t), a = 1 / 255) : 16 == r._bitType && (i = new Int16Array(t), a = 1 / 32766), r._terrainHeightData = new Float32Array(r._height * r._width);
                for (var o = 0, s = r._height * r._width; o < s; o++) r._terrainHeightData[o] = i[o] * a * r._value / 2
            }, l.load = function (t, e, n, i, r, a) {
                m.loader.create(t, e, null, "TERRAINHEIGHTDATA", [n, i, r, a], null, 1, !1)
            }, l
        }(), kn = function (t) {
            function x() {
                x.__super.call(this), this._nodes = new Qt, this._events = []
            }

            d(x, "laya.d3.animation.AnimationClip", D);
            var e = x.prototype;
            return e.duration = function () {
                return this._duration
            }, e._hermiteInterpolate = function (t, e, n, i) {
                var r = t.outTangent, a = e.inTangent;
                if (Number.isFinite(r) && Number.isFinite(a)) {
                    var o = n * n, s = o * n, l = s - 2 * o + n, h = s - o, u = -2 * s + 3 * o;
                    return (2 * s - 3 * o + 1) * t.value + l * r * i + h * a * i + u * e.value
                }
                return t.value
            }, e._hermiteInterpolateVector3 = function (t, e, n, i, r) {
                var a = t.value, o = t.outTangent, s = e.value, l = e.inTangent, h = n * n, u = h * n,
                    c = 2 * u - 3 * h + 1, _ = u - 2 * h + n, d = u - h, f = -2 * u + 3 * h, m = o.x, p = l.x;
                Number.isFinite(m) && Number.isFinite(p) ? r.x = c * a.x + _ * m * i + d * p * i + f * s.x : r.x = a.x, m = o.y, p = l.y, Number.isFinite(m) && Number.isFinite(p) ? r.y = c * a.y + _ * m * i + d * p * i + f * s.y : r.y = a.y, m = o.z, p = l.z, Number.isFinite(m) && Number.isFinite(p) ? r.z = c * a.z + _ * m * i + d * p * i + f * s.z : r.z = a.z
            }, e._hermiteInterpolateQuaternion = function (t, e, n, i, r) {
                var a = t.value, o = t.outTangent, s = e.value, l = e.inTangent, h = n * n, u = h * n,
                    c = 2 * u - 3 * h + 1, _ = u - 2 * h + n, d = u - h, f = -2 * u + 3 * h, m = o.x, p = l.x;
                Number.isFinite(m) && Number.isFinite(p) ? r.x = c * a.x + _ * m * i + d * p * i + f * s.x : r.x = a.x, m = o.y, p = l.y, Number.isFinite(m) && Number.isFinite(p) ? r.y = c * a.y + _ * m * i + d * p * i + f * s.y : r.y = a.y, m = o.z, p = l.z, Number.isFinite(m) && Number.isFinite(p) ? r.z = c * a.z + _ * m * i + d * p * i + f * s.z : r.z = a.z, m = o.w, p = l.w, Number.isFinite(m) && Number.isFinite(p) ? r.w = c * a.w + _ * m * i + d * p * i + f * s.w : r.w = a.w
            }, e._evaluateClipDatasRealTime = function (t, e, n, i, r) {
                for (var a = 0, o = t.count; a < o; a++) {
                    var s = t.getNodeByIndex(a), l = s.type, h = 0, u = s._keyFrames, c = u.length, _ = n[a];
                    if (r) for (-1 !== _ && e < u[_].time && (_ = -1, n[a] = _), h = _ + 1; h < c && !(u[h].time > e);) _++, h++, n[a] = _; else for ((h = _ + 1) !== c && e > u[h].time && (_ = c - 1, n[a] = _), h = _ + 1; -1 < _ && !(u[_].time < e);) _--, h--, n[a] = _;
                    var d = h === c;
                    switch (l) {
                        case 0:
                            if (-1 !== _) {
                                var f = u[_];
                                if (d) s.data = f.value; else {
                                    var m = u[h], p = m.time - f.time, T = NaN;
                                    T = 0 !== p ? (e - f.time) / p : 0, s.data = this._hermiteInterpolate(f, m, T, p)
                                }
                            } else s.data = u[0].value;
                            i && (s.data -= u[0].value);
                            break;
                        case 1:
                        case 4:
                            var E = s.data;
                            if (this._evaluateFrameNodeVector3DatasRealTime(u, _, d, e, E), i) {
                                var v = u[0].value;
                                E.x -= v.x, E.y -= v.y, E.z -= v.z
                            }
                            break;
                        case 2:
                            var g = s.data;
                            if (this._evaluateFrameNodeQuaternionDatasRealTime(u, _, d, e, g), i) {
                                var S = x._tempQuaternion0, y = u[0].value;
                                kt.quaternionConjugate(y, S), at.multiply(S, g, g)
                            }
                            break;
                        case 3:
                            E = s.data, this._evaluateFrameNodeVector3DatasRealTime(u, _, d, e, E), i && (v = u[0].value, E.x /= v.x, E.y /= v.y, E.z /= v.z);
                            break;
                        default:
                            throw"AnimationClip:unknown node type."
                    }
                }
            }, e._evaluateClipDatasRealTimeForNative = function (t, e, n, i) {
                E.instance.evaluateClipDatasRealTime(t._nativeObj, e, n, i)
            }, e._evaluateFrameNodeVector3DatasRealTime = function (t, e, n, i, r) {
                if (-1 !== e) {
                    var a = t[e];
                    if (n) {
                        var o = a.value;
                        r.x = o.x, r.y = o.y, r.z = o.z
                    } else {
                        var s = t[e + 1], l = NaN, h = a.time, u = s.time - h;
                        l = 0 !== u ? (i - h) / u : 0, this._hermiteInterpolateVector3(a, s, l, u, r)
                    }
                } else {
                    var c = t[0].value;
                    r.x = c.x, r.y = c.y, r.z = c.z
                }
            }, e._evaluateFrameNodeQuaternionDatasRealTime = function (t, e, n, i, r) {
                if (-1 !== e) {
                    var a = t[e];
                    if (n) {
                        var o = a.value;
                        r.x = o.x, r.y = o.y, r.z = o.z, r.w = o.w
                    } else {
                        var s = t[e + 1], l = NaN, h = a.time, u = s.time - h;
                        l = 0 !== u ? (i - h) / u : 0, this._hermiteInterpolateQuaternion(a, s, l, u, r)
                    }
                } else {
                    var c = t[0].value;
                    r.x = c.x, r.y = c.y, r.z = c.z, r.w = c.w
                }
            }, e._binarySearchEventIndex = function (t) {
                for (var e = 0, n = this._events.length - 1, i = 0; e <= n;) {
                    i = Math.floor((e + n) / 2);
                    var r = this._events[i].time;
                    if (r == t) return i;
                    t < r ? n = i - 1 : e = i + 1
                }
                return e
            }, e.addEvent = function (t) {
                var e = this._binarySearchEventIndex(t.time);
                this._events.splice(e, 0, t)
            }, e._disposeResource = function () {
                this._nodes = null, this._nodesMap = null
            }, x._parse = function (t, e, n) {
                var i = new x, r = new s(t), a = r.readUTFString();
                switch (a) {
                    case"LAYAANIMATION:03":
                        Bt.parse(i, r);
                        break;
                    case"LAYAANIMATION:04":
                    case"LAYAANIMATION:COMPRESSION_04":
                        Ft.parse(i, r, a);
                        break;
                    default:
                        throw"unknown animationClip version."
                }
                return i
            }, x.load = function (t, e) {
                m.loader.create(t, e, null, "ANIMATIONCLIP")
            }, _(x, ["_tempQuaternion0", function () {
                return this._tempQuaternion0 = new at
            }]), x
        }(), Xn = function (t) {
            function a(t, e, n, i, r) {
                this._stateParamsMap = [], this._uploadMark = -1, this._uploadRenderType = -1, a.__super.call(this), this._vs = t, this._ps = e, this._attributeMap = n, this._uniformMap = i, this._shaderPass = r, this._create(), this.lock = !0
            }

            d(a, "laya.d3.shader.ShaderInstance", D);
            var e = a.prototype;
            return e._create = function () {
                var t = E.instance;
                for (var e in this._program = t.createProgram(), this._vshader = this._createShader(t, this._vs, 35633), this._pshader = this._createShader(t, this._ps, 35632), t.attachShader(this._program, this._vshader), t.attachShader(this._program, this._pshader), this._attributeMap) t.bindAttribLocation(this._program, this._attributeMap[e], e);
                if (t.linkProgram(this._program), !b.isConchApp && Pt.debugMode && !t.getProgramParameter(this._program, 35714)) throw t.getProgramInfoLog(this._program);
                var n = [], i = [], r = [], a = [], o = [];
                this._customUniformParamsMap = [];
                var s = t.getProgramParameter(this._program, 35718);
                V.useProgram(t, this._program);
                var l, h = this._curActTexIndex = 0, u = 0;
                for (h = 0; h < s; h++) {
                    var c = t.getActiveUniform(this._program, h), _ = c.name;
                    (l = new ge).location = t.getUniformLocation(this._program, _), 0 < _.indexOf("[0]") ? (l.name = _ = _.substr(0, _.length - 3), l.isArray = !0) : (l.name = _, l.isArray = !1), l.type = c.type, this._addShaderUnifiormFun(l);
                    var d = this._uniformMap[_];
                    if (null != d) switch (l.dataOffset = Pt.propertyNameToID(_), d) {
                        case 0:
                            o.push(l);
                            break;
                        case 1:
                            a.push(l);
                            break;
                        case 2:
                            r.push(l);
                            break;
                        case 3:
                            i.push(l);
                            break;
                        case 4:
                            n.push(l);
                            break;
                        default:
                            throw new Error("Shader3D: period is unkonw.")
                    }
                }
                for (this._sceneUniformParamsMap = E.instance.createCommandEncoder(4 * n.length * 5 + 4, 64, !0), h = 0, u = n.length; h < u; h++) this._sceneUniformParamsMap.addShaderUniform(n[h]);
                for (this._cameraUniformParamsMap = E.instance.createCommandEncoder(4 * i.length * 5 + 4, 64, !0), h = 0, u = i.length; h < u; h++) this._cameraUniformParamsMap.addShaderUniform(i[h]);
                for (this._spriteUniformParamsMap = E.instance.createCommandEncoder(4 * r.length * 5 + 4, 64, !0), h = 0, u = r.length; h < u; h++) this._spriteUniformParamsMap.addShaderUniform(r[h]);
                for (this._materialUniformParamsMap = E.instance.createCommandEncoder(4 * a.length * 5 + 4, 64, !0), h = 0, u = a.length; h < u; h++) this._materialUniformParamsMap.addShaderUniform(a[h]);
                for (this._customUniformParamsMap.length = o.length, h = 0, u = o.length; h < u; h++) {
                    var f = o[h];
                    this._customUniformParamsMap[f.dataOffset] = f
                }
                var m = this._shaderPass._stateMap;
                for (var p in m) this._stateParamsMap[m[p]] = Pt.propertyNameToID(p)
            }, e._getRenderState = function (t, e) {
                var n = this._stateParamsMap[e];
                return null == n ? null : t[n]
            }, e._disposeResource = function () {
                E.instance.deleteShader(this._vshader), E.instance.deleteShader(this._pshader), E.instance.deleteProgram(this._program), this._vshader = this._pshader = this._program = null, this._setGPUMemory(0), this._curActTexIndex = 0
            }, e._addShaderUnifiormFun = function (t) {
                var e = E.instance;
                t.caller = this;
                var n = t.isArray;
                switch (t.type) {
                    case 35670:
                        t.fun = this._uniform1i, t.uploadedValue = new Array(1);
                        break;
                    case 5124:
                        t.fun = n ? this._uniform1iv : this._uniform1i, t.uploadedValue = new Array(1);
                        break;
                    case 5126:
                        t.fun = n ? this._uniform1fv : this._uniform1f, t.uploadedValue = new Array(1);
                        break;
                    case 35664:
                        t.fun = n ? this._uniform_vec2v : this._uniform_vec2, t.uploadedValue = new Array(2);
                        break;
                    case 35665:
                        t.fun = n ? this._uniform_vec3v : this._uniform_vec3, t.uploadedValue = new Array(3);
                        break;
                    case 35666:
                        t.fun = n ? this._uniform_vec4v : this._uniform_vec4, t.uploadedValue = new Array(4);
                        break;
                    case 35674:
                        t.fun = this._uniformMatrix2fv;
                        break;
                    case 35675:
                        t.fun = this._uniformMatrix3fv;
                        break;
                    case 35676:
                        t.fun = n ? this._uniformMatrix4fv : this._uniformMatrix4f;
                        break;
                    case 35678:
                        e.uniform1i(t.location, this._curActTexIndex), t.textureID = V._glTextureIDs[this._curActTexIndex++], t.fun = this._uniform_sampler2D;
                        break;
                    case 35679:
                        e.uniform1i(t.location, this._curActTexIndex), t.textureID = V._glTextureIDs[this._curActTexIndex++], t.fun = this._uniform_sampler3D;
                        break;
                    case 35680:
                        e.uniform1i(t.location, this._curActTexIndex), t.textureID = V._glTextureIDs[this._curActTexIndex++], t.fun = this._uniform_samplerCube;
                        break;
                    default:
                        throw new Error("compile shader err!")
                }
            }, e._createShader = function (t, e, n) {
                var i = t.createShader(n);
                if (t.shaderSource(i, e), t.compileShader(i), Pt.debugMode && !t.getShaderParameter(i, 35713)) throw t.getShaderInfoLog(i);
                return i
            }, e._uniform1f = function (t, e) {
                var n = t.uploadedValue;
                return n[0] !== e ? (E.instance.uniform1f(t.location, n[0] = e), 1) : 0
            }, e._uniform1fv = function (t, e) {
                if (e.length < 4) {
                    var n = t.uploadedValue;
                    return n[0] !== e[0] || n[1] !== e[1] || n[2] !== e[2] || n[3] !== e[3] ? (E.instance.uniform1fv(t.location, e), n[0] = e[0], n[1] = e[1], n[2] = e[2], n[3] = e[3], 1) : 0
                }
                return E.instance.uniform1fv(t.location, e), 1
            }, e._uniform_vec2 = function (t, e) {
                var n = t.uploadedValue;
                return n[0] !== e.x || n[1] !== e.y ? (E.instance.uniform2f(t.location, n[0] = e.x, n[1] = e.y), 1) : 0
            }, e._uniform_vec2v = function (t, e) {
                if (e.length < 2) {
                    var n = t.uploadedValue;
                    return n[0] !== e[0] || n[1] !== e[1] || n[2] !== e[2] || n[3] !== e[3] ? (E.instance.uniform2fv(t.location, e), n[0] = e[0], n[1] = e[1], n[2] = e[2], n[3] = e[3], 1) : 0
                }
                return E.instance.uniform2fv(t.location, e), 1
            }, e._uniform_vec3 = function (t, e) {
                var n = t.uploadedValue;
                return n[0] !== e.x || n[1] !== e.y || n[2] !== e.z ? (E.instance.uniform3f(t.location, n[0] = e.x, n[1] = e.y, n[2] = e.z), 1) : 0
            }, e._uniform_vec3v = function (t, e) {
                return E.instance.uniform3fv(t.location, e), 1
            }, e._uniform_vec4 = function (t, e) {
                var n = t.uploadedValue;
                return n[0] !== e.x || n[1] !== e.y || n[2] !== e.z || n[3] !== e.w ? (E.instance.uniform4f(t.location, n[0] = e.x, n[1] = e.y, n[2] = e.z, n[3] = e.w), 1) : 0
            }, e._uniform_vec4v = function (t, e) {
                return E.instance.uniform4fv(t.location, e), 1
            }, e._uniformMatrix2fv = function (t, e) {
                return E.instance.uniformMatrix2fv(t.location, !1, e), 1
            }, e._uniformMatrix3fv = function (t, e) {
                return E.instance.uniformMatrix3fv(t.location, !1, e), 1
            }, e._uniformMatrix4f = function (t, e) {
                var n = e.elements;
                return E.instance.uniformMatrix4fv(t.location, !1, n), 1
            }, e._uniformMatrix4fv = function (t, e) {
                return E.instance.uniformMatrix4fv(t.location, !1, e), 1
            }, e._uniform1i = function (t, e) {
                var n = t.uploadedValue;
                return n[0] !== e ? (E.instance.uniform1i(t.location, n[0] = e), 1) : 0
            }, e._uniform1iv = function (t, e) {
                return E.instance.uniform1iv(t.location, e), 1
            }, e._uniform_ivec2 = function (t, e) {
                var n = t.uploadedValue;
                return n[0] !== e[0] || n[1] !== e[1] ? (E.instance.uniform2i(t.location, n[0] = e[0], n[1] = e[1]), 1) : 0
            }, e._uniform_ivec2v = function (t, e) {
                return E.instance.uniform2iv(t.location, e), 1
            }, e._uniform_vec3i = function (t, e) {
                var n = t.uploadedValue;
                return n[0] !== e[0] || n[1] !== e[1] || n[2] !== e[2] ? (E.instance.uniform3i(t.location, n[0] = e[0], n[1] = e[1], n[2] = e[2]), 1) : 0
            }, e._uniform_vec3vi = function (t, e) {
                return E.instance.uniform3iv(t.location, e), 1
            }, e._uniform_vec4i = function (t, e) {
                var n = t.uploadedValue;
                return n[0] !== e[0] || n[1] !== e[1] || n[2] !== e[2] || n[3] !== e[3] ? (E.instance.uniform4i(t.location, n[0] = e[0], n[1] = e[1], n[2] = e[2], n[3] = e[3]), 1) : 0
            }, e._uniform_vec4vi = function (t, e) {
                return E.instance.uniform4iv(t.location, e), 1
            }, e._uniform_sampler2D = function (t, e) {
                var n = e._getSource() || e.defaulteTexture._getSource(), i = E.instance;
                return V.activeTexture(i, t.textureID), V.bindTexture(i, 3553, n), 0
            }, e._uniform_sampler3D = function (t, e) {
                var n = e._getSource() || e.defaulteTexture._getSource(), i = E.instance;
                return V.activeTexture(i, t.textureID), V.bindTexture(i, 32879, n), 0
            }, e._uniform_samplerCube = function (t, e) {
                var n = e._getSource() || e.defaulteTexture._getSource(), i = E.instance;
                return V.activeTexture(i, t.textureID), V.bindTexture(i, 34067, n), 0
            }, e.bind = function () {
                return V.useProgram(E.instance, this._program)
            }, e.uploadUniforms = function (t, e, n) {
                C.shaderCall += v.uploadShaderUniforms(E.instance, t, e, n)
            }, e.uploadRenderStateBlendDepth = function (t) {
                var e = E.instance, n = this._shaderPass.renderState, i = t.getData(), r = this._getRenderState(i, 13),
                    a = this._getRenderState(i, 12), o = this._getRenderState(i, 1);
                switch (null == r && (r = n.depthWrite), null == a && (a = n.depthTest), null == o && (o = n.blend), V.setDepthMask(e, r), 0 === a ? V.setDepthTest(e, !1) : (V.setDepthTest(e, !0), V.setDepthFunc(e, a)), o) {
                    case 0:
                        V.setBlend(e, !1);
                        break;
                    case 1:
                        V.setBlend(e, !0);
                        var s = this._getRenderState(i, 2);
                        null == s && (s = n.srcBlend);
                        var l = this._getRenderState(i, 3);
                        null == l && (l = n.dstBlend), V.setBlendFunc(e, s, l);
                        break;
                    case 2:
                        V.setBlend(e, !0);
                        var h = this._getRenderState(i, 4);
                        null == h && (h = n.srcBlendRGB);
                        var u = this._getRenderState(i, 5);
                        null == u && (u = n.dstBlendRGB);
                        var c = this._getRenderState(i, 6);
                        null == c && (c = n.srcBlendAlpha);
                        var _ = this._getRenderState(i, 7);
                        null == _ && (_ = n.dstBlendAlpha), V.setBlendFuncSeperate(e, h, u, c, _)
                }
            }, e.uploadRenderStateFrontFace = function (t, e, n) {
                var i = E.instance, r = this._shaderPass.renderState, a = t.getData(), o = this._getRenderState(a, 0);
                null == o && (o = r.cull);
                var s = 0;
                switch (o) {
                    case 0:
                        V.setCullFace(i, !1);
                        break;
                    case 1:
                        V.setCullFace(i, !0), s = e ? n && n._isFrontFaceInvert ? 2305 : 2304 : n && n._isFrontFaceInvert ? 2304 : 2305, V.setFrontFace(i, s);
                        break;
                    case 2:
                        V.setCullFace(i, !0), s = e ? n && n._isFrontFaceInvert ? 2304 : 2305 : n && n._isFrontFaceInvert ? 2305 : 2304, V.setFrontFace(i, s)
                }
            }, e.uploadCustomUniform = function (t, e) {
                C.shaderCall += v.uploadCustomUniform(E.instance, this._customUniformParamsMap, t, e)
            }, e._uniformMatrix2fvForNative = function (t, e) {
                return E.instance.uniformMatrix2fvEx(t.location, !1, e), 1
            }, e._uniformMatrix3fvForNative = function (t, e) {
                return E.instance.uniformMatrix3fvEx(t.location, !1, e), 1
            }, e._uniformMatrix4fvForNative = function (t, e) {
                return E.instance.uniformMatrix4fvEx(t.location, !1, e), 1
            }, a
        }(), Wn = (function (t) {
            function r() {
                this._version = NaN, this._cameraCoordinateInverse = !1, this._gridSize = NaN, this._chunkNumX = 0, this._chunkNumZ = 0, this._heightDataX = 0, this._heightDataZ = 0, this._heightDataBitType = 0, this._heightDataValue = NaN, this._heightDataUrl = null, this._detailTextureInfos = null, this._chunkInfos = null, this._heightData = null, this._materialInfo = null, this._alphaMaps = null, this._normalMaps = null, r.__super.call(this)
            }

            d(r, "laya.d3.terrain.TerrainRes", D);
            var e = r.prototype;
            e.parseData = function (t) {
                var e = t[0], n = t[1];
                if (this._version = e.version, 1 == this._version) {
                    this._cameraCoordinateInverse = e.cameraCoordinateInverse, this._gridSize = e.gridSize, this._chunkNumX = e.chunkNumX, this._chunkNumZ = e.chunkNumZ;
                    var i = e.heightData;
                    if (this._heightDataX = i.numX, this._heightDataZ = i.numZ, this._heightDataBitType = i.bitType, this._heightDataValue = i.value, this._heightDataUrl = n[i.url], this._materialInfo = new it, e.material) {
                        var r = e.material.ambient, a = e.material.diffuse, o = e.material.specular;
                        this._materialInfo.ambientColor = new Lt(r[0], r[1], r[2]), this._materialInfo.diffuseColor = new Lt(a[0], a[1], a[2]), this._materialInfo.specularColor = new Ct(o[0], o[1], o[2], o[3])
                    }
                    var s = e.detailTexture;
                    this._detailTextureInfos = w(s.length);
                    for (var l = 0; l < s.length; l++) {
                        var h = s[l], u = new Ae;
                        u.diffuseTexture = n[h.diffuse], u.normalTexture = h.normal ? n[h.normal] : null, h.scale ? u.scale = new Ot(h.scale[0], h.scale[1]) : u.scale = new Ot(1, 1), h.offset ? u.offset = new Ot(h.offset[0], h.offset[1]) : u.offset = new Ot(0, 0), this._detailTextureInfos[l] = u
                    }
                    var c = e.alphaMap;
                    for (this._alphaMaps = w(c.length), l = 0; l < this._alphaMaps.length; l++) this._alphaMaps[l] = e.alphaMap[l];
                    var _ = e.normalMap;
                    for (this._normalMaps = w(_.length), l = 0; l < this._normalMaps.length; l++) this._normalMaps[l] = e.normalMap[l];
                    var d = e.chunkInfo;
                    if (this._chunkNumX * this._chunkNumZ != d.length) return alert("terrain data error"), !1;
                    for (this._chunkInfos = w(d.length), l = 0; l < d.length; l++) {
                        var f = d[l], m = new ve, p = f.alphaMap.length, T = f.detailID.length;
                        if (p != T) return alert("terrain chunk data error"), !1;
                        m.alphaMap = w(p), m.detailID = w(T), m.normalMap = n[this._normalMaps[f.normalMap]];
                        for (var E = 0; E < p; E++) {
                            m.alphaMap[E] = n[this._alphaMaps[f.alphaMap[E]]];
                            var v = f.detailID[E], g = v.length;
                            m.detailID[E] = new Uint8Array(g);
                            for (var S = 0; S < g; S++) m.detailID[E][S] = v[S]
                        }
                        this._chunkInfos[l] = m
                    }
                    this._heightData = Dt.getRes(this._heightDataUrl), this.onLoadTerrainComplete(this._heightData)
                }
                return !0
            }, e.onLoadTerrainComplete = function (t) {
            }, r._parse = function (t, e, n) {
                var i = new r;
                return i.parseData(t), i
            }, r.load = function (t, e) {
                m.loader.create(t, e, null, "TERRAIN", null, null, 1, !1)
            }
        }(), function (t) {
            function e(t) {
                this._finalGravity = new Lt, this._tempRotationMatrix = new He, e.__super.call(this, t), this._defaultBoundBox = new ze(new Lt, new Lt), this._renderMode = -1, this.stretchedBillboardCameraSpeedScale = 0, this.stretchedBillboardSpeedScale = 0, this.stretchedBillboardLengthScale = 1
            }

            d(e, "laya.d3.core.particleShuriKen.ShurikenParticleRenderer", t);
            var n = e.prototype;
            return n._calculateBoundingBox = function () {
                var t = this._bounds.getMin();
                t.x = -Number.MAX_VALUE, t.y = -Number.MAX_VALUE, t.z = -Number.MAX_VALUE, this._bounds.setMin(t);
                var e = this._bounds.getMax();
                if (e.x = Number.MAX_VALUE, e.y = Number.MAX_VALUE, e.z = Number.MAX_VALUE, this._bounds.setMax(e), b.supportWebGLPlusCulling) {
                    t = this._bounds.getMin(), e = this._bounds.getMax();
                    var n = we._cullingBuffer;
                    n[this._cullingBufferIndex + 1] = t.x, n[this._cullingBufferIndex + 2] = t.y, n[this._cullingBufferIndex + 3] = t.z, n[this._cullingBufferIndex + 4] = e.x, n[this._cullingBufferIndex + 5] = e.y, n[this._cullingBufferIndex + 6] = e.z
                }
            }, n._needRender = function (t) {
                return !t || 0 !== t.containsBoundBox(this.bounds._getBoundBox()) && !!this._owner.particleSystem.isAlive
            }, n._renderUpdate = function (t, e) {
                var n = this._owner.particleSystem, i = this._shaderValues, r = this._owner.transform;
                switch (n.simulationSpace) {
                    case 0:
                        break;
                    case 1:
                        i.setVector3(yi.WORLDPOSITION, r.position), i.setQuaternion(yi.WORLDROTATION, r.rotation);
                        break;
                    default:
                        throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.")
                }
                switch (n.scaleMode) {
                    case 0:
                        var a = r.scale;
                        i.setVector3(yi.POSITIONSCALE, a), i.setVector3(yi.SIZESCALE, a);
                        break;
                    case 1:
                        var o = r.localScale;
                        i.setVector3(yi.POSITIONSCALE, o), i.setVector3(yi.SIZESCALE, o);
                        break;
                    case 2:
                        i.setVector3(yi.POSITIONSCALE, r.scale), i.setVector3(yi.SIZESCALE, Lt._ONE)
                }
                Lt.scale(Ue.gravity, n.gravityModifier, this._finalGravity), i.setVector3(yi.GRAVITY, this._finalGravity), i.setInt(yi.SIMULATIONSPACE, n.simulationSpace), i.setBool(yi.THREEDSTARTROTATION, n.threeDStartRotation), i.setInt(yi.SCALINGMODE, n.scaleMode), i.setNumber(yi.STRETCHEDBILLBOARDLENGTHSCALE, this.stretchedBillboardLengthScale), i.setNumber(yi.STRETCHEDBILLBOARDSPEEDSCALE, this.stretchedBillboardSpeedScale), i.setNumber(yi.CURRENTTIME, n._currentTime)
            }, n._destroy = function () {
                t.prototype._destroy.call(this), this._mesh && (this._mesh._removeReference(), this._mesh = null)
            }, u(0, n, "renderMode", function () {
                return this._renderMode
            }, function (t) {
                if (this._renderMode !== t) {
                    var e = this._defineDatas;
                    switch (this._renderMode) {
                        case 0:
                            e.remove(yi.SHADERDEFINE_RENDERMODE_BILLBOARD);
                            break;
                        case 1:
                            e.remove(yi.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD);
                            break;
                        case 2:
                            e.remove(yi.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD);
                            break;
                        case 3:
                            e.remove(yi.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD);
                            break;
                        case 4:
                            e.remove(yi.SHADERDEFINE_RENDERMODE_MESH)
                    }
                    switch (this._renderMode = t) {
                        case 0:
                            e.add(yi.SHADERDEFINE_RENDERMODE_BILLBOARD);
                            break;
                        case 1:
                            e.add(yi.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD);
                            break;
                        case 2:
                            e.add(yi.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD);
                            break;
                        case 3:
                            e.add(yi.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD);
                            break;
                        case 4:
                            e.add(yi.SHADERDEFINE_RENDERMODE_MESH);
                            break;
                        default:
                            throw new Error("ShurikenParticleRender: unknown renderMode Value.")
                    }
                    this._owner.particleSystem._initBufferDatas()
                }
            }), u(0, n, "mesh", function () {
                return this._mesh
            }, function (t) {
                this._mesh !== t && (this._mesh && this._mesh._removeReference(), (this._mesh = t) && t._addReference(), this._owner.particleSystem._initBufferDatas())
            }), u(0, n, "bounds", function () {
                return this._boundsChange && (this._calculateBoundingBox(), this._boundsChange = !1), this._bounds
            }), e
        }(We)), Yn = function (e) {
            function n(t, e) {
                this._isTrigger = !1, n.__super.call(this, t, e)
            }

            d(n, "laya.d3.physics.PhysicsTriggerComponent", e);
            var t = n.prototype;
            return t._onAdded = function () {
                e.prototype._onAdded.call(this), this.isTrigger = this._isTrigger
            }, t._cloneTo = function (t) {
                e.prototype._cloneTo.call(this, t), t.isTrigger = this._isTrigger
            }, u(0, t, "isTrigger", function () {
                return this._isTrigger
            }, function (t) {
                if (this._isTrigger = t, this._nativeColliderObject) {
                    var e = this._nativeColliderObject.getCollisionFlags();
                    t ? 0 == (4 & e) && this._nativeColliderObject.setCollisionFlags(4 | e) : 0 != (4 & e) && this._nativeColliderObject.setCollisionFlags(4 ^ e)
                }
            }), n
        }(Xe), Zn = (function (n) {
            function r(t, e, n, i) {
                this._maxSlope = 45, this._jumpSpeed = 10, this._fallSpeed = 55, this._upAxis = new Lt(0, 1, 0), this._gravity = new Lt(0, 3 * -9.8, 0), void 0 === t && (t = .1), void 0 === n && (n = 1), void 0 === i && (i = Ue.COLLISIONFILTERGROUP_ALLFILTER), this._stepHeight = t, e && (this._upAxis = e), r.__super.call(this, n, i)
            }

            d(r, "laya.d3.physics.CharacterController", n);
            var t = r.prototype;
            t._constructCharacter = function () {
                var t = k._physics3D;
                this._nativeKinematicCharacter && t.destroy(this._nativeKinematicCharacter);
                var e = r._nativeTempVector30;
                e.setValue(this._upAxis.x, this._upAxis.y, this._upAxis.z), this._nativeKinematicCharacter = new t.btKinematicCharacterController(this._nativeColliderObject, this._colliderShape._nativeShape, this._stepHeight, e), this.fallSpeed = this._fallSpeed, this.maxSlope = this._maxSlope, this.jumpSpeed = this._jumpSpeed, this.gravity = this._gravity
            }, t._onShapeChange = function (t) {
                n.prototype._onShapeChange.call(this, t), this._constructCharacter()
            }, t._onAdded = function () {
                var t = new k._physics3D.btPairCachingGhostObject;
                t.setUserIndex(this.id), t.setCollisionFlags(16), this._nativeColliderObject = t, this._colliderShape && this._constructCharacter(), n.prototype._onAdded.call(this)
            }, t._addToSimulation = function () {
                this._simulation._characters.push(this), this._simulation._addCharacter(this, this._collisionGroup, this._canCollideWith)
            }, t._removeFromSimulation = function () {
                this._simulation._removeCharacter(this);
                var t = this._simulation._characters;
                t.splice(t.indexOf(this), 1)
            }, t._cloneTo = function (t) {
                n.prototype._cloneTo.call(this, t);
                var e = t;
                e.stepHeight = this._stepHeight, e.upAxis = this._upAxis, e.maxSlope = this._maxSlope, e.jumpSpeed = this._jumpSpeed, e.fallSpeed = this._fallSpeed, e.gravity = this._gravity
            }, t._onDestroy = function () {
                k._physics3D.destroy(this._nativeKinematicCharacter), n.prototype._onDestroy.call(this), this._nativeKinematicCharacter = null
            }, t.move = function (t) {
                var e = Xe._nativeVector30;
                e.setValue(-t.x, t.y, t.z), this._nativeKinematicCharacter.setWalkDirection(e)
            }, t.jump = function (t) {
                if (t) {
                    var e = Xe._nativeVector30;
                    kt._convertToBulletVec3(t, e, !0), this._nativeKinematicCharacter.jump(e)
                } else this._nativeKinematicCharacter.jump()
            }, u(0, t, "fallSpeed", function () {
                return this._fallSpeed
            }, function (t) {
                this._fallSpeed = t, this._nativeKinematicCharacter.setFallSpeed(t)
            }), u(0, t, "stepHeight", function () {
                return this._stepHeight
            }, function (t) {
                this._stepHeight = t, this._constructCharacter()
            }), u(0, t, "jumpSpeed", function () {
                return this._jumpSpeed
            }, function (t) {
                this._jumpSpeed = t, this._nativeKinematicCharacter.setJumpSpeed(t)
            }), u(0, t, "gravity", function () {
                return this._gravity
            }, function (t) {
                this._gravity = t;
                var e = r._nativeTempVector30;
                e.setValue(-t.x, t.y, t.z), this._nativeKinematicCharacter.setGravity(e)
            }), u(0, t, "maxSlope", function () {
                return this._maxSlope
            }, function (t) {
                this._maxSlope = t, this._nativeKinematicCharacter.setMaxSlope(t / 180 * Math.PI)
            }), u(0, t, "isGrounded", function () {
                return this._nativeKinematicCharacter.onGround()
            }), u(0, t, "upAxis", function () {
                return this._upAxis
            }, function (t) {
                this._upAxis = t, this._constructCharacter()
            }), r.UPAXIS_X = 0, r.UPAXIS_Y = 1, r.UPAXIS_Z = 2, _(r, ["_nativeTempVector30", function () {
                return this._nativeTempVector30 = new k._physics3D.btVector3(0, 0, 0)
            }])
        }(Xe), function (t) {
            function e(t) {
                this._terrainSprite3DOwner = null, this._projectionViewWorldMatrix = null, e.__super.call(this, t), this._terrainSprite3DOwner = t, this._projectionViewWorldMatrix = new He
            }

            d(e, "laya.d3.terrain.TerrainRender", t);
            var n = e.prototype;
            return n._needRender = function (t) {
                return !t || 0 !== t.containsBoundBox(this._bounds._getBoundBox())
            }, n._calculateBoundingBox = function () {
            }, n._renderUpdate = function (t, e) {
                this._shaderValues.setMatrix4x4(Fn.WORLDMATRIX, e.worldMatrix)
            }, n._renderUpdateWithCamera = function (t, e) {
                var n = t.projectionViewMatrix;
                He.multiply(n, e.worldMatrix, this._projectionViewWorldMatrix), this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, this._projectionViewWorldMatrix)
            }, n._destroy = function () {
                t.prototype._destroy.call(this), this._terrainSprite3DOwner = null
            }, e
        }(We)), jn = function (t) {
            function e(t) {
                e.__super.call(this, t), this._projectionViewWorldMatrix = new He
            }

            d(e, "laya.d3.core.MeshRenderer", t);
            var n = e.prototype;
            return n._onMeshChange = function (t) {
                this._boundsChange = !0
            }, n._calculateBoundingBox = function () {
                var t = this._owner.meshFilter.sharedMesh;
                if (t) {
                    var e = this._owner.transform.worldMatrix;
                    t.bounds._tranform(e, this._bounds)
                }
                if (b.supportWebGLPlusCulling) {
                    var n = this._bounds.getMin(), i = this._bounds.getMax(), r = we._cullingBuffer;
                    r[this._cullingBufferIndex + 1] = n.x, r[this._cullingBufferIndex + 2] = n.y, r[this._cullingBufferIndex + 3] = n.z, r[this._cullingBufferIndex + 4] = i.x, r[this._cullingBufferIndex + 5] = i.y, r[this._cullingBufferIndex + 6] = i.z
                }
            }, n._changeRenderObjectsByMesh = function (t) {
                var e = t.subMeshCount;
                this._renderElements.length = e;
                for (var n = 0; n < e; n++) {
                    var i = this._renderElements[n];
                    if (!i) {
                        var r = this.sharedMaterials[n];
                        (i = this._renderElements[n] = new Pn).setTransform(this._owner._transform), i.render = this, i.material = r || ci.defaultMaterial
                    }
                    i.setGeometry(t._getSubMesh(n))
                }
            }, n._needRender = function (t) {
                return !t || 0 !== t.containsBoundBox(this.bounds._getBoundBox())
            }, n._renderUpdate = function (t, e) {
                var n = t.renderElement;
                switch (n.renderType) {
                    case 0:
                        this._shaderValues.setMatrix4x4(Fn.WORLDMATRIX, e.worldMatrix);
                        break;
                    case 1:
                        this._oriDefineValue = this._defineDatas.value, e ? this._shaderValues.setMatrix4x4(Fn.WORLDMATRIX, e.worldMatrix) : this._shaderValues.setMatrix4x4(Fn.WORLDMATRIX, He.DEFAULT), this._defineDatas.add(Ei.SHADERDEFINE_UV1), this._defineDatas.remove(Jn.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV);
                        break;
                    case 3:
                        this._shaderValues.setMatrix4x4(Fn.WORLDMATRIX, He.DEFAULT);
                        break;
                    case 2:
                        for (var i = En.instance.instanceWorldMatrixData, r = n.instanceBatchElementList, a = r.length, o = 0; o < a; o++) i.set(r[o]._transform.worldMatrix.elements, 16 * o);
                        En.instance.instanceWorldMatrixBuffer.setData(i, 0, 0, 16 * a), this._defineDatas.add(Ei.SHADERDEFINE_GPU_INSTANCE)
                }
            }, n._renderUpdateWithCamera = function (t, e) {
                var n = t.projectionViewMatrix, i = t.renderElement;
                switch (i.renderType) {
                    case 0:
                    case 1:
                    case 3:
                        e ? (He.multiply(n, e.worldMatrix, this._projectionViewWorldMatrix), this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, this._projectionViewWorldMatrix)) : this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, n);
                        break;
                    case 2:
                        for (var r = En.instance.instanceMVPMatrixData, a = i.instanceBatchElementList, o = a.length, s = 0; s < o; s++) {
                            var l = a[s]._transform.worldMatrix;
                            kt.mulMatrixByArray(n.elements, 0, l.elements, 0, r, 16 * s)
                        }
                        En.instance.instanceMVPMatrixBuffer.setData(r, 0, 0, 16 * o)
                }
            }, n._renderUpdateWithCameraForNative = function (t, e) {
                var n = t.projectionViewMatrix, i = t.renderElement;
                switch (i.renderType) {
                    case 0:
                        e ? (He.multiply(n, e.worldMatrix, this._projectionViewWorldMatrix), this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, this._projectionViewWorldMatrix)) : this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, n);
                        break;
                    case 1:
                    case 3:
                        var r = ot._SET_RUNTIME_VALUE_MODE_REFERENCE_;
                        ot.setRuntimeValueMode(!1), e ? (He.multiply(n, e.worldMatrix, this._projectionViewWorldMatrix), this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, this._projectionViewWorldMatrix)) : this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, n), ot.setRuntimeValueMode(r);
                        break;
                    case 2:
                        for (var a = En.instance.instanceMVPMatrixData, o = i.instanceBatchElementList, s = o.length, l = 0; l < s; l++) {
                            var h = o[l]._transform.worldMatrix;
                            kt.mulMatrixByArray(n.elements, 0, h.elements, 0, a, 16 * l)
                        }
                        En.instance.instanceMVPMatrixBuffer.setData(a, 0, 0, 16 * s)
                }
            }, n._revertBatchRenderUpdate = function (t) {
                switch (t.renderElement.renderType) {
                    case 1:
                        this._defineDatas.value = this._oriDefineValue;
                        break;
                    case 2:
                        this._defineDatas.remove(Ei.SHADERDEFINE_GPU_INSTANCE)
                }
            }, n._destroy = function () {
                this._isPartOfStaticBatch && Sn.instance._destroyRenderSprite(this._owner), t.prototype._destroy.call(this)
            }, _(e, ["_tempVector30", function () {
                return this._tempVector30 = new Lt
            }, "_tempVector31", function () {
                return this._tempVector31 = new Lt
            }]), e
        }(We), Kn = function (n) {
            function e(t) {
                this._projectionViewWorldMatrix = new He, e.__super.call(this, t)
            }

            d(e, "laya.d3.core.trail.TrailRenderer", n);
            var t = e.prototype;
            return t._calculateBoundingBox = function () {
                var t = this._bounds.getMin();
                t.x = -Number.MAX_VALUE, t.y = -Number.MAX_VALUE, t.z = -Number.MAX_VALUE, this._bounds.setMin(t);
                var e = this._bounds.getMax();
                if (e.x = Number.MAX_VALUE, e.y = Number.MAX_VALUE, e.z = Number.MAX_VALUE, this._bounds.setMax(e), b.supportWebGLPlusCulling) {
                    t = this._bounds.getMin(), e = this._bounds.getMax();
                    var n = we._cullingBuffer;
                    n[this._cullingBufferIndex + 1] = t.x, n[this._cullingBufferIndex + 2] = t.y, n[this._cullingBufferIndex + 3] = t.z, n[this._cullingBufferIndex + 4] = e.x, n[this._cullingBufferIndex + 5] = e.y, n[this._cullingBufferIndex + 6] = e.z
                }
            }, t._needRender = function (t) {
                return !0
            }, t._renderUpdate = function (t, e) {
                n.prototype._renderUpdate.call(this, t, e), this._owner.trailFilter._update(t)
            }, t._renderUpdateWithCamera = function (t, e) {
                var n = t.projectionViewMatrix;
                e ? (He.multiply(n, e.worldMatrix, this._projectionViewWorldMatrix), this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, this._projectionViewWorldMatrix)) : this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, n)
            }, e
        }(We), qn = function (t) {
            function e(t) {
                this._projectionViewWorldMatrix = null, e.__super.call(this, t), this._projectionViewWorldMatrix = new He
            }

            d(e, "laya.d3.core.pixelLine.PixelLineRenderer", We);
            var n = e.prototype;
            return n._calculateBoundingBox = function () {
                var t = this._bounds.getMin();
                t.x = -Number.MAX_VALUE, t.y = -Number.MAX_VALUE, t.z = -Number.MAX_VALUE, this._bounds.setMin(t);
                var e = this._bounds.getMax();
                if (e.x = Number.MAX_VALUE, e.y = Number.MAX_VALUE, e.z = Number.MAX_VALUE, this._bounds.setMax(e), b.supportWebGLPlusCulling) {
                    t = this._bounds.getMin(), e = this._bounds.getMax();
                    var n = we._cullingBuffer;
                    n[this._cullingBufferIndex + 1] = t.x, n[this._cullingBufferIndex + 2] = t.y, n[this._cullingBufferIndex + 3] = t.z, n[this._cullingBufferIndex + 4] = e.x, n[this._cullingBufferIndex + 5] = e.y, n[this._cullingBufferIndex + 6] = e.z
                }
            }, n._renderUpdateWithCamera = function (t, e) {
                var n = t.projectionViewMatrix, i = this._shaderValues;
                if (e) {
                    var r = e.worldMatrix;
                    i.setMatrix4x4(Fn.WORLDMATRIX, r), He.multiply(n, r, this._projectionViewWorldMatrix), i.setMatrix4x4(Fn.MVPMATRIX, this._projectionViewWorldMatrix)
                } else i.setMatrix4x4(Fn.WORLDMATRIX, He.DEFAULT), i.setMatrix4x4(Fn.MVPMATRIX, n)
            }, e
        }(), Qn = function (e) {
            function n() {
                this._reflectionMode = 1, this._enableLightCount = 3, this.enableLight = !0, this._time = 0, n.__super.call(this), this._lights = [], this._lightmaps = [], this._skyRenderer = new me, this._input = new Zt, this._timer = m.timer, this._collsionTestList = [], this._renders = new un, this._opaqueQueue = new Ce(!1), this._transparentQueue = new Ce(!0), this._cameraPool = [], this._animatorPool = new un, this._scriptPool = new un, this._castShadowRenders = new rn, this.currentCreationLayer = Math.pow(2, 0), this._key = new L, this._pickIdToSprite = new Object, k._enbalePhysics && (this._physicsSimulation = new ke(k.physicsSettings)), this._defineDatas = new Ut, this._shaderValues = new ot(null), this.parallelSplitShadowMaps = [], this.enableFog = !1, this.fogStart = 300, this.fogRange = 1e3, this.fogColor = new Lt(.7, .7, .7), this.ambientColor = new Lt(.212, .227, .259), this.reflectionIntensity = 1, N.shaderHighPrecision && this._defineDatas.add(Pt.SHADERDEFINE_HIGHPRECISION), b.supportWebGLPlusCulling && (this._cullingBufferIndices = new Int32Array(1024), this._cullingBufferResult = new Int32Array(1024)), this._shaderValues.setTexture(laya.d3.core.scene.Scene3D.RANGEATTENUATIONTEXTURE, Ht._rangeAttenTex), this._scene = this, k._enbalePhysics && !ke.disableSimulation && this._input.__init__(b.canvas, this);
                var t = k._config;
                if (t.octreeCulling && (this._octree = new Jt(t.octreeInitialSize, t.octreeInitialCenter, t.octreeMinNodeSize, t.octreeLooseness)), k._config.debugFrustumCulling) {
                    this._debugTool = new xi;
                    var e = new ri;
                    e.renderQueue = 3e3, e.alphaTest = !1, e.depthWrite = !1, e.cull = 2, e.blend = 1, e.blendSrc = 770, e.blendDst = 771, e.depthTest = 513, this._debugTool.pixelLineRenderer.sharedMaterial = e
                }
            }

            d(n, "laya.d3.core.scene.Scene3D", e);
            var t = n.prototype;
            return m.imps(t, {
                "laya.webgl.submit.ISubmit": !0,
                "laya.resource.ICreateResource": !0
            }), t._allotPickColorByID = function (t, e) {
                var n = Math.floor(t / 65025);
                t -= 255 * n * 255;
                var i = Math.floor(t / 255), r = t -= 255 * i;
                e.x = n / 255, e.y = i / 255, e.z = r / 255, e.w = 1
            }, t._searchIDByPickColor = function (t) {
                return 255 * t.x * 255 + 255 * t.y + t.z
            }, t._setLightmapToChildNode = function (t) {
                t instanceof laya.d3.core.RenderableSprite3D && t._render._applyLightMapParams();
                for (var e = t._children, n = 0, i = e.length; n < i; n++) this._setLightmapToChildNode(e[n])
            }, t._update = function () {
                var t = this.timer._delta / 1e3;
                this._time += t, this._shaderValues.setNumber(laya.d3.core.scene.Scene3D.TIME, this._time);
                var e = this._physicsSimulation;
                k._enbalePhysics && !ke.disableSimulation && (e._updatePhysicsTransformFromRender(), Xe._addUpdateList = !1, e._simulate(t), e._updateCharacters(), Xe._addUpdateList = !0, e._updateCollisions(), e._eventScripts(), this._input._update()), this._updateScript(), Ze._update(this), this._lateUpdateScript()
            }, t._binarySearchIndexInCameraPool = function (t) {
                for (var e = 0, n = this._cameraPool.length - 1, i = 0; e <= n;) {
                    i = Math.floor((e + n) / 2);
                    var r = this._cameraPool[i]._renderingOrder;
                    if (r == t._renderingOrder) return i;
                    r > t._renderingOrder ? n = i - 1 : e = i + 1
                }
                return e
            }, t._setCreateURL = function (t) {
                this._url = O.formatURL(t)
            }, t._getGroup = function () {
                return this._group
            }, t._setGroup = function (t) {
                this._group = t
            }, t._updateScript = function () {
                for (var t = this._scriptPool, e = t.elements, n = 0, i = t.length; n < i; n++) {
                    var r = e[n];
                    r && r.enabled && r.onUpdate()
                }
            }, t._lateUpdateScript = function () {
                for (var t = this._scriptPool, e = t.elements, n = 0, i = t.length; n < i; n++) {
                    var r = e[n];
                    r && r.enabled && r.onLateUpdate()
                }
            }, t._preRenderScript = function () {
                for (var t = this._scriptPool, e = t.elements, n = 0, i = t.length; n < i; n++) {
                    var r = e[n];
                    r && r.enabled && r.onPreRender()
                }
            }, t._postRenderScript = function () {
                for (var t = this._scriptPool, e = t.elements, n = 0, i = t.length; n < i; n++) {
                    var r = e[n];
                    r && r.enabled && r.onPostRender()
                }
            }, t._prepareSceneToRender = function () {
                var t = this._lights.length;
                if (0 < t) for (var e = 0, n = 0; n < t && !(this._lights[n]._prepareToScene() && ++e >= this._enableLightCount); n++) ;
            }, t._addCamera = function (t) {
                for (var e = this._binarySearchIndexInCameraPool(t), n = t._renderingOrder, i = this._cameraPool.length; e < i && this._cameraPool[e]._renderingOrder <= n;) e++;
                this._cameraPool.splice(e, 0, t)
            }, t._removeCamera = function (t) {
                this._cameraPool.splice(this._cameraPool.indexOf(t), 1)
            }, t._preCulling = function (t, e) {
                we.renderObjectCulling(e, this, t, this._renders)
            }, t._clear = function (t, e) {
                var n = e.viewport, i = e.camera, r = i.getRenderTexture(), a = n.width, o = n.height, s = n.x,
                    l = i._getCanvasHeight() - n.y - o;
                t.viewport(s, l, a, o);
                var h = 0, u = i.clearFlag;
                switch (1 !== u || i.skyRenderer._isAvailable() || this._skyRenderer._isAvailable() || (u = 0), u) {
                    case 0:
                        var c = i.clearColor;
                        if (t.enable(3089), t.scissor(s, l, a, o), c ? t.clearColor(c.x, c.y, c.z, c.w) : t.clearColor(0, 0, 0, 0), r) switch (h = 16384, r.depthStencilFormat) {
                            case 0:
                                h |= 256;
                                break;
                            case 1:
                                h |= 1024;
                                break;
                            case 2:
                                h |= 256, h |= 1024
                        } else h = 16640;
                        V.setDepthMask(t, !0), t.clear(h), t.disable(3089);
                        break;
                    case 1:
                    case 2:
                        if (t.enable(3089), t.scissor(s, l, a, o), r) switch (r.depthStencilFormat) {
                            case 0:
                                h = 256;
                                break;
                            case 1:
                                h = 1024;
                                break;
                            case 2:
                                h = 1280
                        } else h = 256;
                        V.setDepthMask(t, !0), t.clear(h), t.disable(3089);
                        break;
                    case 3:
                        break;
                    default:
                        throw new Error("BaseScene:camera clearFlag invalid.")
                }
            }, t._renderScene = function (t, e, n, i) {
                var r = e.camera;
                r.transform.position;
                if (r.getRenderTexture() ? this._opaqueQueue._render(e, !0, n, i) : this._opaqueQueue._render(e, !1, n, i), 1 === r.clearFlag && (r.skyRenderer._isAvailable() ? r.skyRenderer._render(e) : this._skyRenderer._isAvailable() && this._skyRenderer._render(e)), r.getRenderTexture() ? this._transparentQueue._render(e, !0, n, i) : this._transparentQueue._render(e, !1, n, i), r._applyPostProcessCommandBuffers(), k._config.debugFrustumCulling) for (var a = this._debugTool._render._renderElements, o = 0, s = a.length; o < s; o++) a[o]._render(e, !1, n, i)
            }, t._parse = function (t, e) {
                var n = t.lightmaps;
                if (n) {
                    for (var i = n.length, r = w(i), a = 0; a < i; a++) r[a] = Dt.getRes(n[a].path);
                    this.setlightmaps(r)
                }
                var o = t.ambientColor;
                if (o) {
                    var s = this.ambientColor;
                    s.fromArray(o), this.ambientColor = s
                }
                var l = t.sky;
                if (l) switch (this._skyRenderer.material = Dt.getRes(l.material.path), l.mesh) {
                    case"SkyBox":
                        this._skyRenderer.mesh = xn.instance;
                        break;
                    case"SkyDome":
                        this._skyRenderer.mesh = Ln.instance;
                        break;
                    default:
                        this.skyRenderer.mesh = xn.instance
                }
                var h = t.reflectionTexture;
                h && (this.customReflection = Dt.getRes(h)), this.enableFog = t.enableFog, this.fogStart = t.fogStart, this.fogRange = t.fogRange;
                var u = t.fogColor;
                if (u) {
                    var c = this.fogColor;
                    c.fromArray(u), this.fogColor = c
                }
            }, t._onActive = function () {
                laya.display.Node.prototype._onActive.call(this), m.stage._scene3Ds.push(this)
            }, t._onInActive = function () {
                laya.display.Node.prototype._onInActive.call(this);
                var t = m.stage._scene3Ds;
                t.splice(t.indexOf(this), 1)
            }, t._addLight = function (t) {
                this._lights.indexOf(t) < 0 && this._lights.push(t)
            }, t._removeLight = function (t) {
                var e = this._lights.indexOf(t);
                0 <= e && this._lights.splice(e, 1)
            }, t._addRenderObject = function (t) {
                if (this._octree) this._octree.add(t); else if (this._renders.add(t), b.supportWebGLPlusCulling) {
                    var e = t._getIndexInList(), n = this._cullingBufferIndices.length;
                    if (n <= e) {
                        var i = this._cullingBufferIndices, r = this._cullingBufferResult;
                        this._cullingBufferIndices = new Int32Array(n + 1024), this._cullingBufferResult = new Int32Array(n + 1024), this._cullingBufferIndices.set(i, 0), this._cullingBufferResult.set(r, 0)
                    }
                    this._cullingBufferIndices[e] = t._cullingBufferIndex
                }
            }, t._removeRenderObject = function (t) {
                var e;
                this._octree ? this._octree.remove(t) : (b.supportWebGLPlusCulling && (e = this._renders.elements[this._renders.length - 1]), this._renders.remove(t), b.supportWebGLPlusCulling && (this._cullingBufferIndices[e._getIndexInList()] = e._cullingBufferIndex))
            }, t._addShadowCastRenderObject = function (t) {
                this._octree || this._castShadowRenders.add(t)
            }, t._removeShadowCastRenderObject = function (t) {
                this._octree || this._castShadowRenders.remove(t)
            }, t._getRenderQueue = function (t) {
                return t <= 2500 ? this._opaqueQueue : this._transparentQueue
            }, t.setlightmaps = function (t) {
                for (var e = this._lightmaps, n = 0, i = e.length; n < i; n++) e[n]._removeReference();
                if (!t) throw new Error("Scene3D: value value can't be null.");
                var r = t.length;
                for (e.length = r, n = 0; n < r; n++) {
                    var a = t[n];
                    a._addReference(), e[n] = a
                }
                for (n = 0, i = this._children.length; n < i; n++) this._setLightmapToChildNode(this._children[n])
            }, t.getlightmaps = function () {
                return this._lightmaps.slice()
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this.destroyed || (e.prototype.destroy.call(this, t), this._skyRenderer.destroy(), this._skyRenderer = null, this._lights = null, this._lightmaps = null, this._renderTargetTexture = null, this._shaderValues = null, this._renders = null, this._castShadowRenders = null, this._cameraPool = null, this._octree = null, this.parallelSplitShadowMaps = null, this._physicsSimulation && this._physicsSimulation._destroy(), Dt.clearRes(this.url))
            }, t.render = function (t, e, n) {
                t._curSubmit = A.RENDERBASE, 0 < this._children.length && t.addRenderObject(this)
            }, t.renderSubmit = function () {
                E.instance;
                this._prepareSceneToRender();
                var t, e, n = 0;
                for (n = 0, e = (t = this._cameraPool.length) - 1; n < t; n++) {
                    b.supportWebGLPlusRendering && ot.setRuntimeValueMode(n == e);
                    var i = this._cameraPool[n];
                    i.enableRender && i.render()
                }
                return h.set2DRenderConfig(), 1
            }, t.getRenderType = function () {
                return 0
            }, t.releaseRender = function () {
            }, t.reUse = function (t, e) {
                return 0
            }, u(0, t, "fogColor", function () {
                return this._shaderValues.getVector(laya.d3.core.scene.Scene3D.FOGCOLOR)
            }, function (t) {
                this._shaderValues.setVector3(laya.d3.core.scene.Scene3D.FOGCOLOR, t)
            }), u(0, t, "enableFog", function () {
                return this._enableFog
            }, function (t) {
                this._enableFog !== t && ((this._enableFog = t) ? this._defineDatas.add(laya.d3.core.scene.Scene3D.SHADERDEFINE_FOG) : this._defineDatas.remove(laya.d3.core.scene.Scene3D.SHADERDEFINE_FOG))
            }), u(0, t, "url", function () {
                return this._url
            }), u(0, t, "fogStart", function () {
                return this._shaderValues.getNumber(laya.d3.core.scene.Scene3D.FOGSTART)
            }, function (t) {
                this._shaderValues.setNumber(laya.d3.core.scene.Scene3D.FOGSTART, t)
            }), u(0, t, "reflectionIntensity", function () {
                return this._shaderValues.getNumber(laya.d3.core.scene.Scene3D.REFLETIONINTENSITY)
            }, function (t) {
                t = Math.max(Math.min(t, 1), 0), this._shaderValues.setNumber(laya.d3.core.scene.Scene3D.REFLETIONINTENSITY, t)
            }), u(0, t, "skyRenderer", function () {
                return this._skyRenderer
            }), u(0, t, "fogRange", function () {
                return this._shaderValues.getNumber(laya.d3.core.scene.Scene3D.FOGRANGE)
            }, function (t) {
                this._shaderValues.setNumber(laya.d3.core.scene.Scene3D.FOGRANGE, t)
            }), u(0, t, "ambientColor", function () {
                return this._shaderValues.getVector(laya.d3.core.scene.Scene3D.AMBIENTCOLOR)
            }, function (t) {
                this._shaderValues.setVector3(laya.d3.core.scene.Scene3D.AMBIENTCOLOR, t)
            }), u(0, t, "customReflection", function () {
                return this._shaderValues.getTexture(laya.d3.core.scene.Scene3D.REFLECTIONTEXTURE)
            }, function (t) {
                this._shaderValues.setTexture(laya.d3.core.scene.Scene3D.REFLECTIONTEXTURE, t), t ? this._defineDatas.add(laya.d3.core.scene.Scene3D.SHADERDEFINE_REFLECTMAP) : this._defineDatas.remove(laya.d3.core.scene.Scene3D.SHADERDEFINE_REFLECTMAP)
            }), u(0, t, "physicsSimulation", function () {
                return this._physicsSimulation
            }), u(0, t, "reflectionMode", function () {
                return this._reflectionMode
            }, function (t) {
                this._reflectionMode = t
            }), u(0, t, "timer", function () {
                return this._timer
            }, function (t) {
                this._timer = t
            }), u(0, t, "input", function () {
                return this._input
            }), n._parse = function (t, e, n) {
                var i, r = t.data, a = [];
                switch (t.version) {
                    case"LAYAHIERARCHY:02":
                        i = kt._createNodeByJson02(r, a);
                        break;
                    default:
                        i = kt._createNodeByJson(r, a)
                }
                return Z.combine(null, a), i
            }, n.load = function (t, e) {
                m.loader.create(t, e, null, "HIERARCHY")
            }, n.REFLECTIONMODE_SKYBOX = 0, n.REFLECTIONMODE_CUSTOM = 1, n.SHADERDEFINE_FOG = 0, n.SHADERDEFINE_DIRECTIONLIGHT = 0, n.SHADERDEFINE_POINTLIGHT = 0, n.SHADERDEFINE_SPOTLIGHT = 0, n.SHADERDEFINE_CAST_SHADOW = 0, n.SHADERDEFINE_SHADOW_PSSM1 = 0, n.SHADERDEFINE_SHADOW_PSSM2 = 0, n.SHADERDEFINE_SHADOW_PSSM3 = 0, n.SHADERDEFINE_SHADOW_PCF_NO = 0, n.SHADERDEFINE_SHADOW_PCF1 = 0, n.SHADERDEFINE_SHADOW_PCF2 = 0, n.SHADERDEFINE_SHADOW_PCF3 = 0, n.SHADERDEFINE_REFLECTMAP = 0, _(n, ["FOGCOLOR", function () {
                return this.FOGCOLOR = Pt.propertyNameToID("u_FogColor")
            }, "FOGSTART", function () {
                return this.FOGSTART = Pt.propertyNameToID("u_FogStart")
            }, "FOGRANGE", function () {
                return this.FOGRANGE = Pt.propertyNameToID("u_FogRange")
            }, "LIGHTDIRECTION", function () {
                return this.LIGHTDIRECTION = Pt.propertyNameToID("u_DirectionLight.Direction")
            }, "LIGHTDIRCOLOR", function () {
                return this.LIGHTDIRCOLOR = Pt.propertyNameToID("u_DirectionLight.Color")
            }, "POINTLIGHTPOS", function () {
                return this.POINTLIGHTPOS = Pt.propertyNameToID("u_PointLight.Position")
            }, "POINTLIGHTRANGE", function () {
                return this.POINTLIGHTRANGE = Pt.propertyNameToID("u_PointLight.Range")
            }, "POINTLIGHTATTENUATION", function () {
                return this.POINTLIGHTATTENUATION = Pt.propertyNameToID("u_PointLight.Attenuation")
            }, "POINTLIGHTCOLOR", function () {
                return this.POINTLIGHTCOLOR = Pt.propertyNameToID("u_PointLight.Color")
            }, "SPOTLIGHTPOS", function () {
                return this.SPOTLIGHTPOS = Pt.propertyNameToID("u_SpotLight.Position")
            }, "SPOTLIGHTDIRECTION", function () {
                return this.SPOTLIGHTDIRECTION = Pt.propertyNameToID("u_SpotLight.Direction")
            }, "SPOTLIGHTSPOTANGLE", function () {
                return this.SPOTLIGHTSPOTANGLE = Pt.propertyNameToID("u_SpotLight.Spot")
            }, "SPOTLIGHTRANGE", function () {
                return this.SPOTLIGHTRANGE = Pt.propertyNameToID("u_SpotLight.Range")
            }, "SPOTLIGHTCOLOR", function () {
                return this.SPOTLIGHTCOLOR = Pt.propertyNameToID("u_SpotLight.Color")
            }, "SHADOWDISTANCE", function () {
                return this.SHADOWDISTANCE = Pt.propertyNameToID("u_shadowPSSMDistance")
            }, "SHADOWLIGHTVIEWPROJECT", function () {
                return this.SHADOWLIGHTVIEWPROJECT = Pt.propertyNameToID("u_lightShadowVP")
            }, "SHADOWMAPPCFOFFSET", function () {
                return this.SHADOWMAPPCFOFFSET = Pt.propertyNameToID("u_shadowPCFoffset")
            }, "SHADOWMAPTEXTURE1", function () {
                return this.SHADOWMAPTEXTURE1 = Pt.propertyNameToID("u_shadowMap1")
            }, "SHADOWMAPTEXTURE2", function () {
                return this.SHADOWMAPTEXTURE2 = Pt.propertyNameToID("u_shadowMap2")
            }, "SHADOWMAPTEXTURE3", function () {
                return this.SHADOWMAPTEXTURE3 = Pt.propertyNameToID("u_shadowMap3")
            }, "AMBIENTCOLOR", function () {
                return this.AMBIENTCOLOR = Pt.propertyNameToID("u_AmbientColor")
            }, "REFLECTIONTEXTURE", function () {
                return this.REFLECTIONTEXTURE = Pt.propertyNameToID("u_ReflectTexture")
            }, "REFLETIONINTENSITY", function () {
                return this.REFLETIONINTENSITY = Pt.propertyNameToID("u_ReflectIntensity")
            }, "TIME", function () {
                return this.TIME = Pt.propertyNameToID("u_Time")
            }, "ANGLEATTENUATIONTEXTURE", function () {
                return this.ANGLEATTENUATIONTEXTURE = Pt.propertyNameToID("u_AngleTexture")
            }, "RANGEATTENUATIONTEXTURE", function () {
                return this.RANGEATTENUATIONTEXTURE = Pt.propertyNameToID("u_RangeTexture")
            }, "POINTLIGHTMATRIX", function () {
                return this.POINTLIGHTMATRIX = Pt.propertyNameToID("u_PointLightMatrix")
            }, "SPOTLIGHTMATRIX", function () {
                return this.SPOTLIGHTMATRIX = Pt.propertyNameToID("u_SpotLightMatrix")
            }]), n
        }(M), Jn = function (n) {
            function e(t) {
                this.pickColor = null, this._render = null, e.__super.call(this, t)
            }

            d(e, "laya.d3.core.RenderableSprite3D", n);
            var t = e.prototype;
            return t._onInActive = function () {
                laya.display.Node.prototype._onInActive.call(this);
                var t = this._scene;
                t._removeRenderObject(this._render), this._render.castShadow && t._removeShadowCastRenderObject(this._render)
            }, t._onActive = function () {
                laya.display.Node.prototype._onActive.call(this);
                var t = this._scene;
                t._addRenderObject(this._render), this._render.castShadow && t._addShadowCastRenderObject(this._render)
            }, t._onActiveInScene = function () {
                if (laya.display.Node.prototype._onActiveInScene.call(this), k._editerEnvironment) {
                    var t = this._scene, e = new Ct;
                    t._allotPickColorByID(this.id, e), (t._pickIdToSprite[this.id] = this)._render._shaderValues.setVector(laya.d3.core.RenderableSprite3D.PICKCOLOR, e)
                }
            }, t._addToInitStaticBatchManager = function () {
            }, t._setBelongScene = function (t) {
                laya.display.Node.prototype._setBelongScene.call(this, t), this._render._setBelongScene(t)
            }, t._setUnBelongScene = function () {
                this._render._defineDatas.remove(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP), laya.display.Node.prototype._setUnBelongScene.call(this)
            }, t._changeHierarchyAnimator = function (t) {
                if (this._hierarchyAnimator) {
                    var e = this._hierarchyAnimator._renderableSprites;
                    e.splice(e.indexOf(this), 1)
                }
                t && t._renderableSprites.push(this), n.prototype._changeHierarchyAnimator.call(this, t)
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), n.prototype.destroy.call(this, t), this._render._destroy(), this._render = null
            }, e.__init__ = function () {
                e.SHADERDEFINE_RECEIVE_SHADOW = e.shaderDefines.registerDefine("RECEIVESHADOW"), e.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV = e.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"), e.SAHDERDEFINE_LIGHTMAP = e.shaderDefines.registerDefine("LIGHTMAP")
            }, e.SHADERDEFINE_RECEIVE_SHADOW = 0, e.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV = 0, e.SAHDERDEFINE_LIGHTMAP = 0, _(e, ["LIGHTMAPSCALEOFFSET", function () {
                return this.LIGHTMAPSCALEOFFSET = Pt.propertyNameToID("u_LightmapScaleOffset")
            }, "LIGHTMAP", function () {
                return this.LIGHTMAP = Pt.propertyNameToID("u_LightMap")
            }, "PICKCOLOR", function () {
                return this.PICKCOLOR = Pt.propertyNameToID("u_PickColor")
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut
            }]), e
        }(Fn), $n = function (t) {
            function n() {
                this._albedoIntensity = 1, this._enableVertexColor = !1, this._albedoColor = new Ct(1, 1, 1, 1), n.__super.call(this), this.setShaderName("Unlit"), this._shaderValues.setVector(n.ALBEDOCOLOR, new Ct(1, 1, 1, 1)), this.renderMode = 0
            }

            d(n, "laya.d3.core.material.UnlitMaterial", Bn);
            var e = n.prototype;
            return u(0, e, "_ColorB", function () {
                return this._albedoColor.z
            }, function (t) {
                this._albedoColor.z = t, this.albedoColor = this._albedoColor
            }), u(0, e, "_ColorR", function () {
                return this._albedoColor.x
            }, function (t) {
                this._albedoColor.x = t, this.albedoColor = this._albedoColor
            }), u(0, e, "albedoColorA", function () {
                return this._ColorA
            }, function (t) {
                this._ColorA = t
            }), u(0, e, "_MainTex_STX", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).x
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.x = t, this.tilingOffset = e
            }), u(0, e, "_ColorG", function () {
                return this._albedoColor.y
            }, function (t) {
                this._albedoColor.y = t, this.albedoColor = this._albedoColor
            }), u(0, e, "_ColorA", function () {
                return this._albedoColor.w
            }, function (t) {
                this._albedoColor.w = t, this.albedoColor = this._albedoColor
            }), u(0, e, "_AlbedoIntensity", function () {
                return this._albedoIntensity
            }, function (t) {
                if (this._albedoIntensity !== t) {
                    var e = this._shaderValues.getVector(n.ALBEDOCOLOR);
                    Ct.scale(this._albedoColor, t, e), this._albedoIntensity = t, this._shaderValues.setVector(n.ALBEDOCOLOR, e)
                }
            }), u(0, e, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).z
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.z = t, this.tilingOffset = e
            }), u(0, e, "_MainTex_STY", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).y
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.y = t, this.tilingOffset = e
            }), u(0, e, "_Cutoff", function () {
                return this.alphaTestValue
            }, function (t) {
                this.alphaTestValue = t
            }), u(0, e, "_MainTex_STW", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).w
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.w = t, this.tilingOffset = e
            }), u(0, e, "albedoColorR", function () {
                return this._ColorR
            }, function (t) {
                this._ColorR = t
            }), u(0, e, "albedoColorG", function () {
                return this._ColorG
            }, function (t) {
                this._ColorG = t
            }), u(0, e, "albedoColorB", function () {
                return this._ColorB
            }, function (t) {
                this._ColorB = t
            }), u(0, e, "tilingOffsetX", function () {
                return this._MainTex_STX
            }, function (t) {
                this._MainTex_STX = t
            }), u(0, e, "albedoColor", function () {
                return this._albedoColor
            }, function (t) {
                var e = this._shaderValues.getVector(n.ALBEDOCOLOR);
                Ct.scale(t, this._albedoIntensity, e), this._albedoColor = t, this._shaderValues.setVector(n.ALBEDOCOLOR, e)
            }), u(0, e, "albedoIntensity", function () {
                return this._albedoIntensity
            }, function (t) {
                this._AlbedoIntensity = t
            }), u(0, e, "enableVertexColor", function () {
                return this._enableVertexColor
            }, function (t) {
                (this._enableVertexColor = t) ? this._defineDatas.add(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR) : this._defineDatas.remove(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR)
            }), u(0, e, "albedoTexture", function () {
                return this._shaderValues.getTexture(n.ALBEDOTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_ALBEDOTEXTURE) : this._defineDatas.remove(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_ALBEDOTEXTURE), this._shaderValues.setTexture(n.ALBEDOTEXTURE, t)
            }), u(0, e, "tilingOffsetY", function () {
                return this._MainTex_STY
            }, function (t) {
                this._MainTex_STY = t
            }), u(0, e, "tilingOffsetZ", function () {
                return this._MainTex_STZ
            }, function (t) {
                this._MainTex_STZ = t
            }), u(0, e, "blendSrc", function () {
                return this._shaderValues.getInt(n.BLEND_SRC)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND_SRC, t)
            }), u(0, e, "tilingOffsetW", function () {
                return this._MainTex_STW
            }, function (t) {
                this._MainTex_STW = t
            }), u(0, e, "tilingOffset", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET)
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_TILINGOFFSET), this._shaderValues.setVector(n.TILINGOFFSET, t)
            }), u(0, e, "renderMode", null, function (t) {
                switch (t) {
                    case 0:
                        this.alphaTest = !1, this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513;
                        break;
                    case 1:
                        this.renderQueue = 2450, this.alphaTest = !0, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513;
                        break;
                    case 2:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2, this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513;
                        break;
                    default:
                        throw new Error("UnlitMaterial : renderMode value error.")
                }
            }), u(0, e, "depthWrite", function () {
                return this._shaderValues.getBool(n.DEPTH_WRITE)
            }, function (t) {
                this._shaderValues.setBool(n.DEPTH_WRITE, t)
            }), u(0, e, "cull", function () {
                return this._shaderValues.getInt(n.CULL)
            }, function (t) {
                this._shaderValues.setInt(n.CULL, t)
            }), u(0, e, "blend", function () {
                return this._shaderValues.getInt(n.BLEND)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND, t)
            }), u(0, e, "blendDst", function () {
                return this._shaderValues.getInt(n.BLEND_DST)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND_DST, t)
            }), u(0, e, "depthTest", function () {
                return this._shaderValues.getInt(n.DEPTH_TEST)
            }, function (t) {
                this._shaderValues.setInt(n.DEPTH_TEST, t)
            }), n.__init__ = function () {
                n.SHADERDEFINE_ALBEDOTEXTURE = n.shaderDefines.registerDefine("ALBEDOTEXTURE"), n.SHADERDEFINE_TILINGOFFSET = n.shaderDefines.registerDefine("TILINGOFFSET"), n.SHADERDEFINE_ENABLEVERTEXCOLOR = n.shaderDefines.registerDefine("ENABLEVERTEXCOLOR")
            }, n.RENDERMODE_OPAQUE = 0, n.RENDERMODE_CUTOUT = 1, n.RENDERMODE_TRANSPARENT = 2, n.RENDERMODE_ADDTIVE = 3, n.SHADERDEFINE_ALBEDOTEXTURE = 0, n.SHADERDEFINE_TILINGOFFSET = 0, n.SHADERDEFINE_ENABLEVERTEXCOLOR = 0, _(n, ["ALBEDOTEXTURE", function () {
                return this.ALBEDOTEXTURE = Pt.propertyNameToID("u_AlbedoTexture")
            }, "ALBEDOCOLOR", function () {
                return this.ALBEDOCOLOR = Pt.propertyNameToID("u_AlbedoColor")
            }, "TILINGOFFSET", function () {
                return this.TILINGOFFSET = Pt.propertyNameToID("u_TilingOffset")
            }, "CULL", function () {
                return this.CULL = Pt.propertyNameToID("s_Cull")
            }, "BLEND", function () {
                return this.BLEND = Pt.propertyNameToID("s_Blend")
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Pt.propertyNameToID("s_BlendSrc")
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Pt.propertyNameToID("s_BlendDst")
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Pt.propertyNameToID("s_DepthTest")
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Pt.propertyNameToID("s_DepthWrite")
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new n
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), n
        }(), ti = function (i) {
            function e() {
                this._intensityColor = null, this._intensity = NaN, this._shadow = !1, this._shadowFarPlane = 0, this._shadowMapSize = 0, this._shadowMapCount = 0, this._shadowMapPCFType = 0, this._parallelSplitShadowMap = null, this._lightmapBakedType = 0, this.color = null, e.__super.call(this), this._intensity = 1, this._intensityColor = new Lt, this.color = new Lt(1, 1, 1), this._shadow = !1, this._shadowFarPlane = 8, this._shadowMapSize = 512, this._shadowMapCount = 1, this._shadowMapPCFType = 0, this._lightmapBakedType = e.LIGHTMAPBAKEDTYPE_REALTIME
            }

            d(e, "laya.d3.core.light.LightSprite", i);
            var t = e.prototype;
            return t._parse = function (t, e) {
                i.prototype._parse.call(this, t, e);
                var n = t.color;
                this.color.fromArray(n), this.intensity = t.intensity, this.lightmapBakedType = t.lightmapBakedType
            }, t._onActive = function () {
                laya.display.Node.prototype._onActive.call(this), this.lightmapBakedType !== e.LIGHTMAPBAKEDTYPE_BAKED && this._scene._addLight(this)
            }, t._onInActive = function () {
                laya.display.Node.prototype._onInActive.call(this), this.lightmapBakedType !== e.LIGHTMAPBAKEDTYPE_BAKED && this._scene._removeLight(this)
            }, t._prepareToScene = function () {
                return !1
            }, u(0, t, "lightmapBakedType", function () {
                return this._lightmapBakedType
            }, function (t) {
                this._lightmapBakedType !== t && (this._lightmapBakedType = t, this.activeInHierarchy && (t !== e.LIGHTMAPBAKEDTYPE_BAKED ? this._scene._addLight(this) : this._scene._removeLight(this)))
            }), u(0, t, "shadowPCFType", function () {
                return this._shadowMapPCFType
            }, function (t) {
                this._shadowMapPCFType = t, this._parallelSplitShadowMap && this._parallelSplitShadowMap.setPCFType(t)
            }), u(0, t, "intensity", function () {
                return this._intensity
            }, function (t) {
                this._intensity = t
            }), u(0, t, "shadow", function () {
                return this._shadow
            }, function (t) {
                throw new Error("LightSprite: must override it.")
            }), u(0, t, "shadowDistance", function () {
                return this._shadowFarPlane
            }, function (t) {
                this._shadowFarPlane = t, this._parallelSplitShadowMap && this._parallelSplitShadowMap.setFarDistance(t)
            }), u(0, t, "shadowPSSMCount", function () {
                return this._shadowMapCount
            }, function (t) {
                this._shadowMapCount = t, this._parallelSplitShadowMap && (this._parallelSplitShadowMap.shadowMapCount = t)
            }), u(0, t, "shadowResolution", function () {
                return this._shadowMapSize
            }, function (t) {
                this._shadowMapSize = t, this._parallelSplitShadowMap && this._parallelSplitShadowMap.setShadowMapTextureSize(t)
            }), u(0, t, "diffuseColor", function () {
                return this.color
            }, function (t) {
                this.color = t
            }), e.LIGHTMAPBAKEDTYPE_REALTIME = 0, e.LIGHTMAPBAKEDTYPE_MIXED = 1, e.LIGHTMAPBAKEDTYPE_BAKED = 2, e
        }(Fn), ei = function (r) {
            function h(t) {
                this._terrainRes = null, this._lightmapScaleOffset = null, h.__super.call(this), this._lightmapScaleOffset = new Ct(1, 1, 0, 0), t && (this._terrainRes = t, this.buildTerrain(t))
            }

            d(h, "laya.d3.terrain.Terrain", r);
            var t = h.prototype;
            return t._parse = function (t, e) {
                r.prototype._parse.call(this, t, e), this.terrainRes = Dt.getRes(t.dataPath);
                var n = t.lightmapIndex;
                null != n && this.setLightmapIndex(n);
                var i = t.lightmapScaleOffset;
                i && this.setLightmapScaleOffset(new Ct(i[0], i[1], i[2], i[3]))
            }, t.setLightmapIndex = function (t) {
                for (var e = 0; e < this._children.length; e++) {
                    this._children[e].terrainRender.lightmapIndex = t
                }
            }, t.setLightmapScaleOffset = function (t) {
                if (t) {
                    t.cloneTo(this._lightmapScaleOffset);
                    for (var e = 0; e < this._children.length; e++) {
                        this._children[e].terrainRender.lightmapScaleOffset = this._lightmapScaleOffset
                    }
                }
            }, t.disableLight = function () {
                for (var t = 0, e = this._children.length; t < e; t++) for (var n = this._children[t], i = 0, r = n._render.sharedMaterials.length; i < r; i++) {
                    n._render.sharedMaterials[i].disableLight()
                }
            }, t.buildTerrain = function (t) {
                for (var e = t._chunkNumX, n = t._chunkNumZ, i = t._heightData, r = 0, a = 0; a < n; a++) for (var o = 0; o < e; o++) {
                    for (var s = new Ri(o, a, t._gridSize, i._terrainHeightData, i._width, i._height, t._cameraCoordinateInverse), l = t._chunkInfos[r++], h = 0; h < l.alphaMap.length; h++) {
                        var u = l.detailID[h].length,
                            c = 0 < u ? t._detailTextureInfos[l.detailID[h][0]].diffuseTexture : null,
                            _ = 1 < u ? t._detailTextureInfos[l.detailID[h][1]].diffuseTexture : null,
                            d = 2 < u ? t._detailTextureInfos[l.detailID[h][2]].diffuseTexture : null,
                            f = 3 < u ? t._detailTextureInfos[l.detailID[h][3]].diffuseTexture : null,
                            m = 0 < u ? t._detailTextureInfos[l.detailID[h][0]].scale : null,
                            p = 1 < u ? t._detailTextureInfos[l.detailID[h][1]].scale : null,
                            T = 2 < u ? t._detailTextureInfos[l.detailID[h][2]].scale : null,
                            E = 3 < u ? t._detailTextureInfos[l.detailID[h][3]].scale : null;
                        s.buildRenderElementAndMaterial(u, l.normalMap, l.alphaMap[h], c, _, d, f, t._materialInfo.ambientColor, t._materialInfo.diffuseColor, t._materialInfo.specularColor, m ? m.x : 1, m ? m.y : 1, p ? p.x : 1, p ? p.y : 1, T ? T.x : 1, T ? T.y : 1, E ? E.x : 1, E ? E.y : 1)
                    }
                    s.terrainRender.receiveShadow = !0, s.terrainRender.lightmapScaleOffset = this._lightmapScaleOffset, this.addChild(s)
                }
            }, t.width = function () {
                return this._terrainRes._chunkNumX * st.CHUNK_GRID_NUM * this._terrainRes._gridSize
            }, t.depth = function () {
                return this._terrainRes._chunkNumZ * st.CHUNK_GRID_NUM * this._terrainRes._gridSize
            }, t.getHeightXZ = function (t, e) {
                if (!this._terrainRes) return NaN;
                if (t -= this.transform.position.x, e -= this.transform.position.z, h.__VECTOR3__ || (h.__VECTOR3__ = new Lt), h.__VECTOR3__.x = t, h.__VECTOR3__.y = 0, h.__VECTOR3__.z = e, Lt.transformV3ToV3(h.__VECTOR3__, st.__ADAPT_MATRIX_INV__, h.__VECTOR3__), t = h.__VECTOR3__.x, e = h.__VECTOR3__.z, t < 0 || t > this.width() || e < 0 || e > this.depth()) return NaN;
                var n = this._terrainRes._gridSize, i = parseInt("" + t / n), r = parseInt("" + e / n), a = t - i * n,
                    o = e - r * n, s = NaN, l = this._terrainRes._heightData;
                return n < a + o ? (s = l._terrainHeightData[(r + 1 - 1) * l._width + i + 1]) + (l._terrainHeightData[(r + 1 - 1) * l._width + i] - s) * ((n - a) / n) + (l._terrainHeightData[(r - 1) * l._width + i + 1] - s) * ((n - o) / n) : (s = l._terrainHeightData[Math.max(0, r - 1) * l._width + i]) + (l._terrainHeightData[Math.min(l._width * l._height - 1, (r + 1 - 1) * l._width + i)] - s) * (o / n) + (l._terrainHeightData[Math.min(l._width * l._height - 1, Math.max(0, r - 1) * l._width + i + 1)] - s) * (a / n)
            }, u(0, t, "terrainRes", null, function (t) {
                t && (this._terrainRes = t, this.buildTerrain(t))
            }), h.load = function (t) {
                m.loader.create(t, null, null, "TERRAIN", null, null, 1, !1)
            }, h.RENDER_LINE_MODEL = !1, h.LOD_TOLERANCE_VALUE = 4, h.LOD_DISTANCE_FACTOR = 2, h.__VECTOR3__ = null, h
        }(Fn), ni = function (t) {
            function n() {
                this._color = null, n.__super.call(this), this.setShaderName("Trail"), this._color = new Ct(1, 1, 1, 1), this._shaderValues.setVector(n.TINTCOLOR, new Ct(1, 1, 1, 1)), this.renderMode = 0
            }

            d(n, "laya.d3.core.trail.TrailMaterial", Bn);
            var e = n.prototype;
            return u(0, e, "_TintColorB", function () {
                return this._color.z
            }, function (t) {
                this._color.z = t, this.color = this._color
            }), u(0, e, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).z
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.z = t, this.tilingOffset = e
            }), u(0, e, "texture", function () {
                return this._shaderValues.getTexture(n.MAINTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_MAINTEXTURE) : this._defineDatas.remove(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_MAINTEXTURE), this._shaderValues.setTexture(n.MAINTEXTURE, t)
            }), u(0, e, "_TintColorR", function () {
                return this._color.x
            }, function (t) {
                this._color.x = t, this.color = this._color
            }), u(0, e, "_MainTex_STW", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).w
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.w = t, this.tilingOffset = e
            }), u(0, e, "_TintColorG", function () {
                return this._color.y
            }, function (t) {
                this._color.y = t, this.color = this._color
            }), u(0, e, "_TintColorA", function () {
                return this._color.w
            }, function (t) {
                this._color.w = t, this.color = this._color
            }), u(0, e, "_MainTex_STY", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).y
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.y = t, this.tilingOffset = e
            }), u(0, e, "renderMode", null, function (t) {
                switch (t) {
                    case 1:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 0, this.blend = 1, this.blendSrc = 770, this.blendDst = 1, this.depthTest = 513, this._defineDatas.add(n.SHADERDEFINE_ADDTIVEFOG);
                        break;
                    case 0:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 0, this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513, this._defineDatas.remove(n.SHADERDEFINE_ADDTIVEFOG);
                        break;
                    default:
                        throw new Error("TrailMaterial : renderMode value error.")
                }
            }), u(0, e, "_MainTex_STX", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).x
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.x = t, this.tilingOffset = e
            }), u(0, e, "colorR", function () {
                return this._TintColorR
            }, function (t) {
                this._TintColorR = t
            }), u(0, e, "colorG", function () {
                return this._TintColorG
            }, function (t) {
                this._TintColorG = t
            }), u(0, e, "colorB", function () {
                return this._TintColorB
            }, function (t) {
                this._TintColorB = t
            }), u(0, e, "colorA", function () {
                return this._TintColorA
            }, function (t) {
                this._TintColorA = t
            }), u(0, e, "blend", function () {
                return this._shaderValues.getInt(n.BLEND)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND, t)
            }), u(0, e, "color", function () {
                return this._shaderValues.getVector(n.TINTCOLOR)
            }, function (t) {
                this._shaderValues.setVector(n.TINTCOLOR, t)
            }), u(0, e, "tilingOffsetX", function () {
                return this._MainTex_STX
            }, function (t) {
                this._MainTex_STX = t
            }), u(0, e, "tilingOffsetY", function () {
                return this._MainTex_STY
            }, function (t) {
                this._MainTex_STY = t
            }), u(0, e, "tilingOffsetZ", function () {
                return this._MainTex_STZ
            }, function (t) {
                this._MainTex_STZ = t
            }), u(0, e, "blendSrc", function () {
                return this._shaderValues.getInt(n.BLEND_SRC)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND_SRC, t)
            }), u(0, e, "tilingOffsetW", function () {
                return this._MainTex_STW
            }, function (t) {
                this._MainTex_STW = t
            }), u(0, e, "tilingOffset", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET)
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_TILINGOFFSET), this._shaderValues.setVector(n.TILINGOFFSET, t)
            }), u(0, e, "depthWrite", function () {
                return this._shaderValues.getBool(n.DEPTH_WRITE)
            }, function (t) {
                this._shaderValues.setBool(n.DEPTH_WRITE, t)
            }), u(0, e, "cull", function () {
                return this._shaderValues.getInt(n.CULL)
            }, function (t) {
                this._shaderValues.setInt(n.CULL, t)
            }), u(0, e, "blendDst", function () {
                return this._shaderValues.getInt(n.BLEND_DST)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND_DST, t)
            }), u(0, e, "depthTest", function () {
                return this._shaderValues.getInt(n.DEPTH_TEST)
            }, function (t) {
                this._shaderValues.setInt(n.DEPTH_TEST, t)
            }), n.__init__ = function () {
                n.SHADERDEFINE_MAINTEXTURE = n.shaderDefines.registerDefine("MAINTEXTURE"), n.SHADERDEFINE_TILINGOFFSET = n.shaderDefines.registerDefine("TILINGOFFSET"), n.SHADERDEFINE_ADDTIVEFOG = n.shaderDefines.registerDefine("ADDTIVEFOG")
            }, n.RENDERMODE_ALPHABLENDED = 0, n.RENDERMODE_ADDTIVE = 1, n.SHADERDEFINE_MAINTEXTURE = 0, n.SHADERDEFINE_TILINGOFFSET = 0, n.SHADERDEFINE_ADDTIVEFOG = 0, _(n, ["defaultMaterial", function () {
                return this.defaultMaterial = new n
            }, "MAINTEXTURE", function () {
                return this.MAINTEXTURE = Pt.propertyNameToID("u_MainTexture")
            }, "TINTCOLOR", function () {
                return this.TINTCOLOR = Pt.propertyNameToID("u_MainColor")
            }, "TILINGOFFSET", function () {
                return this.TILINGOFFSET = Pt.propertyNameToID("u_TilingOffset")
            }, "CULL", function () {
                return this.CULL = Pt.propertyNameToID("s_Cull")
            }, "BLEND", function () {
                return this.BLEND = Pt.propertyNameToID("s_Blend")
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Pt.propertyNameToID("s_BlendSrc")
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Pt.propertyNameToID("s_BlendDst")
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Pt.propertyNameToID("s_DepthTest")
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Pt.propertyNameToID("s_DepthWrite")
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), n
        }(), ii = function (t) {
            function e() {
                this._sunDisk = 0, e.__super.call(this), this.setShaderName("SkyBoxProcedural"), this.sunDisk = 1, this.sunSize = .04, this.sunSizeConvergence = 5, this.atmosphereThickness = 1, this.skyTint = new Ct(.5, .5, .5, 1), this.groundTint = new Ct(.369, .349, .341, 1), this.exposure = 1.3
            }

            d(e, "laya.d3.core.material.SkyProceduralMaterial", Bn);
            var n = e.prototype;
            return u(0, n, "exposure", function () {
                return this._shaderValues.getNumber(e.EXPOSURE)
            }, function (t) {
                t = Math.min(Math.max(0, t), 8), this._shaderValues.setNumber(e.EXPOSURE, t)
            }), u(0, n, "sunSize", function () {
                return this._shaderValues.getNumber(e.SUNSIZE)
            }, function (t) {
                t = Math.min(Math.max(0, t), 1), this._shaderValues.setNumber(e.SUNSIZE, t)
            }), u(0, n, "sunDisk", function () {
                return this._sunDisk
            }, function (t) {
                switch (t) {
                    case 1:
                        this._defineDatas.remove(e.SHADERDEFINE_SUN_SIMPLE), this._defineDatas.add(e.SHADERDEFINE_SUN_HIGH_QUALITY);
                        break;
                    case 2:
                        this._defineDatas.remove(e.SHADERDEFINE_SUN_HIGH_QUALITY), this._defineDatas.add(e.SHADERDEFINE_SUN_SIMPLE);
                        break;
                    case 0:
                        this._defineDatas.remove(e.SHADERDEFINE_SUN_HIGH_QUALITY), this._defineDatas.remove(e.SHADERDEFINE_SUN_SIMPLE);
                        break;
                    default:
                        throw"SkyBoxProceduralMaterial: unknown sun value."
                }
                this._sunDisk = t
            }), u(0, n, "sunSizeConvergence", function () {
                return this._shaderValues.getNumber(e.SUNSIZECONVERGENCE)
            }, function (t) {
                t = Math.min(Math.max(0, t), 20), this._shaderValues.setNumber(e.SUNSIZECONVERGENCE, t)
            }), u(0, n, "atmosphereThickness", function () {
                return this._shaderValues.getNumber(e.ATMOSPHERETHICKNESS)
            }, function (t) {
                t = Math.min(Math.max(0, t), 5), this._shaderValues.setNumber(e.ATMOSPHERETHICKNESS, t)
            }), u(0, n, "groundTint", function () {
                return this._shaderValues.getVector(e.GROUNDTINT)
            }, function (t) {
                this._shaderValues.setVector(e.GROUNDTINT, t)
            }), u(0, n, "skyTint", function () {
                return this._shaderValues.getVector(e.SKYTINT)
            }, function (t) {
                this._shaderValues.setVector(e.SKYTINT, t)
            }), e.__init__ = function () {
                e.SHADERDEFINE_SUN_HIGH_QUALITY = e.shaderDefines.registerDefine("SUN_HIGH_QUALITY"), e.SHADERDEFINE_SUN_SIMPLE = e.shaderDefines.registerDefine("SUN_SIMPLE")
            }, e.SUN_NODE = 0, e.SUN_HIGH_QUALITY = 1, e.SUN_SIMPLE = 2, e.SHADERDEFINE_SUN_HIGH_QUALITY = 0, e.SHADERDEFINE_SUN_SIMPLE = 0, _(e, ["SUNSIZE", function () {
                return this.SUNSIZE = Pt.propertyNameToID("u_SunSize")
            }, "SUNSIZECONVERGENCE", function () {
                return this.SUNSIZECONVERGENCE = Pt.propertyNameToID("u_SunSizeConvergence")
            }, "ATMOSPHERETHICKNESS", function () {
                return this.ATMOSPHERETHICKNESS = Pt.propertyNameToID("u_AtmosphereThickness")
            }, "SKYTINT", function () {
                return this.SKYTINT = Pt.propertyNameToID("u_SkyTint")
            }, "GROUNDTINT", function () {
                return this.GROUNDTINT = Pt.propertyNameToID("u_GroundTint")
            }, "EXPOSURE", function () {
                return this.EXPOSURE = Pt.propertyNameToID("u_Exposure")
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new e
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), e
        }(), ri = function (t) {
            function e() {
                e.__super.call(this), this.setShaderName("LineShader"), this._shaderValues.setVector(e.COLOR, new Ct(1, 1, 1, 1))
            }

            d(e, "laya.d3.core.pixelLine.PixelLineMaterial", Bn);
            var n = e.prototype;
            return u(0, n, "blend", function () {
                return this._shaderValues.getInt(e.BLEND)
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t)
            }), u(0, n, "color", function () {
                return this._shaderValues.getVector(e.COLOR)
            }, function (t) {
                this._shaderValues.setVector(e.COLOR, t)
            }), u(0, n, "cull", function () {
                return this._shaderValues.getInt(e.CULL)
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t)
            }), u(0, n, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE)
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t)
            }), u(0, n, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC)
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t)
            }), u(0, n, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST)
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t)
            }), u(0, n, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST)
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t)
            }), _(e, ["COLOR", function () {
                return this.COLOR = Pt.propertyNameToID("u_Color")
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new e
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }, "CULL", function () {
                return this.CULL = Pt.propertyNameToID("s_Cull")
            }, "BLEND", function () {
                return this.BLEND = Pt.propertyNameToID("s_Blend")
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Pt.propertyNameToID("s_BlendSrc")
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Pt.propertyNameToID("s_BlendDst")
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Pt.propertyNameToID("s_DepthTest")
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Pt.propertyNameToID("s_DepthWrite")
            }]), e
        }(), ai = function (a) {
            function o(t, e) {
                o.__super.call(this), this._skyRenderer = new me, this._forward = new Lt, this._up = new Lt, this.clearColor = new Ct(100 / 255, 149 / 255, 237 / 255, 1), void 0 === t && (t = .3), void 0 === e && (e = 1e3), this._shaderValues = new ot(null), this._fieldOfView = 60, this._useUserProjectionMatrix = !1, this._orthographic = !1, this._orthographicVerticalSize = 10, this.renderingOrder = 0, this._nearPlane = t, this._farPlane = e, this.cullingMask = 2147483647, this.clearFlag = 0, this.useOcclusionCulling = !0, this._calculateProjectionMatrix(), m.stage.on("resize", this, this._onScreenSizeChanged)
            }

            d(o, "laya.d3.core.BaseCamera", a);
            var t = o.prototype;
            return t._sortCamerasByRenderingOrder = function () {
                if (this.displayedInStage) for (var t = this.scene._cameraPool, e = t.length - 1, n = 0; n < e; n++) if (t[n].renderingOrder > t[e].renderingOrder) {
                    var i = t[n];
                    t[n] = t[e], t[e] = i
                }
            }, t._calculateProjectionMatrix = function () {
            }, t._onScreenSizeChanged = function () {
                this._calculateProjectionMatrix()
            }, t._prepareCameraToRender = function () {
                this.transform.getForward(this._forward), this.transform.getUp(this._up);
                var t = this._shaderValues;
                t.setVector3(laya.d3.core.BaseCamera.CAMERAPOS, this.transform.position), t.setVector3(laya.d3.core.BaseCamera.CAMERADIRECTION, this._forward), t.setVector3(laya.d3.core.BaseCamera.CAMERAUP, this._up)
            }, t._prepareCameraViewProject = function (t, e, n, i) {
                var r = this._shaderValues;
                r.setMatrix4x4(laya.d3.core.BaseCamera.VIEWMATRIX, t), r.setMatrix4x4(laya.d3.core.BaseCamera.PROJECTMATRIX, e), r.setMatrix4x4(laya.d3.core.BaseCamera.VIEWPROJECTMATRIX, n), this.transform.worldMatrix.cloneTo(o._tempMatrix4x40), o._tempMatrix4x40.transpose(), He.multiply(e, o._tempMatrix4x40, i), r.setMatrix4x4(laya.d3.core.BaseCamera.VPMATRIX_NO_TRANSLATE, i)
            }, t.render = function (t, e) {
            }, t.addLayer = function (t) {
                this.cullingMask |= Math.pow(2, t)
            }, t.removeLayer = function (t) {
                this.cullingMask &= ~Math.pow(2, t)
            }, t.addAllLayers = function () {
                this.cullingMask = 2147483647
            }, t.removeAllLayers = function () {
                this.cullingMask = 0
            }, t.resetProjectionMatrix = function () {
                this._useUserProjectionMatrix = !1, this._calculateProjectionMatrix()
            }, t._onActive = function () {
                this._scene._addCamera(this), laya.display.Node.prototype._onActive.call(this)
            }, t._onInActive = function () {
                this._scene._removeCamera(this), laya.display.Node.prototype._onInActive.call(this)
            }, t._parse = function (t, e) {
                a.prototype._parse.call(this, t, e);
                var n = t.clearFlag;
                void 0 !== n && (this.clearFlag = n), this.orthographic = t.orthographic, this.fieldOfView = t.fieldOfView, this.nearPlane = t.nearPlane, this.farPlane = t.farPlane;
                var i = t.clearColor;
                this.clearColor = new Ct(i[0], i[1], i[2], i[3]);
                var r = t.skyboxMaterial;
                r && (this._skyRenderer.material = Dt.getRes(r.path))
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this._skyRenderer.destroy(), this._skyRenderer = null, m.stage.off("resize", this, this._onScreenSizeChanged), a.prototype.destroy.call(this, t)
            }, u(0, t, "renderingOrder", function () {
                return this._renderingOrder
            }, function (t) {
                this._renderingOrder = t, this._sortCamerasByRenderingOrder()
            }), u(0, t, "skyRenderer", function () {
                return this._skyRenderer
            }), u(0, t, "orthographic", function () {
                return this._orthographic
            }, function (t) {
                this._orthographic = t, this._calculateProjectionMatrix()
            }), u(0, t, "fieldOfView", function () {
                return this._fieldOfView
            }, function (t) {
                this._fieldOfView = t, this._calculateProjectionMatrix()
            }), u(0, t, "nearPlane", function () {
                return this._nearPlane
            }, function (t) {
                this._nearPlane = t, this._calculateProjectionMatrix()
            }), u(0, t, "farPlane", function () {
                return this._farPlane
            }, function (t) {
                this._farPlane = t, this._calculateProjectionMatrix()
            }), u(0, t, "orthographicVerticalSize", function () {
                return this._orthographicVerticalSize
            }, function (t) {
                this._orthographicVerticalSize = t, this._calculateProjectionMatrix()
            }), o.RENDERINGTYPE_DEFERREDLIGHTING = "DEFERREDLIGHTING", o.RENDERINGTYPE_FORWARDRENDERING = "FORWARDRENDERING", o.CLEARFLAG_SOLIDCOLOR = 0, o.CLEARFLAG_SKY = 1, o.CLEARFLAG_DEPTHONLY = 2, o.CLEARFLAG_NONE = 3, _(o, ["_tempMatrix4x40", function () {
                return this._tempMatrix4x40 = new He
            }, "CAMERAPOS", function () {
                return this.CAMERAPOS = Pt.propertyNameToID("u_CameraPos")
            }, "VIEWMATRIX", function () {
                return this.VIEWMATRIX = Pt.propertyNameToID("u_View")
            }, "PROJECTMATRIX", function () {
                return this.PROJECTMATRIX = Pt.propertyNameToID("u_Projection")
            }, "VIEWPROJECTMATRIX", function () {
                return this.VIEWPROJECTMATRIX = Pt.propertyNameToID("u_ViewProjection")
            }, "VPMATRIX_NO_TRANSLATE", function () {
                return this.VPMATRIX_NO_TRANSLATE = Pt.propertyNameToID("u_MvpMatrix")
            }, "CAMERADIRECTION", function () {
                return this.CAMERADIRECTION = Pt.propertyNameToID("u_CameraDirection")
            }, "CAMERAUP", function () {
                return this.CAMERAUP = Pt.propertyNameToID("u_CameraUp")
            }, "_invertYScaleMatrix", function () {
                return this._invertYScaleMatrix = new He(1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)
            }, "_invertYProjectionMatrix", function () {
                return this._invertYProjectionMatrix = new He
            }, "_invertYProjectionViewMatrix", function () {
                return this._invertYProjectionViewMatrix = new He
            }]), o
        }(Fn), oi = function (n) {
            function i() {
                this._albedoColor = null, this._emissionColor = null, i.__super.call(this), this.setShaderName("PBRStandard"), this._albedoColor = new Ct(1, 1, 1, 1), this._shaderValues.setVector(i.ALBEDOCOLOR, new Ct(1, 1, 1, 1)), this._emissionColor = new Ct(0, 0, 0, 0), this._shaderValues.setVector(i.EMISSIONCOLOR, new Ct(0, 0, 0, 0)), this._shaderValues.setNumber(i.METALLIC, 0), this._shaderValues.setNumber(i.SMOOTHNESS, .5), this._shaderValues.setNumber(i.SMOOTHNESSSCALE, 1), this._shaderValues.setNumber(i.SMOOTHNESSSOURCE, 0), this._shaderValues.setNumber(i.OCCLUSIONSTRENGTH, 1), this._shaderValues.setNumber(i.NORMALSCALE, 1), this._shaderValues.setNumber(i.PARALLAXSCALE, .001), this._shaderValues.setBool(i.ENABLEEMISSION, !1), this._shaderValues.setBool(i.ENABLEREFLECT, !0), this._shaderValues.setNumber(Bn.ALPHATESTVALUE, .5), this._disablePublicDefineDatas.remove(Qn.SHADERDEFINE_REFLECTMAP), this.renderMode = 0
            }

            d(i, "laya.d3.core.material.PBRStandardMaterial", n);
            var t = i.prototype;
            return t.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                this._albedoColor.cloneTo(e._albedoColor), this._emissionColor.cloneTo(e._emissionColor)
            }, u(0, t, "_Parallax", function () {
                return this._shaderValues.getNumber(i.PARALLAXSCALE)
            }, function (t) {
                this._shaderValues.setNumber(i.PARALLAXSCALE, t)
            }), u(0, t, "_ColorB", function () {
                return this._albedoColor.z
            }, function (t) {
                this._albedoColor.z = t, this.albedoColor = this._albedoColor
            }), u(0, t, "_ColorR", function () {
                return this._albedoColor.x
            }, function (t) {
                this._albedoColor.x = t, this.albedoColor = this._albedoColor
            }), u(0, t, "_ColorG", function () {
                return this._albedoColor.y
            }, function (t) {
                this._albedoColor.y = t, this.albedoColor = this._albedoColor
            }), u(0, t, "metallic", function () {
                return this._Metallic
            }, function (t) {
                this._Metallic = Math.max(0, Math.min(1, t))
            }), u(0, t, "_GlossMapScale", function () {
                return this._shaderValues.getNumber(i.SMOOTHNESSSCALE)
            }, function (t) {
                this._shaderValues.setNumber(i.SMOOTHNESSSCALE, t)
            }), u(0, t, "_Glossiness", function () {
                return this._shaderValues.getNumber(i.SMOOTHNESS)
            }, function (t) {
                this._shaderValues.setNumber(i.SMOOTHNESS, t)
            }), u(0, t, "_ColorA", function () {
                return this._albedoColor.w
            }, function (t) {
                this._albedoColor.w = t, this.albedoColor = this._albedoColor
            }), u(0, t, "enableReflection", function () {
                return this._shaderValues.getBool(i.ENABLEREFLECT)
            }, function (t) {
                this._shaderValues.setBool(i.ENABLEREFLECT, !0), t ? this._disablePublicDefineDatas.remove(Qn.SHADERDEFINE_REFLECTMAP) : this._disablePublicDefineDatas.add(Qn.SHADERDEFINE_REFLECTMAP)
            }), u(0, t, "_Metallic", function () {
                return this._shaderValues.getNumber(i.METALLIC)
            }, function (t) {
                this._shaderValues.setNumber(i.METALLIC, t)
            }), u(0, t, "_BumpScale", function () {
                return this._shaderValues.getNumber(i.NORMALSCALE)
            }, function (t) {
                this._shaderValues.setNumber(i.NORMALSCALE, t)
            }), u(0, t, "_OcclusionStrength", function () {
                return this._shaderValues.getNumber(i.OCCLUSIONSTRENGTH)
            }, function (t) {
                this._shaderValues.setNumber(i.OCCLUSIONSTRENGTH, t)
            }), u(0, t, "_EmissionColorR", function () {
                return this._emissionColor.x
            }, function (t) {
                this._emissionColor.x = t, this.emissionColor = this._emissionColor
            }), u(0, t, "tilingOffset", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET)
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_TILINGOFFSET), this._shaderValues.setVector(i.TILINGOFFSET, t)
            }), u(0, t, "_EmissionColorG", function () {
                return this._emissionColor.y
            }, function (t) {
                this._emissionColor.y = t, this.emissionColor = this._emissionColor
            }), u(0, t, "blendSrc", function () {
                return this._shaderValues.getInt(i.BLEND_SRC)
            }, function (t) {
                this._shaderValues.setInt(i.BLEND_SRC, t)
            }), u(0, t, "tilingOffsetW", function () {
                return this._MainTex_STW
            }, function (t) {
                this._MainTex_STW = t
            }), u(0, t, "_EmissionColorB", function () {
                return this._emissionColor.z
            }, function (t) {
                this._emissionColor.z = t, this.emissionColor = this._emissionColor
            }), u(0, t, "_EmissionColorA", function () {
                return this._emissionColor.w
            }, function (t) {
                this._emissionColor.w = t, this.emissionColor = this._emissionColor
            }), u(0, t, "albedoColorA", function () {
                return this._ColorA
            }, function (t) {
                this._ColorA = t
            }), u(0, t, "_MainTex_STX", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).x
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.x = t, this.tilingOffset = e
            }), u(0, t, "_MainTex_STY", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).y
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.y = t, this.tilingOffset = e
            }), u(0, t, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).z
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.z = t, this.tilingOffset = e
            }), u(0, t, "_Cutoff", function () {
                return this.alphaTestValue
            }, function (t) {
                this.alphaTestValue = t
            }), u(0, t, "_MainTex_STW", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).w
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.w = t, this.tilingOffset = e
            }), u(0, t, "albedoColorR", function () {
                return this._ColorR
            }, function (t) {
                this._ColorR = t
            }), u(0, t, "albedoColorG", function () {
                return this._ColorG
            }, function (t) {
                this._ColorG = t
            }), u(0, t, "albedoColorB", function () {
                return this._ColorB
            }, function (t) {
                this._ColorB = t
            }), u(0, t, "tilingOffsetX", function () {
                return this._MainTex_STX
            }, function (t) {
                this._MainTex_STX = t
            }), u(0, t, "albedoColor", function () {
                return this._albedoColor
            }, function (t) {
                this._albedoColor = t, this._shaderValues.setVector(i.ALBEDOCOLOR, t)
            }), u(0, t, "albedoTexture", function () {
                return this._shaderValues.getTexture(i.ALBEDOTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_ALBEDOTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_ALBEDOTEXTURE), this._shaderValues.setTexture(i.ALBEDOTEXTURE, t)
            }), u(0, t, "cull", function () {
                return this._shaderValues.getInt(i.CULL)
            }, function (t) {
                this._shaderValues.setInt(i.CULL, t)
            }), u(0, t, "parallaxTexture", function () {
                return this._shaderValues.getTexture(i.PARALLAXTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_PARALLAXTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_PARALLAXTEXTURE), this._shaderValues.setTexture(i.PARALLAXTEXTURE, t)
            }), u(0, t, "normalTexture", function () {
                return this._shaderValues.getTexture(i.NORMALTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_NORMALTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_NORMALTEXTURE), this._shaderValues.setTexture(i.NORMALTEXTURE, t)
            }), u(0, t, "emissionColor", function () {
                return this._shaderValues.getVector(i.EMISSIONCOLOR)
            }, function (t) {
                this._shaderValues.setVector(i.EMISSIONCOLOR, t)
            }), u(0, t, "parallaxTextureScale", function () {
                return this._Parallax
            }, function (t) {
                this._Parallax = Math.max(.005, Math.min(.08, t))
            }), u(0, t, "normalTextureScale", function () {
                return this._BumpScale
            }, function (t) {
                this._BumpScale = t
            }), u(0, t, "tilingOffsetZ", function () {
                return this._MainTex_STZ
            }, function (t) {
                this._MainTex_STZ = t
            }), u(0, t, "occlusionTexture", function () {
                return this._shaderValues.getTexture(i.OCCLUSIONTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_OCCLUSIONTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_OCCLUSIONTEXTURE), this._shaderValues.setTexture(i.OCCLUSIONTEXTURE, t)
            }), u(0, t, "occlusionTextureStrength", function () {
                return this._OcclusionStrength
            }, function (t) {
                this._OcclusionStrength = Math.max(0, Math.min(1, t))
            }), u(0, t, "enableEmission", function () {
                return this._shaderValues.getBool(i.ENABLEEMISSION)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSION) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSION), this._shaderValues.setBool(i.ENABLEEMISSION, t)
            }), u(0, t, "metallicGlossTexture", function () {
                return this._shaderValues.getTexture(i.METALLICGLOSSTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_METALLICGLOSSTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_METALLICGLOSSTEXTURE), this._shaderValues.setTexture(i.METALLICGLOSSTEXTURE, t)
            }), u(0, t, "emissionColorA", function () {
                return this._EmissionColorA
            }, function (t) {
                this._EmissionColorA = t
            }), u(0, t, "smoothness", function () {
                return this._Glossiness
            }, function (t) {
                this._Glossiness = Math.max(0, Math.min(1, t))
            }), u(0, t, "blendDst", function () {
                return this._shaderValues.getInt(i.BLEND_DST)
            }, function (t) {
                this._shaderValues.setInt(i.BLEND_DST, t)
            }), u(0, t, "smoothnessTextureScale", function () {
                return this._GlossMapScale
            }, function (t) {
                this._GlossMapScale = Math.max(0, Math.min(1, t))
            }), u(0, t, "depthWrite", function () {
                return this._shaderValues.getBool(i.DEPTH_WRITE)
            }, function (t) {
                this._shaderValues.setBool(i.DEPTH_WRITE, t)
            }), u(0, t, "smoothnessSource", function () {
                return this._shaderValues.getInt(i.SMOOTHNESSSOURCE)
            }, function (t) {
                t ? (this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA), this._shaderValues.setInt(i.SMOOTHNESSSOURCE, 1)) : (this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA), this._shaderValues.setInt(i.SMOOTHNESSSOURCE, 0))
            }), u(0, t, "emissionColorR", function () {
                return this._EmissionColorR
            }, function (t) {
                this._EmissionColorR = t
            }), u(0, t, "emissionColorG", function () {
                return this._EmissionColorG
            }, function (t) {
                this._EmissionColorG = t
            }), u(0, t, "emissionColorB", function () {
                return this._EmissionColorB
            }, function (t) {
                this._EmissionColorB = t
            }), u(0, t, "emissionTexture", function () {
                return this._shaderValues.getTexture(i.EMISSIONTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSIONTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSIONTEXTURE), this._shaderValues.setTexture(i.EMISSIONTEXTURE, t)
            }), u(0, t, "tilingOffsetY", function () {
                return this._MainTex_STY
            }, function (t) {
                this._MainTex_STY = t
            }), u(0, t, "renderMode", null, function (t) {
                switch (t) {
                    case 0:
                        this.alphaTest = !1, this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513, this._defineDatas.remove(i.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;
                    case 1:
                        this.renderQueue = 2450, this.alphaTest = !0, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513, this._defineDatas.remove(i.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;
                    case 2:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2, this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513, this._defineDatas.remove(i.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;
                    case 3:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2, this.blend = 1, this.blendSrc = 1, this.blendDst = 771, this.depthTest = 513, this._defineDatas.add(i.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;
                    default:
                        throw new Error("PBRSpecularMaterial : renderMode value error.")
                }
            }), u(0, t, "blend", function () {
                return this._shaderValues.getInt(i.BLEND)
            }, function (t) {
                this._shaderValues.setInt(i.BLEND, t)
            }), u(0, t, "depthTest", function () {
                return this._shaderValues.getInt(i.DEPTH_TEST)
            }, function (t) {
                this._shaderValues.setInt(i.DEPTH_TEST, t)
            }), i.__init__ = function () {
                i.SHADERDEFINE_ALBEDOTEXTURE = i.shaderDefines.registerDefine("ALBEDOTEXTURE"), i.SHADERDEFINE_METALLICGLOSSTEXTURE = i.shaderDefines.registerDefine("METALLICGLOSSTEXTURE"), i.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA = i.shaderDefines.registerDefine("SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA"), i.SHADERDEFINE_NORMALTEXTURE = i.shaderDefines.registerDefine("NORMALTEXTURE"), i.SHADERDEFINE_PARALLAXTEXTURE = i.shaderDefines.registerDefine("PARALLAXTEXTURE"), i.SHADERDEFINE_OCCLUSIONTEXTURE = i.shaderDefines.registerDefine("OCCLUSIONTEXTURE"), i.SHADERDEFINE_EMISSION = i.shaderDefines.registerDefine("EMISSION"), i.SHADERDEFINE_EMISSIONTEXTURE = i.shaderDefines.registerDefine("EMISSIONTEXTURE"), i.SHADERDEFINE_REFLECTMAP = i.shaderDefines.registerDefine("REFLECTMAP"), i.SHADERDEFINE_TILINGOFFSET = i.shaderDefines.registerDefine("TILINGOFFSET"), i.SHADERDEFINE_ALPHAPREMULTIPLY = i.shaderDefines.registerDefine("ALPHAPREMULTIPLY")
            }, i.SmoothnessSource_MetallicGlossTexture_Alpha = 0, i.SmoothnessSource_AlbedoTexture_Alpha = 1, i.RENDERMODE_OPAQUE = 0, i.RENDERMODE_CUTOUT = 1, i.RENDERMODE_FADE = 2, i.RENDERMODE_TRANSPARENT = 3, i.SHADERDEFINE_ALBEDOTEXTURE = 0, i.SHADERDEFINE_NORMALTEXTURE = 0, i.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA = 0, i.SHADERDEFINE_METALLICGLOSSTEXTURE = 0, i.SHADERDEFINE_OCCLUSIONTEXTURE = 0, i.SHADERDEFINE_PARALLAXTEXTURE = 0, i.SHADERDEFINE_EMISSION = 0, i.SHADERDEFINE_EMISSIONTEXTURE = 0, i.SHADERDEFINE_REFLECTMAP = 0, i.SHADERDEFINE_TILINGOFFSET = 0, i.SHADERDEFINE_ALPHAPREMULTIPLY = 0, i.SMOOTHNESSSOURCE = -1, i.ENABLEEMISSION = -1, i.ENABLEREFLECT = -1, _(i, ["ALBEDOTEXTURE", function () {
                return this.ALBEDOTEXTURE = Pt.propertyNameToID("u_AlbedoTexture")
            }, "METALLICGLOSSTEXTURE", function () {
                return this.METALLICGLOSSTEXTURE = Pt.propertyNameToID("u_MetallicGlossTexture")
            }, "NORMALTEXTURE", function () {
                return this.NORMALTEXTURE = Pt.propertyNameToID("u_NormalTexture")
            }, "PARALLAXTEXTURE", function () {
                return this.PARALLAXTEXTURE = Pt.propertyNameToID("u_ParallaxTexture")
            }, "OCCLUSIONTEXTURE", function () {
                return this.OCCLUSIONTEXTURE = Pt.propertyNameToID("u_OcclusionTexture")
            }, "EMISSIONTEXTURE", function () {
                return this.EMISSIONTEXTURE = Pt.propertyNameToID("u_EmissionTexture")
            }, "ALBEDOCOLOR", function () {
                return this.ALBEDOCOLOR = Pt.propertyNameToID("u_AlbedoColor")
            }, "EMISSIONCOLOR", function () {
                return this.EMISSIONCOLOR = Pt.propertyNameToID("u_EmissionColor")
            }, "METALLIC", function () {
                return this.METALLIC = Pt.propertyNameToID("u_metallic")
            }, "SMOOTHNESS", function () {
                return this.SMOOTHNESS = Pt.propertyNameToID("u_smoothness")
            }, "SMOOTHNESSSCALE", function () {
                return this.SMOOTHNESSSCALE = Pt.propertyNameToID("u_smoothnessScale")
            }, "OCCLUSIONSTRENGTH", function () {
                return this.OCCLUSIONSTRENGTH = Pt.propertyNameToID("u_occlusionStrength")
            }, "NORMALSCALE", function () {
                return this.NORMALSCALE = Pt.propertyNameToID("u_normalScale")
            }, "PARALLAXSCALE", function () {
                return this.PARALLAXSCALE = Pt.propertyNameToID("u_parallaxScale")
            }, "TILINGOFFSET", function () {
                return this.TILINGOFFSET = Pt.propertyNameToID("u_TilingOffset")
            }, "CULL", function () {
                return this.CULL = Pt.propertyNameToID("s_Cull")
            }, "BLEND", function () {
                return this.BLEND = Pt.propertyNameToID("s_Blend")
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Pt.propertyNameToID("s_BlendSrc")
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Pt.propertyNameToID("s_BlendDst")
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Pt.propertyNameToID("s_DepthTest")
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Pt.propertyNameToID("s_DepthWrite")
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new i
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), i
        }(Bn), si = function (t) {
            function n() {
                n.__super.call(this), this.setShaderName("PARTICLESHURIKEN"), this._color = new Ct(1, 1, 1, 1), this.renderMode = 0
            }

            d(n, "laya.d3.core.particleShuriKen.ShurikenParticleMaterial", Bn);
            var e = n.prototype;
            return u(0, e, "_TintColorB", function () {
                return this._color.z
            }, function (t) {
                this._color.z = t, this.color = this._color
            }), u(0, e, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).z
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.z = t, this.tilingOffset = e
            }), u(0, e, "texture", function () {
                return this._shaderValues.getTexture(n.DIFFUSETEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_DIFFUSEMAP) : this._defineDatas.remove(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_DIFFUSEMAP), this._shaderValues.setTexture(n.DIFFUSETEXTURE, t)
            }), u(0, e, "_TintColorR", function () {
                return this._color.x
            }, function (t) {
                this._color.x = t, this.color = this._color
            }), u(0, e, "_MainTex_STW", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).w
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.w = t, this.tilingOffset = e
            }), u(0, e, "_TintColorG", function () {
                return this._color.y
            }, function (t) {
                this._color.y = t, this.color = this._color
            }), u(0, e, "_TintColorA", function () {
                return this._color.w
            }, function (t) {
                this._color.w = t, this.color = this._color
            }), u(0, e, "_MainTex_STY", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).y
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.y = t, this.tilingOffset = e
            }), u(0, e, "renderMode", null, function (t) {
                switch (t) {
                    case 1:
                        this.renderQueue = 3e3, this.depthWrite = !1, this.cull = 0, this.blend = 1, this.blendSrc = 770, this.blendDst = 1, this.alphaTest = !1, this._defineDatas.add(n.SHADERDEFINE_ADDTIVEFOG);
                        break;
                    case 0:
                        this.renderQueue = 3e3, this.depthWrite = !1, this.cull = 0, this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.alphaTest = !1, this._defineDatas.remove(n.SHADERDEFINE_ADDTIVEFOG);
                        break;
                    default:
                        throw new Error("ShurikenParticleMaterial : renderMode value error.")
                }
            }), u(0, e, "_MainTex_STX", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).x
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.x = t, this.tilingOffset = e
            }), u(0, e, "colorR", function () {
                return this._TintColorR
            }, function (t) {
                this._TintColorR = t
            }), u(0, e, "colorG", function () {
                return this._TintColorG
            }, function (t) {
                this._TintColorG = t
            }), u(0, e, "colorB", function () {
                return this._TintColorB
            }, function (t) {
                this._TintColorB = t
            }), u(0, e, "colorA", function () {
                return this._TintColorA
            }, function (t) {
                this._TintColorA = t
            }), u(0, e, "blend", function () {
                return this._shaderValues.getInt(n.BLEND)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND, t)
            }), u(0, e, "color", function () {
                return this._shaderValues.getVector(n.TINTCOLOR)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TINTCOLOR) : this._defineDatas.remove(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TINTCOLOR), this._shaderValues.setVector(n.TINTCOLOR, t)
            }), u(0, e, "tilingOffsetX", function () {
                return this._MainTex_STX
            }, function (t) {
                this._MainTex_STX = t
            }), u(0, e, "tilingOffsetY", function () {
                return this._MainTex_STY
            }, function (t) {
                this._MainTex_STY = t
            }), u(0, e, "tilingOffsetZ", function () {
                return this._MainTex_STZ
            }, function (t) {
                this._MainTex_STZ = t
            }), u(0, e, "blendSrc", function () {
                return this._shaderValues.getInt(n.BLEND_SRC)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND_SRC, t)
            }), u(0, e, "tilingOffsetW", function () {
                return this._MainTex_STW
            }, function (t) {
                this._MainTex_STW = t
            }), u(0, e, "tilingOffset", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET)
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET), this._shaderValues.setVector(n.TILINGOFFSET, t)
            }), u(0, e, "depthWrite", function () {
                return this._shaderValues.getBool(n.DEPTH_WRITE)
            }, function (t) {
                this._shaderValues.setBool(n.DEPTH_WRITE, t)
            }), u(0, e, "cull", function () {
                return this._shaderValues.getInt(n.CULL)
            }, function (t) {
                this._shaderValues.setInt(n.CULL, t)
            }), u(0, e, "blendDst", function () {
                return this._shaderValues.getInt(n.BLEND_DST)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND_DST, t)
            }), u(0, e, "depthTest", function () {
                return this._shaderValues.getInt(n.DEPTH_TEST)
            }, function (t) {
                this._shaderValues.setInt(n.DEPTH_TEST, t)
            }), n.__init__ = function () {
                n.SHADERDEFINE_DIFFUSEMAP = n.shaderDefines.registerDefine("DIFFUSEMAP"), n.SHADERDEFINE_TINTCOLOR = n.shaderDefines.registerDefine("TINTCOLOR"), n.SHADERDEFINE_ADDTIVEFOG = n.shaderDefines.registerDefine("ADDTIVEFOG"), n.SHADERDEFINE_TILINGOFFSET = n.shaderDefines.registerDefine("TILINGOFFSET")
            }, n.RENDERMODE_ALPHABLENDED = 0, n.RENDERMODE_ADDTIVE = 1, n.SHADERDEFINE_DIFFUSEMAP = 0, n.SHADERDEFINE_TINTCOLOR = 0, n.SHADERDEFINE_TILINGOFFSET = 0, n.SHADERDEFINE_ADDTIVEFOG = 0, _(n, ["DIFFUSETEXTURE", function () {
                return this.DIFFUSETEXTURE = Pt.propertyNameToID("u_texture")
            }, "TINTCOLOR", function () {
                return this.TINTCOLOR = Pt.propertyNameToID("u_Tintcolor")
            }, "TILINGOFFSET", function () {
                return this.TILINGOFFSET = Pt.propertyNameToID("u_TilingOffset")
            }, "CULL", function () {
                return this.CULL = Pt.propertyNameToID("s_Cull")
            }, "BLEND", function () {
                return this.BLEND = Pt.propertyNameToID("s_Blend")
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Pt.propertyNameToID("s_BlendSrc")
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Pt.propertyNameToID("s_BlendDst")
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Pt.propertyNameToID("s_DepthTest")
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Pt.propertyNameToID("s_DepthWrite")
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new n
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), n
        }(), li = function (t) {
            function n() {
                this._color = null, n.__super.call(this), this.setShaderName("Effect"), this._color = new Ct(1, 1, 1, 1), this._shaderValues.setVector(n.TINTCOLOR, new Ct(1, 1, 1, 1)), this.renderMode = 0
            }

            d(n, "laya.d3.core.material.EffectMaterial", Bn);
            var e = n.prototype;
            return u(0, e, "_TintColorB", function () {
                return this._color.z
            }, function (t) {
                this._color.z = t, this.color = this._color
            }), u(0, e, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).z
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.z = t, this.tilingOffset = e
            }), u(0, e, "texture", function () {
                return this._shaderValues.getTexture(n.MAINTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.EffectMaterial.SHADERDEFINE_MAINTEXTURE) : this._defineDatas.remove(laya.d3.core.material.EffectMaterial.SHADERDEFINE_MAINTEXTURE), this._shaderValues.setTexture(n.MAINTEXTURE, t)
            }), u(0, e, "_TintColorR", function () {
                return this._color.x
            }, function (t) {
                this._color.x = t, this.color = this._color
            }), u(0, e, "_MainTex_STW", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).w
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.w = t, this.tilingOffset = e
            }), u(0, e, "_TintColorG", function () {
                return this._color.y
            }, function (t) {
                this._color.y = t, this.color = this._color
            }), u(0, e, "_TintColorA", function () {
                return this._color.w
            }, function (t) {
                this._color.w = t, this.color = this._color
            }), u(0, e, "_MainTex_STY", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).y
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.y = t, this.tilingOffset = e
            }), u(0, e, "renderMode", null, function (t) {
                switch (t) {
                    case 0:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 0, this.blend = 1, this.blendSrc = 770, this.blendDst = 1, this.depthTest = 513, this._defineDatas.add(n.SHADERDEFINE_ADDTIVEFOG);
                        break;
                    case 1:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 0, this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513, this._defineDatas.remove(n.SHADERDEFINE_ADDTIVEFOG);
                        break;
                    default:
                        throw new Error("MeshEffectMaterial : renderMode value error.")
                }
            }), u(0, e, "_MainTex_STX", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET).x
            }, function (t) {
                var e = this._shaderValues.getVector(n.TILINGOFFSET);
                e.x = t, this.tilingOffset = e
            }), u(0, e, "colorR", function () {
                return this._TintColorR
            }, function (t) {
                this._TintColorR = t
            }), u(0, e, "colorG", function () {
                return this._TintColorG
            }, function (t) {
                this._TintColorG = t
            }), u(0, e, "colorB", function () {
                return this._TintColorB
            }, function (t) {
                this._TintColorB = t
            }), u(0, e, "colorA", function () {
                return this._TintColorA
            }, function (t) {
                this._TintColorA = t
            }), u(0, e, "blend", function () {
                return this._shaderValues.getInt(n.BLEND)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND, t)
            }), u(0, e, "color", function () {
                return this._shaderValues.getVector(n.TINTCOLOR)
            }, function (t) {
                this._shaderValues.setVector(n.TINTCOLOR, t)
            }), u(0, e, "tilingOffsetX", function () {
                return this._MainTex_STX
            }, function (t) {
                this._MainTex_STX = t
            }), u(0, e, "tilingOffsetY", function () {
                return this._MainTex_STY
            }, function (t) {
                this._MainTex_STY = t
            }), u(0, e, "tilingOffsetZ", function () {
                return this._MainTex_STZ
            }, function (t) {
                this._MainTex_STZ = t
            }), u(0, e, "blendSrc", function () {
                return this._shaderValues.getInt(n.BLEND_SRC)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND_SRC, t)
            }), u(0, e, "tilingOffsetW", function () {
                return this._MainTex_STW
            }, function (t) {
                this._MainTex_STW = t
            }), u(0, e, "tilingOffset", function () {
                return this._shaderValues.getVector(n.TILINGOFFSET)
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.material.EffectMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.material.EffectMaterial.SHADERDEFINE_TILINGOFFSET), this._shaderValues.setVector(n.TILINGOFFSET, t)
            }), u(0, e, "depthWrite", function () {
                return this._shaderValues.getBool(n.DEPTH_WRITE)
            }, function (t) {
                this._shaderValues.setBool(n.DEPTH_WRITE, t)
            }), u(0, e, "cull", function () {
                return this._shaderValues.getInt(n.CULL)
            }, function (t) {
                this._shaderValues.setInt(n.CULL, t)
            }), u(0, e, "blendDst", function () {
                return this._shaderValues.getInt(n.BLEND_DST)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND_DST, t)
            }), u(0, e, "depthTest", function () {
                return this._shaderValues.getInt(n.DEPTH_TEST)
            }, function (t) {
                this._shaderValues.setInt(n.DEPTH_TEST, t)
            }), n.__init__ = function () {
                n.SHADERDEFINE_MAINTEXTURE = n.shaderDefines.registerDefine("MAINTEXTURE"), n.SHADERDEFINE_TILINGOFFSET = n.shaderDefines.registerDefine("TILINGOFFSET"), n.SHADERDEFINE_ADDTIVEFOG = n.shaderDefines.registerDefine("ADDTIVEFOG")
            }, n.RENDERMODE_ADDTIVE = 0, n.RENDERMODE_ALPHABLENDED = 1, n.SHADERDEFINE_MAINTEXTURE = 0, n.SHADERDEFINE_TILINGOFFSET = 0, n.SHADERDEFINE_ADDTIVEFOG = 0, _(n, ["defaultMaterial", function () {
                return this.defaultMaterial = new n
            }, "MAINTEXTURE", function () {
                return this.MAINTEXTURE = Pt.propertyNameToID("u_AlbedoTexture")
            }, "TINTCOLOR", function () {
                return this.TINTCOLOR = Pt.propertyNameToID("u_AlbedoColor")
            }, "TILINGOFFSET", function () {
                return this.TILINGOFFSET = Pt.propertyNameToID("u_TilingOffset")
            }, "CULL", function () {
                return this.CULL = Pt.propertyNameToID("s_Cull")
            }, "BLEND", function () {
                return this.BLEND = Pt.propertyNameToID("s_Blend")
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Pt.propertyNameToID("s_BlendSrc")
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Pt.propertyNameToID("s_BlendDst")
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Pt.propertyNameToID("s_DepthTest")
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Pt.propertyNameToID("s_DepthWrite")
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), n
        }(), hi = function (t) {
            function e() {
                e.__super.call(this), this.setShaderName("WaterPrimary"), this._shaderValues.setVector(e.HORIZONCOLOR, new Ct(.172, .463, .435, 0)), this._shaderValues.setNumber(e.WAVESCALE, .15), this._shaderValues.setVector(e.WAVESPEED, new Ct(19, 9, -16, -7))
            }

            d(e, "laya.d3.core.material.WaterPrimaryMaterial", Bn);
            var n = e.prototype;
            return u(0, n, "waveSpeed", function () {
                return this._shaderValues.getVector(e.WAVESPEED)
            }, function (t) {
                this._shaderValues.setVector(e.WAVESPEED, t)
            }), u(0, n, "horizonColor", function () {
                return this._shaderValues.getVector(e.HORIZONCOLOR)
            }, function (t) {
                this._shaderValues.setVector(e.HORIZONCOLOR, t)
            }), u(0, n, "mainTexture", function () {
                return this._shaderValues.getTexture(e.MAINTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.WaterPrimaryMaterial.SHADERDEFINE_MAINTEXTURE) : this._defineDatas.remove(laya.d3.core.material.WaterPrimaryMaterial.SHADERDEFINE_MAINTEXTURE), this._shaderValues.setTexture(e.MAINTEXTURE, t)
            }), u(0, n, "normalTexture", function () {
                return this._shaderValues.getTexture(e.NORMALTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.WaterPrimaryMaterial.SHADERDEFINE_NORMALTEXTURE) : this._defineDatas.remove(laya.d3.core.material.WaterPrimaryMaterial.SHADERDEFINE_NORMALTEXTURE), this._shaderValues.setTexture(e.NORMALTEXTURE, t)
            }), u(0, n, "waveScale", function () {
                return this._shaderValues.getNumber(e.WAVESCALE)
            }, function (t) {
                this._shaderValues.setNumber(e.WAVESCALE, t)
            }), e.__init__ = function () {
                e.SHADERDEFINE_MAINTEXTURE = e.shaderDefines.registerDefine("MAINTEXTURE"), e.SHADERDEFINE_NORMALTEXTURE = e.shaderDefines.registerDefine("NORMALTEXTURE")
            }, e.SHADERDEFINE_MAINTEXTURE = 0, e.SHADERDEFINE_NORMALTEXTURE = 0, _(e, ["HORIZONCOLOR", function () {
                return this.HORIZONCOLOR = Pt.propertyNameToID("u_HorizonColor")
            }, "MAINTEXTURE", function () {
                return this.MAINTEXTURE = Pt.propertyNameToID("u_MainTexture")
            }, "NORMALTEXTURE", function () {
                return this.NORMALTEXTURE = Pt.propertyNameToID("u_NormalTexture")
            }, "WAVESCALE", function () {
                return this.WAVESCALE = Pt.propertyNameToID("u_WaveScale")
            }, "WAVESPEED", function () {
                return this.WAVESPEED = Pt.propertyNameToID("u_WaveSpeed")
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new e
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), e
        }(), ui = function (t) {
            function e() {
                this._enableLighting = !0, e.__super.call(this), this.setShaderName("ExtendTerrain"), this.renderMode = 1
            }

            d(e, "laya.d3.core.material.ExtendTerrainMaterial", Bn);
            var n = e.prototype;
            return n._setDetailNum = function (t) {
                switch (t) {
                    case 1:
                        this._defineDatas.add(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);
                        break;
                    case 2:
                        this._defineDatas.add(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);
                        break;
                    case 3:
                        this._defineDatas.add(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);
                        break;
                    case 4:
                        this._defineDatas.add(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);
                        break;
                    case 5:
                        this._defineDatas.add(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3), this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4)
                }
            }, u(0, n, "diffuseScaleOffset2", null, function (t) {
                this._shaderValues.setVector(e.DIFFUSESCALEOFFSET2, t)
            }), u(0, n, "splatAlphaTexture", function () {
                return this._shaderValues.getTexture(e.SPLATALPHATEXTURE)
            }, function (t) {
                this._shaderValues.setTexture(e.SPLATALPHATEXTURE, t)
            }), u(0, n, "diffuseScaleOffset3", null, function (t) {
                this._shaderValues.setVector(e.DIFFUSESCALEOFFSET3, t)
            }), u(0, n, "diffuseTexture1", null, function (t) {
                this._shaderValues.setTexture(e.DIFFUSETEXTURE1, t), this._setDetailNum(1)
            }), u(0, n, "renderMode", null, function (t) {
                switch (t) {
                    case 1:
                        this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513;
                        break;
                    case 2:
                        this.renderQueue = 2e3, this.depthWrite = !1, this.cull = 2, this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 515;
                        break;
                    default:
                        throw new Error("ExtendTerrainMaterial:renderMode value error.")
                }
            }), u(0, n, "diffuseTexture2", function () {
                return this._shaderValues.getTexture(e.DIFFUSETEXTURE2)
            }, function (t) {
                this._shaderValues.setTexture(e.DIFFUSETEXTURE2, t), this._setDetailNum(2)
            }), u(0, n, "diffuseScaleOffset1", null, function (t) {
                this._shaderValues.setVector(e.DIFFUSESCALEOFFSET1, t)
            }), u(0, n, "diffuseTexture3", function () {
                return this._shaderValues.getTexture(e.DIFFUSETEXTURE3)
            }, function (t) {
                this._shaderValues.setTexture(e.DIFFUSETEXTURE3, t), this._setDetailNum(3)
            }), u(0, n, "diffuseTexture4", function () {
                return this._shaderValues.getTexture(e.DIFFUSETEXTURE4)
            }, function (t) {
                this._shaderValues.setTexture(e.DIFFUSETEXTURE4, t), this._setDetailNum(4)
            }), u(0, n, "diffuseTexture5", function () {
                return this._shaderValues.getTexture(e.DIFFUSETEXTURE5)
            }, function (t) {
                this._shaderValues.setTexture(e.DIFFUSETEXTURE5, t), this._setDetailNum(5)
            }), u(0, n, "diffuseScaleOffset4", null, function (t) {
                this._shaderValues.setVector(e.DIFFUSESCALEOFFSET4, t)
            }), u(0, n, "diffuseScaleOffset5", null, function (t) {
                this._shaderValues.setVector(e.DIFFUSESCALEOFFSET5, t)
            }), u(0, n, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC)
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t)
            }), u(0, n, "enableLighting", function () {
                return this._enableLighting
            }, function (t) {
                this._enableLighting !== t && (t ? this._disablePublicDefineDatas.remove(Qn.SHADERDEFINE_POINTLIGHT | Qn.SHADERDEFINE_SPOTLIGHT | Qn.SHADERDEFINE_DIRECTIONLIGHT) : this._disablePublicDefineDatas.add(Qn.SHADERDEFINE_POINTLIGHT | Qn.SHADERDEFINE_SPOTLIGHT | Qn.SHADERDEFINE_DIRECTIONLIGHT), this._enableLighting = t)
            }), u(0, n, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE)
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t)
            }), u(0, n, "cull", function () {
                return this._shaderValues.getInt(e.CULL)
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t)
            }), u(0, n, "blend", function () {
                return this._shaderValues.getInt(e.BLEND)
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t)
            }), u(0, n, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST)
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t)
            }), u(0, n, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST)
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t)
            }), e.__init__ = function () {
                e.SHADERDEFINE_DETAIL_NUM1 = e.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM1"), e.SHADERDEFINE_DETAIL_NUM2 = e.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM2"), e.SHADERDEFINE_DETAIL_NUM3 = e.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM3"), e.SHADERDEFINE_DETAIL_NUM4 = e.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM4"), e.SHADERDEFINE_DETAIL_NUM5 = e.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM5")
            }, e.RENDERMODE_OPAQUE = 1, e.RENDERMODE_TRANSPARENT = 2, e.SHADERDEFINE_DETAIL_NUM1 = 0, e.SHADERDEFINE_DETAIL_NUM2 = 0, e.SHADERDEFINE_DETAIL_NUM3 = 0, e.SHADERDEFINE_DETAIL_NUM4 = 0, e.SHADERDEFINE_DETAIL_NUM5 = 0, _(e, ["SPLATALPHATEXTURE", function () {
                return this.SPLATALPHATEXTURE = Pt.propertyNameToID("u_SplatAlphaTexture")
            }, "DIFFUSETEXTURE1", function () {
                return this.DIFFUSETEXTURE1 = Pt.propertyNameToID("u_DiffuseTexture1")
            }, "DIFFUSETEXTURE2", function () {
                return this.DIFFUSETEXTURE2 = Pt.propertyNameToID("u_DiffuseTexture2")
            }, "DIFFUSETEXTURE3", function () {
                return this.DIFFUSETEXTURE3 = Pt.propertyNameToID("u_DiffuseTexture3")
            }, "DIFFUSETEXTURE4", function () {
                return this.DIFFUSETEXTURE4 = Pt.propertyNameToID("u_DiffuseTexture4")
            }, "DIFFUSETEXTURE5", function () {
                return this.DIFFUSETEXTURE5 = Pt.propertyNameToID("u_DiffuseTexture5")
            }, "DIFFUSESCALEOFFSET1", function () {
                return this.DIFFUSESCALEOFFSET1 = Pt.propertyNameToID("u_DiffuseScaleOffset1")
            }, "DIFFUSESCALEOFFSET2", function () {
                return this.DIFFUSESCALEOFFSET2 = Pt.propertyNameToID("u_DiffuseScaleOffset2")
            }, "DIFFUSESCALEOFFSET3", function () {
                return this.DIFFUSESCALEOFFSET3 = Pt.propertyNameToID("u_DiffuseScaleOffset3")
            }, "DIFFUSESCALEOFFSET4", function () {
                return this.DIFFUSESCALEOFFSET4 = Pt.propertyNameToID("u_DiffuseScaleOffset4")
            }, "DIFFUSESCALEOFFSET5", function () {
                return this.DIFFUSESCALEOFFSET5 = Pt.propertyNameToID("u_DiffuseScaleOffset5")
            }, "CULL", function () {
                return this.CULL = Pt.propertyNameToID("s_Cull")
            }, "BLEND", function () {
                return this.BLEND = Pt.propertyNameToID("s_Blend")
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Pt.propertyNameToID("s_BlendSrc")
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Pt.propertyNameToID("s_BlendDst")
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Pt.propertyNameToID("s_DepthTest")
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Pt.propertyNameToID("s_DepthWrite")
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), e
        }(), ci = function (n) {
            function i() {
                this._enableVertexColor = !1, i.__super.call(this), this.setShaderName("BLINNPHONG"), this._albedoIntensity = 1, this._albedoColor = new Ct(1, 1, 1, 1);
                var t = this._shaderValues;
                t.setVector(i.ALBEDOCOLOR, new Ct(1, 1, 1, 1)), t.setVector(i.MATERIALSPECULAR, new Ct(1, 1, 1, 1)), t.setNumber(i.SHININESS, .078125), t.setNumber(Bn.ALPHATESTVALUE, .5), t.setVector(i.TILINGOFFSET, new Ct(1, 1, 0, 0)), this._enableLighting = !0, this.renderMode = 0
            }

            d(i, "laya.d3.core.material.BlinnPhongMaterial", n);
            var t = i.prototype;
            return t.disableFog = function () {
                this._disablePublicDefineDatas.add(Qn.SHADERDEFINE_FOG)
            }, t.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                e._enableLighting = this._enableLighting, e._albedoIntensity = this._albedoIntensity, e._enableVertexColor = this._enableVertexColor, this._albedoColor.cloneTo(e._albedoColor)
            }, u(0, t, "_SpecColorG", function () {
                return this._shaderValues.getVector(i.MATERIALSPECULAR).y
            }, function (t) {
                this._shaderValues.getVector(i.MATERIALSPECULAR).y = t
            }), u(0, t, "_ColorB", function () {
                return this._albedoColor.z
            }, function (t) {
                this._albedoColor.z = t, this.albedoColor = this._albedoColor
            }), u(0, t, "_ColorR", function () {
                return this._albedoColor.x
            }, function (t) {
                this._albedoColor.x = t, this.albedoColor = this._albedoColor
            }), u(0, t, "albedoColorA", function () {
                return this._ColorA
            }, function (t) {
                this._ColorA = t
            }), u(0, t, "_MainTex_STX", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).x
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.x = t, this.tilingOffset = e
            }), u(0, t, "_SpecColorB", function () {
                return this._shaderValues.getVector(i.MATERIALSPECULAR).z
            }, function (t) {
                this._shaderValues.getVector(i.MATERIALSPECULAR).z = t
            }), u(0, t, "renderMode", null, function (t) {
                switch (t) {
                    case 0:
                        this.alphaTest = !1, this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513;
                        break;
                    case 1:
                        this.renderQueue = 2450, this.alphaTest = !0, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513;
                        break;
                    case 2:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2, this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513;
                        break;
                    default:
                        throw new Error("Material:renderMode value error.")
                }
            }), u(0, t, "_SpecColorR", function () {
                return this._shaderValues.getVector(i.MATERIALSPECULAR).x
            }, function (t) {
                this._shaderValues.getVector(i.MATERIALSPECULAR).x = t
            }), u(0, t, "_ColorG", function () {
                return this._albedoColor.y
            }, function (t) {
                this._albedoColor.y = t, this.albedoColor = this._albedoColor
            }), u(0, t, "_ColorA", function () {
                return this._albedoColor.w
            }, function (t) {
                this._albedoColor.w = t, this.albedoColor = this._albedoColor
            }), u(0, t, "specularColor", function () {
                return this._shaderValues.getVector(i.MATERIALSPECULAR)
            }, function (t) {
                this._shaderValues.setVector(i.MATERIALSPECULAR, t)
            }), u(0, t, "albedoColorB", function () {
                return this._ColorB
            }, function (t) {
                this._ColorB = t
            }), u(0, t, "_SpecColorA", function () {
                return this._shaderValues.getVector(i.MATERIALSPECULAR).w
            }, function (t) {
                this._shaderValues.getVector(i.MATERIALSPECULAR).w = t
            }), u(0, t, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).z
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.z = t, this.tilingOffset = e
            }), u(0, t, "_AlbedoIntensity", function () {
                return this._albedoIntensity
            }, function (t) {
                if (this._albedoIntensity !== t) {
                    var e = this._shaderValues.getVector(i.ALBEDOCOLOR);
                    Ct.scale(this._albedoColor, t, e), this._albedoIntensity = t, this._shaderValues.setVector(i.ALBEDOCOLOR, e)
                }
            }), u(0, t, "specularColorA", function () {
                return this._SpecColorA
            }, function (t) {
                this._SpecColorA = t
            }), u(0, t, "_Shininess", function () {
                return this._shaderValues.getNumber(i.SHININESS)
            }, function (t) {
                t = Math.max(0, Math.min(1, t)), this._shaderValues.setNumber(i.SHININESS, t)
            }), u(0, t, "_MainTex_STY", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).y
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.y = t, this.tilingOffset = e
            }), u(0, t, "_Cutoff", function () {
                return this.alphaTestValue
            }, function (t) {
                this.alphaTestValue = t
            }), u(0, t, "_MainTex_STW", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).w
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.w = t, this.tilingOffset = e
            }), u(0, t, "albedoTexture", function () {
                return this._shaderValues.getTexture(i.ALBEDOTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_DIFFUSEMAP) : this._defineDatas.remove(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_DIFFUSEMAP), this._shaderValues.setTexture(i.ALBEDOTEXTURE, t)
            }), u(0, t, "enableVertexColor", function () {
                return this._enableVertexColor
            }, function (t) {
                (this._enableVertexColor = t) ? this._defineDatas.add(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR) : this._defineDatas.remove(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR)
            }), u(0, t, "albedoColor", function () {
                return this._albedoColor
            }, function (t) {
                var e = this._shaderValues.getVector(i.ALBEDOCOLOR);
                Ct.scale(t, this._albedoIntensity, e), this._albedoColor = t, this._shaderValues.setVector(i.ALBEDOCOLOR, e)
            }), u(0, t, "tilingOffsetX", function () {
                return this._MainTex_STX
            }, function (t) {
                this._MainTex_STX = t
            }), u(0, t, "tilingOffsetY", function () {
                return this._MainTex_STY
            }, function (t) {
                this._MainTex_STY = t
            }), u(0, t, "tilingOffsetZ", function () {
                return this._MainTex_STZ
            }, function (t) {
                this._MainTex_STZ = t
            }), u(0, t, "blendSrc", function () {
                return this._shaderValues.getInt(i.BLEND_SRC)
            }, function (t) {
                this._shaderValues.setInt(i.BLEND_SRC, t)
            }), u(0, t, "enableLighting", function () {
                return this._enableLighting
            }, function (t) {
                this._enableLighting !== t && (t ? this._disablePublicDefineDatas.remove(Qn.SHADERDEFINE_POINTLIGHT | Qn.SHADERDEFINE_SPOTLIGHT | Qn.SHADERDEFINE_DIRECTIONLIGHT) : this._disablePublicDefineDatas.add(Qn.SHADERDEFINE_POINTLIGHT | Qn.SHADERDEFINE_SPOTLIGHT | Qn.SHADERDEFINE_DIRECTIONLIGHT), this._enableLighting = t)
            }), u(0, t, "tilingOffsetW", function () {
                return this._MainTex_STW
            }, function (t) {
                this._MainTex_STW = t
            }), u(0, t, "tilingOffset", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET)
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET), this._shaderValues.setVector(i.TILINGOFFSET, t)
            }), u(0, t, "albedoColorR", function () {
                return this._ColorR
            }, function (t) {
                this._ColorR = t
            }), u(0, t, "albedoColorG", function () {
                return this._ColorG
            }, function (t) {
                this._ColorG = t
            }), u(0, t, "albedoIntensity", function () {
                return this._albedoIntensity
            }, function (t) {
                this._AlbedoIntensity = t
            }), u(0, t, "specularColorR", function () {
                return this._SpecColorR
            }, function (t) {
                this._SpecColorR = t
            }), u(0, t, "specularColorG", function () {
                return this._SpecColorG
            }, function (t) {
                this._SpecColorG = t
            }), u(0, t, "specularColorB", function () {
                return this._SpecColorB
            }, function (t) {
                this._SpecColorB = t
            }), u(0, t, "blendDst", function () {
                return this._shaderValues.getInt(i.BLEND_DST)
            }, function (t) {
                this._shaderValues.setInt(i.BLEND_DST, t)
            }), u(0, t, "shininess", function () {
                return this._Shininess
            }, function (t) {
                this._Shininess = t
            }), u(0, t, "cull", function () {
                return this._shaderValues.getInt(i.CULL)
            }, function (t) {
                this._shaderValues.setInt(i.CULL, t)
            }), u(0, t, "normalTexture", function () {
                return this._shaderValues.getTexture(i.NORMALTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_NORMALMAP) : this._defineDatas.remove(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_NORMALMAP), this._shaderValues.setTexture(i.NORMALTEXTURE, t)
            }), u(0, t, "specularTexture", function () {
                return this._shaderValues.getTexture(i.SPECULARTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_SPECULARMAP) : this._defineDatas.remove(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_SPECULARMAP), this._shaderValues.setTexture(i.SPECULARTEXTURE, t)
            }), u(0, t, "depthWrite", function () {
                return this._shaderValues.getBool(i.DEPTH_WRITE)
            }, function (t) {
                this._shaderValues.setBool(i.DEPTH_WRITE, t)
            }), u(0, t, "blend", function () {
                return this._shaderValues.getInt(i.BLEND)
            }, function (t) {
                this._shaderValues.setInt(i.BLEND, t)
            }), u(0, t, "depthTest", function () {
                return this._shaderValues.getInt(i.DEPTH_TEST)
            }, function (t) {
                this._shaderValues.setInt(i.DEPTH_TEST, t)
            }), i.__init__ = function () {
                i.SHADERDEFINE_DIFFUSEMAP = i.shaderDefines.registerDefine("DIFFUSEMAP"), i.SHADERDEFINE_NORMALMAP = i.shaderDefines.registerDefine("NORMALMAP"), i.SHADERDEFINE_SPECULARMAP = i.shaderDefines.registerDefine("SPECULARMAP"), i.SHADERDEFINE_TILINGOFFSET = i.shaderDefines.registerDefine("TILINGOFFSET"), i.SHADERDEFINE_ENABLEVERTEXCOLOR = i.shaderDefines.registerDefine("ENABLEVERTEXCOLOR")
            }, i.SPECULARSOURCE_DIFFUSEMAPALPHA = 0, i.SPECULARSOURCE_SPECULARMAP = 0, i.RENDERMODE_OPAQUE = 0, i.RENDERMODE_CUTOUT = 1, i.RENDERMODE_TRANSPARENT = 2, i.SHADERDEFINE_DIFFUSEMAP = 0, i.SHADERDEFINE_NORMALMAP = 0, i.SHADERDEFINE_SPECULARMAP = 0, i.SHADERDEFINE_TILINGOFFSET = 0, i.SHADERDEFINE_ENABLEVERTEXCOLOR = 0, _(i, ["ALBEDOTEXTURE", function () {
                return this.ALBEDOTEXTURE = Pt.propertyNameToID("u_DiffuseTexture")
            }, "NORMALTEXTURE", function () {
                return this.NORMALTEXTURE = Pt.propertyNameToID("u_NormalTexture")
            }, "SPECULARTEXTURE", function () {
                return this.SPECULARTEXTURE = Pt.propertyNameToID("u_SpecularTexture")
            }, "ALBEDOCOLOR", function () {
                return this.ALBEDOCOLOR = Pt.propertyNameToID("u_DiffuseColor")
            }, "MATERIALSPECULAR", function () {
                return this.MATERIALSPECULAR = Pt.propertyNameToID("u_MaterialSpecular")
            }, "SHININESS", function () {
                return this.SHININESS = Pt.propertyNameToID("u_Shininess")
            }, "TILINGOFFSET", function () {
                return this.TILINGOFFSET = Pt.propertyNameToID("u_TilingOffset")
            }, "CULL", function () {
                return this.CULL = Pt.propertyNameToID("s_Cull")
            }, "BLEND", function () {
                return this.BLEND = Pt.propertyNameToID("s_Blend")
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Pt.propertyNameToID("s_BlendSrc")
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Pt.propertyNameToID("s_BlendDst")
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Pt.propertyNameToID("s_DepthTest")
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Pt.propertyNameToID("s_DepthWrite")
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new i
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), i
        }(Bn), _i = function (e) {
            function n() {
                this._diffuseScale1 = null, this._diffuseScale2 = null, this._diffuseScale3 = null, this._diffuseScale4 = null, n.__super.call(this), this.setShaderName("Terrain"), this.renderMode = 1, this._diffuseScale1 = new Ot, this._diffuseScale2 = new Ot, this._diffuseScale3 = new Ot, this._diffuseScale4 = new Ot, this.ambientColor = new Lt(.6, .6, .6), this.diffuseColor = new Lt(1, 1, 1), this.specularColor = new Ct(.2, .2, .2, 32)
            }

            d(n, "laya.d3.core.material.TerrainMaterial", e);
            var t = n.prototype;
            return t.setDiffuseScale1 = function (t, e) {
                this._diffuseScale1.x = t, this._diffuseScale1.y = e, this._shaderValues.setVector2(6, this._diffuseScale1)
            }, t.setDiffuseScale2 = function (t, e) {
                this._diffuseScale2.x = t, this._diffuseScale2.y = e, this._shaderValues.setVector2(7, this._diffuseScale2)
            }, t.setDiffuseScale3 = function (t, e) {
                this._diffuseScale3.x = t, this._diffuseScale3.y = e, this._shaderValues.setVector2(8, this._diffuseScale3)
            }, t.setDiffuseScale4 = function (t, e) {
                this._diffuseScale4.x = t, this._diffuseScale4.y = e, this._shaderValues.setVector2(9, this._diffuseScale4)
            }, t.setDetailNum = function (t) {
                switch (t) {
                    case 1:
                        this._defineDatas.add(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4);
                        break;
                    case 2:
                        this._defineDatas.add(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4);
                        break;
                    case 3:
                        this._defineDatas.add(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4);
                        break;
                    case 4:
                        this._defineDatas.add(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2), this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3)
                }
            }, t.disableLight = function () {
                this._disablePublicDefineDatas.add(Qn.SHADERDEFINE_POINTLIGHT | Qn.SHADERDEFINE_SPOTLIGHT | Qn.SHADERDEFINE_DIRECTIONLIGHT)
            }, t.setShaderName = function (t) {
                e.prototype.setShaderName.call(this, t)
            }, u(0, t, "renderMode", null, function (t) {
                switch (t) {
                    case 1:
                        this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513;
                        break;
                    case 2:
                        this.renderQueue = 2e3, this.depthWrite = !1, this.cull = 2, this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 515;
                        break;
                    default:
                        throw new Error("TerrainMaterial:renderMode value error.")
                }
            }), u(0, t, "diffuseTexture2", function () {
                return this._shaderValues.getTexture(3)
            }, function (t) {
                this._shaderValues.setTexture(3, t)
            }), u(0, t, "ambientColor", function () {
                return this._shaderValues.getVector(10)
            }, function (t) {
                this._shaderValues.setVector3(10, t)
            }), u(0, t, "diffuseTexture4", function () {
                return this._shaderValues.getTexture(5)
            }, function (t) {
                this._shaderValues.setTexture(5, t)
            }), u(0, t, "diffuseColor", function () {
                return this._shaderValues.getVector(11)
            }, function (t) {
                this._shaderValues.setVector3(11, t)
            }), u(0, t, "diffuseTexture1", function () {
                return this._shaderValues.getTexture(2)
            }, function (t) {
                this._shaderValues.setTexture(2, t)
            }), u(0, t, "specularColor", function () {
                return this._shaderValues.getVector(12)
            }, function (t) {
                this._shaderValues.setVector(12, t)
            }), u(0, t, "diffuseTexture3", function () {
                return this._shaderValues.getTexture(4)
            }, function (t) {
                this._shaderValues.setTexture(4, t)
            }), u(0, t, "splatAlphaTexture", function () {
                return this._shaderValues.getTexture(0)
            }, function (t) {
                this._shaderValues.setTexture(0, t)
            }), u(0, t, "cull", function () {
                return this._shaderValues.getInt(n.CULL)
            }, function (t) {
                this._shaderValues.setInt(n.CULL, t)
            }), u(0, t, "normalTexture", function () {
                return this._shaderValues.getTexture(1)
            }, function (t) {
                this._shaderValues.setTexture(1, t)
            }), u(0, t, "depthWrite", function () {
                return this._shaderValues.getBool(n.DEPTH_WRITE)
            }, function (t) {
                this._shaderValues.setBool(n.DEPTH_WRITE, t)
            }), u(0, t, "blend", function () {
                return this._shaderValues.getInt(n.BLEND)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND, t)
            }), u(0, t, "blendSrc", function () {
                return this._shaderValues.getInt(n.BLEND_SRC)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND_SRC, t)
            }), u(0, t, "blendDst", function () {
                return this._shaderValues.getInt(n.BLEND_DST)
            }, function (t) {
                this._shaderValues.setInt(n.BLEND_DST, t)
            }), u(0, t, "depthTest", function () {
                return this._shaderValues.getInt(n.DEPTH_TEST)
            }, function (t) {
                this._shaderValues.setInt(n.DEPTH_TEST, t)
            }), n.__init__ = function () {
                n.SHADERDEFINE_DETAIL_NUM1 = n.shaderDefines.registerDefine("DETAIL_NUM1"), n.SHADERDEFINE_DETAIL_NUM2 = n.shaderDefines.registerDefine("DETAIL_NUM2"), n.SHADERDEFINE_DETAIL_NUM4 = n.shaderDefines.registerDefine("DETAIL_NUM4"), n.SHADERDEFINE_DETAIL_NUM3 = n.shaderDefines.registerDefine("DETAIL_NUM3")
            }, n.RENDERMODE_OPAQUE = 1, n.RENDERMODE_TRANSPARENT = 2, n.SPLATALPHATEXTURE = 0, n.NORMALTEXTURE = 1, n.DIFFUSETEXTURE1 = 2, n.DIFFUSETEXTURE2 = 3, n.DIFFUSETEXTURE3 = 4, n.DIFFUSETEXTURE4 = 5, n.DIFFUSESCALE1 = 6, n.DIFFUSESCALE2 = 7, n.DIFFUSESCALE3 = 8, n.DIFFUSESCALE4 = 9, n.MATERIALAMBIENT = 10, n.MATERIALDIFFUSE = 11, n.MATERIALSPECULAR = 12, n.SHADERDEFINE_DETAIL_NUM1 = 0, n.SHADERDEFINE_DETAIL_NUM2 = 0, n.SHADERDEFINE_DETAIL_NUM3 = 0, n.SHADERDEFINE_DETAIL_NUM4 = 0, _(n, ["CULL", function () {
                return this.CULL = Pt.propertyNameToID("s_Cull")
            }, "BLEND", function () {
                return this.BLEND = Pt.propertyNameToID("s_Blend")
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Pt.propertyNameToID("s_BlendSrc")
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Pt.propertyNameToID("s_BlendDst")
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Pt.propertyNameToID("s_DepthTest")
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Pt.propertyNameToID("s_DepthWrite")
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new n
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), n
        }(Bn), di = function (t) {
            function e() {
                e.__super.call(this), this.setShaderName("SkyBox")
            }

            d(e, "laya.d3.core.material.SkyBoxMaterial", Bn);
            var n = e.prototype;
            return u(0, n, "tintColor", function () {
                return this._shaderValues.getVector(e.TINTCOLOR)
            }, function (t) {
                this._shaderValues.setVector(e.TINTCOLOR, t)
            }), u(0, n, "exposure", function () {
                return this._shaderValues.getNumber(e.EXPOSURE)
            }, function (t) {
                this._shaderValues.setNumber(e.EXPOSURE, t)
            }), u(0, n, "rotation", function () {
                return this._shaderValues.getNumber(e.ROTATION)
            }, function (t) {
                this._shaderValues.setNumber(e.ROTATION, t)
            }), u(0, n, "textureCube", function () {
                return this._shaderValues.getTexture(e.TEXTURECUBE)
            }, function (t) {
                this._shaderValues.setTexture(e.TEXTURECUBE, t)
            }), _(e, ["TINTCOLOR", function () {
                return this.TINTCOLOR = Pt.propertyNameToID("u_TintColor")
            }, "EXPOSURE", function () {
                return this.EXPOSURE = Pt.propertyNameToID("u_Exposure")
            }, "ROTATION", function () {
                return this.ROTATION = Pt.propertyNameToID("u_Rotation")
            }, "TEXTURECUBE", function () {
                return this.TEXTURECUBE = Pt.propertyNameToID("u_CubeTexture")
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new e
            }]), e
        }(), fi = function (n) {
            function i() {
                this._albedoColor = null, this._specularColor = null, this._emissionColor = null, i.__super.call(this), this.setShaderName("PBRSpecular"), this._albedoColor = new Ct(1, 1, 1, 1), this._shaderValues.setVector(i.ALBEDOCOLOR, new Ct(1, 1, 1, 1)), this._emissionColor = new Ct(0, 0, 0, 0), this._shaderValues.setVector(i.EMISSIONCOLOR, new Ct(0, 0, 0, 0)), this._specularColor = new Ct(.2, .2, .2, .2), this._shaderValues.setVector(i.SPECULARCOLOR, new Ct(.2, .2, .2, .2)), this._shaderValues.setNumber(i.SMOOTHNESS, .5), this._shaderValues.setNumber(i.SMOOTHNESSSCALE, 1), this._shaderValues.setNumber(i.SMOOTHNESSSOURCE, 0), this._shaderValues.setNumber(i.OCCLUSIONSTRENGTH, 1), this._shaderValues.setNumber(i.NORMALSCALE, 1), this._shaderValues.setNumber(i.PARALLAXSCALE, .001), this._shaderValues.setBool(i.ENABLEEMISSION, !1), this._shaderValues.setNumber(Bn.ALPHATESTVALUE, .5), this.renderMode = 0
            }

            d(i, "laya.d3.core.material.PBRSpecularMaterial", n);
            var t = i.prototype;
            return t.cloneTo = function (t) {
                n.prototype.cloneTo.call(this, t);
                var e = t;
                this._albedoColor.cloneTo(e._albedoColor), this._specularColor.cloneTo(e._specularColor), this._emissionColor.cloneTo(e._emissionColor)
            }, u(0, t, "emissionTexture", function () {
                return this._shaderValues.getTexture(i.EMISSIONTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSIONTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSIONTEXTURE), this._shaderValues.setTexture(i.EMISSIONTEXTURE, t)
            }), u(0, t, "_SpecColorG", function () {
                return this._specularColor.y
            }, function (t) {
                this._specularColor.y = t, this.specularColor = this._specularColor
            }), u(0, t, "_ColorB", function () {
                return this._albedoColor.z
            }, function (t) {
                this._albedoColor.z = t, this.albedoColor = this._albedoColor
            }), u(0, t, "_ColorR", function () {
                return this._albedoColor.x
            }, function (t) {
                this._albedoColor.x = t, this.albedoColor = this._albedoColor
            }), u(0, t, "albedoColorA", function () {
                return this._ColorA
            }, function (t) {
                this._ColorA = t
            }), u(0, t, "_MainTex_STX", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).x
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.x = t, this.tilingOffset = e
            }), u(0, t, "_SpecColorB", function () {
                return this._specularColor.z
            }, function (t) {
                this._specularColor.z = t, this.specularColor = this._specularColor
            }), u(0, t, "renderMode", null, function (t) {
                switch (t) {
                    case 0:
                        this.alphaTest = !1, this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513, this._defineDatas.remove(i.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;
                    case 1:
                        this.renderQueue = 2450, this.alphaTest = !0, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513, this._defineDatas.remove(i.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;
                    case 2:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2, this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513, this._defineDatas.remove(i.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;
                    case 3:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2, this.blend = 1, this.blendSrc = 1, this.blendDst = 771, this.depthTest = 513, this._defineDatas.add(i.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;
                    default:
                        throw new Error("PBRSpecularMaterial : renderMode value error.")
                }
            }), u(0, t, "_SpecColorR", function () {
                return this._specularColor.x
            }, function (t) {
                this._specularColor.x = t, this.specularColor = this._specularColor
            }), u(0, t, "_ColorG", function () {
                return this._albedoColor.y
            }, function (t) {
                this._albedoColor.y = t, this.albedoColor = this._albedoColor
            }), u(0, t, "_Glossiness", function () {
                return this._shaderValues.getNumber(i.SMOOTHNESS)
            }, function (t) {
                this._shaderValues.setNumber(i.SMOOTHNESS, t)
            }), u(0, t, "_ColorA", function () {
                return this._albedoColor.w
            }, function (t) {
                this._albedoColor.w = t, this.albedoColor = this._albedoColor
            }), u(0, t, "specularColor", function () {
                return this._shaderValues.getVector(i.SPECULARCOLOR)
            }, function (t) {
                this._shaderValues.setVector(i.SPECULARCOLOR, t)
            }), u(0, t, "albedoColorB", function () {
                return this._ColorB
            }, function (t) {
                this._ColorB = t
            }), u(0, t, "_SpecColorA", function () {
                return this._specularColor.w
            }, function (t) {
                this._specularColor.w = t, this.specularColor = this._specularColor
            }), u(0, t, "_GlossMapScale", function () {
                return this._shaderValues.getNumber(i.SMOOTHNESSSCALE)
            }, function (t) {
                this._shaderValues.setNumber(i.SMOOTHNESSSCALE, t)
            }), u(0, t, "_BumpScale", function () {
                return this._shaderValues.getNumber(i.NORMALSCALE)
            }, function (t) {
                this._shaderValues.setNumber(i.NORMALSCALE, t)
            }), u(0, t, "_Parallax", function () {
                return this._shaderValues.getNumber(i.PARALLAXSCALE)
            }, function (t) {
                this._shaderValues.setNumber(i.PARALLAXSCALE, t)
            }), u(0, t, "_OcclusionStrength", function () {
                return this._shaderValues.getNumber(i.OCCLUSIONSTRENGTH)
            }, function (t) {
                this._shaderValues.setNumber(i.OCCLUSIONSTRENGTH, t)
            }), u(0, t, "_EmissionColorR", function () {
                return this._emissionColor.x
            }, function (t) {
                this._emissionColor.x = t, this.emissionColor = this._emissionColor
            }), u(0, t, "tilingOffset", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET)
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_TILINGOFFSET), this._shaderValues.setVector(i.TILINGOFFSET, t)
            }), u(0, t, "_EmissionColorG", function () {
                return this._emissionColor.y
            }, function (t) {
                this._emissionColor.y = t, this.emissionColor = this._emissionColor
            }), u(0, t, "blendSrc", function () {
                return this._shaderValues.getInt(i.BLEND_SRC)
            }, function (t) {
                this._shaderValues.setInt(i.BLEND_SRC, t)
            }), u(0, t, "tilingOffsetW", function () {
                return this._MainTex_STW
            }, function (t) {
                this._MainTex_STW = t
            }), u(0, t, "_EmissionColorB", function () {
                return this._emissionColor.z
            }, function (t) {
                this._emissionColor.z = t, this.emissionColor = this._emissionColor
            }), u(0, t, "_EmissionColorA", function () {
                return this._emissionColor.w
            }, function (t) {
                this._emissionColor.w = t, this.emissionColor = this._emissionColor
            }), u(0, t, "_MainTex_STY", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).y
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.y = t, this.tilingOffset = e
            }), u(0, t, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).z
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.z = t, this.tilingOffset = e
            }), u(0, t, "_Cutoff", function () {
                return this.alphaTestValue
            }, function (t) {
                this.alphaTestValue = t
            }), u(0, t, "_MainTex_STW", function () {
                return this._shaderValues.getVector(i.TILINGOFFSET).w
            }, function (t) {
                var e = this._shaderValues.getVector(i.TILINGOFFSET);
                e.w = t, this.tilingOffset = e
            }), u(0, t, "albedoColorR", function () {
                return this._ColorR
            }, function (t) {
                this._ColorR = t
            }), u(0, t, "albedoColorG", function () {
                return this._ColorG
            }, function (t) {
                this._ColorG = t
            }), u(0, t, "tilingOffsetX", function () {
                return this._MainTex_STX
            }, function (t) {
                this._MainTex_STX = t
            }), u(0, t, "albedoColor", function () {
                return this._albedoColor
            }, function (t) {
                this._albedoColor = t, this._shaderValues.setVector(i.ALBEDOCOLOR, t)
            }), u(0, t, "albedoTexture", function () {
                return this._shaderValues.getTexture(i.ALBEDOTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_ALBEDOTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_ALBEDOTEXTURE), this._shaderValues.setTexture(i.ALBEDOTEXTURE, t)
            }), u(0, t, "cull", function () {
                return this._shaderValues.getInt(i.CULL)
            }, function (t) {
                this._shaderValues.setInt(i.CULL, t)
            }), u(0, t, "parallaxTexture", function () {
                return this._shaderValues.getTexture(i.PARALLAXTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_PARALLAXTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_PARALLAXTEXTURE), this._shaderValues.setTexture(i.PARALLAXTEXTURE, t)
            }), u(0, t, "normalTexture", function () {
                return this._shaderValues.getTexture(i.NORMALTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_NORMALTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_NORMALTEXTURE), this._shaderValues.setTexture(i.NORMALTEXTURE, t)
            }), u(0, t, "emissionColor", function () {
                return this._shaderValues.getVector(i.EMISSIONCOLOR)
            }, function (t) {
                this._shaderValues.setVector(i.EMISSIONCOLOR, t)
            }), u(0, t, "parallaxTextureScale", function () {
                return this._Parallax
            }, function (t) {
                this._Parallax = Math.max(.005, Math.min(.08, t))
            }), u(0, t, "normalTextureScale", function () {
                return this._BumpScale
            }, function (t) {
                this._BumpScale = t
            }), u(0, t, "tilingOffsetZ", function () {
                return this._MainTex_STZ
            }, function (t) {
                this._MainTex_STZ = t
            }), u(0, t, "occlusionTexture", function () {
                return this._shaderValues.getTexture(i.OCCLUSIONTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_OCCLUSIONTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_OCCLUSIONTEXTURE), this._shaderValues.setTexture(i.OCCLUSIONTEXTURE, t)
            }), u(0, t, "occlusionTextureStrength", function () {
                return this._OcclusionStrength
            }, function (t) {
                this._OcclusionStrength = Math.max(0, Math.min(1, t))
            }), u(0, t, "specularTexture", function () {
                return this._shaderValues.getTexture(i.SPECULARTEXTURE)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SPECULARTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SPECULARTEXTURE), this._shaderValues.setTexture(i.SPECULARTEXTURE, t)
            }), u(0, t, "specularColorR", function () {
                return this._SpecColorR
            }, function (t) {
                this._SpecColorR = t
            }), u(0, t, "smoothness", function () {
                return this._Glossiness
            }, function (t) {
                this._Glossiness = Math.max(0, Math.min(1, t))
            }), u(0, t, "specularColorG", function () {
                return this._SpecColorG
            }, function (t) {
                this._SpecColorG = t
            }), u(0, t, "specularColorB", function () {
                return this._SpecColorB
            }, function (t) {
                this._SpecColorB = t
            }), u(0, t, "specularColorA", function () {
                return this._SpecColorA
            }, function (t) {
                this._SpecColorA = t
            }), u(0, t, "blendDst", function () {
                return this._shaderValues.getInt(i.BLEND_DST)
            }, function (t) {
                this._shaderValues.setInt(i.BLEND_DST, t)
            }), u(0, t, "smoothnessTextureScale", function () {
                return this._GlossMapScale
            }, function (t) {
                this._GlossMapScale = Math.max(0, Math.min(1, t))
            }), u(0, t, "depthWrite", function () {
                return this._shaderValues.getBool(i.DEPTH_WRITE)
            }, function (t) {
                this._shaderValues.setBool(i.DEPTH_WRITE, t)
            }), u(0, t, "smoothnessSource", function () {
                return this._shaderValues.getInt(i.SMOOTHNESSSOURCE)
            }, function (t) {
                t ? (this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA), this._shaderValues.setInt(i.SMOOTHNESSSOURCE, 1)) : (this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA), this._shaderValues.setInt(i.SMOOTHNESSSOURCE, 0))
            }), u(0, t, "enableEmission", function () {
                return this._shaderValues.getBool(i.ENABLEEMISSION)
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSION) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSION), this._shaderValues.setBool(i.ENABLEEMISSION, t)
            }), u(0, t, "enableReflection", function () {
                return this._shaderValues.getBool(i.ENABLEREFLECT)
            }, function (t) {
                this._shaderValues.setBool(i.ENABLEREFLECT, !0), t ? this._disablePublicDefineDatas.remove(Qn.SHADERDEFINE_REFLECTMAP) : this._disablePublicDefineDatas.add(Qn.SHADERDEFINE_REFLECTMAP)
            }), u(0, t, "tilingOffsetY", function () {
                return this._MainTex_STY
            }, function (t) {
                this._MainTex_STY = t
            }), u(0, t, "blend", function () {
                return this._shaderValues.getInt(i.BLEND)
            }, function (t) {
                this._shaderValues.setInt(i.BLEND, t)
            }), u(0, t, "depthTest", function () {
                return this._shaderValues.getInt(i.DEPTH_TEST)
            }, function (t) {
                this._shaderValues.setInt(i.DEPTH_TEST, t)
            }), i.__init__ = function () {
                i.SHADERDEFINE_ALBEDOTEXTURE = i.shaderDefines.registerDefine("ALBEDOTEXTURE"), i.SHADERDEFINE_SPECULARTEXTURE = i.shaderDefines.registerDefine("SPECULARTEXTURE"), i.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA = i.shaderDefines.registerDefine("SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA"), i.SHADERDEFINE_NORMALTEXTURE = i.shaderDefines.registerDefine("NORMALTEXTURE"), i.SHADERDEFINE_PARALLAXTEXTURE = i.shaderDefines.registerDefine("PARALLAXTEXTURE"), i.SHADERDEFINE_OCCLUSIONTEXTURE = i.shaderDefines.registerDefine("OCCLUSIONTEXTURE"), i.SHADERDEFINE_EMISSION = i.shaderDefines.registerDefine("EMISSION"), i.SHADERDEFINE_EMISSIONTEXTURE = i.shaderDefines.registerDefine("EMISSIONTEXTURE"), i.SHADERDEFINE_TILINGOFFSET = i.shaderDefines.registerDefine("TILINGOFFSET"), i.SHADERDEFINE_ALPHAPREMULTIPLY = i.shaderDefines.registerDefine("ALPHAPREMULTIPLY")
            }, i.SmoothnessSource_SpecularTexture_Alpha = 0, i.SmoothnessSource_AlbedoTexture_Alpha = 1, i.RENDERMODE_OPAQUE = 0, i.RENDERMODE_CUTOUT = 1, i.RENDERMODE_FADE = 2, i.RENDERMODE_TRANSPARENT = 3, i.SHADERDEFINE_ALBEDOTEXTURE = 0, i.SHADERDEFINE_NORMALTEXTURE = 0, i.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA = 0, i.SHADERDEFINE_SPECULARTEXTURE = 0, i.SHADERDEFINE_OCCLUSIONTEXTURE = 0, i.SHADERDEFINE_PARALLAXTEXTURE = 0, i.SHADERDEFINE_EMISSION = 0, i.SHADERDEFINE_EMISSIONTEXTURE = 0, i.SHADERDEFINE_TILINGOFFSET = 0, i.SHADERDEFINE_ALPHAPREMULTIPLY = 0, i.SMOOTHNESSSOURCE = -1, i.ENABLEEMISSION = -1, i.ENABLEREFLECT = -1, _(i, ["ALBEDOTEXTURE", function () {
                return this.ALBEDOTEXTURE = Pt.propertyNameToID("u_AlbedoTexture")
            }, "SPECULARTEXTURE", function () {
                return this.SPECULARTEXTURE = Pt.propertyNameToID("u_SpecularTexture")
            }, "NORMALTEXTURE", function () {
                return this.NORMALTEXTURE = Pt.propertyNameToID("u_NormalTexture")
            }, "PARALLAXTEXTURE", function () {
                return this.PARALLAXTEXTURE = Pt.propertyNameToID("u_ParallaxTexture")
            }, "OCCLUSIONTEXTURE", function () {
                return this.OCCLUSIONTEXTURE = Pt.propertyNameToID("u_OcclusionTexture")
            }, "EMISSIONTEXTURE", function () {
                return this.EMISSIONTEXTURE = Pt.propertyNameToID("u_EmissionTexture")
            }, "ALBEDOCOLOR", function () {
                return this.ALBEDOCOLOR = Pt.propertyNameToID("u_AlbedoColor")
            }, "SPECULARCOLOR", function () {
                return this.SPECULARCOLOR = Pt.propertyNameToID("u_SpecularColor")
            }, "EMISSIONCOLOR", function () {
                return this.EMISSIONCOLOR = Pt.propertyNameToID("u_EmissionColor")
            }, "SMOOTHNESS", function () {
                return this.SMOOTHNESS = Pt.propertyNameToID("u_smoothness")
            }, "SMOOTHNESSSCALE", function () {
                return this.SMOOTHNESSSCALE = Pt.propertyNameToID("u_smoothnessScale")
            }, "OCCLUSIONSTRENGTH", function () {
                return this.OCCLUSIONSTRENGTH = Pt.propertyNameToID("u_occlusionStrength")
            }, "NORMALSCALE", function () {
                return this.NORMALSCALE = Pt.propertyNameToID("u_normalScale")
            }, "PARALLAXSCALE", function () {
                return this.PARALLAXSCALE = Pt.propertyNameToID("u_parallaxScale")
            }, "TILINGOFFSET", function () {
                return this.TILINGOFFSET = Pt.propertyNameToID("u_TilingOffset")
            }, "CULL", function () {
                return this.CULL = Pt.propertyNameToID("s_Cull")
            }, "BLEND", function () {
                return this.BLEND = Pt.propertyNameToID("s_Blend")
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Pt.propertyNameToID("s_BlendSrc")
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Pt.propertyNameToID("s_BlendDst")
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Pt.propertyNameToID("s_DepthTest")
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Pt.propertyNameToID("s_DepthWrite")
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new i
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Bn.shaderDefines)
            }]), i
        }(Bn), mi = (function (r) {
            function a(t, e) {
                this._isKinematic = !1, this._mass = 1, this._angularDamping = 0, this._linearDamping = 0, this._overrideGravity = !1, this._detectCollisions = !0, this._gravity = new Lt(0, -10, 0), this._totalTorque = new Lt(0, 0, 0), this._linearVelocity = new Lt, this._angularVelocity = new Lt, this._linearFactor = new Lt(1, 1, 1), this._angularFactor = new Lt(1, 1, 1), void 0 === t && (t = 1), void 0 === e && (e = Ue.COLLISIONFILTERGROUP_ALLFILTER), a.__super.call(this, t, e)
            }

            d(a, "laya.d3.physics.Rigidbody3D", r);
            var t = a.prototype;
            t._updateMass = function (t) {
                this._nativeColliderObject && this._colliderShape && (this._colliderShape._nativeShape.calculateLocalInertia(t, a._nativeInertia), this._nativeColliderObject.setMassProps(t, a._nativeInertia), this._nativeColliderObject.updateInertiaTensor())
            }, t._delegateMotionStateGetWorldTransform = function (t) {
            }, t._delegateMotionStateSetWorldTransform = function (t) {
                var e = this._rigidbody;
                e._simulation._updatedRigidbodies++;
                var n = k._physics3D, i = n.wrapPointer(t, n.btTransform);
                e._updateTransformComponent(i)
            }, t._delegateMotionStateGetWorldTransformNative = function (t, e) {
            }, t._delegateMotionStateSetWorldTransformNative = function (t, e) {
                var n = t;
                n._simulation._updatedRigidbodies++;
                var i = k._physics3D, r = i.wrapPointer(e, i.btTransform);
                n._updateTransformComponent(r)
            }, t._onScaleChange = function (t) {
                laya.d3.physics.PhysicsComponent.prototype._onScaleChange.call(this, t), this._updateMass(this._isKinematic ? 0 : this._mass)
            }, t._delegateMotionStateClear = function () {
                this._rigidbody = null
            }, t._onAdded = function () {
                var t = k._physics3D, e = new t.LayaMotionState;
                null != o.conch && t.LayaMotionState.prototype.setRigidbody ? (e.setRigidbody(this), e.setNativeGetWorldTransform(this._delegateMotionStateGetWorldTransformNative), e.setNativeSetWorldTransform(this._delegateMotionStateSetWorldTransformNative)) : (e.getWorldTransform = this._delegateMotionStateGetWorldTransform, e.setWorldTransform = this._delegateMotionStateSetWorldTransform), e.clear = this._delegateMotionStateClear, (e._rigidbody = this)._nativeMotionState = e;
                var n = new t.btRigidBodyConstructionInfo(0, e, null, a._nativeVector3Zero), i = new t.btRigidBody(n);
                i.setUserIndex(this.id), this._nativeColliderObject = i, r.prototype._onAdded.call(this), this.mass = this._mass, this.linearFactor = this._linearFactor, this.angularFactor = this._angularFactor, this.linearDamping = this._linearDamping, this.angularDamping = this._angularDamping, this.overrideGravity = this._overrideGravity, this.gravity = this._gravity, this.isKinematic = this._isKinematic, t.destroy(n)
            }, t._onShapeChange = function (t) {
                laya.d3.physics.PhysicsComponent.prototype._onShapeChange.call(this, t), this._isKinematic ? this._updateMass(0) : (this._nativeColliderObject.setCenterOfMassTransform(this._nativeColliderObject.getWorldTransform()), this._updateMass(this._mass))
            }, t._parse = function (t) {
                null != t.friction && (this.friction = t.friction), null != t.rollingFriction && (this.rollingFriction = t.rollingFriction), null != t.restitution && (this.restitution = t.restitution), null != t.isTrigger && (this.isTrigger = t.isTrigger), null != t.mass && (this.mass = t.mass), null != t.isKinematic && (this.isKinematic = t.isKinematic), null != t.linearDamping && (this.linearDamping = t.linearDamping), null != t.angularDamping && (this.angularDamping = t.angularDamping), null != t.overrideGravity && (this.overrideGravity = t.overrideGravity), t.gravity && (this.gravity.fromArray(t.gravity), this.gravity = this.gravity), laya.d3.physics.PhysicsComponent.prototype._parse.call(this, t), this._parseShape(t.shapes)
            }, t._onDestroy = function () {
                var t = k._physics3D;
                this._nativeMotionState.clear(), t.destroy(this._nativeMotionState), laya.d3.physics.PhysicsComponent.prototype._onDestroy.call(this), this._nativeMotionState = null, this._gravity = null, this._totalTorque = null, this._linearVelocity = null, this._angularVelocity = null, this._linearFactor = null, this._angularFactor = null
            }, t._addToSimulation = function () {
                this._simulation._addRigidBody(this, this._collisionGroup, this._detectCollisions ? this._canCollideWith : 0)
            }, t._removeFromSimulation = function () {
                this._simulation._removeRigidBody(this)
            }, t._cloneTo = function (t) {
                r.prototype._cloneTo.call(this, t);
                var e = t;
                e.isKinematic = this._isKinematic, e.mass = this._mass, e.gravity = this._gravity, e.angularDamping = this._angularDamping, e.linearDamping = this._linearDamping, e.overrideGravity = this._overrideGravity, e.linearVelocity = this._linearVelocity, e.angularVelocity = this._angularVelocity, e.linearFactor = this._linearFactor, e.angularFactor = this._angularFactor, e.detectCollisions = this._detectCollisions
            }, t.applyForce = function (t, e) {
                if (null == this._nativeColliderObject) throw"Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";
                var n = a._nativeTempVector30;
                if (n.setValue(-t.x, t.y, t.z), e) {
                    var i = a._nativeTempVector31;
                    i.setValue(-e.x, e.y, e.z), this._nativeColliderObject.applyForce(n, i)
                } else this._nativeColliderObject.applyCentralForce(n)
            }, t.applyTorque = function (t) {
                if (null == this._nativeColliderObject) throw"Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";
                var e = a._nativeTempVector30;
                e.setValue(-t.x, t.y, t.z), this._nativeColliderObject.applyTorque(e)
            }, t.applyImpulse = function (t, e) {
                if (null == this._nativeColliderObject) throw"Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";
                a._nativeImpulse.setValue(-t.x, t.y, t.z), e ? (a._nativeImpulseOffset.setValue(-e.x, e.y, e.z), this._nativeColliderObject.applyImpulse(a._nativeImpulse, a._nativeImpulseOffset)) : this._nativeColliderObject.applyCentralImpulse(a._nativeImpulse)
            }, t.applyTorqueImpulse = function (t) {
                if (null == this._nativeColliderObject) throw"Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";
                var e = a._nativeTempVector30;
                e.setValue(-t.x, t.y, t.z), this._nativeColliderObject.applyTorqueImpulse(e)
            }, t.wakeUp = function () {
                this._nativeColliderObject && this._nativeColliderObject.activate(!1)
            }, t.clearForces = function () {
                var t = this._nativeColliderObject;
                if (null == t) throw"Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";
                t.clearForces();
                var e = a._nativeVector3Zero;
                t.setInterpolationAngularVelocity(e), t.setLinearVelocity(e), t.setInterpolationAngularVelocity(e), t.setAngularVelocity(e)
            }, u(0, t, "angularDamping", function () {
                return this._angularDamping
            }, function (t) {
                this._angularDamping = t, this._nativeColliderObject && this._nativeColliderObject.setDamping(this._linearDamping, t)
            }), u(0, t, "mass", function () {
                return this._mass
            }, function (t) {
                t = Math.max(t, 1e-7), this._mass = t, this._isKinematic || this._updateMass(t)
            }), u(0, t, "linearDamping", function () {
                return this._linearDamping
            }, function (t) {
                this._linearDamping = t, this._nativeColliderObject && this._nativeColliderObject.setDamping(t, this._angularDamping)
            }), u(0, t, "isKinematic", function () {
                return this._isKinematic
            }, function (t) {
                this._isKinematic = t;
                var e = !!(this._simulation && this._enabled && this._colliderShape);
                e && this._removeFromSimulation();
                var n = this._nativeColliderObject, i = n.getCollisionFlags();
                t ? (i |= 2, n.setCollisionFlags(i), this._nativeColliderObject.forceActivationState(4), this._enableProcessCollisions = !1, this._updateMass(0)) : (0 < (2 & i) && (i ^= 2), n.setCollisionFlags(i), this._nativeColliderObject.setActivationState(1), this._enableProcessCollisions = !0, this._updateMass(this._mass));
                var r = a._nativeVector3Zero;
                n.setInterpolationLinearVelocity(r), n.setLinearVelocity(r), n.setInterpolationAngularVelocity(r), n.setAngularVelocity(r), e && this._addToSimulation()
            }), u(0, t, "gravity", function () {
                return this._gravity
            }, function (t) {
                this._gravity = t, a._nativeGravity.setValue(-t.x, t.y, t.z), this._nativeColliderObject.setGravity(a._nativeGravity)
            }), u(0, t, "overrideGravity", function () {
                return this._overrideGravity
            }, function (t) {
                if (this._overrideGravity = t, this._nativeColliderObject) {
                    var e = this._nativeColliderObject.getFlags();
                    t ? 0 == (1 & e) && this._nativeColliderObject.setFlags(1 | e) : 0 < (1 & e) && this._nativeColliderObject.setFlags(1 ^ e)
                }
            }), u(0, t, "totalForce", function () {
                return this._nativeColliderObject ? this._nativeColliderObject.getTotalForce() : null
            }), u(0, t, "linearVelocity", function () {
                return this._nativeColliderObject && kt._convertToLayaVec3(this._nativeColliderObject.getLinearVelocity(), this._linearVelocity, !0), this._linearVelocity
            }, function (t) {
                if (this._linearVelocity = t, this._nativeColliderObject) {
                    var e = a._nativeTempVector30;
                    kt._convertToBulletVec3(t, e, !0), this.isSleeping && this.wakeUp(), this._nativeColliderObject.setLinearVelocity(e)
                }
            }), u(0, t, "detectCollisions", function () {
                return this._detectCollisions
            }, function (t) {
                this._detectCollisions !== t && (this._detectCollisions = t, this._colliderShape && this._enabled && this._simulation && (this._simulation._removeRigidBody(this), this._simulation._addRigidBody(this, this._collisionGroup, t ? this._canCollideWith : 0)))
            }), u(0, t, "linearFactor", function () {
                return this._nativeColliderObject ? this._linearFactor : null
            }, function (t) {
                if (this._linearFactor = t, this._nativeColliderObject) {
                    var e = a._nativeTempVector30;
                    kt._convertToBulletVec3(t, e, !1), this._nativeColliderObject.setLinearFactor(e)
                }
            }), u(0, t, "angularFactor", function () {
                return this._nativeColliderObject ? this._angularFactor : null
            }, function (t) {
                if (this._angularFactor = t, this._nativeColliderObject) {
                    var e = a._nativeTempVector30;
                    kt._convertToBulletVec3(t, e, !1), this._nativeColliderObject.setAngularFactor(e)
                }
            }), u(0, t, "angularVelocity", function () {
                return this._nativeColliderObject && kt._convertToLayaVec3(this._nativeColliderObject.getAngularVelocity(), this._angularVelocity, !0), this._angularVelocity
            }, function (t) {
                if (this._angularVelocity = t, this._nativeColliderObject) {
                    var e = a._nativeTempVector30;
                    kt._convertToBulletVec3(t, e, !0), this.isSleeping && this.wakeUp(), this._nativeColliderObject.setAngularVelocity(e)
                }
            }), u(0, t, "totalTorque", function () {
                if (this._nativeColliderObject) {
                    var t = this._nativeColliderObject.getTotalTorque(), e = this._totalTorque;
                    e.x = -t.x, e.y = t.y, e.z = t.z
                }
                return null
            }), u(0, t, "isSleeping", function () {
                return !!this._nativeColliderObject && 2 === this._nativeColliderObject.getActivationState()
            }), u(0, t, "sleepLinearVelocity", function () {
                return this._nativeColliderObject.getLinearSleepingThreshold()
            }, function (t) {
                this._nativeColliderObject.setSleepingThresholds(t, this._nativeColliderObject.getAngularSleepingThreshold())
            }), u(0, t, "sleepAngularVelocity", function () {
                return this._nativeColliderObject.getAngularSleepingThreshold()
            }, function (t) {
                this._nativeColliderObject.setSleepingThresholds(this._nativeColliderObject.getLinearSleepingThreshold(), t)
            }), a.TYPE_STATIC = 0, a.TYPE_DYNAMIC = 1, a.TYPE_KINEMATIC = 2, a._BT_DISABLE_WORLD_GRAVITY = 1, a._BT_ENABLE_GYROPSCOPIC_FORCE = 2, _(a, ["_nativeTempVector30", function () {
                return this._nativeTempVector30 = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeTempVector31", function () {
                return this._nativeTempVector31 = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeVector3Zero", function () {
                return this._nativeVector3Zero = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeInertia", function () {
                return this._nativeInertia = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeImpulse", function () {
                return this._nativeImpulse = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeImpulseOffset", function () {
                return this._nativeImpulseOffset = new k._physics3D.btVector3(0, 0, 0)
            }, "_nativeGravity", function () {
                return this._nativeGravity = new k._physics3D.btVector3(0, 0, 0)
            }])
        }(Yn), function (n) {
            function i(t, e) {
                void 0 === t && (t = 1), void 0 === e && (e = Ue.COLLISIONFILTERGROUP_ALLFILTER), i.__super.call(this, t, e)
            }

            d(i, "laya.d3.physics.PhysicsCollider", n);
            var t = i.prototype;
            t._addToSimulation = function () {
                this._simulation._addPhysicsCollider(this, this._collisionGroup, this._canCollideWith)
            }, t._removeFromSimulation = function () {
                this._simulation._removePhysicsCollider(this)
            }, t._onTransformChanged = function (t) {
                (t &= 56) && (this._transformFlag |= t, this._isValid() && -1 === this._inPhysicUpdateListIndex && this._simulation._physicsUpdateList.add(this))
            }, t._parse = function (t) {
                null != t.friction && (this.friction = t.friction), null != t.rollingFriction && (this.rollingFriction = t.rollingFriction), null != t.restitution && (this.restitution = t.restitution), null != t.isTrigger && (this.isTrigger = t.isTrigger), laya.d3.physics.PhysicsComponent.prototype._parse.call(this, t), this._parseShape(t.shapes)
            }, t._onAdded = function () {
                var t = new k._physics3D.btCollisionObject;
                t.setUserIndex(this.id), t.forceActivationState(5);
                var e = t.getCollisionFlags();
                this.owner.isStatic ? (0 < (2 & e) && (e ^= 2), e |= 1) : (0 < (1 & e) && (e ^= 1), e |= 2), t.setCollisionFlags(e), this._nativeColliderObject = t, n.prototype._onAdded.call(this)
            }
        }(Yn), function (s) {
            function r(t) {
                this._bones = [], this._skinnedDataLoopMarks = [], this._localBounds = new xe(Lt._ZERO, Lt._ZERO), this._cacheAnimationNode = [], r.__super.call(this, t)
            }

            d(r, "laya.d3.core.SkinnedMeshRenderer", s);
            var t = r.prototype;
            return t._computeSkinnedData = function () {
                if (this._cacheMesh && this._cacheAvatar || this._cacheMesh && this._cacheRootBone) for (var t = this._cacheMesh._inverseBindPoses, e = this._cacheMesh._bindPoseIndices, n = this._cacheMesh._skinDataPathMarks, i = 0, r = this._cacheMesh.subMeshCount; i < r; i++) for (var a = this._cacheMesh._getSubMesh(i)._boneIndicesList, o = this._skinnedData[i], s = 0, l = a.length; s < l; s++) {
                    var h = a[s];
                    b.supportWebGLPlusAnimation ? this._computeSubSkinnedDataNative(this._cacheAnimator._animationNodeWorldMatrixs, this._cacheAnimationNodeIndices, this._cacheMesh._inverseBindPosesBuffer, h, e, o[s]) : this._computeSubSkinnedData(t, h, e, o[s], n)
                }
            }, t._computeSubSkinnedData = function (t, e, n, i, r) {
                for (var a = 0, o = e.length; a < o; a++) {
                    var s = e[a];
                    if (this._skinnedDataLoopMarks[s] === C.loopCount) for (var l = r[s], h = this._skinnedData[l[0]][l[1]], u = 16 * l[2], c = 16 * a, _ = 0; _ < 16; _++) i[c + _] = h[u + _]; else {
                        if (this._cacheRootBone) {
                            var d = n[s];
                            kt._mulMatrixArray(this._bones[d].transform.worldMatrix.elements, t[d], i, 16 * a)
                        } else kt._mulMatrixArray(this._cacheAnimationNode[s].transform.getWorldMatrix(), t[n[s]], i, 16 * a);
                        this._skinnedDataLoopMarks[s] = C.loopCount
                    }
                }
            }, t._boundChange = function () {
                this._boundsChange = !0
            }, t._onMeshChange = function (t) {
                s.prototype._onMeshChange.call(this, t);
                var e = (this._cacheMesh = t).subMeshCount;
                this._skinnedData = w(e), this._skinnedDataLoopMarks.length = t._bindPoseIndices.length;
                for (var n = 0; n < e; n++) for (var i = t._getSubMesh(n)._boneIndicesList, r = i.length, a = this._skinnedData[n] = w(r), o = 0; o < r; o++) a[o] = new Float32Array(16 * i[o].length);
                this._bones || this._cacheAvatar && t && this._getCacheAnimationNodes()
            }, t._setCacheAnimator = function (t) {
                this._cacheAnimator = t, this._defineDatas.add(Di.SHADERDEFINE_BONE), this._setRootNode()
            }, t._calculateBoundingBox = function () {
                if (this._cacheRootBone) this._localBounds._tranform(this._cacheRootBone.transform.worldMatrix, this._bounds); else if (this._cacheAnimator && this._rootBone) {
                    var t = r._tempMatrix4x4;
                    kt.matrix4x4MultiplyMFM(this._cacheAnimator.owner.transform.worldMatrix, this._cacheRootAnimationNode.transform.getWorldMatrix(), t), this._localBounds._tranform(t, this._bounds)
                } else s.prototype._calculateBoundingBox.call(this);
                if (b.supportWebGLPlusCulling) {
                    var e = this._bounds.getMin(), n = this._bounds.getMax(), i = we._cullingBuffer;
                    i[this._cullingBufferIndex + 1] = e.x, i[this._cullingBufferIndex + 2] = e.y, i[this._cullingBufferIndex + 3] = e.z, i[this._cullingBufferIndex + 4] = n.x, i[this._cullingBufferIndex + 5] = n.y, i[this._cullingBufferIndex + 6] = n.z
                }
            }, t._changeRenderObjectsByMesh = function (t) {
                var e = t.subMeshCount;
                this._renderElements.length = e;
                for (var n = 0; n < e; n++) {
                    var i = this._renderElements[n];
                    if (!i) {
                        var r = this.sharedMaterials[n];
                        (i = this._renderElements[n] = new vt).setTransform(this._owner._transform), i.render = this, i.material = r || ci.defaultMaterial
                    }
                    i.setGeometry(t._getSubMesh(n))
                }
            }, t._renderUpdate = function (t, e) {
                if (this._cacheAnimator) if (this._computeSkinnedData(), this._cacheRootBone) this._shaderValues.setMatrix4x4(Fn.WORLDMATRIX, He.DEFAULT); else {
                    var n = this._cacheAnimator.owner._transform;
                    this._shaderValues.setMatrix4x4(Fn.WORLDMATRIX, n.worldMatrix)
                } else this._shaderValues.setMatrix4x4(Fn.WORLDMATRIX, e.worldMatrix)
            }, t._renderUpdateWithCamera = function (t, e) {
                var n = t.projectionViewMatrix;
                if (this._cacheRootBone) this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, n); else {
                    if (this._cacheAnimator) {
                        var i = this._cacheAnimator.owner._transform;
                        He.multiply(n, i.worldMatrix, this._projectionViewWorldMatrix)
                    } else He.multiply(n, e.worldMatrix, this._projectionViewWorldMatrix);
                    this._shaderValues.setMatrix4x4(Fn.MVPMATRIX, this._projectionViewWorldMatrix)
                }
            }, t._destroy = function () {
                s.prototype._destroy.call(this), this._cacheRootBone ? this._cacheRootBone.transform.off("transformchanged", this, this._boundChange) : this._cacheRootAnimationNode && this._cacheRootAnimationNode.transform.off("transformchanged", this, this._boundChange)
            }, t._setRootBone = function (t) {
                this._rootBone = t, this._setRootNode()
            }, t._setRootNode = function () {
                var t;
                t = this._cacheAnimator && this._rootBone && this._cacheAvatar ? this._cacheAnimator._avatarNodeMap[this._rootBone] : null, this._cacheRootAnimationNode != t && (this._boundChange(), this._cacheRootAnimationNode && this._cacheRootAnimationNode.transform.off("transformchanged", this, this._boundChange), t && t.transform.on("transformchanged", this, this._boundChange), this._cacheRootAnimationNode = t)
            }, t._getCacheAnimationNodes = function () {
                var t = this._cacheMesh._boneNames, e = this._cacheMesh._bindPoseIndices, n = e.length;
                if (b.supportWebGLPlusAnimation) {
                    this._cacheAnimationNodeIndices = new Uint16Array(n);
                    var i = this._cacheAnimator._avatarNodeMap;
                    for (o = 0; o < n; o++) {
                        var r = i[t[e[o]]];
                        this._cacheAnimationNodeIndices[o] = r._worldMatrixIndex
                    }
                } else {
                    this._cacheAnimationNode.length = n;
                    for (var a = this._cacheAnimator._avatarNodeMap, o = 0; o < n; o++) {
                        var s = a[t[e[o]]];
                        this._cacheAnimationNode[o] = s
                    }
                }
            }, t._setCacheAvatar = function (t) {
                this._cacheAvatar !== t && (this._cacheMesh ? (this._cacheAvatar = t) && (this._defineDatas.add(Di.SHADERDEFINE_BONE), this._getCacheAnimationNodes()) : this._cacheAvatar = t, this._setRootNode())
            }, t._computeSubSkinnedDataNative = function (t, e, n, i, r, a) {
                E.instance.computeSubSkinnedData(t, e, n, i, r, a)
            }, u(0, t, "localBounds", function () {
                return this._localBounds
            }, function (t) {
                this._localBounds = t
            }), u(0, t, "rootBone", function () {
                return this._cacheRootBone
            }, function (t) {
                this._cacheRootBone != t && (this._cacheRootBone && this._cacheRootBone.transform.off("transformchanged", this, this._boundChange), t.transform.on("transformchanged", this, this._boundChange), this._cacheRootBone = t, this._boundChange())
            }), u(0, t, "bones", function () {
                return this._bones
            }), u(0, t, "bounds", function () {
                return (this._boundsChange || this._cacheAvatar) && (this._calculateBoundingBox(), this._boundsChange = !1), this._bounds
            }), _(r, ["_tempMatrix4x4", function () {
                return this._tempMatrix4x4 = new He
            }]), r
        }(jn)), pi = function (t) {
            function s(t, e, n, i) {
                void 0 === n && (n = 0), void 0 === i && (i = 0), s.__super.call(this, n, !1), this._glTextureType = 3553, this._width = t, this._height = e, this._depthStencilFormat = i, this._create(t, e)
            }

            d(s, "laya.d3.resource.RenderTexture", n);
            var e = s.prototype;
            return e._create = function (t, e) {
                var n = E.instance;
                this._frameBuffer = n.createFramebuffer(), V.bindTexture(n, this._glTextureType, this._glTexture);
                var i = this._getGLFormat();
                if (n.texImage2D(this._glTextureType, 0, i, t, e, 0, i, 5121, null), this._setGPUMemory(t * e * 4), n.bindFramebuffer(36160, this._frameBuffer), n.framebufferTexture2D(36160, 36064, 3553, this._glTexture, 0), 3 !== this._depthStencilFormat) switch (this._depthStencilBuffer = n.createRenderbuffer(), n.bindRenderbuffer(36161, this._depthStencilBuffer), this._depthStencilFormat) {
                    case 0:
                        n.renderbufferStorage(36161, 33189, t, e), n.framebufferRenderbuffer(36160, 36096, 36161, this._depthStencilBuffer);
                        break;
                    case 1:
                        n.renderbufferStorage(36161, 36168, t, e), n.framebufferRenderbuffer(36160, 36128, 36161, this._depthStencilBuffer);
                        break;
                    case 2:
                        n.renderbufferStorage(36161, 34041, t, e), n.framebufferRenderbuffer(36160, 33306, 36161, this._depthStencilBuffer);
                        break;
                    default:
                        throw"RenderTexture: unkonw depth format."
                }
                n.bindFramebuffer(36160, null), n.bindRenderbuffer(36161, null), this._setWarpMode(10242, this._wrapModeU), this._setWarpMode(10243, this._wrapModeV), this._setFilterMode(this._filterMode), this._setAnisotropy(this._anisoLevel), this._readyed = !0, this._activeResource()
            }, e._start = function () {
                E.instance.bindFramebuffer(36160, this._frameBuffer), (s._currentActive = this)._readyed = !1
            }, e._end = function () {
                E.instance.bindFramebuffer(36160, null), s._currentActive = null, this._readyed = !0
            }, e.getData = function (t, e, n, i, r) {
                if (b.isConchApp && 2 == conchConfig.threadMode) throw"native 2 thread mode use getDataAsync";
                var a = E.instance;
                return a.bindFramebuffer(36160, this._frameBuffer), 36053 === a.checkFramebufferStatus(36160) ? (a.readPixels(t, e, n, i, 6408, 5121, r), a.bindFramebuffer(36160, null), r) : (a.bindFramebuffer(36160, null), null)
            }, e.getDataAsync = function (t, e, n, i, r) {
                var a = E.instance;
                a.bindFramebuffer(36160, this._frameBuffer), a.readPixelsAsync(t, e, n, i, 6408, 5121, function (t) {
                    r(new Uint8Array(t))
                }), a.bindFramebuffer(36160, null)
            }, e._disposeResource = function () {
                if (this._frameBuffer) {
                    var t = E.instance;
                    t.deleteTexture(this._glTexture), t.deleteFramebuffer(this._frameBuffer), t.deleteRenderbuffer(this._depthStencilBuffer), this._glTexture = null, this._frameBuffer = null, this._depthStencilBuffer = null, this._setGPUMemory(0)
                }
            }, u(0, e, "depthStencilFormat", function () {
                return this._depthStencilFormat
            }), u(0, e, "defaulteTexture", function () {
                return F.grayTexture
            }), u(1, s, "currentActive", function () {
                return s._currentActive
            }, laya.resource.BaseTexture._$SET_currentActive), s.getTemporary = function (t, e, n, i, r) {
                void 0 === n && (n = 0), void 0 === i && (i = 0), void 0 === r && (r = 1);
                var a = s._temporaryMap[1e7 * r + 1e6 * i + 1e5 * n + 1e4 * e + t];
                if (!a || a && 0 === a.length) {
                    var o = new s(t, e, n, i);
                    return o.filterMode = r, o
                }
                return a.pop()
            }, s.setReleaseTemporary = function (t) {
                var e = 1e7 * t.filterMode + 1e6 * t.depthStencilFormat + 1e5 * t.format + 1e4 * t.height + t.width,
                    n = s._temporaryMap[e];
                n || (s._temporaryMap[e] = n = []), n.push(t)
            }, s._temporaryMap = {}, s._currentActive = null, s
        }(), Ti = function (t) {
            function r(t, e) {
                void 0 === t && (t = 0), void 0 === e && (e = !1), r.__super.call(this, t, e), this._glTextureType = 34067
            }

            d(r, "laya.d3.resource.TextureCube", n);
            var e = r.prototype;
            return e.setSixSideImageSources = function (t, e) {
                void 0 === e && (e = !1);
                for (var n = 0, i = 0, r = 0; r < 6; r++) {
                    var a = t[r];
                    if (!a) return;
                    var o = a.width, s = a.height;
                    if (0 < r && n !== o) return;
                    if ((n = o) !== (i = s)) return
                }
                this._width = n, this._height = i;
                var l = E.instance;
                V.bindTexture(l, this._glTextureType, this._glTexture);
                var h = this._getGLFormat();
                if (b.isConchApp) {
                    if (1 == e) for (var u = 0; u < 6; u++) t[u].setPremultiplyAlpha(e);
                    l.texImage2D(34073, 0, 6408, 6408, 5121, t[0]), l.texImage2D(34074, 0, 6408, 6408, 5121, t[1]), l.texImage2D(34069, 0, 6408, 6408, 5121, t[2]), l.texImage2D(34070, 0, 6408, 6408, 5121, t[3]), l.texImage2D(34071, 0, 6408, 6408, 5121, t[4]), l.texImage2D(34072, 0, 6408, 6408, 5121, t[5])
                } else e && l.pixelStorei(37441, !0), l.texImage2D(34073, 0, h, h, 5121, t[0]), l.texImage2D(34074, 0, h, h, 5121, t[1]), l.texImage2D(34069, 0, h, h, 5121, t[2]), l.texImage2D(34070, 0, h, h, 5121, t[3]), l.texImage2D(34071, 0, h, h, 5121, t[4]), l.texImage2D(34072, 0, h, h, 5121, t[5]), e && l.pixelStorei(37441, !1);
                this._mipmap && this._isPot(n) && this._isPot(i) ? (l.generateMipmap(this._glTextureType), this._setGPUMemory(n * i * 4 * (1 + 1 / 3) * 6)) : this._setGPUMemory(n * i * 4 * 6), this._setWarpMode(10242, this._wrapModeU), this._setWarpMode(10243, this._wrapModeV), this._setFilterMode(this._filterMode), this._readyed = !0, this._activeResource()
            }, e.setSixSidePixels = function (t, e, n) {
                if (t <= 0 || e <= 0) throw new Error("TextureCube:width or height must large than 0.");
                if (!n) throw new Error("TextureCube:pixels can't be null.");
                this._width = t, this._height = e;
                var i = E.instance;
                V.bindTexture(i, this._glTextureType, this._glTexture);
                var r = this._getGLFormat();
                i.texImage2D(34073, 0, r, t, e, 0, r, 5121, n[0]), i.texImage2D(34074, 0, r, t, e, 0, r, 5121, n[1]), i.texImage2D(34069, 0, r, t, e, 0, r, 5121, n[2]), i.texImage2D(34070, 0, r, t, e, 0, r, 5121, n[3]), i.texImage2D(34071, 0, r, t, e, 0, r, 5121, n[4]), i.texImage2D(34072, 0, r, t, e, 0, r, 5121, n[5]), this._mipmap && this._isPot(t) && this._isPot(e) ? (i.generateMipmap(this._glTextureType), this._setGPUMemory(t * e * 4 * (1 + 1 / 3) * 6)) : this._setGPUMemory(t * e * 4 * 6), this._setWarpMode(10242, this._wrapModeU), this._setWarpMode(10243, this._wrapModeV), this._setFilterMode(this._filterMode), this._readyed = !0, this._activeResource()
            }, e._recoverResource = function () {
            }, u(0, e, "defaulteTexture", function () {
                return r.grayTexture
            }), r.__init__ = function () {
                var t = new Uint8Array(3);
                t[0] = 128, t[1] = 128, t[2] = 128, (r.grayTexture = new r(0, !1)).setSixSidePixels(1, 1, [t, t, t, t, t, t]), r.grayTexture.lock = !0
            }, r._parse = function (t, e, n) {
                var i = n ? new r(n[0], n[1]) : new r;
                return i.setSixSideImageSources(t), i
            }, r.load = function (t, e) {
                m.loader.create(t, e, null, "TEXTURECUBE")
            }, r.grayTexture = null, r
        }(), Ei = function (e) {
            function n(t, e) {
                n.__super.call(this, e), this._meshFilter = new $t(this), this._render = new jn(this), t && (this._meshFilter.sharedMesh = t)
            }

            d(n, "laya.d3.core.MeshSprite3D", e);
            var t = n.prototype;
            return t._parse = function (t, e) {
                laya.d3.core.Sprite3D.prototype._parse.call(this, t, e);
                var n = this.meshRenderer, i = t.lightmapIndex;
                null != i && (n.lightmapIndex = i);
                var r = t.lightmapScaleOffset;
                r && (n.lightmapScaleOffset = new Ct(r[0], r[1], r[2], r[3])), null != t.meshPath && (this.meshFilter.sharedMesh = Dt.getRes(t.meshPath)), null != t.enableRender && (this.meshRenderer.enable = t.enableRender);
                var a = t.materials;
                if (a) {
                    var o = n.sharedMaterials, s = a.length;
                    o.length = s;
                    for (var l = 0; l < s; l++) o[l] = Dt.getRes(a[l].path);
                    n.sharedMaterials = o
                }
            }, t._addToInitStaticBatchManager = function () {
                Sn.instance._addBatchSprite(this)
            }, t._cloneTo = function (t, e, n) {
                var i = t;
                i._meshFilter.sharedMesh = this._meshFilter.sharedMesh;
                var r = this._render, a = i._render;
                a.enable = r.enable, a.sharedMaterials = r.sharedMaterials, a.castShadow = r.castShadow;
                var o = r.lightmapScaleOffset;
                o && (a.lightmapScaleOffset = o.clone()), a.lightmapIndex = r.lightmapIndex, a.receiveShadow = r.receiveShadow, a.sortingFudge = r.sortingFudge, laya.d3.core.Sprite3D.prototype._cloneTo.call(this, t, e, n)
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this.destroyed || (e.prototype.destroy.call(this, t), this._meshFilter.destroy())
            }, u(0, t, "meshFilter", function () {
                return this._meshFilter
            }), u(0, t, "meshRenderer", function () {
                return this._render
            }), n.__init__ = function () {
                n.SHADERDEFINE_UV0 = n.shaderDefines.registerDefine("UV"), n.SHADERDEFINE_COLOR = n.shaderDefines.registerDefine("COLOR"), n.SHADERDEFINE_UV1 = n.shaderDefines.registerDefine("UV1"), n.SHADERDEFINE_GPU_INSTANCE = n.shaderDefines.registerDefine("GPU_INSTANCE"), Z._registerManager(Sn.instance), Q._registerManager(ln.instance)
            }, n.SHADERDEFINE_UV0 = 0, n.SHADERDEFINE_COLOR = 0, n.SHADERDEFINE_UV1 = 0, n.SHADERDEFINE_GPU_INSTANCE = 0, _(n, ["shaderDefines", function () {
                return this.shaderDefines = new ut(Jn.shaderDefines)
            }]), n
        }(Jn), vi = function (n) {
            function t() {
                this._direction = null, this._spotAngle = NaN, this._range = NaN, t.__super.call(this), this._spotAngle = 30, this._range = 10, this._direction = new Lt
            }

            d(t, "laya.d3.core.light.SpotLight", n);
            var e = t.prototype;
            return e._onActive = function () {
                n.prototype._onActive.call(this), this._lightmapBakedType !== ti.LIGHTMAPBAKEDTYPE_BAKED && this.scene._defineDatas.add(Qn.SHADERDEFINE_SPOTLIGHT)
            }, e._onInActive = function () {
                n.prototype._onInActive.call(this), this._lightmapBakedType !== ti.LIGHTMAPBAKEDTYPE_BAKED && this.scene._defineDatas.remove(Qn.SHADERDEFINE_SPOTLIGHT)
            }, e._prepareToScene = function () {
                var t = this._scene;
                if (t.enableLight && this.activeInHierarchy) {
                    t._defineDatas;
                    var e = t._shaderValues;
                    return Lt.scale(this.color, this._intensity, this._intensityColor), e.setVector3(Qn.SPOTLIGHTCOLOR, this._intensityColor), e.setVector3(Qn.SPOTLIGHTPOS, this.transform.position), this.transform.worldMatrix.getForward(this._direction), Lt.normalize(this._direction, this._direction), e.setVector3(Qn.SPOTLIGHTDIRECTION, this._direction), e.setNumber(Qn.SPOTLIGHTRANGE, this.range), e.setNumber(Qn.SPOTLIGHTSPOTANGLE, this.spotAngle * Math.PI / 180), !0
                }
                return !1
            }, e._parse = function (t, e) {
                n.prototype._parse.call(this, t, e), this.range = t.range, this.spotAngle = t.spotAngle
            }, u(0, e, "spotAngle", function () {
                return this._spotAngle
            }, function (t) {
                this._spotAngle = Math.max(Math.min(t, 180), 0)
            }), u(0, e, "range", function () {
                return this._range
            }, function (t) {
                this._range = t
            }), _(t, ["_tempMatrix0", function () {
                return this._tempMatrix0 = new He
            }, "_tempMatrix1", function () {
                return this._tempMatrix1 = new He
            }]), t
        }(ti), gi = function (t) {
            function e() {
                this._direction = null, e.__super.call(this), this._direction = new Lt
            }

            d(e, "laya.d3.core.light.DirectionLight", t);
            var n = e.prototype;
            return n._initShadow = function () {
                if (this._shadow) this._parallelSplitShadowMap = new wt, this.scene.parallelSplitShadowMaps.push(this._parallelSplitShadowMap), this.transform.worldMatrix.getForward(this._direction), Lt.normalize(this._direction, this._direction), this._parallelSplitShadowMap.setInfo(this.scene, this._shadowFarPlane, this._direction, this._shadowMapSize, this._shadowMapCount, this._shadowMapPCFType); else {
                    var t = this._scene._defineDatas, e = this.scene.parallelSplitShadowMaps;
                    e.splice(e.indexOf(this._parallelSplitShadowMap), 1), this._parallelSplitShadowMap.disposeAllRenderTarget(), this._parallelSplitShadowMap = null, t.remove(Qn.SHADERDEFINE_SHADOW_PSSM1), t.remove(Qn.SHADERDEFINE_SHADOW_PSSM2), t.remove(Qn.SHADERDEFINE_SHADOW_PSSM3)
                }
            }, n._onActive = function () {
                t.prototype._onActive.call(this), this._shadow && this._initShadow(), this._lightmapBakedType !== ti.LIGHTMAPBAKEDTYPE_BAKED && this._scene._defineDatas.add(Qn.SHADERDEFINE_DIRECTIONLIGHT)
            }, n._onInActive = function () {
                t.prototype._onInActive.call(this), this._lightmapBakedType !== ti.LIGHTMAPBAKEDTYPE_BAKED && this._scene._defineDatas.remove(Qn.SHADERDEFINE_DIRECTIONLIGHT)
            }, n._prepareToScene = function () {
                var t = this._scene;
                if (t.enableLight && this.activeInHierarchy) {
                    t._defineDatas;
                    var e = t._shaderValues;
                    return Lt.scale(this.color, this._intensity, this._intensityColor), e.setVector3(Qn.LIGHTDIRCOLOR, this._intensityColor), this.transform.worldMatrix.getForward(this._direction), Lt.normalize(this._direction, this._direction), e.setVector3(Qn.LIGHTDIRECTION, this._direction), !0
                }
                return !1
            }, u(0, n, "shadow", t.prototype._$get_shadow, function (t) {
                this._shadow !== t && (this._shadow = t, this.scene && this._initShadow())
            }), e
        }(ti), Si = function (e) {
            function t() {
                t.__super.call(this, this.name), this._render = new Kn(this), this._geometryFilter = new te(this)
            }

            d(t, "laya.d3.core.trail.TrailSprite3D", e);
            var n = t.prototype;
            return n._parse = function (t, e) {
                laya.d3.core.Sprite3D.prototype._parse.call(this, t, e);
                var n = this._render, i = this._geometryFilter, r = 0, a = 0, o = t.materials;
                if (o) {
                    var s = n.sharedMaterials, l = o.length;
                    for (s.length = l, r = 0; r < l; r++) s[r] = Dt.getRes(o[r].path);
                    n.sharedMaterials = s
                }
                i.time = t.time, i.minVertexDistance = t.minVertexDistance, i.widthMultiplier = t.widthMultiplier, i.textureMode = t.textureMode, null != t.alignment && (i.alignment = t.alignment);
                var h = [], u = t.widthCurve;
                for (r = 0, a = u.length; r < a; r++) {
                    var c = new Tn;
                    c.time = u[r].time, c.inTangent = u[r].inTangent, c.outTangent = u[r].outTangent, c.value = u[r].value, h.push(c)
                }
                i.widthCurve = h;
                var _ = t.colorGradient, d = _.colorKeys, f = _.alphaKeys, m = new rt(d.length, f.length);
                for (m.mode = _.mode, r = 0, a = d.length; r < a; r++) {
                    var p = d[r];
                    m.addColorRGB(p.time, new ft(p.value[0], p.value[1], p.value[2], 1))
                }
                for (r = 0, a = f.length; r < a; r++) {
                    var T = f[r];
                    m.addColorAlpha(T.time, T.value)
                }
                i.colorGradient = m
            }, n._onActive = function () {
                e.prototype._onActive.call(this), this._transform.position.cloneTo(this._geometryFilter._lastPosition)
            }, n._cloneTo = function (t, e, n) {
                laya.d3.core.Sprite3D.prototype._cloneTo.call(this, t, e, n);
                var i, r = 0, a = t, o = a.trailFilter;
                o.time = this.trailFilter.time, o.minVertexDistance = this.trailFilter.minVertexDistance, o.widthMultiplier = this.trailFilter.widthMultiplier, o.textureMode = this.trailFilter.textureMode;
                var s = this.trailFilter.widthCurve, l = [];
                for (r = 0, i = s.length; r < i; r++) {
                    var h = new Tn;
                    s[r].cloneTo(h), l.push(h)
                }
                o.widthCurve = l;
                var u = new rt(this.trailFilter.colorGradient.maxColorRGBKeysCount, this.trailFilter.colorGradient.maxColorAlphaKeysCount);
                this.trailFilter.colorGradient.cloneTo(u), o.colorGradient = u, a.trailRenderer.sharedMaterial = this.trailRenderer.sharedMaterial
            }, n.destroy = function (t) {
                void 0 === t && (t = !0), this.destroyed || (e.prototype.destroy.call(this, t), this._geometryFilter.destroy(), this._geometryFilter = null)
            }, u(0, n, "trailFilter", function () {
                return this._geometryFilter
            }), u(0, n, "trailRenderer", function () {
                return this._render
            }), t.__init__ = function () {
                t.SHADERDEFINE_GRADIENTMODE_BLEND = t.shaderDefines.registerDefine("GRADIENTMODE_BLEND")
            }, t.SHADERDEFINE_GRADIENTMODE_BLEND = 0, _(t, ["CURTIME", function () {
                return this.CURTIME = Pt.propertyNameToID("u_CurTime")
            }, "LIFETIME", function () {
                return this.LIFETIME = Pt.propertyNameToID("u_LifeTime")
            }, "WIDTHCURVE", function () {
                return this.WIDTHCURVE = Pt.propertyNameToID("u_WidthCurve")
            }, "WIDTHCURVEKEYLENGTH", function () {
                return this.WIDTHCURVEKEYLENGTH = Pt.propertyNameToID("u_WidthCurveKeyLength")
            }, "GRADIENTCOLORKEY", function () {
                return this.GRADIENTCOLORKEY = Pt.propertyNameToID("u_GradientColorkey")
            }, "GRADIENTALPHAKEY", function () {
                return this.GRADIENTALPHAKEY = Pt.propertyNameToID("u_GradientAlphakey")
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Jn.shaderDefines)
            }]), t
        }(Jn), yi = function (e) {
            function xt() {
                xt.__super.call(this, null), this._render = new Wn(this), this._particleSystem = new sn(this);
                var t = this._render._renderElements[0] = new vt;
                t.setTransform(this._transform), t.render = this._render, t.setGeometry(this._particleSystem), t.material = si.defaultMaterial
            }

            d(xt, "laya.d3.core.particleShuriKen.ShuriKenParticle3D", e);
            var t = xt.prototype;
            return t._initParticleVelocity = function (t) {
                for (var e = new Xt, n = t.velocitys, i = 0, r = n.length; i < r; i++) {
                    var a = n[i];
                    e.add(a.key, a.value)
                }
                return e
            }, t._initParticleColor = function (t) {
                var e = new rt(4, 4), n = t.alphas, i = 0, r = 0;
                for (i = 0, r = n.length; i < r; i++) {
                    var a = n[i];
                    3 === i && 1 !== a.key && (a.key = 1), e.addColorAlpha(a.key, a.value)
                }
                var o = t.rgbs;
                for (i = 0, r = o.length; i < r; i++) {
                    var s = o[i], l = s.value;
                    3 === i && 1 !== s.key && (s.key = 1), e.addColorRGB(s.key, new ft(l[0], l[1], l[2], 1))
                }
                return e
            }, t._initParticleSize = function (t) {
                for (var e = new Xt, n = t.sizes, i = 0, r = n.length; i < r; i++) {
                    var a = n[i];
                    e.add(a.key, a.value)
                }
                return e
            }, t._initParticleRotation = function (t) {
                for (var e = new Xt, n = t.angularVelocitys, i = 0, r = n.length; i < r; i++) {
                    var a = n[i];
                    e.add(a.key, a.value / 180 * Math.PI)
                }
                return e
            }, t._initParticleFrame = function (t) {
                for (var e = new ae, n = t.frames, i = 0, r = n.length; i < r; i++) {
                    var a = n[i];
                    e.add(a.key, a.value)
                }
                return e
            }, t._parse = function (t, e) {
                laya.d3.core.Sprite3D.prototype._parse.call(this, t, e);
                var n, i = Math.PI / 180, r = 0, a = 0, o = this.particleRenderer, s = t.material;
                s && (n = Dt.getRes(s.path)), o.sharedMaterial = n;
                var l = t.meshPath;
                l && (o.mesh = Dt.getRes(l)), o.renderMode = t.renderMode, o.stretchedBillboardCameraSpeedScale = t.stretchedBillboardCameraSpeedScale, o.stretchedBillboardSpeedScale = t.stretchedBillboardSpeedScale, o.stretchedBillboardLengthScale = t.stretchedBillboardLengthScale, o.sortingFudge = t.sortingFudge ? t.sortingFudge : 0;
                var h = this.particleSystem;
                h.isPerformanceMode = t.isPerformanceMode, h.duration = t.duration, h.looping = t.looping, h.prewarm = t.prewarm, h.startDelayType = t.startDelayType, h.startDelay = t.startDelay, h.startDelayMin = t.startDelayMin, h.startDelayMax = t.startDelayMax, h.startLifetimeType = t.startLifetimeType, h.startLifetimeConstant = t.startLifetimeConstant, h.startLifeTimeGradient = xt._initStartLife(t.startLifetimeGradient), h.startLifetimeConstantMin = t.startLifetimeConstantMin, h.startLifetimeConstantMax = t.startLifetimeConstantMax, h.startLifeTimeGradientMin = xt._initStartLife(t.startLifetimeGradientMin), h.startLifeTimeGradientMax = xt._initStartLife(t.startLifetimeGradientMax), h.startSpeedType = t.startSpeedType, h.startSpeedConstant = t.startSpeedConstant, h.startSpeedConstantMin = t.startSpeedConstantMin, h.startSpeedConstantMax = t.startSpeedConstantMax, h.threeDStartSize = t.threeDStartSize, h.startSizeType = t.startSizeType, h.startSizeConstant = t.startSizeConstant;
                var u = t.startSizeConstantSeparate, c = h.startSizeConstantSeparate;
                c.x = u[0], c.y = u[1], c.z = u[2], h.startSizeConstantMin = t.startSizeConstantMin, h.startSizeConstantMax = t.startSizeConstantMax;
                var _ = t.startSizeConstantMinSeparate, d = h.startSizeConstantMinSeparate;
                d.x = _[0], d.y = _[1], d.z = _[2];
                var f = t.startSizeConstantMaxSeparate, m = h.startSizeConstantMaxSeparate;
                m.x = f[0], m.y = f[1], m.z = f[2], h.threeDStartRotation = t.threeDStartRotation, h.startRotationType = t.startRotationType, h.startRotationConstant = t.startRotationConstant * i;
                var p = t.startRotationConstantSeparate, T = h.startRotationConstantSeparate;
                T.x = p[0] * i, T.y = p[1] * i, T.z = p[2] * i, h.startRotationConstantMin = t.startRotationConstantMin * i, h.startRotationConstantMax = t.startRotationConstantMax * i;
                var E = t.startRotationConstantMinSeparate, v = h.startRotationConstantMinSeparate;
                v.x = E[0] * i, v.y = E[1] * i, v.z = E[2] * i;
                var g = t.startRotationConstantMaxSeparate, S = h.startRotationConstantMaxSeparate;
                S.x = g[0] * i, S.y = g[1] * i, S.z = g[2] * i, h.randomizeRotationDirection = t.randomizeRotationDirection, h.startColorType = t.startColorType;
                var y = t.startColorConstant, x = h.startColorConstant;
                x.x = y[0], x.y = y[1], x.z = y[2], x.w = y[3];
                var D = t.startColorConstantMin, I = h.startColorConstantMin;
                I.x = D[0], I.y = D[1], I.z = D[2], I.w = D[3];
                var R = t.startColorConstantMax, M = h.startColorConstantMax;
                M.x = R[0], M.y = R[1], M.z = R[2], M.w = R[3], h.gravityModifier = t.gravityModifier, h.simulationSpace = t.simulationSpace, h.scaleMode = t.scaleMode, h.playOnAwake = t.playOnAwake, h.maxParticles = t.maxParticles;
                var A = t.autoRandomSeed;
                null != A && (h.autoRandomSeed = A);
                var C = t.randomSeed;
                null != C && (h.randomSeed[0] = C);
                var L = t.emission, O = h.emission;
                if (L) {
                    O.emissionRate = L.emissionRate;
                    var N = L.bursts;
                    if (N) for (r = 0, a = N.length; r < a; r++) {
                        var V = N[r];
                        O.addBurst(new ne(V.time, V.min, V.max))
                    }
                    O.enbale = L.enable
                } else O.enbale = !1;
                var P = t.shape;
                if (P) {
                    var w;
                    switch (P.shapeType) {
                        case 0:
                            var b;
                            w = b = new An, b.radius = P.sphereRadius, b.emitFromShell = P.sphereEmitFromShell, b.randomDirection = P.sphereRandomDirection;
                            break;
                        case 1:
                            var F;
                            w = F = new In, F.radius = P.hemiSphereRadius, F.emitFromShell = P.hemiSphereEmitFromShell, F.randomDirection = P.hemiSphereRandomDirection;
                            break;
                        case 2:
                            var B;
                            w = B = new $e, B.angle = P.coneAngle * i, B.radius = P.coneRadius, B.length = P.coneLength, B.emitType = P.coneEmitType, B.randomDirection = P.coneRandomDirection;
                            break;
                        case 3:
                            var U;
                            w = U = new Nn, U.x = P.boxX, U.y = P.boxY, U.z = P.boxZ, U.randomDirection = P.boxRandomDirection;
                            break;
                        case 7:
                            var z;
                            w = z = new en, z.radius = P.circleRadius, z.arc = P.circleArc * i, z.emitFromEdge = P.circleEmitFromEdge, z.randomDirection = P.circleRandomDirection;
                            break;
                        default:
                            var G;
                            w = G = new en, G.radius = P.circleRadius, G.arc = P.circleArc * i, G.emitFromEdge = P.circleEmitFromEdge, G.randomDirection = P.circleRandomDirection
                    }
                    w.enable = P.enable, h.shape = w
                }
                var H = t.velocityOverLifetime;
                if (H) {
                    var k, X = H.velocity;
                    switch (X.type) {
                        case 0:
                            var W = X.constant;
                            k = ye.createByConstant(new Lt(W[0], W[1], W[2]));
                            break;
                        case 1:
                            k = ye.createByGradient(this._initParticleVelocity(X.gradientX), this._initParticleVelocity(X.gradientY), this._initParticleVelocity(X.gradientZ));
                            break;
                        case 2:
                            var Y = X.constantMin, Z = X.constantMax;
                            k = ye.createByRandomTwoConstant(new Lt(Y[0], Y[1], Y[2]), new Lt(Z[0], Z[1], Z[2]));
                            break;
                        case 3:
                            k = ye.createByRandomTwoGradient(this._initParticleVelocity(X.gradientXMin), this._initParticleVelocity(X.gradientXMax), this._initParticleVelocity(X.gradientYMin), this._initParticleVelocity(X.gradientYMax), this._initParticleVelocity(X.gradientZMin), this._initParticleVelocity(X.gradientZMax))
                    }
                    var j = new Nt(k);
                    j.space = H.space, j.enbale = H.enable, h.velocityOverLifetime = j
                }
                var K = t.colorOverLifetime;
                if (K) {
                    var q, Q = K.color;
                    switch (Q.type) {
                        case 0:
                            var J = Q.constant;
                            q = Mt.createByConstant(new Ct(J[0], J[1], J[2], J[3]));
                            break;
                        case 1:
                            q = Mt.createByGradient(this._initParticleColor(Q.gradient));
                            break;
                        case 2:
                            var $ = Q.constantMin, tt = Q.constantMax;
                            q = Mt.createByRandomTwoConstant(new Ct($[0], $[1], $[2], $[3]), new Ct(tt[0], tt[1], tt[2], tt[3]));
                            break;
                        case 3:
                            q = Mt.createByRandomTwoGradient(this._initParticleColor(Q.gradientMin), this._initParticleColor(Q.gradientMax))
                    }
                    var et = new It(q);
                    et.enbale = K.enable, h.colorOverLifetime = et
                }
                var nt = t.sizeOverLifetime;
                if (nt) {
                    var it, rt = nt.size;
                    switch (rt.type) {
                        case 0:
                            it = rt.separateAxes ? Ee.createByGradientSeparate(this._initParticleSize(rt.gradientX), this._initParticleSize(rt.gradientY), this._initParticleSize(rt.gradientZ)) : Ee.createByGradient(this._initParticleSize(rt.gradient));
                            break;
                        case 1:
                            if (rt.separateAxes) {
                                var at = rt.constantMinSeparate, ot = rt.constantMaxSeparate;
                                it = Ee.createByRandomTwoConstantSeparate(new Lt(at[0], at[1], at[2]), new Lt(ot[0], ot[1], ot[2]))
                            } else it = Ee.createByRandomTwoConstant(rt.constantMin, rt.constantMax);
                            break;
                        case 2:
                            it = rt.separateAxes ? Ee.createByRandomTwoGradientSeparate(this._initParticleSize(rt.gradientXMin), this._initParticleSize(rt.gradientYMin), this._initParticleSize(rt.gradientZMin), this._initParticleSize(rt.gradientXMax), this._initParticleSize(rt.gradientYMax), this._initParticleSize(rt.gradientZMax)) : Ee.createByRandomTwoGradient(this._initParticleSize(rt.gradientMin), this._initParticleSize(rt.gradientMax))
                    }
                    var st = new At(it);
                    st.enbale = nt.enable, h.sizeOverLifetime = st
                }
                var lt = t.rotationOverLifetime;
                if (lt) {
                    var ht, ut = lt.angularVelocity;
                    switch (ut.type) {
                        case 0:
                            if (ut.separateAxes) {
                                var ct = ut.constantSeparate;
                                ht = he.createByConstantSeparate(new Lt(ct[0] * i, ct[1] * i, ct[2] * i))
                            } else ht = he.createByConstant(ut.constant * i);
                            break;
                        case 1:
                            ht = ut.separateAxes ? he.createByGradientSeparate(this._initParticleRotation(ut.gradientX), this._initParticleRotation(ut.gradientY), this._initParticleRotation(ut.gradientZ)) : he.createByGradient(this._initParticleRotation(ut.gradient));
                            break;
                        case 2:
                            if (ut.separateAxes) {
                                var _t = ut.constantMinSeparate, dt = ut.constantMaxSeparate;
                                ht = he.createByRandomTwoConstantSeparate(new Lt(_t[0] * i, _t[1] * i, _t[2] * i), new Lt(dt[0] * i, dt[1] * i, dt[2] * i))
                            } else ht = he.createByRandomTwoConstant(ut.constantMin * i, ut.constantMax * i);
                            break;
                        case 3:
                            ut.separateAxes || (ht = he.createByRandomTwoGradient(this._initParticleRotation(ut.gradientMin), this._initParticleRotation(ut.gradientMax)))
                    }
                    var ft = new Ne(ht);
                    ft.enbale = lt.enable, h.rotationOverLifetime = ft
                }
                var mt = t.textureSheetAnimation;
                if (mt) {
                    var pt, Tt = mt.frame;
                    switch (Tt.type) {
                        case 0:
                            pt = Rt.createByConstant(Tt.constant);
                            break;
                        case 1:
                            pt = Rt.createByOverTime(this._initParticleFrame(Tt.overTime));
                            break;
                        case 2:
                            pt = Rt.createByRandomTwoConstant(Tt.constantMin, Tt.constantMax);
                            break;
                        case 3:
                            pt = Rt.createByRandomTwoOverTime(this._initParticleFrame(Tt.overTimeMin), this._initParticleFrame(Tt.overTimeMax))
                    }
                    var Et, vt = mt.startFrame;
                    switch (vt.type) {
                        case 0:
                            Et = De.createByConstant(vt.constant);
                            break;
                        case 1:
                            Et = De.createByRandomTwoConstant(vt.constantMin, vt.constantMax)
                    }
                    var gt = new Vt(pt, Et);
                    gt.enable = mt.enable;
                    var St = mt.tiles;
                    gt.tiles = new Ot(St[0], St[1]), gt.type = mt.type, gt.randomRow = mt.randomRow;
                    var yt = mt.rowIndex;
                    void 0 !== yt && (gt.rowIndex = yt), gt.cycles = mt.cycles, h.textureSheetAnimation = gt
                }
            }, t._activeHierarchy = function (t) {
                laya.display.Node.prototype._activeHierarchy.call(this, t), this.particleSystem.playOnAwake && this.particleSystem.play()
            }, t._inActiveHierarchy = function (t) {
                laya.display.Node.prototype._inActiveHierarchy.call(this, t), this.particleSystem.isAlive && this.particleSystem.simulate(0, !0)
            }, t._cloneTo = function (t, e, n) {
                var i = t, r = i._particleSystem;
                this._particleSystem.cloneTo(r);
                var a = i._render, o = this._render;
                a.sharedMaterials = o.sharedMaterials, a.enable = o.enable, a.renderMode = o.renderMode, a.mesh = o.mesh, a.stretchedBillboardCameraSpeedScale = o.stretchedBillboardCameraSpeedScale, a.stretchedBillboardSpeedScale = o.stretchedBillboardSpeedScale, a.stretchedBillboardLengthScale = o.stretchedBillboardLengthScale, a.sortingFudge = o.sortingFudge, laya.d3.core.Sprite3D.prototype._cloneTo.call(this, t, e, n)
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this.destroyed || (e.prototype.destroy.call(this, t), this._particleSystem.destroy(), this._particleSystem = null)
            }, u(0, t, "particleSystem", function () {
                return this._particleSystem
            }), u(0, t, "particleRenderer", function () {
                return this._render
            }), xt.__init__ = function () {
                xt.SHADERDEFINE_RENDERMODE_BILLBOARD = xt.shaderDefines.registerDefine("SPHERHBILLBOARD"), xt.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD = xt.shaderDefines.registerDefine("STRETCHEDBILLBOARD"), xt.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD = xt.shaderDefines.registerDefine("HORIZONTALBILLBOARD"), xt.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD = xt.shaderDefines.registerDefine("VERTICALBILLBOARD"), xt.SHADERDEFINE_COLOROVERLIFETIME = xt.shaderDefines.registerDefine("COLOROVERLIFETIME"), xt.SHADERDEFINE_RANDOMCOLOROVERLIFETIME = xt.shaderDefines.registerDefine("RANDOMCOLOROVERLIFETIME"), xt.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT = xt.shaderDefines.registerDefine("VELOCITYOVERLIFETIMECONSTANT"), xt.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE = xt.shaderDefines.registerDefine("VELOCITYOVERLIFETIMECURVE"), xt.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT = xt.shaderDefines.registerDefine("VELOCITYOVERLIFETIMERANDOMCONSTANT"), xt.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE = xt.shaderDefines.registerDefine("VELOCITYOVERLIFETIMERANDOMCURVE"), xt.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE = xt.shaderDefines.registerDefine("TEXTURESHEETANIMATIONCURVE"), xt.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE = xt.shaderDefines.registerDefine("TEXTURESHEETANIMATIONRANDOMCURVE"), xt.SHADERDEFINE_ROTATIONOVERLIFETIME = xt.shaderDefines.registerDefine("ROTATIONOVERLIFETIME"), xt.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE = xt.shaderDefines.registerDefine("ROTATIONOVERLIFETIMESEPERATE"), xt.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT = xt.shaderDefines.registerDefine("ROTATIONOVERLIFETIMECONSTANT"), xt.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE = xt.shaderDefines.registerDefine("ROTATIONOVERLIFETIMECURVE"), xt.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS = xt.shaderDefines.registerDefine("ROTATIONOVERLIFETIMERANDOMCONSTANTS"), xt.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES = xt.shaderDefines.registerDefine("ROTATIONOVERLIFETIMERANDOMCURVES"), xt.SHADERDEFINE_SIZEOVERLIFETIMECURVE = xt.shaderDefines.registerDefine("SIZEOVERLIFETIMECURVE"), xt.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE = xt.shaderDefines.registerDefine("SIZEOVERLIFETIMECURVESEPERATE"), xt.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES = xt.shaderDefines.registerDefine("SIZEOVERLIFETIMERANDOMCURVES"), xt.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE = xt.shaderDefines.registerDefine("SIZEOVERLIFETIMERANDOMCURVESSEPERATE"), xt.SHADERDEFINE_RENDERMODE_MESH = xt.shaderDefines.registerDefine("RENDERMODE_MESH"), xt.SHADERDEFINE_SHAPE = xt.shaderDefines.registerDefine("SHAPE")
            }, xt._initStartLife = function (t) {
                for (var e = new Xt, n = t.startLifetimes, i = 0, r = n.length; i < r; i++) {
                    var a = n[i];
                    e.add(a.key, a.value)
                }
                return e
            }, xt.SHADERDEFINE_RENDERMODE_BILLBOARD = 0, xt.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD = 0, xt.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD = 0, xt.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD = 0, xt.SHADERDEFINE_COLOROVERLIFETIME = 0, xt.SHADERDEFINE_RANDOMCOLOROVERLIFETIME = 0, xt.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT = 0, xt.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE = 0, xt.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT = 0, xt.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE = 0, xt.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE = 0, xt.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE = 0, xt.SHADERDEFINE_ROTATIONOVERLIFETIME = 0, xt.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE = 0, xt.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT = 0, xt.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE = 0, xt.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS = 0, xt.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES = 0, xt.SHADERDEFINE_SIZEOVERLIFETIMECURVE = 0, xt.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE = 0, xt.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES = 0, xt.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE = 0, xt.SHADERDEFINE_RENDERMODE_MESH = 0, xt.SHADERDEFINE_SHAPE = 0, _(xt, ["WORLDPOSITION", function () {
                return this.WORLDPOSITION = Pt.propertyNameToID("u_WorldPosition")
            }, "WORLDROTATION", function () {
                return this.WORLDROTATION = Pt.propertyNameToID("u_WorldRotation")
            }, "POSITIONSCALE", function () {
                return this.POSITIONSCALE = Pt.propertyNameToID("u_PositionScale")
            }, "SIZESCALE", function () {
                return this.SIZESCALE = Pt.propertyNameToID("u_SizeScale")
            }, "SCALINGMODE", function () {
                return this.SCALINGMODE = Pt.propertyNameToID("u_ScalingMode")
            }, "GRAVITY", function () {
                return this.GRAVITY = Pt.propertyNameToID("u_Gravity")
            }, "THREEDSTARTROTATION", function () {
                return this.THREEDSTARTROTATION = Pt.propertyNameToID("u_ThreeDStartRotation")
            }, "STRETCHEDBILLBOARDLENGTHSCALE", function () {
                return this.STRETCHEDBILLBOARDLENGTHSCALE = Pt.propertyNameToID("u_StretchedBillboardLengthScale")
            }, "STRETCHEDBILLBOARDSPEEDSCALE", function () {
                return this.STRETCHEDBILLBOARDSPEEDSCALE = Pt.propertyNameToID("u_StretchedBillboardSpeedScale")
            }, "SIMULATIONSPACE", function () {
                return this.SIMULATIONSPACE = Pt.propertyNameToID("u_SimulationSpace")
            }, "CURRENTTIME", function () {
                return this.CURRENTTIME = Pt.propertyNameToID("u_CurrentTime")
            }, "VOLVELOCITYCONST", function () {
                return this.VOLVELOCITYCONST = Pt.propertyNameToID("u_VOLVelocityConst")
            }, "VOLVELOCITYGRADIENTX", function () {
                return this.VOLVELOCITYGRADIENTX = Pt.propertyNameToID("u_VOLVelocityGradientX")
            }, "VOLVELOCITYGRADIENTY", function () {
                return this.VOLVELOCITYGRADIENTY = Pt.propertyNameToID("u_VOLVelocityGradientY")
            }, "VOLVELOCITYGRADIENTZ", function () {
                return this.VOLVELOCITYGRADIENTZ = Pt.propertyNameToID("u_VOLVelocityGradientZ")
            }, "VOLVELOCITYCONSTMAX", function () {
                return this.VOLVELOCITYCONSTMAX = Pt.propertyNameToID("u_VOLVelocityConstMax")
            }, "VOLVELOCITYGRADIENTXMAX", function () {
                return this.VOLVELOCITYGRADIENTXMAX = Pt.propertyNameToID("u_VOLVelocityGradientMaxX")
            }, "VOLVELOCITYGRADIENTYMAX", function () {
                return this.VOLVELOCITYGRADIENTYMAX = Pt.propertyNameToID("u_VOLVelocityGradientMaxY")
            }, "VOLVELOCITYGRADIENTZMAX", function () {
                return this.VOLVELOCITYGRADIENTZMAX = Pt.propertyNameToID("u_VOLVelocityGradientMaxZ")
            }, "VOLSPACETYPE", function () {
                return this.VOLSPACETYPE = Pt.propertyNameToID("u_VOLSpaceType")
            }, "COLOROVERLIFEGRADIENTALPHAS", function () {
                return this.COLOROVERLIFEGRADIENTALPHAS = Pt.propertyNameToID("u_ColorOverLifeGradientAlphas")
            }, "COLOROVERLIFEGRADIENTCOLORS", function () {
                return this.COLOROVERLIFEGRADIENTCOLORS = Pt.propertyNameToID("u_ColorOverLifeGradientColors")
            }, "MAXCOLOROVERLIFEGRADIENTALPHAS", function () {
                return this.MAXCOLOROVERLIFEGRADIENTALPHAS = Pt.propertyNameToID("u_MaxColorOverLifeGradientAlphas")
            }, "MAXCOLOROVERLIFEGRADIENTCOLORS", function () {
                return this.MAXCOLOROVERLIFEGRADIENTCOLORS = Pt.propertyNameToID("u_MaxColorOverLifeGradientColors")
            }, "SOLSIZEGRADIENT", function () {
                return this.SOLSIZEGRADIENT = Pt.propertyNameToID("u_SOLSizeGradient")
            }, "SOLSIZEGRADIENTX", function () {
                return this.SOLSIZEGRADIENTX = Pt.propertyNameToID("u_SOLSizeGradientX")
            }, "SOLSIZEGRADIENTY", function () {
                return this.SOLSIZEGRADIENTY = Pt.propertyNameToID("u_SOLSizeGradientY")
            }, "SOLSizeGradientZ", function () {
                return this.SOLSizeGradientZ = Pt.propertyNameToID("u_SOLSizeGradientZ")
            }, "SOLSizeGradientMax", function () {
                return this.SOLSizeGradientMax = Pt.propertyNameToID("u_SOLSizeGradientMax")
            }, "SOLSIZEGRADIENTXMAX", function () {
                return this.SOLSIZEGRADIENTXMAX = Pt.propertyNameToID("u_SOLSizeGradientMaxX")
            }, "SOLSIZEGRADIENTYMAX", function () {
                return this.SOLSIZEGRADIENTYMAX = Pt.propertyNameToID("u_SOLSizeGradientMaxY")
            }, "SOLSizeGradientZMAX", function () {
                return this.SOLSizeGradientZMAX = Pt.propertyNameToID("u_SOLSizeGradientMaxZ")
            }, "ROLANGULARVELOCITYCONST", function () {
                return this.ROLANGULARVELOCITYCONST = Pt.propertyNameToID("u_ROLAngularVelocityConst")
            }, "ROLANGULARVELOCITYCONSTSEPRARATE", function () {
                return this.ROLANGULARVELOCITYCONSTSEPRARATE = Pt.propertyNameToID("u_ROLAngularVelocityConstSeprarate")
            }, "ROLANGULARVELOCITYGRADIENT", function () {
                return this.ROLANGULARVELOCITYGRADIENT = Pt.propertyNameToID("u_ROLAngularVelocityGradient")
            }, "ROLANGULARVELOCITYGRADIENTX", function () {
                return this.ROLANGULARVELOCITYGRADIENTX = Pt.propertyNameToID("u_ROLAngularVelocityGradientX")
            }, "ROLANGULARVELOCITYGRADIENTY", function () {
                return this.ROLANGULARVELOCITYGRADIENTY = Pt.propertyNameToID("u_ROLAngularVelocityGradientY")
            }, "ROLANGULARVELOCITYGRADIENTZ", function () {
                return this.ROLANGULARVELOCITYGRADIENTZ = Pt.propertyNameToID("u_ROLAngularVelocityGradientZ")
            }, "ROLANGULARVELOCITYCONSTMAX", function () {
                return this.ROLANGULARVELOCITYCONSTMAX = Pt.propertyNameToID("u_ROLAngularVelocityConstMax")
            }, "ROLANGULARVELOCITYCONSTMAXSEPRARATE", function () {
                return this.ROLANGULARVELOCITYCONSTMAXSEPRARATE = Pt.propertyNameToID("u_ROLAngularVelocityConstMaxSeprarate")
            }, "ROLANGULARVELOCITYGRADIENTMAX", function () {
                return this.ROLANGULARVELOCITYGRADIENTMAX = Pt.propertyNameToID("u_ROLAngularVelocityGradientMax")
            }, "ROLANGULARVELOCITYGRADIENTXMAX", function () {
                return this.ROLANGULARVELOCITYGRADIENTXMAX = Pt.propertyNameToID("u_ROLAngularVelocityGradientMaxX")
            }, "ROLANGULARVELOCITYGRADIENTYMAX", function () {
                return this.ROLANGULARVELOCITYGRADIENTYMAX = Pt.propertyNameToID("u_ROLAngularVelocityGradientMaxY")
            }, "ROLANGULARVELOCITYGRADIENTZMAX", function () {
                return this.ROLANGULARVELOCITYGRADIENTZMAX = Pt.propertyNameToID("u_ROLAngularVelocityGradientMaxZ")
            }, "ROLANGULARVELOCITYGRADIENTWMAX", function () {
                return this.ROLANGULARVELOCITYGRADIENTWMAX = Pt.propertyNameToID("u_ROLAngularVelocityGradientMaxW")
            }, "TEXTURESHEETANIMATIONCYCLES", function () {
                return this.TEXTURESHEETANIMATIONCYCLES = Pt.propertyNameToID("u_TSACycles")
            }, "TEXTURESHEETANIMATIONSUBUVLENGTH", function () {
                return this.TEXTURESHEETANIMATIONSUBUVLENGTH = Pt.propertyNameToID("u_TSASubUVLength")
            }, "TEXTURESHEETANIMATIONGRADIENTUVS", function () {
                return this.TEXTURESHEETANIMATIONGRADIENTUVS = Pt.propertyNameToID("u_TSAGradientUVs")
            }, "TEXTURESHEETANIMATIONGRADIENTMAXUVS", function () {
                return this.TEXTURESHEETANIMATIONGRADIENTMAXUVS = Pt.propertyNameToID("u_TSAMaxGradientUVs")
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Jn.shaderDefines)
            }]), xt
        }(Jn), xi = function (t) {
            function n(t, e) {
                this._geometryFilter = null, void 0 === t && (t = 2), n.__super.call(this, e), this._geometryFilter = new mn(this, t), this._render = new qn(this), this._changeRenderObjects(this._render, 0, ri.defaultMaterial)
            }

            d(n, "laya.d3.core.pixelLine.PixelLineSprite3D", Jn);
            var e = n.prototype;
            return e._changeRenderObjects = function (t, e, n) {
                var i = this._render._renderElements;
                n || (n = ri.defaultMaterial);
                var r = i[e];
                r || (r = i[e] = new vt), r.setTransform(this._transform), r.setGeometry(this._geometryFilter), r.render = this._render, r.material = n
            }, e.addLine = function (t, e, n, i) {
                if (this._geometryFilter._lineCount === this._geometryFilter._maxLineCount) throw"PixelLineSprite3D: lineCount has equal with maxLineCount.";
                this._geometryFilter._updateLineData(this._geometryFilter._lineCount++, t, e, n, i)
            }, e.addLines = function (t) {
                var e = this._geometryFilter._lineCount, n = t.length;
                if (e + n > this._geometryFilter._maxLineCount) throw"PixelLineSprite3D: lineCount plus lines count must less than maxLineCount.";
                this._geometryFilter._updateLineDatas(e, t), this._geometryFilter._lineCount += n
            }, e.removeLine = function (t) {
                if (!(t < this._geometryFilter._lineCount)) throw"PixelLineSprite3D: index must less than lineCount.";
                this._geometryFilter._removeLineData(t)
            }, e.setLine = function (t, e, n, i, r) {
                if (!(t < this._geometryFilter._lineCount)) throw"PixelLineSprite3D: index must less than lineCount.";
                this._geometryFilter._updateLineData(t, e, n, i, r)
            }, e.getLine = function (t, e) {
                if (!(t < this.lineCount)) throw"PixelLineSprite3D: index must less than lineCount.";
                this._geometryFilter._getLineData(t, e)
            }, e.clear = function () {
                this._geometryFilter._lineCount = 0
            }, u(0, e, "maxLineCount", function () {
                return this._geometryFilter._maxLineCount
            }, function (t) {
                this._geometryFilter._resizeLineData(t), this._geometryFilter._lineCount = Math.min(this._geometryFilter._lineCount, t)
            }), u(0, e, "pixelLineRenderer", function () {
                return this._render
            }), u(0, e, "lineCount", function () {
                return this._geometryFilter._lineCount
            }, function (t) {
                if (t > this.maxLineCount) throw"PixelLineSprite3D: lineCount can't large than maxLineCount";
                this._geometryFilter._lineCount = t
            }), n
        }(), Di = function (e) {
            function f(t, e) {
                f.__super.call(this, e), this._meshFilter = new $t(this), this._render = new mi(this), t && (this._meshFilter.sharedMesh = t)
            }

            d(f, "laya.d3.core.SkinnedMeshSprite3D", e);
            var t = f.prototype;
            return t._parse = function (t, e) {
                laya.d3.core.Sprite3D.prototype._parse.call(this, t, e);
                var n = this.skinnedMeshRenderer, i = t.lightmapIndex;
                null != i && (n.lightmapIndex = i);
                var r, a = t.lightmapScaleOffset;
                if (a && (n.lightmapScaleOffset = new Ct(a[0], a[1], a[2], a[3])), r = t.meshPath) {
                    var o = Dt.getRes(r);
                    o && (this.meshFilter.sharedMesh = o)
                }
                var s = t.materials;
                if (s) {
                    var l = n.sharedMaterials, h = s.length;
                    l.length = h;
                    for (var u = 0; u < h; u++) l[u] = Dt.getRes(s[u].path);
                    n.sharedMaterials = l
                }
                var c = t.boundBox, _ = c.min, d = c.max;
                if (n.localBounds.setMin(new Lt(_[0], _[1], _[2])), n.localBounds.setMax(new Lt(d[0], d[1], d[2])), e) {
                    var f = t.rootBone;
                    n.rootBone = e[f];
                    var m, p = t.bones;
                    for (u = 0, m = p.length; u < m; u++) n.bones.push(e[p[u]])
                } else t.rootBone && n._setRootBone(t.rootBone)
            }, t._changeHierarchyAnimator = function (t) {
                e.prototype._changeHierarchyAnimator.call(this, t), this.skinnedMeshRenderer._setCacheAnimator(t)
            }, t._changeAnimatorAvatar = function (t) {
                this.skinnedMeshRenderer._setCacheAvatar(t)
            }, t._cloneTo = function (t, e, n) {
                var i = t;
                i.meshFilter.sharedMesh = this.meshFilter.sharedMesh;
                var r = this._render, a = i._render;
                a.enable = r.enable, a.sharedMaterials = r.sharedMaterials, a.castShadow = r.castShadow;
                var o = r.lightmapScaleOffset;
                o && (a.lightmapScaleOffset = o.clone()), a.receiveShadow = r.receiveShadow, a.sortingFudge = r.sortingFudge, a._rootBone = r._rootBone;
                var s = r.bones, l = a.bones, h = s.length;
                l.length = h;
                var u = r.rootBone;
                if (u) {
                    var c = kt._getHierarchyPath(e, u, f._tempArray0);
                    a.rootBone = c ? kt._getNodeByHierarchyPath(n, c) : u
                }
                for (var _ = 0; _ < s.length; _++) c = kt._getHierarchyPath(e, s[_], f._tempArray0), l[_] = c ? kt._getNodeByHierarchyPath(n, c) : s[_];
                var d = r.localBounds;
                d && d.cloneTo(a.localBounds), laya.d3.core.Sprite3D.prototype._cloneTo.call(this, t, e, n)
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this.destroyed || (e.prototype.destroy.call(this, t), this._meshFilter.destroy())
            }, u(0, t, "meshFilter", function () {
                return this._meshFilter
            }), u(0, t, "skinnedMeshRenderer", function () {
                return this._render
            }), f.__init__ = function () {
                f.SHADERDEFINE_BONE = f.shaderDefines.registerDefine("BONE")
            }, f._tempArray0 = [], f.SHADERDEFINE_BONE = 0, _(f, ["BONES", function () {
                return this.BONES = Pt.propertyNameToID("u_Bones")
            }, "shaderDefines", function () {
                return this.shaderDefines = new ut(Ei.shaderDefines)
            }]), f
        }(Jn), Ii = function (n) {
            function a() {
                this._range = NaN, this._lightMatrix = new He, a.__super.call(this), this._range = 6
            }

            d(a, "laya.d3.core.light.PointLight", n);
            var t = a.prototype;
            return t._onActive = function () {
                n.prototype._onActive.call(this), this._lightmapBakedType !== ti.LIGHTMAPBAKEDTYPE_BAKED && this._scene._defineDatas.add(Qn.SHADERDEFINE_POINTLIGHT)
            }, t._onInActive = function () {
                n.prototype._onInActive.call(this), this._lightmapBakedType !== ti.LIGHTMAPBAKEDTYPE_BAKED && this._scene._defineDatas.remove(Qn.SHADERDEFINE_POINTLIGHT)
            }, t._prepareToScene = function () {
                var t = this._scene;
                if (t.enableLight && this.activeInHierarchy) {
                    t._defineDatas;
                    var e = t._shaderValues;
                    Lt.scale(this.color, this._intensity, this._intensityColor), e.setVector3(Qn.POINTLIGHTCOLOR, this._intensityColor), e.setVector3(Qn.POINTLIGHTPOS, this.transform.position), e.setNumber(Qn.POINTLIGHTRANGE, this.range);
                    var n = this._lightMatrix, i = n.elements;
                    n.identity(), i[0] = i[5] = i[10] = 1 / this._range;
                    var r = a._tempMatrix0;
                    return this.transform.worldMatrix.invert(r), He.multiply(n, r, n), e.setMatrix4x4(Qn.POINTLIGHTMATRIX, n), !0
                }
                return !1
            }, t._parse = function (t, e) {
                n.prototype._parse.call(this, t, e), this.range = t.range
            }, u(0, t, "range", function () {
                return this._range
            }, function (t) {
                this._range = t
            }), _(a, ["_tempMatrix0", function () {
                return this._tempMatrix0 = new He
            }]), a
        }(ti), Ri = function (e) {
            function l(t, e, n, i, r, a, o, s) {
                this._terrainFilter = null, l.__super.call(this, s), this._terrainFilter = new Rn(this, t, e, n, i, r, a, o), this._render = new Zn(this)
            }

            d(l, "laya.d3.terrain.TerrainChunk", e);
            var t = l.prototype;
            return t.buildRenderElementAndMaterial = function (t, e, n, i, r, a, o, s, l, h, u, c, _, d, f, m, p, T) {
                void 0 === u && (u = 1), void 0 === c && (c = 1), void 0 === _ && (_ = 1), void 0 === d && (d = 1), void 0 === f && (f = 1), void 0 === m && (m = 1), void 0 === p && (p = 1), void 0 === T && (T = 1);
                var E = new _i;
                l && (E.diffuseColor = l), s && (E.ambientColor = s), h && (E.specularColor = h), E.splatAlphaTexture = Dt.getRes(n), E.normalTexture = e ? Dt.getRes(e) : null, E.diffuseTexture1 = i ? Dt.getRes(i) : null, E.diffuseTexture2 = r ? Dt.getRes(r) : null, E.diffuseTexture3 = a ? Dt.getRes(a) : null, E.diffuseTexture4 = o ? Dt.getRes(o) : null, E.setDiffuseScale1(u, c), E.setDiffuseScale2(_, d), E.setDiffuseScale3(f, m), E.setDiffuseScale4(p, T), E.setDetailNum(t), 0 != this._render._renderElements.length && (E.renderMode = 2);
                var v = new vt;
                v.setTransform(this._transform), v.render = this._render, v.setGeometry(this._terrainFilter), this._render._renderElements.push(v), this._render.sharedMaterial = E
            }, t._cloneTo = function (t, e, n) {
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this.destroyed || (e.prototype.destroy.call(this, t), this._terrainFilter.destroy(), this._terrainFilter = null)
            }, u(0, t, "terrainFilter", function () {
                return this._terrainFilter
            }), u(0, t, "terrainRender", function () {
                return this._render
            }), l
        }(Jn), Mi = function (i) {
            function r(t, e, n) {
                this._updateViewMatrix = !0, this._offScreenRenderTexture = null, this._alwaysUseRenderTexture = !1, this._renderTexture = null, this._postProcess = null, this.enableRender = !0, this._screenShaderData = new ot, this._postProcessCommandBuffers = [], void 0 === t && (t = 0), void 0 === e && (e = .3), void 0 === n && (n = 1e3), this._viewMatrix = new He, this._projectionMatrix = new He, this._projectionViewMatrix = new He, this._projectionViewMatrixNoTranslateScale = new He, this._viewport = new Me(0, 0, 0, 0), this._normalizedViewport = new Me(0, 0, 1, 1), this._aspectRatio = t, this._boundFrustum = new Ve(He.DEFAULT), b.supportWebGLPlusCulling && (this._boundFrustumBuffer = new Float32Array(24)), r.__super.call(this, e, n), this.transform.on("transformchanged", this, this._onTransformChanged)
            }

            d(r, "laya.d3.core.Camera", i);
            var t = r.prototype;
            return t._isLayerVisible = function (t) {
                return 0 != (Math.pow(2, t) & this.cullingMask)
            }, t._onTransformChanged = function (t) {
                (t &= 64) && (this._updateViewMatrix = !0)
            }, t._calculationViewport = function (t, e, n) {
                var i = t.x * e, r = t.y * n, a = i + Math.max(t.width * e, 0), o = r + Math.max(t.height * n, 0),
                    s = Math.ceil(i), l = Math.ceil(r), h = Math.floor(a), u = Math.floor(o),
                    c = .5 <= s - i ? Math.floor(i) : s, _ = .5 <= l - r ? Math.floor(r) : l,
                    d = .5 <= a - h ? Math.ceil(a) : h, f = .5 <= o - u ? Math.ceil(o) : u;
                this._viewport.x = c, this._viewport.y = _, this._viewport.width = d - c, this._viewport.height = f - _
            }, t._parse = function (t, e) {
                i.prototype._parse.call(this, t, e);
                var n = t.viewport;
                this.normalizedViewport = new Me(n[0], n[1], n[2], n[3])
            }, t._calculateProjectionMatrix = function () {
                if (!this._useUserProjectionMatrix) if (this._orthographic) {
                    var t = this.orthographicVerticalSize * this.aspectRatio * .5,
                        e = .5 * this.orthographicVerticalSize;
                    He.createOrthoOffCenter(-t, t, -e, e, this.nearPlane, this.farPlane, this._projectionMatrix)
                } else He.createPerspective(3.1416 * this.fieldOfView / 180, this.aspectRatio, this.nearPlane, this.farPlane, this._projectionMatrix)
            }, t._getCanvasHeight = function () {
                return this._offScreenRenderTexture ? this._offScreenRenderTexture.height : K.clientHeight
            }, t._applyPostProcessCommandBuffers = function () {
                for (var t = 0, e = this._postProcessCommandBuffers.length; t < e; t++) this._postProcessCommandBuffers[t]._apply()
            }, t._needForceSetRenderTexture = function () {
                return this._alwaysUseRenderTexture && !this._offScreenRenderTexture
            }, t.render = function (t, e) {
                if (this._scene) {
                    var n = this._needForceSetRenderTexture();
                    n && (this._renderTexture = pi.getTemporary(K.clientWidth, K.clientHeight, 0, 0, 1));
                    var i, r, a = E.instance, o = K._instance, s = o.scene = this._scene;
                    if (s.parallelSplitShadowMaps[0]) {
                        ot.setRuntimeValueMode(!1);
                        var l = s.parallelSplitShadowMaps[0];
                        l._calcAllLightCameraInfo(this), s._defineDatas.add(Qn.SHADERDEFINE_CAST_SHADOW);
                        for (var h = 0, u = l.shadowMapCount; h < u; h++) {
                            var c = l.cameras[h];
                            o.camera = c, o.projectionViewMatrix = c.projectionViewMatrix, we.renderObjectCulling(c, s, o, s._castShadowRenders);
                            var _ = l.cameras[h + 1].renderTarget;
                            _._start(), o.camera = c, o.viewport = c.viewport, c._prepareCameraToRender(), c._prepareCameraViewProject(c.viewMatrix, c.projectionMatrix, o.projectionViewMatrix, c._projectionViewMatrixNoTranslateScale), s._clear(a, o), s._opaqueQueue._render(o, !1), _._end()
                        }
                        s._defineDatas.remove(Qn.SHADERDEFINE_CAST_SHADOW), ot.setRuntimeValueMode(!0)
                    }
                    o.camera = this, s._preRenderScript(), i = o.viewMatrix = this.viewMatrix;
                    var d = this._renderTexture;
                    if (o.projectionViewMatrix = d ? (d._start(), He.multiply(ai._invertYScaleMatrix, this._projectionMatrix, ai._invertYProjectionMatrix), He.multiply(ai._invertYScaleMatrix, this.projectionViewMatrix, ai._invertYProjectionViewMatrix), r = o.projectionMatrix = ai._invertYProjectionMatrix, ai._invertYProjectionViewMatrix) : (r = o.projectionMatrix = this._projectionMatrix, this.projectionViewMatrix), o.viewport = this.viewport, this._prepareCameraToRender(), this._prepareCameraViewProject(i, r, o.projectionViewMatrix, this._projectionViewMatrixNoTranslateScale), s._preCulling(o, this), s._clear(a, o), s._renderScene(a, o, t, e), s._postRenderScript(), d && d._end(), this._postProcess && this._postProcess._render(), n) {
                        var f = nn.create(this._renderTexture, null, le.screenShader, this._screenShaderData);
                        f.run(), f.recover(), pi.setReleaseTemporary(this._renderTexture)
                    }
                }
            }, t.viewportPointToRay = function (t, e) {
                ce.calculateCursorRay(t, this.viewport, this._projectionMatrix, this.viewMatrix, null, e)
            }, t.normalizedViewportPointToRay = function (t, e) {
                var n = r._tempVector20, i = this.viewport;
                n.x = t.x * i.width, n.y = t.y * i.height, ce.calculateCursorRay(n, this.viewport, this._projectionMatrix, this.viewMatrix, null, e)
            }, t.worldToViewportPoint = function (t, e) {
                He.multiply(this._projectionMatrix, this._viewMatrix, this._projectionViewMatrix), this.viewport.project(t, this._projectionViewMatrix, e), e.x = e.x / m.stage.clientScaleX, e.y = e.y / m.stage.clientScaleY
            }, t.worldToNormalizedViewportPoint = function (t, e) {
                He.multiply(this._projectionMatrix, this._viewMatrix, this._projectionViewMatrix), this.normalizedViewport.project(t, this._projectionViewMatrix, e), e.x = e.x / m.stage.clientScaleX, e.y = e.y / m.stage.clientScaleY
            }, t.convertScreenCoordToOrthographicCoord = function (t, e) {
                if (this._orthographic) {
                    var n = K.clientWidth, i = K.clientHeight, r = this.orthographicVerticalSize * this.aspectRatio / n,
                        a = this.orthographicVerticalSize / i;
                    return e.x = (-n / 2 + t.x) * r, e.y = (i / 2 - t.y) * a, e.z = (this.nearPlane - this.farPlane) * (t.z + 1) / 2 - this.nearPlane, Lt.transformCoordinate(e, this.transform.worldMatrix, e), !0
                }
                return !1
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this._offScreenRenderTexture = null, this.transform.off("transformchanged", this, this._onTransformChanged), i.prototype.destroy.call(this, t)
            }, t.addCommandBuffer = function (t, e) {
                switch (t) {
                    case 0:
                        this._postProcessCommandBuffers.push(e);
                        break;
                    default:
                        throw"Camera:unknown event."
                }
            }, t.removeCommandBuffer = function (t, e) {
                switch (t) {
                    case 0:
                        var n = this._postProcessCommandBuffers.indexOf(e);
                        -1 !== n && this._postProcessCommandBuffers.splice(n, 1);
                        break;
                    default:
                        throw"Camera:unknown event."
                }
            }, t.removeCommandBuffers = function (t) {
                switch (t) {
                    case 0:
                        this._postProcessCommandBuffers.length = 0;
                        break;
                    default:
                        throw"Camera:unknown event."
                }
            }, t.getRenderTexture = function () {
                return this._renderTexture
            }, u(0, t, "renderTarget", function () {
                return this._offScreenRenderTexture
            }, function (t) {
                this._offScreenRenderTexture !== t && (this._offScreenRenderTexture = t, this._renderTexture = t, this._calculateProjectionMatrix())
            }), u(0, t, "projectionViewMatrix", function () {
                return He.multiply(this.projectionMatrix, this.viewMatrix, this._projectionViewMatrix), this._projectionViewMatrix
            }), u(0, t, "aspectRatio", function () {
                if (0 !== this._aspectRatio) return this._aspectRatio;
                var t = this.viewport;
                return t.width / t.height
            }, function (t) {
                if (t < 0) throw new Error("Camera: the aspect ratio has to be a positive real number.");
                this._aspectRatio = t, this._calculateProjectionMatrix()
            }), u(0, t, "boundFrustum", function () {
                if (this._boundFrustum.matrix = this.projectionViewMatrix, b.supportWebGLPlusCulling) {
                    var t = this._boundFrustum.near, e = this._boundFrustum.far, n = this._boundFrustum.left,
                        i = this._boundFrustum.right, r = this._boundFrustum.top, a = this._boundFrustum.bottom,
                        o = t.normal, s = e.normal, l = n.normal, h = i.normal, u = r.normal, c = a.normal,
                        _ = this._boundFrustumBuffer;
                    _[0] = o.x, _[1] = o.y, _[2] = o.z, _[3] = t.distance, _[4] = s.x, _[5] = s.y, _[6] = s.z, _[7] = e.distance, _[8] = l.x, _[9] = l.y, _[10] = l.z, _[11] = n.distance, _[12] = h.x, _[13] = h.y, _[14] = h.z, _[15] = i.distance, _[16] = u.x, _[17] = u.y, _[18] = u.z, _[19] = r.distance, _[20] = c.x, _[21] = c.y, _[22] = c.z, _[23] = a.distance
                }
                return this._boundFrustum
            }), u(0, t, "viewport", function () {
                return this._offScreenRenderTexture ? this._calculationViewport(this._normalizedViewport, this._offScreenRenderTexture.width, this._offScreenRenderTexture.height) : this._calculationViewport(this._normalizedViewport, K.clientWidth, K.clientHeight), this._viewport
            }, function (t) {
                var e = 0, n = 0;
                n = this._offScreenRenderTexture ? (e = this._offScreenRenderTexture.width, this._offScreenRenderTexture.height) : (e = K.clientWidth, K.clientHeight), this._normalizedViewport.x = t.x / e, this._normalizedViewport.y = t.y / n, this._normalizedViewport.width = t.width / e, this._normalizedViewport.height = t.height / n, this._calculationViewport(this._normalizedViewport, e, n), this._calculateProjectionMatrix()
            }), u(0, t, "alwaysUseRenderTexture", function () {
                return this._alwaysUseRenderTexture
            }, function (t) {
                this._alwaysUseRenderTexture = t
            }), u(0, t, "normalizedViewport", function () {
                return this._normalizedViewport
            }, function (t) {
                var e = 0, n = 0;
                n = this._offScreenRenderTexture ? (e = this._offScreenRenderTexture.width, this._offScreenRenderTexture.height) : (e = K.clientWidth, K.clientHeight), this._normalizedViewport !== t && t.cloneTo(this._normalizedViewport), this._calculationViewport(t, e, n), this._calculateProjectionMatrix()
            }), u(0, t, "projectionMatrix", function () {
                return this._projectionMatrix
            }, function (t) {
                this._projectionMatrix = t, this._useUserProjectionMatrix = !0
            }), u(0, t, "viewMatrix", function () {
                if (this._updateViewMatrix) {
                    var t = this.transform.scale, e = t.x, n = t.y, i = t.z, r = this._viewMatrix.elements;
                    this.transform.worldMatrix.cloneTo(this._viewMatrix), r[0] /= e, r[1] /= e, r[2] /= e, r[4] /= n, r[5] /= n, r[6] /= n, r[8] /= i, r[9] /= i, r[10] /= i, this._viewMatrix.invert(this._viewMatrix), this._updateViewMatrix = !1
                }
                return this._viewMatrix
            }), u(0, t, "postProcess", function () {
                return this._postProcess
            }, function (t) {
                this._postProcess = t, this.alwaysUseRenderTexture = !0;
                var e = new le;
                this.addCommandBuffer(0, e), t._init(this, e)
            }), r.CAMERAEVENT_POSTPROCESS = 0, r._updateMark = 0, _(r, ["_tempVector20", function () {
                return this._tempVector20 = new Ot
            }]), r
        }(ai);
        !function (t) {
            function v(t, e, n) {
                this._minX = NaN, this._minZ = NaN, this._cellSize = null, this._heightMap = null, v.__super.call(this, t, n), this._heightMap = e, this._cellSize = new Ot
            }

            d(v, "laya.d3.core.MeshTerrainSprite3D", Ei);
            var e = v.prototype;
            e._disableRotation = function () {
                var t = this.transform.rotation;
                t.x = 0, t.y = 0, t.z = 0, t.w = 1, this.transform.rotation = t
            }, e._getScaleX = function () {
                var t = this.transform.worldMatrix.elements, e = t[0], n = t[1], i = t[2];
                return Math.sqrt(e * e + n * n + i * i)
            }, e._getScaleZ = function () {
                var t = this.transform.worldMatrix.elements, e = t[8], n = t[9], i = t[10];
                return Math.sqrt(e * e + n * n + i * i)
            }, e._initCreateFromMesh = function (t, e) {
                this._heightMap = Gt.creatFromMesh(this.meshFilter.sharedMesh, t, e, this._cellSize);
                var n = this.meshFilter.sharedMesh.bounds, i = n.getMin();
                n.getMax();
                this._minX = i.x, this._minZ = i.z
            }, e._initCreateFromMeshHeightMap = function (t, e, n) {
                var i = this.meshFilter.sharedMesh.bounds;
                this._heightMap = Gt.createFromImage(t, e, n), this._computeCellSize(i);
                var r = i.getMin();
                i.getMax();
                this._minX = r.x, this._minZ = r.z
            }, e._computeCellSize = function (t) {
                var e = t.getMin(), n = t.getMax(), i = e.x, r = e.z, a = n.x - i, o = n.z - r;
                this._cellSize.x = a / (this._heightMap.width - 1), this._cellSize.y = o / (this._heightMap.height - 1)
            }, e._update = function (t) {
                this._disableRotation()
            }, e.getHeight = function (t, e) {
                v._tempVector3.x = t, v._tempVector3.y = 0, v._tempVector3.z = e, this._disableRotation();
                var n = this.transform.worldMatrix;
                n.invert(v._tempMatrix4x4), Lt.transformCoordinate(v._tempVector3, v._tempMatrix4x4, v._tempVector3), t = v._tempVector3.x, e = v._tempVector3.z;
                var i = (t - this._minX) / this._cellSize.x, r = (e - this._minZ) / this._cellSize.y, a = Math.floor(r),
                    o = Math.floor(i), s = i - o, l = r - a, h = n.elements, u = h[4], c = h[5], _ = h[6],
                    d = Math.sqrt(u * u + c * c + _ * _), f = h[13], m = this._heightMap.getHeight(a, o + 1),
                    p = this._heightMap.getHeight(a + 1, o);
                if (isNaN(m) || isNaN(p)) return NaN;
                if (s + l <= 1) {
                    var T = this._heightMap.getHeight(a, o);
                    return isNaN(T) ? NaN : (T + s * (m - T) + l * (p - T)) * d + f
                }
                var E = this._heightMap.getHeight(a + 1, o + 1);
                return isNaN(E) ? NaN : (E + (1 - s) * (p - E) + (1 - l) * (m - E)) * d + f
            }, u(0, e, "minX", function () {
                var t = this.transform.worldMatrix.elements;
                return this._minX * this._getScaleX() + t[12]
            }), u(0, e, "width", function () {
                return (this._heightMap.width - 1) * this._cellSize.x * this._getScaleX()
            }), u(0, e, "minZ", function () {
                var t = this.transform.worldMatrix.elements;
                return this._minZ * this._getScaleZ() + t[14]
            }), u(0, e, "depth", function () {
                return (this._heightMap.height - 1) * this._cellSize.y * this._getScaleZ()
            }), v.createFromMesh = function (t, e, n, i) {
                var r = new v(t, null, i);
                return r._initCreateFromMesh(e, n), r
            }, v.createFromMeshAndHeightMap = function (t, e, n, i, r) {
                var a = new v(t, null, r);
                return a._initCreateFromMeshHeightMap(e, n, i), a
            }, _(v, ["_tempVector3", function () {
                return this._tempVector3 = new Lt
            }, "_tempMatrix4x4", function () {
                return this._tempMatrix4x4 = new He
            }])
        }()
    }(window, document, Laya);
});
define("libs/laya.effect.js", function (require, module, exports) {
    !function (t, e, i) {
        i.un, i.uns, i.static;
        var n = i.class, s = i.getset, r = (i.__newvec, laya.filters.BlurFilter), h = laya.filters.ColorFilter,
            a = laya.utils.ColorUtils, l = laya.components.Component, o = laya.utils.Ease,
            u = (laya.events.Event, laya.filters.GlowFilter), c = laya.utils.Handler,
            f = (laya.display.Node, laya.display.Sprite, laya.utils.Tween), _ = laya.utils.Utils, p = function () {
                function t() {
                    this._filter = null, this._target = null
                }

                n(t, "laya.effect.FilterSetterBase");
                var e = t.prototype;
                return e.paramChanged = function () {
                    i.systemTimer.callLater(this, this.buildFilter)
                }, e.buildFilter = function () {
                    this._target && this.addFilter(this._target)
                }, e.addFilter = function (t) {
                    var e;
                    t && (t.filters ? (e = t.filters).indexOf(this._filter) < 0 && (e.push(this._filter), t.filters = _.copyArray([], e)) : t.filters = [this._filter])
                }, e.removeFilter = function (t) {
                    t && (t.filters = null)
                }, s(0, e, "target", null, function (t) {
                    this._target != t && (this._target = t, this.paramChanged())
                }), t
            }(), d = (function () {
                function t() {
                    this._tar = null, this._curState = 0, this._curTween = null, this.effectScale = 1.5, this.tweenTime = 300, this.effectEase = null, this.backEase = null
                }

                n(t, "laya.effect.ButtonEffect");
                var e = t.prototype;
                e.toChangedState = function () {
                    this._curState = 1, this._curTween && f.clear(this._curTween), this._curTween = f.to(this._tar, {
                        scaleX: this.effectScale,
                        scaleY: this.effectScale
                    }, this.tweenTime, o[this.effectEase], c.create(this, this.tweenComplete))
                }, e.toInitState = function () {
                    2 != this._curState && (this._curTween && f.clear(this._curTween), this._curState = 2, this._curTween = f.to(this._tar, {
                        scaleX: 1,
                        scaleY: 1
                    }, this.tweenTime, o[this.backEase], c.create(this, this.tweenComplete)))
                }, e.tweenComplete = function () {
                    this._curState = 0, this._curTween = null
                }, s(0, e, "target", null, function (t) {
                    (this._tar = t).on("mousedown", this, this.toChangedState), t.on("mouseup", this, this.toInitState), t.on("mouseout", this, this.toInitState)
                })
            }(), function (t) {
                function e() {
                    this.duration = 1e3, this.delay = 0, this.repeat = 0, this.ease = null, this.eventName = null, this.target = null, this.autoDestroyAtComplete = !0, this._comlete = null, this._tween = null, e.__super.call(this)
                }

                n(e, "laya.effect.EffectBase", l);
                var i = e.prototype;
                return i._onAwake = function () {
                    this.target = this.target || this.owner, this.autoDestroyAtComplete && (this._comlete = c.create(this.target, this.target.destroy, null, !1)), this.eventName ? this.owner.on(this.eventName, this, this._exeTween) : this._exeTween()
                }, i._exeTween = function () {
                    this._tween = this._doTween(), this._tween.repeat = this.repeat
                }, i._doTween = function () {
                    return null
                }, i.onReset = function () {
                    this.duration = 1e3, this.delay = 0, this.repeat = 0, this.ease = null, this.target = null, this.eventName && (this.owner.off(this.eventName, this, this._exeTween), this.eventName = null), this._comlete && (this._comlete.recover(), this._comlete = null), this._tween && (this._tween.clear(), this._tween = null)
                }, e
            }());
        (function (t) {
            function e() {
                this._brightness = 0, this._contrast = 0, this._saturation = 0, this._hue = 0, this._red = 0, this._green = 0, this._blue = 0, this._alpha = 0, this._color = null, e.__super.call(this), this._filter = new h
            }

            n(e, "laya.effect.ColorFilterSetter", t);
            var i = e.prototype;
            i.buildFilter = function () {
                this._filter.reset(), this._filter.color(this.red, this.green, this.blue, this.alpha), this._filter.adjustHue(this.hue), this._filter.adjustContrast(this.contrast), this._filter.adjustBrightness(this.brightness), this._filter.adjustSaturation(this.saturation), t.prototype.buildFilter.call(this)
            }, s(0, i, "brightness", function () {
                return this._brightness
            }, function (t) {
                this._brightness = t, this.paramChanged()
            }), s(0, i, "alpha", function () {
                return this._alpha
            }, function (t) {
                this._alpha = t, this.paramChanged()
            }), s(0, i, "contrast", function () {
                return this._contrast
            }, function (t) {
                this._contrast = t, this.paramChanged()
            }), s(0, i, "hue", function () {
                return this._hue
            }, function (t) {
                this._hue = t, this.paramChanged()
            }), s(0, i, "saturation", function () {
                return this._saturation
            }, function (t) {
                this._saturation = t, this.paramChanged()
            }), s(0, i, "green", function () {
                return this._green
            }, function (t) {
                this._green = t, this.paramChanged()
            }), s(0, i, "red", function () {
                return this._red
            }, function (t) {
                this._red = t, this.paramChanged()
            }), s(0, i, "blue", function () {
                return this._blue
            }, function (t) {
                this._blue = t, this.paramChanged()
            }), s(0, i, "color", function () {
                return this._color
            }, function (t) {
                var e;
                this._color = t, e = a.create(t), this._red = 255 * e.arrColor[0], this._green = 255 * e.arrColor[1], this._blue = 255 * e.arrColor[2], this.paramChanged()
            })
        })(p), function (t) {
            function e() {
                this._color = "#ff0000", this._blur = 4, this._offX = 6, this._offY = 6, e.__super.call(this), this._filter = new u(this._color)
            }

            n(e, "laya.effect.GlowFilterSetter", t);
            var i = e.prototype;
            i.buildFilter = function () {
                this._filter = new u(this.color, this.blur, this.offX, this.offY), t.prototype.buildFilter.call(this)
            }, s(0, i, "blur", function () {
                return this._blur
            }, function (t) {
                this._blur = t, this.paramChanged()
            }), s(0, i, "color", function () {
                return this._color
            }, function (t) {
                this._color = t, this.paramChanged()
            }), s(0, i, "offX", function () {
                return this._offX
            }, function (t) {
                this._offX = t, this.paramChanged()
            }), s(0, i, "offY", function () {
                return this._offY
            }, function (t) {
                this._offY = t, this.paramChanged()
            })
        }(p), function (t) {
            function e() {
                this._strength = 4, e.__super.call(this), this._filter = new r(this.strength)
            }

            n(e, "laya.effect.BlurFilterSetter", t);
            var i = e.prototype;
            i.buildFilter = function () {
                this._filter = new r(this.strength), t.prototype.buildFilter.call(this)
            }, s(0, i, "strength", function () {
                return this._strength
            }, function (t) {
                this._strength = t
            })
        }(p), function (t) {
            function e() {
                e.__super.call(this)
            }

            n(e, "laya.effect.FadeOut", d), e.prototype._doTween = function () {
                return this.target.alpha = 1, f.to(this.target, {alpha: 0}, this.duration, o[this.ease], this._comlete, this.delay)
            }
        }(), function (t) {
            function e() {
                e.__super.call(this)
            }

            n(e, "laya.effect.FadeIn", d), e.prototype._doTween = function () {
                return this.target.alpha = 0, f.to(this.target, {alpha: 1}, this.duration, o[this.ease], this._comlete, this.delay)
            }
        }()
    }(window, document, Laya);
});
define("libs/laya.html.js", function (require, module, exports) {
    !function (t, e, n) {
        n.un, n.uns;
        var i = n.static, r = n.class, h = n.getset, s = (n.__newvec, laya.utils.Browser), l = laya.utils.ClassUtils,
            a = (laya.resource.Context, laya.events.Event, laya.display.Graphics, laya.utils.HTMLChar),
            o = laya.utils.Handler, u = laya.net.Loader, c = laya.utils.Pool, d = laya.maths.Rectangle,
            _ = laya.display.Sprite, f = laya.display.Text, p = laya.resource.Texture, y = laya.net.URL,
            g = laya.utils.Utils;
        n.interface("laya.html.utils.ILayout");
        var m = function () {
            function t() {
                this.rec = new d, this.reset()
            }

            r(t, "laya.html.dom.HTMLHitRect");
            var e = t.prototype;
            return e.reset = function () {
                return this.rec.reset(), this.href = null, this
            }, e.recover = function () {
                c.recover("HTMLHitRect", this.reset())
            }, t.create = function () {
                return c.getItemByClass("HTMLHitRect", t)
            }, t
        }(), A = function () {
            function t() {
                this.x = 0, this.y = 0, this.w = 0, this.h = 0, this.wordStartIndex = 0, this.minTextHeight = 99999, this.mWidth = 0, this.elements = new Array
            }

            return r(t, "laya.html.utils.LayoutLine"), t.prototype.updatePos = function (t, e, i, n, s, r, h) {
                var l, a = 0;
                0 < this.elements.length && (a = (l = this.elements[this.elements.length - 1]).x + l.width - this.elements[0].x), h = h || this.h;
                var o = 0, u = NaN;
                "center" === s && (o = (e - a) / 2), "right" === s && (o = e - a);
                for (var c = 0, d = this.elements.length; c < d; c++) {
                    var _ = (l = this.elements[c])._getCSSStyle();
                    switch (0 !== o && (l.x += o), _.valign) {
                        case"top":
                            l.y = n;
                            break;
                        case"middle":
                            var f = 0;
                            99999 != this.minTextHeight && (f = this.minTextHeight);
                            var p = (f + h) / 2;
                            p = Math.max(p, this.h), u = (laya.html.dom.HTMLImageElement, n + p - l.height), l.y = u;
                            break;
                        case"bottom":
                            l.y = n + (h - l.height)
                    }
                }
            }, t
        }(), x = function () {
            function t() {
                this.all = new Array, this.styleSheets = S.styleSheets
            }

            r(t, "laya.html.dom.HTMLDocument");
            var e = t.prototype;
            return e.getElementById = function (t) {
                return this.all[t]
            }, e.setElementById = function (t, e) {
                this.all[t] = e
            }, i(t, ["document", function () {
                return this.document = new t
            }]), t
        }(), L = function () {
            function N() {
            }

            return r(N, "laya.html.utils.Layout"), N.later = function (t) {
                null == N._will && (N._will = [], n.stage.frameLoop(1, null, function () {
                    if (!(N._will.length < 1)) {
                        for (var t = 0; t < N._will.length; t++) laya.html.utils.Layout.layout(N._will[t]);
                        N._will.length = 0
                    }
                })), N._will.push(t)
            }, N.layout = function (t) {
                return t && t._style ? 0 == (512 & t._style._type) ? null : (t.style._type &= -513, N._multiLineLayout(t)) : null
            }, N._multiLineLayout = function (t) {
                var e = new Array;
                t._addChildsToLayout(e);
                var i, n, s, r, h, l = 0, a = e.length, o = t._getCSSStyle(), u = o.letterSpacing, c = o.leading,
                    d = o.lineHeight, _ = o._widthAuto() || !o.wordWrap, f = _ ? 999999 : t.width, p = (t.height, 0),
                    y = o.italic ? o.fontSize / 3 : 0, g = o.align, m = o.valign,
                    x = "top" !== m || "left" !== g || 0 != d, L = 0, S = 0, v = 0, w = 0, T = new Array,
                    E = T[0] = new A, H = !1, C = !1;
                E.h = 0, o.italic && (f -= o.fontSize / 3);
                var I = 0, b = !0;

                function M() {
                    E.y = S, S += E.h + c, E.mWidth = I, I = 0, E = new A, T.push(E), E.h = 0, H = !(b = !(L = 0))
                }

                for (l = 0; l < a; l++) if (null != (i = e[l])) if (b = !1, i instanceof laya.html.dom.HTMLBrElement) M(), E.y = S, E.h = d; else {
                    if (i._isChar()) {
                        if ((r = i).isWord) H = C || "\n" === r.char, E.wordStartIndex = E.elements.length; else {
                            if (0 < T.length && f < L + v && 0 < E.wordStartIndex) {
                                var R;
                                R = E.elements.length - E.wordStartIndex + 1, E.elements.length = E.wordStartIndex, l -= R, M();
                                continue
                            }
                            H = !1, I += r.width
                        }
                        v = r.width + r.style.letterSpacing, w = r.height, C = !1, (H = H || f < L + v) && M(), E.minTextHeight = Math.min(E.minTextHeight, i.height)
                    } else n = i._getCSSStyle(), h = i, s = n.padding, H = C || n.getLineElement(), v = h.width + s[1] + s[3] + n.letterSpacing, w = h.height + s[0] + s[2], C = n.getLineElement(), (H = H || f < L + v && n.wordWrap) && M();
                    E.elements.push(i), E.h = Math.max(E.h, w), i.x = L, i.y = S, L += v, E.w = L - u, E.y = S, p = Math.max(L + y, p)
                } else b || (L += N.DIV_ELEMENT_PADDING), E.wordStartIndex = E.elements.length;
                if (S = E.y + E.h, x) {
                    var k = 0, D = f;
                    for (_ && 0 < t.width && (D = t.width), l = 0, a = T.length; l < a; l++) T[l].updatePos(0, D, l, k, g, m, d), k += Math.max(d, T[l].h + c);
                    S = k
                }
                return _ && (t.width = p), S > t.height && (t.height = S), [p, S]
            }, N.DIV_ELEMENT_PADDING = 0, N._will = null, N
        }(), S = (function () {
            function t() {
            }

            r(t, "laya.html.dom.HTMLBrElement");
            var e = t.prototype;
            e._addToLayout = function (t) {
                t.push(this)
            }, e.reset = function () {
                return this
            }, e.destroy = function () {
                c.recover(w.getClassName(this), this.reset())
            }, e._setParent = function (t) {
            }, e._getCSSStyle = function () {
                return t.brStyle || ((t.brStyle = new S).setLineElement(!0), t.brStyle.block = !0), t.brStyle
            }, e.renderSelfToGraphic = function (t, e, i, n) {
            }, h(0, e, "URI", null, function (t) {
            }), h(0, e, "parent", null, function (t) {
            }), h(0, e, "href", null, function (t) {
            }), t.brStyle = null
        }(), function () {
            function d() {
                this.padding = d._PADDING, this.reset()
            }

            r(d, "laya.html.utils.HTMLStyle");
            var t = d.prototype;
            return t._getExtendStyle = function () {
                return this._extendStyle === v.EMPTY && (this._extendStyle = v.create()), this._extendStyle
            }, t.reset = function () {
                return this.ower = null, this._type = 0, this.wordWrap = !0, this.fontSize = f.defaultFontSize, this.family = f.defaultFont, this.color = "#000000", this.valign = "top", this.padding = d._PADDING, this.bold = !1, this.italic = !1, this.align = "left", this.textDecoration = null, this.bgColor = null, this.borderColor = null, this._extendStyle && this._extendStyle.recover(), this._extendStyle = v.EMPTY, this
            }, t.recover = function () {
                c.recover("HTMLStyle", this.reset())
            }, t.inherit = function (t) {
                var e, i, n, s = 0;
                for (e = (i = d._inheritProps).length, s = 0; s < e; s++) this[n = i[s]] = t[n]
            }, t._widthAuto = function () {
                return 0 != (262144 & this._type)
            }, t.widthed = function (t) {
                return 0 != (8 & this._type)
            }, t._calculation = function (t, e) {
                return !1
            }, t.heighted = function (t) {
                return 0 != (8192 & this._type)
            }, t.size = function (t, e) {
                var i = this.ower, n = !1;
                -1 !== t && t != i.width && (this._type |= 8, i.width = t, n = !0), -1 !== e && e != i.height && (this._type |= 8192, i.height = e, n = !0), n && i._layoutLater()
            }, t.getLineElement = function () {
                return 0 != (65536 & this._type)
            }, t.setLineElement = function (t) {
                t ? this._type |= 65536 : this._type &= -65537
            }, t._enableLayout = function () {
                return 0 == (2 & this._type) && 0 == (4 & this._type)
            }, t.cssText = function (t) {
                this.attrs(d.parseOneCSS(t, ";"))
            }, t.attrs = function (t) {
                if (t) for (var e = 0, i = t.length; e < i; e++) {
                    var n = t[e];
                    this[n[0]] = n[1]
                }
            }, h(0, t, "font", function () {
                return (this.italic ? "italic " : "") + (this.bold ? "bold " : "") + this.fontSize + "px " + (s.onIPhone && f.fontFamilyMap[this.family] || this.family)
            }, function (t) {
                for (var e = t.split(" "), i = 0, n = e.length; i < n; i++) {
                    var s = e[i];
                    switch (s) {
                        case"italic":
                            this.italic = !0;
                            continue;
                        case"bold":
                            this.bold = !0;
                            continue
                    }
                    0 < s.indexOf("px") && (this.fontSize = parseInt(s), this.family = e[i + 1], i++)
                }
            }), h(0, t, "href", function () {
                return this._extendStyle.href
            }, function (t) {
                t !== this._extendStyle.href && (this._getExtendStyle().href = t)
            }), h(0, t, "lineHeight", function () {
                return this._extendStyle.lineHeight
            }, function (t) {
                this._extendStyle.lineHeight !== t && (this._getExtendStyle().lineHeight = t)
            }), h(0, t, "strokeColor", function () {
                return this._extendStyle.strokeColor
            }, function (t) {
                this._extendStyle.strokeColor !== t && (this._getExtendStyle().strokeColor = t)
            }), h(0, t, "stroke", function () {
                return this._extendStyle.stroke
            }, function (t) {
                this._extendStyle.stroke !== t && (this._getExtendStyle().stroke = t)
            }), h(0, t, "leading", function () {
                return this._extendStyle.leading
            }, function (t) {
                this._extendStyle.leading !== t && (this._getExtendStyle().leading = t)
            }), h(0, t, "align", function () {
                var t = 48 & this._type;
                return d.align_Value[t]
            }, function (t) {
                t in d.alignVDic && (this._type &= -49, this._type |= d.alignVDic[t])
            }), h(0, t, "valign", function () {
                var t = 192 & this._type;
                return d.vAlign_Value[t]
            }, function (t) {
                t in d.alignVDic && (this._type &= -193, this._type |= d.alignVDic[t])
            }), h(0, t, "block", function () {
                return 0 != (1 & this._type)
            }, function (t) {
                t ? this._type |= 1 : this._type &= -2
            }), h(0, t, "wordWrap", function () {
                return 0 == (131072 & this._type)
            }, function (t) {
                t ? this._type &= -131073 : this._type |= 131072
            }), h(0, t, "bold", function () {
                return 0 != (1024 & this._type)
            }, function (t) {
                t ? this._type |= 1024 : this._type &= -1025
            }), h(0, t, "italic", function () {
                return 0 != (2048 & this._type)
            }, function (t) {
                t ? this._type |= 2048 : this._type &= -2049
            }), h(0, t, "whiteSpace", function () {
                return 131072 & this._type ? "nowrap" : ""
            }, function (t) {
                "nowrap" === t && (this._type |= 131072), "none" === t && (this._type &= -131073)
            }), h(0, t, "width", null, function (t) {
                if (this._type |= 8, "string" == typeof t) {
                    var e = t.indexOf("auto");
                    if (0 <= e && (this._type |= 262144, t = t.substr(0, e)), this._calculation("width", t)) return;
                    t = parseInt(t)
                }
                this.size(t, -1)
            }), h(0, t, "height", null, function (t) {
                if (this._type |= 8192, "string" == typeof t) {
                    if (this._calculation("height", t)) return;
                    t = parseInt(t)
                }
                this.size(-1, t)
            }), h(0, t, "letterSpacing", function () {
                return this._extendStyle.letterSpacing
            }, function (t) {
                "string" == typeof t && (t = parseInt(t + "")), t != this._extendStyle.letterSpacing && (this._getExtendStyle().letterSpacing = t)
            }), h(0, t, "position", function () {
                return 4 & this._type ? "absolute" : ""
            }, function (t) {
                "absolute" === t ? this._type |= 4 : this._type &= -5
            }), h(0, t, "absolute", function () {
                return 0 != (4 & this._type)
            }), h(0, t, "paddingLeft", function () {
                return this.padding[3]
            }), h(0, t, "paddingTop", function () {
                return this.padding[0]
            }), d.create = function () {
                return c.getItemByClass("HTMLStyle", d)
            }, d.parseOneCSS = function (t, e) {
                for (var i, n = [], s = t.split(e), r = 0, h = s.length; r < h; r++) {
                    var l = s[r], a = l.indexOf(":"), o = l.substr(0, a).replace(/^\s+|\s+$/g, "");
                    if (0 !== o.length) {
                        var u = l.substr(a + 1).replace(/^\s+|\s+$/g, ""), c = [o, u];
                        switch (o) {
                            case"italic":
                            case"bold":
                                c[1] = "true" == u;
                                break;
                            case"font-weight":
                                "bold" == u && (c[1] = !0, c[0] = "bold");
                                break;
                            case"line-height":
                                c[0] = "lineHeight", c[1] = parseInt(u);
                                break;
                            case"font-size":
                                c[0] = "fontSize", c[1] = parseInt(u);
                                break;
                            case"stroke":
                                c[0] = "stroke", c[1] = parseInt(u);
                                break;
                            case"padding":
                                1 < (i = u.split(" ")).length || (i[1] = i[2] = i[3] = i[0]), c[1] = [parseInt(i[0]), parseInt(i[1]), parseInt(i[2]), parseInt(i[3])];
                                break;
                            default:
                                (c[0] = d._CSSTOVALUE[o]) || (c[0] = o)
                        }
                        n.push(c)
                    }
                }
                return n
            }, d.parseCSS = function (t, e) {
                for (var i; null != (i = d._parseCSSRegExp.exec(t));) d.styleSheets[i[1]] = d.parseOneCSS(i[2], ";")
            }, d._CSSTOVALUE = {
                "letter-spacing": "letterSpacing",
                "white-space": "whiteSpace",
                "line-height": "lineHeight",
                "font-family": "family",
                "vertical-align": "valign",
                "text-decoration": "textDecoration",
                "background-color": "bgColor",
                "border-color": "borderColor"
            }, d._parseCSSRegExp = new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}", "g"), d.ALIGN_LEFT = "left", d.ALIGN_CENTER = "center", d.ALIGN_RIGHT = "right", d.VALIGN_TOP = "top", d.VALIGN_MIDDLE = "middle", d.VALIGN_BOTTOM = "bottom", d.styleSheets = {}, d.ADDLAYOUTED = 512, d._PADDING = [0, 0, 0, 0], d._HEIGHT_SET = 8192, d._LINE_ELEMENT = 65536, d._NOWARP = 131072, d._WIDTHAUTO = 262144, d._BOLD = 1024, d._ITALIC = 2048, d._CSS_BLOCK = 1, d._DISPLAY_NONE = 2, d._ABSOLUTE = 4, d._WIDTH_SET = 8, d._ALIGN = 48, d._VALIGN = 192, i(d, ["_inheritProps", function () {
                return this._inheritProps = ["italic", "align", "valign", "leading", "stroke", "strokeColor", "bold", "fontSize", "lineHeight", "wordWrap", "color"]
            }, "alignVDic", function () {
                return this.alignVDic = {left: 0, center: 16, right: 32, top: 0, middle: 64, bottom: 128}
            }, "align_Value", function () {
                return this.align_Value = {0: "left", 16: "center", 32: "right"}
            }, "vAlign_Value", function () {
                return this.vAlign_Value = {0: "top", 64: "middle", 128: "bottom"}
            }]), d
        }()), v = function () {
            function t() {
                this.reset()
            }

            r(t, "laya.html.utils.HTMLExtendStyle");
            var e = t.prototype;
            return e.reset = function () {
                return this.stroke = 0, this.strokeColor = "#000000", this.leading = 0, this.lineHeight = 0, this.letterSpacing = 0, this.href = null, this
            }, e.recover = function () {
                this != t.EMPTY && c.recover("HTMLExtendStyle", this.reset())
            }, t.create = function () {
                return c.getItemByClass("HTMLExtendStyle", t)
            }, t.EMPTY = new t, t
        }(), w = function () {
            function s() {
                this._creates(), this.reset()
            }

            r(s, "laya.html.dom.HTMLElement");
            var t = s.prototype;
            return t._creates = function () {
                this._style = S.create()
            }, t.reset = function () {
                if (this.URI = null, this.parent = null, this._style.reset(), (this._style.ower = this)._style.valign = "middle", this._text && this._text.words) {
                    var t, e, i = this._text.words, n = 0;
                    for (t = i.length, n = 0; n < t; n++) (e = i[n]) && e.recover()
                }
                return this._text = s._EMPTYTEXT, this._children && (this._children.length = 0), this._x = this._y = this._width = this._height = 0, this
            }, t._getCSSStyle = function () {
                return this._style
            }, t._addChildsToLayout = function (s) {
                var t = this._getWords();
                if (null == t && (!this._children || 0 == this._children.length)) return !1;
                if (t) for (var e = 0, i = t.length; e < i; e++) s.push(t[e]);
                return this._children && this._children.forEach(function (t, e, i) {
                    var n = t._style;
                    n._enableLayout && n._enableLayout() && t._addToLayout(s)
                }), !0
            }, t._addToLayout = function (t) {
                if (this._style) {
                    var e = this._style;
                    e.absolute || (e.block ? t.push(this) : this._addChildsToLayout(t) && (this.x = this.y = 0))
                }
            }, t.repaint = function (t) {
                void 0 === t && (t = !1), this.parentRepaint(t)
            }, t.parentRepaint = function (t) {
                void 0 === t && (t = !1), this.parent && this.parent.repaint(t)
            }, t._setParent = function (t) {
                if (t instanceof laya.html.dom.HTMLElement) {
                    var e = t;
                    this.URI || (this.URI = e.URI), this.style && this.style.inherit(e.style)
                }
            }, t.appendChild = function (t) {
                return this.addChild(t)
            }, t.addChild = function (t) {
                return t.parent && t.parent.removeChild(t), this._children || (this._children = []), this._children.push(t), t.parent = this, t._setParent(this), this.repaint(), t
            }, t.removeChild = function (t) {
                if (!this._children) return null;
                var e, i = 0;
                for (e = this._children.length, i = 0; i < e; i++) if (this._children[i] == t) return this._children.splice(i, 1), t;
                return null
            }, t.destroy = function () {
                this._children && (this.destroyChildren(), this._children.length = 0), c.recover(s.getClassName(this), this.reset())
            }, t.destroyChildren = function () {
                if (this._children) {
                    for (var t = this._children.length - 1; -1 < t; t--) this._children[t].destroy();
                    this._children.length = 0
                }
            }, t._getWords = function () {
                if (!this._text) return null;
                var t = this._text.text;
                if (!t || 0 === t.length) return null;
                var e, i = this._text.words;
                if (i && i.length === t.length) return i;
                null === i && (this._text.words = i = []), i.length = t.length;
                for (var n = this.style, s = n.font, r = 0, h = t.length; r < h; r++) e = g.measureText(t.charAt(r), s), i[r] = a.create().setData(t.charAt(r), e.width, e.height || n.fontSize, n);
                return i
            }, t._isChar = function () {
                return !1
            }, t._layoutLater = function () {
                var t = this.style;
                512 & t._type || (t.widthed(this) && (this._children && 0 < this._children.length || null != this._getWords()) && t.block ? (L.later(this), t._type |= 512) : this.parent && this.parent._layoutLater())
            }, t._setAttributes = function (t, e) {
                switch (t) {
                    case"style":
                        this.style.cssText(e);
                        break;
                    case"class":
                        this.className = e;
                        break;
                    case"x":
                        this.x = parseFloat(e);
                        break;
                    case"y":
                        this.y = parseFloat(e);
                        break;
                    case"width":
                        this.width = parseFloat(e);
                        break;
                    case"height":
                        this.height = parseFloat(e);
                        break;
                    default:
                        this[t] = e
                }
            }, t.formatURL = function (t) {
                return this.URI ? s.formatURL1(t, this.URI ? this.URI.path : null) : t
            }, t.drawToGraphic = function (t, e, i, n) {
                e += this.x, i += this.y;
                var s = this.style;
                s.paddingLeft && (e += s.paddingLeft), s.paddingTop && (i += s.paddingTop), (null != s.bgColor || s.borderColor) && t.drawRect(e, i, this.width, this.height, s.bgColor, s.borderColor, 1), this.renderSelfToGraphic(t, e, i, n);
                var r, h = 0, l = 0;
                if (this._children && 0 < this._children.length) for (l = this._children.length, h = 0; h < l; h++) null != (r = this._children[h]).drawToGraphic && r.drawToGraphic(t, e, i, n)
            }, t.renderSelfToGraphic = function (t, e, i, n) {
                var s = this.style, r = this._getWords();
                if (r && (r.length, s)) {
                    var h = s.font, l = s.color;
                    if (s.stroke) {
                        var a = s.stroke;
                        a = parseInt(a);
                        var o = s.strokeColor;
                        t.fillBorderWords(r, e, i, h, l, o, a)
                    } else t.fillWords(r, e, i, h, l);
                    if (this.href) {
                        var u = r[r.length - 1], c = u.y + u.height;
                        if (u.y == r[0].y) {
                            "none" != s.textDecoration && t.drawLine(r[0].x, c, u.x + u.width, c, l, 1);
                            var d = m.create();
                            d.rec.setTo(r[0].x, u.y, u.x + u.width - r[0].x, u.height), d.href = this.href, n.push(d)
                        } else this.workLines(r, t, n)
                    }
                }
            }, t.workLines = function (t, e, i) {
                var n;
                n = "none" != this.style.textDecoration;
                var s, r, h, l = 0;
                if (s = t.length, h = r = t[l]) {
                    var a;
                    for (l = 1; l < s; l++) h = (a = t[l]).y != r.y ? (this.createOneLine(r, h, n, e, i), r = a) : a;
                    this.createOneLine(r, h, n, e, i)
                }
            }, t.createOneLine = function (t, e, i, n, s) {
                var r = e.y + e.height;
                i && n.drawLine(t.x, r, e.x + e.width, r, this.color, 1);
                var h = m.create();
                h.rec.setTo(t.x, e.y, e.x + e.width - t.x, e.height), h.href = this.href, s.push(h)
            }, h(0, t, "href", function () {
                return this._style ? this._style.href : null
            }, function (t) {
                this._style && t != this._style.href && (this._style.href = t, this.repaint())
            }), h(0, t, "color", null, function (t) {
                this.style.color = t
            }), h(0, t, "id", null, function (t) {
                x.document.setElementById(t, this)
            }), h(0, t, "innerTEXT", function () {
                return this._text.text
            }, function (t) {
                this._text === s._EMPTYTEXT ? this._text = {
                    text: t,
                    words: null
                } : (this._text.text = t, this._text.words && (this._text.words.length = 0)), this.repaint()
            }), h(0, t, "style", function () {
                return this._style
            }), h(0, t, "width", function () {
                return this._width
            }, function (t) {
                this._width !== t && (this._width = t, this.repaint())
            }), h(0, t, "x", function () {
                return this._x
            }, function (t) {
                this._x != t && (this._x = t, this.parentRepaint())
            }), h(0, t, "y", function () {
                return this._y
            }, function (t) {
                this._y != t && (this._y = t, this.parentRepaint())
            }), h(0, t, "height", function () {
                return this._height
            }, function (t) {
                this._height !== t && (this._height = t, this.repaint())
            }), h(0, t, "className", null, function (t) {
                this.style.attrs(x.document.styleSheets["." + t])
            }), s.formatURL1 = function (t, e) {
                if (!t) return "null path";
                if (e || (e = y.basePath), 0 < t.indexOf(":")) return t;
                if (null != y.customFormat && (t = y.customFormat(t)), 0 < t.indexOf(":")) return t;
                var i = t.charAt(0);
                if ("." === i) return y._formatRelativePath(e + t);
                if ("~" === i) return y.rootPath + t.substring(1);
                if ("d" === i) {
                    if (0 === t.indexOf("data:image")) return t
                } else if ("/" === i) return t;
                return e + t
            }, s.getClassName = function (t) {
                return "function" == typeof t ? t.name : t.constructor.name
            }, s._EMPTYTEXT = {text: null, words: null}, s
        }(), T = function () {
            function _() {
            }

            return r(_, "laya.html.utils.HTMLParse"), _.getInstance = function (t) {
                var e = c.getItem(_._htmlClassMapShort[t]);
                return e || (e = l.getInstance(t)), e
            }, _.parse = function (t, e, i) {
                e = (e = "<root>" + (e = e.replace(/<br>/g, "<br/>")) + "</root>").replace(_.spacePattern, _.char255);
                var n = g.parseXMLFromString(e);
                _._parseXML(t, n.childNodes[0].childNodes, i)
            }, _._parseXML = function (t, e, i, n) {
                var s = 0, r = 0;
                if (e.join || e.item) for (s = 0, r = e.length; s < r; ++s) _._parseXML(t, e[s], i, n); else {
                    var h, l, a;
                    if (3 == e.nodeType) return void (t instanceof laya.html.dom.HTMLDivParser ? (null == e.nodeName && (e.nodeName = "#text"), l = e.nodeName.toLowerCase(), 0 < (a = e.textContent.replace(/^\s+|\s+$/g, "")).length && (h = _.getInstance(l)) && (t.addChild(h), h.innerTEXT = a.replace(_.char255AndOneSpacePattern, " "))) : 0 < (a = e.textContent.replace(/^\s+|\s+$/g, "")).length && (t.innerTEXT = a.replace(_.char255AndOneSpacePattern, " ")));
                    if ("#comment" == (l = e.nodeName.toLowerCase())) return;
                    if (h = _.getInstance(l)) {
                        "p" == l ? (t.addChild(_.getInstance("br")), h = t.addChild(h), t.addChild(_.getInstance("br"))) : h = t.addChild(h), h.URI = i, h.href = n;
                        var o = e.attributes;
                        if (o && 0 < o.length) for (s = 0, r = o.length; s < r; ++s) {
                            var u = o[s], c = u.nodeName, d = u.value;
                            h._setAttributes(c, d)
                        }
                        _._parseXML(h, e.childNodes, i, h.href)
                    } else _._parseXML(t, e.childNodes, i, n)
                }
            }, _.char255 = String.fromCharCode(255), _.spacePattern = /&nbsp;|&#160;/g, _.char255AndOneSpacePattern = new RegExp(String.fromCharCode(255) + "|(\\s+)", "g"), _._htmlClassMapShort = {
                div: "HTMLDivParser",
                p: "HTMLElement",
                img: "HTMLImageElement",
                span: "HTMLElement",
                br: "HTMLBrElement",
                style: "HTMLStyleElement",
                font: "HTMLElement",
                a: "HTMLElement",
                "#text": "HTMLElement",
                link: "HTMLLinkElement"
            }, _
        }(), E = (function (t) {
            function e() {
                e.__super.call(this)
            }

            r(e, "laya.html.dom.HTMLImageElement", t);
            var i = e.prototype;
            i.reset = function () {
                return t.prototype.reset.call(this), this._tex && this._tex.off("loaded", this, this.onloaded), this._tex = null, this._url = null, this
            }, i.onloaded = function () {
                if (this._style) {
                    var t = this._style;
                    t.widthed(this) || this._tex.width, t.heighted(this) || this._tex.height;
                    t.widthed(this) || this._width == this._tex.width || (this.width = this._tex.width, this.parent && this.parent._layoutLater()), t.heighted(this) || this._height == this._tex.height || (this.height = this._tex.height, this.parent && this.parent._layoutLater()), this.repaint()
                }
            }, i._addToLayout = function (t) {
                !this._style.absolute && t.push(this)
            }, i.renderSelfToGraphic = function (t, e, i, n) {
                this._tex && t.drawImage(this._tex, e, i, this.width || this._tex.width, this.height || this._tex.height)
            }, h(0, i, "src", null, function (t) {
                if (t = this.formatURL(t), this._url !== t) {
                    this._url = t;
                    var e = this._tex = u.getRes(t);
                    e || (this._tex = e = new p, e.load(t), u.cacheRes(t, e)), e.getIsReady() ? this.onloaded() : e.once("ready", this, this.onloaded)
                }
            })
        }(w), function (e) {
            function t() {
                this.contextHeight = NaN, this.contextWidth = NaN, this._htmlBounds = null, this._boundsRec = null, this.repaintHandler = null, t.__super.call(this)
            }

            r(t, "laya.html.dom.HTMLDivParser", e);
            var i = t.prototype;
            return i.reset = function () {
                return e.prototype.reset.call(this), this._style.block = !0, this._style.setLineElement(!0), this._style.width = 200, this._style.height = 200, this.repaintHandler = null, this.contextHeight = 0, this.contextWidth = 0, this
            }, i.appendHTML = function (t) {
                T.parse(this, t, this.URI), this.layout()
            }, i._addChildsToLayout = function (e) {
                var t = this._getWords();
                if (null == t && (!this._children || 0 == this._children.length)) return !1;
                t && t.forEach(function (t) {
                    e.push(t)
                });
                for (var i = !0, n = 0, s = this._children.length; n < s; n++) {
                    var r = this._children[n];
                    i ? i = !1 : e.push(null), r._addToLayout(e)
                }
                return !0
            }, i._addToLayout = function (t) {
                this.layout(), !this.style.absolute && t.push(this)
            }, i.getBounds = function () {
                return this._htmlBounds ? (this._boundsRec || (this._boundsRec = d.create()), this._boundsRec.copyFrom(this._htmlBounds)) : null
            }, i.parentRepaint = function (t) {
                void 0 === t && (t = !1), e.prototype.parentRepaint.call(this), this.repaintHandler && this.repaintHandler.runWith(t)
            }, i.layout = function () {
                this.style._type |= 512;
                var t = L.layout(this);
                if (t) {
                    this._htmlBounds || (this._htmlBounds = d.create());
                    var e = this._htmlBounds;
                    e.x = e.y = 0, e.width = this.contextWidth = t[0], e.height = this.contextHeight = t[1]
                }
            }, h(0, i, "height", function () {
                return this._height ? this._height : this.contextHeight
            }, e.prototype._$set_height), h(0, i, "innerHTML", null, function (t) {
                this.destroyChildren(), this.appendHTML(t)
            }), h(0, i, "width", function () {
                return this._width ? this._width : this.contextWidth
            }, function (t) {
                var e = !1;
                e = 0 === t ? t != this._width : t != this.width, n.superSet(w, this, "width", t), e && this.layout()
            }), t
        }(w)), H = (function (t) {
            function e() {
                e.__super.call(this)
            }

            r(e, "laya.html.dom.HTMLLinkElement", t);
            var i = e.prototype;
            i._creates = function () {
            }, i.drawToGraphic = function (t, e, i, n) {
            }, i.reset = function () {
                return this._loader && this._loader.off("complete", this, this._onload), this._loader = null, this
            }, i._onload = function (t) {
                switch (this._loader && (this._loader = null), this.type) {
                    case"text/css":
                        S.parseCSS(t, this.URI)
                }
                this.repaint(!0)
            }, h(0, i, "href", t.prototype._$get_href, function (t) {
                t && (t = this.formatURL(t), this.URI = new y(t), this._loader && this._loader.off("complete", this, this._onload), u.getRes(t) ? "text/css" == this.type && S.parseCSS(u.getRes(t), this.URI) : (this._loader = new u, this._loader.once("complete", this, this._onload), this._loader.load(t, "text")))
            }), e._cuttingStyle = new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{", "g")
        }(w), function (t) {
            function e() {
                e.__super.call(this)
            }

            r(e, "laya.html.dom.HTMLStyleElement", t);
            var i = e.prototype;
            i._creates = function () {
            }, i.drawToGraphic = function (t, e, i, n) {
            }, i.reset = function () {
                return this
            }, h(0, i, "innerTEXT", t.prototype._$get_innerTEXT, function (t) {
                S.parseCSS(t, null)
            })
        }(w), function (e) {
            function t() {
                this._element = null, this._recList = [], this._innerHTML = null, this._repaintState = 0, t.__super.call(this), this._element = new E, this._element.repaintHandler = new o(this, this._htmlDivRepaint), this.mouseEnabled = !0, this.on("click", this, this._onMouseClick)
            }

            r(t, "laya.html.dom.HTMLDivElement", e);
            var i = t.prototype;
            return i.destroy = function (t) {
                void 0 === t && (t = !0), this._element && this._element.reset(), this._element = null, this._doClears(), e.prototype.destroy.call(this, t)
            }, i._htmlDivRepaint = function (t) {
                void 0 === t && (t = !1), t ? this._repaintState < 2 && (this._repaintState = 2) : this._repaintState < 1 && (this._repaintState = 1), 0 < this._repaintState && this._setGraphicDirty()
            }, i._updateGraphicWork = function () {
                switch (this._repaintState) {
                    case 1:
                        this._updateGraphic();
                        break;
                    case 2:
                        this._refresh()
                }
            }, i._setGraphicDirty = function () {
                this.callLater(this._updateGraphicWork)
            }, i._doClears = function () {
                if (this._recList) {
                    var t = 0, e = this._recList.length;
                    for (t = 0; t < e; t++) this._recList[t].recover();
                    this._recList.length = 0
                }
            }, i._updateGraphic = function () {
                this._doClears(), this.graphics.clear(!0), this._repaintState = 0, this._element.drawToGraphic(this.graphics, -this._element.x, -this._element.y, this._recList);
                var t = this._element.getBounds();
                t && this.setSelfBounds(t), this.size(t.width, t.height)
            }, i._refresh = function () {
                this._repaintState = 1, this._innerHTML && (this._element.innerHTML = this._innerHTML), this._setGraphicDirty()
            }, i._onMouseClick = function () {
                var t, e, i = this.mouseX, n = this.mouseY, s = 0;
                for (t = this._recList.length, s = 0; s < t; s++) (e = this._recList[s]).rec.contains(i, n) && this._eventLink(e.href)
            }, i._eventLink = function (t) {
                this.event("link", [t])
            }, h(0, i, "style", function () {
                return this._element.style
            }), h(0, i, "innerHTML", null, function (t) {
                this._innerHTML != t && (this._repaintState = 1, this._innerHTML = t, this._element.innerHTML = t, this._setGraphicDirty())
            }), h(0, i, "contextWidth", function () {
                return this._element.contextWidth
            }), h(0, i, "contextHeight", function () {
                return this._element.contextHeight
            }), t
        }(_));
        !function (t) {
            function e() {
                e.__super.call(this), this._element._getCSSStyle().valign = "middle"
            }

            r(e, "laya.html.dom.HTMLIframeElement", H), h(0, e.prototype, "href", null, function (i) {
                var n = this;
                i = this._element.formatURL(i);
                var t = new u;
                t.once("complete", null, function (t) {
                    var e = n._element.URI;
                    n._element.URI = new y(i), n.innerHTML = t, !e || (n._element.URI = e)
                }), t.load(i, "text")
            })
        }()
    }(window, document, Laya);
});
define("libs/laya.ui.js", function (require, module, exports) {
    !function (s, r, _) {
        _.un, _.uns;
        var h = _.static, a = _.class, n = _.getset, o = (_.__newvec, laya.display.Animation), l = laya.utils.Browser,
            c = laya.utils.ClassUtils, e = laya.filters.ColorFilter, u = laya.components.Component,
            d = (laya.Const, laya.utils.Ease), f = laya.events.Event, t = laya.display.Graphics, g = laya.utils.Handler,
            p = laya.net.HttpRequest, m = laya.display.Input, v = laya.net.Loader, y = laya.net.LocalStorage,
            C = laya.maths.Matrix, b = (laya.display.Node, laya.maths.Point), S = laya.maths.Rectangle,
            i = (laya.renders.Render, laya.display.Scene), w = laya.utils.SceneUtils, x = laya.display.Sprite,
            B = (laya.display.Stage, laya.display.Text), k = laya.resource.Texture, I = laya.utils.TimeLine,
            L = laya.utils.Tween, M = laya.utils.Utils, z = laya.utils.WeakObject;
        _.interface("laya.ui.IBox"), _.interface("laya.ui.IItem"), _.interface("laya.ui.ISelect"), _.interface("laya.ui.IRender");
        var T = function () {
            function t() {
            }

            return a(t, "UIConfig"), t.touchScrollEnable = !0, t.mouseWheelEnable = !0, t.showButtons = !0, t.popupBgColor = "#000000", t.popupBgAlpha = .5, t.closeDialogOnSide = !0, t
        }(), D = function () {
            function t() {
            }

            return a(t, "laya.ui.Styles"), t.labelColor = "#000000", t.buttonStateNum = 3, t.scrollBarMinNum = 15, t.scrollBarDelayTime = 500, h(t, ["defaultSizeGrid", function () {
                return this.defaultSizeGrid = [4, 4, 4, 4, 0]
            }, "labelPadding", function () {
                return this.labelPadding = [2, 2, 2, 2]
            }, "inputLabelPadding", function () {
                return this.inputLabelPadding = [1, 1, 1, 3]
            }, "buttonLabelColors", function () {
                return this.buttonLabelColors = ["#32556b", "#32cc6b", "#ff0000", "#C0C0C0"]
            }, "comboBoxItemColors", function () {
                return this.comboBoxItemColors = ["#5e95b6", "#ffffff", "#000000", "#8fa4b1", "#ffffff"]
            }]), t
        }(), H = function () {
            function n() {
            }

            return a(n, "laya.ui.UIUtils"), n.fillArray = function (t, i, e) {
                var s = t.concat();
                if (i) for (var n = i.split(","), h = 0, o = Math.min(s.length, n.length); h < o; h++) {
                    var r = n[h];
                    s[h] = "true" == r || "false" != r && r, null != e && (s[h] = e(r))
                }
                return s
            }, n.toColor = function (t) {
                return M.toHexColor(t)
            }, n.gray = function (t, i) {
                void 0 === i && (i = !0), i ? n.addFilter(t, n.grayFilter) : n.clearFilter(t, e)
            }, n.addFilter = function (t, i) {
                var e = t.filters || [];
                e.push(i), t.filters = e
            }, n.clearFilter = function (t, i) {
                var e = t.filters;
                if (null != e && 0 < e.length) {
                    for (var s = e.length - 1; -1 < s; s--) {
                        var n = e[s];
                        _.__typeof(n, i) && e.splice(s, 1)
                    }
                    t.filters = e
                }
            }, n._getReplaceStr = function (t) {
                return n.escapeSequence[t]
            }, n.adptString = function (t) {
                return t.replace(/\\(\w)/g, n._getReplaceStr)
            }, n.getBindFun = function (t) {
                var i = n._funMap.get(t);
                if (null == i) {
                    var e = '"' + t + '"',
                        s = "(function(data){if(data==null)return;with(data){try{\nreturn " + (e = e.replace(/^"\${|}"$/g, "").replace(/\${/g, '"+').replace(/}/g, '+"')) + "\n}catch(e){}}})";
                    i = _._runScript(s), n._funMap.set(t, i)
                }
                return i
            }, h(n, ["grayFilter", function () {
                return this.grayFilter = new e([.3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, 0, 0, 0, 1, 0])
            }, "escapeSequence", function () {
                return this.escapeSequence = {"\\n": "\n", "\\t": "\t"}
            }, "_funMap", function () {
                return this._funMap = new z
            }]), n
        }(), O = function (t) {
            function i() {
                i.__super.call(this), this._top = NaN, this._bottom = NaN, this._left = NaN, this._right = NaN, this._centerX = NaN, this._centerY = NaN
            }

            a(i, "laya.ui.Widget", u);
            var e = i.prototype;
            return e.onReset = function () {
                this._top = this._bottom = this._left = this._right = this._centerX = this._centerY = NaN
            }, e._onEnable = function () {
                this.owner.parent ? this._onAdded() : this.owner.once("added", this, this._onAdded)
            }, e._onDisable = function () {
                this.owner.off("added", this, this._onAdded), this.owner.parent && this.owner.parent.off("resize", this, this._onParentResize)
            }, e._onAdded = function () {
                this.owner.parent && this.owner.parent.on("resize", this, this._onParentResize), this.resetLayoutX(), this.resetLayoutY()
            }, e._onParentResize = function () {
                (this.resetLayoutX() || this.resetLayoutY()) && this.owner.event("resize")
            }, e.resetLayoutX = function () {
                var t = this.owner;
                if (!t) return !1;
                var i = t.parent;
                if (i) if (isNaN(this.centerX)) {
                    if (isNaN(this.left)) isNaN(this.right) || (t.x = Math.round(i.width - t.displayWidth - this.right + t.pivotX * t.scaleX)); else if (t.x = Math.round(this.left + t.pivotX * t.scaleX), !isNaN(this.right)) {
                        var e = (i._width - this.left - this.right) / (t.scaleX || .01);
                        if (e != t.width) return t.width = e, !0
                    }
                } else t.x = Math.round(.5 * (i.width - t.displayWidth) + this.centerX + t.pivotX * t.scaleX);
                return !1
            }, e.resetLayoutY = function () {
                var t = this.owner;
                if (!t) return !1;
                var i = t.parent;
                if (i) if (isNaN(this.centerY)) {
                    if (isNaN(this.top)) isNaN(this.bottom) || (t.y = Math.round(i.height - t.displayHeight - this.bottom + t.pivotY * t.scaleY)); else if (t.y = Math.round(this.top + t.pivotY * t.scaleY), !isNaN(this.bottom)) {
                        var e = (i._height - this.top - this.bottom) / (t.scaleY || .01);
                        if (e != t.height) return t.height = e, !0
                    }
                } else t.y = Math.round(.5 * (i.height - t.displayHeight) + this.centerY + t.pivotY * t.scaleY);
                return !1
            }, e.resetLayout = function () {
                this.owner && (this.resetLayoutX(), this.resetLayoutY())
            }, n(0, e, "centerX", function () {
                return this._centerX
            }, function (t) {
                this._centerX != t && (this._centerX = t, this.resetLayoutX())
            }), n(0, e, "top", function () {
                return this._top
            }, function (t) {
                this._top != t && (this._top = t, this.resetLayoutY())
            }), n(0, e, "bottom", function () {
                return this._bottom
            }, function (t) {
                this._bottom != t && (this._bottom = t, this.resetLayoutY())
            }), n(0, e, "left", function () {
                return this._left
            }, function (t) {
                this._left != t && (this._left = t, this.resetLayoutX())
            }), n(0, e, "right", function () {
                return this._right
            }, function (t) {
                this._right != t && (this._right = t, this.resetLayoutX())
            }), n(0, e, "centerY", function () {
                return this._centerY
            }, function (t) {
                this._centerY != t && (this._centerY = t, this.resetLayoutY())
            }), h(i, ["EMPTY", function () {
                return this.EMPTY = new i
            }]), i
        }(), P = (function (t) {
            function i() {
                i.__super.call(this)
            }

            a(i, "laya.ui.UIEvent", f), i.SHOW_TIP = "showtip", i.HIDE_TIP = "hidetip"
        }(), function (t) {
            function d() {
                this.autoCacheCmd = !0, this._width = 0, this._height = 0, this._source = null, this._sizeGrid = null, this._isChanged = !1, this._offset = null, d.__super.call(this)
            }

            a(d, "laya.ui.AutoBitmap", t);
            var i = d.prototype;
            return i.destroy = function () {
                t.prototype.destroy.call(this), this._source = null, this._sizeGrid = null, this._offset = null
            }, i._setChanged = function () {
                this._isChanged || (this._isChanged = !0, _.timer.callLater(this, this.changeSource))
            }, i.changeSource = function () {
                this._isChanged = !1;
                var t = this._source;
                if (t && t.bitmap) {
                    var i = this.width, e = this.height, s = this._sizeGrid, n = t.sourceWidth, h = t.sourceHeight;
                    if (!s || n === i && h === e) this.clear(), this.drawTexture(t, this._offset ? this._offset[0] : 0, this._offset ? this._offset[1] : 0, i, e); else {
                        this.clear();
                        var o = s[0], r = s[1], a = s[2], l = s[3], c = s[4], u = !1;
                        if (i == n && (l = r = 0), e == h && (o = a = 0), i < l + r) {
                            var _ = i;
                            u = !0, i = l + r, this.save(), this.clipRect(0, 0, _, e)
                        }
                        l && o && this.drawImage(d.getTexture(t, 0, 0, l, o), 0, 0, l, o), r && o && this.drawImage(d.getTexture(t, n - r, 0, r, o), i - r, 0, r, o), l && a && this.drawImage(d.getTexture(t, 0, h - a, l, a), 0, e - a, l, a), r && a && this.drawImage(d.getTexture(t, n - r, h - a, r, a), i - r, e - a, r, a), o && this.drawBitmap(c, d.getTexture(t, l, 0, n - l - r, o), l, 0, i - l - r, o), a && this.drawBitmap(c, d.getTexture(t, l, h - a, n - l - r, a), l, e - a, i - l - r, a), l && this.drawBitmap(c, d.getTexture(t, 0, o, l, h - o - a), 0, o, l, e - o - a), r && this.drawBitmap(c, d.getTexture(t, n - r, o, r, h - o - a), i - r, o, r, e - o - a), this.drawBitmap(c, d.getTexture(t, l, o, n - l - r, h - o - a), l, o, i - l - r, e - o - a), u && this.restore()
                    }
                    this._repaint()
                }
            }, i.drawBitmap = function (t, i, e, s, n, h) {
                void 0 === n && (n = 0), void 0 === h && (h = 0), n < .1 || h < .1 || (!t || i.width == n && i.height == h ? this.drawImage(i, e, s, n, h) : this.fillTexture(i, e, s, n, h))
            }, n(0, i, "sizeGrid", function () {
                return this._sizeGrid
            }, function (t) {
                this._sizeGrid = t, this._setChanged()
            }), n(0, i, "width", function () {
                return this._width ? this._width : this._source ? this._source.sourceWidth : 0
            }, function (t) {
                this._width != t && (this._width = t, this._setChanged())
            }), n(0, i, "height", function () {
                return this._height ? this._height : this._source ? this._source.sourceHeight : 0
            }, function (t) {
                this._height != t && (this._height = t, this._setChanged())
            }), n(0, i, "source", function () {
                return this._source
            }, function (t) {
                t ? (this._source = t, this._setChanged()) : (this._source = null, this.clear())
            }), d.getTexture = function (t, i, e, s, n) {
                var h;
                return s <= 0 && (s = 1), n <= 0 && (n = 1), t.$_GID || (t.$_GID = M.getGID()), h && h._getSource() || (h = k.createFromTexture(t, i, e, s, n)), h
            }, d
        }(t)), Y = function (i) {
            function t() {
                this._dataSource = null, this._toolTip = null, this._tag = null, this._disabled = !1, this._gray = !1, t.__super.call(this), this._anchorX = NaN, this._anchorY = NaN, this._widget = O.EMPTY, this.preinitialize(), this.createChildren(), this.initialize()
            }

            a(t, "laya.ui.UIComponent", i);
            var e = t.prototype;
            return e.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, t), this._dataSource = null, this._tag = null, this._toolTip = null
            }, e.preinitialize = function () {
            }, e.createChildren = function () {
            }, e.initialize = function () {
            }, e.measureWidth = function () {
                var t = 0;
                this.commitMeasure();
                for (var i = this.numChildren - 1; -1 < i; i--) {
                    var e = this.getChildAt(i);
                    e._visible && (t = Math.max(e._x + e.width * e.scaleX, t))
                }
                return t
            }, e.commitMeasure = function () {
            }, e.measureHeight = function () {
                var t = 0;
                this.commitMeasure();
                for (var i = this.numChildren - 1; -1 < i; i--) {
                    var e = this.getChildAt(i);
                    e._visible && (t = Math.max(e._y + e.height * e.scaleY, t))
                }
                return t
            }, e._sizeChanged = function () {
                isNaN(this._anchorX) || (this.pivotX = this.anchorX * this.width), isNaN(this._anchorY) || (this.pivotY = this.anchorY * this.height), this.event("resize"), this._widget !== O.EMPTY && this._widget.resetLayout()
            }, e.onMouseOver = function (t) {
                _.stage.event("showtip", this._toolTip)
            }, e.onMouseOut = function (t) {
                _.stage.event("hidetip", this._toolTip)
            }, e._getWidget = function () {
                return this._widget === O.EMPTY && (this._widget = this.addComponent(O)), this._widget
            }, e.onCompResize = function () {
                this._sizeChanged()
            }, e._childChanged = function (t) {
                this.callLater(this._sizeChanged), i.prototype._childChanged.call(this, t)
            }, n(0, e, "centerY", function () {
                return this._widget.centerY
            }, function (t) {
                t != this._widget.centerY && (this._getWidget().centerY = t)
            }), n(0, e, "width", function () {
                return this._width ? this._width : this.measureWidth()
            }, function (t) {
                _.superGet(x, this, "width") != t && (_.superSet(x, this, "width", t), this.callLater(this._sizeChanged))
            }), n(0, e, "bottom", function () {
                return this._widget.bottom
            }, function (t) {
                t != this._widget.bottom && (this._getWidget().bottom = t)
            }), n(0, e, "height", function () {
                return this._height ? this._height : this.measureHeight()
            }, function (t) {
                _.superGet(x, this, "height") != t && (_.superSet(x, this, "height", t), this.callLater(this._sizeChanged))
            }), n(0, e, "left", function () {
                return this._widget.left
            }, function (t) {
                t != this._widget.left && (this._getWidget().left = t)
            }), n(0, e, "dataSource", function () {
                return this._dataSource
            }, function (t) {
                for (var i in this._dataSource = t, this._dataSource) this.hasOwnProperty(i) && "function" != typeof this[i] && (this[i] = this._dataSource[i])
            }), n(0, e, "centerX", function () {
                return this._widget.centerX
            }, function (t) {
                t != this._widget.centerX && (this._getWidget().centerX = t)
            }), n(0, e, "top", function () {
                return this._widget.top
            }, function (t) {
                t != this._widget.top && (this._getWidget().top = t)
            }), n(0, e, "right", function () {
                return this._widget.right
            }, function (t) {
                t != this._widget.right && (this._getWidget().right = t)
            }), n(0, e, "tag", function () {
                return this._tag
            }, function (t) {
                this._tag = t
            }), n(0, e, "toolTip", function () {
                return this._toolTip
            }, function (t) {
                this._toolTip != t && (null != (this._toolTip = t) ? (this.on("mouseover", this, this.onMouseOver), this.on("mouseout", this, this.onMouseOut)) : (this.off("mouseover", this, this.onMouseOver), this.off("mouseout", this, this.onMouseOut)))
            }), n(0, e, "gray", function () {
                return this._gray
            }, function (t) {
                t !== this._gray && (this._gray = t, H.gray(this, t))
            }), n(0, e, "disabled", function () {
                return this._disabled
            }, function (t) {
                t !== this._disabled && (this.gray = this._disabled = t, this.mouseEnabled = !t)
            }), n(0, e, "scaleX", i.prototype._$get_scaleX, function (t) {
                _.superGet(x, this, "scaleX") != t && (_.superSet(x, this, "scaleX", t), this.event("resize"))
            }), n(0, e, "scaleY", i.prototype._$get_scaleY, function (t) {
                _.superGet(x, this, "scaleY") != t && (_.superSet(x, this, "scaleY", t), this.event("resize"))
            }), n(0, e, "anchorX", function () {
                return this._anchorX
            }, function (t) {
                this._anchorX != t && (this._anchorX = t, this.callLater(this._sizeChanged))
            }), n(0, e, "anchorY", function () {
                return this._anchorY
            }, function (t) {
                this._anchorY != t && (this._anchorY = t, this.callLater(this._sizeChanged))
            }), t
        }(x), A = function (t) {
            function i() {
                this.lockLayer = null, this.popupEffect = function (t) {
                    t.scale(1, 1), t._effectTween = L.from(t, {
                        x: _.stage.width / 2,
                        y: _.stage.height / 2,
                        scaleX: 0,
                        scaleY: 0
                    }, 300, d.backOut, g.create(this, this.doOpen, [t]), 0, !1, !1)
                }, this.closeEffect = function (t) {
                    t._effectTween = L.to(t, {
                        x: _.stage.width / 2,
                        y: _.stage.height / 2,
                        scaleX: 0,
                        scaleY: 0
                    }, 300, d.strongOut, g.create(this, this.doClose, [t]), 0, !1, !1)
                }, i.__super.call(this), this.maskLayer = new x, this.popupEffectHandler = new g(this, this.popupEffect), this.closeEffectHandler = new g(this, this.closeEffect), this.mouseEnabled = this.maskLayer.mouseEnabled = !0, this.zOrder = 1e3, _.stage.addChild(this), _.stage.on("resize", this, this._onResize), T.closeDialogOnSide && this.maskLayer.on("click", this, this._closeOnSide), this._onResize(null)
            }

            a(i, "laya.ui.DialogManager", x);
            var e = i.prototype;
            return e._closeOnSide = function () {
                var t = this.getChildAt(this.numChildren - 1);
                t instanceof laya.ui.Dialog && t.close()
            }, e.setLockView = function (t) {
                this.lockLayer || (this.lockLayer = new X, this.lockLayer.mouseEnabled = !0, this.lockLayer.size(_.stage.width, _.stage.height)), this.lockLayer.removeChildren(), t && (t.centerX = t.centerY = 0, this.lockLayer.addChild(t))
            }, e._onResize = function (t) {
                var i = this.maskLayer.width = _.stage.width, e = this.maskLayer.height = _.stage.height;
                this.lockLayer && this.lockLayer.size(i, e), this.maskLayer.graphics.clear(!0), this.maskLayer.graphics.drawRect(0, 0, i, e, T.popupBgColor), this.maskLayer.alpha = T.popupBgAlpha;
                for (var s = this.numChildren - 1; -1 < s; s--) {
                    var n = this.getChildAt(s);
                    n.isPopupCenter && this._centerDialog(n)
                }
            }, e._centerDialog = function (t) {
                t.x = Math.round((_.stage.width - t.width >> 1) + t.pivotX), t.y = Math.round((_.stage.height - t.height >> 1) + t.pivotY)
            }, e.open = function (t, i, e) {
                void 0 === i && (i = !1), void 0 === e && (e = !1), i && this._closeAll(), this._clearDialogEffect(t), t.isPopupCenter && this._centerDialog(t), this.addChild(t), (t.isModal || this._getBit(32)) && _.timer.callLater(this, this._checkMask), e && null != t.popupEffect ? t.popupEffect.runWith(t) : this.doOpen(t), this.event("open")
            }, e._clearDialogEffect = function (t) {
                t._effectTween && (L.clear(t._effectTween), t._effectTween = null)
            }, e.doOpen = function (t) {
                t.onOpened(t._param)
            }, e.lock = function (t) {
                this.lockLayer && (t ? this.addChild(this.lockLayer) : this.lockLayer.removeSelf())
            }, e.close = function (t) {
                this._clearDialogEffect(t), t.isShowEffect && null != t.closeEffect ? t.closeEffect.runWith([t]) : this.doClose(t), this.event("close")
            }, e.doClose = function (t) {
                t.removeSelf(), t.isModal && this._checkMask(), t.closeHandler && t.closeHandler.runWith(t.closeType), t.onClosed(t.closeType), t.autoDestroyAtClosed && t.destroy()
            }, e.closeAll = function () {
                this._closeAll(), this.event("close")
            }, e._closeAll = function () {
                for (var t = this.numChildren - 1; -1 < t; t--) {
                    var i = this.getChildAt(t);
                    i && null != i.close && this.doClose(i)
                }
            }, e.getDialogsByGroup = function (t) {
                for (var i = [], e = this.numChildren - 1; -1 < e; e--) {
                    var s = this.getChildAt(e);
                    s && s.group === t && i.push(s)
                }
                return i
            }, e.closeByGroup = function (t) {
                for (var i = [], e = this.numChildren - 1; -1 < e; e--) {
                    var s = this.getChildAt(e);
                    s && s.group === t && (s.close(), i.push(s))
                }
                return i
            }, e._checkMask = function () {
                this.maskLayer.removeSelf();
                for (var t = this.numChildren - 1; -1 < t; t--) {
                    var i = this.getChildAt(t);
                    if (i && i.isModal) return void this.addChildAt(this.maskLayer, t)
                }
            }, i
        }(), N = function (i) {
            function e() {
                this._watchMap = {}, this._widget = null, this._dataSource = null, this._anchorX = NaN, this._anchorY = NaN, this._widget = O.EMPTY, e.__super.call(this)
            }

            a(e, "laya.ui.View", i);
            var t = e.prototype;
            return t.destroy = function (t) {
                void 0 === t && (t = !0), this._watchMap = null, i.prototype.destroy.call(this, t)
            }, t.changeData = function (t) {
                var i = this._watchMap[t];
                if (i) for (var e = 0, s = i.length; e < s; e++) {
                    i[e].exe(this)
                }
            }, t._sizeChanged = function () {
                isNaN(this._anchorX) || (this.pivotX = this.anchorX * this.width), isNaN(this._anchorY) || (this.pivotY = this.anchorY * this.height), this.event("resize")
            }, t._getWidget = function () {
                return this._widget === O.EMPTY && (this._widget = this.addComponent(O)), this._widget
            }, t.loadUI = function (t) {
                var i = e.uiMap[t];
                e.uiMap && this.createView(i)
            }, n(0, t, "anchorX", function () {
                return this._anchorX
            }, function (t) {
                this._anchorX != t && (this._anchorX = t, this.callLater(this._sizeChanged))
            }), n(0, t, "centerX", function () {
                return this._widget.centerX
            }, function (t) {
                t != this._widget.centerX && (this._getWidget().centerX = t)
            }), n(0, t, "top", function () {
                return this._widget.top
            }, function (t) {
                t != this._widget.top && (this._getWidget().top = t)
            }), n(0, t, "bottom", function () {
                return this._widget.bottom
            }, function (t) {
                t != this._widget.bottom && (this._getWidget().bottom = t)
            }), n(0, t, "dataSource", function () {
                return this._dataSource
            }, function (t) {
                for (var i in this._dataSource = t) {
                    var e = this.getChildByName(i);
                    e instanceof laya.ui.UIComponent ? e.dataSource = t[i] : this.hasOwnProperty(i) && "function" != typeof this[i] && (this[i] = t[i])
                }
            }), n(0, t, "left", function () {
                return this._widget.left
            }, function (t) {
                t != this._widget.left && (this._getWidget().left = t)
            }), n(0, t, "right", function () {
                return this._widget.right
            }, function (t) {
                t != this._widget.right && (this._getWidget().right = t)
            }), n(0, t, "anchorY", function () {
                return this._anchorY
            }, function (t) {
                this._anchorY != t && (this._anchorY = t, this.callLater(this._sizeChanged))
            }), n(0, t, "centerY", function () {
                return this._widget.centerY
            }, function (t) {
                t != this._widget.centerY && (this._getWidget().centerY = t)
            }), e.regComponent = function (t, i) {
                c.regClass(t, i)
            }, e.regViewRuntime = function (t, i) {
                c.regClass(t, i)
            }, e.regUI = function (t, i) {
                _.loader.cacheRes(t, i)
            }, e.uiMap = {}, e.__init$ = function () {
                c.regShortClassName([Q, E, gt, U, X, ht, E, tt, V, W, Y, ct, ut, G, R, st, et, $, ot, dt, F, j, pt, nt, e, q, at, lt, it, _t, ft, x, o, B, rt])
            }, e
        }(i), X = (function (t) {
            function i() {
                this._$4__texture = null, i.__super.call(this), this._width = this._height = 200;
                var t = new k;
                if (!_.Texture2D) throw new Error("WXOpenDataViewer:webgl not found!");
                t.bitmap = new _.Texture2D, this.texture = t
            }

            a(i, "laya.ui.WXOpenDataViewer", t);
            var e = i.prototype;
            e.onEnable = function () {
                this.postMsg({
                    type: "display",
                    rate: _.stage.frameRate
                }), s.wx && s.sharedCanvas && _.timer.frameLoop(1, this, this._onLoop)
            }, e.onDisable = function () {
                this.postMsg({type: "undisplay"}), _.timer.clear(this, this._onLoop)
            }, e._onLoop = function () {
                this.texture.bitmap.loadImageSource(s.sharedCanvas)
            }, e._postMsg = function () {
                var t = new C;
                t.translate(this.x, this.y);
                var i = _.stage;
                t.scale(i._canvasTransform.getScaleX() * this.globalScaleX * i.transform.getScaleX(), i._canvasTransform.getScaleY() * this.globalScaleY * i.transform.getScaleY()), this.postMsg({
                    type: "changeMatrix",
                    a: t.a,
                    b: t.b,
                    c: t.c,
                    d: t.d,
                    tx: t.tx,
                    ty: t.ty,
                    w: this.width,
                    h: this.height
                })
            }, e.postMsg = function (t) {
                s.wx && s.wx.getOpenDataContext && s.wx.getOpenDataContext().postMessage(t)
            }, n(0, e, "x", t.prototype._$get_x, function (t) {
                _.superSet(Y, this, "x", t), this.callLater(this._postMsg)
            }), n(0, e, "width", t.prototype._$get_width, function (t) {
                _.superSet(Y, this, "width", t), s.sharedCanvas && (s.sharedCanvas.width = t), this.callLater(this._postMsg)
            }), n(0, e, "height", t.prototype._$get_height, function (t) {
                _.superSet(Y, this, "height", t), s.sharedCanvas && (s.sharedCanvas.height = t), this.callLater(this._postMsg)
            }), n(0, e, "y", t.prototype._$get_y, function (t) {
                _.superSet(Y, this, "y", t), this.callLater(this._postMsg)
            })
        }(Y), function (t) {
            function i() {
                this._bgColor = null, i.__super.call(this)
            }

            a(i, "laya.ui.Box", t);
            var e = i.prototype;
            return _.imps(e, {"laya.ui.IBox": !0}), e._onResize = function (t) {
                this.graphics.clear(), this.graphics.drawRect(0, 0, this.width, this.height, this._bgColor)
            }, n(0, e, "dataSource", t.prototype._$get_dataSource, function (t) {
                for (var i in this._dataSource = t) {
                    var e = this.getChildByName(i);
                    e ? e.dataSource = t[i] : this.hasOwnProperty(i) && "function" != typeof this[i] && (this[i] = t[i])
                }
            }), n(0, e, "bgColor", function () {
                return this._bgColor
            }, function (t) {
                (this._bgColor = t) ? (this._onResize(null), this.on("resize", this, this._onResize)) : (this.graphics.clear(), this.off("resize", this, this._onResize))
            }), i
        }(Y)), E = function (i) {
            function e(t, i) {
                this.toggle = !1, this._bitmap = null, this._text = null, this._strokeColors = null, this._state = 0, this._selected = !1, this._skin = null, this._autoSize = !0, this._sources = null, this._clickHandler = null, this._stateChanged = !1, e.__super.call(this), this._labelColors = D.buttonLabelColors, this._stateNum = D.buttonStateNum, void 0 === i && (i = ""), this.skin = t, this.label = i
            }

            a(e, "laya.ui.Button", i);
            var t = e.prototype;
            return _.imps(t, {"laya.ui.ISelect": !0}), t.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, t), this._bitmap && this._bitmap.destroy(), this._text && this._text.destroy(t), this._bitmap = null, this._text = null, this._clickHandler = null, this._labelColors = this._sources = this._strokeColors = null
            }, t.createChildren = function () {
                this.graphics = this._bitmap = new P
            }, t.createText = function () {
                this._text || (this._text = new B, this._text.overflow = "hidden", this._text.align = "center", this._text.valign = "middle", this._text.width = this._width, this._text.height = this._height)
            }, t.initialize = function () {
                1 !== this._mouseState && (this.mouseEnabled = !0, this._setBit(64, !0)), this._createListener("mouseover", this, this.onMouse, null, !1, !1), this._createListener("mouseout", this, this.onMouse, null, !1, !1), this._createListener("mousedown", this, this.onMouse, null, !1, !1), this._createListener("mouseup", this, this.onMouse, null, !1, !1), this._createListener("click", this, this.onMouse, null, !1, !1)
            }, t.onMouse = function (t) {
                if (!1 !== this.toggle || !this._selected) return "click" === t.type ? (this.toggle && (this.selected = !this._selected), void (this._clickHandler && this._clickHandler.run())) : void (!this._selected && (this.state = e.stateMap[t.type]))
            }, t._skinLoaded = function () {
                this.callLater(this.changeClips), this._setStateChanged(), this._sizeChanged(), this.event("loaded")
            }, t.changeClips = function () {
                var t = v.getRes(this._skin);
                if (t) {
                    var i = t.sourceWidth, e = t.sourceHeight / this._stateNum;
                    t.$_GID || (t.$_GID = M.getGID());
                    var s = t.$_GID + "-" + this._stateNum, n = z.I.get(s);
                    if (M.isOkTextureList(n) || (n = null), n) this._sources = n; else {
                        if (this._sources = [], 1 === this._stateNum) this._sources.push(t); else for (var h = 0; h < this._stateNum; h++) this._sources.push(k.createFromTexture(t, 0, e * h, i, e));
                        z.I.set(s, this._sources)
                    }
                    this._autoSize ? (this._bitmap.width = this._width || i, this._bitmap.height = this._height || e, this._text && (this._text.width = this._bitmap.width, this._text.height = this._bitmap.height)) : this._text && (this._text.x = i)
                }
            }, t.measureWidth = function () {
                return this.runCallLater(this.changeClips), this._autoSize ? this._bitmap.width : (this.runCallLater(this.changeState), this._bitmap.width + (this._text ? this._text.width : 0))
            }, t.measureHeight = function () {
                return this.runCallLater(this.changeClips), this._text ? Math.max(this._bitmap.height, this._text.height) : this._bitmap.height
            }, t.changeState = function () {
                this._stateChanged = !1, this.runCallLater(this.changeClips);
                var t = this._state < this._stateNum ? this._state : this._stateNum - 1;
                this._sources && (this._bitmap.source = this._sources[t]), this.label && (this._text.color = this._labelColors[t], this._strokeColors && (this._text.strokeColor = this._strokeColors[t]))
            }, t._setStateChanged = function () {
                this._stateChanged || (this._stateChanged = !0, this.callLater(this.changeState))
            }, n(0, t, "skin", function () {
                return this._skin
            }, function (t) {
                this._skin != t && ((this._skin = t) ? v.getRes(t) ? this._skinLoaded() : _.loader.load(this._skin, g.create(this, this._skinLoaded), null, "image", 1) : this._skinLoaded())
            }), n(0, t, "labelPadding", function () {
                return this.createText(), this._text.padding.join(",")
            }, function (t) {
                this.createText(), this._text.padding = H.fillArray(D.labelPadding, t, Number)
            }), n(0, t, "state", function () {
                return this._state
            }, function (t) {
                this._state != t && (this._state = t, this._setStateChanged())
            }), n(0, t, "text", function () {
                return this.createText(), this._text
            }), n(0, t, "stateNum", function () {
                return this._stateNum
            }, function (t) {
                "string" == typeof t && (t = parseInt(t)), this._stateNum != t && (this._stateNum = t < 1 ? 1 : 3 < t ? 3 : t, this.callLater(this.changeClips))
            }), n(0, t, "label", function () {
                return this._text ? this._text.text : null
            }, function (t) {
                (this._text || t) && (this.createText(), this._text.text != t && (t && !this._text.parent && this.addChild(this._text), this._text.text = (t + "").replace(/\\n/g, "\n"), this._setStateChanged()))
            }), n(0, t, "labelSize", function () {
                return this.createText(), this._text.fontSize
            }, function (t) {
                this.createText(), this._text.fontSize = t
            }), n(0, t, "selected", function () {
                return this._selected
            }, function (t) {
                this._selected != t && (this._selected = t, this.state = this._selected ? 2 : 0, this.event("change"))
            }), n(0, t, "strokeColors", function () {
                return this._strokeColors ? this._strokeColors.join(",") : ""
            }, function (t) {
                this._strokeColors = H.fillArray(D.buttonLabelColors, t, String), this._setStateChanged()
            }), n(0, t, "labelColors", function () {
                return this._labelColors.join(",")
            }, function (t) {
                this._labelColors = H.fillArray(D.buttonLabelColors, t, String), this._setStateChanged()
            }), n(0, t, "labelStroke", function () {
                return this.createText(), this._text.stroke
            }, function (t) {
                this.createText(), this._text.stroke = t
            }), n(0, t, "labelStrokeColor", function () {
                return this.createText(), this._text.strokeColor
            }, function (t) {
                this.createText(), this._text.strokeColor = t
            }), n(0, t, "labelBold", function () {
                return this.createText(), this._text.bold
            }, function (t) {
                this.createText(), this._text.bold = t
            }), n(0, t, "labelFont", function () {
                return this.createText(), this._text.font
            }, function (t) {
                this.createText(), this._text.font = t
            }), n(0, t, "labelAlign", function () {
                return this.createText(), this._text.align
            }, function (t) {
                this.createText(), this._text.align = t
            }), n(0, t, "clickHandler", function () {
                return this._clickHandler
            }, function (t) {
                this._clickHandler = t
            }), n(0, t, "sizeGrid", function () {
                return this._bitmap.sizeGrid ? this._bitmap.sizeGrid.join(",") : null
            }, function (t) {
                this._bitmap.sizeGrid = H.fillArray(D.defaultSizeGrid, t, Number)
            }), n(0, t, "width", i.prototype._$get_width, function (t) {
                _.superSet(Y, this, "width", t), this._autoSize && (this._bitmap.width = t, this._text && (this._text.width = t))
            }), n(0, t, "height", i.prototype._$get_height, function (t) {
                _.superSet(Y, this, "height", t), this._autoSize && (this._bitmap.height = t, this._text && (this._text.height = t))
            }), n(0, t, "dataSource", i.prototype._$get_dataSource, function (t) {
                "number" == typeof (this._dataSource = t) || "string" == typeof t ? this.label = t + "" : _.superSet(Y, this, "dataSource", t)
            }), n(0, t, "iconOffset", function () {
                return this._bitmap._offset ? this._bitmap._offset.join(",") : null
            }, function (t) {
                this._bitmap._offset = t ? H.fillArray([1, 1], t, Number) : []
            }), h(e, ["stateMap", function () {
                return this.stateMap = {mouseup: 0, mouseover: 1, mousedown: 2, mouseout: 0}
            }]), e
        }(Y), G = function (i) {
            function e(t) {
                this._bitmap = null, this._skin = null, this._group = null, e.__super.call(this), this.skin = t
            }

            a(e, "laya.ui.Image", i);
            var t = e.prototype;
            return t.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, !0), this._bitmap && this._bitmap.destroy(), this._bitmap = null
            }, t.dispose = function () {
                this.destroy(!0), _.loader.clearRes(this._skin)
            }, t.createChildren = function () {
                this.graphics = this._bitmap = new P, this._bitmap.autoCacheCmd = !1
            }, t.setSource = function (t, i) {
                t === this._skin && i && (this.source = i, this.onCompResize())
            }, t.measureWidth = function () {
                return this._bitmap.width
            }, t.measureHeight = function () {
                return this._bitmap.height
            }, n(0, t, "dataSource", i.prototype._$get_dataSource, function (t) {
                "string" == typeof (this._dataSource = t) ? this.skin = t : _.superSet(Y, this, "dataSource", t)
            }), n(0, t, "source", function () {
                return this._bitmap.source
            }, function (t) {
                this._bitmap && (this._bitmap.source = t, this.event("loaded"), this.repaint())
            }), n(0, t, "skin", function () {
                return this._skin
            }, function (t) {
                if (this._skin != t) if (this._skin = t) {
                    var i = v.getRes(t);
                    i ? (this.source = i, this.onCompResize()) : _.loader.load(this._skin, g.create(this, this.setSource, [this._skin]), null, "image", 1, !0, this._group)
                } else this.source = null
            }), n(0, t, "sizeGrid", function () {
                return this._bitmap.sizeGrid ? this._bitmap.sizeGrid.join(",") : null
            }, function (t) {
                this._bitmap.sizeGrid = H.fillArray(D.defaultSizeGrid, t, Number)
            }), n(0, t, "group", function () {
                return this._group
            }, function (t) {
                t && this._skin && v.setGroup(this._skin, t), this._group = t
            }), n(0, t, "width", i.prototype._$get_width, function (t) {
                _.superSet(Y, this, "width", t), this._bitmap.width = 0 == t ? 1e-7 : t
            }), n(0, t, "height", i.prototype._$get_height, function (t) {
                _.superSet(Y, this, "height", t), this._bitmap.height = 0 == t ? 1e-7 : t
            }), e
        }(Y), R = function (i) {
            function e(t) {
                this._tf = null, e.__super.call(this), void 0 === t && (t = ""), this.text = t
            }

            a(e, "laya.ui.Label", i);
            var t = e.prototype;
            return t.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, t), this._tf = null
            }, t.createChildren = function () {
                this.addChild(this._tf = new B)
            }, t.changeText = function (t) {
                this._tf.changeText(t)
            }, t.measureWidth = function () {
                return this._tf.width
            }, t.measureHeight = function () {
                return this._tf.height
            }, n(0, t, "padding", function () {
                return this._tf.padding.join(",")
            }, function (t) {
                this._tf.padding = H.fillArray(D.labelPadding, t, Number)
            }), n(0, t, "bold", function () {
                return this._tf.bold
            }, function (t) {
                this._tf.bold = t
            }), n(0, t, "align", function () {
                return this._tf.align
            }, function (t) {
                this._tf.align = t
            }), n(0, t, "text", function () {
                return this._tf.text
            }, function (t) {
                this._tf.text != t && (t && (t = H.adptString(t + "")), this._tf.text = t, this.event("change"), this._width && this._height || this.onCompResize())
            }), n(0, t, "italic", function () {
                return this._tf.italic
            }, function (t) {
                this._tf.italic = t
            }), n(0, t, "wordWrap", function () {
                return this._tf.wordWrap
            }, function (t) {
                this._tf.wordWrap = t
            }), n(0, t, "font", function () {
                return this._tf.font
            }, function (t) {
                this._tf.font = t
            }), n(0, t, "dataSource", i.prototype._$get_dataSource, function (t) {
                "number" == typeof (this._dataSource = t) || "string" == typeof t ? this.text = t + "" : _.superSet(Y, this, "dataSource", t)
            }), n(0, t, "color", function () {
                return this._tf.color
            }, function (t) {
                this._tf.color = t
            }), n(0, t, "valign", function () {
                return this._tf.valign
            }, function (t) {
                this._tf.valign = t
            }), n(0, t, "leading", function () {
                return this._tf.leading
            }, function (t) {
                this._tf.leading = t
            }), n(0, t, "fontSize", function () {
                return this._tf.fontSize
            }, function (t) {
                this._tf.fontSize = t
            }), n(0, t, "bgColor", function () {
                return this._tf.bgColor
            }, function (t) {
                this._tf.bgColor = t
            }), n(0, t, "borderColor", function () {
                return this._tf.borderColor
            }, function (t) {
                this._tf.borderColor = t
            }), n(0, t, "stroke", function () {
                return this._tf.stroke
            }, function (t) {
                this._tf.stroke = t
            }), n(0, t, "strokeColor", function () {
                return this._tf.strokeColor
            }, function (t) {
                this._tf.strokeColor = t
            }), n(0, t, "textField", function () {
                return this._tf
            }), n(0, t, "width", function () {
                return this._width || this._tf.text ? _.superGet(Y, this, "width") : 0
            }, function (t) {
                _.superSet(Y, this, "width", t), this._tf.width = t
            }), n(0, t, "height", function () {
                return this._height || this._tf.text ? _.superGet(Y, this, "height") : 0
            }, function (t) {
                _.superSet(Y, this, "height", t), this._tf.height = t
            }), n(0, t, "overflow", function () {
                return this._tf.overflow
            }, function (t) {
                this._tf.overflow = t
            }), n(0, t, "underline", function () {
                return this._tf.underline
            }, function (t) {
                this._tf.underline = t
            }), n(0, t, "underlineColor", function () {
                return this._tf.underlineColor
            }, function (t) {
                this._tf.underlineColor = t
            }), e
        }(Y), W = function (i) {
            function e(t, i) {
                this._visibleNum = 6, this._button = null, this._list = null, this._isOpen = !1, this._itemSize = 12, this._labels = [], this._selectedIndex = -1, this._selectHandler = null, this._itemHeight = NaN, this._listHeight = NaN, this._listChanged = !1, this._itemChanged = !1, this._scrollBarSkin = null, this._isCustomList = !1, this.itemRender = null, e.__super.call(this), this._itemColors = D.comboBoxItemColors, this.skin = t, this.labels = i
            }

            a(e, "laya.ui.ComboBox", i);
            var t = e.prototype;
            return t.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, t), this._button && this._button.destroy(t), this._list && this._list.destroy(t), this._button = null, this._list = null, this._itemColors = null, this._labels = null, this._selectHandler = null
            }, t.createChildren = function () {
                this.addChild(this._button = new E), this._button.text.align = "left", this._button.labelPadding = "0,0,0,5", this._button.on("mousedown", this, this.onButtonMouseDown)
            }, t._createList = function () {
                this._list = new st, this._scrollBarSkin && (this._list.vScrollBarSkin = this._scrollBarSkin), this._setListEvent(this._list)
            }, t._setListEvent = function (t) {
                this._list.selectEnable = !0, this._list.on("mousedown", this, this.onListDown), this._list.mouseHandler = g.create(this, this.onlistItemMouse, null, !1), this._list.scrollBar && this._list.scrollBar.on("mousedown", this, this.onScrollBarDown)
            }, t.onListDown = function (t) {
                t.stopPropagation()
            }, t.onScrollBarDown = function (t) {
                t.stopPropagation()
            }, t.onButtonMouseDown = function (t) {
                this.callLater(this.switchTo, [!this._isOpen])
            }, t.measureWidth = function () {
                return this._button.width
            }, t.measureHeight = function () {
                return this._button.height
            }, t.changeList = function () {
                this._listChanged = !1;
                var t = this.width - 2, i = this._itemColors[2];
                this._itemHeight = this._itemSize + 6, this._list.itemRender = this.itemRender || {
                    type: "Box",
                    child: [{
                        type: "Label",
                        props: {
                            name: "label",
                            x: 1,
                            padding: "3,3,3,3",
                            width: t,
                            height: this._itemHeight,
                            fontSize: this._itemSize,
                            color: i
                        }
                    }]
                }, this._list.repeatY = this._visibleNum, this._list.refresh()
            }, t.onlistItemMouse = function (t, i) {
                var e = t.type;
                if ("mouseover" === e || "mouseout" === e) {
                    if (this._isCustomList) return;
                    var s = this._list.getCell(i);
                    if (!s) return;
                    var n = s.getChildByName("label");
                    n && (n.color = "mouseover" === e ? (n.bgColor = this._itemColors[0], this._itemColors[1]) : (n.bgColor = null, this._itemColors[2]))
                } else "click" === e && (this.selectedIndex = i, this.isOpen = !1)
            }, t.switchTo = function (t) {
                this.isOpen = t
            }, t.changeOpen = function () {
                this.isOpen = !this._isOpen
            }, t.changeItem = function () {
                if (this._itemChanged = !1, this._listHeight = 0 < this._labels.length ? Math.min(this._visibleNum, this._labels.length) * this._itemHeight : this._itemHeight, !this._isCustomList) {
                    var t = this._list.graphics;
                    t.clear(!0), t.drawRect(0, 0, this.width - 1, this._listHeight, this._itemColors[4], this._itemColors[3])
                }
                for (var i = this._list.array || [], e = i.length = 0, s = this._labels.length; e < s; e++) i.push({label: this._labels[e]});
                this._list.height = this._listHeight, this._list.array = i
            }, t.changeSelected = function () {
                this._button.label = this.selectedLabel
            }, t._onStageMouseWheel = function (t) {
                this._list && !this._list.contains(t.target) && this.removeList(null)
            }, t.removeList = function (t) {
                _.stage.off("mousedown", this, this.removeList), _.stage.off("mousewheel", this, this._onStageMouseWheel), this.isOpen = !1
            }, n(0, t, "selectedIndex", function () {
                return this._selectedIndex
            }, function (t) {
                this._selectedIndex != t && (this._selectedIndex = t, 0 < this._labels.length ? this.changeSelected() : this.callLater(this.changeSelected), this.event("change", [f.EMPTY.setTo("change", this, this)]), this._selectHandler && this._selectHandler.runWith(this._selectedIndex))
            }), n(0, t, "skin", function () {
                return this._button.skin
            }, function (t) {
                this._button.skin != t && (this._button.skin = t, this._listChanged = !0)
            }), n(0, t, "visibleNum", function () {
                return this._visibleNum
            }, function (t) {
                this._visibleNum = t, this._listChanged = !0
            }), n(0, t, "width", i.prototype._$get_width, function (t) {
                _.superSet(Y, this, "width", t), this._button.width = this._width, this._itemChanged = !0, this._listChanged = !0
            }), n(0, t, "selectedLabel", function () {
                return -1 < this._selectedIndex && this._selectedIndex < this._labels.length ? this._labels[this._selectedIndex] : null
            }, function (t) {
                this.selectedIndex = this._labels.indexOf(t)
            }), n(0, t, "labels", function () {
                return this._labels.join(",")
            }, function (t) {
                0 < this._labels.length && (this.selectedIndex = -1), t ? this._labels = t.split(",") : this._labels.length = 0, this._itemChanged = !0
            }), n(0, t, "height", i.prototype._$get_height, function (t) {
                _.superSet(Y, this, "height", t), this._button.height = this._height
            }), n(0, t, "selectHandler", function () {
                return this._selectHandler
            }, function (t) {
                this._selectHandler = t
            }), n(0, t, "labelBold", function () {
                return this._button.text.bold
            }, function (t) {
                this._button.text.bold = t
            }), n(0, t, "itemColors", function () {
                return String(this._itemColors)
            }, function (t) {
                this._itemColors = H.fillArray(this._itemColors, t, String), this._listChanged = !0
            }), n(0, t, "itemSize", function () {
                return this._itemSize
            }, function (t) {
                this._itemSize = t, this._listChanged = !0
            }), n(0, t, "scrollBar", function () {
                return this.list.scrollBar
            }), n(0, t, "isOpen", function () {
                return this._isOpen
            }, function (t) {
                if (this._isOpen != t) if (this._isOpen = t, this._button.selected = this._isOpen, this._isOpen) {
                    this._list || this._createList(), this._listChanged && !this._isCustomList && this.changeList(), this._itemChanged && this.changeItem();
                    var i = this.localToGlobal(b.TEMP.setTo(0, 0)), e = i.y + this._button.height;
                    e = e + this._listHeight <= _.stage.height ? e : i.y - this._listHeight, this._list.pos(i.x, e), this._list.zOrder = 1001, _._currentStage.addChild(this._list), _.stage.once("mousedown", this, this.removeList), _.stage.on("mousewheel", this, this._onStageMouseWheel), this._list.selectedIndex = this._selectedIndex
                } else this._list && this._list.removeSelf()
            }), n(0, t, "scrollBarSkin", function () {
                return this._scrollBarSkin
            }, function (t) {
                this._scrollBarSkin = t
            }), n(0, t, "sizeGrid", function () {
                return this._button.sizeGrid
            }, function (t) {
                this._button.sizeGrid = t
            }), n(0, t, "button", function () {
                return this._button
            }), n(0, t, "list", function () {
                return this._list || this._createList(), this._list
            }, function (t) {
                t && (t.removeSelf(), this._isCustomList = !0, this._list = t, this._setListEvent(t), this._itemHeight = t.getCell(0).height + t.spaceY)
            }), n(0, t, "dataSource", i.prototype._$get_dataSource, function (t) {
                "number" == typeof (this._dataSource = t) && Math.floor(t) == t || "string" == typeof t ? this.selectedIndex = parseInt(t) : t instanceof Array ? this.labels = t.join(",") : _.superSet(Y, this, "dataSource", t)
            }), n(0, t, "labelColors", function () {
                return this._button.labelColors
            }, function (t) {
                this._button.labelColors != t && (this._button.labelColors = t)
            }), n(0, t, "labelPadding", function () {
                return this._button.text.padding.join(",")
            }, function (t) {
                this._button.text.padding = H.fillArray(D.labelPadding, t, Number)
            }), n(0, t, "labelSize", function () {
                return this._button.text.fontSize
            }, function (t) {
                this._button.text.fontSize = t
            }), n(0, t, "labelFont", function () {
                return this._button.text.font
            }, function (t) {
                this._button.text.font = t
            }), n(0, t, "stateNum", function () {
                return this._button.stateNum
            }, function (t) {
                this._button.stateNum = t
            }), e
        }(Y), V = (function (t) {
            function e() {
                this._tipBox = null, this._tipText = null, this._defaultTipHandler = null, e.__super.call(this), this._tipBox = new Y, this._tipBox.addChild(this._tipText = new B), this._tipText.x = this._tipText.y = 5, this._tipText.color = e.tipTextColor, this._defaultTipHandler = this._showDefaultTip, _.stage.on("showtip", this, this._onStageShowTip), _.stage.on("hidetip", this, this._onStageHideTip), this.zOrder = 1100
            }

            a(e, "laya.ui.TipManager", Y);
            var i = e.prototype;
            i._onStageHideTip = function (t) {
                _.timer.clear(this, this._showTip), this.closeAll(), this.removeSelf()
            }, i._onStageShowTip = function (t) {
                _.timer.once(e.tipDelay, this, this._showTip, [t], !0)
            }, i._showTip = function (t) {
                if ("string" == typeof t) {
                    var i = String(t);
                    Boolean(i) && this._defaultTipHandler(i)
                } else t instanceof laya.utils.Handler ? t.run() : "function" == typeof t && t.apply();
                _.stage.on("mousemove", this, this._onStageMouseMove), _.stage.on("mousedown", this, this._onStageMouseDown), this._onStageMouseMove(null)
            }, i._onStageMouseDown = function (t) {
                this.closeAll()
            }, i._onStageMouseMove = function (t) {
                this._showToStage(this, e.offsetX, e.offsetY)
            }, i._showToStage = function (t, i, e) {
                void 0 === i && (i = 0), void 0 === e && (e = 0);
                var s = t.getBounds();
                t.x = _.stage.mouseX + i, t.y = _.stage.mouseY + e, t._x + s.width > _.stage.width && (t.x -= s.width + i), t._y + s.height > _.stage.height && (t.y -= s.height + e)
            }, i.closeAll = function () {
                _.timer.clear(this, this._showTip), _.stage.off("mousemove", this, this._onStageMouseMove), _.stage.off("mousedown", this, this._onStageMouseDown), this.removeChildren()
            }, i.showDislayTip = function (t) {
                this.addChild(t), this._showToStage(this), _._currentStage.addChild(this)
            }, i._showDefaultTip = function (t) {
                this._tipText.text = t;
                var i = this._tipBox.graphics;
                i.clear(!0), i.drawRect(0, 0, this._tipText.width + 10, this._tipText.height + 10, e.tipBackColor), this.addChild(this._tipBox), this._showToStage(this), _._currentStage.addChild(this)
            }, n(0, i, "defaultTipHandler", function () {
                return this._defaultTipHandler
            }, function (t) {
                this._defaultTipHandler = t
            }), e.offsetX = 10, e.offsetY = 15, e.tipTextColor = "#ffffff", e.tipBackColor = "#111111", e.tipDelay = 200
        }(), function (i) {
            function s(t, i, e) {
                this._sources = null, this._bitmap = null, this._skin = null, this._clipX = 1, this._clipY = 1, this._clipWidth = 0, this._clipHeight = 0, this._autoPlay = !1, this._interval = 50, this._complete = null, this._isPlaying = !1, this._index = 0, this._clipChanged = !1, this._group = null, this._toIndex = -1, s.__super.call(this), void 0 === i && (i = 1), void 0 === e && (e = 1), this._clipX = i, this._clipY = e, this.skin = t
            }

            a(s, "laya.ui.Clip", i);
            var t = s.prototype;
            return t.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, !0), this._bitmap && this._bitmap.destroy(), this._bitmap = null, this._sources = null
            }, t.dispose = function () {
                this.destroy(!0), _.loader.clearRes(this._skin)
            }, t.createChildren = function () {
                this.graphics = this._bitmap = new P
            }, t._onDisplay = function (t) {
                this._isPlaying ? this._getBit(128) ? this.play() : this.stop() : this._autoPlay && this.play()
            }, t._skinLoaded = function () {
                this._setClipChanged(), this._sizeChanged(), this.event("loaded")
            }, t.changeClip = function () {
                if (this._clipChanged = !1, this._skin) {
                    var t = v.getRes(this._skin);
                    t ? this.loadComplete(this._skin, t) : _.loader.load(this._skin, g.create(this, this.loadComplete, [this._skin]))
                }
            }, t.loadComplete = function (t, i) {
                if (t === this._skin && i) {
                    var e = this._clipWidth || Math.ceil(i.sourceWidth / this._clipX),
                        s = this._clipHeight || Math.ceil(i.sourceHeight / this._clipY), n = this._skin + e + s,
                        h = z.I.get(n);
                    if (M.isOkTextureList(h) || (h = null), h) this._sources = h; else {
                        this._sources = [];
                        for (var o = 0; o < this._clipY; o++) for (var r = 0; r < this._clipX; r++) this._sources.push(k.createFromTexture(i, e * r, s * o, e, s));
                        z.I.set(n, this._sources)
                    }
                    this.index = this._index, this.event("loaded"), this.onCompResize()
                }
            }, t.measureWidth = function () {
                return this.runCallLater(this.changeClip), this._bitmap.width
            }, t.measureHeight = function () {
                return this.runCallLater(this.changeClip), this._bitmap.height
            }, t.play = function (t, i) {
                void 0 === t && (t = 0), void 0 === i && (i = -1), this._isPlaying = !0, this.index = t, this._toIndex = i, this._index++, _.timer.loop(this.interval, this, this._loop), this.on("display", this, this._onDisplay), this.on("undisplay", this, this._onDisplay)
            }, t._loop = function () {
                this._visible && this._sources && (this._index++, -1 < this._toIndex && this._index >= this._toIndex ? this.stop() : this._index >= this._sources.length && (this._index = 0), this.index = this._index)
            }, t.stop = function () {
                this._isPlaying = !1, _.timer.clear(this, this._loop), this.event("complete")
            }, t._setClipChanged = function () {
                this._clipChanged || (this._clipChanged = !0, this.callLater(this.changeClip))
            }, n(0, t, "interval", function () {
                return this._interval
            }, function (t) {
                this._interval != t && (this._interval = t, this._isPlaying && this.play())
            }), n(0, t, "skin", function () {
                return this._skin
            }, function (t) {
                this._skin != t && ((this._skin = t) ? v.getRes(t) ? this._skinLoaded() : _.loader.load(this._skin, g.create(this, this._skinLoaded), null, "image", 1) : this._bitmap.source = null)
            }), n(0, t, "sources", function () {
                return this._sources
            }, function (t) {
                this._sources = t, this.index = this._index, this.event("loaded")
            }), n(0, t, "clipX", function () {
                return this._clipX
            }, function (t) {
                this._clipX = t || 1, this._setClipChanged()
            }), n(0, t, "clipY", function () {
                return this._clipY
            }, function (t) {
                this._clipY = t || 1, this._setClipChanged()
            }), n(0, t, "total", function () {
                return this.runCallLater(this.changeClip), this._sources ? this._sources.length : 0
            }), n(0, t, "clipWidth", function () {
                return this._clipWidth
            }, function (t) {
                this._clipWidth = t, this._setClipChanged()
            }), n(0, t, "sizeGrid", function () {
                return this._bitmap.sizeGrid ? this._bitmap.sizeGrid.join(",") : null
            }, function (t) {
                this._bitmap.sizeGrid = H.fillArray(D.defaultSizeGrid, t, Number)
            }), n(0, t, "group", function () {
                return this._group
            }, function (t) {
                t && this._skin && v.setGroup(this._skin, t), this._group = t
            }), n(0, t, "clipHeight", function () {
                return this._clipHeight
            }, function (t) {
                this._clipHeight = t, this._setClipChanged()
            }), n(0, t, "width", i.prototype._$get_width, function (t) {
                _.superSet(Y, this, "width", t), this._bitmap.width = t
            }), n(0, t, "height", i.prototype._$get_height, function (t) {
                _.superSet(Y, this, "height", t), this._bitmap.height = t
            }), n(0, t, "index", function () {
                return this._index
            }, function (t) {
                this._index = t, this._bitmap && this._sources && (this._bitmap.source = this._sources[t]), this.event("change")
            }), n(0, t, "autoPlay", function () {
                return this._autoPlay
            }, function (t) {
                this._autoPlay != t && ((this._autoPlay = t) ? this.play() : this.stop())
            }), n(0, t, "isPlaying", function () {
                return this._isPlaying
            }, function (t) {
                this._isPlaying = t
            }), n(0, t, "dataSource", i.prototype._$get_dataSource, function (t) {
                "number" == typeof (this._dataSource = t) && Math.floor(t) == t || "string" == typeof t ? this.index = parseInt(t) : _.superSet(Y, this, "dataSource", t)
            }), n(0, t, "bitmap", function () {
                return this._bitmap
            }), s
        }(Y)), U = function (i) {
            function t() {
                this.changeHandler = null, this._gridSize = 11, this._bgColor = "#ffffff", this._borderColor = "#000000", this._inputColor = "#000000", this._inputBgColor = "#efefef", this._colorPanel = null, this._colorTiles = null, this._colorBlock = null, this._colorInput = null, this._colorButton = null, this._colors = [], this._selectedColor = "#000000", this._panelChanged = !1, t.__super.call(this)
            }

            a(t, "laya.ui.ColorPicker", i);
            var e = t.prototype;
            return e.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, t), this._colorPanel && this._colorPanel.destroy(t), this._colorButton && this._colorButton.destroy(t), this._colorPanel = null, this._colorTiles = null, this._colorBlock = null, this._colorInput = null, this._colorButton = null, this._colors = null, this.changeHandler = null
            }, e.createChildren = function () {
                this.addChild(this._colorButton = new E), this._colorPanel = new X, this._colorPanel.size(230, 166), this._colorPanel.addChild(this._colorTiles = new x), this._colorPanel.addChild(this._colorBlock = new x), this._colorPanel.addChild(this._colorInput = new m)
            }, e.initialize = function () {
                this._colorButton.on("click", this, this.onColorButtonClick), this._colorBlock.pos(5, 5), this._colorInput.pos(60, 5), this._colorInput.size(60, 20), this._colorInput.on("change", this, this.onColorInputChange), this._colorInput.on("keydown", this, this.onColorFieldKeyDown), this._colorTiles.pos(5, 30), this._colorTiles.on("mousemove", this, this.onColorTilesMouseMove), this._colorTiles.on("click", this, this.onColorTilesClick), this._colorTiles.size(20 * this._gridSize, 12 * this._gridSize), this._colorPanel.on("mousedown", this, this.onPanelMouseDown), this.bgColor = this._bgColor
            }, e.onPanelMouseDown = function (t) {
                t.stopPropagation()
            }, e.changePanel = function () {
                this._panelChanged = !1;
                var t = this._colorPanel.graphics;
                t.clear(!0), t.drawRect(0, 0, 230, 166, this._bgColor, this._borderColor), this.drawBlock(this._selectedColor), this._colorInput.borderColor = this._borderColor, this._colorInput.bgColor = this._inputBgColor, this._colorInput.color = this._inputColor, (t = this._colorTiles.graphics).clear(!0);
                for (var i = [0, 3355443, 6710886, 10066329, 13421772, 16777215, 16711680, 65280, 255, 16776960, 65535, 16711935], e = 0; e < 12; e++) for (var s = 0; s < 20; s++) {
                    var n = 0;
                    n = 0 === s ? i[e] : 1 === s ? 0 : 51 * (((3 * e + s / 6) % 3 << 0) + 3 * (e / 6 << 0)) << 16 | s % 6 * 51 << 8 | (e << 0) % 6 * 51;
                    var h = H.toColor(n);
                    this._colors.push(h);
                    var o = s * this._gridSize, r = e * this._gridSize;
                    t.drawRect(o, r, this._gridSize, this._gridSize, h, "#000000")
                }
            }, e.onColorButtonClick = function (t) {
                this._colorPanel.parent ? this.close() : this.open()
            }, e.open = function () {
                var t = this.localToGlobal(new b),
                    i = t.x + this._colorPanel.width <= _.stage.width ? t.x : _.stage.width - this._colorPanel.width,
                    e = t.y + this._colorButton.height;
                e = e + this._colorPanel.height <= _.stage.height ? e : t.y - this._colorPanel.height, this._colorPanel.pos(i, e), this._colorPanel.zOrder = 1001, _._currentStage.addChild(this._colorPanel), _.stage.on("mousedown", this, this.removeColorBox)
            }, e.close = function () {
                _.stage.off("mousedown", this, this.removeColorBox), this._colorPanel.removeSelf()
            }, e.removeColorBox = function (t) {
                this.close()
            }, e.onColorFieldKeyDown = function (t) {
                13 == t.keyCode && (this._colorInput.text ? this.selectedColor = this._colorInput.text : this.selectedColor = null, this.close(), t.stopPropagation())
            }, e.onColorInputChange = function (t) {
                this._colorInput.text ? this.drawBlock(this._colorInput.text) : this.drawBlock("#FFFFFF")
            }, e.onColorTilesClick = function (t) {
                this.selectedColor = this.getColorByMouse(), this.close()
            }, e.onColorTilesMouseMove = function (t) {
                this._colorInput.focus = !1;
                var i = this.getColorByMouse();
                this._colorInput.text = i, this.drawBlock(i)
            }, e.getColorByMouse = function () {
                var t = this._colorTiles.getMousePoint(), i = Math.floor(t.x / this._gridSize),
                    e = Math.floor(t.y / this._gridSize);
                return this._colors[20 * e + i]
            }, e.drawBlock = function (t) {
                var i = this._colorBlock.graphics;
                i.clear(!0);
                var e = t || "#ffffff";
                i.drawRect(0, 0, 50, 20, e, this._borderColor), t || i.drawLine(0, 0, 50, 20, "#ff0000")
            }, e.changeColor = function () {
                var t = this.graphics;
                t.clear(!0);
                var i = this._selectedColor || "#000000";
                t.drawRect(0, 0, this._colorButton.width, this._colorButton.height, i)
            }, e._setPanelChanged = function () {
                this._panelChanged || (this._panelChanged = !0, this.callLater(this.changePanel))
            }, n(0, e, "inputBgColor", function () {
                return this._inputBgColor
            }, function (t) {
                this._inputBgColor = t, this._setPanelChanged()
            }), n(0, e, "selectedColor", function () {
                return this._selectedColor
            }, function (t) {
                this._selectedColor != t && (this._selectedColor = this._colorInput.text = t, this.drawBlock(t), this.changeColor(), this.changeHandler && this.changeHandler.runWith(this._selectedColor), this.event("change", f.EMPTY.setTo("change", this, this)))
            }), n(0, e, "skin", function () {
                return this._colorButton.skin
            }, function (t) {
                this._colorButton.once("loaded", this, this.changeColor), this._colorButton.skin = t
            }), n(0, e, "bgColor", function () {
                return this._bgColor
            }, function (t) {
                this._bgColor = t, this._setPanelChanged()
            }), n(0, e, "borderColor", function () {
                return this._borderColor
            }, function (t) {
                this._borderColor = t, this._setPanelChanged()
            }), n(0, e, "inputColor", function () {
                return this._inputColor
            }, function (t) {
                this._inputColor = t, this._setPanelChanged()
            }), t
        }(Y), $ = function (i) {
            function e(t) {
                this.changeHandler = null, this._bg = null, this._bar = null, this._skin = null, this._value = .5, e.__super.call(this), this.skin = t
            }

            a(e, "laya.ui.ProgressBar", i);
            var t = e.prototype;
            return t.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, t), this._bg && this._bg.destroy(t), this._bar && this._bar.destroy(t), this._bg = this._bar = null, this.changeHandler = null
            }, t.createChildren = function () {
                this.addChild(this._bg = new G), this.addChild(this._bar = new G), this._bar._bitmap.autoCacheCmd = !1
            }, t._skinLoaded = function () {
                this._bg.skin = this._skin, this._bar.skin = this._skin.replace(".png", "$bar.png"), this.callLater(this.changeValue), this._sizeChanged(), this.event("loaded")
            }, t.measureWidth = function () {
                return this._bg.width
            }, t.measureHeight = function () {
                return this._bg.height
            }, t.changeValue = function () {
                if (this.sizeGrid) {
                    var t = this.sizeGrid.split(","), i = Number(t[3]), e = Number(t[1]),
                        s = (this.width - i - e) * this._value;
                    this._bar.width = i + e + s, this._bar.visible = this._bar.width > i + e
                } else this._bar.width = this.width * this._value
            }, n(0, t, "dataSource", i.prototype._$get_dataSource, function (t) {
                "number" == typeof (this._dataSource = t) || "string" == typeof t ? this.value = Number(t) : _.superSet(Y, this, "dataSource", t)
            }), n(0, t, "skin", function () {
                return this._skin
            }, function (t) {
                this._skin != t && (this._skin = t, this._skin && !v.getRes(this._skin) ? _.loader.load(this._skin, g.create(this, this._skinLoaded), null, "image", 1) : this._skinLoaded())
            }), n(0, t, "height", i.prototype._$get_height, function (t) {
                _.superSet(Y, this, "height", t), this._bg.height = this._height, this._bar.height = this._height
            }), n(0, t, "bar", function () {
                return this._bar
            }), n(0, t, "value", function () {
                return this._value
            }, function (t) {
                this._value != t && (t = 1 < t ? 1 : t < 0 ? 0 : t, this._value = t, this.callLater(this.changeValue), this.event("change"), this.changeHandler && this.changeHandler.runWith(t))
            }), n(0, t, "bg", function () {
                return this._bg
            }), n(0, t, "sizeGrid", function () {
                return this._bg.sizeGrid
            }, function (t) {
                this._bg.sizeGrid = this._bar.sizeGrid = t
            }), n(0, t, "width", i.prototype._$get_width, function (t) {
                _.superSet(Y, this, "width", t), this._bg.width = this._width, this.callLater(this.changeValue)
            }), e
        }(Y), F = function (i) {
            function e(t) {
                this.rollRatio = .97, this.changeHandler = null, this.scaleBar = !0, this.autoHide = !1, this.elasticDistance = 0, this.elasticBackTime = 500, this.upButton = null, this.downButton = null, this.slider = null, this._scrollSize = 1, this._skin = null, this._thumbPercent = 1, this._target = null, this._lastPoint = null, this._lastOffset = 0, this._checkElastic = !1, this._isElastic = !1, this._value = NaN, this._hide = !1, this._clickOnly = !0, this._offsets = null, this.isLockedFun = null, this.triggerDownDragLimit = null, this.triggerUpDragLimit = null, e.__super.call(this), this._showButtons = T.showButtons, this._touchScrollEnable = T.touchScrollEnable, this._mouseWheelEnable = T.mouseWheelEnable, this.skin = t, this.max = 1
            }

            a(e, "laya.ui.ScrollBar", i);
            var t = e.prototype;
            return t.destroy = function (t) {
                void 0 === t && (t = !0), this.stopScroll(), this.target = null, i.prototype.destroy.call(this, t), this.upButton && this.upButton.destroy(t), this.downButton && this.downButton.destroy(t), this.slider && this.slider.destroy(t), this.upButton = this.downButton = null, this.slider = null, this.changeHandler = null, this._offsets = null
            }, t.createChildren = function () {
                this.addChild(this.slider = new j), this.addChild(this.upButton = new E), this.addChild(this.downButton = new E)
            }, t.initialize = function () {
                this.slider.showLabel = !1, this.slider.tick = 0, this.slider.on("change", this, this.onSliderChange), this.slider.setSlider(0, 0, 0), this.upButton.on("mousedown", this, this.onButtonMouseDown), this.downButton.on("mousedown", this, this.onButtonMouseDown)
            }, t.onSliderChange = function () {
                this._value != this.slider.value && (this.value = this.slider.value)
            }, t.onButtonMouseDown = function (t) {
                var i = t.currentTarget === this.upButton;
                this.slide(i), _.timer.once(D.scrollBarDelayTime, this, this.startLoop, [i]), _.stage.once("mouseup", this, this.onStageMouseUp)
            }, t.startLoop = function (t) {
                _.timer.frameLoop(1, this, this.slide, [t])
            }, t.slide = function (t) {
                t ? this.value -= this._scrollSize : this.value += this._scrollSize
            }, t.onStageMouseUp = function (t) {
                _.timer.clear(this, this.startLoop), _.timer.clear(this, this.slide)
            }, t._skinLoaded = function () {
                this.slider.skin = this._skin, this.callLater(this.changeScrollBar), this._sizeChanged(), this.event("loaded")
            }, t.changeScrollBar = function () {
                this.upButton.visible = this._showButtons, this.downButton.visible = this._showButtons, this._showButtons && (this.upButton.skin = this._skin.replace(".png", "$up.png"), this.downButton.skin = this._skin.replace(".png", "$down.png")), this.slider.isVertical ? this.slider.y = this._showButtons ? this.upButton.height : 0 : this.slider.x = this._showButtons ? this.upButton.width : 0, this.resetPositions(), this.repaint()
            }, t._sizeChanged = function () {
                i.prototype._sizeChanged.call(this), this.repaint(), this.resetPositions(), this.event("change"), this.changeHandler && this.changeHandler.runWith(this.value)
            }, t.resetPositions = function () {
                this.slider.isVertical ? this.slider.height = this.height - (this._showButtons ? this.upButton.height + this.downButton.height : 0) : this.slider.width = this.width - (this._showButtons ? this.upButton.width + this.downButton.width : 0), this.resetButtonPosition()
            }, t.resetButtonPosition = function () {
                this.slider.isVertical ? this.downButton.y = this.slider._y + this.slider.height : this.downButton.x = this.slider._x + this.slider.width
            }, t.measureWidth = function () {
                return this.slider.isVertical ? this.slider.width : 100
            }, t.measureHeight = function () {
                return this.slider.isVertical ? 100 : this.slider.height
            }, t.setScroll = function (t, i, e) {
                this.runCallLater(this._sizeChanged), this.slider.setSlider(t, i, e), this.slider.bar.visible = 0 < i, !this._hide && this.autoHide && (this.visible = !1)
            }, t.onTargetMouseWheel = function (t) {
                this.value -= t.delta * this._scrollSize, this.target = this._target
            }, t.onTargetMouseDown = function (t) {
                this.isLockedFun && !this.isLockedFun(t) || (this.event("end"), this._clickOnly = !0, this._lastOffset = 0, this._checkElastic = !1, this._lastPoint || (this._lastPoint = new b), this._lastPoint.setTo(_.stage.mouseX, _.stage.mouseY), _.timer.clear(this, this.tweenMove), L.clearTween(this), _.stage.once("mouseup", this, this.onStageMouseUp2), _.stage.once("mouseout", this, this.onStageMouseUp2), _.timer.frameLoop(1, this, this.loop))
            }, t.startDragForce = function () {
                this._clickOnly = !0, this._lastOffset = 0, this._checkElastic = !1, this._lastPoint || (this._lastPoint = new b), this._lastPoint.setTo(_.stage.mouseX, _.stage.mouseY), _.timer.clear(this, this.tweenMove), L.clearTween(this), _.stage.once("mouseup", this, this.onStageMouseUp2), _.stage.once("mouseout", this, this.onStageMouseUp2), _.timer.frameLoop(1, this, this.loop)
            }, t.cancelDragOp = function () {
                _.stage.off("mouseup", this, this.onStageMouseUp2), _.stage.off("mouseout", this, this.onStageMouseUp2), _.timer.clear(this, this.tweenMove), _.timer.clear(this, this.loop), this._target.mouseEnabled = !0
            }, t.checkTriggers = function (t) {
                return void 0 === t && (t = !1), 0 <= this.value && this.value - this._lastOffset <= 0 && this.triggerDownDragLimit && this.triggerDownDragLimit(t) ? (this.cancelDragOp(), !(this.value = 0)) : !!(this.value <= this.max && this.value - this._lastOffset >= this.max && this.triggerUpDragLimit && this.triggerUpDragLimit(t)) && (this.cancelDragOp(), this.value = this.max, !0)
            }, t.startTweenMoveForce = function (t) {
                this._lastOffset = t, _.timer.frameLoop(1, this, this.tweenMove, [200])
            }, t.loop = function () {
                var t = _.stage.mouseY, i = _.stage.mouseX;
                if (this._lastOffset = this.isVertical ? t - this._lastPoint.y : i - this._lastPoint.x, this._clickOnly) {
                    if (!(1 < Math.abs(this._lastOffset * (this.isVertical ? _.stage._canvasTransform.getScaleY() : _.stage._canvasTransform.getScaleX())))) return;
                    if (this._clickOnly = !1, this.checkTriggers()) return;
                    this._offsets || (this._offsets = []), this._offsets.length = 0, this._target.mouseEnabled = !1, !this.hide && this.autoHide && (this.alpha = 1, this.visible = !0), this.event("start")
                } else if (this.checkTriggers()) return;
                this._offsets.push(this._lastOffset), this._lastPoint.x = i, this._lastPoint.y = t, 0 !== this._lastOffset && (this._checkElastic || (0 < this.elasticDistance ? this._checkElastic || 0 == this._lastOffset || (0 < this._lastOffset && this._value <= this.min || this._lastOffset < 0 && this._value >= this.max ? (this._isElastic = !0, this._checkElastic = !0) : this._isElastic = !1) : this._checkElastic = !0), this._isElastic ? this._value <= this.min ? 0 < this._lastOffset ? this.value -= this._lastOffset * Math.max(0, 1 - (this.min - this._value) / this.elasticDistance) : (this.value -= .5 * this._lastOffset, this._value >= this.min && (this._checkElastic = !1)) : this._value >= this.max && (this._lastOffset < 0 ? this.value -= this._lastOffset * Math.max(0, 1 - (this._value - this.max) / this.elasticDistance) : (this.value -= .5 * this._lastOffset, this._value <= this.max && (this._checkElastic = !1))) : this.value -= this._lastOffset)
            }, t.onStageMouseUp2 = function (t) {
                if (_.stage.off("mouseup", this, this.onStageMouseUp2), _.stage.off("mouseout", this, this.onStageMouseUp2), _.timer.clear(this, this.loop), !(this._clickOnly && this._value >= this.min && this._value <= this.max)) if (this._target.mouseEnabled = !0, this._isElastic) this._value < this.min ? L.to(this, {value: this.min}, this.elasticBackTime, d.sineOut, g.create(this, this.elasticOver)) : this._value > this.max && L.to(this, {value: this.max}, this.elasticBackTime, d.sineOut, g.create(this, this.elasticOver)); else {
                    if (!this._offsets) return;
                    this._offsets.length < 1 && (this._offsets[0] = this.isVertical ? _.stage.mouseY - this._lastPoint.y : _.stage.mouseX - this._lastPoint.x);
                    for (var i = 0, e = Math.min(this._offsets.length, 3), s = 0; s < e; s++) i += this._offsets[this._offsets.length - 1 - s];
                    if (this._lastOffset = i / e, (i = Math.abs(this._lastOffset)) < 2) return void this.event("end");
                    250 < i && (this._lastOffset = 0 < this._lastOffset ? 250 : -250);
                    var n = Math.round(Math.abs(this.elasticDistance * (this._lastOffset / 150)));
                    _.timer.frameLoop(1, this, this.tweenMove, [n])
                }
            }, t.elasticOver = function () {
                this._isElastic = !1, !this.hide && this.autoHide && L.to(this, {alpha: 0}, 500), this.event("end")
            }, t.tweenMove = function (t) {
                if (this._lastOffset *= this.rollRatio, !this.checkTriggers(!0)) {
                    var i = NaN;
                    if (0 < t && (0 < this._lastOffset && this.value <= this.min ? (this._isElastic = !0, i = .5 * -(this.min - t - this.value), this._lastOffset > i && (this._lastOffset = i)) : this._lastOffset < 0 && this.value >= this.max && (this._isElastic = !0, i = .5 * -(this.max + t - this.value), this._lastOffset < i && (this._lastOffset = i))), this.value -= this._lastOffset, Math.abs(this._lastOffset) < .1) {
                        if (_.timer.clear(this, this.tweenMove), this._isElastic) return void (this._value < this.min ? L.to(this, {value: this.min}, this.elasticBackTime, d.sineOut, g.create(this, this.elasticOver)) : this._value > this.max ? L.to(this, {value: this.max}, this.elasticBackTime, d.sineOut, g.create(this, this.elasticOver)) : this.elasticOver());
                        this.event("end"), !this.hide && this.autoHide && L.to(this, {alpha: 0}, 500)
                    }
                }
            }, t.stopScroll = function () {
                this.onStageMouseUp2(null), _.timer.clear(this, this.tweenMove), L.clearTween(this)
            }, n(0, t, "thumbPercent", function () {
                return this._thumbPercent
            }, function (t) {
                this.runCallLater(this.changeScrollBar), this.runCallLater(this._sizeChanged), t = 1 <= t ? .99 : t, this._thumbPercent = t, this.scaleBar && (this.slider.isVertical ? this.slider.bar.height = Math.max(this.slider.height * t, D.scrollBarMinNum) : this.slider.bar.width = Math.max(this.slider.width * t, D.scrollBarMinNum))
            }), n(0, t, "dataSource", i.prototype._$get_dataSource, function (t) {
                "number" == typeof (this._dataSource = t) || "string" == typeof t ? this.value = Number(t) : _.superSet(Y, this, "dataSource", t)
            }), n(0, t, "skin", function () {
                return this._skin
            }, function (t) {
                " " != t && this._skin != t && (this._skin = t, this._skin && !v.getRes(this._skin) ? _.loader.load([this._skin, this._skin.replace(".png", "$up.png"), this._skin.replace(".png", "$down.png"), this._skin.replace(".png", "$bar.png")], g.create(this, this._skinLoaded)) : this._skinLoaded())
            }), n(0, t, "max", function () {
                return this.slider.max
            }, function (t) {
                this.slider.max = t
            }), n(0, t, "min", function () {
                return this.slider.min
            }, function (t) {
                this.slider.min = t
            }), n(0, t, "value", function () {
                return this._value
            }, function (t) {
                t !== this._value && (this._value = t, this._isElastic || (this.slider._value != t && (this.slider._value = t, this.slider.changeValue()), this._value = this.slider._value), this.event("change"), this.changeHandler && this.changeHandler.runWith(this._value))
            }), n(0, t, "isVertical", function () {
                return this.slider.isVertical
            }, function (t) {
                this.slider.isVertical = t
            }), n(0, t, "sizeGrid", function () {
                return this.slider.sizeGrid
            }, function (t) {
                this.slider.sizeGrid = t
            }), n(0, t, "scrollSize", function () {
                return this._scrollSize
            }, function (t) {
                this._scrollSize = t
            }), n(0, t, "target", function () {
                return this._target
            }, function (t) {
                this._target && (this._target.off("mousewheel", this, this.onTargetMouseWheel), this._target.off("mousedown", this, this.onTargetMouseDown)), (this._target = t) && (this._mouseWheelEnable && this._target.on("mousewheel", this, this.onTargetMouseWheel), this._touchScrollEnable && this._target.on("mousedown", this, this.onTargetMouseDown))
            }), n(0, t, "hide", function () {
                return this._hide
            }, function (t) {
                this._hide = t, this.visible = !t
            }), n(0, t, "showButtons", function () {
                return this._showButtons
            }, function (t) {
                this._showButtons = t, this.callLater(this.changeScrollBar)
            }), n(0, t, "touchScrollEnable", function () {
                return this._touchScrollEnable
            }, function (t) {
                this._touchScrollEnable = t, this.target = this._target
            }), n(0, t, "mouseWheelEnable", function () {
                return this._mouseWheelEnable
            }, function (t) {
                this._mouseWheelEnable = t, this.target = this._target
            }), n(0, t, "lastOffset", function () {
                return this._lastOffset
            }), n(0, t, "tick", function () {
                return this.slider.tick
            }, function (t) {
                this.slider.tick = t
            }), e
        }(Y), j = function (i) {
            function e(t) {
                this.changeHandler = null, this.isVertical = !0, this.showLabel = !0, this._allowClickBack = !1, this._max = 100, this._min = 0, this._tick = 1, this._value = 0, this._skin = null, this._bg = null, this._progress = null, this._bar = null, this._tx = NaN, this._ty = NaN, this._maxMove = NaN, this._globalSacle = null, e.__super.call(this), this.skin = t
            }

            a(e, "laya.ui.Slider", i);
            var t = e.prototype;
            return t.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, t), this._bg && this._bg.destroy(t), this._bar && this._bar.destroy(t), this._progress && this._progress.destroy(t), this._bg = null, this._bar = null, this._progress = null, this.changeHandler = null
            }, t.createChildren = function () {
                this.addChild(this._bg = new G), this.addChild(this._bar = new E)
            }, t.initialize = function () {
                this._bar.on("mousedown", this, this.onBarMouseDown), this._bg.sizeGrid = this._bar.sizeGrid = "4,4,4,4,0", this._progress && (this._progress.sizeGrid = this._bar.sizeGrid), this.allowClickBack = !0
            }, t.onBarMouseDown = function (t) {
                this._globalSacle || (this._globalSacle = new b), this._globalSacle.setTo(this.globalScaleX || .01, this.globalScaleY || .01), this._maxMove = this.isVertical ? this.height - this._bar.height : this.width - this._bar.width, this._tx = _.stage.mouseX, this._ty = _.stage.mouseY, _.stage.on("mousemove", this, this.mouseMove), _.stage.once("mouseup", this, this.mouseUp), _.stage.once("mouseout", this, this.mouseUp), this.showValueText()
            }, t.showValueText = function () {
                if (this.showLabel) {
                    var t = laya.ui.Slider.label;
                    this.addChild(t), t.textField.changeText(this._value + ""), this.isVertical ? (t.x = this._bar._x + 20, t.y = .5 * (this._bar.height - t.height) + this._bar._y) : (t.y = this._bar._y - 20, t.x = .5 * (this._bar.width - t.width) + this._bar._x)
                }
            }, t.hideValueText = function () {
                laya.ui.Slider.label && laya.ui.Slider.label.removeSelf()
            }, t.mouseUp = function (t) {
                _.stage.off("mousemove", this, this.mouseMove), _.stage.off("mouseup", this, this.mouseUp), _.stage.off("mouseout", this, this.mouseUp), this.sendChangeEvent("changed"), this.hideValueText()
            }, t.mouseMove = function (t) {
                var i = this._value;
                if (this.isVertical ? (this._bar.y += (_.stage.mouseY - this._ty) / this._globalSacle.y, this._bar._y > this._maxMove ? this._bar.y = this._maxMove : this._bar._y < 0 && (this._bar.y = 0), this._value = this._bar._y / this._maxMove * (this._max - this._min) + this._min, this._progress && (this._progress.height = this._bar._y + .5 * this._bar.height)) : (this._bar.x += (_.stage.mouseX - this._tx) / this._globalSacle.x, this._bar._x > this._maxMove ? this._bar.x = this._maxMove : this._bar._x < 0 && (this._bar.x = 0), this._value = this._bar._x / this._maxMove * (this._max - this._min) + this._min, this._progress && (this._progress.width = this._bar._x + .5 * this._bar.width)), this._tx = _.stage.mouseX, this._ty = _.stage.mouseY, 0 != this._tick) {
                    var e = Math.pow(10, (this._tick + "").length - 1);
                    this._value = Math.round(Math.round(this._value / this._tick) * this._tick * e) / e
                }
                this._value != i && this.sendChangeEvent(), this.showValueText()
            }, t.sendChangeEvent = function (t) {
                void 0 === t && (t = "change"), this.event(t), this.changeHandler && this.changeHandler.runWith(this._value)
            }, t._skinLoaded = function () {
                this._bg.skin = this._skin, this._bar.skin = this._skin.replace(".png", "$bar.png");
                var t = this._skin.replace(".png", "$progress.png");
                v.getRes(t) && (this._progress || (this.addChild(this._progress = new G), this._progress.sizeGrid = this._bar.sizeGrid, this.setChildIndex(this._progress, 1)), this._progress.skin = t), this.setBarPoint(), this.callLater(this.changeValue), this._sizeChanged(), this.event("loaded")
            }, t.setBarPoint = function () {
                this.isVertical ? this._bar.x = Math.round(.5 * (this._bg.width - this._bar.width)) : this._bar.y = Math.round(.5 * (this._bg.height - this._bar.height))
            }, t.measureWidth = function () {
                return Math.max(this._bg.width, this._bar.width)
            }, t.measureHeight = function () {
                return Math.max(this._bg.height, this._bar.height)
            }, t._sizeChanged = function () {
                i.prototype._sizeChanged.call(this), this.isVertical ? this._bg.height = this.height : this._bg.width = this.width, this.setBarPoint(), this.changeValue()
            }, t.setSlider = function (t, i, e) {
                this._value = -1, this._min = t, this._max = t < i ? i : t, this.value = e < t ? t : i < e ? i : e
            }, t.changeValue = function () {
                if (0 != this.tick) {
                    var t = Math.pow(10, (this._tick + "").length - 1);
                    this._value = Math.round(Math.round(this._value / this._tick) * this._tick * t) / t
                }
                this._value = this._value > this._max ? this._max : this._value < this._min ? this._min : this._value;
                var i = this._max - this._min;
                0 === i && (i = 1), this.isVertical ? (this._bar.y = (this._value - this._min) / i * (this.height - this._bar.height), this._progress && (this._progress.height = this._bar._y + .5 * this._bar.height)) : (this._bar.x = (this._value - this._min) / i * (this.width - this._bar.width), this._progress && (this._progress.width = this._bar._x + .5 * this._bar.width))
            }, t.onBgMouseDown = function (t) {
                var i = this._bg.getMousePoint();
                this.isVertical ? this.value = i.y / (this.height - this._bar.height) * (this._max - this._min) + this._min : this.value = i.x / (this.width - this._bar.width) * (this._max - this._min) + this._min
            }, n(0, t, "dataSource", i.prototype._$get_dataSource, function (t) {
                "number" == typeof (this._dataSource = t) || "string" == typeof t ? this.value = Number(t) : _.superSet(Y, this, "dataSource", t)
            }), n(0, t, "skin", function () {
                return this._skin
            }, function (t) {
                this._skin != t && (this._skin = t, this._skin && !v.getRes(this._skin) ? _.loader.load([this._skin, this._skin.replace(".png", "$bar.png")], g.create(this, this._skinLoaded)) : this._skinLoaded())
            }), n(0, t, "tick", function () {
                return this._tick
            }, function (t) {
                this._tick != t && (this._tick = t, this.callLater(this.changeValue))
            }), n(0, t, "sizeGrid", function () {
                return this._bg.sizeGrid
            }, function (t) {
                this._bg.sizeGrid = t, this._bar.sizeGrid = t, this._progress && (this._progress.sizeGrid = this._bar.sizeGrid)
            }), n(0, t, "allowClickBack", function () {
                return this._allowClickBack
            }, function (t) {
                this._allowClickBack != t && ((this._allowClickBack = t) ? this._bg.on("mousedown", this, this.onBgMouseDown) : this._bg.off("mousedown", this, this.onBgMouseDown))
            }), n(0, t, "max", function () {
                return this._max
            }, function (t) {
                this._max != t && (this._max = t, this.callLater(this.changeValue))
            }), n(0, t, "min", function () {
                return this._min
            }, function (t) {
                this._min != t && (this._min = t, this.callLater(this.changeValue))
            }), n(0, t, "bar", function () {
                return this._bar
            }), n(0, t, "value", function () {
                return this._value
            }, function (t) {
                if (this._value != t) {
                    var i = this._value;
                    this._value = t, this.changeValue(), this._value != i && this.sendChangeEvent()
                }
            }), h(e, ["label", function () {
                return this.label = new R
            }]), e
        }(Y), J = function (t) {
            var c, o;

            function u(t) {
                this.gameStopHD = !1, this.iconImgTl = null, this._iconImage = null, this._moreBox = null, this._gameBox = null, this.screenType = 0, this._moreGameDataUrl = "https://abc.layabox.com/public/more/gamelist2.json", this._iconImageObj = null, this.clickCallBack = null, this.closeCallBack = null, this.isShow = !1, this.dinfo = null, this.ErrorUrlHttps = "https://elastic.layabox.com/", this.tongjiType = "bdm", void 0 === t && (t = 0), u.__super.call(this), this.screenType = t, this.init()
            }

            a(u, "laya.ui.MoreGame", N);
            var i = u.prototype;
            return i.getLocalDateString = function (t) {
                void 0 === t && (t = 0);
                var i = this.getDateByTimestamp(t).toLocaleDateString();
                if (l.onLimixiu || l.onMiniGame) {
                    var e = new Date;
                    i = u.toLocaleDateString(e.getTime())
                }
                var s = new RegExp("/", "g");
                return i = i.replace(s, "-")
            }, i.getDateByTimestamp = function (t) {
                return void 0 === t && (t = 0), t && "" != t ? new Date(t) : new Date
            }, i.reportError = function (t, i, e) {
                void 0 === i && (i = ""), e = e || {};
                var s = Date.now(), n = new Date(s + 0);
                e.date = n.toLocaleString(), "error" != (e.etype = t) && "statistics" != t && (t = "statistics"), e.version = "V0.0.1", e.gameId = 10100, e.dinfo = this.dinfo, e.channel = -1e3, e.msg = i, e["@timestamp"] = n.toISOString(), e.user = this.getUserId(), e.openid = this.getOpenId();
                var h = u.getDay(n);
                e.rdate = h, e.day = n.getDate() + "", e.hour = n.getHours() + "", e.minute = n.getMinutes() + "", e.gameurl = r.baseURI, e.regTime = 0, "error" == t ? this.sendLog(e, this.tongjiType + "error-" + h.substring(0, 6) + "/" + t + "/", t) : this.sendLog(e, this.tongjiType + "-" + h.substring(0, 6) + "/" + t + "/", t)
            }, i.getUserId = function () {
                var t = parseInt(y.getItem("layauserid") + "") || -1;
                return -1 == t && (t = this.randRange(0, 1e9), y.setItem("layauserid", t + "")), t
            }, i.getOpenId = function () {
                var t = y.getItem("openid");
                if (null == t || "" == t) {
                    t = "";
                    for (var i = 0; i < 32; i++) {
                        var e = this.randRange(0, 62);
                        t += "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(e)
                    }
                    y.setItem("openid", t)
                }
                return t
            }, i.sendLog = function (t, i, e) {
                var s = this, n = new p;
                n.on("error", this, function (t, i, e) {
                    e && -1 != e.indexOf("[404]") && (new p).send(s.ErrorUrlHttps + "garbage/" + i + "/", JSON.stringify(t), "post", "text", ["Content-Type", "application/json"])
                }, [t, e]), l.onBDMiniGame && (t.gameurl = ""), n.send(this.ErrorUrlHttps + i, JSON.stringify(t), "post", "text", ["Content-Type", "application/json"])
            }, i.initEvent = function () {
                this.on("click", this, this.onIconClick)
            }, i.onStageResize = function () {
                var t = Math.min(_.stage.width / _.stage.designWidth, _.stage.height / _.stage.designHeight);
                _.stage.width < 720 && (t = .9), this._moreBox && this._moreBox.scale(t, t), this._gameBox && this._gameBox.scale(t, t)
            }, i.tada = function (t, i, e, s) {
                void 0 === e && (e = 1.1), void 0 === s && (s = 1);
                var n = new I;
                return n.reset(), n.to(t, {scaleX: e, scaleY: e, rotation: 3}, .1 * i).to(t, {
                    scaleX: e,
                    scaleY: e,
                    rotation: -3
                }, .1 * i).to(t, {scaleX: e, scaleY: e, rotation: 3}, .1 * i).to(t, {
                    scaleX: e,
                    scaleY: e,
                    rotation: -3
                }, .1 * i).to(t, {scaleX: e, scaleY: e, rotation: 3}, .1 * i).to(t, {
                    scaleX: e,
                    scaleY: e,
                    rotation: -3
                }, .1 * i).to(t, {scaleX: e, scaleY: e, rotation: 3}, .1 * i).to(t, {
                    scaleX: e,
                    scaleY: e,
                    rotation: -3
                }, .1 * i).to(t, {scaleX: e, scaleY: e, rotation: 3}, .1 * i).to(t, {
                    scaleX: s,
                    scaleY: s,
                    rotation: 0
                }, .1 * i), n.play(0), n
            }, i.dispose = function () {
                this.removeEvent(), this.gameStopHD = !0, u._moreGameData = null, this._iconImageObj = null, this.clickCallBack = null, this.closeCallBack = null, this.iconImgTl && (this.iconImgTl.offAll("complete"), this.iconImgTl = null), this._moreBox && (this._moreBox.removeChildren(), this._moreBox = null), this._gameBox && (this._gameBox.removeChildren(), this._gameBox = null), this._iconImage && (this._iconImage.removeSelf(), this._iconImage = null)
            }, i.onSetIconType = function (t) {
                this.gameStopHD = !t, this.visible = t
            }, i.checkIconImgHD = function () {
                this.iconImgTl ? this.iconImgTl.play(0) : this.iconImgTl = this.tada(this._iconImage, 1200, 1.1, .9), this.iconImgTl.on("complete", this, this.onTlComplete)
            }, i.onTlComplete = function () {
                if (this.parent) {
                    if (this._iconImage.scale(.9, .9), this._iconImage.rotation = 0, this.gameStopHD && this.iconImgTl) return this.iconImgTl.offAll("complete"), void (this.iconImgTl = null);
                    _.timer.once(1e3, this, this.onYanChiPlay)
                } else this.iconImgTl && (this.iconImgTl.offAll(), this.iconImgTl = null)
            }, i.onYanChiPlay = function () {
                this.parent && this.iconImgTl ? this.iconImgTl.play(0) : this.iconImgTl && (this.iconImgTl.offAll("complete"), this.iconImgTl = null)
            }, i.removeEvent = function () {
                this.off("click", this, this.onIconClick)
            }, i.onIconClick = function () {
                this.isShow = !0, null != this.clickCallBack && this.clickCallBack.run();
                var t = y.getItem("currentTime"), i = this.getLocalDateString();
                t != i ? (y.setItem("currentTime", i), this.reportError(u._moreGameData.statid1)) : this.reportError(u._moreGameData.statid2), this.onResLoaded()
            }, i.onResLoaded = function () {
                if (this._moreBox) this._moreBox.visible = !0; else {
                    this._moreBox = new X, _.stage.addChild(this._moreBox), this._moreBox.zOrder = 99999, this._moreBox.left = this._moreBox.right = this._moreBox.top = this._moreBox.bottom = 0;
                    var t = this.onCreateImage(u.onGetAtlasDanImgUrl("img_white_bg"), this._moreBox);
                    t.top = t.left = t.right = t.bottom = 0, t.sizeGrid = "1,1,1,1,1";
                    var i = this.onCreateImage(u.onGetAtlasDanImgUrl("hengfengexian"), this._moreBox);
                    i.left = i.right = 0, i.y = 132, i.alpha = .2;
                    var e = this.onCreateImage(u.onGetAtlasDanImgUrl("img_font_jingcai"), this._moreBox);
                    e.on("click", this, this.onJiantouImgClick), this.isQMP() && this.screenType ? e.pos(15, 70) : e.pos(15, 45);
                    var s = new st;
                    this._moreBox.addChild(s), s.itemRender = c, s.selectEnable = !0, s.vScrollBarSkin = "", s.scrollBar.autoHide = !0, s.scrollBar.elasticDistance = 250, s.renderHandler = new g(this, this.onGameListRender);
                    var n = u._moreGameData.marvellousGame.gameList, h = [];
                    h.push(n[0]), h.push(n[1]);
                    var o = this.RandomNumBoth(h.length, n.length - h.length, n.length);
                    if (!o) return void (this.visible = !1);
                    try {
                        for (var r = 0, a = o.length; r < a; r++) {
                            var l = o[r];
                            h.push(n[l])
                        }
                        u._moreGameData.marvellousGame.gameList = [], u._moreGameData.marvellousGame.gameList = h, s.array = u._moreGameData.marvellousGame.gameList
                    } catch (t) {
                        s.array = u._moreGameData.marvellousGame.gameList
                    }
                    this.screenType && (s.spaceY = 10, s.width = 690, this.isQMP() ? s.height = _.stage.height + 130 : s.height = 1139, s.y = 139, s.centerX = 0), this.onStageResize()
                }
            }, i.RandomNumBoth = function (t, i, e) {
                for (var s = [], n = t; n < e; n++) s.push(n);
                var h = [], o = s.length;
                for (n = 0; n < o; n++) {
                    s.length;
                    var r = Math.floor(Math.random() * s.length);
                    if (h.push(s[r]), s.splice(r, 1), s.length <= o - i) return h
                }
                return null
            }, i.isQMP = function () {
                var t = !1, i = 0;
                if (i = "horizontal" == _.stage.screenMode ? l.height % 9 : l.width % 9, l.onAndroid && 0 == i) {
                    var e = 0;
                    e = "horizontal" == _.stage.screenMode ? l.width : l.height, -1 != [2280, 2160, 2244, 3120, 2248, 2340, 2310].indexOf(e) && (t = !0)
                }
                var s = /iPhone/gi.test(l.window.navigator.userAgent) && 375 == Math.min(l.clientHeight, l.clientWidth) && 812 == Math.max(l.clientHeight, l.clientWidth),
                    n = 414 == Math.min(l.clientHeight, l.clientWidth) && 896 == Math.max(l.clientHeight, l.clientWidth);
                return !l.onMiniGame && !l.onBDMiniGame || l.onAndroid || !s && !n || (t = !0), t
            }, i.onDrawShapes = function (t, i, e, s) {
                void 0 === e && (e = 5), void 0 === s && (s = !1);
                var n = e;
                s && (n = 0);
                var h = new x;
                return h.graphics.drawPath(0, 0, [["moveTo", e, 0], ["lineTo", 105, 0], ["arcTo", t, 0, t, e, e], ["lineTo", t, i], ["arcTo", t, i + e, 105, i + e, n], ["lineTo", e, i + e], ["arcTo", 0, i + e, 0, i, n], ["lineTo", 0, e], ["arcTo", 0, 0, e, 0, e], ["closePath"]], {fillStyle: "#ff0000"}), h
            }, i.onCreateMaskImg = function (t, i) {
                var e = this.onCreateImage(u.onGetAtlasDanImgUrl("dayuan"), i), s = this.onCreateImage(t, e);
                s.pos(11, 10);
                var n = new x;
                return n.graphics.drawCircle(71, 74, 68, "#ff0000"), s.mask = n, e.scale(.7, .7), e
            }, i.onGameListRender = function (t, i) {
                var e = u._moreGameData.marvellousGame.gameList;
                if (!(i < 0 || i > e.length - 1)) {
                    var s = e[i];
                    t.init(s, this.screenType, new g(this, this.onItemClickCallBack))
                }
            }, i.onItemClickCallBack = function (i) {
                var e = this;
                if (swan.navigateToMiniProgram) {
                    var t = i.appKey, s = i.path, n = i.extendInfo;
                    swan.navigateToMiniProgram({
                        appKey: t, path: s, extraData: n, success: function (t) {
                        }, fail: function (t) {
                        }, complete: function (t) {
                            e.reportError(i.statid)
                        }.bind(this)
                    })
                }
            }, i.onJiantouImgClick = function (t) {
                this.isShow = !1, this._moreBox && (this._moreBox.visible = !1), null != this.closeCallBack && this.closeCallBack.run()
            }, i.onCreateLabel = function (t, i, e, s, n, h, o) {
                void 0 === e && (e = 24), void 0 === s && (s = "#000000"), void 0 === n && (n = !1), void 0 === h && (h = "center"), void 0 === o && (o = 10);
                var r = new R;
                return r.text = t, r.font = "Microsoft YaHei", r.fontSize = e, r.color = s, r.bold = !0, r.leading = o, r.valign = "middle", r.align = h, r.wordWrap = n, i.addChild(r), r
            }, i.onCreateImage = function (t, i) {
                var e = new G;
                return e.skin = t, i.addChild(e), e
            }, i.init = function () {
                var t = -1 < l.window.navigator.userAgent.indexOf("SwanGame");
                this.visible = !1, t && (this.dinfo = JSON.stringify(laya.bd.mini.BMiniAdapter.systemInfo), this.onGetAdvsListData())
            }, i.randRange = function (t, i) {
                return Math.floor(Math.random() * (i - t + 1)) + t
            }, i.onGetAdvsListData = function () {
                var i = this, t = this.randRange(1e4, 1e6), e = this._moreGameDataUrl + "?" + t;
                u._http.open("get", e, !0), u._http.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), u._http.responseType = "text", u._http.onerror = function (t) {
                    i._onError(t)
                }, u._http.onload = function (t) {
                    i._onLoad(t)
                }, u._http.send(null)
            }, i._onError = function (t) {
                this.error("Request failed Status:" + u._http.status + " text:" + u._http.statusText)
            }, i._onLoad = function (t) {
                var i = u._http, e = void 0 !== i.status ? i.status : 200;
                200 === e || 204 === e || 0 === e ? this.complete() : this.error("[" + i.status + "]" + i.statusText + ":" + i.responseURL)
            }, i.error = function (t) {
                this.event("error", t)
            }, i.complete = function () {
                try {
                    var t = u._http.response || u._http.responseText;
                    u._moreGameData = JSON.parse(t), this.initUI()
                } catch (t) {
                    !1, this.error(t.message)
                }
            }, i.initUI = function () {
                u._moreGameData.isOpen && this.screenType ? (this._iconImage || (this._iconImage = new G, this.addChild(this._iconImage)), this._iconImage.skin = u.onGetImgSkinUrl(u._moreGameData.icon), this._iconImageObj && (this._iconImage.size(this._iconImageObj.width, this._iconImageObj.height), this._iconImage.pivot(this._iconImageObj.width / 2, this._iconImageObj.height / 2), this._iconImage.pos(this._iconImageObj.width / 2, this._iconImageObj.height / 2)), this.visible = !0, this.initEvent(), this.gameStopHD = !1, this.checkIconImgHD()) : this.visible = !1
            }, i.setIconSize = function (t, i) {
                this._iconImage && (this._iconImage.size(t, i), this._iconImage.pivot(t / 2, i / 2), this._iconImage.pos(t / 2, i / 2)), this._iconImageObj = {
                    width: t,
                    height: i
                }
            }, u.toLocaleDateString = function (t) {
                return u.getDateFormatStr(t, "/")
            }, u.getDateFormatStr = function (t, i) {
                void 0 === i && (i = "yynndd");
                var e = new Date(t), s = e.getFullYear(), n = e.getMonth() + 1, h = e.getDate(), o = e.getHours(),
                    r = e.getMinutes(), a = e.getSeconds();
                switch (i) {
                    case"yynndd":
                        return s.toString() + "年" + n.toString() + "月" + h.toString() + "日";
                    case"/":
                        return s.toString() + "/" + n.toString() + "/" + h.toString()
                }
                return s.toString() + "年" + n.toString() + "月" + h.toString() + "日" + o.toString() + "时" + r.toString() + "分" + a.toString() + "秒"
            }, u.getDay = function (t) {
                var i = t.getMonth() + 1, e = t.getDate();
                return t.getFullYear() + "" + (i < 10 ? "0" + i : i) + (e < 10 ? "0" + e : e)
            }, u.onGetAtlasDanImgUrl = function (t) {
                return u._moreGameData.imgPath + u._moreGameData.atlas + t + ".png"
            }, u.onGetImgSkinUrl = function (t) {
                return u._moreGameData.imgPath + t
            }, u.onGetIconImgSkinUrl = function (t) {
                return u._moreGameData.iconPath + t
            }, u._moreGameData = null, h(u, ["_http", function () {
                return this._http = new l.window.XMLHttpRequest
            }]), u.__init$ = function () {
                c = function (t) {
                    function i() {
                        this.titleLabel = null, this.gameListBox = null, i.__super.call(this)
                    }

                    a(i, "", X);
                    var e = i.prototype;
                    return e.init = function (t, i, e) {
                        if (this.titleLabel ? this.titleLabel.text = t.title : (this.titleLabel = this.onCreateLabel(t.title, this, 32, "#3d3939"), this.titleLabel.pos(8, 0), this.titleLabel.size(162, 50)), this.gameListBox) for (s = 0, n = this.gameListBox._children.length; s < n; s++) (h = this.gameListBox._children[s]).init(t.gameList[s], i, e); else {
                            this.gameListBox = new X, this.addChild(this.gameListBox);
                            for (var s = 0, n = t.gameList.length; s < n; s++) {
                                var h = new o;
                                h.init(t.gameList[s], i, e), h.x = 0 + 175 * s, h.y = 65, this.gameListBox.addChild(h)
                            }
                        }
                        this.size(695, 340)
                    }, e.onCreateLabel = function (t, i, e, s, n) {
                        void 0 === e && (e = 26), void 0 === s && (s = "#000000"), void 0 === n && (n = !0);
                        var h = new R;
                        return h.text = t, h.font = "Microsoft YaHei", h.fontSize = e, h.color = s, h.bold = n, h.leading = 10, h.valign = "middle", h.align = "center", h.overflow = "hidden", i.addChild(h), h
                    }, i
                }(), o = function (t) {
                    function i() {
                        this.kuangImg = null, this.iconNameLabel = null, this.iconImg = null, this.playImg = null, this.itemData = null, this.callBackHandler = null, i.__super.call(this)
                    }

                    a(i, "", X);
                    var e = i.prototype;
                    return e.MoveGameItem = function () {
                    }, e.initEvent = function () {
                        this.on("click", this, this.onItemClick)
                    }, e.onItemClick = function () {
                        null != this.callBackHandler && this.callBackHandler.runWith([this.itemData])
                    }, e.init = function (t, i, e) {
                        if (this.itemData = t, this.callBackHandler = e, this.kuangImg ? this.kuangImg.skin = u.onGetAtlasDanImgUrl("dayuan") : this.kuangImg = this.onCreateImage(u.onGetAtlasDanImgUrl("dayuan"), this), this.iconImg) this.iconImg.skin = u.onGetIconImgSkinUrl(t.icon); else {
                            this.iconImg = this.onCreateImage(u.onGetIconImgSkinUrl(t.icon), this);
                            var s = new x;
                            s.graphics.drawCircle(71, 74, 68, "#ff0000"), this.iconImg.mask = s, this.iconImg.pos(13, 10)
                        }
                        this.iconNameLabel ? this.iconNameLabel.text = t.name : (this.iconNameLabel = this.onCreateLabel(t.name, this, 28, "#3d3939"), this.iconNameLabel.pos(7, 165)), this.playImg ? this.playImg.skin = u.onGetAtlasDanImgUrl("img_play") : (this.playImg = this.onCreateImage(u.onGetAtlasDanImgUrl("img_play"), this), this.playImg.pos(12, 210)), this.size(165, 270), this.initEvent()
                    }, e.onCreateLabel = function (t, i, e, s, n) {
                        void 0 === e && (e = 24), void 0 === s && (s = "#000000"), void 0 === n && (n = !1);
                        var h = new R;
                        return h.text = t, h.font = "Microsoft YaHei", h.fontSize = e, h.color = s, h.bold = n, h.leading = 10, h.valign = "middle", h.align = "center", h.size(152, 44), h.overflow = "hidden", i.addChild(h), h
                    }, e.onCreateImage = function (t, i) {
                        var e = new G;
                        return e.skin = t, i.addChild(e), e
                    }, i
                }()
            }, u
        }(), q = function (i) {
            function s() {
                this.closeHandler = null, this.popupEffect = null, this.closeEffect = null, this.group = null, this.isModal = !1, this.isShowEffect = !0, this.isPopupCenter = !0, this.closeType = null, this._dragArea = null, this._param = null, this._effectTween = null, s.__super.call(this), this.popupEffect = s.manager.popupEffectHandler, this.closeEffect = s.manager.closeEffectHandler, this._dealDragArea(), this.on("click", this, this._onClick)
            }

            a(s, "laya.ui.Dialog", i);
            var t = s.prototype;
            return t._dealDragArea = function () {
                var t = this.getChildByName("drag");
                t && (this.dragArea = t._x + "," + t._y + "," + t.width + "," + t.height, t.removeSelf())
            }, t._onMouseDown = function (t) {
                var i = this.getMousePoint();
                this._dragArea.contains(i.x, i.y) ? this.startDrag() : this.stopDrag()
            }, t._onClick = function (t) {
                var i = t.target;
                if (i) switch (i.name) {
                    case"close":
                    case"cancel":
                    case"sure":
                    case"no":
                    case"ok":
                    case"yes":
                        return void this.close(i.name)
                }
            }, t.open = function (t, i) {
                void 0 === t && (t = !0), this._dealDragArea(), this._param = i, s.manager.open(this, t, this.isShowEffect), s.manager.lock(!1)
            }, t.close = function (t) {
                this.closeType = t, s.manager.close(this)
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this.closeHandler = null, this.popupEffect = null, this.closeEffect = null, this._dragArea = null, i.prototype.destroy.call(this, t)
            }, t.show = function (t, i) {
                void 0 === t && (t = !1), void 0 === i && (i = !0), this._open(!1, t, i)
            }, t.popup = function (t, i) {
                void 0 === t && (t = !1), void 0 === i && (i = !0), this._open(!0, t, i)
            }, t._open = function (t, i, e) {
                this.isModal = t, this.isShowEffect = e, s.manager.lock(!0), this.open(i)
            }, n(0, t, "dragArea", function () {
                return this._dragArea ? this._dragArea.toString() : null
            }, function (t) {
                if (t) {
                    var i = H.fillArray([0, 0, 0, 0], t, Number);
                    this._dragArea = new S(i[0], i[1], i[2], i[3]), this.on("mousedown", this, this._onMouseDown)
                } else this._dragArea = null, this.off("mousedown", this, this._onMouseDown)
            }), n(0, t, "isPopup", function () {
                return null != this.parent
            }), n(0, t, "zOrder", i.prototype._$get_zOrder, function (t) {
                _.superSet(N, this, "zOrder", t), s.manager._checkMask()
            }), n(1, s, "manager", function () {
                return s._manager = s._manager || new A
            }, function (t) {
                s._manager = t
            }), s.setLockView = function (t) {
                s.manager.setLockView(t)
            }, s.lock = function (t) {
                s.manager.lock(t)
            }, s.closeAll = function () {
                s.manager.closeAll()
            }, s.getDialogsByGroup = function (t) {
                return s.manager.getDialogsByGroup(t)
            }, s.closeByGroup = function (t) {
                return s.manager.closeByGroup(t)
            }, s.CLOSE = "close", s.CANCEL = "cancel", s.SURE = "sure", s.NO = "no", s.YES = "yes", s.OK = "ok", s._manager = null, s
        }(N), Q = function (t) {
            function i() {
                this._items = null, this._selectedIndex = 0, i.__super.call(this), this._setIndexHandler = g.create(this, this.setIndex, null, !1)
            }

            a(i, "laya.ui.ViewStack", t);
            var e = i.prototype;
            return _.imps(e, {"laya.ui.IItem": !0}), e.setItems = function (t) {
                this.removeChildren();
                for (var i = 0, e = 0, s = t.length; e < s; e++) {
                    var n = t[e];
                    n && (n.name = "item" + i, this.addChild(n), i++)
                }
                this.initItems()
            }, e.addItem = function (t) {
                t.name = "item" + this._items.length, this.addChild(t), this.initItems()
            }, e._afterInited = function () {
                this.initItems()
            }, e.initItems = function () {
                this._items = [];
                for (var t = 0; t < 1e4; t++) {
                    var i = this.getChildByName("item" + t);
                    if (null == i) break;
                    this._items.push(i), i.visible = t == this._selectedIndex
                }
            }, e.setSelect = function (t, i) {
                this._items && -1 < t && t < this._items.length && (this._items[t].visible = i)
            }, e.setIndex = function (t) {
                this.selectedIndex = t
            }, n(0, e, "dataSource", t.prototype._$get_dataSource, function (t) {
                if ("number" == typeof (this._dataSource = t) && Math.floor(t) == t || "string" == typeof t) this.selectedIndex = parseInt(t); else for (var i in this._dataSource) this.hasOwnProperty(i) && (this[i] = this._dataSource[i])
            }), n(0, e, "selectedIndex", function () {
                return this._selectedIndex
            }, function (t) {
                this._selectedIndex != t && (this.setSelect(this._selectedIndex, !1), this._selectedIndex = t, this.setSelect(this._selectedIndex, !0))
            }), n(0, e, "selection", function () {
                return -1 < this._selectedIndex && this._selectedIndex < this._items.length ? this._items[this._selectedIndex] : null
            }, function (t) {
                this.selectedIndex = this._items.indexOf(t)
            }), n(0, e, "items", function () {
                return this._items
            }), n(0, e, "setIndexHandler", function () {
                return this._setIndexHandler
            }, function (t) {
                this._setIndexHandler = t
            }), i
        }(X), K = function (t) {
            function i() {
                this._space = 0, this._align = "none", this._itemChanged = !1, i.__super.call(this)
            }

            a(i, "laya.ui.LayoutBox", X);
            var e = i.prototype;
            return e.addChild = function (t) {
                return t.on("resize", this, this.onResize), this._setItemChanged(), laya.display.Node.prototype.addChild.call(this, t)
            }, e.onResize = function (t) {
                this._setItemChanged()
            }, e.addChildAt = function (t, i) {
                return t.on("resize", this, this.onResize), this._setItemChanged(), laya.display.Node.prototype.addChildAt.call(this, t, i)
            }, e.removeChildAt = function (t) {
                return this.getChildAt(t).off("resize", this, this.onResize), this._setItemChanged(), laya.display.Node.prototype.removeChildAt.call(this, t)
            }, e.refresh = function () {
                this._setItemChanged()
            }, e.changeItems = function () {
                this._itemChanged = !1
            }, e.sortItem = function (t) {
                t && t.sort(function (t, i) {
                    return t.y - i.y
                })
            }, e._setItemChanged = function () {
                this._itemChanged || (this._itemChanged = !0, this.callLater(this.changeItems))
            }, n(0, e, "space", function () {
                return this._space
            }, function (t) {
                this._space = t, this._setItemChanged()
            }), n(0, e, "align", function () {
                return this._align
            }, function (t) {
                this._align = t, this._setItemChanged()
            }), i
        }(), Z = function (t) {
            function e(t, i) {
                this.selectHandler = null, this._items = null, this._selectedIndex = -1, this._skin = null, this._direction = "horizontal", this._space = 0, this._labels = null, this._labelColors = null, this._labelFont = null, this._labelStrokeColor = null, this._strokeColors = null, this._labelStroke = NaN, this._labelSize = 0, this._labelBold = !1, this._labelPadding = null, this._labelAlign = null, this._stateNum = 0, this._labelChanged = !1, e.__super.call(this), this.skin = i, this.labels = t
            }

            a(e, "laya.ui.UIGroup", t);
            var i = e.prototype;
            return _.imps(i, {"laya.ui.IItem": !0}), i.preinitialize = function () {
                this.mouseEnabled = !0
            }, i.destroy = function (t) {
                void 0 === t && (t = !0), laya.ui.UIComponent.prototype.destroy.call(this, t), this._items && (this._items.length = 0), this._items = null, this.selectHandler = null
            }, i.addItem = function (t, i) {
                void 0 === i && (i = !0);
                var e = t, s = this._items.length;
                if (e.name = "item" + s, this.addChild(e), this.initItems(), i && 0 < s) {
                    var n = this._items[s - 1];
                    "horizontal" == this._direction ? e.x = n._x + n.width + this._space : e.y = n._y + n.height + this._space
                } else i && (e.x = 0, e.y = 0);
                return s
            }, i.delItem = function (t, i) {
                void 0 === i && (i = !0);
                var e = this._items.indexOf(t);
                if (-1 != e) {
                    var s = t;
                    this.removeChild(s);
                    for (var n = e + 1, h = this._items.length; n < h; n++) {
                        var o = this._items[n];
                        o.name = "item" + (n - 1), i && ("horizontal" == this._direction ? o.x -= s.width + this._space : o.y -= s.height + this._space)
                    }
                    if (this.initItems(), -1 < this._selectedIndex) {
                        var r;
                        r = this._selectedIndex < this._items.length ? this._selectedIndex : this._selectedIndex - 1, this._selectedIndex = -1, this.selectedIndex = r
                    }
                }
            }, i._afterInited = function () {
                this.initItems()
            }, i.initItems = function () {
                this._items || (this._items = []);
                for (var t = this._items.length = 0; t < 1e4; t++) {
                    var i = this.getChildByName("item" + t);
                    if (null == i) break;
                    this._items.push(i), i.selected = t === this._selectedIndex, i.clickHandler = g.create(this, this.itemClick, [t], !1)
                }
            }, i.itemClick = function (t) {
                this.selectedIndex = t
            }, i.setSelect = function (t, i) {
                this._items && -1 < t && t < this._items.length && (this._items[t].selected = i)
            }, i._skinLoaded = function () {
                this._setLabelChanged(), this.event("loaded")
            }, i.createItem = function (t, i) {
                return null
            }, i.changeLabels = function () {
                if (this._labelChanged = !1, this._items) for (var t = 0, i = 0, e = this._items.length; i < e; i++) {
                    var s = this._items[i];
                    this._skin && (s.skin = this._skin), this._labelColors && (s.labelColors = this._labelColors), this._labelSize && (s.labelSize = this._labelSize), this._labelStroke && (s.labelStroke = this._labelStroke), this._labelStrokeColor && (s.labelStrokeColor = this._labelStrokeColor), this._strokeColors && (s.strokeColors = this._strokeColors), this._labelBold && (s.labelBold = this._labelBold), this._labelPadding && (s.labelPadding = this._labelPadding), this._labelAlign && (s.labelAlign = this._labelAlign), this._stateNum && (s.stateNum = this._stateNum), this._labelFont && (s.labelFont = this._labelFont), "horizontal" === this._direction ? (s.y = 0, s.x = t, t += s.width + this._space) : (s.x = 0, s.y = t, t += s.height + this._space)
                }
                this._sizeChanged()
            }, i.commitMeasure = function () {
                this.runCallLater(this.changeLabels)
            }, i._setLabelChanged = function () {
                this._labelChanged || (this._labelChanged = !0, this.callLater(this.changeLabels))
            }, n(0, i, "labelStrokeColor", function () {
                return this._labelStrokeColor
            }, function (t) {
                this._labelStrokeColor != t && (this._labelStrokeColor = t, this._setLabelChanged())
            }), n(0, i, "skin", function () {
                return this._skin
            }, function (t) {
                this._skin != t && (this._skin = t, this._skin && !v.getRes(this._skin) ? _.loader.load(this._skin, g.create(this, this._skinLoaded), null, "image", 1) : this._skinLoaded())
            }), n(0, i, "selectedIndex", function () {
                return this._selectedIndex
            }, function (t) {
                this._selectedIndex != t && (this.setSelect(this._selectedIndex, !1), this._selectedIndex = t, this.setSelect(t, !0), this.event("change"), this.selectHandler && this.selectHandler.runWith(this._selectedIndex))
            }), n(0, i, "labels", function () {
                return this._labels
            }, function (t) {
                if (this._labels != t) {
                    if (this._labels = t, this.removeChildren(), this._setLabelChanged(), this._labels) for (var i = this._labels.split(","), e = 0, s = i.length; e < s; e++) {
                        var n = this.createItem(this._skin, i[e]);
                        n.name = "item" + e, this.addChild(n)
                    }
                    this.initItems()
                }
            }), n(0, i, "strokeColors", function () {
                return this._strokeColors
            }, function (t) {
                this._strokeColors != t && (this._strokeColors = t, this._setLabelChanged())
            }), n(0, i, "labelColors", function () {
                return this._labelColors
            }, function (t) {
                this._labelColors != t && (this._labelColors = t, this._setLabelChanged())
            }), n(0, i, "labelStroke", function () {
                return this._labelStroke
            }, function (t) {
                this._labelStroke != t && (this._labelStroke = t, this._setLabelChanged())
            }), n(0, i, "labelSize", function () {
                return this._labelSize
            }, function (t) {
                this._labelSize != t && (this._labelSize = t, this._setLabelChanged())
            }), n(0, i, "stateNum", function () {
                return this._stateNum
            }, function (t) {
                this._stateNum != t && (this._stateNum = t, this._setLabelChanged())
            }), n(0, i, "labelBold", function () {
                return this._labelBold
            }, function (t) {
                this._labelBold != t && (this._labelBold = t, this._setLabelChanged())
            }), n(0, i, "labelFont", function () {
                return this._labelFont
            }, function (t) {
                this._labelFont != t && (this._labelFont = t, this._setLabelChanged())
            }), n(0, i, "labelPadding", function () {
                return this._labelPadding
            }, function (t) {
                this._labelPadding != t && (this._labelPadding = t, this._setLabelChanged())
            }), n(0, i, "direction", function () {
                return this._direction
            }, function (t) {
                this._direction = t, this._setLabelChanged()
            }), n(0, i, "space", function () {
                return this._space
            }, function (t) {
                this._space = t, this._setLabelChanged()
            }), n(0, i, "items", function () {
                return this._items
            }), n(0, i, "selection", function () {
                return -1 < this._selectedIndex && this._selectedIndex < this._items.length ? this._items[this._selectedIndex] : null
            }, function (t) {
                this.selectedIndex = this._items.indexOf(t)
            }), n(0, i, "dataSource", t.prototype._$get_dataSource, function (t) {
                "number" == typeof (this._dataSource = t) && Math.floor(t) == t || "string" == typeof t ? this.selectedIndex = parseInt(t) : t instanceof Array ? this.labels = t.join(",") : _.superSet(X, this, "dataSource", t)
            }), e
        }(X), tt = function (t) {
            function e(t, i) {
                void 0 === i && (i = ""), e.__super.call(this, t, i)
            }

            a(e, "laya.ui.CheckBox", t);
            var i = e.prototype;
            return i.preinitialize = function () {
                laya.ui.UIComponent.prototype.preinitialize.call(this), this.toggle = !0, this._autoSize = !1
            }, i.initialize = function () {
                t.prototype.initialize.call(this), this.createText(), this._text.align = "left", this._text.valign = "top", this._text.width = 0
            }, n(0, i, "dataSource", t.prototype._$get_dataSource, function (t) {
                "boolean" == typeof (this._dataSource = t) ? this.selected = t : "string" == typeof t ? this.selected = "true" === t : _.superSet(E, this, "dataSource", t)
            }), e
        }(E), it = function (t) {
            function i() {
                this._list = null, this._source = null, this._renderHandler = null, this._spaceLeft = 10, this._spaceBottom = 0, this._keepStatus = !0, i.__super.call(this), this.width = this.height = 200
            }

            a(i, "laya.ui.Tree", t);
            var e = i.prototype;
            return _.imps(e, {"laya.ui.IRender": !0}), e.destroy = function (t) {
                void 0 === t && (t = !0), laya.ui.UIComponent.prototype.destroy.call(this, t), this._list && this._list.destroy(t), this._list = null, this._source = null, this._renderHandler = null
            }, e.createChildren = function () {
                this.addChild(this._list = new st), this._list.renderHandler = g.create(this, this.renderItem, null, !1), this._list.repeatX = 1, this._list.on("change", this, this.onListChange)
            }, e.onListChange = function (t) {
                this.event("change")
            }, e.getArray = function () {
                var t, i = [];
                for (var e in this._source) t = this._source[e], this.getParentOpenStatus(t) && (t.x = this._spaceLeft * this.getDepth(t), i.push(t));
                return i
            }, e.getDepth = function (t, i) {
                return void 0 === i && (i = 0), null == t.nodeParent ? i : this.getDepth(t.nodeParent, i + 1)
            }, e.getParentOpenStatus = function (t) {
                var i = t.nodeParent;
                return null == i || !!i.isOpen && (null == i.nodeParent || this.getParentOpenStatus(i))
            }, e.renderItem = function (t, i) {
                var e = t.dataSource;
                if (e) {
                    t.left = e.x;
                    var s = t.getChildByName("arrow");
                    s && (e.hasChild ? (s.visible = !0, s.index = e.isOpen ? 1 : 0, s.tag = i, s.off("click", this, this.onArrowClick), s.on("click", this, this.onArrowClick)) : s.visible = !1);
                    var n = t.getChildByName("folder");
                    n && (2 == n.clipY ? n.index = e.isDirectory ? 0 : 1 : n.index = e.isDirectory ? e.isOpen ? 1 : 0 : 2), this._renderHandler && this._renderHandler.runWith([t, i])
                }
            }, e.onArrowClick = function (t) {
                var i = t.currentTarget.tag;
                this._list.array[i].isOpen = !this._list.array[i].isOpen, this.event("open"), this._list.array = this.getArray()
            }, e.setItemState = function (t, i) {
                this._list.array[t] && (this._list.array[t].isOpen = i, this._list.array = this.getArray())
            }, e.fresh = function () {
                this._list.array = this.getArray(), this.repaint()
            }, e.parseXml = function (t, i, e, s) {
                var n, h = t.childNodes, o = h.length;
                if (!s) {
                    n = {};
                    var r, a = t.attributes;
                    for (var l in a) {
                        var c = (r = a[l]).nodeName, u = r.nodeValue;
                        n[c] = "true" == u || "false" != u && u
                    }
                    n.nodeParent = e, 0 < o && (n.isDirectory = !0), n.hasChild = 0 < o, i.push(n)
                }
                for (var _ = 0; _ < o; _++) {
                    var d = h[_];
                    this.parseXml(d, i, n, !1)
                }
            }, e.parseOpenStatus = function (t, i) {
                for (var e = 0, s = i.length; e < s; e++) {
                    var n = i[e];
                    if (n.isDirectory) for (var h = 0, o = t.length; h < o; h++) {
                        var r = t[h];
                        if (r.isDirectory && this.isSameParent(r, n) && n.label == r.label) {
                            n.isOpen = r.isOpen;
                            break
                        }
                    }
                }
            }, e.isSameParent = function (t, i) {
                return null == t.nodeParent && null == i.nodeParent || null != t.nodeParent && null != i.nodeParent && (t.nodeParent.label == i.nodeParent.label && this.isSameParent(t.nodeParent, i.nodeParent))
            }, e.filter = function (t) {
                if (Boolean(t)) {
                    var i = [];
                    this.getFilterSource(this._source, i, t), this._list.array = i
                } else this._list.array = this.getArray()
            }, e.getFilterSource = function (t, i, e) {
                var s;
                for (var n in e = e.toLocaleLowerCase(), t) !(s = t[n]).isDirectory && -1 < String(s.label).toLowerCase().indexOf(e) && (s.x = 0, i.push(s)), s.child && 0 < s.child.length && this.getFilterSource(s.child, i, e)
            }, n(0, e, "spaceBottom", function () {
                return this._list.spaceY
            }, function (t) {
                this._list.spaceY = t
            }), n(0, e, "keepStatus", function () {
                return this._keepStatus
            }, function (t) {
                this._keepStatus = t
            }), n(0, e, "itemRender", function () {
                return this._list.itemRender
            }, function (t) {
                this._list.itemRender = t
            }), n(0, e, "array", function () {
                return this._list.array
            }, function (t) {
                this._keepStatus && this._list.array && t && this.parseOpenStatus(this._list.array, t), this._source = t, this._list.array = this.getArray()
            }), n(0, e, "mouseHandler", function () {
                return this._list.mouseHandler
            }, function (t) {
                this._list.mouseHandler = t
            }), n(0, e, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, _.superSet(X, this, "dataSource", t)
            }), n(0, e, "source", function () {
                return this._source
            }), n(0, e, "scrollBar", function () {
                return this._list.scrollBar
            }), n(0, e, "list", function () {
                return this._list
            }), n(0, e, "scrollBarSkin", function () {
                return this._list.vScrollBarSkin
            }, function (t) {
                this._list.vScrollBarSkin = t
            }), n(0, e, "renderHandler", function () {
                return this._renderHandler
            }, function (t) {
                this._renderHandler = t
            }), n(0, e, "selectedIndex", function () {
                return this._list.selectedIndex
            }, function (t) {
                this._list.selectedIndex = t
            }), n(0, e, "spaceLeft", function () {
                return this._spaceLeft
            }, function (t) {
                this._spaceLeft = t
            }), n(0, e, "selectedItem", function () {
                return this._list.selectedItem
            }, function (t) {
                this._list.selectedItem = t
            }), n(0, e, "width", t.prototype._$get_width, function (t) {
                _.superSet(X, this, "width", t), this._list.width = t
            }), n(0, e, "height", t.prototype._$get_height, function (t) {
                _.superSet(X, this, "height", t), this._list.height = t
            }), n(0, e, "xml", null, function (t) {
                var i = [];
                this.parseXml(t.childNodes[0], i, null, !0), this.array = i
            }), n(0, e, "selectedPath", function () {
                return this._list.selectedItem ? this._list.selectedItem.path : null
            }), i
        }(X), et = function (t) {
            function i() {
                this._content = null, this._vScrollBar = null, this._hScrollBar = null, this._scrollChanged = !1, this._usedCache = null, this._elasticEnabled = !1, i.__super.call(this), this.width = this.height = 100
            }

            a(i, "laya.ui.Panel", t);
            var e = i.prototype;
            return e.destroy = function (t) {
                void 0 === t && (t = !0), laya.ui.UIComponent.prototype.destroy.call(this, t), this._content && this._content.destroy(t), this._vScrollBar && this._vScrollBar.destroy(t), this._hScrollBar && this._hScrollBar.destroy(t), this._vScrollBar = null, this._hScrollBar = null, this._content = null
            }, e.destroyChildren = function () {
                this._content.destroyChildren()
            }, e.createChildren = function () {
                laya.display.Node.prototype.addChild.call(this, this._content = new X)
            }, e.addChild = function (t) {
                return t.on("resize", this, this.onResize), this._setScrollChanged(), this._content.addChild(t)
            }, e.onResize = function () {
                this._setScrollChanged()
            }, e.addChildAt = function (t, i) {
                return t.on("resize", this, this.onResize), this._setScrollChanged(), this._content.addChildAt(t, i)
            }, e.removeChild = function (t) {
                return t.off("resize", this, this.onResize), this._setScrollChanged(), this._content.removeChild(t)
            }, e.removeChildAt = function (t) {
                return this.getChildAt(t).off("resize", this, this.onResize), this._setScrollChanged(), this._content.removeChildAt(t)
            }, e.removeChildren = function (t, i) {
                return void 0 === t && (t = 0), void 0 === i && (i = 2147483647), this._content.removeChildren(t, i), this._setScrollChanged(), this
            }, e.getChildAt = function (t) {
                return this._content.getChildAt(t)
            }, e.getChildByName = function (t) {
                return this._content.getChildByName(t)
            }, e.getChildIndex = function (t) {
                return this._content.getChildIndex(t)
            }, e.changeScroll = function () {
                this._scrollChanged = !1;
                var t = this.contentWidth || 1, i = this.contentHeight || 1, e = this._vScrollBar, s = this._hScrollBar,
                    n = e && i > this._height, h = s && t > this._width, o = n ? this._width - e.width : this._width,
                    r = h ? this._height - s.height : this._height;
                e && (e.x = this._width - e.width, e.y = 0, e.height = this._height - (h ? s.height : 0), e.scrollSize = Math.max(.033 * this._height, 1), e.thumbPercent = r / i, e.setScroll(0, i - r, e.value)), s && (s.x = 0, s.y = this._height - s.height, s.width = this._width - (n ? e.width : 0), s.scrollSize = Math.max(.033 * this._width, 1), s.thumbPercent = o / t, s.setScroll(0, t - o, s.value))
            }, e._sizeChanged = function () {
                laya.ui.UIComponent.prototype._sizeChanged.call(this), this.setContentSize(this._width, this._height)
            }, e.setContentSize = function (t, i) {
                var e = this._content;
                e.width = t, e.height = i, e._style.scrollRect || (e.scrollRect = S.create()), e._style.scrollRect.setTo(0, 0, t, i), e.scrollRect = e.scrollRect
            }, e.onScrollBarChange = function (t) {
                var i = this._content._style.scrollRect;
                if (i) {
                    var e = Math.round(t.value);
                    t.isVertical ? i.y = e : i.x = e, this._content.scrollRect = i
                }
            }, e.scrollTo = function (t, i) {
                void 0 === t && (t = 0), void 0 === i && (i = 0), this.vScrollBar && (this.vScrollBar.value = i), this.hScrollBar && (this.hScrollBar.value = t)
            }, e.refresh = function () {
                this.changeScroll()
            }, e.onScrollStart = function () {
                this._usedCache || (this._usedCache = _.superGet(X, this, "cacheAs")), _.superSet(X, this, "cacheAs", "none"), this._hScrollBar && this._hScrollBar.once("end", this, this.onScrollEnd), this._vScrollBar && this._vScrollBar.once("end", this, this.onScrollEnd)
            }, e.onScrollEnd = function () {
                _.superSet(X, this, "cacheAs", this._usedCache)
            }, e._setScrollChanged = function () {
                this._scrollChanged || (this._scrollChanged = !0, this.callLater(this.changeScroll))
            }, n(0, e, "numChildren", function () {
                return this._content.numChildren
            }), n(0, e, "hScrollBarSkin", function () {
                return this._hScrollBar ? this._hScrollBar.skin : null
            }, function (t) {
                null == this._hScrollBar && (laya.display.Node.prototype.addChild.call(this, this._hScrollBar = new ct), this._hScrollBar.on("change", this, this.onScrollBarChange, [this._hScrollBar]), this._hScrollBar.target = this._content, this._hScrollBar.elasticDistance = this._elasticEnabled ? 200 : 0, this._setScrollChanged()), this._hScrollBar.skin = t
            }), n(0, e, "contentWidth", function () {
                for (var t = 0, i = this._content.numChildren - 1; -1 < i; i--) {
                    var e = this._content.getChildAt(i);
                    t = Math.max(e._x + e.width * e.scaleX - e.pivotX, t)
                }
                return t
            }), n(0, e, "contentHeight", function () {
                for (var t = 0, i = this._content.numChildren - 1; -1 < i; i--) {
                    var e = this._content.getChildAt(i);
                    t = Math.max(e._y + e.height * e.scaleY - e.pivotY, t)
                }
                return t
            }), n(0, e, "width", t.prototype._$get_width, function (t) {
                _.superSet(X, this, "width", t), this._setScrollChanged()
            }), n(0, e, "hScrollBar", function () {
                return this._hScrollBar
            }), n(0, e, "content", function () {
                return this._content
            }), n(0, e, "height", t.prototype._$get_height, function (t) {
                _.superSet(X, this, "height", t), this._setScrollChanged()
            }), n(0, e, "vScrollBarSkin", function () {
                return this._vScrollBar ? this._vScrollBar.skin : null
            }, function (t) {
                null == this._vScrollBar && (laya.display.Node.prototype.addChild.call(this, this._vScrollBar = new at), this._vScrollBar.on("change", this, this.onScrollBarChange, [this._vScrollBar]), this._vScrollBar.target = this._content, this._vScrollBar.elasticDistance = this._elasticEnabled ? 200 : 0, this._setScrollChanged()), this._vScrollBar.skin = t
            }), n(0, e, "vScrollBar", function () {
                return this._vScrollBar
            }), n(0, e, "cacheAs", t.prototype._$get_cacheAs, function (t) {
                _.superSet(X, this, "cacheAs", t), this._usedCache = null, "none" !== t ? (this._hScrollBar && this._hScrollBar.on("start", this, this.onScrollStart), this._vScrollBar && this._vScrollBar.on("start", this, this.onScrollStart)) : (this._hScrollBar && this._hScrollBar.off("start", this, this.onScrollStart), this._vScrollBar && this._vScrollBar.off("start", this, this.onScrollStart))
            }), n(0, e, "elasticEnabled", function () {
                return this._elasticEnabled
            }, function (t) {
                this._elasticEnabled = t, this._vScrollBar && (this._vScrollBar.elasticDistance = t ? 200 : 0), this._hScrollBar && (this._hScrollBar.elasticDistance = t ? 200 : 0)
            }), i
        }(X), st = function (t) {
            function i() {
                this.selectHandler = null, this.renderHandler = null, this.mouseHandler = null, this.selectEnable = !1, this.totalPage = 0, this._$componentType = "List", this._content = null, this._scrollBar = null, this._itemRender = null, this._repeatX = 0, this._repeatY = 0, this._repeatX2 = 0, this._repeatY2 = 0, this._spaceX = 0, this._spaceY = 0, this._array = null, this._startIndex = 0, this._selectedIndex = -1, this._page = 0, this._isVertical = !0, this._cellSize = 20, this._cellOffset = 0, this._isMoved = !1, this.cacheContent = !1, this._createdLine = 0, this._cellChanged = !1, this._usedCache = null, this._elasticEnabled = !1, this._preLen = 0, i.__super.call(this), this._cells = [], this._offset = new b
            }

            a(i, "laya.ui.List", t);
            var e = i.prototype;
            return _.imps(e, {"laya.ui.IRender": !0, "laya.ui.IItem": !0}), e.destroy = function (t) {
                void 0 === t && (t = !0), this._content && this._content.destroy(t), this._scrollBar && this._scrollBar.destroy(t), laya.ui.UIComponent.prototype.destroy.call(this, t), this._content = null, this._scrollBar = null, this._itemRender = null, this._cells = null, this._array = null, this.selectHandler = this.renderHandler = this.mouseHandler = null
            }, e.createChildren = function () {
                this.addChild(this._content = new X)
            }, e.onScrollStart = function () {
                this._usedCache || (this._usedCache = _.superGet(X, this, "cacheAs")), _.superSet(X, this, "cacheAs", "none"), this._scrollBar.once("end", this, this.onScrollEnd)
            }, e.onScrollEnd = function () {
                _.superSet(X, this, "cacheAs", this._usedCache)
            }, e._removePreScrollBar = function () {
                var t = this.removeChildByName("scrollBar");
                t && t.destroy(!0)
            }, e.changeCells = function () {
                if (this._cellChanged = !1, this._itemRender) {
                    this.scrollBar = this.getChildByName("scrollBar");
                    var t = this._getOneCell(), i = t.width + this._spaceX || 1, e = t.height + this._spaceY || 1;
                    0 < this._width && (this._repeatX2 = this._isVertical ? Math.round(this._width / i) : Math.ceil(this._width / i)), 0 < this._height && (this._repeatY2 = this._isVertical ? Math.ceil(this._height / e) : Math.round(this._height / e));
                    var s = this._width ? this._width : i * this.repeatX - this._spaceX,
                        n = this._height ? this._height : e * this.repeatY - this._spaceY;
                    this._cellSize = this._isVertical ? e : i, this._cellOffset = this._isVertical ? e * Math.max(this._repeatY2, this._repeatY) - n - this._spaceY : i * Math.max(this._repeatX2, this._repeatX) - s - this._spaceX, this._isVertical && this.vScrollBarSkin ? this._scrollBar.height = n : !this._isVertical && this.hScrollBarSkin && (this._scrollBar.width = s), this.setContentSize(s, n);
                    var h = this._isVertical ? this.repeatX : this.repeatY,
                        o = (this._isVertical ? this.repeatY : this.repeatX) + (this._scrollBar ? 1 : 0);
                    this._createItems(0, h, o), this._createdLine = o, this._array && (this.array = this._array, this.runCallLater(this.renderItems))
                }
            }, e._getOneCell = function () {
                if (0 === this._cells.length) {
                    var t = this.createItem();
                    if (this._offset.setTo(t._x, t._y), this.cacheContent) return t;
                    this._cells.push(t)
                }
                return this._cells[0]
            }, e._createItems = function (t, i, e) {
                var s = this._content, n = this._getOneCell(), h = n.width + this._spaceX, o = n.height + this._spaceY;
                if (this.cacheContent) {
                    var r = new X;
                    r.cacheAs = "normal", r.pos((this._isVertical ? 0 : t) * h, (this._isVertical ? t : 0) * o), this._content.addChild(r), s = r
                } else {
                    for (var a = [], l = this._cells.length - 1; -1 < l; l--) {
                        var c = this._cells[l];
                        c.removeSelf(), a.push(c)
                    }
                    this._cells.length = 0
                }
                for (var u = t; u < e; u++) for (var _ = 0; _ < i; _++) (n = a && a.length ? a.pop() : this.createItem()).x = (this._isVertical ? _ : u) * h - s._x, n.y = (this._isVertical ? u : _) * o - s._y, n.name = "item" + (u * i + _), s.addChild(n), this.addCell(n)
            }, e.createItem = function () {
                var t = [];
                if ("function" == typeof this._itemRender) var i = new this._itemRender; else i = w.createComp(this._itemRender, null, null, t);
                if (0 == t.length && i._watchMap) {
                    var e = i._watchMap;
                    for (var s in e) for (var n = e[s], h = 0; h < n.length; h++) {
                        var o = n[h];
                        t.push(o.comp, o.prop, o.value)
                    }
                }
                return t.length && (i._$bindData = t), i
            }, e.addCell = function (t) {
                t.on("click", this, this.onCellMouse), t.on("rightclick", this, this.onCellMouse), t.on("mouseover", this, this.onCellMouse), t.on("mouseout", this, this.onCellMouse), t.on("mousedown", this, this.onCellMouse), t.on("mouseup", this, this.onCellMouse), this._cells.push(t)
            }, e._afterInited = function () {
                this.initItems()
            }, e.initItems = function () {
                if (!this._itemRender && null != this.getChildByName("item0")) {
                    this.repeatX = 1;
                    for (var t = 0, i = t = 0; i < 1e4; i++) {
                        var e = this.getChildByName("item" + i);
                        if (!e) break;
                        this.addCell(e), t++
                    }
                    this.repeatY = t
                }
            }, e.setContentSize = function (t, i) {
                this._content.width = t, this._content.height = i, (this._scrollBar || 0 != this._offset.x || 0 != this._offset.y) && (this._content._style.scrollRect || (this._content.scrollRect = S.create()), this._content._style.scrollRect.setTo(-this._offset.x, -this._offset.y, t, i), this._content.scrollRect = this._content.scrollRect), this.event("resize")
            }, e.onCellMouse = function (t) {
                "mousedown" === t.type && (this._isMoved = !1);
                var i = t.currentTarget, e = this._startIndex + this._cells.indexOf(i);
                e < 0 || ("click" === t.type || "rightclick" === t.type ? this.selectEnable && !this._isMoved ? this.selectedIndex = e : this.changeCellState(i, !0, 0) : "mouseover" !== t.type && "mouseout" !== t.type || this._selectedIndex === e || this.changeCellState(i, "mouseover" === t.type, 0), this.mouseHandler && this.mouseHandler.runWith([t, e]))
            }, e.changeCellState = function (t, i, e) {
                var s = t.getChildByName("selectBox");
                s && (this.selectEnable = !0, s.visible = i, s.index = e)
            }, e._sizeChanged = function () {
                laya.ui.UIComponent.prototype._sizeChanged.call(this), this.setContentSize(this.width, this.height), this._scrollBar && this.callLater(this.onScrollBarChange)
            }, e.onScrollBarChange = function (t) {
                this.runCallLater(this.changeCells);
                var i = this._scrollBar.value, e = this._isVertical ? this.repeatX : this.repeatY,
                    s = this._isVertical ? this.repeatY : this.repeatX, n = Math.floor(i / this._cellSize);
                if (this.cacheContent) o = s + 1, this._createdLine - n < o && (this._createItems(this._createdLine, e, this._createdLine + o), this.renderItems(this._createdLine * e, 0), this._createdLine += o); else {
                    var h = n * e, o = 0;
                    if (h > this._startIndex) {
                        o = h - this._startIndex;
                        var r = !0, a = this._startIndex + e * (s + 1);
                        this._isMoved = !0
                    } else h < this._startIndex && (o = this._startIndex - h, r = !1, a = this._startIndex - 1, this._isMoved = !0);
                    for (var l = 0; l < o; l++) {
                        if (r) {
                            var c = this._cells.shift();
                            this._cells[this._cells.length] = c;
                            var u = a + l
                        } else c = this._cells.pop(), this._cells.unshift(c), u = a - l;
                        var _ = Math.floor(u / e) * this._cellSize;
                        this._isVertical ? c.y = _ : c.x = _, this.renderItem(c, u)
                    }
                    this._startIndex = h, this.changeSelectStatus()
                }
                var d = this._content._style.scrollRect;
                this._isVertical ? (d.y = i - this._offset.y, d.x = -this._offset.x) : (d.y = -this._offset.y, d.x = i - this._offset.x), this._content.scrollRect = d
            }, e.posCell = function (t, i) {
                if (this._scrollBar) {
                    var e = this._isVertical ? this.repeatX : this.repeatY,
                        s = (this._isVertical ? this.repeatY : this.repeatX, Math.floor(i / e) * this._cellSize);
                    this._isVertical ? t._y = s : t.x = s
                }
            }, e.changeSelectStatus = function () {
                for (var t = 0, i = this._cells.length; t < i; t++) this.changeCellState(this._cells[t], this._selectedIndex === this._startIndex + t, 1)
            }, e.renderItems = function (t, i) {
                void 0 === t && (t = 0), void 0 === i && (i = 0);
                for (var e = t, s = i || this._cells.length; e < s; e++) this.renderItem(this._cells[e], this._startIndex + e);
                this.changeSelectStatus()
            }, e.renderItem = function (t, i) {
                this._array && 0 <= i && i < this._array.length ? (t.visible = !0, t._$bindData ? (t._dataSource = this._array[i], this._bindData(t, this._array[i])) : t.dataSource = this._array[i], this.cacheContent || this.posCell(t, i), this.hasListener("render") && this.event("render", [t, i]), this.renderHandler && this.renderHandler.runWith([t, i])) : (t.visible = !1, t.dataSource = null)
            }, e._bindData = function (t, i) {
                for (var e = t._$bindData, s = 0, n = e.length; s < n; s++) {
                    var h = e[s++], o = e[s++], r = e[s], a = H.getBindFun(r);
                    h[o] = a.call(this, i)
                }
            }, e.updateArray = function (t) {
                this._array = t;
                var i = 0;
                if (this._array && (0 <= (i = this._preLen - this._startIndex) && this.renderItems(i), this._preLen = this._array.length), this._scrollBar) {
                    var e = t.length, s = this._isVertical ? this.repeatX : this.repeatY,
                        n = this._isVertical ? this.repeatY : this.repeatX, h = Math.ceil(e / s);
                    n <= h && (this._scrollBar.thumbPercent = n / h, this._scrollBar.slider._max = (h - n) * this._cellSize + this._cellOffset)
                }
            }, e.refresh = function () {
                this.array = this._array
            }, e.getItem = function (t) {
                return -1 < t && t < this._array.length ? this._array[t] : null
            }, e.changeItem = function (t, i) {
                -1 < t && t < this._array.length && (this._array[t] = i, t >= this._startIndex && t < this._startIndex + this._cells.length && this.renderItem(this.getCell(t), t))
            }, e.setItem = function (t, i) {
                this.changeItem(t, i)
            }, e.addItem = function (t) {
                this._array.push(t), this.array = this._array
            }, e.addItemAt = function (t, i) {
                this._array.splice(i, 0, t), this.array = this._array
            }, e.deleteItem = function (t) {
                this._array.splice(t, 1), this.array = this._array
            }, e.getCell = function (t) {
                return this.runCallLater(this.changeCells), -1 < t && this._cells ? this._cells[(t - this._startIndex) % this._cells.length] : null
            }, e.scrollTo = function (t) {
                if (this._scrollBar) {
                    var i = this._isVertical ? this.repeatX : this.repeatY;
                    this._scrollBar.value = Math.floor(t / i) * this._cellSize
                } else this.startIndex = t
            }, e.tweenTo = function (t, i, e) {
                if (void 0 === i && (i = 200), this._scrollBar) {
                    this._scrollBar.stopScroll();
                    var s = this._isVertical ? this.repeatX : this.repeatY;
                    L.to(this._scrollBar, {value: Math.floor(t / s) * this._cellSize}, i, null, e, 0, !0)
                } else this.startIndex = t, e && e.run()
            }, e._setCellChanged = function () {
                this._cellChanged || (this._cellChanged = !0, this.callLater(this.changeCells))
            }, e.commitMeasure = function () {
                this.runCallLater(this.changeCells)
            }, n(0, e, "cacheAs", t.prototype._$get_cacheAs, function (t) {
                _.superSet(X, this, "cacheAs", t), this._scrollBar && (this._usedCache = null, "none" !== t ? this._scrollBar.on("start", this, this.onScrollStart) : this._scrollBar.off("start", this, this.onScrollStart))
            }), n(0, e, "content", function () {
                return this._content
            }), n(0, e, "height", t.prototype._$get_height, function (t) {
                t != this._height && (_.superSet(X, this, "height", t), this._setCellChanged())
            }), n(0, e, "itemRender", function () {
                return this._itemRender
            }, function (t) {
                if (this._itemRender != t) {
                    this._itemRender = t;
                    for (var i = this._cells.length - 1; -1 < i; i--) this._cells[i].destroy();
                    this._cells.length = 0, this._setCellChanged()
                }
            }), n(0, e, "vScrollBarSkin", function () {
                return this._scrollBar ? this._scrollBar.skin : null
            }, function (t) {
                this._removePreScrollBar();
                var i = new at;
                i.name = "scrollBar", i.right = 0, i.skin = t, i.elasticDistance = this._elasticEnabled ? 200 : 0, this.scrollBar = i, this.addChild(i), this._setCellChanged()
            }), n(0, e, "page", function () {
                return this._page
            }, function (t) {
                this._page = t, this._array && (this._page = 0 < t ? t : 0, this._page = this._page < this.totalPage ? this._page : this.totalPage - 1, this.startIndex = this._page * this.repeatX * this.repeatY)
            }), n(0, e, "hScrollBarSkin", function () {
                return this._scrollBar ? this._scrollBar.skin : null
            }, function (t) {
                this._removePreScrollBar();
                var i = new ct;
                i.name = "scrollBar", i.bottom = 0, i.skin = t, i.elasticDistance = this._elasticEnabled ? 200 : 0, this.scrollBar = i, this.addChild(i), this._setCellChanged()
            }), n(0, e, "repeatX", function () {
                return 0 < this._repeatX ? this._repeatX : 0 < this._repeatX2 ? this._repeatX2 : 1
            }, function (t) {
                this._repeatX = t, this._setCellChanged()
            }), n(0, e, "scrollBar", function () {
                return this._scrollBar
            }, function (t) {
                this._scrollBar != t && (this._scrollBar = t) && (this._isVertical = this._scrollBar.isVertical, this.addChild(this._scrollBar), this._scrollBar.on("change", this, this.onScrollBarChange))
            }), n(0, e, "width", t.prototype._$get_width, function (t) {
                t != this._width && (_.superSet(X, this, "width", t), this._setCellChanged())
            }), n(0, e, "repeatY", function () {
                return 0 < this._repeatY ? this._repeatY : 0 < this._repeatY2 ? this._repeatY2 : 1
            }, function (t) {
                this._repeatY = t, this._setCellChanged()
            }), n(0, e, "spaceX", function () {
                return this._spaceX
            }, function (t) {
                this._spaceX = t, this._setCellChanged()
            }), n(0, e, "spaceY", function () {
                return this._spaceY
            }, function (t) {
                this._spaceY = t, this._setCellChanged()
            }), n(0, e, "selectedIndex", function () {
                return this._selectedIndex
            }, function (t) {
                this._selectedIndex != t && (this._selectedIndex = t, this.changeSelectStatus(), this.event("change"), this.selectHandler && this.selectHandler.runWith(t), this.startIndex = this._startIndex)
            }), n(0, e, "selectedItem", function () {
                return -1 != this._selectedIndex ? this._array[this._selectedIndex] : null
            }, function (t) {
                this.selectedIndex = this._array.indexOf(t)
            }), n(0, e, "length", function () {
                return this._array ? this._array.length : 0
            }), n(0, e, "selection", function () {
                return this.getCell(this._selectedIndex)
            }, function (t) {
                this.selectedIndex = this._startIndex + this._cells.indexOf(t)
            }), n(0, e, "startIndex", function () {
                return this._startIndex
            }, function (t) {
                this._startIndex = 0 < t ? t : 0, this.callLater(this.renderItems)
            }), n(0, e, "array", function () {
                return this._array
            }, function (t) {
                this.runCallLater(this.changeCells), this._array = t || [], this._preLen = this._array.length;
                var i = this._array.length;
                if (this.totalPage = Math.ceil(i / (this.repeatX * this.repeatY)), this._selectedIndex = this._selectedIndex < i ? this._selectedIndex : i - 1, this.startIndex = this._startIndex, this._scrollBar) {
                    this._scrollBar.stopScroll();
                    var e = this._isVertical ? this.repeatX : this.repeatY,
                        s = this._isVertical ? this.repeatY : this.repeatX, n = Math.ceil(i / e),
                        h = 0 < this._cellOffset ? this.totalPage + 1 : this.totalPage;
                    this._scrollBar.target = (1 < h && s <= n ? (this._scrollBar.scrollSize = this._cellSize, this._scrollBar.thumbPercent = s / n, this._scrollBar.setScroll(0, (n - s) * this._cellSize + this._cellOffset, this._scrollBar.value)) : this._scrollBar.setScroll(0, 0, 0), this._content)
                }
            }), n(0, e, "dataSource", t.prototype._$get_dataSource, function (t) {
                "number" == typeof (this._dataSource = t) && Math.floor(t) == t || "string" == typeof t ? this.selectedIndex = parseInt(t) : t instanceof Array ? this.array = t : _.superSet(X, this, "dataSource", t)
            }), n(0, e, "cells", function () {
                return this.runCallLater(this.changeCells), this._cells
            }), n(0, e, "elasticEnabled", function () {
                return this._elasticEnabled
            }, function (t) {
                this._elasticEnabled = t, this._scrollBar && (this._scrollBar.elasticDistance = t ? 200 : 0)
            }), i
        }(X), nt = function (i) {
            function e(t) {
                this._bg = null, this._skin = null, e.__super.call(this), void 0 === t && (t = ""), this.text = t, this.skin = this.skin
            }

            a(e, "laya.ui.TextInput", i);
            var t = e.prototype;
            return t.preinitialize = function () {
                this.mouseEnabled = !0
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, t), this._bg && this._bg.destroy(), this._bg = null
            }, t.createChildren = function () {
                this.addChild(this._tf = new m), this._tf.padding = D.inputLabelPadding, this._tf.on("input", this, this._onInput), this._tf.on("enter", this, this._onEnter), this._tf.on("blur", this, this._onBlur), this._tf.on("focus", this, this._onFocus)
            }, t._onFocus = function () {
                this.event("focus", this)
            }, t._onBlur = function () {
                this.event("blur", this)
            }, t._onInput = function () {
                this.event("input", this)
            }, t._onEnter = function () {
                this.event("enter", this)
            }, t.initialize = function () {
                this.width = 128, this.height = 22
            }, t._skinLoaded = function () {
                this._bg || (this.graphics = this._bg = new P), this._bg.source = v.getRes(this._skin), this._width && (this._bg.width = this._width), this._height && (this._bg.height = this._height), this._sizeChanged(), this.event("loaded")
            }, t.select = function () {
                this._tf.select()
            }, t.setSelection = function (t, i) {
                this._tf.setSelection(t, i)
            }, n(0, t, "text", i.prototype._$get_text, function (t) {
                this._tf.text != t && (t += "", this._tf.text = t, this.event("change"))
            }), n(0, t, "bg", function () {
                return this._bg
            }, function (t) {
                this.graphics = this._bg = t
            }), n(0, t, "multiline", function () {
                return this._tf.multiline
            }, function (t) {
                this._tf.multiline = t
            }), n(0, t, "skin", function () {
                return this._skin
            }, function (t) {
                this._skin != t && (this._skin = t, this._skin && !v.getRes(this._skin) ? _.loader.load(this._skin, g.create(this, this._skinLoaded), null, "image", 1) : this._skinLoaded())
            }), n(0, t, "sizeGrid", function () {
                return this._bg && this._bg.sizeGrid ? this._bg.sizeGrid.join(",") : null
            }, function (t) {
                this._bg || (this.graphics = this._bg = new P), this._bg.sizeGrid = H.fillArray(D.defaultSizeGrid, t, Number)
            }), n(0, t, "width", i.prototype._$get_width, function (t) {
                _.superSet(R, this, "width", t), this._bg && (this._bg.width = t)
            }), n(0, t, "height", i.prototype._$get_height, function (t) {
                _.superSet(R, this, "height", t), this._bg && (this._bg.height = t)
            }), n(0, t, "editable", function () {
                return this._tf.editable
            }, function (t) {
                this._tf.editable = t
            }), n(0, t, "restrict", function () {
                return this._tf.restrict
            }, function (t) {
                this._tf.restrict = t
            }), n(0, t, "prompt", function () {
                return this._tf.prompt
            }, function (t) {
                this._tf.prompt = t
            }), n(0, t, "promptColor", function () {
                return this._tf.promptColor
            }, function (t) {
                this._tf.promptColor = t
            }), n(0, t, "maxChars", function () {
                return this._tf.maxChars
            }, function (t) {
                this._tf.maxChars = t
            }), n(0, t, "focus", function () {
                return this._tf.focus
            }, function (t) {
                this._tf.focus = t
            }), n(0, t, "type", function () {
                return this._tf.type
            }, function (t) {
                this._tf.type = t
            }), e
        }(R), ht = function (t) {
            function i() {
                this._oldW = 0, this._oldH = 0, i.__super.call(this)
            }

            a(i, "laya.ui.ScaleBox", t);
            var e = i.prototype;
            return e.onEnable = function () {
                _.stage.on("resize", this, this.onResize), this.onResize()
            }, e.onDisable = function () {
                _.stage.off("resize", this, this.onResize)
            }, e.onResize = function () {
                if (0 < this.width && 0 < this.height) {
                    var t = Math.min(_.stage.width / this._oldW, _.stage.height / this._oldH);
                    _.superSet(X, this, "width", _.stage.width), _.superSet(X, this, "height", _.stage.height), this.scale(t, t)
                }
            }, n(0, e, "width", t.prototype._$get_width, function (t) {
                _.superSet(X, this, "width", t), this._oldW = t
            }), n(0, e, "height", t.prototype._$get_height, function (t) {
                _.superSet(X, this, "height", t), this._oldH = t
            }), i
        }(X), ot = function (i) {
            function e(t, i) {
                this._value = null, void 0 === i && (i = ""), e.__super.call(this, t, i)
            }

            a(e, "laya.ui.Radio", i);
            var t = e.prototype;
            return t.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, t), this._value = null
            }, t.preinitialize = function () {
                laya.ui.UIComponent.prototype.preinitialize.call(this), this.toggle = !1, this._autoSize = !1
            }, t.initialize = function () {
                i.prototype.initialize.call(this), this.createText(), this._text.align = "left", this._text.valign = "top", this._text.width = 0, this.on("click", this, this.onClick)
            }, t.onClick = function (t) {
                this.selected = !0
            }, n(0, t, "value", function () {
                return null != this._value ? this._value : this.label
            }, function (t) {
                this._value = t
            }), e
        }(E), rt = function (i) {
            function e(t, i) {
                this._valueArr = null, this._indexMap = null, this._sheet = null, this._direction = "horizontal", this._spaceX = 0, this._spaceY = 0, this._align = "left", this._wordsW = 0, this._wordsH = 0, e.__super.call(this), t && (this.skin = t), i && (this.sheet = i)
            }

            a(e, "laya.ui.FontClip", i);
            var t = e.prototype;
            return t.createChildren = function () {
                this._bitmap = new P, this.on("loaded", this, this._onClipLoaded)
            }, t._onClipLoaded = function () {
                this.callLater(this.changeValue)
            }, t.changeValue = function () {
                var t;
                if (this._sources && (this._valueArr && (this.graphics.clear(!0), t = this._sources[0]))) {
                    var i = "horizontal" === this._direction;
                    this._wordsH = i ? (this._wordsW = this._valueArr.length * (t.sourceWidth + this.spaceX), t.sourceHeight) : (this._wordsW = t.sourceWidth, (t.sourceHeight + this.spaceY) * this._valueArr.length);
                    var e = 0;
                    if (this._width) switch (this._align) {
                        case"center":
                            e = .5 * (this._width - this._wordsW);
                            break;
                        case"right":
                            e = this._width - this._wordsW;
                            break;
                        default:
                            e = 0
                    }
                    for (var s = 0, n = this._valueArr.length; s < n; s++) {
                        var h = this._indexMap[this._valueArr.charAt(s)];
                        this.sources[h] && (t = this.sources[h], i ? this.graphics.drawImage(t, e + s * (t.sourceWidth + this.spaceX), 0, t.sourceWidth, t.sourceHeight) : this.graphics.drawImage(t, 0 + e, s * (t.sourceHeight + this.spaceY), t.sourceWidth, t.sourceHeight))
                    }
                    this._width || (this._widget.resetLayoutX(), this.callLater(this._sizeChanged)), this._height || (this._widget.resetLayoutY(), this.callLater(this._sizeChanged))
                }
            }, t.measureWidth = function () {
                return this._wordsW
            }, t.measureHeight = function () {
                return this._wordsH
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), this._valueArr = null, this._indexMap = null, this.graphics.clear(!0), this.removeSelf(), this.off("loaded", this, this._onClipLoaded), i.prototype.destroy.call(this, t)
            }, n(0, t, "sheet", function () {
                return this._sheet
            }, function (t) {
                t += "";
                var i = (this._sheet = t).split(" ");
                this._clipX = String(i[0]).length, this.clipY = i.length, this._indexMap = {};
                for (var e = 0; e < this._clipY; e++) for (var s = i[e].split(""), n = 0, h = s.length; n < h; n++) this._indexMap[s[n]] = e * this._clipX + n
            }), n(0, t, "height", i.prototype._$get_height, function (t) {
                _.superSet(V, this, "height", t), this.callLater(this.changeValue)
            }), n(0, t, "direction", function () {
                return this._direction
            }, function (t) {
                this._direction = t, this.callLater(this.changeValue)
            }), n(0, t, "value", function () {
                return this._valueArr ? this._valueArr : ""
            }, function (t) {
                t += "", this._valueArr = t, this.callLater(this.changeValue)
            }), n(0, t, "width", i.prototype._$get_width, function (t) {
                _.superSet(V, this, "width", t), this.callLater(this.changeValue)
            }), n(0, t, "spaceX", function () {
                return this._spaceX
            }, function (t) {
                this._spaceX = t, "horizontal" === this._direction && this.callLater(this.changeValue)
            }), n(0, t, "spaceY", function () {
                return this._spaceY
            }, function (t) {
                this._spaceY = t, "horizontal" !== this._direction && this.callLater(this.changeValue)
            }), n(0, t, "align", function () {
                return this._align
            }, function (t) {
                this._align = t, this.callLater(this.changeValue)
            }), e
        }(V), at = (function (i) {
            function s(t) {
                this.advsListArr = [], this.resUrl = "https://unioncdn.layabox.com/config/iconlist.json", this._data = [], this._resquestTime = 36e4, this._appid = null, this._playIndex = 0, this._lunboTime = 5e3, s.__super.call(this), this._http = new l.window.XMLHttpRequest, this.skin = t, this.setLoadUrl(), this.init(), this.size(120, 120)
            }

            a(s, "laya.ui.AdvImage", i);
            var t = s.prototype;
            t.setLoadUrl = function () {
                l.onLimixiu && (this.resUrl = "https://abc.layabox.com/public/wyw/gconfig.json")
            }, t.init = function () {
                this.isSupportJump() ? ((l.onMiniGame || l.onBDMiniGame) && _.timer.loop(this._resquestTime, this, this.onGetAdvsListData), this.onGetAdvsListData(), this.initEvent()) : this.visible = !1
            }, t.initEvent = function () {
                this.on("click", this, this.onAdvsImgClick)
            }, t.onAdvsImgClick = function () {
                this.getCurrentAppidObj() && this.jumptoGame()
            }, t.revertAdvsData = function () {
                if (this.advsListArr[this._playIndex]) if (this.visible = !0, l.onLimixiu) {
                    this.visible = !0;
                    var t = this.advsListArr[this._playIndex];
                    t && (l.onLimixiu && GameStatusInfo.gameId == t.gameid ? this.onLunbo() : (this.skin = "https://abc.layabox.com/public/icon/" + t.iconUrl, this.size(103, 126)))
                } else this.skin = this.advsListArr[this._playIndex]
            }, t.isSupportJump = function () {
                if (l.onMiniGame) return "function" == typeof wx.navigateToMiniProgram;
                if (l.onLimixiu) {
                    if (BK.QQ.skipGame) return !0
                } else if (l.onBDMiniGame) return !0;
                return !1
            }, t.jumptoGame = function () {
                var t = this, i = this.advsListArr[this._playIndex], e = parseInt(i.gameid), s = i.extendInfo;
                i.path;
                if (l.onLimixiu) {
                    if (!i.isLunBo && !i.isLunBo) {
                        var n = y.getJSON("gameObj");
                        n || (n = {}), n[i.gameid] || (n[i.gameid] = {}), n[i.gameid] = {isclick: !0}, y.setJSON("gameObj", n), this.advsListArr.splice(this._playIndex, 1)
                    }
                    BK.QQ.skipGame(e, s), this.updateAdvsInfo()
                } else l.onMiniGame ? this.isSupportJump() && wx.navigateToMiniProgram({
                    appId: this._appid,
                    path: "",
                    extraData: "",
                    envVersion: "release",
                    success: function () {
                    },
                    fail: function () {
                    },
                    complete: function () {
                        t.updateAdvsInfo()
                    }.bind(this)
                }) : l.onBDMiniGame || (this.visible = !1)
            }, t.updateAdvsInfo = function () {
                this.visible = !1, this.onLunbo(), _.timer.loop(this._lunboTime, this, this.onLunbo)
            }, t.onLunbo = function () {
                this._playIndex >= this.advsListArr.length - 1 ? this._playIndex = 0 : this._playIndex += 1, this.visible = !0, this.revertAdvsData()
            }, t.getCurrentAppidObj = function () {
                return this.advsListArr[this._playIndex]
            }, t.onGetAdvsListData = function () {
                var i = this, t = s.randRange(1e4, 1e6), e = this.resUrl + "?" + t;
                this._http.open("get", e, !0), this._http.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), this._http.responseType = "text", this._http.onerror = function (t) {
                    i._onError(t)
                }, this._http.onload = function (t) {
                    i._onLoad(t)
                }, this._http.send(null)
            }, t._onError = function (t) {
                this.error("Request failed Status:" + this._http.status + " text:" + this._http.statusText)
            }, t._onLoad = function (t) {
                var i = this._http, e = void 0 !== i.status ? i.status : 200;
                200 === e || 204 === e || 0 === e ? this.complete() : this.error("[" + i.status + "]" + i.statusText + ":" + i.responseURL)
            }, t.error = function (t) {
                this.event("error", t)
            }, t.complete = function () {
                try {
                    this._data = this._http.response || this._http.responseText, this._data = JSON.parse(this._data), l.onLimixiu ? (this.advsListArr = this.getAdvsQArr(this._data), this.advsListArr.length ? (this.updateAdvsInfo(), this.revertAdvsData()) : this.visible = !1) : (this.advsListArr = this._data.list, this._appid = this._data.appid, this.updateAdvsInfo(), this.revertAdvsData())
                } catch (t) {
                    !1, this.error(t.message)
                }
            }, t.getAdvsQArr = function (t) {
                var i = [], e = y.getJSON("gameObj");
                for (var s in t) {
                    var n = t[s];
                    e && e[n.gameid] && !n.isQiangZhi || i.push(n)
                }
                return i
            }, t.clear = function () {
                var t = this._http;
                t.onerror = t.onabort = t.onprogress = t.onload = null
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), _.timer.clear(this, this.onLunbo), i.prototype.destroy.call(this, !0), this.clear(), _.timer.clear(this, this.onGetAdvsListData)
            }, s.randRange = function (t, i) {
                return Math.floor(Math.random() * (i - t + 1)) + t
            }
        }(G), function (t) {
            function i() {
                i.__super.call(this)
            }

            return a(i, "laya.ui.VScrollBar", F), i
        }()), lt = function (t) {
            function i() {
                i.__super.call(this)
            }

            return a(i, "laya.ui.VSlider", j), i
        }(), ct = function (t) {
            function i() {
                i.__super.call(this)
            }

            return a(i, "laya.ui.HScrollBar", t), i.prototype.initialize = function () {
                t.prototype.initialize.call(this), this.slider.isVertical = !1
            }, i
        }(F), ut = function (t) {
            function i(t) {
                i.__super.call(this, t), this.isVertical = !1
            }

            return a(i, "laya.ui.HSlider", j), i
        }(), _t = function (t) {
            function i() {
                i.__super.call(this)
            }

            a(i, "laya.ui.HBox", t);
            var e = i.prototype;
            return e.sortItem = function (t) {
                t && t.sort(function (t, i) {
                    return t.x - i.x
                })
            }, e.changeItems = function () {
                this._itemChanged = !1;
                for (var t = [], i = 0, e = 0, s = this.numChildren; e < s; e++) {
                    var n = this.getChildAt(e);
                    n && (t.push(n), i = this._height ? this._height : Math.max(i, n.height * n.scaleY))
                }
                this.sortItem(t);
                var h = 0;
                for (e = 0, s = t.length; e < s; e++) (n = t[e]).x = h, h += n.width * n.scaleX + this._space, "top" == this._align ? n.y = 0 : "middle" == this._align ? n.y = .5 * (i - n.height * n.scaleY) : "bottom" == this._align && (n.y = i - n.height * n.scaleY);
                this._sizeChanged()
            }, n(0, e, "height", t.prototype._$get_height, function (t) {
                this._height != t && (_.superSet(K, this, "height", t), this.callLater(this.changeItems))
            }), i.NONE = "none", i.TOP = "top", i.MIDDLE = "middle", i.BOTTOM = "bottom", i
        }(K), dt = function (t) {
            function i() {
                i.__super.call(this)
            }

            return a(i, "laya.ui.RadioGroup", Z), i.prototype.createItem = function (t, i) {
                return new ot(t, i)
            }, i
        }(), ft = function (t) {
            function i() {
                i.__super.call(this)
            }

            a(i, "laya.ui.VBox", t);
            var e = i.prototype;
            return e.changeItems = function () {
                this._itemChanged = !1;
                for (var t = [], i = 0, e = 0, s = this.numChildren; e < s; e++) {
                    var n = this.getChildAt(e);
                    n && (t.push(n), i = this._width ? this._width : Math.max(i, n.width * n.scaleX))
                }
                this.sortItem(t);
                var h = 0;
                for (e = 0, s = t.length; e < s; e++) (n = t[e]).y = h, h += n.height * n.scaleY + this._space, "left" == this._align ? n.x = 0 : "center" == this._align ? n.x = .5 * (i - n.width * n.scaleX) : "right" == this._align && (n.x = i - n.width * n.scaleX);
                this._sizeChanged()
            }, n(0, e, "width", t.prototype._$get_width, function (t) {
                this._width != t && (_.superSet(K, this, "width", t), this.callLater(this.changeItems))
            }), i.NONE = "none", i.LEFT = "left", i.CENTER = "center", i.RIGHT = "right", i
        }(K), gt = function (i) {
            function e(t) {
                this._vScrollBar = null, this._hScrollBar = null, void 0 === t && (t = ""), e.__super.call(this, t), this.on("change", this, this._onTextChange)
            }

            a(e, "laya.ui.TextArea", i);
            var t = e.prototype;
            return t._onTextChange = function () {
                this.callLater(this.changeScroll)
            }, t.destroy = function (t) {
                void 0 === t && (t = !0), i.prototype.destroy.call(this, t), this._vScrollBar && this._vScrollBar.destroy(), this._hScrollBar && this._hScrollBar.destroy(), this._vScrollBar = null, this._hScrollBar = null
            }, t.initialize = function () {
                this.width = 180, this.height = 150, this._tf.wordWrap = !0, this.multiline = !0
            }, t.onVBarChanged = function (t) {
                this._tf.scrollY != this._vScrollBar.value && (this._tf.scrollY = this._vScrollBar.value)
            }, t.onHBarChanged = function (t) {
                this._tf.scrollX != this._hScrollBar.value && (this._tf.scrollX = this._hScrollBar.value)
            }, t.changeScroll = function () {
                var t = this._vScrollBar && 0 < this._tf.maxScrollY, i = this._hScrollBar && 0 < this._tf.maxScrollX,
                    e = t ? this._width - this._vScrollBar.width : this._width,
                    s = i ? this._height - this._hScrollBar.height : this._height,
                    n = this._tf.padding || D.labelPadding;
                this._tf.width = e, this._tf.height = s, this._vScrollBar && (this._vScrollBar.x = this._width - this._vScrollBar.width - n[2], this._vScrollBar.y = n[1], this._vScrollBar.height = this._height - (i ? this._hScrollBar.height : 0) - n[1] - n[3], this._vScrollBar.scrollSize = 1, this._vScrollBar.thumbPercent = s / Math.max(this._tf.textHeight, s), this._vScrollBar.setScroll(1, this._tf.maxScrollY, this._tf.scrollY), this._vScrollBar.visible = t), this._hScrollBar && (this._hScrollBar.x = n[0], this._hScrollBar.y = this._height - this._hScrollBar.height - n[3], this._hScrollBar.width = this._width - (t ? this._vScrollBar.width : 0) - n[0] - n[2], this._hScrollBar.scrollSize = Math.max(.033 * e, 1), this._hScrollBar.thumbPercent = e / Math.max(this._tf.textWidth, e), this._hScrollBar.setScroll(0, this.maxScrollX, this.scrollX), this._hScrollBar.visible = i)
            }, t.scrollTo = function (t) {
                this.commitMeasure(), this._tf.scrollY = t
            }, n(0, t, "scrollY", function () {
                return this._tf.scrollY
            }), n(0, t, "width", i.prototype._$get_width, function (t) {
                _.superSet(nt, this, "width", t), this.callLater(this.changeScroll)
            }), n(0, t, "hScrollBar", function () {
                return this._hScrollBar
            }), n(0, t, "height", i.prototype._$get_height, function (t) {
                _.superSet(nt, this, "height", t), this.callLater(this.changeScroll)
            }), n(0, t, "maxScrollX", function () {
                return this._tf.maxScrollX
            }), n(0, t, "vScrollBarSkin", function () {
                return this._vScrollBar ? this._vScrollBar.skin : null
            }, function (t) {
                null == this._vScrollBar && (this.addChild(this._vScrollBar = new at), this._vScrollBar.on("change", this, this.onVBarChanged), this._vScrollBar.target = this._tf, this.callLater(this.changeScroll)), this._vScrollBar.skin = t
            }), n(0, t, "hScrollBarSkin", function () {
                return this._hScrollBar ? this._hScrollBar.skin : null
            }, function (t) {
                null == this._hScrollBar && (this.addChild(this._hScrollBar = new ct), this._hScrollBar.on("change", this, this.onHBarChanged), this._hScrollBar.mouseWheelEnable = !1, this._hScrollBar.target = this._tf, this.callLater(this.changeScroll)), this._hScrollBar.skin = t
            }), n(0, t, "vScrollBar", function () {
                return this._vScrollBar
            }), n(0, t, "maxScrollY", function () {
                return this._tf.maxScrollY
            }), n(0, t, "scrollX", function () {
                return this._tf.scrollX
            }), e
        }(nt), pt = function (t) {
            function i() {
                i.__super.call(this)
            }

            return a(i, "laya.ui.Tab", Z), i.prototype.createItem = function (t, i) {
                return new E(t, i)
            }, i
        }();
        _.__init([J, N])
    }(window, document, Laya);
});
define("libs/laya.wxmini.js", function (require, module, exports) {
    window = window || global, window.layalib || (window.layalib = function (e, i) {
        (window._layalibs || (window._layalibs = [])).push({f: e, i: i})
    }), window.layalib(function (n, e, o) {
        o.un, o.uns;
        var i = o.static, l = o.class, a = o.getset, f = (o.__newvec, laya.utils.Browser),
            t = (laya.events.Event, laya.events.EventDispatcher), h = laya.resource.HTMLImage, _ = laya.utils.Handler,
            s = laya.display.Input, x = laya.net.Loader, r = laya.net.LocalStorage, d = laya.maths.Matrix,
            u = laya.renders.Render, c = laya.utils.RunDriver, v = laya.media.SoundChannel, p = laya.media.SoundManager,
            F = (laya.display.Stage, laya.net.URL), C = laya.utils.Utils, b = (function () {
                function a() {
                }

                l(a, "laya.wx.mini.MiniLocation"), a.__init__ = function () {
                    E.window.navigator.geolocation.getCurrentPosition = a.getCurrentPosition, E.window.navigator.geolocation.watchPosition = a.watchPosition, E.window.navigator.geolocation.clearWatch = a.clearWatch
                }, a.getCurrentPosition = function (i, e, t) {
                    var n;
                    (n = {
                        success: function (e) {
                            null != i && i(e)
                        }
                    }).fail = e, E.window.wx.getLocation(n)
                }, a.watchPosition = function (e, i, t) {
                    var n;
                    return a._curID++, (n = {}).success = e, n.error = i, a._watchDic[a._curID] = n, o.systemTimer.loop(1e3, null, a._myLoop), a._curID
                }, a.clearWatch = function (e) {
                    delete a._watchDic[e], a._hasWatch() || o.systemTimer.clear(null, a._myLoop)
                }, a._hasWatch = function () {
                    var e;
                    for (e in a._watchDic) if (a._watchDic[e]) return !0;
                    return !1
                }, a._myLoop = function () {
                    a.getCurrentPosition(a._mySuccess, a._myError)
                }, a._mySuccess = function (e) {
                    var i, t = {};
                    for (i in t.coords = e, t.timestamp = f.now(), a._watchDic) a._watchDic[i].success && a._watchDic[i].success(t)
                }, a._myError = function (e) {
                    var i;
                    for (i in a._watchDic) a._watchDic[i].error && a._watchDic[i].error(e)
                }, a._watchDic = {}, a._curID = 0
            }(), function () {
                function c() {
                }

                return l(c, "laya.wx.mini.MiniFileMgr"), c.isLocalNativeFile = function (e) {
                    for (var i = 0, t = E.nativefiles.length; i < t; i++) if (-1 != e.indexOf(E.nativefiles[i])) return !0;
                    return !1
                }, c.getFileInfo = function (e) {
                    var i = c.fakeObj[e];
                    return null == i ? null : i
                }, c.read = function (e, i, t, n, a, o) {
                    var l;
                    void 0 === i && (i = "utf8"), void 0 === n && (n = ""), void 0 === a && (a = !1), void 0 === o && (o = ""), l = "" == n || -1 == n.indexOf("http://") && -1 == n.indexOf("https://") ? e : c.getFileNativePath(e), l = F.getAdptedFilePath(l), c.fs.readFile({
                        filePath: l,
                        encoding: i,
                        success: function (e) {
                            null != t && t.runWith([0, e])
                        },
                        fail: function (e) {
                            e && "" != n ? c.downFiles(n, i, t, n, a, o) : null != t && t.runWith([1])
                        }
                    })
                }, c.downFiles = function (i, t, n, a, o, l, s) {
                    void 0 === t && (t = "ascii"), void 0 === a && (a = ""), void 0 === o && (o = !1), void 0 === l && (l = ""), void 0 === s && (s = !0), c.wxdown({
                        url: i,
                        success: function (e) {
                            200 === e.statusCode ? c.readFile(e.tempFilePath, t, n, a, o, l, s) : 403 === e.statusCode ? null != n && n.runWith([0, i]) : null != n && n.runWith([1, e])
                        },
                        fail: function (e) {
                            null != n && n.runWith([1, e])
                        }
                    }).onProgressUpdate(function (e) {
                        null != n && n.runWith([2, e.progress])
                    })
                }, c.readFile = function (i, t, n, a, o, e, l) {
                    void 0 === t && (t = "utf8"), void 0 === a && (a = ""), void 0 === o && (o = !1), void 0 === e && (e = ""), void 0 === l && (l = !0), i = F.getAdptedFilePath(i), c.fs.readFile({
                        filePath: i,
                        encoding: t,
                        success: function (e) {
                            (-1 != i.indexOf("http://") || -1 != i.indexOf("https://")) && (E.autoCacheFile || o) ? (null != n && n.runWith([0, e]), c.copyFile(i, a, null, t, l)) : null != n && n.runWith([0, e])
                        },
                        fail: function (e) {
                            e && null != n && n.runWith([1, e])
                        }
                    })
                }, c.downOtherFiles = function (e, i, t, n, a) {
                    void 0 === t && (t = ""), void 0 === n && (n = !1), void 0 === a && (a = !0), c.wxdown({
                        url: e,
                        success: function (e) {
                            200 === e.statusCode ? (E.autoCacheFile || n) && -1 == t.indexOf("qlogo.cn") && -1 == t.indexOf(".php") ? (null != i && i.runWith([0, e.tempFilePath]), c.copyFile(e.tempFilePath, t, null, "", a)) : null != i && i.runWith([0, e.tempFilePath]) : null != i && i.runWith([1, e])
                        },
                        fail: function (e) {
                            null != i && i.runWith([1, e])
                        }
                    })
                }, c.downLoadFile = function (e, i, t, n) {
                    void 0 === i && (i = ""), void 0 === n && (n = "ascii"), E.window.navigator.userAgent.indexOf("MiniGame") < 0 ? o.loader.load(e, t) : "image" == i || "sound" == i ? c.downOtherFiles(e, t, e, !0, !1) : c.downFiles(e, n, t, e, !0, i, !1)
                }, c.copyFile = function (e, t, n, a, o) {
                    void 0 === a && (a = ""), void 0 === o && (o = !0);
                    var i = e.split("/"), l = i[i.length - 1], s = t, r = c.getFileInfo(t), u = c.getFileNativePath(l);
                    c.fakeObj[s] = {md5: l, readyUrl: t, size: 0, times: f.now(), encoding: a};
                    var d = c.getCacheUseSize();
                    r ? r.readyUrl != t ? c.fs.getFileInfo({
                        filePath: e, success: function (e) {
                            o && 52428800 <= d + 4194304 + e.size && (e.size > E.minClearSize && (E.minClearSize = e.size), c.onClearCacheRes()), c.deleteFile(l, t, n, a, e.size)
                        }, fail: function (e) {
                            null != n && n.runWith([1, e])
                        }
                    }) : null != n && n.runWith([0]) : c.fs.getFileInfo({
                        filePath: e, success: function (i) {
                            o && 52428800 <= d + 4194304 + i.size && (i.size > E.minClearSize && (E.minClearSize = i.size), c.onClearCacheRes()), c.fs.copyFile({
                                srcPath: e,
                                destPath: u,
                                success: function (e) {
                                    c.onSaveFile(t, l, !0, a, n, i.size)
                                },
                                fail: function (e) {
                                    null != n && n.runWith([1, e])
                                }
                            })
                        }, fail: function (e) {
                            null != n && n.runWith([1, e])
                        }
                    })
                }, c.onClearCacheRes = function () {
                    var e = E.minClearSize, i = [];
                    for (var t in c.filesListObj) i.push(c.filesListObj[t]);
                    c.sortOn(i, "times", 16);
                    for (var n = 0, a = 1, o = i.length; a < o; a++) {
                        var l = i[a];
                        if (e <= n) break;
                        n += l.size, c.deleteFile("", l.readyUrl)
                    }
                }, c.sortOn = function (e, t, i) {
                    return void 0 === i && (i = 0), 16 == i ? e.sort(function (e, i) {
                        return e[t] - i[t]
                    }) : 18 == i ? e.sort(function (e, i) {
                        return i[t] - e[t]
                    }) : e.sort(function (e, i) {
                        return e[t] - i[t]
                    })
                }, c.getFileNativePath = function (e) {
                    return laya.wx.mini.MiniFileMgr.fileNativeDir + "/" + e
                }, c.deleteFile = function (n, a, o, l, s) {
                    void 0 === a && (a = ""), void 0 === l && (l = ""), void 0 === s && (s = 0);
                    var e = c.getFileInfo(a), i = c.getFileNativePath(e.md5);
                    c.fs.unlink({
                        filePath: i, success: function (e) {
                            var i = "" != n;
                            if ("" != n) {
                                var t = c.getFileNativePath(n);
                                c.fs.copyFile({
                                    srcPath: n, destPath: t, success: function (e) {
                                        c.onSaveFile(a, n, i, l, o, e.size)
                                    }, fail: function (e) {
                                        null != o && o.runWith([1, e])
                                    }
                                })
                            } else c.onSaveFile(a, n, i, l, o, s)
                        }, fail: function (e) {
                        }
                    })
                }, c.deleteAll = function () {
                    var e = [];
                    for (var i in c.filesListObj) e.push(c.filesListObj[i]);
                    for (var t = 1, n = e.length; t < n; t++) {
                        var a = e[t];
                        c.deleteFile("", a.readyUrl)
                    }
                    laya.wx.mini.MiniFileMgr.filesListObj && laya.wx.mini.MiniFileMgr.filesListObj.fileUsedSize && (laya.wx.mini.MiniFileMgr.filesListObj.fileUsedSize = 0), laya.wx.mini.MiniFileMgr.writeFilesList("", JSON.stringify({}), !1)
                }, c.onSaveFile = function (e, i, t, n, a, o) {
                    void 0 === t && (t = !0), void 0 === n && (n = ""), void 0 === o && (o = 0);
                    var l = e;
                    if (null == c.filesListObj.fileUsedSize && (c.filesListObj.fileUsedSize = 0), t) {
                        c.getFileNativePath(i);
                        c.filesListObj[l] = {
                            md5: i,
                            readyUrl: e,
                            size: o,
                            times: f.now(),
                            encoding: n
                        }, c.filesListObj.fileUsedSize = parseInt(c.filesListObj.fileUsedSize) + o, c.writeFilesList(l, JSON.stringify(c.filesListObj), !0), null != a && a.runWith([0])
                    } else if (c.filesListObj[l]) {
                        var s = parseInt(c.filesListObj[l].size);
                        c.filesListObj.fileUsedSize = parseInt(c.filesListObj.fileUsedSize) - s, delete c.filesListObj[l], c.writeFilesList(l, JSON.stringify(c.filesListObj), !1), null != a && a.runWith([0])
                    }
                }, c.writeFilesList = function (e, i, t) {
                    var n = c.fileNativeDir + "/" + c.fileListName;
                    c.fs.writeFile({
                        filePath: n, encoding: "utf8", data: i, success: function (e) {
                        }, fail: function (e) {
                        }
                    }), !E.isZiYu && E.isPosMsgYu && E.window.wx.postMessage && E.window.wx.postMessage({
                        url: e,
                        data: c.filesListObj[e],
                        isLoad: "filenative",
                        isAdd: t
                    })
                }, c.getCacheUseSize = function () {
                    return c.filesListObj && c.filesListObj.fileUsedSize ? c.filesListObj.fileUsedSize : 0
                }, c.existDir = function (e, i) {
                    c.fs.mkdir({
                        dirPath: e, success: function (e) {
                            null != i && i.runWith([0, {data: JSON.stringify({})}])
                        }, fail: function (e) {
                            -1 != e.errMsg.indexOf("file already exists") ? c.readSync(c.fileListName, "utf8", i) : null != i && i.runWith([1, e])
                        }
                    })
                }, c.readSync = function (e, i, t, n) {
                    void 0 === i && (i = "utf8"), void 0 === n && (n = "");
                    var a, o = c.getFileNativePath(e);
                    try {
                        a = c.fs.readFileSync(o, i), null != t && t.runWith([0, {data: a}])
                    } catch (e) {
                        null != t && t.runWith([1])
                    }
                }, c.setNativeFileDir = function (e) {
                    c.fileNativeDir = E.window.wx.env.USER_DATA_PATH + e
                }, c.filesListObj = {}, c.fakeObj = {}, c.fileNativeDir = null, c.fileListName = "layaairfiles.txt", c.ziyuFileData = {}, c.ziyuFileTextureData = {}, c.loadPath = "", c.DESCENDING = 2, c.NUMERIC = 16, i(c, ["fs", function () {
                    return this.fs = E.window.wx.getFileSystemManager()
                }, "wxdown", function () {
                    return this.wxdown = E.window.wx.downloadFile
                }]), c
            }()), m = function () {
                function t() {
                }

                return l(t, "laya.wx.mini.MiniLocalStorage"), t.__init__ = function () {
                    t.items = t
                }, t.setItem = function (i, t) {
                    try {
                        wx.setStorageSync(i, t)
                    } catch (e) {
                        wx.setStorage({key: i, data: t})
                    }
                }, t.getItem = function (e) {
                    return wx.getStorageSync(e)
                }, t.setJSON = function (e, i) {
                    t.setItem(e, i)
                }, t.getJSON = function (e) {
                    return t.getItem(e)
                }, t.removeItem = function (e) {
                    wx.removeStorageSync(e)
                }, t.clear = function () {
                    wx.clearStorageSync()
                }, t.getStorageInfoSync = function () {
                    try {
                        var e = wx.getStorageInfoSync();
                        return e
                    } catch (e) {
                    }
                    return null
                }, t.support = !0, t.items = null, t
            }(), g = (function () {
                function e(e, i) {
                    this.videoend = !1, this.videourl = "", this.videoElement = null, this.onPlayFunc = null, this.onEndedFunC = null, this._duration = NaN, this.position = NaN, void 0 === e && (e = 320), void 0 === i && (i = 240), this.videoElement = E.window.wx.createVideo({
                        width: e,
                        height: i,
                        autoplay: !0
                    })
                }

                l(e, "laya.wx.mini.MiniVideo");
                var i = e.prototype;
                i.on = function (e, i, t) {
                    "loadedmetadata" == e ? (this.onPlayFunc = t.bind(i), this.videoElement.onPlay = this.onPlayFunction.bind(this)) : "ended" == e && (this.onEndedFunC = t.bind(i), this.videoElement.onEnded = this.onEndedFunction.bind(this)), this.videoElement.onTimeUpdate = this.onTimeUpdateFunc.bind(this)
                }, i.onTimeUpdateFunc = function (e) {
                    this.position = e.position, this._duration = e.duration
                }, i.onPlayFunction = function () {
                    this.videoElement && (this.videoElement.readyState = 200), null != this.onPlayFunc && this.onPlayFunc()
                }, i.onEndedFunction = function () {
                    this.videoElement && (this.videoend = !0, null != this.onEndedFunC && this.onEndedFunC())
                }, i.off = function (e, i, t) {
                    "loadedmetadata" == e ? (this.onPlayFunc = t.bind(i), this.videoElement.offPlay = this.onPlayFunction.bind(this)) : "ended" == e && (this.onEndedFunC = t.bind(i), this.videoElement.offEnded = this.onEndedFunction.bind(this))
                }, i.load = function (e) {
                    this.videoElement && (this.videoElement.src = e)
                }, i.play = function () {
                    this.videoElement && (this.videoend = !1, this.videoElement.play())
                }, i.pause = function () {
                    this.videoElement && (this.videoend = !0, this.videoElement.pause())
                }, i.size = function (e, i) {
                    this.videoElement && (this.videoElement.width = e, this.videoElement.height = i)
                }, i.destroy = function () {
                    this.videoElement && this.videoElement.destroy(), this.videoElement = null, this.onEndedFunC = null, this.onPlayFunc = null, this.videoend = !1, this.videourl = null
                }, i.reload = function () {
                    this.videoElement && (this.videoElement.src = this.videourl)
                }, a(0, i, "duration", function () {
                    return this._duration
                }), a(0, i, "paused", function () {
                    return !!this.videoElement && this.videoElement.paused
                }), a(0, i, "loop", function () {
                    return !!this.videoElement && this.videoElement.loop
                }, function (e) {
                    this.videoElement && (this.videoElement.loop = e)
                }), a(0, i, "currentTime", function () {
                    return this.videoElement ? this.videoElement.initialTime : 0
                }, function (e) {
                    this.videoElement && (this.videoElement.initialTime = e)
                }), a(0, i, "ended", function () {
                    return this.videoend
                }), a(0, i, "muted", function () {
                    return !!this.videoElement && this.videoElement.muted
                }, function (e) {
                    this.videoElement && (this.videoElement.muted = e)
                }), a(0, i, "videoWidth", function () {
                    return this.videoElement ? this.videoElement.width : 0
                }), a(0, i, "videoHeight", function () {
                    return this.videoElement ? this.videoElement.height : 0
                }), a(0, i, "playbackRate", function () {
                    return this.videoElement ? this.videoElement.playbackRate : 0
                }, function (e) {
                    this.videoElement && (this.videoElement.playbackRate = e)
                }), a(0, i, "x", function () {
                    return this.videoElement ? this.videoElement.x : 0
                }, function (e) {
                    this.videoElement && (this.videoElement.x = e)
                }), a(0, i, "y", function () {
                    return this.videoElement ? this.videoElement.y : 0
                }, function (e) {
                    this.videoElement && (this.videoElement.y = e)
                }), a(0, i, "currentSrc", function () {
                    return this.videoElement.src
                }), e.__init__ = function () {
                    laya.device.media.Video = e
                }
            }(), function () {
                function d() {
                }

                return l(d, "laya.wx.mini.MiniImage"), d.prototype._loadImage = function (e) {
                    var i = this;
                    if (E.isZiYu) d.onCreateImage(e, i, !0); else {
                        var t = !1;
                        if (b.isLocalNativeFile(e)) {
                            if (-1 == e.indexOf("http://usr/") && (-1 != e.indexOf("http://") || -1 != e.indexOf("https://"))) if ("" != b.loadPath) e = e.split(b.loadPath)[1]; else {
                                var n = "" != F.rootPath ? F.rootPath : F._basePath, a = e;
                                "" != n && (e = e.split(n)[1]), e || (e = a)
                            }
                            if (E.subNativeFiles && 0 == E.subNativeheads.length) for (var o in E.subNativeFiles) {
                                var l = E.subNativeFiles[o];
                                E.subNativeheads = E.subNativeheads.concat(l);
                                for (var s = 0; s < l.length; s++) E.subMaps[l[s]] = o + "/" + l[s]
                            }
                            if (E.subNativeFiles && -1 != e.indexOf("/")) {
                                var r = e.split("/")[0] + "/";
                                if (r && -1 != E.subNativeheads.indexOf(r)) {
                                    var u = E.subMaps[r];
                                    e = e.replace(r, u)
                                }
                            }
                        } else t = !0, e = F.formatURL(e);
                        b.getFileInfo(e) ? d.onCreateImage(e, i, !t) : -1 != e.indexOf("http://usr/") || -1 == e.indexOf("http://") && -1 == e.indexOf("https://") ? d.onCreateImage(e, i, !0) : E.isZiYu ? d.onCreateImage(e, i, !0) : b.downOtherFiles(e, new _(d, d.onDownImgCallBack, [e, i]), e)
                    }
                }, d.onDownImgCallBack = function (e, i, t, n) {
                    void 0 === n && (n = ""), t ? i.onError(null) : d.onCreateImage(e, i, !1, n)
                }, d.onCreateImage = function (e, i, t, n) {
                    var a, o;
                    if (void 0 === t && (t = !1), void 0 === n && (n = ""), E.autoCacheFile) if (t) if (E.isZiYu) {
                        var l = F.formatURL(e);
                        a = b.ziyuFileTextureData[l] ? b.ziyuFileTextureData[l] : e
                    } else a = e; else if ("" != n) a = n; else {
                        var s = b.getFileInfo(e).md5;
                        a = b.getFileNativePath(s)
                    } else a = t ? e : n;

                    function r() {
                        var e = i._imgCache[a];
                        e && (e.onload = null, e.onerror = null, delete i._imgCache[a])
                    }

                    null == i._imgCache && (i._imgCache = {});
                    var u = function () {
                        r(), delete b.fakeObj[e], delete b.filesListObj[e], i.event("error", "Load image failed")
                    };
                    if ("nativeimage" == i._type) {
                        var d = function () {
                            r(), i.onLoaded(o)
                        };
                        (o = new f.window.Image).crossOrigin = "", o.onload = d, o.onerror = u, o.src = a, i._imgCache[a] = o
                    } else {
                        var c = new f.window.Image;
                        d = function () {
                            (o = h.create(c.width, c.height)).loadImageSource(c, !0), o._setCreateURL(a), r(), i.onLoaded(o)
                        }, c.crossOrigin = "", c.onload = d, c.onerror = u, c.src = a, i._imgCache[a] = c
                    }
                }, d
            }()), w = function () {
                function t() {
                }

                return l(t, "laya.wx.mini.MiniInput"), t._createInputElement = function () {
                    s._initInput(s.area = f.createElement("textarea")), s._initInput(s.input = f.createElement("input")), s.inputContainer = f.createElement("div"), s.inputContainer.style.position = "absolute", s.inputContainer.style.zIndex = 1e5, f.container.appendChild(s.inputContainer), s.inputContainer.setPos = function (e, i) {
                        s.inputContainer.style.left = e + "px", s.inputContainer.style.top = i + "px"
                    }, o.stage.on("resize", null, t._onStageResize), wx.onWindowResize && wx.onWindowResize(function (e) {
                        n.dispatchEvent && n.dispatchEvent("resize")
                    }), p._soundClass = L, p._musicClass = L;
                    var e = E.systemInfo.model, i = E.systemInfo.system;
                    -1 != e.indexOf("iPhone") && (f.onIPhone = !0, f.onIOS = !0, f.onIPad = !0, f.onAndroid = !1), -1 == i.indexOf("Android") && -1 == i.indexOf("Adr") || (f.onAndroid = !0, f.onIPhone = !1, f.onIOS = !1, f.onIPad = !1)
                }, t._onStageResize = function () {
                    o.stage._canvasTransform.identity().scale(f.width / u.canvas.width / f.pixelRatio, f.height / u.canvas.height / f.pixelRatio)
                }, t.wxinputFocus = function (e) {
                    var t = s.inputElement.target;
                    t && !t.editable || (E.window.wx.offKeyboardConfirm(), E.window.wx.offKeyboardInput(), E.window.wx.showKeyboard({
                        defaultValue: t.text,
                        maxLength: t.maxChars,
                        multiple: t.multiline,
                        confirmHold: !0,
                        confirmType: t.confirmType || "done",
                        success: function (e) {
                        },
                        fail: function (e) {
                        }
                    }), E.window.wx.onKeyboardConfirm(function (e) {
                        var i = e ? e.value : "";
                        t._restrictPattern && (i = i.replace(/\u2006|\x27/g, ""), t._restrictPattern.test(i) && (i = i.replace(t._restrictPattern, ""))), t.text = i, t.event("input"), laya.wx.mini.MiniInput.inputEnter(), t.event("confirm")
                    }), E.window.wx.onKeyboardInput(function (e) {
                        var i = e ? e.value : "";
                        t.multiline || -1 == i.indexOf("\n") ? (t._restrictPattern && (i = i.replace(/\u2006|\x27/g, ""), t._restrictPattern.test(i) && (i = i.replace(t._restrictPattern, ""))), t.text = i, t.event("input")) : laya.wx.mini.MiniInput.inputEnter()
                    }))
                }, t.inputEnter = function () {
                    s.inputElement.target.focus = !1
                }, t.wxinputblur = function () {
                    t.hideKeyboard()
                }, t.hideKeyboard = function () {
                    E.window.wx.offKeyboardConfirm(), E.window.wx.offKeyboardInput(), E.window.wx.hideKeyboard({
                        success: function (e) {
                        }, fail: function (e) {
                        }
                    })
                }, t
            }(), E = function () {
                function u() {
                }

                return l(u, "laya.wx.mini.MiniAdpter"), u.getJson = function (e) {
                    return JSON.parse(e)
                }, u.enable = function () {
                    u.init(o.isWXPosMsg, o.isWXOpenDataContext)
                }, u.init = function (e, i) {
                    void 0 === e && (e = !1), void 0 === i && (i = !1), u._inited || (u._inited = !0, (u.window = n).hasOwnProperty("wx") && (u.window.navigator.userAgent.indexOf("MiniGame") < 0 || (u.isZiYu = i, u.isPosMsgYu = e, u.EnvConfig = {}, u.isZiYu || (b.setNativeFileDir("/layaairGame"), b.existDir(b.fileNativeDir, _.create(u, u.onMkdirCallBack))), u.systemInfo = wx.getSystemInfoSync(), u.window.focus = function () {
                    }, o._getUrlPath = function () {
                        return ""
                    }, u.window.logtime = function (e) {
                    }, u.window.alertTimeLog = function (e) {
                    }, u.window.resetShareInfo = function () {
                    }, u.window.CanvasRenderingContext2D = function () {
                    }, u.window.CanvasRenderingContext2D.prototype = u.window.wx.createCanvas().getContext("2d").__proto__, u.window.document.body.appendChild = function () {
                    }, u.EnvConfig.pixelRatioInt = 0, f._pixelRatio = u.pixelRatio(), u._preCreateElement = f.createElement, f.createElement = u.createElement, c.createShaderCondition = u.createShaderCondition, C.parseXMLFromString = u.parseXMLFromString, s._createInputElement = w._createInputElement, u.EnvConfig.load = x.prototype.load, x.prototype.load = y.prototype.load, x.prototype._loadImage = g.prototype._loadImage, (r._baseClass = m).__init__(), u.window.wx.onMessage(u._onMessage))))
                }, u._onMessage = function (e) {
                    switch (e.type) {
                        case"changeMatrix":
                            o.stage.transform.identity(), o.stage._width = e.w, o.stage._height = e.h, o.stage._canvasTransform = new d(e.a, e.b, e.c, e.d, e.tx, e.ty);
                            break;
                        case"display":
                            o.stage.frameRate = e.rate || "fast";
                            break;
                        case"undisplay":
                            o.stage.frameRate = "sleep"
                    }
                    "opendatacontext" == e.isLoad ? e.url && (b.ziyuFileData[e.url] = e.atlasdata, b.ziyuFileTextureData[e.imgReadyUrl] = e.imgNativeUrl) : "openJsondatacontext" == e.isLoad ? e.url && (b.ziyuFileData[e.url] = e.atlasdata) : "openJsondatacontextPic" == e.isLoad && (b.ziyuFileTextureData[e.imgReadyUrl] = e.imgNativeUrl)
                }, u.getUrlEncode = function (e, i) {
                    return "arraybuffer" == i ? "" : "utf8"
                }, u.downLoadFile = function (e, i, t, n) {
                    void 0 === i && (i = ""), void 0 === n && (n = "utf8"), b.getFileInfo(e) ? null != t && t.runWith([0]) : b.downLoadFile(e, i, t, n)
                }, u.remove = function (e, i) {
                    b.deleteFile("", e, i, "", 0)
                }, u.removeAll = function () {
                    b.deleteAll()
                }, u.hasNativeFile = function (e) {
                    return b.isLocalNativeFile(e)
                }, u.getFileInfo = function (e) {
                    return b.getFileInfo(e)
                }, u.getFileList = function () {
                    return b.filesListObj
                }, u.exitMiniProgram = function () {
                    u.window.wx.exitMiniProgram()
                }, u.onMkdirCallBack = function (e, i) {
                    e || (b.filesListObj = JSON.parse(i.data), b.fakeObj = b.filesListObj)
                }, u.pixelRatio = function () {
                    if (!u.EnvConfig.pixelRatioInt) try {
                        return u.EnvConfig.pixelRatioInt = u.systemInfo.pixelRatio, u.systemInfo.pixelRatio
                    } catch (e) {
                    }
                    return u.EnvConfig.pixelRatioInt
                }, u.createElement = function (e) {
                    var i;
                    if ("canvas" == e) return 1 == u.idx ? u.isZiYu ? (i = sharedCanvas).style = {} : i = n.canvas : i = n.wx.createCanvas(), u.idx++, i;
                    if ("textarea" == e || "input" == e) return u.onCreateInput(e);
                    if ("div" != e) return u._preCreateElement(e);
                    var t = u._preCreateElement(e);
                    return t.contains = function (e) {
                        return null
                    }, t.removeChild = function (e) {
                    }, t
                }, u.onCreateInput = function (e) {
                    var i = u._preCreateElement(e);
                    return i.focus = w.wxinputFocus, i.blur = w.wxinputblur, i.style = {}, i.value = 0, i.parentElement = {}, i.placeholder = {}, i.type = {}, i.setColor = function (e) {
                    }, i.setType = function (e) {
                    }, i.setFontFace = function (e) {
                    }, i.addEventListener = function (e) {
                    }, i.contains = function (e) {
                        return null
                    }, i.removeChild = function (e) {
                    }, i
                }, u.createShaderCondition = function (e) {
                    var i = this;
                    return function () {
                        return i[e.replace("this.", "")]
                    }
                }, u.sendAtlasToOpenDataContext = function (e) {
                    if (!laya.wx.mini.MiniAdpter.isZiYu) {
                        var i = x.getRes(F.formatURL(e));
                        if (!i) throw"传递的url没有获取到对应的图集数据信息，请确保图集已经过！";
                        i.meta.image.split(",");
                        if (i.meta && i.meta.image) for (var t = i.meta.image.split(","), n = 0 <= e.indexOf("/") ? "/" : "\\", a = e.lastIndexOf(n), o = 0 <= a ? e.substr(0, a + 1) : "", l = 0, s = t.length; l < s; l++) t[l] = o + t[l]; else t = [e.replace(".json", ".png")];
                        for (l = 0; l < t.length; l++) {
                            var r = t[l];
                            u.postInfoToContext(e, r, i)
                        }
                    }
                }, u.postInfoToContext = function (e, i, t) {
                    var n = {frames: t.frames, meta: t.meta}, a = i, o = b.getFileInfo(F.formatURL(i));
                    if (o) var l = o.md5, s = b.getFileNativePath(l); else s = a;
                    if (!s) throw"获取图集的磁盘url路径不存在！";
                    wx.postMessage({url: e, atlasdata: n, imgNativeUrl: s, imgReadyUrl: a, isLoad: "opendatacontext"})
                }, u.sendSinglePicToOpenDataContext = function (e) {
                    var i = F.formatURL(e), t = b.getFileInfo(i);
                    if (t) {
                        var n = t.md5, a = b.getFileNativePath(n);
                        e = i
                    } else a = e;
                    if (!a) throw"获取图集的磁盘url路径不存在！";
                    wx.postMessage({url: e, imgNativeUrl: a, imgReadyUrl: e, isLoad: "openJsondatacontextPic"})
                }, u.sendJsonDataToDataContext = function (e) {
                    if (!laya.wx.mini.MiniAdpter.isZiYu) {
                        var i = x.getRes(e);
                        if (!i) throw"传递的url没有获取到对应的图集数据信息，请确保图集已经过！";
                        wx.postMessage({url: e, atlasdata: i, isLoad: "openJsondatacontext"})
                    }
                }, u.EnvConfig = null, u.window = null, u._preCreateElement = null, u._inited = !1, u.systemInfo = null, u.isZiYu = !1, u.isPosMsgYu = !1, u.autoCacheFile = !0, u.minClearSize = 5242880, u.subNativeFiles = null, u.subNativeheads = [], u.subMaps = [], u.AutoCacheDownFile = !1, u.parseXMLFromString = function (e) {
                    var i;
                    e = e.replace(/>\s+</g, "><");
                    try {
                        i = (new n.Parser.DOMParser).parseFromString(e, "text/xml")
                    } catch (e) {
                        throw"需要引入xml解析库文件"
                    }
                    return i
                }, u.idx = 1, i(u, ["nativefiles", function () {
                    return this.nativefiles = ["layaNativeDir", "wxlocal"]
                }]), u
            }(), y = function (e) {
                function y() {
                    y.__super.call(this)
                }

                return l(y, "laya.wx.mini.MiniLoader", t), y.prototype.load = function (e, i, t, n, a) {
                    void 0 === t && (t = !0), void 0 === a && (a = !1);
                    var o = this;
                    if (o._url = e) {
                        if (0 === (e = F.customFormat(e)).indexOf("data:image") ? o._type = i = "image" : o._type = i || (i = x.getTypeFromUrl(o._url)), o._cache = t, o._data = null, !a && x.loadedMap[F.formatURL(e)]) return o._data = x.loadedMap[F.formatURL(e)], this.event("progress", 1), void this.event("complete", o._data);
                        if (null != x.parserMap[i]) return o._customParse = !0, void (x.parserMap[i] instanceof laya.utils.Handler ? x.parserMap[i].runWith(this) : x.parserMap[i].call(null, this));
                        var l;
                        switch (i) {
                            case"atlas":
                            case"prefab":
                            case"plf":
                                l = "json";
                                break;
                            case"font":
                                l = "xml";
                                break;
                            case"plfb":
                                l = "arraybuffer";
                                break;
                            default:
                                l = i
                        }
                        if (x.preLoadedMap[F.formatURL(e)]) o.onLoaded(x.preLoadedMap[F.formatURL(e)]); else {
                            var s = E.getUrlEncode(e, l), r = C.getFileExtension(e);
                            if (-1 != y._fileTypeArr.indexOf(r)) E.EnvConfig.load.call(this, e, i, t, n, a); else {
                                if (E.isZiYu && !b.ziyuFileData[e] && (e = F.formatURL(e)), E.isZiYu && b.ziyuFileData[e]) {
                                    var u = b.ziyuFileData[e];
                                    return void o.onLoaded(u)
                                }
                                if (b.getFileInfo(e)) {
                                    var d = b.getFileInfo(e);
                                    d.encoding = null == d.encoding ? "utf8" : d.encoding, b.readFile(e, d.encoding, new _(y, y.onReadNativeCallBack, [s, e, i, t, n, a, o]), e)
                                } else {
                                    if (b.isLocalNativeFile(e)) {
                                        if (E.subNativeFiles && 0 == E.subNativeheads.length) for (var c in E.subNativeFiles) {
                                            var f = E.subNativeFiles[c];
                                            E.subNativeheads = E.subNativeheads.concat(f);
                                            for (var h = 0; h < f.length; h++) E.subMaps[f[h]] = c + "/" + f[h]
                                        }
                                        if (E.subNativeFiles && -1 != e.indexOf("/")) {
                                            var v = e.split("/")[0] + "/";
                                            if (v && -1 != E.subNativeheads.indexOf(v)) {
                                                var p = E.subMaps[v];
                                                e = e.replace(v, p)
                                            }
                                        }
                                        var m = "" != F.rootPath ? F.rootPath : F._basePath, g = e;
                                        return "" != m && (e = e.split(m)[1]), e || (e = g), void b.read(e, s, new _(y, y.onReadNativeCallBack, [s, e, i, t, n, a, o]))
                                    }
                                    var w = F.formatURL(e);
                                    -1 != w.indexOf("http://usr/") || -1 == w.indexOf("http://") && -1 == w.indexOf("https://") || E.AutoCacheDownFile ? (d = b.getFileInfo(e)) ? (d.encoding = null == d.encoding ? "utf8" : d.encoding, b.readFile(d.url, s, new _(y, y.onReadNativeCallBack, [s, e, i, t, n, a, o]), e)) : "image" == o.type || "htmlimage" == o.type ? E.EnvConfig.load.call(o, e, i, t, n, a) : -1 == (e = F.formatURL(e)).indexOf("http://") && -1 == e.indexOf("https://") || b.isLocalNativeFile(e) ? b.readFile(e, s, new _(y, y.onReadNativeCallBack, [s, e, i, t, n, a, o]), e) : b.downFiles(e, s, new _(y, y.onReadNativeCallBack, [s, e, i, t, n, a, o]), e, t) : E.EnvConfig.load.call(o, e, i, t, n, a)
                                }
                            }
                        }
                    } else o.onLoaded(null)
                }, y.onReadNativeCallBack = function (e, i, t, n, a, o, l, s, r) {
                    var u;
                    (void 0 === n && (n = !0), void 0 === o && (o = !1), void 0 === s && (s = 0), s) ? 1 == s && E.EnvConfig.load.call(l, i, t, n, a, o) : (u = "json" == t || "atlas" == t || "prefab" == t || "plf" == t ? E.getJson(r.data) : "xml" == t ? C.parseXMLFromString(r.data) : r.data, !E.isZiYu && E.isPosMsgYu && "arraybuffer" != t && wx.postMessage({
                        url: i,
                        data: u,
                        isLoad: "filedata"
                    }), l.onLoaded(u))
                }, i(y, ["_fileTypeArr", function () {
                    return this._fileTypeArr = ["png", "jpg", "bmp", "jpeg", "gif"]
                }]), y
            }(), L = function (e) {
                function r() {
                    this._sound = null, this.url = null, this.loaded = !1, this.readyUrl = null, r.__super.call(this)
                }

                l(r, "laya.wx.mini.MiniSound", t);
                var i = r.prototype;
                return i.load = function (e) {
                    if (b.isLocalNativeFile(e)) {
                        if (-1 != e.indexOf("http://") || -1 != e.indexOf("https://")) if ("" != b.loadPath) e = e.split(b.loadPath)[1]; else {
                            var i = "" != F.rootPath ? F.rootPath : F._basePath;
                            "" != i && (e = e.split(i)[1])
                        }
                    } else e = F.formatURL(e);
                    if (this.url = e, this.readyUrl = e, r._audioCache[this.readyUrl]) this.event("complete"); else if (E.autoCacheFile && b.getFileInfo(e)) this.onDownLoadCallBack(e, 0); else if (E.autoCacheFile) if (b.isLocalNativeFile(e)) {
                        var t = e;
                        if ("" != (i = "" != F.rootPath ? F.rootPath : F._basePath) && (e = e.split(i)[1]), e || (e = t), E.subNativeFiles && 0 == E.subNativeheads.length) for (var n in E.subNativeFiles) {
                            var a = E.subNativeFiles[n];
                            E.subNativeheads = E.subNativeheads.concat(a);
                            for (var o = 0; o < a.length; o++) E.subMaps[a[o]] = n + "/" + a[o]
                        }
                        if (E.subNativeFiles && -1 != e.indexOf("/")) {
                            var l = e.split("/")[0] + "/";
                            if (l && -1 != E.subNativeheads.indexOf(l)) {
                                var s = E.subMaps[l];
                                e = e.replace(l, s)
                            }
                        }
                        this.onDownLoadCallBack(e, 0)
                    } else !b.isLocalNativeFile(e) && -1 == e.indexOf("http://") && -1 == e.indexOf("https://") || -1 != e.indexOf("http://usr/") ? this.onDownLoadCallBack(e, 0) : b.downOtherFiles(e, _.create(this, this.onDownLoadCallBack, [e]), e); else this.onDownLoadCallBack(e, 0)
                }, i.onDownLoadCallBack = function (e, i, t) {
                    if (i) this.event("error"); else {
                        var n;
                        if (E.autoCacheFile) {
                            if (t) n = t; else if (b.isLocalNativeFile(e)) {
                                var a = "" != F.rootPath ? F.rootPath : F._basePath, o = e;
                                "" == a || -1 == e.indexOf("http://") && -1 == e.indexOf("https://") || (n = e.split(a)[1]), n || (n = o)
                            } else {
                                var l = b.getFileInfo(e);
                                if (l && l.md5) {
                                    var s = l.md5;
                                    n = b.getFileNativePath(s)
                                } else n = e
                            }
                            this._sound = r._createSound(), this._sound.src = this.url = n
                        } else this._sound = r._createSound(), this._sound.src = e;
                        this._sound.onCanplay(r.bindToThis(this.onCanPlay, this)), this._sound.onError(r.bindToThis(this.onError, this))
                    }
                }, i.onError = function (e) {
                    this.event("error"), this._sound.offError(null)
                }, i.onCanPlay = function () {
                    this.loaded = !0, this.event("complete"), this._sound.offCanplay(null)
                }, i.play = function (e, i) {
                    var t;
                    if (void 0 === e && (e = 0), void 0 === i && (i = 0), !(t = this.url == p._bgMusic ? (r._musicAudio || (r._musicAudio = r._createSound()), r._musicAudio) : r._audioCache[this.readyUrl] ? r._audioCache[this.readyUrl]._sound : r._createSound())) return null;
                    if (E.autoCacheFile && b.getFileInfo(this.url)) {
                        var n = b.getFileInfo(this.url).md5;
                        t.src = this.url = b.getFileNativePath(n)
                    } else t.src = this.url;
                    var a = new O(t, this);
                    return a.url = this.url, a.loops = i, a.loop = 0 === i, a.startTime = e, a.play(), p.addChannel(a), a
                }, i.dispose = function () {
                    var e = r._audioCache[this.readyUrl];
                    e && (e.src = "", e._sound && (e._sound.destroy(), e._sound = null, e = null), delete r._audioCache[this.readyUrl])
                }, a(0, i, "duration", function () {
                    return this._sound.duration
                }), r._createSound = function () {
                    return r._id++, E.window.wx.createInnerAudioContext()
                }, r.bindToThis = function (e, i) {
                    return e.bind(i)
                }, r._musicAudio = null, r._id = 0, r._audioCache = {}, r
            }(), O = (function (a) {
                function o() {
                    o.__super.call(this)
                }

                l(o, "laya.wx.mini.MiniAccelerator", a);
                var e = o.prototype;
                e.on = function (e, i, t, n) {
                    return a.prototype.on.call(this, e, i, t, n), o.startListen(this.onDeviceOrientationChange), this
                }, e.off = function (e, i, t, n) {
                    return void 0 === n && (n = !1), this.hasListener(e) || o.stopListen(), a.prototype.off.call(this, e, i, t, n)
                }, o.__init__ = function () {
                    try {
                        var e;
                        if (!(e = laya.device.motion.Accelerator)) return;
                        e.prototype.on = o.prototype.on, e.prototype.off = o.prototype.off
                    } catch (e) {
                    }
                }, o.startListen = function (e) {
                    if (o._callBack = e, !o._isListening) {
                        o._isListening = !0;
                        try {
                            E.window.wx.onAccelerometerChange(laya.wx.mini.MiniAccelerator.onDeviceOrientationChange)
                        } catch (e) {
                        }
                    }
                }, o.stopListen = function () {
                    o._isListening = !1;
                    try {
                        E.window.wx.stopAccelerometer({})
                    } catch (e) {
                    }
                }, o.onDeviceOrientationChange = function (e) {
                    var i;
                    (i = {}).acceleration = e, i.accelerationIncludingGravity = e, i.rotationRate = {}, null != o._callBack && o._callBack(i)
                }, o._isListening = !1, o._callBack = null
            }(t), function (e) {
                function t(e, i) {
                    this._audio = null, this._onEnd = null, this._miniSound = null, t.__super.call(this), this._audio = e, this._miniSound = i, this._onEnd = t.bindToThis(this.__onEnd, this), e.onEnded(this._onEnd)
                }

                l(t, "laya.wx.mini.MiniSoundChannel", v);
                var i = t.prototype;
                return i.__onEnd = function () {
                    if (L._audioCache[this.url] = this._miniSound, 1 == this.loops) return this.completeHandler && (o.systemTimer.once(10, this, this.__runComplete, [this.completeHandler], !1), this.completeHandler = null), this.stop(), void this.event("complete");
                    0 < this.loops && this.loops--, this.startTime = 0, this.play()
                }, i.play = function () {
                    this.isStopped = !1, p.addChannel(this), this._audio.play()
                }, i.stop = function () {
                    this.isStopped = !0, p.removeChannel(this), this.completeHandler = null, this._audio && (this._audio.stop(), this._audio.offEnded(null), this._miniSound.dispose(), this._audio = null, this._miniSound = null, this._onEnd = null)
                }, i.pause = function () {
                    this.isStopped = !0, this._audio.pause()
                }, i.resume = function () {
                    this._audio && (this.isStopped = !1, p.addChannel(this), this._audio.play())
                }, a(0, i, "startTime", null, function (e) {
                    this._audio && (this._audio.startTime = e)
                }), a(0, i, "autoplay", function () {
                    return this._audio.autoplay
                }, function (e) {
                    this._audio.autoplay = e
                }), a(0, i, "position", function () {
                    return this._audio ? this._audio.currentTime : 0
                }), a(0, i, "duration", function () {
                    return this._audio ? this._audio.duration : 0
                }), a(0, i, "loop", function () {
                    return this._audio.loop
                }, function (e) {
                    this._audio.loop = e
                }), a(0, i, "volume", function () {
                    return this._audio ? this._audio.volume : 1
                }, function (e) {
                    this._audio && (this._audio.volume = e)
                }), t.bindToThis = function (e, i) {
                    return e.bind(i)
                }, t
            }())
    }, 1e3);
});
define("weapp-adapter.js", function (require, module, exports) {
    !function (n) {
        var o = {};

        function r(e) {
            if (o[e]) return o[e].exports;
            var t = o[e] = {exports: {}, id: e, loaded: !1};
            return n[e].call(t.exports, t, t.exports, r), t.loaded = !0, t.exports
        }

        r.m = n, r.c = o, r.p = "", r(0)
    }([function (e, t, n) {
        "use strict";
        var o, i = function (e) {
            {
                if (e && e.__esModule) return e;
                var t = {};
                if (null != e) for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n]);
                return t.default = e, t
            }
        }(n(1)), r = n(4), u = (o = r) && o.__esModule ? o : {default: o};
        var c = GameGlobal;
        GameGlobal.__isAdapterInjected || (GameGlobal.__isAdapterInjected = !0, function () {
            i.addEventListener = function (e, t) {
                i.document.addEventListener(e, t)
            }, i.removeEventListener = function (e, t) {
                i.document.removeEventListener(e, t)
            }, i.canvas && (i.canvas.addEventListener = i.addEventListener, i.canvas.removeEventListener = i.removeEventListener), c.sharedCanvas && (sharedCanvas.__proto__.__proto__ = new u.default("canvas"), sharedCanvas.addEventListener = i.addEventListener, sharedCanvas.removeEventListener = i.removeEventListener);
            var e = wx.getSystemInfoSync().platform;
            if ("undefined" == typeof __devtoolssubcontext && "devtools" === e) {
                for (var t in i) {
                    var n = Object.getOwnPropertyDescriptor(c, t);
                    n && !0 !== n.configurable || Object.defineProperty(window, t, {value: i[t]})
                }
                for (var o in i.document) {
                    var r = Object.getOwnPropertyDescriptor(c.document, o);
                    r && !0 !== r.configurable || Object.defineProperty(c.document, o, {value: i.document[o]})
                }
                window.parent = window
            } else {
                for (var a in i) c[a] = i[a];
                c.window = i, window = c, window.top = window.parent = window
            }
        }())
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0}), t.cancelAnimationFrame = t.requestAnimationFrame = t.clearInterval = t.clearTimeout = t.setInterval = t.setTimeout = t.canvas = t.location = t.localStorage = t.HTMLElement = t.FileReader = t.Audio = t.Image = t.WebSocket = t.XMLHttpRequest = t.navigator = t.document = void 0;
        var o = n(2);
        Object.keys(o).forEach(function (e) {
            "default" !== e && "__esModule" !== e && Object.defineProperty(t, e, {
                enumerable: !0, get: function () {
                    return o[e]
                }
            })
        });
        var r = n(3);
        Object.keys(r).forEach(function (e) {
            "default" !== e && "__esModule" !== e && Object.defineProperty(t, e, {
                enumerable: !0, get: function () {
                    return r[e]
                }
            })
        });
        var a = b(n(9)), i = n(17), u = b(n(10)), c = b(n(18)), s = b(n(19)), l = b(n(20)), f = b(n(11)), p = b(n(12)),
            d = b(n(21)), h = b(n(4)), y = b(n(22)), v = b(n(23));

        function b(e) {
            return e && e.__esModule ? e : {default: e}
        }

        t.document = u.default, t.navigator = c.default, t.XMLHttpRequest = s.default, t.WebSocket = l.default, t.Image = f.default, t.Audio = p.default, t.FileReader = d.default, t.HTMLElement = h.default, t.localStorage = y.default, t.location = v.default;
        var _ = (0, i.isSubContext)() ? void 0 : new a.default;
        t.canvas = _, t.setTimeout = setTimeout, t.setInterval = setInterval, t.clearTimeout = clearTimeout, t.clearInterval = clearInterval, t.requestAnimationFrame = requestAnimationFrame, t.cancelAnimationFrame = cancelAnimationFrame
    }, function (e, t) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var n = wx.getSystemInfoSync(), o = n.screenWidth, r = n.screenHeight, a = n.devicePixelRatio,
            i = t.innerWidth = o, u = t.innerHeight = r;
        t.devicePixelRatio = a;
        t.screen = {availWidth: i, availHeight: u}, t.performance = {
            now: function () {
                return Date.now() / 1e3
            }
        }, t.ontouchstart = null, t.ontouchmove = null, t.ontouchend = null
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0}), t.HTMLCanvasElement = t.HTMLImageElement = void 0;
        var o, r = n(4), a = (o = r) && o.__esModule ? o : {default: o};

        function i(e, t) {
            if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
        }

        function u(e, t) {
            if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return !t || "object" != typeof t && "function" != typeof t ? e : t
        }

        function c(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }

        t.HTMLImageElement = function (e) {
            function t() {
                return i(this, t), u(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, "img"))
            }

            return c(t, a.default), t
        }(), t.HTMLCanvasElement = function (e) {
            function t() {
                return i(this, t), u(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, "canvas"))
            }

            return c(t, a.default), t
        }()
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o, r = function () {
            function o(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var o = t[n];
                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                }
            }

            return function (e, t, n) {
                return t && o(e.prototype, t), n && o(e, n), e
            }
        }(), a = n(5), i = (o = a) && o.__esModule ? o : {default: o}, u = n(8), c = n(2);
        var s = function (e) {
            function n() {
                var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "";
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, n);
                var t = function (e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this));
                return t.className = "", t.childern = [], t.style = {
                    width: c.innerWidth + "px",
                    height: c.innerHeight + "px"
                }, t.insertBefore = u.noop, t.innerHTML = "", t.tagName = e.toUpperCase(), t
            }

            return function (e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(n, i.default), r(n, [{
                key: "setAttribute", value: function (e, t) {
                    this[e] = t
                }
            }, {
                key: "getAttribute", value: function (e) {
                    return this[e]
                }
            }, {
                key: "getBoundingClientRect", value: function () {
                    return {top: 0, left: 0, width: c.innerWidth, height: c.innerHeight}
                }
            }, {
                key: "focus", value: function () {
                }
            }, {
                key: "clientWidth", get: function () {
                    var e = parseInt(this.style.fontSize, 10) * this.innerHTML.length;
                    return Number.isNaN(e) ? 0 : e
                }
            }, {
                key: "clientHeight", get: function () {
                    var e = parseInt(this.style.fontSize, 10);
                    return Number.isNaN(e) ? 0 : e
                }
            }]), n
        }();
        t.default = s
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o, r = n(6), a = (o = r) && o.__esModule ? o : {default: o};
        var i = function (e) {
            function t() {
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var e = function (e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
                return e.className = "", e.children = [], e
            }

            return function (e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, a.default), t
        }();
        t.default = i
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o, r = function () {
            function o(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var o = t[n];
                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                }
            }

            return function (e, t, n) {
                return t && o(e.prototype, t), n && o(e, n), e
            }
        }(), a = n(7), i = (o = a) && o.__esModule ? o : {default: o};
        var u = function (e) {
            function t() {
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var e = function (e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
                return e.childNodes = [], e
            }

            return function (e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, i.default), r(t, [{
                key: "appendChild", value: function (e) {
                    if (!(e instanceof t)) throw new TypeError("Failed to executed 'appendChild' on 'Node': parameter 1 is not of type 'Node'.");
                    this.childNodes.push(e)
                }
            }, {
                key: "cloneNode", value: function () {
                    var e = Object.create(this);
                    return Object.assign(e, this), e
                }
            }, {
                key: "removeChild", value: function (t) {
                    var e = this.childNodes.findIndex(function (e) {
                        return e === t
                    });
                    return -1 < e ? this.childNodes.splice(e, 1) : null
                }
            }]), t
        }();
        t.default = u
    }, function (e, t) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var n = function () {
            function o(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var o = t[n];
                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                }
            }

            return function (e, t, n) {
                return t && o(e.prototype, t), n && o(e, n), e
            }
        }();
        var r = new WeakMap, o = function () {
            function e() {
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, e), r.set(this, {})
            }

            return n(e, [{
                key: "addEventListener", value: function (e, t) {
                    var n = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : {}, o = r.get(this);
                    o || (o = {}, r.set(this, o)), o[e] || (o[e] = []), o[e].push(t), n.capture, n.once, n.passive
                }
            }, {
                key: "removeEventListener", value: function (e, t) {
                    var n = r.get(this)[e];
                    if (n && 0 < n.length) for (var o = n.length; o--; 0 < o) if (n[o] === t) {
                        n.splice(o, 1);
                        break
                    }
                }
            }, {
                key: "dispatchEvent", value: function () {
                    var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {},
                        t = r.get(this)[e.type];
                    if (t) for (var n = 0; n < t.length; n++) t[n](e)
                }
            }]), e
        }();
        t.default = o
    }, function (e, t) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0}), t.noop = function () {
        }, t.isSubContext = function () {
            return "undefined" != typeof GameGlobal && !0 === GameGlobal.__isSubContext
        }
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0}), t.default = function () {
            var e = wx.createCanvas();
            e.type = "canvas", e.__proto__.__proto__ = new o.default("canvas");
            e.getContext;
            return e.getBoundingClientRect = function () {
                return {top: 0, left: 0, width: window.innerWidth, height: window.innerHeight}
            }, e
        };
        n(3);
        var o = r(n(4));
        r(n(10));

        function r(e) {
            return e && e.__esModule ? e : {default: e}
        }
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o = function (e) {
            {
                if (e && e.__esModule) return e;
                var t = {};
                if (null != e) for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n]);
                return t.default = e, t
            }
        }(n(1)), r = c(n(4)), a = c(n(11)), i = c(n(12)), u = c(n(9));

        function c(e) {
            return e && e.__esModule ? e : {default: e}
        }

        n(15);
        var s = {}, l = {
            readyState: "complete",
            visibilityState: "visible",
            documentElement: o,
            hidden: !1,
            style: {},
            location: o.location,
            ontouchstart: null,
            ontouchmove: null,
            ontouchend: null,
            head: new r.default("head"),
            body: new r.default("body"),
            createElement: function (e) {
                return "canvas" === e ? new u.default : "audio" === e ? new i.default : "img" === e ? new a.default : new r.default(e)
            },
            getElementById: function (e) {
                return e === o.canvas.id ? o.canvas : null
            },
            getElementsByTagName: function (e) {
                return "head" === e ? [l.head] : "body" === e ? [l.body] : "canvas" === e ? [o.canvas] : []
            },
            querySelector: function (e) {
                return "head" === e ? l.head : "body" === e ? l.body : "canvas" === e ? o.canvas : e === "#" + o.canvas.id ? o.canvas : null
            },
            querySelectorAll: function (e) {
                return "head" === e ? [l.head] : "body" === e ? [l.body] : "canvas" === e ? [o.canvas] : []
            },
            addEventListener: function (e, t) {
                s[e] || (s[e] = []), s[e].push(t)
            },
            removeEventListener: function (e, t) {
                var n = s[e];
                if (n && 0 < n.length) for (var o = n.length; o--; 0 < o) if (n[o] === t) {
                    n.splice(o, 1);
                    break
                }
            },
            dispatchEvent: function (e) {
                var t = s[e.type];
                if (t) for (var n = 0; n < t.length; n++) t[n](e)
            }
        };
        t.default = l
    }, function (e, t) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0}), t.default = function () {
            return wx.createImage()
        }
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o, r = function () {
            function o(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var o = t[n];
                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                }
            }

            return function (e, t, n) {
                return t && o(e.prototype, t), n && o(e, n), e
            }
        }(), a = n(13), i = (o = a) && o.__esModule ? o : {default: o}, u = n(8);

        function c(e, t) {
            if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return !t || "object" != typeof t && "function" != typeof t ? e : t
        }

        var s = new WeakMap, l = new WeakMap, f = (new WeakMap, new WeakMap, function (e) {
            function o(e) {
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, o);
                var t = c(this, (o.__proto__ || Object.getPrototypeOf(o)).call(this));
                if (t.HAVE_NOTHING = 0, t.HAVE_METADATA = 1, t.HAVE_CURRENT_DATA = 2, t.HAVE_FUTURE_DATA = 3, t.HAVE_ENOUGH_DATA = 4, (t.readyState = 0, u.isSubContext)()) return c(t);
                l.set(t, "");
                var n = wx.createInnerAudioContext();
                return s.set(t, n), n.onCanplay(function () {
                    t.dispatchEvent({type: "load"}), t.dispatchEvent({type: "loadend"}), t.dispatchEvent({type: "canplay"}), t.dispatchEvent({type: "canplaythrough"}), t.dispatchEvent({type: "loadedmetadata"}), t.readyState = 2
                }), n.onPlay(function () {
                    t.dispatchEvent({type: "play"})
                }), n.onPause(function () {
                    t.dispatchEvent({type: "pause"})
                }), n.onEnded(function () {
                    t.dispatchEvent({type: "ended"}), t.readyState = 4
                }), n.onError(function () {
                    t.dispatchEvent({type: "error"})
                }), e && (s.get(t).src = e), t
            }

            return function (e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(o, i.default), r(o, [{
                key: "load", value: function () {
                }
            }, {
                key: "play", value: function () {
                    (0, u.isSubContext)() || s.get(this).play()
                }
            }, {
                key: "pause", value: function () {
                    (0, u.isSubContext)() || s.get(this).pause()
                }
            }, {
                key: "canPlayType", value: function () {
                    var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "";
                    return "string" != typeof e ? "" : -1 < e.indexOf("audio/mpeg") || e.indexOf("audio/mp4") ? "probably" : ""
                }
            }, {
                key: "cloneNode", value: function () {
                    var e = new o;
                    return (0, u.isSubContext)() || (e.loop = s.get(this).loop, e.autoplay = s.get(this).loop, e.src = this.src), e
                }
            }, {
                key: "currentTime", get: function () {
                    return (0, u.isSubContext)() ? 0 : s.get(this).currentTime
                }, set: function (e) {
                    (0, u.isSubContext)() || s.get(this).seek(e)
                }
            }, {
                key: "src", get: function () {
                    return l.get(this)
                }, set: function (e) {
                    l.set(this, e), (0, u.isSubContext)() || (s.get(this).src = e)
                }
            }, {
                key: "loop", get: function () {
                    return !(0, u.isSubContext)() && s.get(this).loop
                }, set: function (e) {
                    (0, u.isSubContext)() || (s.get(this).loop = e)
                }
            }, {
                key: "autoplay", get: function () {
                    return !(0, u.isSubContext)() && s.get(this).autoplay
                }, set: function (e) {
                    (0, u.isSubContext)() || (s.get(this).autoplay = e)
                }
            }, {
                key: "paused", get: function () {
                    return !(0, u.isSubContext)() && s.get(this).paused
                }
            }]), o
        }());
        t.default = f
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o, r = n(14), a = (o = r) && o.__esModule ? o : {default: o};
        var i = function (e) {
            function t() {
                return function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t), function (e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, "audio"))
            }

            return function (e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, a.default), t
        }();
        t.default = i
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o, r = function () {
            function o(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var o = t[n];
                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                }
            }

            return function (e, t, n) {
                return t && o(e.prototype, t), n && o(e, n), e
            }
        }(), a = n(4), i = (o = a) && o.__esModule ? o : {default: o};
        var u = function (e) {
            function t(e) {
                return function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t), function (e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e))
            }

            return function (e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, i.default), r(t, [{
                key: "addTextTrack", value: function () {
                }
            }, {
                key: "captureStream", value: function () {
                }
            }, {
                key: "fastSeek", value: function () {
                }
            }, {
                key: "load", value: function () {
                }
            }, {
                key: "pause", value: function () {
                }
            }, {
                key: "play", value: function () {
                }
            }]), t
        }();
        t.default = u
    }, function (e, t, n) {
        "use strict";
        n(16)
    }, function (e, t, n) {
        "use strict";
        var o, r = function (e) {
            {
                if (e && e.__esModule) return e;
                var t = {};
                if (null != e) for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n]);
                return t.default = e, t
            }
        }(n(1)), a = n(10), i = (o = a) && o.__esModule ? o : {default: o}, u = n(8);
        var c = function e(t) {
            !function (e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, e), this.target = r.canvas, this.currentTarget = r.canvas, this.touches = [], this.targetTouches = [], this.changedTouches = [], this.preventDefault = u.noop, this.stopPropagation = u.noop, this.type = t
        };

        function s(n) {
            return function (e) {
                var t = new c(n);
                t.touches = e.touches, t.targetTouches = Array.prototype.slice.call(e.touches), t.changedTouches = e.changedTouches, t.timeStamp = e.timeStamp, i.default.dispatchEvent(t)
            }
        }

        wx.onTouchStart(s("touchstart")), wx.onTouchMove(s("touchmove")), wx.onTouchEnd(s("touchend")), wx.onTouchCancel(s("touchcancel"))
    }, function (e, t) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0}), t.noop = function () {
        }, t.isSubContext = function () {
            return "undefined" != typeof GameGlobal && !0 === GameGlobal.__isSubContext
        }
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o = n(8), r = {
            platform: wx.getSystemInfoSync().platform,
            language: "zh-cn",
            appVersion: "5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1",
            userAgent: "Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/zh_CN",
            onLine: !0,
            geolocation: {getCurrentPosition: o.noop, watchPosition: o.noop, clearWatch: o.noop}
        };
        t.default = r
    }, function (e, t) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var n = function () {
            function o(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var o = t[n];
                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                }
            }

            return function (e, t, n) {
                return t && o(e.prototype, t), n && o(e, n), e
            }
        }();
        var o = new WeakMap, r = new WeakMap, a = new WeakMap, s = new WeakMap, i = new WeakMap;

        function l(e) {
            if ("function" == typeof this["on" + e]) {
                for (var t = arguments.length, n = Array(1 < t ? t - 1 : 0), o = 1; o < t; o++) n[o - 1] = arguments[o];
                this["on" + e].apply(this, n)
            }
        }

        function f(e) {
            this.readyState = e, l.call(this, "readystatechange")
        }

        var u = function () {
            function c() {
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, c), this.onabort = null, this.onerror = null, this.onload = null, this.onloadstart = null, this.onprogress = null, this.ontimeout = null, this.onloadend = null, this.onreadystatechange = null, this.readyState = 0, this.response = null, this.responseText = null, this.responseType = "", this.responseXML = null, this.status = 0, this.statusText = "", this.upload = {}, this.withCredentials = !1, a.set(this, {"content-type": "application/x-www-form-urlencoded"}), s.set(this, {})
            }

            return n(c, [{
                key: "abort", value: function () {
                    var e = i.get(this);
                    e && e.abort()
                }
            }, {
                key: "getAllResponseHeaders", value: function () {
                    var t = s.get(this);
                    return Object.keys(t).map(function (e) {
                        return e + ": " + t[e]
                    }).join("\n")
                }
            }, {
                key: "getResponseHeader", value: function (e) {
                    return s.get(this)[e]
                }
            }, {
                key: "open", value: function (e, t) {
                    r.set(this, e), o.set(this, t), f.call(this, c.OPENED)
                }
            }, {
                key: "overrideMimeType", value: function () {
                }
            }, {
                key: "send", value: function () {
                    var u = this, e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "";
                    if (this.readyState !== c.OPENED) throw new Error("Failed to execute 'send' on 'XMLHttpRequest': The object's state must be OPENED.");
                    wx.request({
                        data: e,
                        url: o.get(this),
                        method: r.get(this),
                        header: a.get(this),
                        responseType: this.responseType,
                        success: function (e) {
                            var t = e.data, n = e.statusCode, o = e.header;
                            if ("string" != typeof t && !(t instanceof ArrayBuffer)) try {
                                t = JSON.stringify(t)
                            } catch (e) {
                                t = t
                            }
                            if (u.status = n, s.set(u, o), l.call(u, "loadstart"), f.call(u, c.HEADERS_RECEIVED), f.call(u, c.LOADING), (u.response = t) instanceof ArrayBuffer) {
                                u.responseText = "";
                                for (var r = new Uint8Array(t), a = r.byteLength, i = 0; i < a; i++) u.responseText += String.fromCharCode(r[i])
                            } else u.responseText = t;
                            f.call(u, c.DONE), l.call(u, "load"), l.call(u, "loadend")
                        },
                        fail: function (e) {
                            var t = e.errMsg;
                            -1 !== t.indexOf("abort") ? l.call(u, "abort") : l.call(u, "error", t), l.call(u, "loadend")
                        }
                    })
                }
            }, {
                key: "setRequestHeader", value: function (e, t) {
                    var n = a.get(this);
                    n[e] = t, a.set(this, n)
                }
            }]), c
        }();
        u.UNSEND = 0, u.OPENED = 1, u.HEADERS_RECEIVED = 2, u.LOADING = 3, u.DONE = 4, t.default = u
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o = function () {
            function o(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var o = t[n];
                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                }
            }

            return function (e, t, n) {
                return t && o(e.prototype, t), n && o(e, n), e
            }
        }(), a = n(8);
        var i = new WeakMap, r = function () {
            function r(e) {
                var t = this, n = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : [];
                if (function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, r), this.binaryType = "", this.bufferedAmount = 0, this.extensions = "", this.onclose = null, this.onerror = null, this.onmessage = null, this.onopen = null, this.protocol = "", this.readyState = 3, (0, a.isSubContext)()) throw new Error("WebSocket is not supported in SubContext.");
                if ("string" != typeof e || !/(^ws:\/\/)|(^wss:\/\/)/.test(e)) throw new TypeError("Failed to construct 'WebSocket': The URL '" + e + "' is invalid");
                this.url = e, this.readyState = r.CONNECTING;
                var o = wx.connectSocket({url: e, protocols: Array.isArray(n) ? n : [n]});
                return i.set(this, o), o.onClose(function (e) {
                    t.readyState = r.CLOSED, "function" == typeof t.onclose && t.onclose(e)
                }), o.onMessage(function (e) {
                    "function" == typeof t.onmessage && t.onmessage(e)
                }), o.onOpen(function () {
                    t.readyState = r.OPEN, "function" == typeof t.onopen && t.onopen()
                }), o.onError(function (e) {
                    "function" == typeof t.onerror && t.onerror(new Error(e.errMsg))
                }), this
            }

            return o(r, [{
                key: "close", value: function (e, t) {
                    this.readyState = r.CLOSING, i.get(this).close({code: e, reason: t})
                }
            }, {
                key: "send", value: function (e) {
                    if ("string" != typeof e && !(e instanceof ArrayBuffer)) throw new TypeError("Failed to send message: The data " + e + " is invalid");
                    i.get(this).send({data: e})
                }
            }]), r
        }();
        r.CONNECTING = 0, r.OPEN = 1, r.CLOSING = 2, r.CLOSED = 3, t.default = r
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o = function () {
            function o(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var o = t[n];
                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                }
            }

            return function (e, t, n) {
                return t && o(e.prototype, t), n && o(e, n), e
            }
        }(), r = n(8);
        var a = function () {
            function e() {
                !function (e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, e)
            }

            return o(e, [{
                key: "construct", value: function () {
                    if ((0, r.isSubContext)()) throw new Error("FileReader is not supported in SubContext.")
                }
            }]), e
        }();
        t.default = a
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        var o = n(8), r = {
            get length() {
                return wx.getStorageInfoSync().keys.length
            }, key: function (e) {
                return wx.getStorageInfoSync().keys[e]
            }, getItem: function (e) {
                return wx.getStorageSync(e)
            }, setItem: function (e, t) {
                return wx.setStorageSync(e, t)
            }, removeItem: function (e) {
                wx.removeStorageSync(e)
            }, clear: function () {
                wx.clearStorageSync()
            }
        }, a = {}, i = {
            get length() {
                return Object.keys(a).length
            }, key: function (e) {
                return Object.keys(a)[e]
            }, getItem: function (e) {
                return a[e]
            }, setItem: function (e, t) {
                a[e] = t
            }, removeItem: function (e) {
                delete a[e]
            }, clear: function () {
                a = {}
            }
        }, u = (0, o.isSubContext)() ? i : r;
        t.default = u
    }, function (e, t) {
        "use strict";
        Object.defineProperty(t, "__esModule", {value: !0});
        t.default = {
            href: "game.js", reload: function () {
            }
        }
    }]);
});
var global = (function () {
    return this
})();
var pluginInfoMap = {};
;global.requirePlugin = global.requirePlugin || function (path) {
    var position = path.indexOf('/');
    var alias = '';
    var pagePath = '';
    if (position !== -1) {
        alias = path.substr(0, position);
        pagePath = path.substr(position + 1, path.length);
    } else {
        alias = path;
    }
    if (pluginInfoMap.hasOwnProperty(alias)) {
        var realPath = '';
        if (pagePath.length === 0) {
            realPath = '__plugin__/' + pluginInfoMap[alias].appid;
            return require(realPath);
        } else {
            realPath = '__plugin__/' + pluginInfoMap[alias].appid + '/' + pagePath;
            return require(realPath);
        }
    } else {
        console.error('not found alias: ', alias);
        throw new Error('Plugin ' + alias + ' is not defined.')
    }
};
define("game.js", function (require, module, exports) {
    "undefined" != typeof wx && (require("weapp-adapter.js"), require("libs/laya.wxmini.js"), require("libs/ald-game.js")), window.loadLib = require, require("index.js");
});
require("game.js");
 	